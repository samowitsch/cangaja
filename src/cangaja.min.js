var CG=CG||{VERSION:1,canvas:{},ctx:{},Const_PI_180:Math.PI/180,Const_180_PI:180/Math.PI,LEFT:1,RIGHT:2,UP:3,DOWN:4,LEFT_HAND:1,RIGHT_HAND:2,mousedown:false,mouse:{x:0,y:0},start:{x:0,y:0},end:{x:0,y:0}};CG._extend=function(a,b){if(!b){return a}for(var d in b){a[d]=b[d]}return a};CG._clone=function(a){return Q._extend({},a)};(function(){var b=0;var d=["ms","moz","webkit","o"];for(var a=0;a<d.length&&!window.requestAnimationFrame;++a){window.requestAnimationFrame=window[d[a]+"RequestAnimationFrame"];window.cancelAnimationFrame=window[d[a]+"CancelAnimationFrame"]||window[d[a]+"CancelRequestAnimationFrame"]}if(!window.requestAnimationFrame){window.requestAnimationFrame=function(k,f){var e=new Date().getTime();var g=Math.max(0,16-(e-b));var j=window.setTimeout(function(){k(e+g)},g);b=e+g;return j}}if(!window.cancelAnimationFrame){window.cancelAnimationFrame=function(e){clearTimeout(e)}}}());(function(){var a=false,b=/xyz/.test(function(){var d})?/\b_super\b/:/.*/;CG.Class=function(){};CG.Class.prototype.isA=function(d){return this.className===d};CG.Class.extend=function(k,e,g){if(!typeof k==="string"){g=e;e=k;k=null}var n=this.prototype,q=this;a=true;var m=new q();a=false;function j(r,s){return function(){var v=this._super;this._super=n[r];var u=s.apply(this,arguments);this._super=v;return u}}for(var f in e){m[f]=typeof e[f]==="function"&&typeof n[f]==="function"&&b.test(e[f])?j(f,e[f]):e[f]}function d(){if(!a&&this.init){this.init.apply(this,arguments)}}d.prototype=m;d.prototype.constructor=d;d.extend=CG.Class.extend;if(g){CG._extend(d,g)}if(k){CG[k]=d;d.prototype.className=k;d.className=k}return d}}());CG.Class.extend("Game",{init:function(b,a){switch(typeof b){case"object":this.canvas=b;break;case"string":this.canvas=document.getElementById(b);break;default:throw"no canvas element defined";break}this.ctx=this.canvas.getContext("2d");this.fps=60;this.width=this.canvas.width;this.height=this.canvas.height;this.width2=this.width/2;this.height2=this.height/2;this.b_canvas=document.createElement("canvas");this.b_canvas.width=this.width;this.b_canvas.height=this.height;this.b_ctx=this.b_canvas.getContext("2d");this.asset=new CG.MediaAsset(this);this.director=new CG.Director();this.renderer=new CG.CanvasRenderer();this.delta=new CG.Delta(this.fps);this.bound=new CG.Bound({x:0,y:0,width:this.width,height:this.height});this.preload()},preload:function(){},create:function(){this.loop()},loop:function(){requestAnimationFrame(this.loop.bind(this));this.beforeUpdate();this.update();this.beforeDraw();this.draw();this.afterDraw()},beforeUpdate:function(){this.director.update()},update:function(){},beforeDraw:function(){this.director.draw()},draw:function(){},afterDraw:function(){this.ctx.clearRect(0,0,this.bound.width,this.bound.height);this.ctx.drawImage(this.b_canvas,0,0);this.b_ctx.clearRect(0,0,this.bound.width,this.bound.height)}});function Transform(){this.reset()}Transform.prototype.reset=function(){this.m=[1,0,0,1,0,0]};Transform.prototype.multiply=function(d){var f=this.m[0]*d.m[0]+this.m[2]*d.m[1];var e=this.m[1]*d.m[0]+this.m[3]*d.m[1];var j=this.m[0]*d.m[2]+this.m[2]*d.m[3];var g=this.m[1]*d.m[2]+this.m[3]*d.m[3];var b=this.m[0]*d.m[4]+this.m[2]*d.m[5]+this.m[4];var a=this.m[1]*d.m[4]+this.m[3]*d.m[5]+this.m[5];this.m[0]=f;this.m[1]=e;this.m[2]=j;this.m[3]=g;this.m[4]=b;this.m[5]=a};Transform.prototype.invert=function(){var j=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]);var g=this.m[3]*j;var f=-this.m[1]*j;var e=-this.m[2]*j;var b=this.m[0]*j;var a=j*(this.m[2]*this.m[5]-this.m[3]*this.m[4]);var k=j*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);this.m[0]=g;this.m[1]=f;this.m[2]=e;this.m[3]=b;this.m[4]=a;this.m[5]=k};Transform.prototype.rotate=function(a){var j=Math.cos(a);var b=Math.sin(a);var e=this.m[0]*j+this.m[2]*b;var d=this.m[1]*j+this.m[3]*b;var g=this.m[0]*-b+this.m[2]*j;var f=this.m[1]*-b+this.m[3]*j;this.m[0]=e;this.m[1]=d;this.m[2]=g;this.m[3]=f};Transform.prototype.translate=function(a,b){this.m[4]+=this.m[0]*a+this.m[2]*b;this.m[5]+=this.m[1]*a+this.m[3]*b};Transform.prototype.scale=function(b,a){this.m[0]*=b;this.m[1]*=b;this.m[2]*=a;this.m[3]*=a};Transform.prototype.transformPoint=function(d,b){var a=d;var e=b;d=a*this.m[0]+e*this.m[2]+this.m[4];b=a*this.m[1]+e*this.m[3]+this.m[5];return[d,b]};(function(D){var E,K={},J={16:false,18:false,17:false,91:false},A="all",f={"⇧":16,shift:16,"⌥":18,alt:18,option:18,"⌃":17,ctrl:17,control:17,"⌘":91,command:91},g={backspace:8,tab:9,clear:12,enter:13,"return":13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,"delete":46,home:36,end:35,pageup:33,pagedown:34,",":188,".":190,"/":191,"`":192,"-":189,"=":187,";":186,"'":222,"[":219,"]":221,"\\":220},a=function(k){return g[k]||k.toUpperCase().charCodeAt(0)},G=[];for(E=1;E<20;E++){g["f"+E]=111+E}function m(O,N){var k=O.length;while(k--){if(O[k]===N){return k}}return -1}function H(N,k){if(N.length!=k.length){return false}for(var O=0;O<N.length;O++){if(N[O]!==k[O]){return false}}return true}var z={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey"};function n(k){for(E in J){J[E]=k[z[E]]}}function L(T){var P,S,N,O,U,R;P=T.keyCode;if(m(G,P)==-1){G.push(P)}if(P==93||P==224){P=91}if(P in J){J[P]=true;for(N in f){if(f[N]==P){j[N]=true}}return}n(T);if(!j.filter.call(this,T)){return}if(!(P in K)){return}R=u();for(O=0;O<K[P].length;O++){S=K[P][O];if(S.scope==R||S.scope=="all"){U=S.mods.length>0;for(N in J){if((!J[N]&&m(S.mods,+N)>-1)||(J[N]&&m(S.mods,+N)==-1)){U=false}}if((S.mods.length==0&&!J[16]&&!J[18]&&!J[17]&&!J[91])||U){if(S.method(T,S)===false){if(T.preventDefault){T.preventDefault()}else{T.returnValue=false}if(T.stopPropagation){T.stopPropagation()}if(T.cancelBubble){T.cancelBubble=true}}}}}}function e(R){var P=R.keyCode,N,O=m(G,P);if(O>=0){G.splice(O,1)}if(P==93||P==224){P=91}if(P in J){J[P]=false;for(N in f){if(f[N]==P){j[N]=false}}}}function q(){for(E in J){J[E]=false}for(E in f){j[E]=false}}function j(N,O,S){var R,P;R=b(N);if(S===undefined){S=O;O="all"}for(var k=0;k<R.length;k++){P=[];N=R[k].split("+");if(N.length>1){P=F(N);N=[N[N.length-1]]}N=N[0];N=a(N);if(!(N in K)){K[N]=[]}K[N].push({shortcut:R[k],scope:O,method:S,key:R[k],mods:P})}}function I(P,R){var k,T,S=[],O,N,U;k=b(P);for(N=0;N<k.length;N++){T=k[N].split("+");if(T.length>1){S=F(T);P=T[T.length-1]}P=a(P);if(R===undefined){R=u()}if(!K[P]){return}for(O in K[P]){U=K[P][O];if(U.scope===R&&H(U.mods,S)){K[P][O]={}}}}}function d(k){if(typeof(k)=="string"){k=a(k)}return m(G,k)!=-1}function y(){return G.slice(0)}function r(N){var k=(N.target||N.srcElement).tagName;return !(k=="INPUT"||k=="SELECT"||k=="TEXTAREA")}for(E in f){j[E]=false}function s(k){A=k||"all"}function u(){return A||"all"}function B(P){var O,k,N;for(O in K){k=K[O];for(N=0;N<k.length;){if(k[N].scope===P){k.splice(N,1)}else{N++}}}}function b(k){var N;k=k.replace(/\s/g,"");N=k.split(",");if((N[N.length-1])==""){N[N.length-2]+=","}return N}function F(N){var O=N.slice(0,N.length-1);for(var k=0;k<O.length;k++){O[k]=f[O[k]]}return O}function C(k,N,O){if(k.addEventListener){k.addEventListener(N,O,false)}else{if(k.attachEvent){k.attachEvent("on"+N,function(){O(window.event)})}}}C(document,"keydown",function(k){L(k)});C(document,"keyup",e);C(window,"focus",q);var v=D.key;function M(){var N=D.key;D.key=v;return N}D.key=j;D.key.setScope=s;D.key.getScope=u;D.key.deleteScope=B;D.key.filter=r;D.key.isPressed=d;D.key.getPressedKeyCodes=y;D.key.noConflict=M;D.key.unbind=I;if(typeof module!=="undefined"){module.exports=key}})(this);!function(b){if("object"==typeof exports){module.exports=b()}else{if("function"==typeof define&&define.amd){define(b)}else{var a;"undefined"!=typeof window?a=window:"undefined"!=typeof global?a=global:"undefined"!=typeof self&&(a=self),a.poly2tri=b()}}}(function(){var f,b,a;return(function d(g,q,k){function j(v,r){if(!q[v]){if(!g[v]){var n=typeof require=="function"&&require;if(!r&&n){return n(v,!0)}if(e){return e(v,!0)}throw new Error("Cannot find module '"+v+"'")}var s=q[v]={exports:{}};g[v][0].call(s.exports,function(u){var y=g[v][1][u];return j(y?y:u)},s,s.exports,d,g,q,k)}return q[v].exports}var e=typeof require=="function"&&require;for(var m=0;m<k.length;m++){j(k[m])}return j})({1:[function(j,g,e){g.exports={version:"1.3.3"}},{}],2:[function(m,j,e){var g=function(q,n){this.point=q;this.triangle=n||null;this.next=null;this.prev=null;this.value=q.x};var k=function(q,n){this.head_=q;this.tail_=n;this.search_node_=q};k.prototype.head=function(){return this.head_};k.prototype.setHead=function(n){this.head_=n};k.prototype.tail=function(){return this.tail_};k.prototype.setTail=function(n){this.tail_=n};k.prototype.search=function(){return this.search_node_};k.prototype.setSearch=function(n){this.search_node_=n};k.prototype.findSearchNode=function(){return this.search_node_};k.prototype.locateNode=function(n){var q=this.search_node_;if(n<q.value){while(q=q.prev){if(n>=q.value){this.search_node_=q;return q}}}else{while(q=q.next){if(n<q.value){this.search_node_=q.prev;return q.prev}}}return null};k.prototype.locatePoint=function(q){var r=q.x;var s=this.findSearchNode(r);var n=s.point.x;if(r===n){if(q!==s.point){if(q===s.prev.point){s=s.prev}else{if(q===s.next.point){s=s.next}else{throw new Error("poly2tri Invalid AdvancingFront.locatePoint() call")}}}}else{if(r<n){while(s=s.prev){if(q===s.point){break}}}else{while(s=s.next){if(q===s.point){break}}}}if(s){this.search_node_=s}return s};j.exports=k;j.exports.Node=g},{}],3:[function(k,g,e){var m=k("./xy");var j=function(n,q){this.x=+n||0;this.y=+q||0;this._p2t_edge_list=null};j.prototype.toString=function(){return m.toStringBase(this)};j.prototype.clone=function(){return new j(this.x,this.y)};j.prototype.set_zero=function(){this.x=0;this.y=0;return this};j.prototype.set=function(n,q){this.x=+n||0;this.y=+q||0;return this};j.prototype.negate=function(){this.x=-this.x;this.y=-this.y;return this};j.prototype.add=function(q){this.x+=q.x;this.y+=q.y;return this};j.prototype.sub=function(q){this.x-=q.x;this.y-=q.y;return this};j.prototype.mul=function(n){this.x*=n;this.y*=n;return this};j.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)};j.prototype.normalize=function(){var n=this.length();this.x/=n;this.y/=n;return n};j.prototype.equals=function(n){return this.x===n.x&&this.y===n.y};j.negate=function(n){return new j(-n.x,-n.y)};j.add=function(q,n){return new j(q.x+n.x,q.y+n.y)};j.sub=function(q,n){return new j(q.x-n.x,q.y-n.y)};j.mul=function(n,q){return new j(n*q.x,n*q.y)};j.cross=function(q,n){if(typeof(q)==="number"){if(typeof(n)==="number"){return q*n}else{return new j(-q*n.y,q*n.x)}}else{if(typeof(n)==="number"){return new j(n*q.y,-n*q.x)}else{return q.x*n.y-q.y*n.x}}};j.toString=m.toString;j.compare=m.compare;j.cmp=m.compare;j.equals=m.equals;j.dot=function(q,n){return q.x*n.x+q.y*n.y};g.exports=j},{"./xy":10}],4:[function(k,j,g){var m=k("./xy");var e=function(r,q){this.name="PointError";this.points=q=q||[];this.message=r||"Invalid Points!";for(var n=0;n<q.length;n++){this.message+=" "+m.toString(q[n])}};e.prototype=new Error();e.prototype.constructor=e;j.exports=e},{"./xy":10}],5:[function(m,j,e){var k=typeof self!=="undefined"?self:typeof window!=="undefined"?window:{};"use strict";var g=k.poly2tri;e.noConflict=function(){k.poly2tri=g;return e};e.VERSION=m("../dist/version.json").version;e.PointError=m("./pointerror");e.Point=m("./point");e.Triangle=m("./triangle");e.SweepContext=m("./sweepcontext");var n=m("./sweep");e.triangulate=n.triangulate;e.sweep={Triangulate:n.triangulate}},{"../dist/version.json":1,"./point":3,"./pointerror":4,"./sweep":6,"./sweepcontext":7,"./triangle":8}],6:[function(G,k,U){var L=G("./pointerror");var E=G("./triangle");var H=G("./advancingfront").Node;var af=G("./utils");var A=3*Math.PI/4;var R=Math.PI/2;var v=af.EPSILON;var J=af.Orientation;var X=af.orient2d;var Y=af.inScanArea;function u(ag){ag.initTriangulation();ag.createAdvancingFront();C(ag);W(ag)}function C(am){var ak,ah=am.pointCount();for(ak=1;ak<ah;++ak){var ag=am.getPoint(ak);var al=N(am,ag);var ai=ag._p2t_edge_list;for(var aj=0;ai&&aj<ai.length;++aj){aa(am,ai[aj],al)}}}function W(ai){var ag=ai.front().head().next.triangle;var ah=ai.front().head().next.point;while(!ag.getConstrainedEdgeCW(ah)){ag=ag.neighborCCW(ah)}ai.meshClean(ag)}function N(ai,ag){var ah=ai.locateNode(ag);var aj=ad(ai,ag,ah);if(ag.x<=ah.point.x+(v)){y(ai,ah)}g(ai,aj);return aj}function aa(ai,ah,ag){ai.edge_event.constrained_edge=ah;ai.edge_event.right=(ah.p.x>ah.q.x);if(ab(ag.triangle,ah.p,ah.q)){return}e(ai,ah,ag);D(ai,ah.p,ah.q,ag.triangle,ah.q)}function D(aj,ao,an,ai,ak){if(ab(ai,ao,an)){return}var am=ai.pointCCW(ak);var ah=X(an,am,ao);if(ah===J.COLLINEAR){throw new L("poly2tri EdgeEvent: Collinear not supported!",[an,am,ao])}var al=ai.pointCW(ak);var ag=X(an,al,ao);if(ag===J.COLLINEAR){throw new L("poly2tri EdgeEvent: Collinear not supported!",[an,al,ao])}if(ah===ag){if(ah===J.CW){ai=ai.neighborCCW(ak)}else{ai=ai.neighborCW(ak)}D(aj,ao,an,ai,ak)}else{n(aj,ao,an,ai,ak)}}function ab(ak,ah,ag){var ai=ak.edgeIndex(ah,ag);if(ai!==-1){ak.markConstrainedEdgeByIndex(ai);var aj=ak.getNeighbor(ai);if(aj){aj.markConstrainedEdgeByPoints(ah,ag)}return true}return false}function ad(aj,ag,ah){var ai=new E(ag,ah.point,ah.next.point);ai.markNeighbor(ah.triangle);aj.addToMap(ai);var ak=new H(ag);ak.next=ah.next;ak.prev=ah;ah.next.prev=ak;ah.next=ak;if(!M(aj,ai)){aj.mapTriangleToNodes(ai)}return ak}function y(ai,ag){var ah=new E(ag.prev.point,ag.point,ag.next.point);ah.markNeighbor(ag.prev.triangle);ah.markNeighbor(ag.triangle);ai.addToMap(ah);ag.prev.next=ag.next;ag.next.prev=ag.prev;if(!M(ai,ah)){ai.mapTriangleToNodes(ah)}}function g(ai,aj){var ag=aj.next;var ah;while(ag.next){ah=K(ag);if(ah>R||ah<-(R)){break}y(ai,ag);ag=ag.next}ag=aj.prev;while(ag.prev){ah=K(ag);if(ah>R||ah<-(R)){break}y(ai,ag);ag=ag.prev}if(aj.next&&aj.next.next){ah=V(aj);if(ah<A){O(ai,aj)}}}function V(ah){var ai=ah.point.x-ah.next.next.point.x;var ag=ah.point.y-ah.next.next.point.y;return Math.atan2(ag,ai)}function K(ah){var ai=ah.next.point.x-ah.point.x;var ag=ah.next.point.y-ah.point.y;var ak=ah.prev.point.x-ah.point.x;var aj=ah.prev.point.y-ah.point.y;return Math.atan2(ai*aj-ag*ak,ai*ak+ag*aj)}function M(al,an){for(var aj=0;aj<3;++aj){if(an.delaunay_edge[aj]){continue}var ai=an.getNeighbor(aj);if(ai){var ag=an.getPoint(aj);var ak=ai.oppositePoint(an,ag);var am=ai.index(ak);if(ai.constrained_edge[am]||ai.delaunay_edge[am]){an.constrained_edge[aj]=ai.constrained_edge[am];continue}var ah=B(ag,an.pointCCW(ag),an.pointCW(ag),ak);if(ah){an.delaunay_edge[aj]=true;ai.delaunay_edge[am]=true;ac(an,ag,ai,ak);var ao=!M(al,an);if(ao){al.mapTriangleToNodes(an)}ao=!M(al,ai);if(ao){al.mapTriangleToNodes(ai)}an.delaunay_edge[aj]=false;ai.delaunay_edge[am]=false;return true}}}return false}function B(ai,ah,ag,aC){var al=ai.x-aC.x;var ak=ai.y-aC.y;var ay=ah.x-aC.x;var ax=ah.y-aC.y;var aj=al*ax;var aw=ay*ak;var at=aj-aw;if(at<=0){return false}var ap=ag.x-aC.x;var ao=ag.y-aC.y;var aA=ap*ak;var av=al*ao;var am=aA-av;if(am<=0){return false}var az=ay*ao;var ar=ap*ax;var aq=al*al+ak*ak;var aB=ay*ay+ax*ax;var au=ap*ap+ao*ao;var an=aq*(az-ar)+aB*am+au*at;return an>0}function ac(aw,ah,am,ar){var av,au,at,aq;av=aw.neighborCCW(ah);au=aw.neighborCW(ah);at=am.neighborCCW(ar);aq=am.neighborCW(ar);var ak,aj,ai,ag;ak=aw.getConstrainedEdgeCCW(ah);aj=aw.getConstrainedEdgeCW(ah);ai=am.getConstrainedEdgeCCW(ar);ag=am.getConstrainedEdgeCW(ar);var ap,ao,an,al;ap=aw.getDelaunayEdgeCCW(ah);ao=aw.getDelaunayEdgeCW(ah);an=am.getDelaunayEdgeCCW(ar);al=am.getDelaunayEdgeCW(ar);aw.legalize(ah,ar);am.legalize(ar,ah);am.setDelaunayEdgeCCW(ah,ap);aw.setDelaunayEdgeCW(ah,ao);aw.setDelaunayEdgeCCW(ar,an);am.setDelaunayEdgeCW(ar,al);am.setConstrainedEdgeCCW(ah,ak);aw.setConstrainedEdgeCW(ah,aj);aw.setConstrainedEdgeCCW(ar,ai);am.setConstrainedEdgeCW(ar,ag);aw.clearNeigbors();am.clearNeigbors();if(av){am.markNeighbor(av)}if(au){aw.markNeighbor(au)}if(at){aw.markNeighbor(at)}if(aq){am.markNeighbor(aq)}aw.markNeighbor(am)}function O(ah,ag){if(X(ag.point,ag.next.point,ag.next.next.point)===J.CCW){ah.basin.left_node=ag.next.next}else{ah.basin.left_node=ag.next}ah.basin.bottom_node=ah.basin.left_node;while(ah.basin.bottom_node.next&&ah.basin.bottom_node.point.y>=ah.basin.bottom_node.next.point.y){ah.basin.bottom_node=ah.basin.bottom_node.next}if(ah.basin.bottom_node===ah.basin.left_node){return}ah.basin.right_node=ah.basin.bottom_node;while(ah.basin.right_node.next&&ah.basin.right_node.point.y<ah.basin.right_node.next.point.y){ah.basin.right_node=ah.basin.right_node.next}if(ah.basin.right_node===ah.basin.bottom_node){return}ah.basin.width=ah.basin.right_node.point.x-ah.basin.left_node.point.x;ah.basin.left_highest=ah.basin.left_node.point.y>ah.basin.right_node.point.y;S(ah,ah.basin.bottom_node)}function S(ai,ag){if(F(ai,ag)){return}y(ai,ag);var ah;if(ag.prev===ai.basin.left_node&&ag.next===ai.basin.right_node){return}else{if(ag.prev===ai.basin.left_node){ah=X(ag.point,ag.next.point,ag.next.next.point);if(ah===J.CW){return}ag=ag.next}else{if(ag.next===ai.basin.right_node){ah=X(ag.point,ag.prev.point,ag.prev.prev.point);if(ah===J.CCW){return}ag=ag.prev}else{if(ag.prev.point.y<ag.next.point.y){ag=ag.prev}else{ag=ag.next}}}}S(ai,ag)}function F(ai,ah){var ag;if(ai.basin.left_highest){ag=ai.basin.left_node.point.y-ah.point.y}else{ag=ai.basin.right_node.point.y-ah.point.y}if(ai.basin.width>ag){return true}return false}function e(ai,ah,ag){if(ai.edge_event.right){r(ai,ah,ag)}else{z(ai,ah,ag)}}function r(ai,ah,ag){while(ag.next.point.x<ah.p.x){if(X(ah.q,ag.next.point,ah.p)===J.CCW){j(ai,ah,ag)}else{ag=ag.next}}}function j(ai,ah,ag){if(ag.point.x<ah.p.x){if(X(ag.point,ag.next.point,ag.next.next.point)===J.CCW){I(ai,ah,ag)}else{Z(ai,ah,ag);j(ai,ah,ag)}}}function I(ai,ah,ag){y(ai,ag.next);if(ag.next.point!==ah.p){if(X(ah.q,ag.next.point,ah.p)===J.CCW){if(X(ag.point,ag.next.point,ag.next.next.point)===J.CCW){I(ai,ah,ag)}else{}}}}function Z(ai,ah,ag){if(X(ag.next.point,ag.next.next.point,ag.next.next.next.point)===J.CCW){I(ai,ah,ag.next)}else{if(X(ah.q,ag.next.next.point,ah.p)===J.CCW){Z(ai,ah,ag.next)}else{}}}function z(ai,ah,ag){while(ag.prev.point.x>ah.p.x){if(X(ah.q,ag.prev.point,ah.p)===J.CW){s(ai,ah,ag)}else{ag=ag.prev}}}function s(ai,ah,ag){if(ag.point.x>ah.p.x){if(X(ag.point,ag.prev.point,ag.prev.prev.point)===J.CW){T(ai,ah,ag)}else{ae(ai,ah,ag);s(ai,ah,ag)}}}function ae(ai,ah,ag){if(X(ag.prev.point,ag.prev.prev.point,ag.prev.prev.prev.point)===J.CW){T(ai,ah,ag.prev)}else{if(X(ah.q,ag.prev.prev.point,ah.p)===J.CW){ae(ai,ah,ag.prev)}else{}}}function T(ai,ah,ag){y(ai,ag.prev);if(ag.prev.point!==ah.p){if(X(ah.q,ag.prev.point,ah.p)===J.CW){if(X(ag.point,ag.prev.point,ag.prev.prev.point)===J.CW){T(ai,ah,ag)}else{}}}}function n(al,ap,ao,an,ag){var ai=an.neighborAcross(ag);if(!ai){throw new Error("poly2tri [BUG:FIXME] FLIP failed due to missing triangle!")}var ak=ai.oppositePoint(an,ag);if(an.getConstrainedEdgeAcross(ag)){var am=an.index(ag);throw new L("poly2tri Intersecting Constraints",[ag,ak,an.getPoint((am+1)%3),an.getPoint((am+2)%3)])}if(Y(ag,an.pointCCW(ag),an.pointCW(ag),ak)){ac(an,ag,ai,ak);al.mapTriangleToNodes(an);al.mapTriangleToNodes(ai);if(ag===ao&&ak===ap){if(ao===al.edge_event.constrained_edge.q&&ap===al.edge_event.constrained_edge.p){an.markConstrainedEdgeByPoints(ap,ao);ai.markConstrainedEdgeByPoints(ap,ao);M(al,an);M(al,ai)}else{}}else{var ah=X(ao,ak,ap);an=m(al,ah,an,ai,ag,ak);n(al,ap,ao,an,ag)}}else{var aj=P(ap,ao,ai,ak);q(al,ap,ao,an,ai,aj);D(al,ap,ao,an,ag)}}function m(al,ak,ag,ai,aj,am){var ah;if(ak===J.CCW){ah=ai.edgeIndex(aj,am);ai.delaunay_edge[ah]=true;M(al,ai);ai.clearDelunayEdges();return ag}ah=ag.edgeIndex(aj,am);ag.delaunay_edge[ah]=true;M(al,ag);ag.clearDelunayEdges();return ai}function P(ah,ag,aj,ak){var ai=X(ag,ak,ah);if(ai===J.CW){return aj.pointCCW(ak)}else{if(ai===J.CCW){return aj.pointCW(ak)}else{throw new L("poly2tri [Unsupported] nextFlipPoint: opposing point on constrained edge!",[ag,ak,ah])}}}function q(ak,ao,am,an,al,ag){var ah=al.neighborAcross(ag);if(!ah){throw new Error("poly2tri [BUG:FIXME] FLIP failed due to missing triangle")}var aj=ah.oppositePoint(al,ag);if(Y(am,an.pointCCW(am),an.pointCW(am),aj)){n(ak,am,aj,ah,aj)}else{var ai=P(ao,am,ah,aj);q(ak,ao,am,an,ah,ai)}}U.triangulate=u},{"./advancingfront":2,"./pointerror":4,"./triangle":8,"./utils":9}],7:[function(e,g,m){var y=e("./pointerror");var r=e("./point");var k=e("./triangle");var z=e("./sweep");var s=e("./advancingfront");var q=s.Node;var A=0.3;var n=function(C,B){this.p=C;this.q=B;if(C.y>B.y){this.q=C;this.p=B}else{if(C.y===B.y){if(C.x>B.x){this.q=C;this.p=B}else{if(C.x===B.x){throw new y("poly2tri Invalid Edge constructor: repeated points!",[C])}}}}if(!this.q._p2t_edge_list){this.q._p2t_edge_list=[]}this.q._p2t_edge_list.push(this)};var u=function(){this.left_node=null;this.bottom_node=null;this.right_node=null;this.width=0;this.left_highest=false};u.prototype.clear=function(){this.left_node=null;this.bottom_node=null;this.right_node=null;this.width=0;this.left_highest=false};var v=function(){this.constrained_edge=null;this.right=false};var j=function(C,B){B=B||{};this.triangles_=[];this.map_=[];this.points_=(B.cloneArrays?C.slice(0):C);this.edge_list=[];this.pmin_=this.pmax_=null;this.front_=null;this.head_=null;this.tail_=null;this.af_head_=null;this.af_middle_=null;this.af_tail_=null;this.basin=new u();this.edge_event=new v();this.initEdges(this.points_)};j.prototype.addHole=function(C){this.initEdges(C);var D,B=C.length;for(D=0;D<B;D++){this.points_.push(C[D])}return this};j.prototype.AddHole=j.prototype.addHole;j.prototype.addPoint=function(B){this.points_.push(B);return this};j.prototype.AddPoint=j.prototype.addPoint;j.prototype.addPoints=function(B){this.points_=this.points_.concat(B);return this};j.prototype.triangulate=function(){z.triangulate(this);return this};j.prototype.getBoundingBox=function(){return{min:this.pmin_,max:this.pmax_}};j.prototype.getTriangles=function(){return this.triangles_};j.prototype.GetTriangles=j.prototype.getTriangles;j.prototype.front=function(){return this.front_};j.prototype.pointCount=function(){return this.points_.length};j.prototype.head=function(){return this.head_};j.prototype.setHead=function(B){this.head_=B};j.prototype.tail=function(){return this.tail_};j.prototype.setTail=function(B){this.tail_=B};j.prototype.getMap=function(){return this.map_};j.prototype.initTriangulation=function(){var F=this.points_[0].x;var B=this.points_[0].x;var D=this.points_[0].y;var H=this.points_[0].y;var E,G=this.points_.length;for(E=1;E<G;E++){var C=this.points_[E];(C.x>F)&&(F=C.x);(C.x<B)&&(B=C.x);(C.y>D)&&(D=C.y);(C.y<H)&&(H=C.y)}this.pmin_=new r(B,H);this.pmax_=new r(F,D);var J=A*(F-B);var I=A*(D-H);this.head_=new r(F+J,H-I);this.tail_=new r(B-J,H-I);this.points_.sort(r.compare)};j.prototype.initEdges=function(C){var D,B=C.length;for(D=0;D<B;++D){this.edge_list.push(new n(C[D],C[(D+1)%B]))}};j.prototype.getPoint=function(B){return this.points_[B]};j.prototype.addToMap=function(B){this.map_.push(B)};j.prototype.locateNode=function(B){return this.front_.locateNode(B.x)};j.prototype.createAdvancingFront=function(){var D;var C;var B;var E=new k(this.points_[0],this.tail_,this.head_);this.map_.push(E);D=new q(E.getPoint(1),E);C=new q(E.getPoint(0),E);B=new q(E.getPoint(2));this.front_=new s(D,B);D.next=C;C.next=B;C.prev=D;B.prev=C};j.prototype.removeNode=function(B){};j.prototype.mapTriangleToNodes=function(C){for(var B=0;B<3;++B){if(!C.getNeighbor(B)){var D=this.front_.locatePoint(C.pointCW(C.getPoint(B)));if(D){D.triangle=C}}}};j.prototype.removeFromMap=function(E){var C,D=this.map_,B=D.length;for(C=0;C<B;C++){if(D[C]===E){D.splice(C,1);break}}};j.prototype.meshClean=function(E){var D=[E],C,B;while(C=D.pop()){if(!C.isInterior()){C.setInterior(true);this.triangles_.push(C);for(B=0;B<3;B++){if(!C.constrained_edge[B]){D.push(C.getNeighbor(B))}}}}};g.exports=j},{"./advancingfront":2,"./point":3,"./pointerror":4,"./sweep":6,"./triangle":8}],8:[function(j,g,e){var k=j("./xy");var n=function(r,q,s){this.points_=[r,q,s];this.neighbors_=[null,null,null];this.interior_=false;this.constrained_edge=[false,false,false];this.delaunay_edge=[false,false,false]};var m=k.toString;n.prototype.toString=function(){return("["+m(this.points_[0])+m(this.points_[1])+m(this.points_[2])+"]")};n.prototype.getPoint=function(q){return this.points_[q]};n.prototype.GetPoint=n.prototype.getPoint;n.prototype.getPoints=function(){return this.points_};n.prototype.getNeighbor=function(q){return this.neighbors_[q]};n.prototype.containsPoint=function(q){var r=this.points_;return(q===r[0]||q===r[1]||q===r[2])};n.prototype.containsEdge=function(q){return this.containsPoint(q.p)&&this.containsPoint(q.q)};n.prototype.containsPoints=function(r,q){return this.containsPoint(r)&&this.containsPoint(q)};n.prototype.isInterior=function(){return this.interior_};n.prototype.setInterior=function(q){this.interior_=q;return this};n.prototype.markNeighborPointers=function(u,s,q){var r=this.points_;if((u===r[2]&&s===r[1])||(u===r[1]&&s===r[2])){this.neighbors_[0]=q}else{if((u===r[0]&&s===r[2])||(u===r[2]&&s===r[0])){this.neighbors_[1]=q}else{if((u===r[0]&&s===r[1])||(u===r[1]&&s===r[0])){this.neighbors_[2]=q}else{throw new Error("poly2tri Invalid Triangle.markNeighborPointers() call")}}}};n.prototype.markNeighbor=function(q){var r=this.points_;if(q.containsPoints(r[1],r[2])){this.neighbors_[0]=q;q.markNeighborPointers(r[1],r[2],this)}else{if(q.containsPoints(r[0],r[2])){this.neighbors_[1]=q;q.markNeighborPointers(r[0],r[2],this)}else{if(q.containsPoints(r[0],r[1])){this.neighbors_[2]=q;q.markNeighborPointers(r[0],r[1],this)}}}};n.prototype.clearNeigbors=function(){this.neighbors_[0]=null;this.neighbors_[1]=null;this.neighbors_[2]=null};n.prototype.clearDelunayEdges=function(){this.delaunay_edge[0]=false;this.delaunay_edge[1]=false;this.delaunay_edge[2]=false};n.prototype.pointCW=function(r){var q=this.points_;if(r===q[0]){return q[2]}else{if(r===q[1]){return q[0]}else{if(r===q[2]){return q[1]}else{return null}}}};n.prototype.pointCCW=function(r){var q=this.points_;if(r===q[0]){return q[1]}else{if(r===q[1]){return q[2]}else{if(r===q[2]){return q[0]}else{return null}}}};n.prototype.neighborCW=function(q){if(q===this.points_[0]){return this.neighbors_[1]}else{if(q===this.points_[1]){return this.neighbors_[2]}else{return this.neighbors_[0]}}};n.prototype.neighborCCW=function(q){if(q===this.points_[0]){return this.neighbors_[2]}else{if(q===this.points_[1]){return this.neighbors_[0]}else{return this.neighbors_[1]}}};n.prototype.getConstrainedEdgeCW=function(q){if(q===this.points_[0]){return this.constrained_edge[1]}else{if(q===this.points_[1]){return this.constrained_edge[2]}else{return this.constrained_edge[0]}}};n.prototype.getConstrainedEdgeCCW=function(q){if(q===this.points_[0]){return this.constrained_edge[2]}else{if(q===this.points_[1]){return this.constrained_edge[0]}else{return this.constrained_edge[1]}}};n.prototype.getConstrainedEdgeAcross=function(q){if(q===this.points_[0]){return this.constrained_edge[0]}else{if(q===this.points_[1]){return this.constrained_edge[1]}else{return this.constrained_edge[2]}}};n.prototype.setConstrainedEdgeCW=function(r,q){if(r===this.points_[0]){this.constrained_edge[1]=q}else{if(r===this.points_[1]){this.constrained_edge[2]=q}else{this.constrained_edge[0]=q}}};n.prototype.setConstrainedEdgeCCW=function(r,q){if(r===this.points_[0]){this.constrained_edge[2]=q}else{if(r===this.points_[1]){this.constrained_edge[0]=q}else{this.constrained_edge[1]=q}}};n.prototype.getDelaunayEdgeCW=function(q){if(q===this.points_[0]){return this.delaunay_edge[1]}else{if(q===this.points_[1]){return this.delaunay_edge[2]}else{return this.delaunay_edge[0]}}};n.prototype.getDelaunayEdgeCCW=function(q){if(q===this.points_[0]){return this.delaunay_edge[2]}else{if(q===this.points_[1]){return this.delaunay_edge[0]}else{return this.delaunay_edge[1]}}};n.prototype.setDelaunayEdgeCW=function(r,q){if(r===this.points_[0]){this.delaunay_edge[1]=q}else{if(r===this.points_[1]){this.delaunay_edge[2]=q}else{this.delaunay_edge[0]=q}}};n.prototype.setDelaunayEdgeCCW=function(r,q){if(r===this.points_[0]){this.delaunay_edge[2]=q}else{if(r===this.points_[1]){this.delaunay_edge[0]=q}else{this.delaunay_edge[1]=q}}};n.prototype.neighborAcross=function(q){if(q===this.points_[0]){return this.neighbors_[0]}else{if(q===this.points_[1]){return this.neighbors_[1]}else{return this.neighbors_[2]}}};n.prototype.oppositePoint=function(r,s){var q=r.pointCW(s);return this.pointCW(q)};n.prototype.legalize=function(q,r){var s=this.points_;if(q===s[0]){s[1]=s[0];s[0]=s[2];s[2]=r}else{if(q===s[1]){s[2]=s[1];s[1]=s[0];s[0]=r}else{if(q===s[2]){s[0]=s[2];s[2]=s[1];s[1]=r}else{throw new Error("poly2tri Invalid Triangle.legalize() call")}}}};n.prototype.index=function(r){var q=this.points_;if(r===q[0]){return 0}else{if(r===q[1]){return 1}else{if(r===q[2]){return 2}else{throw new Error("poly2tri Invalid Triangle.index() call")}}}};n.prototype.edgeIndex=function(s,r){var q=this.points_;if(s===q[0]){if(r===q[1]){return 2}else{if(r===q[2]){return 1}}}else{if(s===q[1]){if(r===q[2]){return 0}else{if(r===q[0]){return 2}}}else{if(s===q[2]){if(r===q[0]){return 1}else{if(r===q[1]){return 0}}}}}return -1};n.prototype.markConstrainedEdgeByIndex=function(q){this.constrained_edge[q]=true};n.prototype.markConstrainedEdgeByEdge=function(q){this.markConstrainedEdgeByPoints(q.p,q.q)};n.prototype.markConstrainedEdgeByPoints=function(u,s){var r=this.points_;if((s===r[0]&&u===r[1])||(s===r[1]&&u===r[0])){this.constrained_edge[2]=true}else{if((s===r[0]&&u===r[2])||(s===r[2]&&u===r[0])){this.constrained_edge[1]=true}else{if((s===r[1]&&u===r[2])||(s===r[2]&&u===r[1])){this.constrained_edge[0]=true}}}};g.exports=n},{"./xy":10}],9:[function(n,j,g){var k=1e-12;var m={CW:1,CCW:-1,COLLINEAR:0};function q(u,s,r){var y=(u.x-r.x)*(s.y-r.y);var v=(u.y-r.y)*(s.x-r.x);var z=y-v;if(z>-(k)&&z<(k)){return m.COLLINEAR}else{if(z>0){return m.CCW}else{return m.CW}}}function e(v,u,s,r){var z=(v.x-u.x)*(r.y-u.y)-(r.x-u.x)*(v.y-u.y);if(z>=-k){return false}var y=(v.x-s.x)*(r.y-s.y)-(r.x-s.x)*(v.y-s.y);if(y<=k){return false}return true}j.exports={EPSILON:k,Orientation:m,orient2d:q,inScanArea:e}},{}],10:[function(k,g,e){function q(r){return("("+r.x+";"+r.y+")")}function n(u){var r=u.toString();return(r==="[object Object]"?q(u):r)}function m(s,r){if(s.y===r.y){return s.x-r.x}else{return s.y-r.y}}function j(s,r){return s.x===r.x&&s.y===r.y}g.exports={toString:n,toStringBase:q,compare:m,equals:j}},{}]},{},[5])(5)});(function(){var T=false;var aF=false;var Z=true;var a5=false;var aC={};var aE=false;if(typeof module!=="undefined"&&module.exports){module.exports=aC;aE=true}else{if(typeof(document)!=="undefined"){window.ClipperLib=aC}else{self.ClipperLib=aC}}var V;if(!aE){var H=navigator.userAgent.toString().toLowerCase();V=navigator.appName}else{var H="chrome";V="Netscape"}var bc={};if(H.indexOf("chrome")!=-1&&H.indexOf("chromium")==-1){bc.chrome=1}else{bc.chrome=0}if(H.indexOf("chromium")!=-1){bc.chromium=1}else{bc.chromium=0}if(H.indexOf("safari")!=-1&&H.indexOf("chrome")==-1&&H.indexOf("chromium")==-1){bc.safari=1}else{bc.safari=0}if(H.indexOf("firefox")!=-1){bc.firefox=1}else{bc.firefox=0}if(H.indexOf("firefox/17")!=-1){bc.firefox17=1}else{bc.firefox17=0}if(H.indexOf("firefox/15")!=-1){bc.firefox15=1}else{bc.firefox15=0}if(H.indexOf("firefox/3")!=-1){bc.firefox3=1}else{bc.firefox3=0}if(H.indexOf("opera")!=-1){bc.opera=1}else{bc.opera=0}if(H.indexOf("msie 10")!=-1){bc.msie10=1}else{bc.msie10=0}if(H.indexOf("msie 9")!=-1){bc.msie9=1}else{bc.msie9=0}if(H.indexOf("msie 8")!=-1){bc.msie8=1}else{bc.msie8=0}if(H.indexOf("msie 7")!=-1){bc.msie7=1}else{bc.msie7=0}if(H.indexOf("msie ")!=-1){bc.msie=1}else{bc.msie=0}if(H.indexOf("ejecta")!=-1){bc.safari=1}else{bc.safari=0}aC.biginteger_used=null;var by;var bd=244837814094590;var aX=((bd&16777215)==15715070);function bm(bD,bC,bE){aC.biginteger_used=1;if(bD!=null){if("number"==typeof bD&&"undefined"==typeof(bC)){this.fromInt(bD)}else{if("number"==typeof bD){this.fromNumber(bD,bC,bE)}else{if(bC==null&&"string"!=typeof bD){this.fromString(bD,256)}else{this.fromString(bD,bC)}}}}}function s(){return new bm(null)}function a(bG,bC,bD,bF,bI,bH){while(--bH>=0){var bE=bC*this[bG++]+bD[bF]+bI;bI=Math.floor(bE/67108864);bD[bF++]=bE&67108863}return bI}function bA(bG,bL,bM,bF,bJ,bC){var bI=bL&32767,bK=bL>>15;while(--bC>=0){var bE=this[bG]&32767;var bH=this[bG++]>>15;var bD=bK*bE+bH*bI;bE=bI*bE+((bD&32767)<<15)+bM[bF]+(bJ&1073741823);bJ=(bE>>>30)+(bD>>>15)+bK*bH+(bJ>>>30);bM[bF++]=bE&1073741823}return bJ}function bz(bG,bL,bM,bF,bJ,bC){var bI=bL&16383,bK=bL>>14;while(--bC>=0){var bE=this[bG]&16383;var bH=this[bG++]>>14;var bD=bK*bE+bH*bI;bE=bI*bE+((bD&16383)<<14)+bM[bF]+bJ;bJ=(bE>>28)+(bD>>14)+bK*bH;bM[bF++]=bE&268435455}return bJ}if(aX&&(V=="Microsoft Internet Explorer")){bm.prototype.am=bA;by=30}else{if(aX&&(V!="Netscape")){bm.prototype.am=a;by=26}else{bm.prototype.am=bz;by=28}}bm.prototype.DB=by;bm.prototype.DM=((1<<by)-1);bm.prototype.DV=(1<<by);var aZ=52;bm.prototype.FV=Math.pow(2,aZ);bm.prototype.F1=aZ-by;bm.prototype.F2=2*by-aZ;var a8="0123456789abcdefghijklmnopqrstuvwxyz";var bb=new Array();var bk,L;bk="0".charCodeAt(0);for(L=0;L<=9;++L){bb[bk++]=L}bk="a".charCodeAt(0);for(L=10;L<36;++L){bb[bk++]=L}bk="A".charCodeAt(0);for(L=10;L<36;++L){bb[bk++]=L}function bB(bC){return a8.charAt(bC)}function Y(bD,bC){var bE=bb[bD.charCodeAt(bC)];return(bE==null)?-1:bE}function aW(bD){for(var bC=this.t-1;bC>=0;--bC){bD[bC]=this[bC]}bD.t=this.t;bD.s=this.s}function E(bC){this.t=1;this.s=(bC<0)?-1:0;if(bC>0){this[0]=bC}else{if(bC<-1){this[0]=bC+this.DV}else{this.t=0}}}function e(bC){var bD=s();bD.fromInt(bC);return bD}function O(bI,bD){var bF;if(bD==16){bF=4}else{if(bD==8){bF=3}else{if(bD==256){bF=8}else{if(bD==2){bF=1}else{if(bD==32){bF=5}else{if(bD==4){bF=2}else{this.fromRadix(bI,bD);return}}}}}}this.t=0;this.s=0;var bH=bI.length,bE=false,bG=0;while(--bH>=0){var bC=(bF==8)?bI[bH]&255:Y(bI,bH);if(bC<0){if(bI.charAt(bH)=="-"){bE=true}continue}bE=false;if(bG==0){this[this.t++]=bC}else{if(bG+bF>this.DB){this[this.t-1]|=(bC&((1<<(this.DB-bG))-1))<<bG;this[this.t++]=(bC>>(this.DB-bG))}else{this[this.t-1]|=bC<<bG}}bG+=bF;if(bG>=this.DB){bG-=this.DB}}if(bF==8&&(bI[0]&128)!=0){this.s=-1;if(bG>0){this[this.t-1]|=((1<<(this.DB-bG))-1)<<bG}}this.clamp();if(bE){bm.ZERO.subTo(this,this)}}function ay(){var bC=this.s&this.DM;while(this.t>0&&this[this.t-1]==bC){--this.t}}function G(bD){if(this.s<0){return"-"+this.negate().toString(bD)}var bE;if(bD==16){bE=4}else{if(bD==8){bE=3}else{if(bD==2){bE=1}else{if(bD==32){bE=5}else{if(bD==4){bE=2}else{return this.toRadix(bD)}}}}}var bG=(1<<bE)-1,bJ,bC=false,bH="",bF=this.t;var bI=this.DB-(bF*this.DB)%bE;if(bF-->0){if(bI<this.DB&&(bJ=this[bF]>>bI)>0){bC=true;bH=bB(bJ)}while(bF>=0){if(bI<bE){bJ=(this[bF]&((1<<bI)-1))<<(bE-bI);bJ|=this[--bF]>>(bI+=this.DB-bE)}else{bJ=(this[bF]>>(bI-=bE))&bG;if(bI<=0){bI+=this.DB;--bF}}if(bJ>0){bC=true}if(bC){bH+=bB(bJ)}}}return bC?bH:"0"}function aD(){var bC=s();bm.ZERO.subTo(this,bC);return bC}function bg(){return(this.s<0)?this.negate():this}function aj(bC){var bE=this.s-bC.s;if(bE!=0){return bE}var bD=this.t;bE=bD-bC.t;if(bE!=0){return(this.s<0)?-bE:bE}while(--bD>=0){if((bE=this[bD]-bC[bD])!=0){return bE}}return 0}function A(bC){var bE=1,bD;if((bD=bC>>>16)!=0){bC=bD;bE+=16}if((bD=bC>>8)!=0){bC=bD;bE+=8}if((bD=bC>>4)!=0){bC=bD;bE+=4}if((bD=bC>>2)!=0){bC=bD;bE+=2}if((bD=bC>>1)!=0){bC=bD;bE+=1}return bE}function K(){if(this.t<=0){return 0}return this.DB*(this.t-1)+A(this[this.t-1]^(this.s&this.DM))}function bl(bE,bD){var bC;for(bC=this.t-1;bC>=0;--bC){bD[bC+bE]=this[bC]}for(bC=bE-1;bC>=0;--bC){bD[bC]=0}bD.t=this.t+bE;bD.s=this.s}function aV(bE,bD){for(var bC=bE;bC<this.t;++bC){bD[bC-bE]=this[bC]}bD.t=Math.max(this.t-bE,0);bD.s=this.s}function J(bJ,bF){var bD=bJ%this.DB;var bC=this.DB-bD;var bH=(1<<bC)-1;var bG=Math.floor(bJ/this.DB),bI=(this.s<<bD)&this.DM,bE;for(bE=this.t-1;bE>=0;--bE){bF[bE+bG+1]=(this[bE]>>bC)|bI;bI=(this[bE]&bH)<<bD}for(bE=bG-1;bE>=0;--bE){bF[bE]=0}bF[bG]=bI;bF.t=this.t+bG+1;bF.s=this.s;bF.clamp()}function B(bI,bF){bF.s=this.s;var bG=Math.floor(bI/this.DB);if(bG>=this.t){bF.t=0;return}var bD=bI%this.DB;var bC=this.DB-bD;var bH=(1<<bD)-1;bF[0]=this[bG]>>bD;for(var bE=bG+1;bE<this.t;++bE){bF[bE-bG-1]|=(this[bE]&bH)<<bC;bF[bE-bG]=this[bE]>>bD}if(bD>0){bF[this.t-bG-1]|=(this.s&bH)<<bC}bF.t=this.t-bG;bF.clamp()}function a0(bD,bF){var bE=0,bG=0,bC=Math.min(bD.t,this.t);while(bE<bC){bG+=this[bE]-bD[bE];bF[bE++]=bG&this.DM;bG>>=this.DB}if(bD.t<this.t){bG-=bD.s;while(bE<this.t){bG+=this[bE];bF[bE++]=bG&this.DM;bG>>=this.DB}bG+=this.s}else{bG+=this.s;while(bE<bD.t){bG-=bD[bE];bF[bE++]=bG&this.DM;bG>>=this.DB}bG-=bD.s}bF.s=(bG<0)?-1:0;if(bG<-1){bF[bE++]=this.DV+bG}else{if(bG>0){bF[bE++]=bG}}bF.t=bE;bF.clamp()}function ae(bD,bF){var bC=this.abs(),bG=bD.abs();var bE=bC.t;bF.t=bE+bG.t;while(--bE>=0){bF[bE]=0}for(bE=0;bE<bG.t;++bE){bF[bE+bC.t]=bC.am(0,bG[bE],bF,bE,0,bC.t)}bF.s=0;bF.clamp();if(this.s!=bD.s){bm.ZERO.subTo(bF,bF)}}function aA(bE){var bC=this.abs();var bD=bE.t=2*bC.t;while(--bD>=0){bE[bD]=0}for(bD=0;bD<bC.t-1;++bD){var bF=bC.am(bD,bC[bD],bE,2*bD,0,1);if((bE[bD+bC.t]+=bC.am(bD+1,2*bC[bD],bE,2*bD+1,bF,bC.t-bD-1))>=bC.DV){bE[bD+bC.t]-=bC.DV;bE[bD+bC.t+1]=1}}if(bE.t>0){bE[bE.t-1]+=bC.am(bD,bC[bD],bE,2*bD,0,1)}bE.s=0;bE.clamp()}function af(bL,bI,bH){var bR=bL.abs();if(bR.t<=0){return}var bJ=this.abs();if(bJ.t<bR.t){if(bI!=null){bI.fromInt(0)}if(bH!=null){this.copyTo(bH)}return}if(bH==null){bH=s()}var bF=s(),bC=this.s,bK=bL.s;var bQ=this.DB-A(bR[bR.t-1]);if(bQ>0){bR.lShiftTo(bQ,bF);bJ.lShiftTo(bQ,bH)}else{bR.copyTo(bF);bJ.copyTo(bH)}var bN=bF.t;var bD=bF[bN-1];if(bD==0){return}var bM=bD*(1<<this.F1)+((bN>1)?bF[bN-2]>>this.F2:0);var bU=this.FV/bM,bT=(1<<this.F1)/bM,bS=1<<this.F2;var bP=bH.t,bO=bP-bN,bG=(bI==null)?s():bI;bF.dlShiftTo(bO,bG);if(bH.compareTo(bG)>=0){bH[bH.t++]=1;bH.subTo(bG,bH)}bm.ONE.dlShiftTo(bN,bG);bG.subTo(bF,bF);while(bF.t<bN){bF[bF.t++]=0}while(--bO>=0){var bE=(bH[--bP]==bD)?this.DM:Math.floor(bH[bP]*bU+(bH[bP-1]+bS)*bT);if((bH[bP]+=bF.am(0,bE,bH,bO,0,bN))<bE){bF.dlShiftTo(bO,bG);bH.subTo(bG,bH);while(bH[bP]<--bE){bH.subTo(bG,bH)}}}if(bI!=null){bH.drShiftTo(bN,bI);if(bC!=bK){bm.ZERO.subTo(bI,bI)}}bH.t=bN;bH.clamp();if(bQ>0){bH.rShiftTo(bQ,bH)}if(bC<0){bm.ZERO.subTo(bH,bH)}}function ax(bC){var bD=s();this.abs().divRemTo(bC,null,bD);if(this.s<0&&bD.compareTo(bm.ZERO)>0){bC.subTo(bD,bD)}return bD}function an(bC){this.m=bC}function aR(bC){if(bC.s<0||bC.compareTo(this.m)>=0){return bC.mod(this.m)}else{return bC}}function bf(bC){return bC}function al(bC){bC.divRemTo(this.m,null,bC)}function ak(bC,bE,bD){bC.multiplyTo(bE,bD);this.reduce(bD)}function br(bC,bD){bC.squareTo(bD);this.reduce(bD)}an.prototype.convert=aR;an.prototype.revert=bf;an.prototype.reduce=al;an.prototype.mulTo=ak;an.prototype.sqrTo=br;function ab(){if(this.t<1){return 0}var bC=this[0];if((bC&1)==0){return 0}var bD=bC&3;bD=(bD*(2-(bC&15)*bD))&15;bD=(bD*(2-(bC&255)*bD))&255;bD=(bD*(2-(((bC&65535)*bD)&65535)))&65535;bD=(bD*(2-bC*bD%this.DV))%this.DV;return(bD>0)?this.DV-bD:-bD}function k(bC){this.m=bC;this.mp=bC.invDigit();this.mpl=this.mp&32767;this.mph=this.mp>>15;this.um=(1<<(bC.DB-15))-1;this.mt2=2*bC.t}function be(bC){var bD=s();bC.abs().dlShiftTo(this.m.t,bD);bD.divRemTo(this.m,null,bD);if(bC.s<0&&bD.compareTo(bm.ZERO)>0){this.m.subTo(bD,bD)}return bD}function bp(bC){var bD=s();bC.copyTo(bD);this.reduce(bD);return bD}function az(bC){while(bC.t<=this.mt2){bC[bC.t++]=0}for(var bE=0;bE<this.m.t;++bE){var bD=bC[bE]&32767;var bF=(bD*this.mpl+(((bD*this.mph+(bC[bE]>>15)*this.mpl)&this.um)<<15))&bC.DM;bD=bE+this.m.t;bC[bD]+=this.m.am(0,bF,bC,bE,0,this.m.t);while(bC[bD]>=bC.DV){bC[bD]-=bC.DV;bC[++bD]++}}bC.clamp();bC.drShiftTo(this.m.t,bC);if(bC.compareTo(this.m)>=0){bC.subTo(this.m,bC)}}function bh(bC,bD){bC.squareTo(bD);this.reduce(bD)}function X(bC,bE,bD){bC.multiplyTo(bE,bD);this.reduce(bD)}k.prototype.convert=be;k.prototype.revert=bp;k.prototype.reduce=az;k.prototype.mulTo=X;k.prototype.sqrTo=bh;function u(){return((this.t>0)?(this[0]&1):this.s)==0}function P(bH,bI){if(bH>4294967295||bH<1){return bm.ONE}var bG=s(),bC=s(),bF=bI.convert(this),bE=A(bH)-1;bF.copyTo(bG);while(--bE>=0){bI.sqrTo(bG,bC);if((bH&(1<<bE))>0){bI.mulTo(bC,bF,bG)}else{var bD=bG;bG=bC;bC=bD}}return bI.revert(bG)}function bj(bD,bC){var bE;if(bD<256||bC.isEven()){bE=new an(bC)}else{bE=new k(bC)}return this.exp(bD,bE)}bm.prototype.copyTo=aW;bm.prototype.fromInt=E;bm.prototype.fromString=O;bm.prototype.clamp=ay;bm.prototype.dlShiftTo=bl;bm.prototype.drShiftTo=aV;bm.prototype.lShiftTo=J;bm.prototype.rShiftTo=B;bm.prototype.subTo=a0;bm.prototype.multiplyTo=ae;bm.prototype.squareTo=aA;bm.prototype.divRemTo=af;bm.prototype.invDigit=ab;bm.prototype.isEven=u;bm.prototype.exp=P;bm.prototype.toString=G;bm.prototype.negate=aD;bm.prototype.abs=bg;bm.prototype.compareTo=aj;bm.prototype.bitLength=K;bm.prototype.mod=ax;bm.prototype.modPowInt=bj;bm.ZERO=e(0);bm.ONE=e(1);function q(){var bC=s();this.copyTo(bC);return bC}function ah(){if(this.s<0){if(this.t==1){return this[0]-this.DV}else{if(this.t==0){return -1}}}else{if(this.t==1){return this[0]}else{if(this.t==0){return 0}}}return((this[1]&((1<<(32-this.DB))-1))<<this.DB)|this[0]}function a9(){return(this.t==0)?this.s:(this[0]<<24)>>24}function aB(){return(this.t==0)?this.s:(this[0]<<16)>>16}function aU(bC){return Math.floor(Math.LN2*this.DB/Math.log(bC))}function bn(){if(this.s<0){return -1}else{if(this.t<=0||(this.t==1&&this[0]<=0)){return 0}else{return 1}}}function U(bC){if(bC==null){bC=10}if(this.signum()==0||bC<2||bC>36){return"0"}var bE=this.chunkSize(bC);var bD=Math.pow(bC,bE);var bH=e(bD),bI=s(),bG=s(),bF="";this.divRemTo(bH,bI,bG);while(bI.signum()>0){bF=(bD+bG.intValue()).toString(bC).substr(1)+bF;bI.divRemTo(bH,bI,bG)}return bG.intValue().toString(bC)+bF}function aL(bK,bH){this.fromInt(0);if(bH==null){bH=10}var bF=this.chunkSize(bH);var bG=Math.pow(bH,bF),bE=false,bC=0,bJ=0;for(var bD=0;bD<bK.length;++bD){var bI=Y(bK,bD);if(bI<0){if(bK.charAt(bD)=="-"&&this.signum()==0){bE=true}continue}bJ=bH*bJ+bI;if(++bC>=bF){this.dMultiply(bG);this.dAddOffset(bJ,0);bC=0;bJ=0}}if(bC>0){this.dMultiply(Math.pow(bH,bC));this.dAddOffset(bJ,0)}if(bE){bm.ZERO.subTo(this,this)}}function a7(bE,bD,bG){if("number"==typeof bD){if(bE<2){this.fromInt(1)}else{this.fromNumber(bE,bG);if(!this.testBit(bE-1)){this.bitwiseTo(bm.ONE.shiftLeft(bE-1),ap,this)}if(this.isEven()){this.dAddOffset(1,0)}while(!this.isProbablePrime(bD)){this.dAddOffset(2,0);if(this.bitLength()>bE){this.subTo(bm.ONE.shiftLeft(bE-1),this)}}}}else{var bC=new Array(),bF=bE&7;bC.length=(bE>>3)+1;bD.nextBytes(bC);if(bF>0){bC[0]&=((1<<bF)-1)}else{bC[0]=0}this.fromString(bC,256)}}function bv(){var bD=this.t,bE=new Array();bE[0]=this.s;var bF=this.DB-(bD*this.DB)%8,bG,bC=0;if(bD-->0){if(bF<this.DB&&(bG=this[bD]>>bF)!=(this.s&this.DM)>>bF){bE[bC++]=bG|(this.s<<(this.DB-bF))}while(bD>=0){if(bF<8){bG=(this[bD]&((1<<bF)-1))<<(8-bF);bG|=this[--bD]>>(bF+=this.DB-8)}else{bG=(this[bD]>>(bF-=8))&255;if(bF<=0){bF+=this.DB;--bD}}if((bG&128)!=0){bG|=-256}if(bC==0&&(this.s&128)!=(bG&128)){++bC}if(bC>0||bG!=this.s){bE[bC++]=bG}}}return bE}function aH(bC){return(this.compareTo(bC)==0)}function ai(bC){return(this.compareTo(bC)<0)?this:bC}function aP(bC){return(this.compareTo(bC)>0)?this:bC}function a6(bD,bH,bF){var bE,bG,bC=Math.min(bD.t,this.t);for(bE=0;bE<bC;++bE){bF[bE]=bH(this[bE],bD[bE])}if(bD.t<this.t){bG=bD.s&this.DM;for(bE=bC;bE<this.t;++bE){bF[bE]=bH(this[bE],bG)}bF.t=this.t}else{bG=this.s&this.DM;for(bE=bC;bE<bD.t;++bE){bF[bE]=bH(bG,bD[bE])}bF.t=bD.t}bF.s=bH(this.s,bD.s);bF.clamp()}function W(bC,bD){return bC&bD}function bx(bC){var bD=s();this.bitwiseTo(bC,W,bD);return bD}function ap(bC,bD){return bC|bD}function aT(bC){var bD=s();this.bitwiseTo(bC,ap,bD);return bD}function ac(bC,bD){return bC^bD}function g(bC){var bD=s();this.bitwiseTo(bC,ac,bD);return bD}function M(bC,bD){return bC&~bD}function C(bC){var bD=s();this.bitwiseTo(bC,M,bD);return bD}function ad(){var bD=s();for(var bC=0;bC<this.t;++bC){bD[bC]=this.DM&~this[bC]}bD.t=this.t;bD.s=~this.s;return bD}function N(bD){var bC=s();if(bD<0){this.rShiftTo(-bD,bC)}else{this.lShiftTo(bD,bC)}return bC}function bw(bD){var bC=s();if(bD<0){this.lShiftTo(-bD,bC)}else{this.rShiftTo(bD,bC)}return bC}function y(bC){if(bC==0){return -1}var bD=0;if((bC&65535)==0){bC>>=16;bD+=16}if((bC&255)==0){bC>>=8;bD+=8}if((bC&15)==0){bC>>=4;bD+=4}if((bC&3)==0){bC>>=2;bD+=2}if((bC&1)==0){++bD}return bD}function F(){for(var bC=0;bC<this.t;++bC){if(this[bC]!=0){return bC*this.DB+y(this[bC])}}if(this.s<0){return this.t*this.DB}return -1}function bi(bC){var bD=0;while(bC!=0){bC&=bC-1;++bD}return bD}function a4(){var bE=0,bC=this.s&this.DM;for(var bD=0;bD<this.t;++bD){bE+=bi(this[bD]^bC)}return bE}function a2(bD){var bC=Math.floor(bD/this.DB);if(bC>=this.t){return(this.s!=0)}return((this[bC]&(1<<(bD%this.DB)))!=0)}function ag(bE,bD){var bC=bm.ONE.shiftLeft(bE);this.bitwiseTo(bC,bD,bC);return bC}function aa(bC){return this.changeBit(bC,ap)}function D(bC){return this.changeBit(bC,M)}function d(bC){return this.changeBit(bC,ac)}function aM(bD,bF){var bE=0,bG=0,bC=Math.min(bD.t,this.t);while(bE<bC){bG+=this[bE]+bD[bE];bF[bE++]=bG&this.DM;bG>>=this.DB}if(bD.t<this.t){bG+=bD.s;while(bE<this.t){bG+=this[bE];bF[bE++]=bG&this.DM;bG>>=this.DB}bG+=this.s}else{bG+=this.s;while(bE<bD.t){bG+=bD[bE];bF[bE++]=bG&this.DM;bG>>=this.DB}bG+=bD.s}bF.s=(bG<0)?-1:0;if(bG>0){bF[bE++]=bG}else{if(bG<-1){bF[bE++]=this.DV+bG}}bF.t=bE;bF.clamp()}function aO(bC){var bD=s();this.addTo(bC,bD);return bD}function bo(bC){var bD=s();this.subTo(bC,bD);return bD}function aG(bC){var bD=s();this.multiplyTo(bC,bD);return bD}function a1(){var bC=s();this.squareTo(bC);return bC}function f(bC){var bD=s();this.divRemTo(bC,bD,null);return bD}function n(bC){var bD=s();this.divRemTo(bC,null,bD);return bD}function a3(bC){var bE=s(),bD=s();this.divRemTo(bC,bE,bD);return new Array(bE,bD)}function v(bC){this[this.t]=this.am(0,bC-1,this,0,0,this.t);++this.t;this.clamp()}function aw(bD,bC){if(bD==0){return}while(this.t<=bC){this[this.t++]=0}this[bC]+=bD;while(this[bC]>=this.DV){this[bC]-=this.DV;if(++bC>=this.t){this[this.t++]=0}++this[bC]}}function aN(){}function ba(bC){return bC}function z(bC,bE,bD){bC.multiplyTo(bE,bD)}function aS(bC,bD){bC.squareTo(bD)}aN.prototype.convert=ba;aN.prototype.revert=ba;aN.prototype.mulTo=z;aN.prototype.sqrTo=aS;function R(bC){return this.exp(bC,new aN())}function r(bC,bG,bF){var bE=Math.min(this.t+bC.t,bG);bF.s=0;bF.t=bE;while(bE>0){bF[--bE]=0}var bD;for(bD=bF.t-this.t;bE<bD;++bE){bF[bE+this.t]=this.am(0,bC[bE],bF,bE,0,this.t)}for(bD=Math.min(bC.t,bG);bE<bD;++bE){this.am(0,bC[bE],bF,bE,0,bG-bE)}bF.clamp()}function j(bC,bF,bE){--bF;var bD=bE.t=this.t+bC.t-bF;bE.s=0;while(--bD>=0){bE[bD]=0}for(bD=Math.max(bF-this.t,0);bD<bC.t;++bD){bE[this.t+bD-bF]=this.am(bF-bD,bC[bD],bE,0,0,this.t+bD-bF)}bE.clamp();bE.drShiftTo(1,bE)}function S(bC){this.r2=s();this.q3=s();bm.ONE.dlShiftTo(2*bC.t,this.r2);this.mu=this.r2.divide(bC);this.m=bC}function am(bC){if(bC.s<0||bC.t>2*this.m.t){return bC.mod(this.m)}else{if(bC.compareTo(this.m)<0){return bC}else{var bD=s();bC.copyTo(bD);this.reduce(bD);return bD}}}function ar(bC){return bC}function bs(bC){bC.drShiftTo(this.m.t-1,this.r2);if(bC.t>this.m.t+1){bC.t=this.m.t+1;bC.clamp()}this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3);this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);while(bC.compareTo(this.r2)<0){bC.dAddOffset(1,this.m.t+1)}bC.subTo(this.r2,bC);while(bC.compareTo(this.m)>=0){bC.subTo(this.m,bC)}}function aI(bC,bD){bC.squareTo(bD);this.reduce(bD)}function bu(bC,bE,bD){bC.multiplyTo(bE,bD);this.reduce(bD)}S.prototype.convert=am;S.prototype.revert=ar;S.prototype.reduce=bs;S.prototype.mulTo=bu;S.prototype.sqrTo=aI;function aQ(bL,bG){var bJ=bL.bitLength(),bH,bD=e(1),bO;if(bJ<=0){return bD}else{if(bJ<18){bH=1}else{if(bJ<48){bH=3}else{if(bJ<144){bH=4}else{if(bJ<768){bH=5}else{bH=6}}}}}if(bJ<8){bO=new an(bG)}else{if(bG.isEven()){bO=new S(bG)}else{bO=new k(bG)}}var bK=new Array(),bF=3,bM=bH-1,bC=(1<<bH)-1;bK[1]=bO.convert(this);if(bH>1){var bR=s();bO.sqrTo(bK[1],bR);while(bF<=bC){bK[bF]=s();bO.mulTo(bR,bK[bF-2],bK[bF]);bF+=2}}var bI=bL.t-1,bP,bN=true,bE=s(),bQ;bJ=A(bL[bI])-1;while(bI>=0){if(bJ>=bM){bP=(bL[bI]>>(bJ-bM))&bC}else{bP=(bL[bI]&((1<<(bJ+1))-1))<<(bM-bJ);if(bI>0){bP|=bL[bI-1]>>(this.DB+bJ-bM)}}bF=bH;while((bP&1)==0){bP>>=1;--bF}if((bJ-=bF)<0){bJ+=this.DB;--bI}if(bN){bK[bP].copyTo(bD);bN=false}else{while(bF>1){bO.sqrTo(bD,bE);bO.sqrTo(bE,bD);bF-=2}if(bF>0){bO.sqrTo(bD,bE)}else{bQ=bD;bD=bE;bE=bQ}bO.mulTo(bE,bK[bP],bD)}while(bI>=0&&(bL[bI]&(1<<bJ))==0){bO.sqrTo(bD,bE);bQ=bD;bD=bE;bE=bQ;if(--bJ<0){bJ=this.DB-1;--bI}}}return bO.revert(bD)}function bq(bD){var bC=(this.s<0)?this.negate():this.clone();var bH=(bD.s<0)?bD.negate():bD.clone();if(bC.compareTo(bH)<0){var bF=bC;bC=bH;bH=bF}var bE=bC.getLowestSetBit(),bG=bH.getLowestSetBit();if(bG<0){return bC}if(bE<bG){bG=bE}if(bG>0){bC.rShiftTo(bG,bC);bH.rShiftTo(bG,bH)}while(bC.signum()>0){if((bE=bC.getLowestSetBit())>0){bC.rShiftTo(bE,bC)}if((bE=bH.getLowestSetBit())>0){bH.rShiftTo(bE,bH)}if(bC.compareTo(bH)>=0){bC.subTo(bH,bC);bC.rShiftTo(1,bC)}else{bH.subTo(bC,bH);bH.rShiftTo(1,bH)}}if(bG>0){bH.lShiftTo(bG,bH)}return bH}function I(bF){if(bF<=0){return 0}var bE=this.DV%bF,bD=(this.s<0)?bF-1:0;if(this.t>0){if(bE==0){bD=this[0]%bF}else{for(var bC=this.t-1;bC>=0;--bC){bD=(bE*bD+this[bC])%bF}}}return bD}function b(bD){var bH=bD.isEven();if((this.isEven()&&bH)||bD.signum()==0){return bm.ZERO}var bG=bD.clone(),bF=this.clone();var bE=e(1),bC=e(0),bJ=e(0),bI=e(1);while(bG.signum()!=0){while(bG.isEven()){bG.rShiftTo(1,bG);if(bH){if(!bE.isEven()||!bC.isEven()){bE.addTo(this,bE);bC.subTo(bD,bC)}bE.rShiftTo(1,bE)}else{if(!bC.isEven()){bC.subTo(bD,bC)}}bC.rShiftTo(1,bC)}while(bF.isEven()){bF.rShiftTo(1,bF);if(bH){if(!bJ.isEven()||!bI.isEven()){bJ.addTo(this,bJ);bI.subTo(bD,bI)}bJ.rShiftTo(1,bJ)}else{if(!bI.isEven()){bI.subTo(bD,bI)}}bI.rShiftTo(1,bI)}if(bG.compareTo(bF)>=0){bG.subTo(bF,bG);if(bH){bE.subTo(bJ,bE)}bC.subTo(bI,bC)}else{bF.subTo(bG,bF);if(bH){bJ.subTo(bE,bJ)}bI.subTo(bC,bI)}}if(bF.compareTo(bm.ONE)!=0){return bm.ZERO}if(bI.compareTo(bD)>=0){return bI.subtract(bD)}if(bI.signum()<0){bI.addTo(bD,bI)}else{return bI}if(bI.signum()<0){return bI.add(bD)}else{return bI}}var aJ=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997];var aK=(1<<26)/aJ[aJ.length-1];function ao(bG){var bF,bD=this.abs();if(bD.t==1&&bD[0]<=aJ[aJ.length-1]){for(bF=0;bF<aJ.length;++bF){if(bD[0]==aJ[bF]){return true}}return false}if(bD.isEven()){return false}bF=1;while(bF<aJ.length){var bC=aJ[bF],bE=bF+1;while(bE<aJ.length&&bC<aK){bC*=aJ[bE++]}bC=bD.modInt(bC);while(bF<bE){if(bC%aJ[bF++]==0){return false}}}return bD.millerRabin(bG)}function m(bG){var bH=this.subtract(bm.ONE);var bD=bH.getLowestSetBit();if(bD<=0){return false}var bI=bH.shiftRight(bD);bG=(bG+1)>>1;if(bG>aJ.length){bG=aJ.length}var bC=s();for(var bF=0;bF<bG;++bF){bC.fromInt(aJ[Math.floor(Math.random()*aJ.length)]);var bJ=bC.modPow(bI,this);if(bJ.compareTo(bm.ONE)!=0&&bJ.compareTo(bH)!=0){var bE=1;while(bE++<bD&&bJ.compareTo(bH)!=0){bJ=bJ.modPowInt(2,this);if(bJ.compareTo(bm.ONE)==0){return false}}if(bJ.compareTo(bH)!=0){return false}}}return true}bm.prototype.chunkSize=aU;bm.prototype.toRadix=U;bm.prototype.fromRadix=aL;bm.prototype.fromNumber=a7;bm.prototype.bitwiseTo=a6;bm.prototype.changeBit=ag;bm.prototype.addTo=aM;bm.prototype.dMultiply=v;bm.prototype.dAddOffset=aw;bm.prototype.multiplyLowerTo=r;bm.prototype.multiplyUpperTo=j;bm.prototype.modInt=I;bm.prototype.millerRabin=m;bm.prototype.clone=q;bm.prototype.intValue=ah;bm.prototype.byteValue=a9;bm.prototype.shortValue=aB;bm.prototype.signum=bn;bm.prototype.toByteArray=bv;bm.prototype.equals=aH;bm.prototype.min=ai;bm.prototype.max=aP;bm.prototype.and=bx;bm.prototype.or=aT;bm.prototype.xor=g;bm.prototype.andNot=C;bm.prototype.not=ad;bm.prototype.shiftLeft=N;bm.prototype.shiftRight=bw;bm.prototype.getLowestSetBit=F;bm.prototype.bitCount=a4;bm.prototype.testBit=a2;bm.prototype.setBit=aa;bm.prototype.clearBit=D;bm.prototype.flipBit=d;bm.prototype.add=aO;bm.prototype.subtract=bo;bm.prototype.multiply=aG;bm.prototype.divide=f;bm.prototype.remainder=n;bm.prototype.divideAndRemainder=a3;bm.prototype.modPow=aQ;bm.prototype.modInverse=b;bm.prototype.pow=R;bm.prototype.gcd=bq;bm.prototype.isProbablePrime=ao;bm.prototype.square=a1;var aY=bm;aY.prototype.IsNegative=function(){if(this.compareTo(aY.ZERO)==-1){return true}else{return false}};aY.op_Equality=function(bD,bC){if(bD.compareTo(bC)==0){return true}else{return false}};aY.op_Inequality=function(bD,bC){if(bD.compareTo(bC)!=0){return true}else{return false}};aY.op_GreaterThan=function(bD,bC){if(bD.compareTo(bC)>0){return true}else{return false}};aY.op_LessThan=function(bD,bC){if(bD.compareTo(bC)<0){return true}else{return false}};aY.op_Addition=function(bC,bD){return new aY(bC).add(new aY(bD))};aY.op_Subtraction=function(bC,bD){return new aY(bC).subtract(new aY(bD))};aY.Int128Mul=function(bC,bD){return new aY(bC).multiply(new aY(bD))};aY.op_Division=function(bC,bD){return bC.divide(bD)};aY.prototype.ToDouble=function(){return parseFloat(this.toString())};if(typeof(bt)=="undefined"){var bt=function(bG,bF){var bE;if(typeof(Object.getOwnPropertyNames)=="undefined"){for(bE in bF.prototype){if(typeof(bG.prototype[bE])=="undefined"||bG.prototype[bE]==Object.prototype[bE]){bG.prototype[bE]=bF.prototype[bE]}}for(bE in bF){if(typeof(bG[bE])=="undefined"){bG[bE]=bF[bE]}}bG.$baseCtor=bF}else{var bD=Object.getOwnPropertyNames(bF.prototype);for(var bC=0;bC<bD.length;bC++){if(typeof(Object.getOwnPropertyDescriptor(bG.prototype,bD[bC]))=="undefined"){Object.defineProperty(bG.prototype,bD[bC],Object.getOwnPropertyDescriptor(bF.prototype,bD[bC]))}}for(bE in bF){if(typeof(bG[bE])=="undefined"){bG[bE]=bF[bE]}}bG.$baseCtor=bF}}}aC.Path=function(){return[]};aC.Paths=function(){return[]};aC.DoublePoint=function(){var bC=arguments;this.x=0;this.y=0;if(bC.length==1){this.x=bC[0].x;this.y=bC[0].y}else{if(bC.length==2){this.x=bC[0];this.y=bC[1]}}};aC.DoublePoint0=function(){this.x=0;this.y=0};aC.DoublePoint1=function(bC){this.x=bC.x;this.y=bC.y};aC.DoublePoint2=function(bC,bD){this.x=bC;this.y=bD};aC.PolyNode=function(){this.m_Parent=null;this.m_polygon=new aC.Path();this.m_Index=0;this.m_jointype=0;this.m_endtype=0;this.m_Childs=[];this.IsOpen=false};aC.PolyNode.prototype.IsHoleNode=function(){var bC=true;var bD=this.m_Parent;while(bD!==null){bC=!bC;bD=bD.m_Parent}return bC};aC.PolyNode.prototype.ChildCount=function(){return this.m_Childs.length};aC.PolyNode.prototype.Contour=function(){return this.m_polygon};aC.PolyNode.prototype.AddChild=function(bD){var bC=this.m_Childs.length;this.m_Childs.push(bD);bD.m_Parent=this;bD.m_Index=bC};aC.PolyNode.prototype.GetNext=function(){if(this.m_Childs.length>0){return this.m_Childs[0]}else{return this.GetNextSiblingUp()}};aC.PolyNode.prototype.GetNextSiblingUp=function(){if(this.m_Parent===null){return null}else{if(this.m_Index==this.m_Parent.m_Childs.length-1){return this.m_Parent.GetNextSiblingUp()}else{return this.m_Parent.m_Childs[this.m_Index+1]}}};aC.PolyNode.prototype.Childs=function(){return this.m_Childs};aC.PolyNode.prototype.Parent=function(){return this.m_Parent};aC.PolyNode.prototype.IsHole=function(){return this.IsHoleNode()};aC.PolyTree=function(){this.m_AllPolys=[];aC.PolyNode.call(this)};aC.PolyTree.prototype.Clear=function(){for(var bD=0,bC=this.m_AllPolys.length;bD<bC;bD++){this.m_AllPolys[bD]=null}this.m_AllPolys.length=0;this.m_Childs.length=0};aC.PolyTree.prototype.GetFirst=function(){if(this.m_Childs.length>0){return this.m_Childs[0]}else{return null}};aC.PolyTree.prototype.Total=function(){return this.m_AllPolys.length};bt(aC.PolyTree,aC.PolyNode);aC.Math_Abs_Int64=aC.Math_Abs_Int32=aC.Math_Abs_Double=function(bC){return Math.abs(bC)};aC.Math_Max_Int32_Int32=function(bD,bC){return Math.max(bD,bC)};if(bc.msie||bc.opera||bc.safari){aC.Cast_Int32=function(bC){return bC|0}}else{aC.Cast_Int32=function(bC){return ~~bC}}if(bc.chrome){aC.Cast_Int64=function(bC){if(bC<-2147483648||bC>2147483647){return bC<0?Math.ceil(bC):Math.floor(bC)}else{return ~~bC}}}else{if(bc.firefox&&typeof(Number.toInteger)=="function"){aC.Cast_Int64=function(bC){return Number.toInteger(bC)}}else{if(bc.msie7||bc.msie8){aC.Cast_Int64=function(bC){return parseInt(bC,10)}}else{if(bc.msie){aC.Cast_Int64=function(bC){if(bC<-2147483648||bC>2147483647){return bC<0?Math.ceil(bC):Math.floor(bC)}return bC|0}}else{aC.Cast_Int64=function(bC){return bC<0?Math.ceil(bC):Math.floor(bC)}}}}}aC.Clear=function(bC){bC.length=0};aC.PI=3.141592653589793;aC.PI2=2*3.141592653589793;aC.IntPoint=function(){var bC=arguments,bD=bC.length;this.x=0;this.y=0;if(aF){this.z=0;if(bD==3){this.x=bC[0];this.y=bC[1];this.z=bC[2]}else{if(bD==2){this.x=bC[0];this.y=bC[1];this.z=0}else{if(bD==1){if(bC[0] instanceof aC.DoublePoint){var bF=bC[0];this.x=aC.Clipper.Round(bF.x);this.y=aC.Clipper.Round(bF.y);this.z=0}else{var bE=bC[0];if(typeof(bE.z)=="undefined"){bE.z=0}this.x=bE.x;this.y=bE.y;this.z=bE.z}}else{this.x=0;this.y=0;this.z=0}}}}else{if(bD==2){this.x=bC[0];this.y=bC[1]}else{if(bD==1){if(bC[0] instanceof aC.DoublePoint){var bF=bC[0];this.x=aC.Clipper.Round(bF.x);this.y=aC.Clipper.Round(bF.y)}else{var bE=bC[0];this.x=bE.x;this.y=bE.y}}else{this.x=0;this.y=0}}}};aC.IntPoint.op_Equality=function(bD,bC){return bD.x==bC.x&&bD.y==bC.y};aC.IntPoint.op_Inequality=function(bD,bC){return bD.x!=bC.x||bD.y!=bC.y};if(aF){aC.IntPoint0=function(){this.x=0;this.y=0;this.z=0};aC.IntPoint1=function(bC){this.x=bC.x;this.y=bC.y;this.z=bC.z};aC.IntPoint1dp=function(bC){this.x=aC.Clipper.Round(bC.x);this.y=aC.Clipper.Round(bC.y);this.z=0};aC.IntPoint2=function(bC,bD){this.x=bC;this.y=bD;this.z=0};aC.IntPoint3=function(bC,bE,bD){this.x=bC;this.y=bE;this.z=bD}}else{aC.IntPoint0=function(){this.x=0;this.y=0};aC.IntPoint1=function(bC){this.x=bC.x;this.y=bC.y};aC.IntPoint1dp=function(bC){this.x=aC.Clipper.Round(bC.x);this.y=aC.Clipper.Round(bC.y)};aC.IntPoint2=function(bC,bD){this.x=bC;this.y=bD}}aC.IntRect=function(){var bC=arguments,bD=bC.length;if(bD==4){this.left=bC[0];this.top=bC[1];this.right=bC[2];this.bottom=bC[3]}else{if(bD==1){this.left=ir.left;this.top=ir.top;this.right=ir.right;this.bottom=ir.bottom}else{this.left=0;this.top=0;this.right=0;this.bottom=0}}};aC.IntRect0=function(){this.left=0;this.top=0;this.right=0;this.bottom=0};aC.IntRect1=function(bC){this.left=bC.left;this.top=bC.top;this.right=bC.right;this.bottom=bC.bottom};aC.IntRect4=function(bD,bE,bF,bC){this.left=bD;this.top=bE;this.right=bF;this.bottom=bC};aC.ClipType={ctIntersection:0,ctUnion:1,ctDifference:2,ctXor:3};aC.PolyType={ptSubject:0,ptClip:1};aC.PolyFillType={pftEvenOdd:0,pftNonZero:1,pftPositive:2,pftNegative:3};aC.JoinType={jtSquare:0,jtRound:1,jtMiter:2};aC.EndType={etOpenSquare:0,etOpenRound:1,etOpenButt:2,etClosedLine:3,etClosedPolygon:4};if(a5){aC.EndType_={etSquare:0,etRound:1,etButt:2,etClosed:3}}aC.EdgeSide={esLeft:0,esRight:1};aC.Direction={dRightToLeft:0,dLeftToRight:1};aC.TEdge=function(){this.Bot=new aC.IntPoint();this.Curr=new aC.IntPoint();this.Top=new aC.IntPoint();this.Delta=new aC.IntPoint();this.Dx=0;this.PolyTyp=aC.PolyType.ptSubject;this.Side=aC.EdgeSide.esLeft;this.WindDelta=0;this.WindCnt=0;this.WindCnt2=0;this.OutIdx=0;this.Next=null;this.Prev=null;this.NextInLML=null;this.NextInAEL=null;this.PrevInAEL=null;this.NextInSEL=null;this.PrevInSEL=null};aC.IntersectNode=function(){this.Edge1=null;this.Edge2=null;this.Pt=new aC.IntPoint()};aC.MyIntersectNodeSort=function(){};aC.MyIntersectNodeSort.Compare=function(bD,bC){return(bC.Pt.y-bD.Pt.y)};aC.LocalMinima=function(){this.y=0;this.LeftBound=null;this.RightBound=null;this.Next=null};aC.Scanbeam=function(){this.y=0;this.Next=null};aC.OutRec=function(){this.Idx=0;this.IsHole=false;this.IsOpen=false;this.FirstLeft=null;this.Pts=null;this.BottomPt=null;this.PolyNode=null};aC.OutPt=function(){this.Idx=0;this.Pt=new aC.IntPoint();this.Next=null;this.Prev=null};aC.Join=function(){this.OutPt1=null;this.OutPt2=null;this.OffPt=new aC.IntPoint()};aC.ClipperBase=function(){this.m_MinimaList=null;this.m_CurrentLM=null;this.m_edges=new Array();this.m_UseFullRange=false;this.m_HasOpenPaths=false;this.PreserveCollinear=false;this.m_MinimaList=null;this.m_CurrentLM=null;this.m_UseFullRange=false;this.m_HasOpenPaths=false};aC.ClipperBase.horizontal=-9007199254740992;aC.ClipperBase.Skip=-2;aC.ClipperBase.Unassigned=-1;aC.ClipperBase.tolerance=1e-20;if(T){aC.ClipperBase.loRange=46340;aC.ClipperBase.hiRange=46340}else{aC.ClipperBase.loRange=47453132;aC.ClipperBase.hiRange=4503599627370495}aC.ClipperBase.near_zero=function(bC){return(bC>-aC.ClipperBase.tolerance)&&(bC<aC.ClipperBase.tolerance)};aC.ClipperBase.IsHorizontal=function(bC){return bC.Delta.y===0};aC.ClipperBase.prototype.PointIsVertex=function(bE,bD){var bC=bD;do{if(aC.IntPoint.op_Equality(bC.Pt,bE)){return true}bC=bC.Next}while(bC!=bD);return false};aC.ClipperBase.prototype.PointOnLineSegment=function(bF,bD,bC,bE){if(bE){return((bF.x==bD.x)&&(bF.y==bD.y))||((bF.x==bC.x)&&(bF.y==bC.y))||(((bF.x>bD.x)==(bF.x<bC.x))&&((bF.y>bD.y)==(bF.y<bC.y))&&(aY.op_Equality(aY.Int128Mul((bF.x-bD.x),(bC.y-bD.y)),aY.Int128Mul((bC.x-bD.x),(bF.y-bD.y)))))}else{return((bF.x==bD.x)&&(bF.y==bD.y))||((bF.x==bC.x)&&(bF.y==bC.y))||(((bF.x>bD.x)==(bF.x<bC.x))&&((bF.y>bD.y)==(bF.y<bC.y))&&((bF.x-bD.x)*(bC.y-bD.y)==(bC.x-bD.x)*(bF.y-bD.y)))}};aC.ClipperBase.prototype.PointOnPolygon=function(bF,bD,bE){var bC=bD;while(true){if(this.PointOnLineSegment(bF,bC.Pt,bC.Next.Pt,bE)){return true}bC=bC.Next;if(bC==bD){break}}return false};aC.ClipperBase.prototype.SlopesEqual=aC.ClipperBase.SlopesEqual=function(){var bH=arguments,bC=bH.length;var bE,bD,bK,bJ,bG,bF,bI;if(bC==3){bE=bH[0];bD=bH[1];bI=bH[2];if(bI){return aY.op_Equality(aY.Int128Mul(bE.Delta.y,bD.Delta.x),aY.Int128Mul(bE.Delta.x,bD.Delta.y))}else{return aC.Cast_Int64((bE.Delta.y)*(bD.Delta.x))==aC.Cast_Int64((bE.Delta.x)*(bD.Delta.y))}}else{if(bC==4){bK=bH[0];bJ=bH[1];bG=bH[2];bI=bH[3];if(bI){return aY.op_Equality(aY.Int128Mul(bK.y-bJ.y,bJ.x-bG.x),aY.Int128Mul(bK.x-bJ.x,bJ.y-bG.y))}else{return aC.Cast_Int64((bK.y-bJ.y)*(bJ.x-bG.x))-aC.Cast_Int64((bK.x-bJ.x)*(bJ.y-bG.y))===0}}else{bK=bH[0];bJ=bH[1];bG=bH[2];bF=bH[3];bI=bH[4];if(bI){return aY.op_Equality(aY.Int128Mul(bK.y-bJ.y,bG.x-bF.x),aY.Int128Mul(bK.x-bJ.x,bG.y-bF.y))}else{return aC.Cast_Int64((bK.y-bJ.y)*(bG.x-bF.x))-aC.Cast_Int64((bK.x-bJ.x)*(bG.y-bF.y))===0}}}};aC.ClipperBase.SlopesEqual3=function(bE,bD,bC){if(bC){return aY.op_Equality(aY.Int128Mul(bE.Delta.y,bD.Delta.x),aY.Int128Mul(bE.Delta.x,bD.Delta.y))}else{return aC.Cast_Int64((bE.Delta.y)*(bD.Delta.x))==aC.Cast_Int64((bE.Delta.x)*(bD.Delta.y))}};aC.ClipperBase.SlopesEqual4=function(bF,bE,bD,bC){if(bC){return aY.op_Equality(aY.Int128Mul(bF.y-bE.y,bE.x-bD.x),aY.Int128Mul(bF.x-bE.x,bE.y-bD.y))}else{return aC.Cast_Int64((bF.y-bE.y)*(bE.x-bD.x))-aC.Cast_Int64((bF.x-bE.x)*(bE.y-bD.y))===0}};aC.ClipperBase.SlopesEqual5=function(bG,bF,bE,bD,bC){if(bC){return aY.op_Equality(aY.Int128Mul(bG.y-bF.y,bE.x-bD.x),aY.Int128Mul(bG.x-bF.x,bE.y-bD.y))}else{return aC.Cast_Int64((bG.y-bF.y)*(bE.x-bD.x))-aC.Cast_Int64((bG.x-bF.x)*(bE.y-bD.y))===0}};aC.ClipperBase.prototype.Clear=function(){this.DisposeLocalMinimaList();for(var bF=0,bE=this.m_edges.length;bF<bE;++bF){for(var bD=0,bC=this.m_edges[bF].length;bD<bC;++bD){this.m_edges[bF][bD]=null}aC.Clear(this.m_edges[bF])}aC.Clear(this.m_edges);this.m_UseFullRange=false;this.m_HasOpenPaths=false};aC.ClipperBase.prototype.DisposeLocalMinimaList=function(){while(this.m_MinimaList!==null){var bC=this.m_MinimaList.Next;this.m_MinimaList=null;this.m_MinimaList=bC}this.m_CurrentLM=null};aC.ClipperBase.prototype.RangeTest=function(bD,bC){if(bC.Value){if(bD.x>aC.ClipperBase.hiRange||bD.y>aC.ClipperBase.hiRange||-bD.x>aC.ClipperBase.hiRange||-bD.y>aC.ClipperBase.hiRange){aC.Error("Coordinate outside allowed range in RangeTest().")}}else{if(bD.x>aC.ClipperBase.loRange||bD.y>aC.ClipperBase.loRange||-bD.x>aC.ClipperBase.loRange||-bD.y>aC.ClipperBase.loRange){bC.Value=true;this.RangeTest(bD,bC)}}};aC.ClipperBase.prototype.InitEdge=function(bF,bC,bD,bE){bF.Next=bC;bF.Prev=bD;bF.Curr.x=bE.x;bF.Curr.y=bE.y;bF.OutIdx=-1};aC.ClipperBase.prototype.InitEdge2=function(bD,bC){if(bD.Curr.y>=bD.Next.Curr.y){bD.Bot.x=bD.Curr.x;bD.Bot.y=bD.Curr.y;bD.Top.x=bD.Next.Curr.x;bD.Top.y=bD.Next.Curr.y}else{bD.Top.x=bD.Curr.x;bD.Top.y=bD.Curr.y;bD.Bot.x=bD.Next.Curr.x;bD.Bot.y=bD.Next.Curr.y}this.SetDx(bD);bD.PolyTyp=bC};aC.ClipperBase.prototype.FindNextLocMin=function(bC){var bD;for(;;){while(aC.IntPoint.op_Inequality(bC.Bot,bC.Prev.Bot)||aC.IntPoint.op_Equality(bC.Curr,bC.Top)){bC=bC.Next}if(bC.Dx!=aC.ClipperBase.horizontal&&bC.Prev.Dx!=aC.ClipperBase.horizontal){break}while(bC.Prev.Dx==aC.ClipperBase.horizontal){bC=bC.Prev}bD=bC;while(bC.Dx==aC.ClipperBase.horizontal){bC=bC.Next}if(bC.Top.y==bC.Prev.Bot.y){continue}if(bD.Prev.Bot.x<bC.Bot.x){bC=bD}break}return bC};aC.ClipperBase.prototype.ProcessBound=function(bF,bG){var bD=bF,bI=bF;var bE;var bC;if(bF.Dx==aC.ClipperBase.horizontal){if(bG){bC=bF.Prev.Bot.x}else{bC=bF.Next.Bot.x}if(bF.Bot.x!=bC){this.ReverseHorizontal(bF)}}if(bI.OutIdx!=aC.ClipperBase.Skip){if(bG){while(bI.Top.y==bI.Next.Bot.y&&bI.Next.OutIdx!=aC.ClipperBase.Skip){bI=bI.Next}if(bI.Dx==aC.ClipperBase.horizontal&&bI.Next.OutIdx!=aC.ClipperBase.Skip){bE=bI;while(bE.Prev.Dx==aC.ClipperBase.horizontal){bE=bE.Prev}if(bE.Prev.Top.x==bI.Next.Top.x){if(!bG){bI=bE.Prev}}else{if(bE.Prev.Top.x>bI.Next.Top.x){bI=bE.Prev}}}while(bF!=bI){bF.NextInLML=bF.Next;if(bF.Dx==aC.ClipperBase.horizontal&&bF!=bD&&bF.Bot.x!=bF.Prev.Top.x){this.ReverseHorizontal(bF)}bF=bF.Next}if(bF.Dx==aC.ClipperBase.horizontal&&bF!=bD&&bF.Bot.x!=bF.Prev.Top.x){this.ReverseHorizontal(bF)}bI=bI.Next}else{while(bI.Top.y==bI.Prev.Bot.y&&bI.Prev.OutIdx!=aC.ClipperBase.Skip){bI=bI.Prev}if(bI.Dx==aC.ClipperBase.horizontal&&bI.Prev.OutIdx!=aC.ClipperBase.Skip){bE=bI;while(bE.Next.Dx==aC.ClipperBase.horizontal){bE=bE.Next}if(bE.Next.Top.x==bI.Prev.Top.x){if(!bG){bI=bE.Next}}else{if(bE.Next.Top.x>bI.Prev.Top.x){bI=bE.Next}}}while(bF!=bI){bF.NextInLML=bF.Prev;if(bF.Dx==aC.ClipperBase.horizontal&&bF!=bD&&bF.Bot.x!=bF.Next.Top.x){this.ReverseHorizontal(bF)}bF=bF.Prev}if(bF.Dx==aC.ClipperBase.horizontal&&bF!=bD&&bF.Bot.x!=bF.Next.Top.x){this.ReverseHorizontal(bF)}bI=bI.Prev}}if(bI.OutIdx==aC.ClipperBase.Skip){bF=bI;if(bG){while(bF.Top.y==bF.Next.Bot.y){bF=bF.Next}while(bF!=bI&&bF.Dx==aC.ClipperBase.horizontal){bF=bF.Prev}}else{while(bF.Top.y==bF.Prev.Bot.y){bF=bF.Prev}while(bF!=bI&&bF.Dx==aC.ClipperBase.horizontal){bF=bF.Next}}if(bF==bI){if(bG){bI=bF.Next}else{bI=bF.Prev}}else{if(bG){bF=bI.Next}else{bF=bI.Prev}var bH=new aC.LocalMinima();bH.Next=null;bH.y=bF.Bot.y;bH.LeftBound=null;bH.RightBound=bF;bH.RightBound.WindDelta=0;bI=this.ProcessBound(bH.RightBound,bG);this.InsertLocalMinima(bH)}}return bI};aC.ClipperBase.prototype.AddPath=function(bJ,bO,bK){if(Z){if(!bK&&bO==aC.PolyType.ptClip){aC.Error("AddPath: Open paths must be subject.")}}else{if(!bK){aC.Error("AddPath: Open paths have been disabled.")}}var bL=bJ.length-1;if(bK){while(bL>0&&(aC.IntPoint.op_Equality(bJ[bL],bJ[0]))){--bL}}while(bL>0&&(aC.IntPoint.op_Equality(bJ[bL],bJ[bL-1]))){--bL}if((bK&&bL<2)||(!bK&&bL<1)){return false}var bG=new Array();for(var bI=0;bI<=bL;bI++){bG.push(new aC.TEdge())}var bQ=true;bG[1].Curr.x=bJ[1].x;bG[1].Curr.y=bJ[1].y;var bF={Value:this.m_UseFullRange};this.RangeTest(bJ[0],bF);this.m_UseFullRange=bF.Value;bF.Value=this.m_UseFullRange;this.RangeTest(bJ[bL],bF);this.m_UseFullRange=bF.Value;this.InitEdge(bG[0],bG[1],bG[bL],bJ[0]);this.InitEdge(bG[bL],bG[0],bG[bL-1],bJ[bL]);for(var bI=bL-1;bI>=1;--bI){bF.Value=this.m_UseFullRange;this.RangeTest(bJ[bI],bF);this.m_UseFullRange=bF.Value;this.InitEdge(bG[bI],bG[bI+1],bG[bI-1],bJ[bI])}var bP=bG[0];var bR=bP,bM=bP;for(;;){if(aC.IntPoint.op_Equality(bR.Curr,bR.Next.Curr)){if(bR==bR.Next){break}if(bR==bP){bP=bR.Next}bR=this.RemoveEdge(bR);bM=bR;continue}if(bR.Prev==bR.Next){break}else{if(bK&&aC.ClipperBase.SlopesEqual(bR.Prev.Curr,bR.Curr,bR.Next.Curr,this.m_UseFullRange)&&(!this.PreserveCollinear||!this.Pt2IsBetweenPt1AndPt3(bR.Prev.Curr,bR.Curr,bR.Next.Curr))){if(bR==bP){bP=bR.Next}bR=this.RemoveEdge(bR);bR=bR.Prev;bM=bR;continue}}bR=bR.Next;if(bR==bM){break}}if((!bK&&(bR==bR.Next))||(bK&&(bR.Prev==bR.Next))){return false}if(!bK){this.m_HasOpenPaths=true;bP.Prev.OutIdx=aC.ClipperBase.Skip}var bC=bP;bR=bP;do{this.InitEdge2(bR,bO);bR=bR.Next;if(bQ&&bR.Curr.y!=bP.Curr.y){bQ=false}}while(bR!=bP);if(bQ){if(bK){return false}bR.Prev.OutIdx=aC.ClipperBase.Skip;if(bR.Prev.Bot.x<bR.Prev.Top.x){this.ReverseHorizontal(bR.Prev)}var bE=new aC.LocalMinima();bE.Next=null;bE.y=bR.Bot.y;bE.LeftBound=null;bE.RightBound=bR;bE.RightBound.Side=aC.EdgeSide.esRight;bE.RightBound.WindDelta=0;while(bR.Next.OutIdx!=aC.ClipperBase.Skip){bR.NextInLML=bR.Next;if(bR.Bot.x!=bR.Prev.Top.x){this.ReverseHorizontal(bR)}bR=bR.Next}this.InsertLocalMinima(bE);this.m_edges.push(bG);return true}this.m_edges.push(bG);var bD;var bH=null;for(;;){bR=this.FindNextLocMin(bR);if(bR==bH){break}else{if(bH==null){bH=bR}}var bE=new aC.LocalMinima();bE.Next=null;bE.y=bR.Bot.y;if(bR.Dx<bR.Prev.Dx){bE.LeftBound=bR.Prev;bE.RightBound=bR;bD=false}else{bE.LeftBound=bR;bE.RightBound=bR.Prev;bD=true}bE.LeftBound.Side=aC.EdgeSide.esLeft;bE.RightBound.Side=aC.EdgeSide.esRight;if(!bK){bE.LeftBound.WindDelta=0}else{if(bE.LeftBound.Next==bE.RightBound){bE.LeftBound.WindDelta=-1}else{bE.LeftBound.WindDelta=1}}bE.RightBound.WindDelta=-bE.LeftBound.WindDelta;bR=this.ProcessBound(bE.LeftBound,bD);var bN=this.ProcessBound(bE.RightBound,!bD);if(bE.LeftBound.OutIdx==aC.ClipperBase.Skip){bE.LeftBound=null}else{if(bE.RightBound.OutIdx==aC.ClipperBase.Skip){bE.RightBound=null}}this.InsertLocalMinima(bE);if(!bD){bR=bN}}return true};aC.ClipperBase.prototype.AddPaths=function(bE,bF,bD){var bC=false;for(var bH=0,bG=bE.length;bH<bG;++bH){if(this.AddPath(bE[bH],bF,bD)){bC=true}}return bC};aC.ClipperBase.prototype.Pt2IsBetweenPt1AndPt3=function(bE,bD,bC){if((aC.IntPoint.op_Equality(bE,bC))||(aC.IntPoint.op_Equality(bE,bD))||(aC.IntPoint.op_Equality(bC,bD))){return false}else{if(bE.x!=bC.x){return(bD.x>bE.x)==(bD.x<bC.x)}else{return(bD.y>bE.y)==(bD.y<bC.y)}}};aC.ClipperBase.prototype.RemoveEdge=function(bD){bD.Prev.Next=bD.Next;bD.Next.Prev=bD.Prev;var bC=bD.Next;bD.Prev=null;return bC};aC.ClipperBase.prototype.SetDx=function(bC){bC.Delta.x=(bC.Top.x-bC.Bot.x);bC.Delta.y=(bC.Top.y-bC.Bot.y);if(bC.Delta.y===0){bC.Dx=aC.ClipperBase.horizontal}else{bC.Dx=(bC.Delta.x)/(bC.Delta.y)}};aC.ClipperBase.prototype.InsertLocalMinima=function(bC){if(this.m_MinimaList===null){this.m_MinimaList=bC}else{if(bC.y>=this.m_MinimaList.y){bC.Next=this.m_MinimaList;this.m_MinimaList=bC}else{var bD=this.m_MinimaList;while(bD.Next!==null&&(bC.y<bD.Next.y)){bD=bD.Next}bC.Next=bD.Next;bD.Next=bC}}};aC.ClipperBase.prototype.PopLocalMinima=function(){if(this.m_CurrentLM===null){return}this.m_CurrentLM=this.m_CurrentLM.Next};aC.ClipperBase.prototype.ReverseHorizontal=function(bD){var bC=bD.Top.x;bD.Top.x=bD.Bot.x;bD.Bot.x=bC;if(aF){bC=bD.Top.z;bD.Top.z=bD.Bot.z;bD.Bot.z=bC}};aC.ClipperBase.prototype.Reset=function(){this.m_CurrentLM=this.m_MinimaList;if(this.m_CurrentLM==null){return}var bC=this.m_MinimaList;while(bC!=null){var bD=bC.LeftBound;if(bD!=null){bD.Curr.x=bD.Bot.x;bD.Curr.y=bD.Bot.y;bD.Side=aC.EdgeSide.esLeft;bD.OutIdx=aC.ClipperBase.Unassigned}bD=bC.RightBound;if(bD!=null){bD.Curr.x=bD.Bot.x;bD.Curr.y=bD.Bot.y;bD.Side=aC.EdgeSide.esRight;bD.OutIdx=aC.ClipperBase.Unassigned}bC=bC.Next}};aC.Clipper=function(bC){if(typeof(bC)=="undefined"){bC=0}this.m_PolyOuts=null;this.m_ClipType=aC.ClipType.ctIntersection;this.m_Scanbeam=null;this.m_ActiveEdges=null;this.m_SortedEdges=null;this.m_IntersectList=null;this.m_IntersectNodeComparer=null;this.m_ExecuteLocked=false;this.m_ClipFillType=aC.PolyFillType.pftEvenOdd;this.m_SubjFillType=aC.PolyFillType.pftEvenOdd;this.m_Joins=null;this.m_GhostJoins=null;this.m_UsingPolyTree=false;this.ReverseSolution=false;this.StrictlySimple=false;aC.ClipperBase.call(this);this.m_Scanbeam=null;this.m_ActiveEdges=null;this.m_SortedEdges=null;this.m_IntersectList=new Array();this.m_IntersectNodeComparer=aC.MyIntersectNodeSort.Compare;this.m_ExecuteLocked=false;this.m_UsingPolyTree=false;this.m_PolyOuts=new Array();this.m_Joins=new Array();this.m_GhostJoins=new Array();this.ReverseSolution=(1&bC)!==0;this.StrictlySimple=(2&bC)!==0;this.PreserveCollinear=(4&bC)!==0;if(aF){this.ZFillFunction=null}};aC.Clipper.ioReverseSolution=1;aC.Clipper.ioStrictlySimple=2;aC.Clipper.ioPreserveCollinear=4;aC.Clipper.prototype.Clear=function(){if(this.m_edges.length===0){return}this.DisposeAllPolyPts();aC.ClipperBase.prototype.Clear.call(this)};aC.Clipper.prototype.DisposeScanbeamList=function(){while(this.m_Scanbeam!==null){var bC=this.m_Scanbeam.Next;this.m_Scanbeam=null;this.m_Scanbeam=bC}};aC.Clipper.prototype.Reset=function(){aC.ClipperBase.prototype.Reset.call(this);this.m_Scanbeam=null;this.m_ActiveEdges=null;this.m_SortedEdges=null;var bC=this.m_MinimaList;while(bC!==null){this.InsertScanbeam(bC.y);bC=bC.Next}};aC.Clipper.prototype.InsertScanbeam=function(bE){if(this.m_Scanbeam===null){this.m_Scanbeam=new aC.Scanbeam();this.m_Scanbeam.Next=null;this.m_Scanbeam.y=bE}else{if(bE>this.m_Scanbeam.y){var bC=new aC.Scanbeam();bC.y=bE;bC.Next=this.m_Scanbeam;this.m_Scanbeam=bC}else{var bD=this.m_Scanbeam;while(bD.Next!==null&&(bE<=bD.Next.y)){bD=bD.Next}if(bE==bD.y){return}var bC=new aC.Scanbeam();bC.y=bE;bC.Next=bD.Next;bD.Next=bC}}};aC.Clipper.prototype.Execute=function(){var bJ=arguments,bD=bJ.length,bG=bJ[1] instanceof aC.PolyTree;if(bD==4&&!bG){var bE=bJ[0],bH=bJ[1],bF=bJ[2],bC=bJ[3];if(this.m_ExecuteLocked){return false}if(this.m_HasOpenPaths){aC.Error("Error: PolyTree struct is need for open path clipping.")}this.m_ExecuteLocked=true;aC.Clear(bH);this.m_SubjFillType=bF;this.m_ClipFillType=bC;this.m_ClipType=bE;this.m_UsingPolyTree=false;try{var bK=this.ExecuteInternal();if(bK){this.BuildResult(bH)}}finally{this.DisposeAllPolyPts();this.m_ExecuteLocked=false}return bK}else{if(bD==4&&bG){var bE=bJ[0],bI=bJ[1],bF=bJ[2],bC=bJ[3];if(this.m_ExecuteLocked){return false}this.m_ExecuteLocked=true;this.m_SubjFillType=bF;this.m_ClipFillType=bC;this.m_ClipType=bE;this.m_UsingPolyTree=true;try{var bK=this.ExecuteInternal();if(bK){this.BuildResult2(bI)}}finally{this.DisposeAllPolyPts();this.m_ExecuteLocked=false}return bK}else{if(bD==2&&!bG){var bE=bJ[0],bH=bJ[1];return this.Execute(bE,bH,aC.PolyFillType.pftEvenOdd,aC.PolyFillType.pftEvenOdd)}else{if(bD==2&&bG){var bE=bJ[0],bI=bJ[1];return this.Execute(bE,bI,aC.PolyFillType.pftEvenOdd,aC.PolyFillType.pftEvenOdd)}}}}};aC.Clipper.prototype.FixHoleLinkage=function(bC){if(bC.FirstLeft===null||(bC.IsHole!=bC.FirstLeft.IsHole&&bC.FirstLeft.Pts!==null)){return}var bD=bC.FirstLeft;while(bD!==null&&((bD.IsHole==bC.IsHole)||bD.Pts===null)){bD=bD.FirstLeft}bC.FirstLeft=bD};aC.Clipper.prototype.ExecuteInternal=function(){try{this.Reset();if(this.m_CurrentLM===null){return false}var bG=this.PopScanbeam();do{this.InsertLocalMinimaIntoAEL(bG);aC.Clear(this.m_GhostJoins);this.ProcessHorizontals(false);if(this.m_Scanbeam===null){break}var bC=this.PopScanbeam();if(!this.ProcessIntersections(bG,bC)){return false}this.ProcessEdgesAtTopOfScanbeam(bC);bG=bC}while(this.m_Scanbeam!==null||this.m_CurrentLM!==null);for(var bE=0,bD=this.m_PolyOuts.length;bE<bD;bE++){var bF=this.m_PolyOuts[bE];if(bF.Pts===null||bF.IsOpen){continue}if((bF.IsHole^this.ReverseSolution)==(this.Area(bF)>0)){this.ReversePolyPtLinks(bF.Pts)}}this.JoinCommonEdges();for(var bE=0,bD=this.m_PolyOuts.length;bE<bD;bE++){var bF=this.m_PolyOuts[bE];if(bF.Pts!==null&&!bF.IsOpen){this.FixupOutPolygon(bF)}}if(this.StrictlySimple){this.DoSimplePolygons()}return true}finally{aC.Clear(this.m_Joins);aC.Clear(this.m_GhostJoins)}};aC.Clipper.prototype.PopScanbeam=function(){var bD=this.m_Scanbeam.y;var bC=this.m_Scanbeam;this.m_Scanbeam=this.m_Scanbeam.Next;bC=null;return bD};aC.Clipper.prototype.DisposeAllPolyPts=function(){for(var bD=0,bC=this.m_PolyOuts.length;bD<bC;++bD){this.DisposeOutRec(bD)}aC.Clear(this.m_PolyOuts)};aC.Clipper.prototype.DisposeOutRec=function(bC){var bD=this.m_PolyOuts[bC];if(bD.Pts!==null){this.DisposeOutPts(bD.Pts)}bD=null;this.m_PolyOuts[bC]=null};aC.Clipper.prototype.DisposeOutPts=function(bD){if(bD===null){return}var bC=null;bD.Prev.Next=null;while(bD!==null){bC=bD;bD=bD.Next;bC=null}};aC.Clipper.prototype.AddJoin=function(bE,bC,bD){var bF=new aC.Join();bF.OutPt1=bE;bF.OutPt2=bC;bF.OffPt.x=bD.x;bF.OffPt.y=bD.y;this.m_Joins.push(bF)};aC.Clipper.prototype.AddGhostJoin=function(bD,bC){var bE=new aC.Join();bE.OutPt1=bD;bE.OffPt.x=bC.x;bE.OffPt.y=bC.y;this.m_GhostJoins.push(bE)};if(aF){aC.Clipper.prototype.SetZ=function(bD,bC){bD.z=0;if(this.ZFillFunction!==null){if(bC.OutIdx<0){this.ZFillFunction(bC.Bot,bC.Top,bD)}else{this.ZFillFunction(bC.Top,bC.Bot,bD)}}}}aC.Clipper.prototype.InsertLocalMinimaIntoAEL=function(bH){while(this.m_CurrentLM!==null&&(this.m_CurrentLM.y==bH)){var bF=this.m_CurrentLM.LeftBound;var bD=this.m_CurrentLM.RightBound;this.PopLocalMinima();var bE=null;if(bF===null){this.InsertEdgeIntoAEL(bD,null);this.SetWindingCount(bD);if(this.IsContributing(bD)){bE=this.AddOutPt(bD,bD.Bot)}}else{if(bD==null){this.InsertEdgeIntoAEL(bF,null);this.SetWindingCount(bF);if(this.IsContributing(bF)){bE=this.AddOutPt(bF,bF.Bot)}this.InsertScanbeam(bF.Top.y)}else{this.InsertEdgeIntoAEL(bF,null);this.InsertEdgeIntoAEL(bD,bF);this.SetWindingCount(bF);bD.WindCnt=bF.WindCnt;bD.WindCnt2=bF.WindCnt2;if(this.IsContributing(bF)){bE=this.AddLocalMinPoly(bF,bD,bF.Bot)}this.InsertScanbeam(bF.Top.y)}}if(bD!=null){if(aC.ClipperBase.IsHorizontal(bD)){this.AddEdgeToSEL(bD)}else{this.InsertScanbeam(bD.Top.y)}}if(bF==null||bD==null){continue}if(bE!==null&&aC.ClipperBase.IsHorizontal(bD)&&this.m_GhostJoins.length>0&&bD.WindDelta!==0){for(var bJ=0,bG=this.m_GhostJoins.length;bJ<bG;bJ++){var bI=this.m_GhostJoins[bJ];if(this.HorzSegmentsOverlap(bI.OutPt1.Pt,bI.OffPt,bD.Bot,bD.Top)){this.AddJoin(bI.OutPt1,bE,bI.OffPt)}}}if(bF.OutIdx>=0&&bF.PrevInAEL!==null&&bF.PrevInAEL.Curr.x==bF.Bot.x&&bF.PrevInAEL.OutIdx>=0&&aC.ClipperBase.SlopesEqual(bF.PrevInAEL,bF,this.m_UseFullRange)&&bF.WindDelta!==0&&bF.PrevInAEL.WindDelta!==0){var bC=this.AddOutPt(bF.PrevInAEL,bF.Bot);this.AddJoin(bE,bC,bF.Top)}if(bF.NextInAEL!=bD){if(bD.OutIdx>=0&&bD.PrevInAEL.OutIdx>=0&&aC.ClipperBase.SlopesEqual(bD.PrevInAEL,bD,this.m_UseFullRange)&&bD.WindDelta!==0&&bD.PrevInAEL.WindDelta!==0){var bC=this.AddOutPt(bD.PrevInAEL,bD.Bot);this.AddJoin(bE,bC,bD.Top)}var bK=bF.NextInAEL;if(bK!==null){while(bK!=bD){this.IntersectEdges(bD,bK,bF.Curr,false);bK=bK.NextInAEL}}}}};aC.Clipper.prototype.InsertEdgeIntoAEL=function(bD,bC){if(this.m_ActiveEdges===null){bD.PrevInAEL=null;bD.NextInAEL=null;this.m_ActiveEdges=bD}else{if(bC===null&&this.E2InsertsBeforeE1(this.m_ActiveEdges,bD)){bD.PrevInAEL=null;bD.NextInAEL=this.m_ActiveEdges;this.m_ActiveEdges.PrevInAEL=bD;this.m_ActiveEdges=bD}else{if(bC===null){bC=this.m_ActiveEdges}while(bC.NextInAEL!==null&&!this.E2InsertsBeforeE1(bC.NextInAEL,bD)){bC=bC.NextInAEL}bD.NextInAEL=bC.NextInAEL;if(bC.NextInAEL!==null){bC.NextInAEL.PrevInAEL=bD}bD.PrevInAEL=bC;bC.NextInAEL=bD}}};aC.Clipper.prototype.E2InsertsBeforeE1=function(bD,bC){if(bC.Curr.x==bD.Curr.x){if(bC.Top.y>bD.Top.y){return bC.Top.x<aC.Clipper.TopX(bD,bC.Top.y)}else{return bD.Top.x>aC.Clipper.TopX(bC,bD.Top.y)}}else{return bC.Curr.x<bD.Curr.x}};aC.Clipper.prototype.IsEvenOddFillType=function(bC){if(bC.PolyTyp==aC.PolyType.ptSubject){return this.m_SubjFillType==aC.PolyFillType.pftEvenOdd}else{return this.m_ClipFillType==aC.PolyFillType.pftEvenOdd}};aC.Clipper.prototype.IsEvenOddAltFillType=function(bC){if(bC.PolyTyp==aC.PolyType.ptSubject){return this.m_ClipFillType==aC.PolyFillType.pftEvenOdd}else{return this.m_SubjFillType==aC.PolyFillType.pftEvenOdd}};aC.Clipper.prototype.IsContributing=function(bD){var bC,bE;if(bD.PolyTyp==aC.PolyType.ptSubject){bC=this.m_SubjFillType;bE=this.m_ClipFillType}else{bC=this.m_ClipFillType;bE=this.m_SubjFillType}switch(bC){case aC.PolyFillType.pftEvenOdd:if(bD.WindDelta===0&&bD.WindCnt!=1){return false}break;case aC.PolyFillType.pftNonZero:if(Math.abs(bD.WindCnt)!=1){return false}break;case aC.PolyFillType.pftPositive:if(bD.WindCnt!=1){return false}break;default:if(bD.WindCnt!=-1){return false}break}switch(this.m_ClipType){case aC.ClipType.ctIntersection:switch(bE){case aC.PolyFillType.pftEvenOdd:case aC.PolyFillType.pftNonZero:return(bD.WindCnt2!==0);case aC.PolyFillType.pftPositive:return(bD.WindCnt2>0);default:return(bD.WindCnt2<0)}case aC.ClipType.ctUnion:switch(bE){case aC.PolyFillType.pftEvenOdd:case aC.PolyFillType.pftNonZero:return(bD.WindCnt2===0);case aC.PolyFillType.pftPositive:return(bD.WindCnt2<=0);default:return(bD.WindCnt2>=0)}case aC.ClipType.ctDifference:if(bD.PolyTyp==aC.PolyType.ptSubject){switch(bE){case aC.PolyFillType.pftEvenOdd:case aC.PolyFillType.pftNonZero:return(bD.WindCnt2===0);case aC.PolyFillType.pftPositive:return(bD.WindCnt2<=0);default:return(bD.WindCnt2>=0)}}else{switch(bE){case aC.PolyFillType.pftEvenOdd:case aC.PolyFillType.pftNonZero:return(bD.WindCnt2!==0);case aC.PolyFillType.pftPositive:return(bD.WindCnt2>0);default:return(bD.WindCnt2<0)}}case aC.ClipType.ctXor:if(bD.WindDelta===0){switch(bE){case aC.PolyFillType.pftEvenOdd:case aC.PolyFillType.pftNonZero:return(bD.WindCnt2===0);case aC.PolyFillType.pftPositive:return(bD.WindCnt2<=0);default:return(bD.WindCnt2>=0)}}else{return true}}return true};aC.Clipper.prototype.SetWindingCount=function(bC){var bE=bC.PrevInAEL;while(bE!==null&&((bE.PolyTyp!=bC.PolyTyp)||(bE.WindDelta===0))){bE=bE.PrevInAEL}if(bE===null){bC.WindCnt=(bC.WindDelta===0?1:bC.WindDelta);bC.WindCnt2=0;bE=this.m_ActiveEdges}else{if(bC.WindDelta===0&&this.m_ClipType!=aC.ClipType.ctUnion){bC.WindCnt=1;bC.WindCnt2=bE.WindCnt2;bE=bE.NextInAEL}else{if(this.IsEvenOddFillType(bC)){if(bC.WindDelta===0){var bF=true;var bD=bE.PrevInAEL;while(bD!==null){if(bD.PolyTyp==bE.PolyTyp&&bD.WindDelta!==0){bF=!bF}bD=bD.PrevInAEL}bC.WindCnt=(bF?0:1)}else{bC.WindCnt=bC.WindDelta}bC.WindCnt2=bE.WindCnt2;bE=bE.NextInAEL}else{if(bE.WindCnt*bE.WindDelta<0){if(Math.abs(bE.WindCnt)>1){if(bE.WindDelta*bC.WindDelta<0){bC.WindCnt=bE.WindCnt}else{bC.WindCnt=bE.WindCnt+bC.WindDelta}}else{bC.WindCnt=(bC.WindDelta===0?1:bC.WindDelta)}}else{if(bC.WindDelta===0){bC.WindCnt=(bE.WindCnt<0?bE.WindCnt-1:bE.WindCnt+1)}else{if(bE.WindDelta*bC.WindDelta<0){bC.WindCnt=bE.WindCnt}else{bC.WindCnt=bE.WindCnt+bC.WindDelta}}}bC.WindCnt2=bE.WindCnt2;bE=bE.NextInAEL}}}if(this.IsEvenOddAltFillType(bC)){while(bE!=bC){if(bE.WindDelta!==0){bC.WindCnt2=(bC.WindCnt2===0?1:0)}bE=bE.NextInAEL}}else{while(bE!=bC){bC.WindCnt2+=bE.WindDelta;bE=bE.NextInAEL}}};aC.Clipper.prototype.AddEdgeToSEL=function(bC){if(this.m_SortedEdges===null){this.m_SortedEdges=bC;bC.PrevInSEL=null;bC.NextInSEL=null}else{bC.NextInSEL=this.m_SortedEdges;bC.PrevInSEL=null;this.m_SortedEdges.PrevInSEL=bC;this.m_SortedEdges=bC}};aC.Clipper.prototype.CopyAELToSEL=function(){var bC=this.m_ActiveEdges;this.m_SortedEdges=bC;while(bC!==null){bC.PrevInSEL=bC.PrevInAEL;bC.NextInSEL=bC.NextInAEL;bC=bC.NextInAEL}};aC.Clipper.prototype.SwapPositionsInAEL=function(bD,bC){if(bD.NextInAEL==bD.PrevInAEL||bC.NextInAEL==bC.PrevInAEL){return}if(bD.NextInAEL==bC){var bE=bC.NextInAEL;if(bE!==null){bE.PrevInAEL=bD}var bF=bD.PrevInAEL;if(bF!==null){bF.NextInAEL=bC}bC.PrevInAEL=bF;bC.NextInAEL=bD;bD.PrevInAEL=bC;bD.NextInAEL=bE}else{if(bC.NextInAEL==bD){var bE=bD.NextInAEL;if(bE!==null){bE.PrevInAEL=bC}var bF=bC.PrevInAEL;if(bF!==null){bF.NextInAEL=bD}bD.PrevInAEL=bF;bD.NextInAEL=bC;bC.PrevInAEL=bD;bC.NextInAEL=bE}else{var bE=bD.NextInAEL;var bF=bD.PrevInAEL;bD.NextInAEL=bC.NextInAEL;if(bD.NextInAEL!==null){bD.NextInAEL.PrevInAEL=bD}bD.PrevInAEL=bC.PrevInAEL;if(bD.PrevInAEL!==null){bD.PrevInAEL.NextInAEL=bD}bC.NextInAEL=bE;if(bC.NextInAEL!==null){bC.NextInAEL.PrevInAEL=bC}bC.PrevInAEL=bF;if(bC.PrevInAEL!==null){bC.PrevInAEL.NextInAEL=bC}}}if(bD.PrevInAEL===null){this.m_ActiveEdges=bD}else{if(bC.PrevInAEL===null){this.m_ActiveEdges=bC}}};aC.Clipper.prototype.SwapPositionsInSEL=function(bD,bC){if(bD.NextInSEL===null&&bD.PrevInSEL===null){return}if(bC.NextInSEL===null&&bC.PrevInSEL===null){return}if(bD.NextInSEL==bC){var bE=bC.NextInSEL;if(bE!==null){bE.PrevInSEL=bD}var bF=bD.PrevInSEL;if(bF!==null){bF.NextInSEL=bC}bC.PrevInSEL=bF;bC.NextInSEL=bD;bD.PrevInSEL=bC;bD.NextInSEL=bE}else{if(bC.NextInSEL==bD){var bE=bD.NextInSEL;if(bE!==null){bE.PrevInSEL=bC}var bF=bC.PrevInSEL;if(bF!==null){bF.NextInSEL=bD}bD.PrevInSEL=bF;bD.NextInSEL=bC;bC.PrevInSEL=bD;bC.NextInSEL=bE}else{var bE=bD.NextInSEL;var bF=bD.PrevInSEL;bD.NextInSEL=bC.NextInSEL;if(bD.NextInSEL!==null){bD.NextInSEL.PrevInSEL=bD}bD.PrevInSEL=bC.PrevInSEL;if(bD.PrevInSEL!==null){bD.PrevInSEL.NextInSEL=bD}bC.NextInSEL=bE;if(bC.NextInSEL!==null){bC.NextInSEL.PrevInSEL=bC}bC.PrevInSEL=bF;if(bC.PrevInSEL!==null){bC.PrevInSEL.NextInSEL=bC}}}if(bD.PrevInSEL===null){this.m_SortedEdges=bD}else{if(bC.PrevInSEL===null){this.m_SortedEdges=bC}}};aC.Clipper.prototype.AddLocalMaxPoly=function(bE,bD,bC){this.AddOutPt(bE,bC);if(bD.WindDelta==0){this.AddOutPt(bD,bC)}if(bE.OutIdx==bD.OutIdx){bE.OutIdx=-1;bD.OutIdx=-1}else{if(bE.OutIdx<bD.OutIdx){this.AppendPolygon(bE,bD)}else{this.AppendPolygon(bD,bE)}}};aC.Clipper.prototype.AddLocalMinPoly=function(bI,bH,bG){var bC;var bF,bE;if(aC.ClipperBase.IsHorizontal(bH)||(bI.Dx>bH.Dx)){bC=this.AddOutPt(bI,bG);bH.OutIdx=bI.OutIdx;bI.Side=aC.EdgeSide.esLeft;bH.Side=aC.EdgeSide.esRight;bF=bI;if(bF.PrevInAEL==bH){bE=bH.PrevInAEL}else{bE=bF.PrevInAEL}}else{bC=this.AddOutPt(bH,bG);bI.OutIdx=bH.OutIdx;bI.Side=aC.EdgeSide.esRight;bH.Side=aC.EdgeSide.esLeft;bF=bH;if(bF.PrevInAEL==bI){bE=bI.PrevInAEL}else{bE=bF.PrevInAEL}}if(bE!==null&&bE.OutIdx>=0&&(aC.Clipper.TopX(bE,bG.y)==aC.Clipper.TopX(bF,bG.y))&&aC.ClipperBase.SlopesEqual(bF,bE,this.m_UseFullRange)&&(bF.WindDelta!==0)&&(bE.WindDelta!==0)){var bD=this.AddOutPt(bE,bG);this.AddJoin(bC,bD,bF.Top)}return bC};aC.Clipper.prototype.CreateOutRec=function(){var bC=new aC.OutRec();bC.Idx=-1;bC.IsHole=false;bC.IsOpen=false;bC.FirstLeft=null;bC.Pts=null;bC.BottomPt=null;bC.PolyNode=null;this.m_PolyOuts.push(bC);bC.Idx=this.m_PolyOuts.length-1;return bC};aC.Clipper.prototype.AddOutPt=function(bF,bE){var bG=(bF.Side==aC.EdgeSide.esLeft);if(bF.OutIdx<0){var bD=this.CreateOutRec();bD.IsOpen=(bF.WindDelta===0);var bC=new aC.OutPt();bD.Pts=bC;bC.Idx=bD.Idx;bC.Pt.x=bE.x;bC.Pt.y=bE.y;bC.Next=bC;bC.Prev=bC;if(!bD.IsOpen){this.SetHoleState(bF,bD)}if(aF){if(aC.IntPoint.op_Equality(bE,bF.Bot)){bC.Pt.x=bF.Bot.x;bC.Pt.y=bF.Bot.y;bC.Pt.z=bF.Bot.z}else{if(aC.IntPoint.op_Equality(bE,bF.Top)){bC.Pt.x=bF.Top.x;bC.Pt.y=bF.Top.y;bC.Pt.z=bF.Top.z}else{this.SetZ(bC.Pt,bF)}}}bF.OutIdx=bD.Idx;return bC}else{var bD=this.m_PolyOuts[bF.OutIdx];var bH=bD.Pts;if(bG&&aC.IntPoint.op_Equality(bE,bH.Pt)){return bH}else{if(!bG&&aC.IntPoint.op_Equality(bE,bH.Prev.Pt)){return bH.Prev}}var bC=new aC.OutPt();bC.Idx=bD.Idx;bC.Pt.x=bE.x;bC.Pt.y=bE.y;bC.Next=bH;bC.Prev=bH.Prev;bC.Prev.Next=bC;bH.Prev=bC;if(bG){bD.Pts=bC}if(aF){if(aC.IntPoint.op_Equality(bE,bF.Bot)){bC.Pt.x=bF.Bot.x;bC.Pt.y=bF.Bot.y;bC.Pt.z=bF.Bot.z}else{if(aC.IntPoint.op_Equality(bE,bF.Top)){bC.Pt.x=bF.Top.x;bC.Pt.y=bF.Top.y;bC.Pt.z=bF.Top.z}else{this.SetZ(bC.Pt,bF)}}}return bC}};aC.Clipper.prototype.SwapPoints=function(bE,bD){var bC=new aC.IntPoint(bE.Value);bE.Value.x=bD.Value.x;bE.Value.y=bD.Value.y;bD.Value.x=bC.x;bD.Value.y=bC.y};aC.Clipper.prototype.HorzSegmentsOverlap=function(bC,bF,bE,bD){if((bC.x>bE.x)==(bC.x<bD.x)){return true}else{if((bF.x>bE.x)==(bF.x<bD.x)){return true}else{if((bE.x>bC.x)==(bE.x<bF.x)){return true}else{if((bD.x>bC.x)==(bD.x<bF.x)){return true}else{if((bC.x==bE.x)&&(bF.x==bD.x)){return true}else{if((bC.x==bD.x)&&(bF.x==bE.x)){return true}else{return false}}}}}}};aC.Clipper.prototype.InsertPolyPtBetween=function(bF,bE,bD){var bC=new aC.OutPt();bC.Pt.x=bD.x;bC.Pt.y=bD.y;if(bE==bF.Next){bF.Next=bC;bE.Prev=bC;bC.Next=bE;bC.Prev=bF}else{bE.Next=bC;bF.Prev=bC;bC.Next=bF;bC.Prev=bE}return bC};aC.Clipper.prototype.SetHoleState=function(bF,bE){var bD=false;var bC=bF.PrevInAEL;while(bC!==null){if(bC.OutIdx>=0&&bC.WindDelta!=0){bD=!bD;if(bE.FirstLeft===null){bE.FirstLeft=this.m_PolyOuts[bC.OutIdx]}}bC=bC.PrevInAEL}if(bD){bE.IsHole=true}};aC.Clipper.prototype.GetDx=function(bD,bC){if(bD.y==bC.y){return aC.ClipperBase.horizontal}else{return(bC.x-bD.x)/(bC.y-bD.y)}};aC.Clipper.prototype.FirstIsBottomPt=function(bE,bD){var bG=bE.Prev;while((aC.IntPoint.op_Equality(bG.Pt,bE.Pt))&&(bG!=bE)){bG=bG.Prev}var bF=Math.abs(this.GetDx(bE.Pt,bG.Pt));bG=bE.Next;while((aC.IntPoint.op_Equality(bG.Pt,bE.Pt))&&(bG!=bE)){bG=bG.Next}var bI=Math.abs(this.GetDx(bE.Pt,bG.Pt));bG=bD.Prev;while((aC.IntPoint.op_Equality(bG.Pt,bD.Pt))&&(bG!=bD)){bG=bG.Prev}var bH=Math.abs(this.GetDx(bD.Pt,bG.Pt));bG=bD.Next;while((aC.IntPoint.op_Equality(bG.Pt,bD.Pt))&&(bG!=bD)){bG=bG.Next}var bC=Math.abs(this.GetDx(bD.Pt,bG.Pt));return(bF>=bH&&bF>=bC)||(bI>=bH&&bI>=bC)};aC.Clipper.prototype.GetBottomPt=function(bD){var bC=null;var bE=bD.Next;while(bE!=bD){if(bE.Pt.y>bD.Pt.y){bD=bE;bC=null}else{if(bE.Pt.y==bD.Pt.y&&bE.Pt.x<=bD.Pt.x){if(bE.Pt.x<bD.Pt.x){bC=null;bD=bE}else{if(bE.Next!=bD&&bE.Prev!=bD){bC=bE}}}}bE=bE.Next}if(bC!==null){while(bC!=bE){if(!this.FirstIsBottomPt(bE,bC)){bD=bC}bC=bC.Next;while(aC.IntPoint.op_Inequality(bC.Pt,bD.Pt)){bC=bC.Next}}}return bD};aC.Clipper.prototype.GetLowermostRec=function(bF,bD){if(bF.BottomPt===null){bF.BottomPt=this.GetBottomPt(bF.Pts)}if(bD.BottomPt===null){bD.BottomPt=this.GetBottomPt(bD.Pts)}var bE=bF.BottomPt;var bC=bD.BottomPt;if(bE.Pt.y>bC.Pt.y){return bF}else{if(bE.Pt.y<bC.Pt.y){return bD}else{if(bE.Pt.x<bC.Pt.x){return bF}else{if(bE.Pt.x>bC.Pt.x){return bD}else{if(bE.Next==bE){return bD}else{if(bC.Next==bC){return bF}else{if(this.FirstIsBottomPt(bE,bC)){return bF}else{return bD}}}}}}}};aC.Clipper.prototype.Param1RightOfParam2=function(bD,bC){do{bD=bD.FirstLeft;if(bD==bC){return true}}while(bD!==null);return false};aC.Clipper.prototype.GetOutRec=function(bC){var bD=this.m_PolyOuts[bC];while(bD!=this.m_PolyOuts[bD.Idx]){bD=this.m_PolyOuts[bD.Idx]}return bD};aC.Clipper.prototype.AppendPolygon=function(bM,bL){var bC=this.m_PolyOuts[bM.OutIdx];var bO=this.m_PolyOuts[bL.OutIdx];var bN;if(this.Param1RightOfParam2(bC,bO)){bN=bO}else{if(this.Param1RightOfParam2(bO,bC)){bN=bC}else{bN=this.GetLowermostRec(bC,bO)}}var bF=bC.Pts;var bH=bF.Prev;var bE=bO.Pts;var bD=bE.Prev;var bK;if(bM.Side==aC.EdgeSide.esLeft){if(bL.Side==aC.EdgeSide.esLeft){this.ReversePolyPtLinks(bE);bE.Next=bF;bF.Prev=bE;bH.Next=bD;bD.Prev=bH;bC.Pts=bD}else{bD.Next=bF;bF.Prev=bD;bE.Prev=bH;bH.Next=bE;bC.Pts=bE}bK=aC.EdgeSide.esLeft}else{if(bL.Side==aC.EdgeSide.esRight){this.ReversePolyPtLinks(bE);bH.Next=bD;bD.Prev=bH;bE.Next=bF;bF.Prev=bE}else{bH.Next=bE;bE.Prev=bH;bF.Prev=bD;bD.Next=bF}bK=aC.EdgeSide.esRight}bC.BottomPt=null;if(bN==bO){if(bO.FirstLeft!=bC){bC.FirstLeft=bO.FirstLeft}bC.IsHole=bO.IsHole}bO.Pts=null;bO.BottomPt=null;bO.FirstLeft=bC;var bG=bM.OutIdx;var bI=bL.OutIdx;bM.OutIdx=-1;bL.OutIdx=-1;var bJ=this.m_ActiveEdges;while(bJ!==null){if(bJ.OutIdx==bI){bJ.OutIdx=bG;bJ.Side=bK;break}bJ=bJ.NextInAEL}bO.Idx=bC.Idx};aC.Clipper.prototype.ReversePolyPtLinks=function(bE){if(bE===null){return}var bD;var bC;bD=bE;do{bC=bD.Next;bD.Next=bD.Prev;bD.Prev=bC;bD=bC}while(bD!=bE)};aC.Clipper.SwapSides=function(bD,bC){var bE=bD.Side;bD.Side=bC.Side;bC.Side=bE};aC.Clipper.SwapPolyIndexes=function(bD,bC){var bE=bD.OutIdx;bD.OutIdx=bC.OutIdx;bC.OutIdx=bE};aC.Clipper.prototype.IntersectEdges=function(bN,bJ,bR,bE){var bK=!bE&&bN.NextInLML===null&&bN.Top.x==bR.x&&bN.Top.y==bR.y;var bS=!bE&&bJ.NextInLML===null&&bJ.Top.x==bR.x&&bJ.Top.y==bR.y;var bG=(bN.OutIdx>=0);var bO=(bJ.OutIdx>=0);if(Z){if(bN.WindDelta===0||bJ.WindDelta===0){if(bN.WindDelta===0&&bJ.WindDelta===0){if((bK||bS)&&bG&&bO){this.AddLocalMaxPoly(bN,bJ,bR)}}else{if(bN.PolyTyp==bJ.PolyTyp&&bN.WindDelta!=bJ.WindDelta&&this.m_ClipType==aC.ClipType.ctUnion){if(bN.WindDelta===0){if(bO){this.AddOutPt(bN,bR);if(bG){bN.OutIdx=-1}}}else{if(bG){this.AddOutPt(bJ,bR);if(bO){bJ.OutIdx=-1}}}}else{if(bN.PolyTyp!=bJ.PolyTyp){if((bN.WindDelta===0)&&Math.abs(bJ.WindCnt)==1&&(this.m_ClipType!=aC.ClipType.ctUnion||bJ.WindCnt2===0)){this.AddOutPt(bN,bR);if(bG){bN.OutIdx=-1}}else{if((bJ.WindDelta===0)&&(Math.abs(bN.WindCnt)==1)&&(this.m_ClipType!=aC.ClipType.ctUnion||bN.WindCnt2===0)){this.AddOutPt(bJ,bR);if(bO){bJ.OutIdx=-1}}}}}}if(bK){if(bN.OutIdx<0){this.DeleteFromAEL(bN)}else{aC.Error("Error intersecting polylines")}}if(bS){if(bJ.OutIdx<0){this.DeleteFromAEL(bJ)}else{aC.Error("Error intersecting polylines")}}return}}if(bN.PolyTyp==bJ.PolyTyp){if(this.IsEvenOddFillType(bN)){var bD=bN.WindCnt;bN.WindCnt=bJ.WindCnt;bJ.WindCnt=bD}else{if(bN.WindCnt+bJ.WindDelta===0){bN.WindCnt=-bN.WindCnt}else{bN.WindCnt+=bJ.WindDelta}if(bJ.WindCnt-bN.WindDelta===0){bJ.WindCnt=-bJ.WindCnt}else{bJ.WindCnt-=bN.WindDelta}}}else{if(!this.IsEvenOddFillType(bJ)){bN.WindCnt2+=bJ.WindDelta}else{bN.WindCnt2=(bN.WindCnt2===0)?1:0}if(!this.IsEvenOddFillType(bN)){bJ.WindCnt2-=bN.WindDelta}else{bJ.WindCnt2=(bJ.WindCnt2===0)?1:0}}var bQ,bF,bC,bI;if(bN.PolyTyp==aC.PolyType.ptSubject){bQ=this.m_SubjFillType;bC=this.m_ClipFillType}else{bQ=this.m_ClipFillType;bC=this.m_SubjFillType}if(bJ.PolyTyp==aC.PolyType.ptSubject){bF=this.m_SubjFillType;bI=this.m_ClipFillType}else{bF=this.m_ClipFillType;bI=this.m_SubjFillType}var bM,bP;switch(bQ){case aC.PolyFillType.pftPositive:bM=bN.WindCnt;break;case aC.PolyFillType.pftNegative:bM=-bN.WindCnt;break;default:bM=Math.abs(bN.WindCnt);break}switch(bF){case aC.PolyFillType.pftPositive:bP=bJ.WindCnt;break;case aC.PolyFillType.pftNegative:bP=-bJ.WindCnt;break;default:bP=Math.abs(bJ.WindCnt);break}if(bG&&bO){if(bK||bS||(bM!==0&&bM!=1)||(bP!==0&&bP!=1)||(bN.PolyTyp!=bJ.PolyTyp&&this.m_ClipType!=aC.ClipType.ctXor)){this.AddLocalMaxPoly(bN,bJ,bR)}else{this.AddOutPt(bN,bR);this.AddOutPt(bJ,bR);aC.Clipper.SwapSides(bN,bJ);aC.Clipper.SwapPolyIndexes(bN,bJ)}}else{if(bG){if(bP===0||bP==1){this.AddOutPt(bN,bR);aC.Clipper.SwapSides(bN,bJ);aC.Clipper.SwapPolyIndexes(bN,bJ)}}else{if(bO){if(bM===0||bM==1){this.AddOutPt(bJ,bR);aC.Clipper.SwapSides(bN,bJ);aC.Clipper.SwapPolyIndexes(bN,bJ)}}else{if((bM===0||bM==1)&&(bP===0||bP==1)&&!bK&&!bS){var bL,bH;switch(bC){case aC.PolyFillType.pftPositive:bL=bN.WindCnt2;break;case aC.PolyFillType.pftNegative:bL=-bN.WindCnt2;break;default:bL=Math.abs(bN.WindCnt2);break}switch(bI){case aC.PolyFillType.pftPositive:bH=bJ.WindCnt2;break;case aC.PolyFillType.pftNegative:bH=-bJ.WindCnt2;break;default:bH=Math.abs(bJ.WindCnt2);break}if(bN.PolyTyp!=bJ.PolyTyp){this.AddLocalMinPoly(bN,bJ,bR)}else{if(bM==1&&bP==1){switch(this.m_ClipType){case aC.ClipType.ctIntersection:if(bL>0&&bH>0){this.AddLocalMinPoly(bN,bJ,bR)}break;case aC.ClipType.ctUnion:if(bL<=0&&bH<=0){this.AddLocalMinPoly(bN,bJ,bR)}break;case aC.ClipType.ctDifference:if(((bN.PolyTyp==aC.PolyType.ptClip)&&(bL>0)&&(bH>0))||((bN.PolyTyp==aC.PolyType.ptSubject)&&(bL<=0)&&(bH<=0))){this.AddLocalMinPoly(bN,bJ,bR)}break;case aC.ClipType.ctXor:this.AddLocalMinPoly(bN,bJ,bR);break}}else{aC.Clipper.SwapSides(bN,bJ)}}}}}}if((bK!=bS)&&((bK&&(bN.OutIdx>=0))||(bS&&(bJ.OutIdx>=0)))){aC.Clipper.SwapSides(bN,bJ);aC.Clipper.SwapPolyIndexes(bN,bJ)}if(bK){this.DeleteFromAEL(bN)}if(bS){this.DeleteFromAEL(bJ)}};aC.Clipper.prototype.DeleteFromAEL=function(bC){var bE=bC.PrevInAEL;var bD=bC.NextInAEL;if(bE===null&&bD===null&&(bC!=this.m_ActiveEdges)){return}if(bE!==null){bE.NextInAEL=bD}else{this.m_ActiveEdges=bD}if(bD!==null){bD.PrevInAEL=bE}bC.NextInAEL=null;bC.PrevInAEL=null};aC.Clipper.prototype.DeleteFromSEL=function(bE){var bD=bE.PrevInSEL;var bC=bE.NextInSEL;if(bD===null&&bC===null&&(bE!=this.m_SortedEdges)){return}if(bD!==null){bD.NextInSEL=bC}else{this.m_SortedEdges=bC}if(bC!==null){bC.PrevInSEL=bD}bE.NextInSEL=null;bE.PrevInSEL=null};aC.Clipper.prototype.UpdateEdgeIntoAEL=function(bC){if(bC.NextInLML===null){aC.Error("UpdateEdgeIntoAEL: invalid call")}var bE=bC.PrevInAEL;var bD=bC.NextInAEL;bC.NextInLML.OutIdx=bC.OutIdx;if(bE!==null){bE.NextInAEL=bC.NextInLML}else{this.m_ActiveEdges=bC.NextInLML}if(bD!==null){bD.PrevInAEL=bC.NextInLML}bC.NextInLML.Side=bC.Side;bC.NextInLML.WindDelta=bC.WindDelta;bC.NextInLML.WindCnt=bC.WindCnt;bC.NextInLML.WindCnt2=bC.WindCnt2;bC=bC.NextInLML;bC.Curr.x=bC.Bot.x;bC.Curr.y=bC.Bot.y;bC.PrevInAEL=bE;bC.NextInAEL=bD;if(!aC.ClipperBase.IsHorizontal(bC)){this.InsertScanbeam(bC.Top.y)}return bC};aC.Clipper.prototype.ProcessHorizontals=function(bC){var bD=this.m_SortedEdges;while(bD!==null){this.DeleteFromSEL(bD);this.ProcessHorizontal(bD,bC);bD=this.m_SortedEdges}};aC.Clipper.prototype.GetHorzDirection=function(bD,bC){if(bD.Bot.x<bD.Top.x){bC.Left=bD.Bot.x;bC.Right=bD.Top.x;bC.Dir=aC.Direction.dLeftToRight}else{bC.Left=bD.Top.x;bC.Right=bD.Bot.x;bC.Dir=aC.Direction.dRightToLeft}};aC.Clipper.prototype.PrepareHorzJoins=function(bE,bC){var bD=this.m_PolyOuts[bE.OutIdx].Pts;if(bE.Side!=aC.EdgeSide.esLeft){bD=bD.Prev}if(bC){if(aC.IntPoint.op_Equality(bD.Pt,bE.Top)){this.AddGhostJoin(bD,bE.Bot)}else{this.AddGhostJoin(bD,bE.Top)}}};aC.Clipper.prototype.ProcessHorizontal=function(bJ,bQ){var bL={Dir:null,Left:null,Right:null};this.GetHorzDirection(bJ,bL);var bH=bL.Dir;var bK=bL.Left;var bE=bL.Right;var bI=bJ,bN=null;while(bI.NextInLML!==null&&aC.ClipperBase.IsHorizontal(bI.NextInLML)){bI=bI.NextInLML}if(bI.NextInLML===null){bN=this.GetMaximaPair(bI)}for(;;){var bG=(bJ==bI);var bM=this.GetNextInAEL(bJ,bH);while(bM!==null){if(bM.Curr.x==bJ.Top.x&&bJ.NextInLML!==null&&bM.Dx<bJ.NextInLML.Dx){break}var bD=this.GetNextInAEL(bM,bH);if((bH==aC.Direction.dLeftToRight&&bM.Curr.x<=bE)||(bH==aC.Direction.dRightToLeft&&bM.Curr.x>=bK)){if(bJ.OutIdx>=0&&bJ.WindDelta!=0){this.PrepareHorzJoins(bJ,bQ)}if(bM==bN&&bG){if(bH==aC.Direction.dLeftToRight){this.IntersectEdges(bJ,bM,bM.Top,false)}else{this.IntersectEdges(bM,bJ,bM.Top,false)}if(bN.OutIdx>=0){aC.Error("ProcessHorizontal error")}return}else{if(bH==aC.Direction.dLeftToRight){var bF=new aC.IntPoint(bM.Curr.x,bJ.Curr.y);this.IntersectEdges(bJ,bM,bF,true)}else{var bF=new aC.IntPoint(bM.Curr.x,bJ.Curr.y);this.IntersectEdges(bM,bJ,bF,true)}}this.SwapPositionsInAEL(bJ,bM)}else{if((bH==aC.Direction.dLeftToRight&&bM.Curr.x>=bE)||(bH==aC.Direction.dRightToLeft&&bM.Curr.x<=bK)){break}}bM=bD}if(bJ.OutIdx>=0&&bJ.WindDelta!==0){this.PrepareHorzJoins(bJ,bQ)}if(bJ.NextInLML!==null&&aC.ClipperBase.IsHorizontal(bJ.NextInLML)){bJ=this.UpdateEdgeIntoAEL(bJ);if(bJ.OutIdx>=0){this.AddOutPt(bJ,bJ.Bot)}var bL={Dir:bH,Left:bK,Right:bE};this.GetHorzDirection(bJ,bL);bH=bL.Dir;bK=bL.Left;bE=bL.Right}else{break}}if(bJ.NextInLML!==null){if(bJ.OutIdx>=0){var bC=this.AddOutPt(bJ,bJ.Top);bJ=this.UpdateEdgeIntoAEL(bJ);if(bJ.WindDelta===0){return}var bO=bJ.PrevInAEL;var bD=bJ.NextInAEL;if(bO!==null&&bO.Curr.x==bJ.Bot.x&&bO.Curr.y==bJ.Bot.y&&bO.WindDelta!==0&&(bO.OutIdx>=0&&bO.Curr.y>bO.Top.y&&aC.ClipperBase.SlopesEqual(bJ,bO,this.m_UseFullRange))){var bP=this.AddOutPt(bO,bJ.Bot);this.AddJoin(bC,bP,bJ.Top)}else{if(bD!==null&&bD.Curr.x==bJ.Bot.x&&bD.Curr.y==bJ.Bot.y&&bD.WindDelta!==0&&bD.OutIdx>=0&&bD.Curr.y>bD.Top.y&&aC.ClipperBase.SlopesEqual(bJ,bD,this.m_UseFullRange)){var bP=this.AddOutPt(bD,bJ.Bot);this.AddJoin(bC,bP,bJ.Top)}}}else{bJ=this.UpdateEdgeIntoAEL(bJ)}}else{if(bN!==null){if(bN.OutIdx>=0){if(bH==aC.Direction.dLeftToRight){this.IntersectEdges(bJ,bN,bJ.Top,false)}else{this.IntersectEdges(bN,bJ,bJ.Top,false)}if(bN.OutIdx>=0){aC.Error("ProcessHorizontal error")}}else{this.DeleteFromAEL(bJ);this.DeleteFromAEL(bN)}}else{if(bJ.OutIdx>=0){this.AddOutPt(bJ,bJ.Top)}this.DeleteFromAEL(bJ)}}};aC.Clipper.prototype.GetNextInAEL=function(bD,bC){return bC==aC.Direction.dLeftToRight?bD.NextInAEL:bD.PrevInAEL};aC.Clipper.prototype.IsMinima=function(bC){return bC!==null&&(bC.Prev.NextInLML!=bC)&&(bC.Next.NextInLML!=bC)};aC.Clipper.prototype.IsMaxima=function(bC,bD){return(bC!==null&&bC.Top.y==bD&&bC.NextInLML===null)};aC.Clipper.prototype.IsIntermediate=function(bC,bD){return(bC.Top.y==bD&&bC.NextInLML!==null)};aC.Clipper.prototype.GetMaximaPair=function(bD){var bC=null;if((aC.IntPoint.op_Equality(bD.Next.Top,bD.Top))&&bD.Next.NextInLML===null){bC=bD.Next}else{if((aC.IntPoint.op_Equality(bD.Prev.Top,bD.Top))&&bD.Prev.NextInLML===null){bC=bD.Prev}}if(bC!==null&&(bC.OutIdx==-2||(bC.NextInAEL==bC.PrevInAEL&&!aC.ClipperBase.IsHorizontal(bC)))){return null}return bC};aC.Clipper.prototype.ProcessIntersections=function(bE,bC){if(this.m_ActiveEdges==null){return true}try{this.BuildIntersectList(bE,bC);if(this.m_IntersectList.length==0){return true}if(this.m_IntersectList.length==1||this.FixupIntersectionOrder()){this.ProcessIntersectList()}else{return false}}catch(bD){this.m_SortedEdges=null;this.m_IntersectList.length=0;aC.Error("ProcessIntersections error")}this.m_SortedEdges=null;return true};aC.Clipper.prototype.BuildIntersectList=function(bI,bD){if(this.m_ActiveEdges===null){return}var bH=this.m_ActiveEdges;this.m_SortedEdges=bH;while(bH!==null){bH.PrevInSEL=bH.PrevInAEL;bH.NextInSEL=bH.NextInAEL;bH.Curr.x=aC.Clipper.TopX(bH,bD);bH=bH.NextInAEL}var bC=true;while(bC&&this.m_SortedEdges!==null){bC=false;bH=this.m_SortedEdges;while(bH.NextInSEL!==null){var bE=bH.NextInSEL;var bG=new aC.IntPoint();if(bH.Curr.x>bE.Curr.x){if(!this.IntersectPoint(bH,bE,bG)&&bH.Curr.x>bE.Curr.x+1){aC.Error("Intersection error")}if(bG.y>bI){bG.y=bI;if(Math.abs(bH.Dx)>Math.abs(bE.Dx)){bG.x=aC.Clipper.TopX(bE,bI)}else{bG.x=aC.Clipper.TopX(bH,bI)}}var bF=new aC.IntersectNode();bF.Edge1=bH;bF.Edge2=bE;bF.Pt.x=bG.x;bF.Pt.y=bG.y;this.m_IntersectList.push(bF);this.SwapPositionsInSEL(bH,bE);bC=true}else{bH=bE}}if(bH.PrevInSEL!==null){bH.PrevInSEL.NextInSEL=null}else{break}}this.m_SortedEdges=null};aC.Clipper.prototype.EdgesAdjacent=function(bC){return(bC.Edge1.NextInSEL==bC.Edge2)||(bC.Edge1.PrevInSEL==bC.Edge2)};aC.Clipper.IntersectNodeSort=function(bD,bC){return(bC.Pt.y-bD.Pt.y)};aC.Clipper.prototype.FixupIntersectionOrder=function(){this.m_IntersectList.sort(this.m_IntersectNodeComparer);this.CopyAELToSEL();var bF=this.m_IntersectList.length;for(var bE=0;bE<bF;bE++){if(!this.EdgesAdjacent(this.m_IntersectList[bE])){var bC=bE+1;while(bC<bF&&!this.EdgesAdjacent(this.m_IntersectList[bC])){bC++}if(bC==bF){return false}var bD=this.m_IntersectList[bE];this.m_IntersectList[bE]=this.m_IntersectList[bC];this.m_IntersectList[bC]=bD}this.SwapPositionsInSEL(this.m_IntersectList[bE].Edge1,this.m_IntersectList[bE].Edge2)}return true};aC.Clipper.prototype.ProcessIntersectList=function(){for(var bD=0,bC=this.m_IntersectList.length;bD<bC;bD++){var bE=this.m_IntersectList[bD];this.IntersectEdges(bE.Edge1,bE.Edge2,bE.Pt,true);this.SwapPositionsInAEL(bE.Edge1,bE.Edge2)}this.m_IntersectList.length=0};var av=function(bC){return bC<0?Math.ceil(bC-0.5):Math.round(bC)};var au=function(bC){return bC<0?Math.ceil(bC-0.5):Math.floor(bC+0.5)};var at=function(bC){return bC<0?-Math.round(Math.abs(bC)):Math.round(bC)};var aq=function(bC){if(bC<0){bC-=0.5;return bC<-2147483648?Math.ceil(bC):bC|0}else{bC+=0.5;return bC>2147483647?Math.floor(bC):bC|0}};if(bc.msie){aC.Clipper.Round=av}else{if(bc.chromium){aC.Clipper.Round=at}else{if(bc.safari){aC.Clipper.Round=aq}else{aC.Clipper.Round=au}}}aC.Clipper.TopX=function(bD,bC){if(bC==bD.Top.y){return bD.Top.x}return bD.Bot.x+aC.Clipper.Round(bD.Dx*(bC-bD.Bot.y))};aC.Clipper.prototype.IntersectPoint=function(bE,bC,bH){bH.x=0;bH.y=0;var bF,bD;if(aC.ClipperBase.SlopesEqual(bE,bC,this.m_UseFullRange)||bE.Dx==bC.Dx){if(bC.Bot.y>bE.Bot.y){bH.x=bC.Bot.x;bH.y=bC.Bot.y}else{bH.x=bE.Bot.x;bH.y=bE.Bot.y}return false}else{if(bE.Delta.x===0){bH.x=bE.Bot.x;if(aC.ClipperBase.IsHorizontal(bC)){bH.y=bC.Bot.y}else{bD=bC.Bot.y-(bC.Bot.x/bC.Dx);bH.y=aC.Clipper.Round(bH.x/bC.Dx+bD)}}else{if(bC.Delta.x===0){bH.x=bC.Bot.x;if(aC.ClipperBase.IsHorizontal(bE)){bH.y=bE.Bot.y}else{bF=bE.Bot.y-(bE.Bot.x/bE.Dx);bH.y=aC.Clipper.Round(bH.x/bE.Dx+bF)}}else{bF=bE.Bot.x-bE.Bot.y*bE.Dx;bD=bC.Bot.x-bC.Bot.y*bC.Dx;var bG=(bD-bF)/(bE.Dx-bC.Dx);bH.y=aC.Clipper.Round(bG);if(Math.abs(bE.Dx)<Math.abs(bC.Dx)){bH.x=aC.Clipper.Round(bE.Dx*bG+bF)}else{bH.x=aC.Clipper.Round(bC.Dx*bG+bD)}}}}if(bH.y<bE.Top.y||bH.y<bC.Top.y){if(bE.Top.y>bC.Top.y){bH.y=bE.Top.y;bH.x=aC.Clipper.TopX(bC,bE.Top.y);return bH.x<bE.Top.x}else{bH.y=bC.Top.y}if(Math.abs(bE.Dx)<Math.abs(bC.Dx)){bH.x=aC.Clipper.TopX(bE,bH.y)}else{bH.x=aC.Clipper.TopX(bC,bH.y)}}return true};aC.Clipper.prototype.ProcessEdgesAtTopOfScanbeam=function(bD){var bI=this.m_ActiveEdges;while(bI!==null){var bC=this.IsMaxima(bI,bD);if(bC){var bH=this.GetMaximaPair(bI);bC=(bH===null||!aC.ClipperBase.IsHorizontal(bH))}if(bC){var bG=bI.PrevInAEL;this.DoMaxima(bI);if(bG===null){bI=this.m_ActiveEdges}else{bI=bG.NextInAEL}}else{if(this.IsIntermediate(bI,bD)&&aC.ClipperBase.IsHorizontal(bI.NextInLML)){bI=this.UpdateEdgeIntoAEL(bI);if(bI.OutIdx>=0){this.AddOutPt(bI,bI.Bot)}this.AddEdgeToSEL(bI)}else{bI.Curr.x=aC.Clipper.TopX(bI,bD);bI.Curr.y=bD}if(this.StrictlySimple){var bG=bI.PrevInAEL;if((bI.OutIdx>=0)&&(bI.WindDelta!==0)&&bG!==null&&(bG.OutIdx>=0)&&(bG.Curr.x==bI.Curr.x)&&(bG.WindDelta!==0)){var bJ=this.AddOutPt(bG,bI.Curr);var bF=this.AddOutPt(bI,bI.Curr);this.AddJoin(bJ,bF,bI.Curr)}}bI=bI.NextInAEL}}this.ProcessHorizontals(true);bI=this.m_ActiveEdges;while(bI!==null){if(this.IsIntermediate(bI,bD)){var bJ=null;if(bI.OutIdx>=0){bJ=this.AddOutPt(bI,bI.Top)}bI=this.UpdateEdgeIntoAEL(bI);var bG=bI.PrevInAEL;var bE=bI.NextInAEL;if(bG!==null&&bG.Curr.x==bI.Bot.x&&bG.Curr.y==bI.Bot.y&&bJ!==null&&bG.OutIdx>=0&&bG.Curr.y>bG.Top.y&&aC.ClipperBase.SlopesEqual(bI,bG,this.m_UseFullRange)&&(bI.WindDelta!==0)&&(bG.WindDelta!==0)){var bF=this.AddOutPt(bG,bI.Bot);this.AddJoin(bJ,bF,bI.Top)}else{if(bE!==null&&bE.Curr.x==bI.Bot.x&&bE.Curr.y==bI.Bot.y&&bJ!==null&&bE.OutIdx>=0&&bE.Curr.y>bE.Top.y&&aC.ClipperBase.SlopesEqual(bI,bE,this.m_UseFullRange)&&(bI.WindDelta!==0)&&(bE.WindDelta!==0)){var bF=this.AddOutPt(bE,bI.Bot);this.AddJoin(bJ,bF,bI.Top)}}}bI=bI.NextInAEL}};aC.Clipper.prototype.DoMaxima=function(bF){var bE=this.GetMaximaPair(bF);if(bE===null){if(bF.OutIdx>=0){this.AddOutPt(bF,bF.Top)}this.DeleteFromAEL(bF);return}var bD=bF.NextInAEL;var bC=true;while(bD!==null&&bD!=bE){this.IntersectEdges(bF,bD,bF.Top,true);this.SwapPositionsInAEL(bF,bD);bD=bF.NextInAEL}if(bF.OutIdx==-1&&bE.OutIdx==-1){this.DeleteFromAEL(bF);this.DeleteFromAEL(bE)}else{if(bF.OutIdx>=0&&bE.OutIdx>=0){this.IntersectEdges(bF,bE,bF.Top,false)}else{if(bC&&bF.WindDelta===0){if(bF.OutIdx>=0){this.AddOutPt(bF,bF.Top);bF.OutIdx=-1}this.DeleteFromAEL(bF);if(bE.OutIdx>=0){this.AddOutPt(bE,bF.Top);bE.OutIdx=-1}this.DeleteFromAEL(bE)}else{aC.Error("DoMaxima error")}}}};aC.Clipper.ReversePaths=function(bD){for(var bE=0,bC=bD.length;bE<bC;bE++){bD[bE].reverse()}};aC.Clipper.Orientation=function(bC){return aC.Clipper.Area(bC)>=0};aC.Clipper.prototype.PointCount=function(bE){if(bE===null){return 0}var bC=0;var bD=bE;do{bC++;bD=bD.Next}while(bD!=bE);return bC};aC.Clipper.prototype.BuildResult=function(bC){aC.Clear(bC);for(var bG=0,bF=this.m_PolyOuts.length;bG<bF;bG++){var bI=this.m_PolyOuts[bG];if(bI.Pts===null){continue}var bH=bI.Pts.Prev;var bE=this.PointCount(bH);if(bE<2){continue}var bJ=new Array(bE);for(var bD=0;bD<bE;bD++){bJ[bD]=bH.Pt;bH=bH.Prev}bC.push(bJ)}};aC.Clipper.prototype.BuildResult2=function(bC){bC.Clear();for(var bH=0,bG=this.m_PolyOuts.length;bH<bG;bH++){var bI=this.m_PolyOuts[bH];var bF=this.PointCount(bI.Pts);if((bI.IsOpen&&bF<2)||(!bI.IsOpen&&bF<3)){continue}this.FixHoleLinkage(bI);var bE=new aC.PolyNode();bC.m_AllPolys.push(bE);bI.PolyNode=bE;bE.m_polygon.length=bF;var bJ=bI.Pts.Prev;for(var bD=0;bD<bF;bD++){bE.m_polygon[bD]=bJ.Pt;bJ=bJ.Prev}}for(var bH=0,bG=this.m_PolyOuts.length;bH<bG;bH++){var bI=this.m_PolyOuts[bH];if(bI.PolyNode===null){continue}else{if(bI.IsOpen){bI.PolyNode.IsOpen=true;bC.AddChild(bI.PolyNode)}else{if(bI.FirstLeft!==null&&bI.FirstLeft.PolyNode!=null){bI.FirstLeft.PolyNode.AddChild(bI.PolyNode)}else{bC.AddChild(bI.PolyNode)}}}}};aC.Clipper.prototype.FixupOutPolygon=function(bF){var bD=null;bF.BottomPt=null;var bC=bF.Pts;for(;;){if(bC.Prev==bC||bC.Prev==bC.Next){this.DisposeOutPts(bC);bF.Pts=null;return}if((aC.IntPoint.op_Equality(bC.Pt,bC.Next.Pt))||(aC.IntPoint.op_Equality(bC.Pt,bC.Prev.Pt))||(aC.ClipperBase.SlopesEqual(bC.Prev.Pt,bC.Pt,bC.Next.Pt,this.m_UseFullRange)&&(!this.PreserveCollinear||!this.Pt2IsBetweenPt1AndPt3(bC.Prev.Pt,bC.Pt,bC.Next.Pt)))){bD=null;var bE=bC;bC.Prev.Next=bC.Next;bC.Next.Prev=bC.Prev;bC=bC.Prev;bE=null}else{if(bC==bD){break}else{if(bD===null){bD=bC}bC=bC.Next}}}bF.Pts=bC};aC.Clipper.prototype.DupOutPt=function(bD,bE){var bC=new aC.OutPt();bC.Pt.x=bD.Pt.x;bC.Pt.y=bD.Pt.y;bC.Idx=bD.Idx;if(bE){bC.Next=bD.Next;bC.Prev=bD;bD.Next.Prev=bC;bD.Next=bC}else{bC.Prev=bD.Prev;bC.Next=bD;bD.Prev.Next=bC;bD.Prev=bC}return bC};aC.Clipper.prototype.GetOverlap=function(bE,bD,bG,bF,bC){if(bE<bD){if(bG<bF){bC.Left=Math.max(bE,bG);bC.Right=Math.min(bD,bF)}else{bC.Left=Math.max(bE,bF);bC.Right=Math.min(bD,bG)}}else{if(bG<bF){bC.Left=Math.max(bD,bG);bC.Right=Math.min(bE,bF)}else{bC.Left=Math.max(bD,bF);bC.Right=Math.min(bE,bG)}}return bC.Left<bC.Right};aC.Clipper.prototype.JoinHorz=function(bG,bJ,bE,bC,bI,bH){var bF=(bG.Pt.x>bJ.Pt.x?aC.Direction.dRightToLeft:aC.Direction.dLeftToRight);var bD=(bE.Pt.x>bC.Pt.x?aC.Direction.dRightToLeft:aC.Direction.dLeftToRight);if(bF==bD){return false}if(bF==aC.Direction.dLeftToRight){while(bG.Next.Pt.x<=bI.x&&bG.Next.Pt.x>=bG.Pt.x&&bG.Next.Pt.y==bI.y){bG=bG.Next}if(bH&&(bG.Pt.x!=bI.x)){bG=bG.Next}bJ=this.DupOutPt(bG,!bH);if(aC.IntPoint.op_Inequality(bJ.Pt,bI)){bG=bJ;bG.Pt.x=bI.x;bG.Pt.y=bI.y;bJ=this.DupOutPt(bG,!bH)}}else{while(bG.Next.Pt.x>=bI.x&&bG.Next.Pt.x<=bG.Pt.x&&bG.Next.Pt.y==bI.y){bG=bG.Next}if(!bH&&(bG.Pt.x!=bI.x)){bG=bG.Next}bJ=this.DupOutPt(bG,bH);if(aC.IntPoint.op_Inequality(bJ.Pt,bI)){bG=bJ;bG.Pt.x=bI.x;bG.Pt.y=bI.y;bJ=this.DupOutPt(bG,bH)}}if(bD==aC.Direction.dLeftToRight){while(bE.Next.Pt.x<=bI.x&&bE.Next.Pt.x>=bE.Pt.x&&bE.Next.Pt.y==bI.y){bE=bE.Next}if(bH&&(bE.Pt.x!=bI.x)){bE=bE.Next}bC=this.DupOutPt(bE,!bH);if(aC.IntPoint.op_Inequality(bC.Pt,bI)){bE=bC;bE.Pt.x=bI.x;bE.Pt.y=bI.y;bC=this.DupOutPt(bE,!bH)}}else{while(bE.Next.Pt.x>=bI.x&&bE.Next.Pt.x<=bE.Pt.x&&bE.Next.Pt.y==bI.y){bE=bE.Next}if(!bH&&(bE.Pt.x!=bI.x)){bE=bE.Next}bC=this.DupOutPt(bE,bH);if(aC.IntPoint.op_Inequality(bC.Pt,bI)){bE=bC;bE.Pt.x=bI.x;bE.Pt.y=bI.y;bC=this.DupOutPt(bE,bH)}}if((bF==aC.Direction.dLeftToRight)==bH){bG.Prev=bE;bE.Next=bG;bJ.Next=bC;bC.Prev=bJ}else{bG.Next=bE;bE.Prev=bG;bJ.Prev=bC;bC.Next=bJ}return true};aC.Clipper.prototype.JoinPoints=function(bI,bC,bR){var bD=bI.OutPt1,bE=new aC.OutPt();var bS=bI.OutPt2,bO=new aC.OutPt();var bP=(bI.OutPt1.Pt.y==bI.OffPt.y);if(bP&&(aC.IntPoint.op_Equality(bI.OffPt,bI.OutPt1.Pt))&&(aC.IntPoint.op_Equality(bI.OffPt,bI.OutPt2.Pt))){bE=bI.OutPt1.Next;while(bE!=bD&&(aC.IntPoint.op_Equality(bE.Pt,bI.OffPt))){bE=bE.Next}var bN=(bE.Pt.y>bI.OffPt.y);bO=bI.OutPt2.Next;while(bO!=bS&&(aC.IntPoint.op_Equality(bO.Pt,bI.OffPt))){bO=bO.Next}var bK=(bO.Pt.y>bI.OffPt.y);if(bN==bK){return false}if(bN){bE=this.DupOutPt(bD,false);bO=this.DupOutPt(bS,true);bD.Prev=bS;bS.Next=bD;bE.Next=bO;bO.Prev=bE;bI.OutPt1=bD;bI.OutPt2=bE;return true}else{bE=this.DupOutPt(bD,true);bO=this.DupOutPt(bS,false);bD.Next=bS;bS.Prev=bD;bE.Prev=bO;bO.Next=bE;bI.OutPt1=bD;bI.OutPt2=bE;return true}}else{if(bP){bE=bD;while(bD.Prev.Pt.y==bD.Pt.y&&bD.Prev!=bE&&bD.Prev!=bS){bD=bD.Prev}while(bE.Next.Pt.y==bE.Pt.y&&bE.Next!=bD&&bE.Next!=bS){bE=bE.Next}if(bE.Next==bD||bE.Next==bS){return false}bO=bS;while(bS.Prev.Pt.y==bS.Pt.y&&bS.Prev!=bO&&bS.Prev!=bE){bS=bS.Prev}while(bO.Next.Pt.y==bO.Pt.y&&bO.Next!=bS&&bO.Next!=bD){bO=bO.Next}if(bO.Next==bS||bO.Next==bD){return false}var bQ={Left:null,Right:null};if(!this.GetOverlap(bD.Pt.x,bE.Pt.x,bS.Pt.x,bO.Pt.x,bQ)){return false}var bJ=bQ.Left;var bM=bQ.Right;var bF=new aC.IntPoint();var bL;if(bD.Pt.x>=bJ&&bD.Pt.x<=bM){bF.x=bD.Pt.x;bF.y=bD.Pt.y;bL=(bD.Pt.x>bE.Pt.x)}else{if(bS.Pt.x>=bJ&&bS.Pt.x<=bM){bF.x=bS.Pt.x;bF.y=bS.Pt.y;bL=(bS.Pt.x>bO.Pt.x)}else{if(bE.Pt.x>=bJ&&bE.Pt.x<=bM){bF.x=bE.Pt.x;bF.y=bE.Pt.y;bL=bE.Pt.x>bD.Pt.x}else{bF.x=bO.Pt.x;bF.y=bO.Pt.y;bL=(bO.Pt.x>bS.Pt.x)}}}bI.OutPt1=bD;bI.OutPt2=bS;return this.JoinHorz(bD,bE,bS,bO,bF,bL)}else{bE=bD.Next;while((aC.IntPoint.op_Equality(bE.Pt,bD.Pt))&&(bE!=bD)){bE=bE.Next}var bH=((bE.Pt.y>bD.Pt.y)||!aC.ClipperBase.SlopesEqual(bD.Pt,bE.Pt,bI.OffPt,this.m_UseFullRange));if(bH){bE=bD.Prev;while((aC.IntPoint.op_Equality(bE.Pt,bD.Pt))&&(bE!=bD)){bE=bE.Prev}if((bE.Pt.y>bD.Pt.y)||!aC.ClipperBase.SlopesEqual(bD.Pt,bE.Pt,bI.OffPt,this.m_UseFullRange)){return false}}bO=bS.Next;while((aC.IntPoint.op_Equality(bO.Pt,bS.Pt))&&(bO!=bS)){bO=bO.Next}var bG=((bO.Pt.y>bS.Pt.y)||!aC.ClipperBase.SlopesEqual(bS.Pt,bO.Pt,bI.OffPt,this.m_UseFullRange));if(bG){bO=bS.Prev;while((aC.IntPoint.op_Equality(bO.Pt,bS.Pt))&&(bO!=bS)){bO=bO.Prev}if((bO.Pt.y>bS.Pt.y)||!aC.ClipperBase.SlopesEqual(bS.Pt,bO.Pt,bI.OffPt,this.m_UseFullRange)){return false}}if((bE==bD)||(bO==bS)||(bE==bO)||((bC==bR)&&(bH==bG))){return false}if(bH){bE=this.DupOutPt(bD,false);bO=this.DupOutPt(bS,true);bD.Prev=bS;bS.Next=bD;bE.Next=bO;bO.Prev=bE;bI.OutPt1=bD;bI.OutPt2=bE;return true}else{bE=this.DupOutPt(bD,true);bO=this.DupOutPt(bS,false);bD.Next=bS;bS.Prev=bD;bE.Prev=bO;bO.Next=bE;bI.OutPt1=bD;bI.OutPt2=bE;return true}}}};aC.Clipper.GetBounds=function(bH){var bG=0,bF=bH.length;while(bG<bF&&bH[bG].length==0){bG++}if(bG==bF){return new aC.IntRect(0,0,0,0)}var bC=new aC.IntRect();bC.left=bH[bG][0].x;bC.right=bC.left;bC.top=bH[bG][0].y;bC.bottom=bC.top;for(;bG<bF;bG++){for(var bE=0,bD=bH[bG].length;bE<bD;bE++){if(bH[bG][bE].x<bC.left){bC.left=bH[bG][bE].x}else{if(bH[bG][bE].x>bC.right){bC.right=bH[bG][bE].x}}if(bH[bG][bE].y<bC.top){bC.top=bH[bG][bE].y}else{if(bH[bG][bE].y>bC.bottom){bC.bottom=bH[bG][bE].y}}}}return bC};aC.Clipper.prototype.GetBounds2=function(bE){var bD=bE;var bC=new aC.IntRect();bC.left=bE.Pt.x;bC.right=bE.Pt.x;bC.top=bE.Pt.y;bC.bottom=bE.Pt.y;bE=bE.Next;while(bE!=bD){if(bE.Pt.x<bC.left){bC.left=bE.Pt.x}if(bE.Pt.x>bC.right){bC.right=bE.Pt.x}if(bE.Pt.y<bC.top){bC.top=bE.Pt.y}if(bE.Pt.y>bC.bottom){bC.bottom=bE.Pt.y}bE=bE.Next}return bC};aC.Clipper.PointInPolygon=function(bG,bF){var bC=0,bE=bF.length;if(bE<3){return 0}var bI=bF[0];for(var bD=1;bD<=bE;++bD){var bJ=(bD==bE?bF[0]:bF[bD]);if(bJ.y==bG.y){if((bJ.x==bG.x)||(bI.y==bG.y&&((bJ.x>bG.x)==(bI.x<bG.x)))){return -1}}if((bI.y<bG.y)!=(bJ.y<bG.y)){if(bI.x>=bG.x){if(bJ.x>bG.x){bC=1-bC}else{var bH=(bI.x-bG.x)*(bJ.y-bG.y)-(bJ.x-bG.x)*(bI.y-bG.y);if(bH==0){return -1}else{if((bH>0)==(bJ.y>bI.y)){bC=1-bC}}}}else{if(bJ.x>bG.x){var bH=(bI.x-bG.x)*(bJ.y-bG.y)-(bJ.x-bG.x)*(bI.y-bG.y);if(bH==0){return -1}else{if((bH>0)==(bJ.y>bI.y)){bC=1-bC}}}}}bI=bJ}return bC};aC.Clipper.prototype.PointInPolygon=function(bJ,bC){var bK=0;var bG=bC;for(;;){var bI=bC.Pt.x,bH=bC.Pt.y;var bE=bC.Next.Pt.x,bD=bC.Next.Pt.y;if(bD==bJ.y){if((bE==bJ.x)||(bH==bJ.y&&((bE>bJ.x)==(bI<bJ.x)))){return -1}}if((bH<bJ.y)!=(bD<bJ.y)){if(bI>=bJ.x){if(bE>bJ.x){bK=1-bK}else{var bF=(bI-bJ.x)*(bD-bJ.y)-(bE-bJ.x)*(bH-bJ.y);if(bF==0){return -1}if((bF>0)==(bD>bH)){bK=1-bK}}}else{if(bE>bJ.x){var bF=(bI-bJ.x)*(bD-bJ.y)-(bE-bJ.x)*(bH-bJ.y);if(bF==0){return -1}if((bF>0)==(bD>bH)){bK=1-bK}}}}bC=bC.Next;if(bG==bC){break}}return bK};aC.Clipper.prototype.Poly2ContainsPoly1=function(bE,bD){var bF=bE;do{var bC=this.PointInPolygon(bF.Pt,bD);if(bC>=0){return bC!=0}bF=bF.Next}while(bF!=bE);return true};aC.Clipper.prototype.FixupFirstLefts1=function(bE,bG){for(var bD=0,bC=this.m_PolyOuts.length;bD<bC;bD++){var bF=this.m_PolyOuts[bD];if(bF.Pts!==null&&bF.FirstLeft==bE){if(this.Poly2ContainsPoly1(bF.Pts,bG.Pts)){bF.FirstLeft=bG}}}};aC.Clipper.prototype.FixupFirstLefts2=function(bE,bG){for(var bD=0,bC=this.m_PolyOuts,bH=bC.length,bF=bC[bD];bD<bH;bD++,bF=bC[bD]){if(bF.FirstLeft==bE){bF.FirstLeft=bG}}};aC.Clipper.ParseFirstLeft=function(bC){while(bC!=null&&bC.Pts==null){bC=bC.FirstLeft}return bC};aC.Clipper.prototype.JoinCommonEdges=function(){for(var bH=0,bE=this.m_Joins.length;bH<bE;bH++){var bD=this.m_Joins[bH];var bC=this.GetOutRec(bD.OutPt1.Idx);var bK=this.GetOutRec(bD.OutPt2.Idx);if(bC.Pts==null||bK.Pts==null){continue}var bI;if(bC==bK){bI=bC}else{if(this.Param1RightOfParam2(bC,bK)){bI=bK}else{if(this.Param1RightOfParam2(bK,bC)){bI=bC}else{bI=this.GetLowermostRec(bC,bK)}}}if(!this.JoinPoints(bD,bC,bK)){continue}if(bC==bK){bC.Pts=bD.OutPt1;bC.BottomPt=null;bK=this.CreateOutRec();bK.Pts=bD.OutPt2;this.UpdateOutPtIdxs(bK);if(this.m_UsingPolyTree){for(var bF=0,bJ=this.m_PolyOuts.length;bF<bJ-1;bF++){var bG=this.m_PolyOuts[bF];if(bG.Pts==null||aC.Clipper.ParseFirstLeft(bG.FirstLeft)!=bC||bG.IsHole==bC.IsHole){continue}if(this.Poly2ContainsPoly1(bG.Pts,bD.OutPt2)){bG.FirstLeft=bK}}}if(this.Poly2ContainsPoly1(bK.Pts,bC.Pts)){bK.IsHole=!bC.IsHole;bK.FirstLeft=bC;if(this.m_UsingPolyTree){this.FixupFirstLefts2(bK,bC)}if((bK.IsHole^this.ReverseSolution)==(this.Area(bK)>0)){this.ReversePolyPtLinks(bK.Pts)}}else{if(this.Poly2ContainsPoly1(bC.Pts,bK.Pts)){bK.IsHole=bC.IsHole;bC.IsHole=!bK.IsHole;bK.FirstLeft=bC.FirstLeft;bC.FirstLeft=bK;if(this.m_UsingPolyTree){this.FixupFirstLefts2(bC,bK)}if((bC.IsHole^this.ReverseSolution)==(this.Area(bC)>0)){this.ReversePolyPtLinks(bC.Pts)}}else{bK.IsHole=bC.IsHole;bK.FirstLeft=bC.FirstLeft;if(this.m_UsingPolyTree){this.FixupFirstLefts1(bC,bK)}}}}else{bK.Pts=null;bK.BottomPt=null;bK.Idx=bC.Idx;bC.IsHole=bI.IsHole;if(bI==bK){bC.FirstLeft=bK.FirstLeft}bK.FirstLeft=bC;if(this.m_UsingPolyTree){this.FixupFirstLefts2(bK,bC)}}}};aC.Clipper.prototype.UpdateOutPtIdxs=function(bC){var bD=bC.Pts;do{bD.Idx=bC.Idx;bD=bD.Prev}while(bD!=bC.Pts)};aC.Clipper.prototype.DoSimplePolygons=function(){var bG=0;while(bG<this.m_PolyOuts.length){var bC=this.m_PolyOuts[bG++];var bI=bC.Pts;if(bI===null){continue}do{var bF=bI.Next;while(bF!=bC.Pts){if((aC.IntPoint.op_Equality(bI.Pt,bF.Pt))&&bF.Next!=bI&&bF.Prev!=bI){var bE=bI.Prev;var bD=bF.Prev;bI.Prev=bD;bD.Next=bI;bF.Prev=bE;bE.Next=bF;bC.Pts=bI;var bH=this.CreateOutRec();bH.Pts=bF;this.UpdateOutPtIdxs(bH);if(this.Poly2ContainsPoly1(bH.Pts,bC.Pts)){bH.IsHole=!bC.IsHole;bH.FirstLeft=bC}else{if(this.Poly2ContainsPoly1(bC.Pts,bH.Pts)){bH.IsHole=bC.IsHole;bC.IsHole=!bH.IsHole;bH.FirstLeft=bC.FirstLeft;bC.FirstLeft=bH}else{bH.IsHole=bC.IsHole;bH.FirstLeft=bC.FirstLeft}}bF=bI}bF=bF.Next}bI=bI.Next}while(bI!=bC.Pts)}};aC.Clipper.Area=function(bG){var bF=bG.length;if(bF<3){return 0}var bC=0;for(var bE=0,bD=bF-1;bE<bF;++bE){bC+=(bG[bD].x+bG[bE].x)*(bG[bD].y-bG[bE].y);bD=bE}return -bC*0.5};aC.Clipper.prototype.Area=function(bD){var bE=bD.Pts;if(bE==null){return 0}var bC=0;do{bC=bC+(bE.Prev.Pt.x+bE.Pt.x)*(bE.Prev.Pt.y-bE.Pt.y);bE=bE.Next}while(bE!=bD.Pts);return bC*0.5};if(a5){aC.Clipper.OffsetPaths=function(bE,bI,bD,bF,bG){var bC=new aC.Paths();var bH=new aC.ClipperOffset(bG,bG);bH.AddPaths(bE,bD,bF);bH.Execute(bC,bI);return bC}}aC.Clipper.SimplifyPolygon=function(bD,bF){var bC=new Array();var bE=new aC.Clipper(0);bE.StrictlySimple=true;bE.AddPath(bD,aC.PolyType.ptSubject,true);bE.Execute(aC.ClipType.ctUnion,bC,bF,bF);return bC};aC.Clipper.SimplifyPolygons=function(bD,bF){if(typeof(bF)=="undefined"){bF=aC.PolyFillType.pftEvenOdd}var bC=new Array();var bE=new aC.Clipper(0);bE.StrictlySimple=true;bE.AddPaths(bD,aC.PolyType.ptSubject,true);bE.Execute(aC.ClipType.ctUnion,bC,bF,bF);return bC};aC.Clipper.DistanceSqrd=function(bF,bE){var bD=(bF.x-bE.x);var bC=(bF.y-bE.y);return(bD*bD+bC*bC)};aC.Clipper.DistanceFromLineSqrd=function(bF,bE,bD){var bC=bE.y-bD.y;var bH=bD.x-bE.x;var bG=bC*bE.x+bH*bE.y;bG=bC*bF.x+bH*bF.y-bG;return(bG*bG)/(bC*bC+bH*bH)};aC.Clipper.SlopesNearCollinear=function(bF,bE,bD,bC){return aC.Clipper.DistanceFromLineSqrd(bE,bF,bD)<bC};aC.Clipper.PointsAreClose=function(bG,bF,bE){var bD=bG.x-bF.x;var bC=bG.y-bF.y;return((bD*bD)+(bC*bC)<=bE)};aC.Clipper.ExcludeOp=function(bD){var bC=bD.Prev;bC.Next=bD.Next;bD.Next.Prev=bC;bC.Idx=0;return bC};aC.Clipper.CleanPolygon=function(bH,bJ){if(typeof(bJ)=="undefined"){bJ=1.415}var bE=bH.length;if(bE==0){return new Array()}var bG=new Array(bE);for(var bD=0;bD<bE;++bD){bG[bD]=new aC.OutPt()}for(var bD=0;bD<bE;++bD){bG[bD].Pt=bH[bD];bG[bD].Next=bG[(bD+1)%bE];bG[bD].Next.Prev=bG[bD];bG[bD].Idx=0}var bF=bJ*bJ;var bI=bG[0];while(bI.Idx==0&&bI.Next!=bI.Prev){if(aC.Clipper.PointsAreClose(bI.Pt,bI.Prev.Pt,bF)){bI=aC.Clipper.ExcludeOp(bI);bE--}else{if(aC.Clipper.PointsAreClose(bI.Prev.Pt,bI.Next.Pt,bF)){aC.Clipper.ExcludeOp(bI.Next);bI=aC.Clipper.ExcludeOp(bI);bE-=2}else{if(aC.Clipper.SlopesNearCollinear(bI.Prev.Pt,bI.Pt,bI.Next.Pt,bF)){bI=aC.Clipper.ExcludeOp(bI);bE--}else{bI.Idx=1;bI=bI.Next}}}}if(bE<3){bE=0}var bC=new Array(bE);for(var bD=0;bD<bE;++bD){bC[bD]=new aC.IntPoint(bI.Pt);bI=bI.Next}bG=null;return bC};aC.Clipper.CleanPolygons=function(bD,bG){var bC=new Array(bD.length);for(var bF=0,bE=bD.length;bF<bE;bF++){bC[bF]=aC.Clipper.CleanPolygon(bD[bF],bG)}return bC};aC.Clipper.Minkowski=function(bJ,bQ,bE,bO){var bM=(bO?1:0);var bC=bJ.length;var bH=bQ.length;var bR=new Array();if(bE){for(var bG=0;bG<bH;bG++){var bD=new Array(bC);for(var bF=0,bN=bJ.length,bI=bJ[bF];bF<bN;bF++,bI=bJ[bF]){bD[bF]=new aC.IntPoint(bQ[bG].x+bI.x,bQ[bG].y+bI.y)}bR.push(bD)}}else{for(var bG=0;bG<bH;bG++){var bD=new Array(bC);for(var bF=0,bN=bJ.length,bI=bJ[bF];bF<bN;bF++,bI=bJ[bF]){bD[bF]=new aC.IntPoint(bQ[bG].x-bI.x,bQ[bG].y-bI.y)}bR.push(bD)}}var bP=new Array();for(var bG=0;bG<bH-1+bM;bG++){for(var bF=0;bF<bC;bF++){var bL=new Array();bL.push(bR[bG%bH][bF%bC]);bL.push(bR[(bG+1)%bH][bF%bC]);bL.push(bR[(bG+1)%bH][(bF+1)%bC]);bL.push(bR[bG%bH][(bF+1)%bC]);if(!aC.Clipper.Orientation(bL)){bL.reverse()}bP.push(bL)}}var bK=new aC.Clipper(0);bK.AddPaths(bP,aC.PolyType.ptSubject,true);bK.Execute(aC.ClipType.ctUnion,bR,aC.PolyFillType.pftNonZero,aC.PolyFillType.pftNonZero);return bR};aC.Clipper.MinkowskiSum=function(){var bL=arguments,bD=bL.length;if(bD==3){var bI=bL[0],bN=bL[1],bG=bL[2];return aC.Clipper.Minkowski(bI,bN,true,bG)}else{if(bD==4){var bI=bL[0],bM=bL[1],bK=bL[2],bG=bL[3];var bJ=new aC.Clipper(),bF;for(var bE=0,bC=bM.length;bE<bC;++bE){var bF=aC.Clipper.Minkowski(bI,bM[bE],true,bG);bJ.AddPaths(bF,aC.PolyType.ptSubject,true)}if(bG){bJ.AddPaths(bM,aC.PolyType.ptClip,true)}var bH=new aC.Paths();bJ.Execute(aC.ClipType.ctUnion,bH,bK,bK);return bH}}};aC.Clipper.MinkowskiDiff=function(bD,bE,bC){return aC.Clipper.Minkowski(bD,bE,false,bC)};aC.Clipper.PolyTreeToPaths=function(bD){var bC=new Array();aC.Clipper.AddPolyNodeToPaths(bD,aC.Clipper.NodeType.ntAny,bC);return bC};aC.Clipper.AddPolyNodeToPaths=function(bH,bG,bJ){var bF=true;switch(bG){case aC.Clipper.NodeType.ntOpen:return;case aC.Clipper.NodeType.ntClosed:bF=!bH.IsOpen;break;default:break}if(bH.m_polygon.length>0&&bF){bJ.push(bH.m_polygon)}for(var bE=0,bD=bH.Childs(),bI=bD.length,bC=bD[bE];bE<bI;bE++,bC=bD[bE]){aC.Clipper.AddPolyNodeToPaths(bC,bG,bJ)}};aC.Clipper.OpenPathsFromPolyTree=function(bD){var bC=new aC.Paths();for(var bF=0,bE=bD.ChildCount();bF<bE;bF++){if(bD.Childs()[bF].IsOpen){bC.push(bD.Childs()[bF].m_polygon)}}return bC};aC.Clipper.ClosedPathsFromPolyTree=function(bD){var bC=new aC.Paths();aC.Clipper.AddPolyNodeToPaths(bD,aC.Clipper.NodeType.ntClosed,bC);return bC};bt(aC.Clipper,aC.ClipperBase);aC.Clipper.NodeType={ntAny:0,ntOpen:1,ntClosed:2};aC.ClipperOffset=function(bC,bD){if(typeof(bC)=="undefined"){bC=2}if(typeof(bD)=="undefined"){bD=aC.ClipperOffset.def_arc_tolerance}this.m_destPolys=new aC.Paths();this.m_srcPoly=new aC.Path();this.m_destPoly=new aC.Path();this.m_normals=new Array();this.m_delta=0;this.m_sinA=0;this.m_sin=0;this.m_cos=0;this.m_miterLim=0;this.m_StepsPerRad=0;this.m_lowest=new aC.IntPoint();this.m_polyNodes=new aC.PolyNode();this.MiterLimit=bC;this.ArcTolerance=bD;this.m_lowest.x=-1};aC.ClipperOffset.two_pi=6.28318530717959;aC.ClipperOffset.def_arc_tolerance=0.25;aC.ClipperOffset.prototype.Clear=function(){aC.Clear(this.m_polyNodes.Childs());this.m_lowest.x=-1};aC.ClipperOffset.Round=aC.Clipper.Round;aC.ClipperOffset.prototype.AddPath=function(bK,bI,bJ){var bG=bK.length-1;if(bG<0){return}var bH=new aC.PolyNode();bH.m_jointype=bI;bH.m_endtype=bJ;if(bJ==aC.EndType.etClosedLine||bJ==aC.EndType.etClosedPolygon){while(bG>0&&aC.IntPoint.op_Equality(bK[0],bK[bG])){bG--}}bH.m_polygon.push(bK[0]);var bD=0,bC=0;for(var bE=1;bE<=bG;bE++){if(aC.IntPoint.op_Inequality(bH.m_polygon[bD],bK[bE])){bD++;bH.m_polygon.push(bK[bE]);if(bK[bE].y>bH.m_polygon[bC].y||(bK[bE].y==bH.m_polygon[bC].y&&bK[bE].x<bH.m_polygon[bC].x)){bC=bD}}}if((bJ==aC.EndType.etClosedPolygon&&bD<2)||(bJ!=aC.EndType.etClosedPolygon&&bD<0)){return}this.m_polyNodes.AddChild(bH);if(bJ!=aC.EndType.etClosedPolygon){return}if(this.m_lowest.x<0){this.m_lowest=new aC.IntPoint(0,bC)}else{var bF=this.m_polyNodes.Childs()[this.m_lowest.x].m_polygon[this.m_lowest.y];if(bH.m_polygon[bC].y>bF.y||(bH.m_polygon[bC].y==bF.y&&bH.m_polygon[bC].x<bF.x)){this.m_lowest=new aC.IntPoint(this.m_polyNodes.ChildCount()-1,bC)}}};aC.ClipperOffset.prototype.AddPaths=function(bF,bE,bG){for(var bD=0,bC=bF.length;bD<bC;bD++){this.AddPath(bF[bD],bE,bG)}};aC.ClipperOffset.prototype.FixOrientations=function(){if(this.m_lowest.x>=0&&!aC.Clipper.Orientation(this.m_polyNodes.Childs()[this.m_lowest.x].m_polygon)){for(var bC=0;bC<this.m_polyNodes.ChildCount();bC++){var bD=this.m_polyNodes.Childs()[bC];if(bD.m_endtype==aC.EndType.etClosedPolygon||(bD.m_endtype==aC.EndType.etClosedLine&&aC.Clipper.Orientation(bD.m_polygon))){bD.m_polygon.reverse()}}}else{for(var bC=0;bC<this.m_polyNodes.ChildCount();bC++){var bD=this.m_polyNodes.Childs()[bC];if(bD.m_endtype==aC.EndType.etClosedLine&&!aC.Clipper.Orientation(bD.m_polygon)){bD.m_polygon.reverse()}}}};aC.ClipperOffset.GetUnitNormal=function(bG,bF){var bD=(bF.x-bG.x);var bC=(bF.y-bG.y);if((bD==0)&&(bC==0)){return new aC.DoublePoint(0,0)}var bE=1/Math.sqrt(bD*bD+bC*bC);bD*=bE;bC*=bE;return new aC.DoublePoint(bC,-bD)};aC.ClipperOffset.prototype.DoOffset=function(bO){this.m_destPolys=new Array();this.m_delta=bO;if(aC.ClipperBase.near_zero(bO)){for(var bJ=0;bJ<this.m_polyNodes.ChildCount();bJ++){var bG=this.m_polyNodes.Childs()[bJ];if(bG.m_endtype==aC.EndType.etClosedPolygon){this.m_destPolys.push(bG.m_polygon)}}return}if(this.MiterLimit>2){this.m_miterLim=2/(this.MiterLimit*this.MiterLimit)}else{this.m_miterLim=0.5}var bL;if(this.ArcTolerance<=0){bL=aC.ClipperOffset.def_arc_tolerance}else{if(this.ArcTolerance>Math.abs(bO)*aC.ClipperOffset.def_arc_tolerance){bL=Math.abs(bO)*aC.ClipperOffset.def_arc_tolerance}else{bL=this.ArcTolerance}}var bM=3.14159265358979/Math.acos(1-bL/Math.abs(bO));this.m_sin=Math.sin(aC.ClipperOffset.two_pi/bM);this.m_cos=Math.cos(aC.ClipperOffset.two_pi/bM);this.m_StepsPerRad=bM/aC.ClipperOffset.two_pi;if(bO<0){this.m_sin=-this.m_sin}for(var bJ=0;bJ<this.m_polyNodes.ChildCount();bJ++){var bG=this.m_polyNodes.Childs()[bJ];this.m_srcPoly=bG.m_polygon;var bK=this.m_srcPoly.length;if(bK==0||(bO<=0&&(bK<3||bG.m_endtype!=aC.EndType.etClosedPolygon))){continue}this.m_destPoly=new Array();if(bK==1){if(bG.m_jointype==aC.JoinType.jtRound){var bD=1,bC=0;for(var bI=1;bI<=bM;bI++){this.m_destPoly.push(new aC.IntPoint(aC.ClipperOffset.Round(this.m_srcPoly[0].x+bD*bO),aC.ClipperOffset.Round(this.m_srcPoly[0].y+bC*bO)));var bF=bD;bD=bD*this.m_cos-this.m_sin*bC;bC=bF*this.m_sin+bC*this.m_cos}}else{var bD=-1,bC=-1;for(var bI=0;bI<4;++bI){this.m_destPoly.push(new aC.IntPoint(aC.ClipperOffset.Round(this.m_srcPoly[0].x+bD*bO),aC.ClipperOffset.Round(this.m_srcPoly[0].y+bC*bO)));if(bD<0){bD=1}else{if(bC<0){bC=1}else{bD=-1}}}}this.m_destPolys.push(this.m_destPoly);continue}this.m_normals.length=0;for(var bI=0;bI<bK-1;bI++){this.m_normals.push(aC.ClipperOffset.GetUnitNormal(this.m_srcPoly[bI],this.m_srcPoly[bI+1]))}if(bG.m_endtype==aC.EndType.etClosedLine||bG.m_endtype==aC.EndType.etClosedPolygon){this.m_normals.push(aC.ClipperOffset.GetUnitNormal(this.m_srcPoly[bK-1],this.m_srcPoly[0]))}else{this.m_normals.push(new aC.DoublePoint(this.m_normals[bK-2]))}if(bG.m_endtype==aC.EndType.etClosedPolygon){var bH=bK-1;for(var bI=0;bI<bK;bI++){bH=this.OffsetPoint(bI,bH,bG.m_jointype)}this.m_destPolys.push(this.m_destPoly)}else{if(bG.m_endtype==aC.EndType.etClosedLine){var bH=bK-1;for(var bI=0;bI<bK;bI++){bH=this.OffsetPoint(bI,bH,bG.m_jointype)}this.m_destPolys.push(this.m_destPoly);this.m_destPoly=new Array();var bE=this.m_normals[bK-1];for(var bI=bK-1;bI>0;bI--){this.m_normals[bI]=new aC.DoublePoint(-this.m_normals[bI-1].x,-this.m_normals[bI-1].y)}this.m_normals[0]=new aC.DoublePoint(-bE.x,-bE.y);bH=0;for(var bI=bK-1;bI>=0;bI--){bH=this.OffsetPoint(bI,bH,bG.m_jointype)}this.m_destPolys.push(this.m_destPoly)}else{var bH=0;for(var bI=1;bI<bK-1;++bI){bH=this.OffsetPoint(bI,bH,bG.m_jointype)}var bN;if(bG.m_endtype==aC.EndType.etOpenButt){var bI=bK-1;bN=new aC.IntPoint(aC.ClipperOffset.Round(this.m_srcPoly[bI].x+this.m_normals[bI].x*bO),aC.ClipperOffset.Round(this.m_srcPoly[bI].y+this.m_normals[bI].y*bO));this.m_destPoly.push(bN);bN=new aC.IntPoint(aC.ClipperOffset.Round(this.m_srcPoly[bI].x-this.m_normals[bI].x*bO),aC.ClipperOffset.Round(this.m_srcPoly[bI].y-this.m_normals[bI].y*bO));this.m_destPoly.push(bN)}else{var bI=bK-1;bH=bK-2;this.m_sinA=0;this.m_normals[bI]=new aC.DoublePoint(-this.m_normals[bI].x,-this.m_normals[bI].y);if(bG.m_endtype==aC.EndType.etOpenSquare){this.DoSquare(bI,bH)}else{this.DoRound(bI,bH)}}for(var bI=bK-1;bI>0;bI--){this.m_normals[bI]=new aC.DoublePoint(-this.m_normals[bI-1].x,-this.m_normals[bI-1].y)}this.m_normals[0]=new aC.DoublePoint(-this.m_normals[1].x,-this.m_normals[1].y);bH=bK-1;for(var bI=bH-1;bI>0;--bI){bH=this.OffsetPoint(bI,bH,bG.m_jointype)}if(bG.m_endtype==aC.EndType.etOpenButt){bN=new aC.IntPoint(aC.ClipperOffset.Round(this.m_srcPoly[0].x-this.m_normals[0].x*bO),aC.ClipperOffset.Round(this.m_srcPoly[0].y-this.m_normals[0].y*bO));this.m_destPoly.push(bN);bN=new aC.IntPoint(aC.ClipperOffset.Round(this.m_srcPoly[0].x+this.m_normals[0].x*bO),aC.ClipperOffset.Round(this.m_srcPoly[0].y+this.m_normals[0].y*bO));this.m_destPoly.push(bN)}else{bH=1;this.m_sinA=0;if(bG.m_endtype==aC.EndType.etOpenSquare){this.DoSquare(0,1)}else{this.DoRound(0,1)}}this.m_destPolys.push(this.m_destPoly)}}}};aC.ClipperOffset.prototype.Execute=function(){var bI=arguments,bE=bI[0] instanceof aC.PolyTree;if(!bE){var bG=bI[0],bJ=bI[1];aC.Clear(bG);this.FixOrientations();this.DoOffset(bJ);var bH=new aC.Clipper(0);bH.AddPaths(this.m_destPolys,aC.PolyType.ptSubject,true);if(bJ>0){bH.Execute(aC.ClipType.ctUnion,bG,aC.PolyFillType.pftPositive,aC.PolyFillType.pftPositive)}else{var bC=aC.Clipper.GetBounds(this.m_destPolys);var bK=new aC.Path();bK.push(new aC.IntPoint(bC.left-10,bC.bottom+10));bK.push(new aC.IntPoint(bC.right+10,bC.bottom+10));bK.push(new aC.IntPoint(bC.right+10,bC.top-10));bK.push(new aC.IntPoint(bC.left-10,bC.top-10));bH.AddPath(bK,aC.PolyType.ptSubject,true);bH.ReverseSolution=true;bH.Execute(aC.ClipType.ctUnion,bG,aC.PolyFillType.pftNegative,aC.PolyFillType.pftNegative);if(bG.length>0){bG.splice(0,1)}}}else{var bG=bI[0],bJ=bI[1];bG.Clear();this.FixOrientations();this.DoOffset(bJ);var bH=new aC.Clipper(0);bH.AddPaths(this.m_destPolys,aC.PolyType.ptSubject,true);if(bJ>0){bH.Execute(aC.ClipType.ctUnion,bG,aC.PolyFillType.pftPositive,aC.PolyFillType.pftPositive)}else{var bC=aC.Clipper.GetBounds(this.m_destPolys);var bK=new aC.Path();bK.push(new aC.IntPoint(bC.left-10,bC.bottom+10));bK.push(new aC.IntPoint(bC.right+10,bC.bottom+10));bK.push(new aC.IntPoint(bC.right+10,bC.top-10));bK.push(new aC.IntPoint(bC.left-10,bC.top-10));bH.AddPath(bK,aC.PolyType.ptSubject,true);bH.ReverseSolution=true;bH.Execute(aC.ClipType.ctUnion,bG,aC.PolyFillType.pftNegative,aC.PolyFillType.pftNegative);if(bG.ChildCount()==1&&bG.Childs()[0].ChildCount()>0){var bF=bG.Childs()[0];bG.Childs()[0]=bF.Childs()[0];for(var bD=1;bD<bF.ChildCount();bD++){bG.AddChild(bF.Childs()[bD])}}else{bG.Clear()}}}};aC.ClipperOffset.prototype.OffsetPoint=function(bE,bD,bC){this.m_sinA=(this.m_normals[bD].x*this.m_normals[bE].y-this.m_normals[bE].x*this.m_normals[bD].y);if(this.m_sinA<0.00005&&this.m_sinA>-0.00005){return bD}else{if(this.m_sinA>1){this.m_sinA=1}else{if(this.m_sinA<-1){this.m_sinA=-1}}}if(this.m_sinA*this.m_delta<0){this.m_destPoly.push(new aC.IntPoint(aC.ClipperOffset.Round(this.m_srcPoly[bE].x+this.m_normals[bD].x*this.m_delta),aC.ClipperOffset.Round(this.m_srcPoly[bE].y+this.m_normals[bD].y*this.m_delta)));this.m_destPoly.push(new aC.IntPoint(this.m_srcPoly[bE]));this.m_destPoly.push(new aC.IntPoint(aC.ClipperOffset.Round(this.m_srcPoly[bE].x+this.m_normals[bE].x*this.m_delta),aC.ClipperOffset.Round(this.m_srcPoly[bE].y+this.m_normals[bE].y*this.m_delta)))}else{switch(bC){case aC.JoinType.jtMiter:var bF=1+(this.m_normals[bE].x*this.m_normals[bD].x+this.m_normals[bE].y*this.m_normals[bD].y);if(bF>=this.m_miterLim){this.DoMiter(bE,bD,bF)}else{this.DoSquare(bE,bD)}break;case aC.JoinType.jtSquare:this.DoSquare(bE,bD);break;case aC.JoinType.jtRound:this.DoRound(bE,bD);break}}bD=bE;return bD};aC.ClipperOffset.prototype.DoSquare=function(bE,bD){var bC=Math.tan(Math.atan2(this.m_sinA,this.m_normals[bD].x*this.m_normals[bE].x+this.m_normals[bD].y*this.m_normals[bE].y)/4);this.m_destPoly.push(new aC.IntPoint(aC.ClipperOffset.Round(this.m_srcPoly[bE].x+this.m_delta*(this.m_normals[bD].x-this.m_normals[bD].y*bC)),aC.ClipperOffset.Round(this.m_srcPoly[bE].y+this.m_delta*(this.m_normals[bD].y+this.m_normals[bD].x*bC))));this.m_destPoly.push(new aC.IntPoint(aC.ClipperOffset.Round(this.m_srcPoly[bE].x+this.m_delta*(this.m_normals[bE].x+this.m_normals[bE].y*bC)),aC.ClipperOffset.Round(this.m_srcPoly[bE].y+this.m_delta*(this.m_normals[bE].y-this.m_normals[bE].x*bC))))};aC.ClipperOffset.prototype.DoMiter=function(bD,bC,bE){var bF=this.m_delta/bE;this.m_destPoly.push(new aC.IntPoint(aC.ClipperOffset.Round(this.m_srcPoly[bD].x+(this.m_normals[bC].x+this.m_normals[bD].x)*bF),aC.ClipperOffset.Round(this.m_srcPoly[bD].y+(this.m_normals[bC].y+this.m_normals[bD].y)*bF)))};aC.ClipperOffset.prototype.DoRound=function(bF,bE){var bC=Math.atan2(this.m_sinA,this.m_normals[bE].x*this.m_normals[bF].x+this.m_normals[bE].y*this.m_normals[bF].y);var bD=aC.Cast_Int32(aC.ClipperOffset.Round(this.m_StepsPerRad*Math.abs(bC)));var bJ=this.m_normals[bE].x,bI=this.m_normals[bE].y,bH;for(var bG=0;bG<bD;++bG){this.m_destPoly.push(new aC.IntPoint(aC.ClipperOffset.Round(this.m_srcPoly[bF].x+bJ*this.m_delta),aC.ClipperOffset.Round(this.m_srcPoly[bF].y+bI*this.m_delta)));bH=bJ;bJ=bJ*this.m_cos-this.m_sin*bI;bI=bH*this.m_sin+bI*this.m_cos}this.m_destPoly.push(new aC.IntPoint(aC.ClipperOffset.Round(this.m_srcPoly[bF].x+this.m_normals[bF].x*this.m_delta),aC.ClipperOffset.Round(this.m_srcPoly[bF].y+this.m_normals[bF].y*this.m_delta)))};aC.Error=function(bD){try{throw new Error(bD)}catch(bC){alert(bC.message)}};aC.JS={};aC.JS.AreaOfPolygon=function(bC,bD){if(!bD){bD=1}return aC.Clipper.Area(bC)/(bD*bD)};aC.JS.AreaOfPolygons=function(bE,bF){if(!bF){bF=1}var bD=0;for(var bC=0;bC<bE.length;bC++){bD+=aC.Clipper.Area(bE[bC])}return bD/(bF*bF)};aC.JS.BoundsOfPath=function(bC,bD){return aC.JS.BoundsOfPaths([bC],bD)};aC.JS.BoundsOfPaths=function(bE,bD){if(!bD){bD=1}var bC=aC.Clipper.GetBounds(bE);bC.left/=bD;bC.bottom/=bD;bC.right/=bD;bC.top/=bD;return bC};aC.JS.Clean=function(bM,bN){if(!(bM instanceof Array)){return[]}var bE=bM[0] instanceof Array;var bM=aC.JS.Clone(bM);if(typeof bN!="number"||bN===null){aC.Error("Delta is not a number in Clean().");return bM}if(bM.length===0||(bM.length==1&&bM[0].length===0)||bN<0){return bM}if(!bE){bM=[bM]}var bJ=bM.length;var bK,bC,bO,bL,bD,bG,bI;var bH=[];for(var bF=0;bF<bJ;bF++){bC=bM[bF];bK=bC.length;if(bK===0){continue}else{if(bK<3){bO=bC;bH.push(bO);continue}}bO=bC;bL=bN*bN;bD=bC[0];bG=1;for(bI=1;bI<bK;bI++){if((bC[bI].x-bD.x)*(bC[bI].x-bD.x)+(bC[bI].y-bD.y)*(bC[bI].y-bD.y)<=bL){continue}bO[bG]=bC[bI];bD=bC[bI];bG++}bD=bC[bG-1];if((bC[0].x-bD.x)*(bC[0].x-bD.x)+(bC[0].y-bD.y)*(bC[0].y-bD.y)<=bL){bG--}if(bG<bK){bO.splice(bG,bK-bG)}if(bO.length){bH.push(bO)}}if(!bE&&bH.length){bH=bH[0]}else{if(!bE&&bH.length===0){bH=[]}else{if(bE&&bH.length===0){bH=[[]]}}}return bH};aC.JS.Clone=function(bH){if(!(bH instanceof Array)){return[]}if(bH.length===0){return[]}else{if(bH.length==1&&bH[0].length===0){return[[]]}}var bJ=bH[0] instanceof Array;if(!bJ){bH=[bH]}var bD=bH.length,bI,bG,bE,bC;var bF=new Array(bD);for(bG=0;bG<bD;bG++){bI=bH[bG].length;bC=new Array(bI);for(bE=0;bE<bI;bE++){bC[bE]={x:bH[bG][bE].x,y:bH[bG][bE].y}}bF[bG]=bC}if(!bJ){bF=bF[0]}return bF};aC.JS.Lighten=function(bK,bU){if(!(bK instanceof Array)){return[]}if(typeof bU!="number"||bU===null){aC.Error("Tolerance is not a number in Lighten().");return aC.JS.Clone(bK)}if(bK.length===0||(bK.length==1&&bK[0].length===0)||bU<0){return aC.JS.Clone(bK)}if(!(bK[0] instanceof Array)){bK=[bK]}var bS,bR,bE,bQ,bL,bJ,bN,bM,bF,bW,bD,bC;var bH,bX,bP,bI,bG;var bT=bK.length;var bV=bU*bU;var bO=[];for(bS=0;bS<bT;bS++){bE=bK[bS];bJ=bE.length;if(bJ==0){continue}for(bQ=0;bQ<1000000;bQ++){bL=[];bJ=bE.length;if(bE[bJ-1].x!=bE[0].x||bE[bJ-1].y!=bE[0].y){bC=1;bE.push({x:bE[0].x,y:bE[0].y});bJ=bE.length}else{bC=0}bD=[];for(bR=0;bR<bJ-2;bR++){bN=bE[bR];bF=bE[bR+1];bM=bE[bR+2];bI=bN.x;bG=bN.y;bH=bM.x-bI;bX=bM.y-bG;if(bH!==0||bX!==0){bP=((bF.x-bI)*bH+(bF.y-bG)*bX)/(bH*bH+bX*bX);if(bP>1){bI=bM.x;bG=bM.y}else{if(bP>0){bI+=bH*bP;bG+=bX*bP}}}bH=bF.x-bI;bX=bF.y-bG;bW=bH*bH+bX*bX;if(bW<=bV){bD[bR+1]=1;bR++}}bL.push({x:bE[0].x,y:bE[0].y});for(bR=1;bR<bJ-1;bR++){if(!bD[bR]){bL.push({x:bE[bR].x,y:bE[bR].y})}}bL.push({x:bE[bJ-1].x,y:bE[bJ-1].y});if(bC){bE.pop()}if(!bD.length){break}else{bE=bL}}bJ=bL.length;if(bL[bJ-1].x==bL[0].x&&bL[bJ-1].y==bL[0].y){bL.pop()}if(bL.length>2){bO.push(bL)}}if(!bK[0] instanceof Array){bO=bO[0]}if(typeof(bO)=="undefined"){bO=[[]]}return bO};aC.JS.PerimeterOfPath=function(bN,bG,bE){if(typeof(bN)=="undefined"){return 0}var bL=Math.sqrt;var bJ=0;var bM,bK,bD=0,bC=0,bI=0,bH=0;var bF=bN.length;if(bF<2){return 0}if(bG){bN[bF]=bN[0];bF++}while(--bF){bM=bN[bF];bD=bM.x;bC=bM.y;bK=bN[bF-1];bI=bK.x;bH=bK.y;bJ+=bL((bD-bI)*(bD-bI)+(bC-bH)*(bC-bH))}if(bG){bN.pop()}return bJ/bE};aC.JS.PerimeterOfPaths=function(bG,bD,bF){if(!bF){bF=1}var bC=0;for(var bE=0;bE<bG.length;bE++){bC+=aC.JS.PerimeterOfPath(bG[bE],bD,bF)}return bC};aC.JS.ScaleDownPath=function(bE,bF){var bC,bD;if(!bF){bF=1}bC=bE.length;while(bC--){bD=bE[bC];bD.x=bD.x/bF;bD.y=bD.y/bF}};aC.JS.ScaleDownPaths=function(bH,bG){var bE,bD,bF,bC=Math.round;if(!bG){bG=1}bE=bH.length;while(bE--){bD=bH[bE].length;while(bD--){bF=bH[bE][bD];bF.x=bF.x/bG;bF.y=bF.y/bG}}};aC.JS.ScaleUpPath=function(bF,bG){var bD,bE,bC=Math.round;if(!bG){bG=1}bD=bF.length;while(bD--){bE=bF[bD];bE.x=bC(bE.x*bG);bE.y=bC(bE.y*bG)}};aC.JS.ScaleUpPaths=function(bH,bG){var bE,bD,bF,bC=Math.round;if(!bG){bG=1}bE=bH.length;while(bE--){bD=bH[bE].length;while(bD--){bF=bH[bE][bD];bF.x=bC(bF.x*bG);bF.y=bC(bF.y*bG)}}};aC.ExPolygons=function(){return[]};aC.ExPolygon=function(){this.outer=null;this.holes=null};aC.JS.AddOuterPolyNodeToExPolygons=function(bC,bG){var bM=new aC.ExPolygon();bM.outer=bC.Contour();var bJ=bC.Childs();var bD=bJ.length;bM.holes=new Array(bD);var bF,bE,bI,bH,bL,bK;for(bI=0;bI<bD;bI++){bF=bJ[bI];bM.holes[bI]=bF.Contour();for(bH=0,bL=bF.Childs(),bK=bL.length;bH<bK;bH++){bE=bL[bH];aC.JS.AddOuterPolyNodeToExPolygons(bE,bG)}}bG.push(bM)};aC.JS.ExPolygonsToPaths=function(bD){var bC,bF,bG,bE;var bH=new aC.Paths();for(bC=0,bG=bD.length;bC<bG;bC++){bH.push(bD[bC].outer);for(bF=0,bE=bD[bC].holes.length;bF<bE;bF++){bH.push(bD[bC].holes[bF])}}return bH};aC.JS.PolyTreeToExPolygons=function(bC){var bD=new aC.ExPolygons();var bG,bF,bH,bE;for(bF=0,bH=bC.Childs(),bE=bH.length;bF<bE;bF++){bG=bH[bF];aC.JS.AddOuterPolyNodeToExPolygons(bG,bD)}return bD}})();var spine={};spine.BoneData=function(a,b){this.name=a;this.parent=b};spine.BoneData.prototype={length:0,x:0,y:0,rotation:0,scaleX:1,scaleY:1,inheritScale:true,inheritRotation:true};spine.SlotData=function(a,b){this.name=a;this.boneData=b};spine.SlotData.prototype={r:1,g:1,b:1,a:1,attachmentName:null,additiveBlending:false};spine.Bone=function(b,a){this.data=b;this.parent=a;this.setToSetupPose()};spine.Bone.yDown=false;spine.Bone.prototype={x:0,y:0,rotation:0,scaleX:1,scaleY:1,m00:0,m01:0,worldX:0,m10:0,m11:0,worldY:0,worldRotation:0,worldScaleX:1,worldScaleY:1,updateWorldTransform:function(d,b){var e=this.parent;if(e!=null){this.worldX=this.x*e.m00+this.y*e.m01+e.worldX;this.worldY=this.x*e.m10+this.y*e.m11+e.worldY;if(this.data.inheritScale){this.worldScaleX=e.worldScaleX*this.scaleX;this.worldScaleY=e.worldScaleY*this.scaleY}else{this.worldScaleX=this.scaleX;this.worldScaleY=this.scaleY}this.worldRotation=this.data.inheritRotation?e.worldRotation+this.rotation:this.rotation}else{this.worldX=this.x;this.worldY=this.y;this.worldScaleX=this.scaleX;this.worldScaleY=this.scaleY;this.worldRotation=this.rotation}var g=this.worldRotation*Math.PI/180;var f=Math.cos(g);var a=Math.sin(g);this.m00=f*this.worldScaleX;this.m10=a*this.worldScaleX;this.m01=-a*this.worldScaleY;this.m11=f*this.worldScaleY;if(d){this.m00=-this.m00;this.m01=-this.m01}if(b!=spine.Bone.yDown){this.m10=-this.m10;this.m11=-this.m11}},setToSetupPose:function(){var a=this.data;this.x=a.x;this.y=a.y;this.rotation=a.rotation;this.scaleX=a.scaleX;this.scaleY=a.scaleY}};spine.Slot=function(a,d,b){this.data=a;this.skeleton=d;this.bone=b;this.setToSetupPose()};spine.Slot.prototype={r:1,g:1,b:1,a:1,_attachmentTime:0,attachment:null,setAttachment:function(a){this.attachment=a;this._attachmentTime=this.skeleton.time},setAttachmentTime:function(a){this._attachmentTime=this.skeleton.time-a},getAttachmentTime:function(){return this.skeleton.time-this._attachmentTime},setToSetupPose:function(){var b=this.data;this.r=b.r;this.g=b.g;this.b=b.b;this.a=b.a;var e=this.skeleton.data.slots;for(var a=0,d=e.length;a<d;a++){if(e[a]==b){this.setAttachment(!b.attachmentName?null:this.skeleton.getAttachmentBySlotIndex(a,b.attachmentName));break}}}};spine.Skin=function(a){this.name=a;this.attachments={}};spine.Skin.prototype={addAttachment:function(a,b,d){this.attachments[a+":"+b]=d},getAttachment:function(a,b){return this.attachments[a+":"+b]},_attachAll:function(f,k){for(var d in k.attachments){var e=d.indexOf(":");var a=parseInt(d.substring(0,e));var b=d.substring(e+1);var j=f.slots[a];if(j.attachment&&j.attachment.name==b){var g=this.getAttachment(a,b);if(g){j.setAttachment(g)}}}}};spine.Animation=function(a,b,d){this.name=a;this.timelines=b;this.duration=d};spine.Animation.prototype={apply:function(j,g,f,a,e){if(a&&this.duration!=0){f%=this.duration;g%=this.duration}var d=this.timelines;for(var b=0,k=d.length;b<k;b++){d[b].apply(j,g,f,e,1)}},mix:function(e,a,d,j,m,f){if(j&&this.duration!=0){d%=this.duration;a%=this.duration}var k=this.timelines;for(var g=0,b=k.length;g<b;g++){k[g].apply(e,a,d,m,f)}}};spine.binarySearch=function(b,g,d){var a=0;var e=Math.floor(b.length/d)-2;if(e==0){return d}var f=e>>>1;while(true){if(b[(f+1)*d]<=g){a=f+1}else{e=f}if(a==e){return(a+1)*d}f=(a+e)>>>1}};spine.linearSearch=function(a,f,e){for(var b=0,d=a.length-e;b<=d;b+=e){if(a[b]>f){return b}}return -1};spine.Curves=function(a){this.curves=[];this.curves.length=(a-1)*6};spine.Curves.prototype={setLinear:function(a){this.curves[a*6]=0},setStepped:function(a){this.curves[a*6]=-1},setCurve:function(k,q,z,n,y){var r=1/10;var j=r*r;var g=j*r;var d=3*r;var b=3*j;var a=6*j;var A=6*g;var v=-q*2+n;var u=-z*2+y;var f=(q-n)*3+1;var e=(z-y)*3+1;var s=k*6;var m=this.curves;m[s]=q*d+v*b+f*g;m[s+1]=z*d+u*b+e*g;m[s+2]=v*a+f*A;m[s+3]=u*a+e*A;m[s+4]=f*A;m[s+5]=e*A},getCurvePercent:function(e,m){m=m<0?0:(m>1?1:m);var j=e*6;var u=this.curves;var a=u[j];if(!a){return m}if(a==-1){return 0}var v=u[j+1];var s=u[j+2];var r=u[j+3];var g=u[j+4];var f=u[j+5];var q=a,n=v;var k=10-2;while(true){if(q>=m){var d=q-a;var b=n-v;return b+(n-b)*(m-d)/(q-d)}if(k==0){break}k--;a+=s;v+=r;s+=g;r+=f;q+=a;n+=v}return n+(1-n)*(m-q)/(1-q)}};spine.RotateTimeline=function(a){this.curves=new spine.Curves(a);this.frames=[];this.frames.length=a*2};spine.RotateTimeline.prototype={boneIndex:0,getFrameCount:function(){return this.frames.length/2},setFrame:function(d,a,b){d*=2;this.frames[d]=a;this.frames[d+1]=b},apply:function(e,a,d,r,f){var n=this.frames;if(d<n[0]){return}var q=e.bones[this.boneIndex];if(d>=n[n.length-2]){var g=q.data.rotation+n[n.length-1]-q.rotation;while(g>180){g-=360}while(g<-180){g+=360}q.rotation+=g*f;return}var b=spine.binarySearch(n,d,2);var j=n[b-1];var m=n[b];var k=1-(d-m)/(n[b-2]-m);k=this.curves.getCurvePercent(b/2-1,k);var g=n[b+1]-j;while(g>180){g-=360}while(g<-180){g+=360}g=q.data.rotation+(j+g*k)-q.rotation;while(g>180){g-=360}while(g<-180){g+=360}q.rotation+=g*f}};spine.TranslateTimeline=function(a){this.curves=new spine.Curves(a);this.frames=[];this.frames.length=a*3};spine.TranslateTimeline.prototype={boneIndex:0,getFrameCount:function(){return this.frames.length/3},setFrame:function(e,b,a,d){e*=3;this.frames[e]=b;this.frames[e+1]=a;this.frames[e+2]=d},apply:function(e,a,d,r,f){var n=this.frames;if(d<n[0]){return}var q=e.bones[this.boneIndex];if(d>=n[n.length-3]){q.x+=(q.data.x+n[n.length-2]-q.x)*f;q.y+=(q.data.y+n[n.length-1]-q.y)*f;return}var b=spine.binarySearch(n,d,3);var j=n[b-2];var g=n[b-1];var m=n[b];var k=1-(d-m)/(n[b+-3]-m);k=this.curves.getCurvePercent(b/3-1,k);q.x+=(q.data.x+j+(n[b+1]-j)*k-q.x)*f;q.y+=(q.data.y+g+(n[b+2]-g)*k-q.y)*f}};spine.ScaleTimeline=function(a){this.curves=new spine.Curves(a);this.frames=[];this.frames.length=a*3};spine.ScaleTimeline.prototype={boneIndex:0,getFrameCount:function(){return this.frames.length/3},setFrame:function(e,b,a,d){e*=3;this.frames[e]=b;this.frames[e+1]=a;this.frames[e+2]=d},apply:function(e,a,d,r,f){var n=this.frames;if(d<n[0]){return}var q=e.bones[this.boneIndex];if(d>=n[n.length-3]){q.scaleX+=(q.data.scaleX-1+n[n.length-2]-q.scaleX)*f;q.scaleY+=(q.data.scaleY-1+n[n.length-1]-q.scaleY)*f;return}var b=spine.binarySearch(n,d,3);var j=n[b-2];var g=n[b-1];var m=n[b];var k=1-(d-m)/(n[b+-3]-m);k=this.curves.getCurvePercent(b/3-1,k);q.scaleX+=(q.data.scaleX-1+j+(n[b+1]-j)*k-q.scaleX)*f;q.scaleY+=(q.data.scaleY-1+g+(n[b+2]-g)*k-q.scaleY)*f}};spine.ColorTimeline=function(a){this.curves=new spine.Curves(a);this.frames=[];this.frames.length=a*5};spine.ColorTimeline.prototype={slotIndex:0,getFrameCount:function(){return this.frames.length/5},setFrame:function(m,k,j,f,d,e){m*=5;this.frames[m]=k;this.frames[m+1]=j;this.frames[m+2]=f;this.frames[m+3]=d;this.frames[m+4]=e},apply:function(f,D,k,F,j){var s=this.frames;if(k<s[0]){return}var e=f.slots[this.slotIndex];if(k>=s[s.length-5]){var z=s.length-1;e.r=s[z-3];e.g=s[z-2];e.b=s[z-1];e.a=s[z];return}var m=spine.binarySearch(s,k,5);var n=s[m-4];var v=s[m-3];var y=s[m-2];var A=s[m-1];var q=s[m];var d=1-(k-q)/(s[m-5]-q);d=this.curves.getCurvePercent(m/5-1,d);var u=n+(s[m+1]-n)*d;var B=v+(s[m+2]-v)*d;var C=y+(s[m+3]-y)*d;var E=A+(s[m+4]-A)*d;if(j<1){e.r+=(u-e.r)*j;e.g+=(B-e.g)*j;e.b+=(C-e.b)*j;e.a+=(E-e.a)*j}else{e.r=u;e.g=B;e.b=C;e.a=E}}};spine.AttachmentTimeline=function(a){this.curves=new spine.Curves(a);this.frames=[];this.frames.length=a;this.attachmentNames=[];this.attachmentNames.length=a};spine.AttachmentTimeline.prototype={slotIndex:0,getFrameCount:function(){return this.frames.length},setFrame:function(d,b,a){this.frames[d]=b;this.attachmentNames[d]=a},apply:function(g,f,e,a,d){var j=this.frames;if(e<j[0]){return}var k;if(e>=j[j.length-1]){k=j.length-1}else{k=spine.binarySearch(j,e,1)-1}var b=this.attachmentNames[k];g.slots[this.slotIndex].setAttachment(!b?null:g.getAttachmentBySlotIndex(this.slotIndex,b))}};spine.EventTimeline=function(a){this.frames=[];this.frames.length=a;this.events=[];this.events.length=a};spine.EventTimeline.prototype={getFrameCount:function(){return this.frames.length},setFrame:function(d,b,a){this.frames[d]=b;this.events[d]=a},apply:function(g,a,f,n,j){if(!n){return}var k=this.frames;var e=k.length;if(a>f){this.apply(g,a,Number.MAX_VALUE,n,j);a=-1}else{if(a>=k[e-1]){return}}if(f<k[0]){return}var d;if(a<k[0]){d=0}else{d=spine.binarySearch(k,a,1);var b=k[d];while(d>0){if(k[d-1]!=b){break}d--}}var m=this.events;for(;d<e&&f>=k[d];d++){n.push(m[d])}}};spine.DrawOrderTimeline=function(a){this.frames=[];this.frames.length=a;this.drawOrders=[];this.drawOrders.length=a};spine.DrawOrderTimeline.prototype={getFrameCount:function(){return this.frames.length},setFrame:function(d,a,b){this.frames[d]=a;this.drawOrders[d]=b},apply:function(g,b,f,s,j){var q=this.frames;if(f<q[0]){return}var d;if(f>=q[q.length-1]){d=q.length-1}else{d=spine.binarySearch(q,f,1)-1}var a=g.drawOrder;var m=g.slots;var r=this.drawOrders[d];if(!r){for(var k=0,e=m.length;k<e;k++){a[k]=m[k]}}else{for(var k=0,e=r.length;k<e;k++){a[k]=g.slots[r[k]]}}}};spine.SkeletonData=function(){this.bones=[];this.slots=[];this.skins=[];this.events=[];this.animations=[]};spine.SkeletonData.prototype={defaultSkin:null,findBone:function(d){var a=this.bones;for(var b=0,e=a.length;b<e;b++){if(a[b].name==d){return a[b]}}return null},findBoneIndex:function(d){var a=this.bones;for(var b=0,e=a.length;b<e;b++){if(a[b].name==d){return b}}return -1},findSlot:function(a){var d=this.slots;for(var b=0,e=d.length;b<e;b++){if(d[b].name==a){return d[b]}}return null},findSlotIndex:function(a){var d=this.slots;for(var b=0,e=d.length;b<e;b++){if(d[b].name==a){return b}}return -1},findSkin:function(a){var d=this.skins;for(var b=0,e=d.length;b<e;b++){if(d[b].name==a){return d[b]}}return null},findEvent:function(a){var d=this.events;for(var b=0,e=d.length;b<e;b++){if(d[b].name==a){return d[b]}}return null},findAnimation:function(b){var e=this.animations;for(var a=0,d=e.length;a<d;a++){if(e[a].name==b){return e[a]}}return null}};spine.Skeleton=function(a){this.data=a;this.bones=[];for(var b=0,k=a.bones.length;b<k;b++){var g=a.bones[b];var d=!g.parent?null:this.bones[a.bones.indexOf(g.parent)];this.bones.push(new spine.Bone(g,d))}this.slots=[];this.drawOrder=[];for(var b=0,k=a.slots.length;b<k;b++){var e=a.slots[b];var f=this.bones[a.bones.indexOf(e.boneData)];var j=new spine.Slot(e,this,f);this.slots.push(j);this.drawOrder.push(j)}};spine.Skeleton.prototype={x:0,y:0,skin:null,r:1,g:1,b:1,a:1,time:0,flipX:false,flipY:false,updateWorldTransform:function(){var d=this.flipX;var b=this.flipY;var a=this.bones;for(var e=0,f=a.length;e<f;e++){a[e].updateWorldTransform(d,b)}},setToSetupPose:function(){this.setBonesToSetupPose();this.setSlotsToSetupPose()},setBonesToSetupPose:function(){var a=this.bones;for(var b=0,d=a.length;b<d;b++){a[b].setToSetupPose()}},setSlotsToSetupPose:function(){var b=this.slots;for(var a=0,d=b.length;a<d;a++){b[a].setToSetupPose(a)}},getRootBone:function(){return this.bones.length==0?null:this.bones[0]},findBone:function(d){var a=this.bones;for(var b=0,e=a.length;b<e;b++){if(a[b].data.name==d){return a[b]}}return null},findBoneIndex:function(d){var a=this.bones;for(var b=0,e=a.length;b<e;b++){if(a[b].data.name==d){return b}}return -1},findSlot:function(a){var d=this.slots;for(var b=0,e=d.length;b<e;b++){if(d[b].data.name==a){return d[b]}}return null},findSlotIndex:function(a){var d=this.slots;for(var b=0,e=d.length;b<e;b++){if(d[b].data.name==a){return b}}return -1},setSkinByName:function(a){var b=this.data.findSkin(a);if(!b){throw"Skin not found: "+a}this.setSkin(b)},setSkin:function(a){if(this.skin&&a){a._attachAll(this,this.skin)}this.skin=a},getAttachmentBySlotName:function(b,a){return this.getAttachmentBySlotIndex(this.data.findSlotIndex(b),a)},getAttachmentBySlotIndex:function(b,a){if(this.skin){var d=this.skin.getAttachment(b,a);if(d){return d}}if(this.data.defaultSkin){return this.data.defaultSkin.getAttachment(b,a)}return null},setAttachment:function(b,a){var e=this.slots;for(var d=0,j=e.length;d<j;d++){var g=e[d];if(g.data.name==b){var f=null;if(a){f=this.getAttachment(d,a);if(!f){throw"Attachment not found: "+a+", for slot: "+b}}g.setAttachment(f);return}}throw"Slot not found: "+b},update:function(a){this.time+=a}};spine.EventData=function(a){this.name=a};spine.EventData.prototype={intValue:0,floatValue:0,stringValue:null};spine.Event=function(a){this.data=a};spine.Event.prototype={intValue:0,floatValue:0,stringValue:null};spine.AttachmentType={region:0,boundingbox:1};spine.RegionAttachment=function(a){this.name=a;this.offset=[];this.offset.length=8;this.uvs=[];this.uvs.length=8};spine.RegionAttachment.prototype={type:spine.AttachmentType.region,x:0,y:0,rotation:0,scaleX:1,scaleY:1,width:0,height:0,rendererObject:null,regionOffsetX:0,regionOffsetY:0,regionWidth:0,regionHeight:0,regionOriginalWidth:0,regionOriginalHeight:0,setUVs:function(d,a,f,g,b){var e=this.uvs;if(b){e[2]=d;e[3]=g;e[4]=d;e[5]=a;e[6]=f;e[7]=a;e[0]=f;e[1]=g}else{e[0]=d;e[1]=g;e[2]=d;e[3]=a;e[4]=f;e[5]=a;e[6]=f;e[7]=g}},updateOffset:function(){var y=this.width/this.regionOriginalWidth*this.scaleX;var v=this.height/this.regionOriginalHeight*this.scaleY;var b=-this.width/2*this.scaleX+this.regionOffsetX*y;var A=-this.height/2*this.scaleY+this.regionOffsetY*v;var j=b+this.regionWidth*y;var u=A+this.regionHeight*v;var z=this.rotation*Math.PI/180;var d=Math.cos(z);var a=Math.sin(z);var m=b*d+this.x;var k=b*a;var r=A*d+this.y;var n=A*a;var s=j*d+this.x;var q=j*a;var f=u*d+this.y;var e=u*a;var g=this.offset;g[0]=m-n;g[1]=r+k;g[2]=m-e;g[3]=f+k;g[4]=s-e;g[5]=f+q;g[6]=s-n;g[7]=r+q},computeVertices:function(g,f,k,e){g+=k.worldX;f+=k.worldY;var m=k.m00;var j=k.m01;var d=k.m10;var b=k.m11;var a=this.offset;e[0]=a[0]*m+a[1]*j+g;e[1]=a[0]*d+a[1]*b+f;e[2]=a[2]*m+a[3]*j+g;e[3]=a[2]*d+a[3]*b+f;e[4]=a[4]*m+a[5]*j+g;e[5]=a[4]*d+a[5]*b+f;e[6]=a[6]*m+a[7]*j+g;e[7]=a[6]*d+a[7]*b+f}};spine.BoundingBoxAttachment=function(a){this.name=a;this.vertices=[]};spine.BoundingBoxAttachment.prototype={type:spine.AttachmentType.boundingBox,computeWorldVertices:function(m,j,s,a){m+=s.worldX;j+=s.worldY;var u=s.m00;var r=s.m01;var f=s.m10;var e=s.m11;var g=this.vertices;for(var d=0,b=g.length;d<b;d+=2){var q=g[d];var k=g[d+1];a[d]=q*u+k*r+m;a[d+1]=q*f+k*e+j}}};spine.AnimationStateData=function(a){this.skeletonData=a;this.animationToMixTime={}};spine.AnimationStateData.prototype={defaultMix:0,setMixByName:function(b,a,d){var f=this.skeletonData.findAnimation(b);if(!f){throw"Animation not found: "+b}var e=this.skeletonData.findAnimation(a);if(!e){throw"Animation not found: "+a}this.setMix(f,e,d)},setMix:function(d,b,a){this.animationToMixTime[d.name+":"+b.name]=a},getMix:function(d,b){var a=this.animationToMixTime[d.name+":"+b.name];return a?a:this.defaultMix}};spine.TrackEntry=function(){};spine.TrackEntry.prototype={next:null,previous:null,animation:null,loop:false,delay:0,time:0,lastTime:-1,endTime:0,timeScale:1,mixTime:0,mixDuration:0,onStart:null,onEnd:null,onComplete:null,onEvent:null};spine.AnimationState=function(a){this.data=a;this.tracks=[];this.events=[]};spine.AnimationState.prototype={onStart:null,onEnd:null,onComplete:null,onEvent:null,timeScale:1,update:function(f){f*=this.timeScale;for(var a=0;a<this.tracks.length;a++){var e=this.tracks[a];if(!e){continue}var d=f*e.timeScale;e.time+=d;if(e.previous){e.previous.time+=d;e.mixTime+=d}var b=e.next;if(b){if(e.lastTime>=b.delay){this.setCurrent(a,b)}}else{if(!e.loop&&e.lastTime>=e.endTime){this.clearTrack(a)}}}},apply:function(f){for(var g=0;g<this.tracks.length;g++){var q=this.tracks[g];if(!q){continue}this.events.length=0;var d=q.time;var b=q.lastTime;var m=q.endTime;var j=q.loop;if(!j&&d>m){d=m}var k=q.previous;if(!k){q.animation.apply(f,q.lastTime,d,j,this.events)}else{var r=k.time;if(!k.loop&&r>k.endTime){r=k.endTime}k.animation.apply(f,r,r,k.loop,null);var e=q.mixTime/q.mixDuration;if(e>=1){e=1;q.previous=null}q.animation.mix(f,q.lastTime,d,j,this.events,e)}for(var s=0,u=this.events.length;s<u;s++){var a=this.events[s];if(q.onEvent!=null){q.onEvent(g,a)}if(this.onEvent!=null){this.onEvent(g,a)}}if(j?(b%m>d%m):(b<m&&d>=m)){var n=Math.floor(d/m);if(q.onComplete){q.onComplete(g,n)}if(this.onComplete){this.onComplete(g,n)}}q.lastTime=q.time}},clearTracks:function(){for(var a=0,b=this.tracks.length;a<b;a++){this.clearTrack(a)}this.tracks.length=0},clearTrack:function(b){if(b>=this.tracks.length){return}var a=this.tracks[b];if(!a){return}if(a.onEnd!=null){a.onEnd(b)}if(this.onEnd!=null){this.onEnd(b)}this.tracks[b]=null},_expandToIndex:function(a){if(a<this.tracks.length){return this.tracks[a]}while(a>=this.tracks.length){this.tracks.push(null)}return null},setCurrent:function(a,b){var d=this._expandToIndex(a);if(d){d.previous=null;if(d.onEnd!=null){d.onEnd(a)}if(this.onEnd!=null){this.onEnd(a)}b.mixDuration=this.data.getMix(d.animation,b.animation);if(b.mixDuration>0){b.mixTime=0;b.previous=d}}this.tracks[a]=b;if(b.onStart!=null){b.onStart(a)}if(this.onStart!=null){this.onStart(a)}},setAnimationByName:function(e,b,a){var d=this.data.skeletonData.findAnimation(b);if(!d){throw"Animation not found: "+b}return this.setAnimation(e,d,a)},setAnimation:function(e,d,a){var b=new spine.TrackEntry();b.animation=d;b.loop=a;b.endTime=d.duration;this.setCurrent(e,b);return b},addAnimationByName:function(f,d,a,b){var e=this.data.skeletonData.findAnimation(d);if(!e){throw"Animation not found: "+d}return this.addAnimation(f,e,a,b)},addAnimation:function(g,f,a,b){var e=new spine.TrackEntry();e.animation=f;e.loop=a;e.endTime=f.duration;var d=this._expandToIndex(g);if(d){while(d.next){d=d.next}d.next=e}else{this.tracks[g]=e}if(b<=0){if(d){b+=d.endTime-this.data.getMix(d.animation,f)}else{b=0}}e.delay=b;return e},getCurrent:function(a){if(a>=this.tracks.length){return null}return this.tracks[a]}};spine.SkeletonJson=function(a){this.attachmentLoader=a};spine.SkeletonJson.prototype={scale:1,readSkeletonData:function(C){var b=new spine.SkeletonData();var H=C.bones;for(var F=0,A=H.length;F<A;F++){var J=H[F];var q=null;if(J.parent){q=b.findBone(J.parent);if(!q){throw"Parent bone not found: "+J.parent}}var f=new spine.BoneData(J.name,q);f.length=(J.length||0)*this.scale;f.x=(J.x||0)*this.scale;f.y=(J.y||0)*this.scale;f.rotation=(J.rotation||0);f.scaleX=J.scaleX||1;f.scaleY=J.scaleY||1;f.inheritScale=J.inheritScale||true;f.inheritRotation=J.inheritRotation||true;b.bones.push(f)}var s=C.slots;for(var F=0,A=s.length;F<A;F++){var G=s[F];var f=b.findBone(G.bone);if(!f){throw"Slot bone not found: "+G.bone}var g=new spine.SlotData(G.name,f);var E=G.color;if(E){g.r=spine.SkeletonJson.toColor(E,0);g.g=spine.SkeletonJson.toColor(E,1);g.b=spine.SkeletonJson.toColor(E,2);g.a=spine.SkeletonJson.toColor(E,3)}g.attachmentName=G.attachment;g.additiveBlending=G.additive;b.slots.push(g)}var K=C.skins;for(var u in K){if(!K.hasOwnProperty(u)){continue}var z=K[u];var D=new spine.Skin(u);for(var j in z){if(!z.hasOwnProperty(j)){continue}var I=b.findSlotIndex(j);var B=z[j];for(var y in B){if(!B.hasOwnProperty(y)){continue}var r=this.readAttachment(D,y,B[y]);if(r!=null){D.addAttachment(I,y,r)}}}b.skins.push(D);if(D.name=="default"){b.defaultSkin=D}}var a=C.events;for(var e in a){if(!a.hasOwnProperty(e)){continue}var v=a[e];var d=new spine.EventData(e);d.intValue=v["int"]||0;d.floatValue=v["float"]||0;d.stringValue=v.string||null;b.events.push(d)}var m=C.animations;for(var k in m){if(!m.hasOwnProperty(k)){continue}this.readAnimation(k,m[k],b)}return b},readAttachment:function(g,b,f){b=f.name||b;var e=spine.AttachmentType[f.type||"region"];var j=this.attachmentLoader.newAttachment(g,e,b);if(e==spine.AttachmentType.region){j.x=(f.x||0)*this.scale;j.y=(f.y||0)*this.scale;j.scaleX=f.scaleX||1;j.scaleY=f.scaleY||1;j.rotation=f.rotation||0;j.width=(f.width||32)*this.scale;j.height=(f.height||32)*this.scale;j.updateOffset()}else{if(e==spine.AttachmentType.boundingBox){var a=f.vertices;for(var d=0,k=a.length;d<k;d++){j.vertices.push(a[d]*scale)}}}return j},readAnimation:function(A,I,U){var M=[];var G=0;var S=I.bones;for(var z in S){if(!S.hasOwnProperty(z)){continue}var v=U.findBoneIndex(z);if(v==-1){throw"Bone not found: "+z}var q=S[z];for(var d in q){if(!q.hasOwnProperty(d)){continue}var ac=q[d];if(d=="rotate"){var u=new spine.RotateTimeline(ac.length);u.boneIndex=v;var j=0;for(var V=0,T=ac.length;V<T;V++){var X=ac[V];u.setFrame(j,X.time,X.angle);spine.SkeletonJson.readCurve(u,j,X);j++}M.push(u);G=Math.max(G,u.frames[u.getFrameCount()*2-2])}else{if(d=="translate"||d=="scale"){var u;var D=1;if(d=="scale"){u=new spine.ScaleTimeline(ac.length)}else{u=new spine.TranslateTimeline(ac.length);D=this.scale}u.boneIndex=v;var j=0;for(var V=0,T=ac.length;V<T;V++){var X=ac[V];var O=(X.x||0)*D;var N=(X.y||0)*D;u.setFrame(j,X.time,O,N);spine.SkeletonJson.readCurve(u,j,X);j++}M.push(u);G=Math.max(G,u.frames[u.getFrameCount()*3-3])}else{throw"Invalid timeline type for a bone: "+d+" ("+z+")"}}}}var Z=I.slots;for(var ab in Z){if(!Z.hasOwnProperty(ab)){continue}var H=Z[ab];var ae=U.findSlotIndex(ab);for(var d in H){if(!H.hasOwnProperty(d)){continue}var ac=H[d];if(d=="color"){var u=new spine.ColorTimeline(ac.length);u.slotIndex=ae;var j=0;for(var V=0,T=ac.length;V<T;V++){var X=ac[V];var J=X.color;var P=spine.SkeletonJson.toColor(J,0);var W=spine.SkeletonJson.toColor(J,1);var aa=spine.SkeletonJson.toColor(J,2);var ad=spine.SkeletonJson.toColor(J,3);u.setFrame(j,X.time,P,W,aa,ad);spine.SkeletonJson.readCurve(u,j,X);j++}M.push(u);G=Math.max(G,u.frames[u.getFrameCount()*5-5])}else{if(d=="attachment"){var u=new spine.AttachmentTimeline(ac.length);u.slotIndex=ae;var j=0;for(var V=0,T=ac.length;V<T;V++){var X=ac[V];u.setFrame(j++,X.time,X.name)}M.push(u);G=Math.max(G,u.frames[u.getFrameCount()-1])}else{throw"Invalid timeline type for a slot: "+d+" ("+ab+")"}}}}var E=I.events;if(E){var u=new spine.EventTimeline(E.length);var j=0;for(var V=0,T=E.length;V<T;V++){var f=E[V];var B=U.findEvent(f.name);if(!B){throw"Event not found: "+f.name}var af=new spine.Event(B);af.intValue=f.hasOwnProperty("int")?f["int"]:B.intValue;af.floatValue=f.hasOwnProperty("float")?f["float"]:B.floatValue;af.stringValue=f.hasOwnProperty("string")?f.string:B.stringValue;u.setFrame(j++,f.time,af)}M.push(u);G=Math.max(G,u.frames[u.getFrameCount()-1])}var R=I.draworder;if(R){var u=new spine.DrawOrderTimeline(R.length);var s=U.slots.length;var j=0;for(var V=0,T=R.length;V<T;V++){var ag=R[V];var L=null;if(ag.offsets){L=[];L.length=s;for(var K=s-1;K>=0;K--){L[K]=-1}var C=ag.offsets;var e=[];e.length=s-C.length;var m=0,F=0;for(var K=0,Y=C.length;K<Y;K++){var k=C[K];var ae=U.findSlotIndex(k.slot);if(ae==-1){throw"Slot not found: "+k.slot}while(m!=ae){e[F++]=m++}L[m+k.offset]=m++}while(m<s){e[F++]=m++}for(var K=s-1;K>=0;K--){if(L[K]==-1){L[K]=e[--F]}}}u.setFrame(j++,ag.time,L)}M.push(u);G=Math.max(G,u.frames[u.getFrameCount()-1])}U.animations.push(new spine.Animation(A,M,G))}};spine.SkeletonJson.readCurve=function(a,e,d){var b=d.curve;if(!b){return}if(b=="stepped"){a.curves.setStepped(e)}else{if(b instanceof Array){a.curves.setCurve(e,b[0],b[1],b[2],b[3])}}};spine.SkeletonJson.toColor=function(a,b){if(a.length!=8){throw"Color hexidecimal length must be 8, recieved: "+a}return parseInt(a.substring(b*2,(b*2)+2),16)/255};spine.Atlas=function(j,a){this.textureLoader=a;this.pages=[];this.regions=[];var d=new spine.AtlasReader(j);var n=[];n.length=4;var e=null;while(true){var r=d.readLine();if(r==null){break}r=d.trim(r);if(r.length==0){e=null}else{if(!e){e=new spine.AtlasPage();e.name=r;e.format=spine.Atlas.Format[d.readValue()];d.readTuple(n);e.minFilter=spine.Atlas.TextureFilter[n[0]];e.magFilter=spine.Atlas.TextureFilter[n[1]];var m=d.readValue();e.uWrap=spine.Atlas.TextureWrap.clampToEdge;e.vWrap=spine.Atlas.TextureWrap.clampToEdge;if(m=="x"){e.uWrap=spine.Atlas.TextureWrap.repeat}else{if(m=="y"){e.vWrap=spine.Atlas.TextureWrap.repeat}else{if(m=="xy"){e.uWrap=e.vWrap=spine.Atlas.TextureWrap.repeat}}}a.load(e,r,this);this.pages.push(e)}else{var g=new spine.AtlasRegion();g.name=r;g.page=e;g.rotate=d.readValue()=="true";d.readTuple(n);var k=parseInt(n[0]);var f=parseInt(n[1]);d.readTuple(n);var b=parseInt(n[0]);var q=parseInt(n[1]);g.u=k/e.width;g.v=f/e.height;if(g.rotate){g.u2=(k+q)/e.width;g.v2=(f+b)/e.height}else{g.u2=(k+b)/e.width;g.v2=(f+q)/e.height}g.x=k;g.y=f;g.width=Math.abs(b);g.height=Math.abs(q);if(d.readTuple(n)==4){g.splits=[parseInt(n[0]),parseInt(n[1]),parseInt(n[2]),parseInt(n[3])];if(d.readTuple(n)==4){g.pads=[parseInt(n[0]),parseInt(n[1]),parseInt(n[2]),parseInt(n[3])];d.readTuple(n)}}g.originalWidth=parseInt(n[0]);g.originalHeight=parseInt(n[1]);d.readTuple(n);g.offsetX=parseInt(n[0]);g.offsetY=parseInt(n[1]);g.index=parseInt(d.readValue());this.regions.push(g)}}}};spine.Atlas.prototype={findRegion:function(a){var e=this.regions;for(var b=0,d=e.length;b<d;b++){if(e[b].name==a){return e[b]}}return null},dispose:function(){var a=this.pages;for(var b=0,d=a.length;b<d;b++){this.textureLoader.unload(a[b].rendererObject)}},updateUVs:function(b){var f=this.regions;for(var a=0,e=f.length;a<e;a++){var d=f[a];if(d.page!=b){continue}d.u=d.x/b.width;d.v=d.y/b.height;if(d.rotate){d.u2=(d.x+d.height)/b.width;d.v2=(d.y+d.width)/b.height}else{d.u2=(d.x+d.width)/b.width;d.v2=(d.y+d.height)/b.height}}}};spine.Atlas.Format={alpha:0,intensity:1,luminanceAlpha:2,rgb565:3,rgba4444:4,rgb888:5,rgba8888:6};spine.Atlas.TextureFilter={nearest:0,linear:1,mipMap:2,mipMapNearestNearest:3,mipMapLinearNearest:4,mipMapNearestLinear:5,mipMapLinearLinear:6};spine.Atlas.TextureWrap={mirroredRepeat:0,clampToEdge:1,repeat:2};spine.AtlasPage=function(){};spine.AtlasPage.prototype={name:null,format:null,minFilter:null,magFilter:null,uWrap:null,vWrap:null,rendererObject:null,width:0,height:0};spine.AtlasRegion=function(){};spine.AtlasRegion.prototype={page:null,name:null,x:0,y:0,width:0,height:0,u:0,v:0,u2:0,v2:0,offsetX:0,offsetY:0,originalWidth:0,originalHeight:0,index:0,rotate:false,splits:null,pads:null};spine.AtlasReader=function(a){this.lines=a.split(/\r\n|\r|\n/)};spine.AtlasReader.prototype={index:0,trim:function(a){return a.replace(/^\s+|\s+$/g,"")},readLine:function(){if(this.index>=this.lines.length){return null}return this.lines[this.index++]},readValue:function(){var a=this.readLine();var b=a.indexOf(":");if(b==-1){throw"Invalid line: "+a}return this.trim(a.substring(b+1))},readTuple:function(b){var d=this.readLine();var f=d.indexOf(":");if(f==-1){throw"Invalid line: "+d}var e=0,g=f+1;for(;e<3;e++){var a=d.indexOf(",",g);if(a==-1){if(e==0){throw"Invalid line: "+d}break}b[e]=this.trim(d.substr(g,a-g));g=a+1}b[e]=this.trim(d.substring(g));return e+1}};spine.AtlasAttachmentLoader=function(a){this.atlas=a};spine.AtlasAttachmentLoader.prototype={newAttachment:function(e,b,a){switch(b){case spine.AttachmentType.boundingbox:return new spine.BoundingBoxAttachment(a);case spine.AttachmentType.region:var d=this.atlas.findRegion(a);if(!d){throw"Region not found in atlas: "+a+" ("+b+")"}var f=new spine.RegionAttachment(a);f.rendererObject=d;f.setUVs(d.u,d.v,d.u2,d.v2,d.rotate);f.regionOffsetX=d.offsetX;f.regionOffsetY=d.offsetY;f.regionWidth=d.width;f.regionHeight=d.height;f.regionOriginalWidth=d.originalWidth;f.regionOriginalHeight=d.originalHeight;return f}throw"Unknown attachment type: "+b}};spine.SkeletonBounds=function(){this.polygonPool=[];this.polygons=[];this.boundingBoxes=[]};spine.SkeletonBounds.prototype={minX:0,minY:0,maxX:0,maxY:0,update:function(e,q){var m=e.slots;var j=m.length;var u=e.x,r=e.y;var b=this.boundingBoxes;var k=this.polygonPool;var s=this.polygons;b.length=0;for(var g=0,a=s.length;g<a;g++){k.push(s[g])}s.length=0;for(var g=0;g<j;g++){var v=m[g];var f=v.attachment;if(f.type!=spine.AttachmentType.boundingBox){continue}b.push(f);var d=k.length;if(d>0){polygon=k[d-1];k.splice(d-1,1)}else{polygon=[]}s.push(polygon);polygon.length=f.vertices.length;f.computeWorldVertices(u,r,v.bone,polygon)}if(q){this.aabbCompute()}},aabbCompute:function(){var q=this.polygons;var f=Number.MAX_VALUE,e=Number.MAX_VALUE,b=Number.MIN_VALUE,a=Number.MIN_VALUE;for(var g=0,d=q.length;g<d;g++){var j=q[g];for(var r=0,s=j.length;r<s;r+=2){var m=j[r];var k=j[r+1];f=Math.min(f,m);e=Math.min(e,k);b=Math.max(b,m);a=Math.max(a,k)}}this.minX=f;this.minY=e;this.maxX=b;this.maxY=a},aabbContainsPoint:function(a,b){return a>=this.minX&&a<=this.maxX&&b>=this.minY&&b<=this.maxY},aabbIntersectsSegment:function(e,r,d,n){var j=this.minX,g=this.minY,b=this.maxX,a=this.maxY;if((e<=j&&d<=j)||(r<=g&&n<=g)||(e>=b&&d>=b)||(r>=a&&n>=a)){return false}var f=(n-r)/(d-e);var k=f*(j-e)+r;if(k>g&&k<a){return true}k=f*(b-e)+r;if(k>g&&k<a){return true}var q=(g-r)/f+e;if(q>j&&q<b){return true}q=(a-r)/f+e;if(q>j&&q<b){return true}return false},aabbIntersectsSkeleton:function(a){return this.minX<a.maxX&&this.maxX>a.minX&&this.minY<a.maxY&&this.maxY>a.minY},containsPoint:function(a,f){var b=this.polygons;for(var d=0,e=b.length;d<e;d++){if(this.polygonContainsPoint(b[d],a,f)){return this.boundingBoxes[d]}}return null},intersectsSegment:function(d,g,b,f){var a=this.polygons;for(var e=0,j=a.length;e<j;e++){if(a[e].intersectsSegment(d,g,b,f)){return boundingBoxes[e]}}return null},polygonContainsPoint:function(j,k,g){var n=j.length;var d=n-2;var e=false;for(var m=0;m<n;m+=2){var a=j[m+1];var f=j[d+1];if((a<g&&f>=g)||(f<g&&a>=g)){var b=j[m];if(b+(g-a)/(f-a)*(j[d]-b)<k){e=!e}}d=m}return e},intersectsSegment:function(s,D,g,B,f){var b=s.length;var C=D-B,e=g-f;var m=D*f-g*B;var A=s[b-2],d=s[b-1];for(var u=0;u<b;u+=2){var v=s[u],a=s[u+1];var k=A*a-d*v;var r=A-v,z=d-a;var j=C*z-e*r;var q=(m*r-C*k)/j;if(((q>=A&&q<=v)||(q>=v&&q<=A))&&((q>=D&&q<=B)||(q>=B&&q<=D))){var n=(m*z-e*k)/j;if(((n>=d&&n<=a)||(n>=a&&n<=d))&&((n>=g&&n<=f)||(n>=f&&n<=g))){return true}}A=v;d=a}return false},getPolygon:function(b){var a=this.boundingBoxes.indexOf(b);return a==-1?null:this.polygons[a]},getWidth:function(){return this.maxX-this.minX},getHeight:function(){return this.maxY-this.minY}};var Clock=function(d){this.targetfps=d||60;this.startTime=Date.now();this.ms=this.startTime;this.last=this.startTime;this.time=0;this.dt=0;this.delta=0;this.fps=0;this.frameCount=0;this.frameCounter=true;var b=0;var a=0;this.tick=function(){if(this.frameCounter){this.frameCount++}this.ms=Date.now();this.dt=this.ms-this.last;this.last=this.ms;this.delta=this.dt/(1000/this.targetfps);this.time+=0.001*this.dt;if(this.frameCounter){b+=this.dt;a++;if(b>1000){this.fps=Math.round((a*1000)/b);a=0;b=0}}}};function loadString(a){var b=new XMLHttpRequest();b.open("GET",a,false);b.send(null);if((b.status==200)||(b.status==0)){return b.responseText}return""}String.prototype.ltrim=function(a){if(a){return this.replace(new RegExp("^["+a+"]+"),"")}return this.replace(/^\s+/,"")};String.prototype.rtrim=function(a){if(a){return this.replace(new RegExp("["+a+"]+$"),"")}return this.replace(/\s+$/,"")};String.prototype.trim=function(a){if(a){return this.ltrim(a).rtrim(a)}return this.ltrim().rtrim()};String.prototype.startsWith=function(a){return !this.indexOf(a)};CG.Class.extend("CanvasRenderer",{init:function(a){return this},draw:function(d){Game.b_ctx.save();switch(d.instanceOf){case"Sprite":case"Button":case"Particle":Game.b_ctx.globalAlpha=d.alpha;Game.b_ctx.transform(1,0,0,1,d.position.x,d.position.y);if(d.atlasimage){Game.b_ctx.rotate((d.rotation-d.imagerotation)*CG.Const_PI_180);Game.b_ctx.drawImage(d.image,d.xoffset,d.yoffset,d.cutwidth,d.cutheight,0-d.xhandle,0-d.yhandle,d.cutwidth*d.xscale,d.cutheight*d.yscale)}else{Game.b_ctx.rotate(d.rotation*CG.Const_PI_180);Game.b_ctx.drawImage(d.image,0-d.xhandle,0-d.yhandle,d.image.width*d.xscale,d.image.height*d.yscale)}break;case"SpineAnimation":Game.b_ctx.globalAlpha=d.alpha;Game.b_ctx.transform(d.transform.m[0],d.transform.m[1],d.transform.m[2],d.transform.m[3],d.transform.m[4],d.transform.m[5]);Game.b_ctx.drawImage(d.image,d.xoffset,d.yoffset,d.cutwidth,d.cutheight,d.xpos,d.ypos,d.cutwidth*d.xscale,d.cutheight*d.yscale);break;case"Animation":Game.b_ctx.globalAlpha=d.alpha;Game.b_ctx.transform(1,0,0,1,d.position.x,d.position.y);if(d.frames==1){Game.b_ctx.drawImage(d.image,d.position.x,d.position.y,d.image.width*d.xscale,d.image.height*d.yscale)}else{d.fx=d.currentFrame*d.width;if((d.fx/d.image.width)>0){d.fx=d.fx%d.image.width}d.fy=Math.floor(d.width*d.currentFrame/d.image.width)*d.height;Game.b_ctx.rotate(d.rotation*CG.Const_PI_180);try{Game.b_ctx.drawImage(d.image,d.fx,d.fy,d.width,d.height,0-d.xhandle,0-d.yhandle,d.width*d.xscale,d.height*d.yscale)}catch(g){}}break;case"Font":for(var f=0,b=d.text.length;f<b;f++){var a=d.text.charCodeAt(f);try{Game.b_ctx.drawImage(d.atlas,d.x[a],d.y[a],d.width[a],d.height[a],d.currentX,d.currentY+d.yoff[a],d.width[a],d.height[a])}catch(g){}d.currentX+=d.xadv[a]}break;case"Bitmap":Game.b_ctx.drawImage(d.bitmap_canvas,d.x,d.y);break;case"Map":Game.b_ctx.globalAlpha=d.layers[d.layer].opacity;Game.b_ctx.transform(1,0,0,1,d.rx,d.ry);if(d.orientation=="orthogonal"){try{Game.b_ctx.drawImage(d.atlas,d.cx,d.cy,d.tilewidth,d.tileheight,d.sx,d.sy,d.tilewidth*d.xscale,d.tileheight*d.yscale)}catch(g){}}else{if(d.orientation=="isometric"){try{Game.b_ctx.drawImage(d.atlas,d.cx,d.cy,d.tilewidth,d.tileset.tileheight,d.sx,d.sy,d.tilewidth*d.xscale,d.tileset.tileheight*d.yscale)}catch(g){}}}break;case"B2DEntity":case"B2DCircle":case"B2DRectangle":case"B2DPolygon":case"B2DBridge":case"B2DRope":Game.b_ctx.globalAlpha=d.alpha;Game.b_ctx.transform(1,0,0,1,d.body.GetPosition().x*d.scale,d.body.GetPosition().y*d.scale);if(d.atlasimage){Game.b_ctx.rotate((d.body.GetAngleRadians()-d.imagerotation));Game.b_ctx.drawImage(d.image,d.xoffset,d.yoffset,d.cutwidth,d.cutheight,0-d.xhandle,0-d.yhandle,d.cutwidth,d.cutheight)}else{Game.b_ctx.rotate(d.body.GetAngleRadians());Game.b_ctx.drawImage(d.image,0-d.xhandle,0-d.yhandle,d.image.width,d.image.height)}break}Game.b_ctx.restore()}});CG.Class.extend("Delta",{init:function(a){this.targetfps=a;this.currenttime=0;this.lasttime=Date.now();this.elapsedtime=0;this.frametime=0;this.delta=0;this.fps=0},update:function(){var a=(Date.now()-this.lasttime)/1000;this.fps=1/a;this.lasttime=Date.now()},getDelta:function(){return this.delta},getFPS:function(){return this.fps}});CG.Class.extend("Entity",{init:function(a){CG._extend(this,{name:"",position:new CG.Point(0,0),visible:true,transform:new Transform(),width:0,height:0,dragable:true,rotation:0,xscale:1,xhandle:0,yscale:1,yhandle:0,clicked:false,hover:false,boundingradius:0,mapcollision:false});if(a){CG._extend(this,a)}return this},update:function(){},updateMatrix:function(){this.transform.reset();this.transform.translate(this.position.x,this.position.y);this.transform.rotate(this.rotation*CG.Const_PI_180);this.transform.scale(this.xscale,this.yscale)},draw:function(){throw {name:"Entity Error",message:"Subclass has no draw method."}},setImage:function(a){this.atlasimage=false;if(a){if(a instanceof CG.AtlasImage){this.image=Game.asset.getImageByName(a.atlasname);this.imagerotation=a.rotation;this.xoffset=a.xoffset;this.yoffset=a.yoffset;this.width=a.width;this.height=a.height;this.atlasimage=true;if(this.imagerotation!==0){this.cutwidth=a.height;this.cutheight=a.width;this.xhandle=this.height/2;this.yhandle=this.width/2}else{this.cutwidth=a.width;this.cutheight=a.height;this.xhandle=this.width/2;this.yhandle=this.height/2}}else{if(typeof a=="string"&&a!=""){this.image=new Image();this.image.src=a;this.image.onload=function(){this.width=this.image.width;this.height=this.image.height;this.xhandle=this.width/2;this.yhandle=this.height/2}}else{this.image=a;this.width=this.image.width;this.height=this.image.height;this.xhandle=this.width/2;this.yhandle=this.height/2}}}},AABB:function(){var b=this.rotation*CG.Const_PI_180,d=Math.sin(b),e=Math.cos(b);if(d<0){d=-d}if(e<0){e=-e}return{bw:this.height*this.xscale*d+this.width*this.yscale*e,bh:this.height*this.xscale*e+this.width*this.yscale*d}},ifClicked:function(){if(CG.mousedown&&this.clickable){var d=CG.mouse.x-this.position.x,a=CG.mouse.y-this.position.y,g=Math.sqrt(d*d+a*a),f=Math.atan2(a,d),j=f-(this.rotation*CG.Const_PI_180),b=Math.cos(j)*g,e=Math.sin(j)*g;if(b>-0.5*(this.width*this.xscale)&&b<0.5*(this.width*this.xscale)&&e>-0.5*(this.height*this.yscale)&&e<0.5*(this.height*this.yscale)){this.clicked=true;CG.mousedown=false;return}else{this.clicked=false}}},ifMouseOver:function(){var d=CG.mouse.x-this.position.x,a=CG.mouse.y-this.position.y,g=Math.sqrt(d*d+a*a),f=Math.atan2(a,d),j=f-(this.rotation*CG.Const_PI_180),b=Math.cos(j)*g,e=Math.sin(j)*g;if(b>-0.5*(this.width*this.xscale)&&b<0.5*(this.width*this.xscale)&&e>-0.5*(this.height*this.yscale)&&e<0.5*(this.height*this.yscale)){this.hover=true;return}else{this.hover=false}},checkCollision:function(a,b){a.forEach(function(e,d){if(e.className=="MapArea"){if((this.position.y+this.AABB().bh/2)>=e.bound.y&&this.position.y-this.AABB().bh/2<=(e.bound.y+e.bound.height)&&(this.position.x+this.AABB().bw/2)>=e.bound.x&&this.position.x-this.AABB().bw/2<=(e.bound.x+e.bound.width)){if(e.type==="outer"){w=0.5*(this.width+e.bound.width);h=0.5*(this.height+e.bound.height);dx=this.position.x-(e.bound.width/2+e.bound.x);dy=this.position.y-(e.bound.height/2+e.bound.y);if(Math.abs(dx)<=w&&Math.abs(dy)<=h){wy=w*dy;hx=h*dx;if(wy>hx){if(wy>-hx){direction="bottom";overlap=((this.position.y-this.AABB().bh/2)-(e.bound.y+e.bound.height))>>0}else{direction="left";overlap=((this.position.x+this.AABB().bw/2)-e.bound.x)>>0}}else{if(wy>-hx){direction="right";overlap=((this.position.x-this.AABB().bw/2)-(e.bound.x+e.bound.width))>>0}else{direction="top";overlap=((this.position.y+this.AABB().bh/2)-e.bound.y)>>0}}}collision={overlap:overlap,direction:direction};b(this,e,collision)}}}else{if(this.boundingradius>0&&e.boundingradius>0){distx=this.position.x-e.position.x;disty=this.position.y-e.position.y;dist=Math.sqrt((distx*distx)+(disty*disty));if(dist<=(this.boundingradius/2*this.xscale+e.boundingradius/2*e.yscale)){collision=false;b(this,e,collision)}}else{if((this.position.y+this.AABB().bh/2)>=e.position.y-e.AABB().bh/2&&this.position.y-this.AABB().bh/2<=(e.position.y+e.AABB().bh/2)&&(this.position.x+this.AABB().bw/2)>=e.position.x-e.AABB().bw/2&&this.position.x-this.AABB().bw/2<=(e.position.x+e.AABB().bw/2)){w=0.5*(this.width+e.width);h=0.5*(this.height+e.height);dx=this.position.x-e.position.x;dy=this.position.y-e.position.y;if(Math.abs(dx)<=w&&Math.abs(dy)<=h){wy=w*dy;hx=h*dx;if(wy>hx){if(wy>-hx){direction="bottom";overlap=((this.position.y-this.AABB().bh/2)-(e.position.y-e.AABB().bh/2))>>0}else{direction="left";overlap=((this.position.x+this.AABB().bw/2)-(e.position.x+e.AABB().bw/2))>>0}}else{if(wy>-hx){direction="right";overlap=((this.position.x-this.AABB().bw/2)-(e.position.x-e.AABB().bw/2))>>0}else{direction="top";overlap=((this.position.y+this.AABB().bh/2)-(e.position.y+e.AABB().bh/2))>>0}}}collision={overlap:overlap,direction:direction};b(this,e,collision)}}}},this);return this}});function EntityException(a){this.msg=a;console.log(this.msg)}CG.Class.extend("Point",{init:function(a,b){this.x=a||0;this.y=b||0}});CG.Point.extend("Vector",{init:function(a,d,b){this._super(this,a,d);this.z=b||0}});CG.Class.extend("Bound",{init:function(a){CG._extend(this,{x:0,y:0,width:0,height:0});if(a){CG._extend(this,a)}return this},setName:function(a){this.name=a;return this}});CG.Class.extend("Buffer",{init:function(b,a){this.b_canvas=document.createElement("canvas");this.b_canvas.width=b;this.b_canvas.height=a;this.b_ctx=this.b_canvas.getContext("2d");return this}});CG.Class.extend("Stick",{init:function(a){CG._extend(this,{active:false,identifier:-1,handle:CG.LEFT_HAND,atLimit:false,length:1,maxLength:0,limit:{x:0,Y:0},input:{x:0,Y:0},normal:{x:0,Y:0}});if(a){CG._extend(this,a)}return this},draw:function(){if(!this.active){return}Game.b_ctx.save();Game.b_ctx.globalAlpha=0.6;Game.b_ctx.beginPath();Game.b_ctx.strokeStyle="rgb(100,100,100)";Game.b_ctx.lineWidth=1;Game.b_ctx.arc(this.limit.x,this.limit.y,this.maxLength,0,(Math.PI*2),true);Game.b_ctx.stroke();Game.b_ctx.beginPath();Game.b_ctx.arc(this.limit.x,this.limit.y,this.maxLength,0,(Math.PI*2),true);Game.b_ctx.stroke();Game.b_ctx.beginPath();Game.b_ctx.arc(this.input.x,this.input.y,this.maxLength/1.5,0,(Math.PI*2),true);Game.b_ctx.fillStyle="rgb(200, 200, 200)";Game.b_ctx.fill();Game.b_ctx.restore()},update:function(){if(!this.active){return}var d=this.subtractVectors(this.input,this.limit);var b=this.getVectorLength(d);if(Math.round(b)>=this.maxLength){b=this.maxLength;var a=this.getRadians(d.x,d.y);this.atLimit=true;this.input=this.getVectorFromRadians(a,b);this.input.x+=this.limit.x;this.input.y+=this.limit.y}else{this.atLimit=false}this.length=b;this.normal=this.getVectorNormal(d)},getRadians:function(a,b){return Math.atan2(a,-b)},getVectorFromRadians:function(b,a){var a=(Number(a)||1);return{x:(Math.sin(b)*a),y:(-Math.cos(b)*a)}},getVectorLength:function(a){return Math.sqrt((a.x*a.x)+(a.y*a.y))},getVectorNormal:function(b){var a=this.getVectorLength(b);if(a===0){return b}else{return{x:(b.x*(1/a)),y:(b.y*(1/a))}}},setLimitXY:function(a,b){this.limit={x:a,y:b}},setInputXY:function(a,b){this.input={x:a,y:b}},subtractVectors:function(b,a){return{x:(b.x-a.x),y:(b.y-a.y)}}});CG.Stick.extend("GameController",{init:function(a){this._super(a);CG._extend(this,{buttons:[],visible:true});if(a){CG._extend(this,a)}this.addEventListener();return this},addEventListener:function(){Game.canvas.addEventListener("touchstart",function(a){a.preventDefault();var b=a.touches[0];if(this.identifier===-1){if(this.handle===CG.LEFT_HAND&&b.pageX<Game.width2){this.setLimitXY(b.pageX,b.pageY);this.setInputXY(b.pageX,b.pageY);this.active=true;this.identifier=b.identifier}else{if(this.handle===CG.RIGHT_HAND&&b.pageX>Game.width2){this.setLimitXY(b.pageX,b.pageY);this.setInputXY(b.pageX,b.pageY);this.active=true;this.identifier=b.identifier}}}if(a.touches.length>1&&this.active){var b=a.touches[1];CG.mousedown=true;CG.mouse={x:b.pageX,y:b.pageY}}}.bind(this));Game.canvas.addEventListener("touchmove",function(b){b.preventDefault();for(var a=0;a<b.touches.length;++a){var d=b.touches[a];if(d.identifier===this.identifier){this.setInputXY(d.pageX,d.pageY)}}}.bind(this));Game.canvas.addEventListener("touchend",function(b){for(var a=0;a<b.changedTouches.length;++a){var d=b.changedTouches[a];if(d.identifier===this.identifier){this.active=false;this.identifier=-1}}}.bind(this))},draw:function(){if(!this.active){return}this._super();for(var b=0,a=this.buttons.length;b<a;b++){this.buttons[b].draw()}},update:function(){if(!this.active){return}this._super();for(var b=0,a=this.buttons.length;b<a;b++){this.buttons[b].update()}}});CG.Entity.extend("Sprite",{init:function(a){this._super();this.instanceOf="Sprite";CG._extend(this,{bound:Game.bound,xspeed:0,yspeed:0,boundsMode:false,rotationspeed:0,alpha:1,followobject:false,followspeed:false,followsteps:false,attachedobject:false,offsetx:0,offsety:0});CG._extend(this,a);this.setImage(this.image);this.diffpoint=new CG.Point(this.bound.x,this.bound.y);return this},update:function(){this.ifClicked();this.ifMouseOver();this.ifAttached();if(this.followobject){this.follow()}this.position.x+=this.xspeed;this.position.y+=this.yspeed;this.rotation+=this.rotationspeed;this.xhandle=(this.width*this.xscale/2);this.yhandle=(this.height*this.yscale/2);if(this.boundsMode){this.checkBound()}this.updateDiff();this.updateMatrix()},draw:function(){Game.renderer.draw(this)},checkBound:function(){switch(this.boundsMode){case"bounce":if(this.position.x>(this.bound.width-this.xhandle+this.bound.x)){this.position.x=this.bound.width-this.xhandle+this.bound.x;this.xspeed=this.xspeed*-1}else{if(this.position.x<this.bound.x+this.xhandle){this.position.x=this.bound.x+this.xhandle;this.xspeed=this.xspeed*-1}}if(this.position.y>(this.bound.height-this.yhandle+this.bound.y)){this.position.y=this.bound.height-this.yhandle+this.bound.y;this.yspeed=this.yspeed*-1}else{if(this.position.y<this.bound.y+this.yhandle){this.position.y=this.bound.y+this.yhandle;this.yspeed=this.yspeed*-1}}break;case"slide":if(this.position.x>(this.bound.width+this.xhandle+this.bound.x)){this.position.x=(this.bound.x-this.xhandle)}else{if(this.position.x<this.bound.x-this.xhandle){this.position.x=this.bound.x+this.bound.width+this.xhandle}}if(this.position.y>(this.bound.height+this.yhandle+this.bound.y)){this.position.y=(this.bound.y-this.yhandle)}else{if(this.position.y<this.bound.y-this.yhandle){this.position.y=this.bound.height+this.yhandle+this.bound.y}}break;default:break}},updateDiff:function(){if(this.diffpoint.x!==this.bound.x){this.position.x+=this.bound.x-this.diffpoint.x}if(this.diffpoint.y!==this.bound.y){this.position.y+=this.bound.y-this.diffpoint.y}this.diffpoint.x=this.bound.x;this.diffpoint.y=this.bound.y},follow:function(){if(this.followspeed){angl=Math.atan2(this.followobject.position.x-this.position.x,this.followobject.position.y-this.position.y)*CG.Const_180_PI;xs=this.followspeed*Math.sin(angl*CG.Const_PI_180);ys=this.followspeed*Math.cos(angl*CG.Const_PI_180);this.xspeed=xs;this.yspeed=ys;this.rotation=angl*-1}else{if(this.followsteps){angl=Math.atan2(this.followobject.position.x-this.position.x,this.followobject.position.y-this.position.y)*CG.Const_180_PI;this.rotation=angl*-1;if(this.followobject.position.x!=this.position.x){distx=this.followobject.position.x-this.position.x;this.xspeed=distx/this.followsteps}else{this.xspeed=0}if(this.followobject.position.y!=this.position.y){disty=this.followobject.position.y-this.position.y;this.yspeed=disty/this.followsteps}else{this.yspeed=0}}}},setBound:function(a){this.bound=a;return this},ifAttached:function(){if(this.attachedobject!=false){this.attachedobject.position._x=this.attachedobject.position.x=(this.position.x+this.offsetx);this.attachedobject.position._y=this.attachedobject.position.y=(this.position.y+this.offsety)}},attachObject:function(a){this.attachedobject=a;return this},removeAttachedObject:function(){this.attachedobject=null;return this},setAttachedOffsetX:function(a){this.offsetx=a;return this},setAttachedOffsetY:function(a){this.offsety=a;return this}});CG.Entity.extend("SpineAnimation",{init:function(a){this._super();this.instanceOf="SpineAnimation";self=this;if(a){CG._extend(this,a)}this.lastTime=Date.now();this.skeletonposition=this.position||new CG.Point(0,0);this.xscale=1;this.yscale=1;this.scale=this.scale||1;this.vertices=[];this.textureCount=0;if(this.spineatlas.type=="text"){this.spineAtlasData=this.spineatlas.data;console.log("spine atlas: text (libGDX) used")}else{if(this.spineatlas.type=="json"){this.spineAtlasData=this.spineatlas.src;console.log("spine atlas: json");throw"json format is not supported by spine-js runtime?"}else{throw"check your atlas file format?"}}this.spineJsonData=this.spinejson.data;this.initCustom=this.callback;this.spineAtlas=new spine.Atlas(this.spineAtlasData,{load:function(b,e){this.textureCount++;var d=new Image();d.onload=function(){b.rendererObject=d;b.width=d.width;b.height=d.height;self.spineAtlas.updateUVs(b);this.textureCount--};d.onerror=function(){throw"error: atlas image not loaded! "+e};d.src="media/spine/"+e},unload:function(b){}});this.waitForTextures()},waitForTextures:function(){if(!this.textureCount){this.initSkeleton()}else{setTimeout(this.waitForTextures,100)}},initSkeleton:function(){this.skeletonJson=new spine.SkeletonJson(new spine.AtlasAttachmentLoader(self.spineAtlas));this.skeletonJson.scale=this.scale;if(typeof this.spineJsonData==="object"){this.skeletonData=this.skeletonJson.readSkeletonData(this.spineJsonData)}else{this.skeletonData=this.skeletonJson.readSkeletonData(JSON.parse(this.spineJsonData))}spine.Bone.yDown=true;this.skeleton=new spine.Skeleton(this.skeletonData);this.skeleton.getRootBone().x=this.skeletonposition.x||0;this.skeleton.getRootBone().y=this.skeletonposition.y||0;this.skeleton.updateWorldTransform();this.stateData=new spine.AnimationStateData(this.skeletonData);this.state=new spine.AnimationState(this.stateData);this.initCustom(this);this.state.onEvent=function(b,a){}},update:function(){var a=(Date.now()-this.lastTime)/1000;this.lastTime=Date.now();this.state.update(a);this.state.apply(this.skeleton);this.skeleton.updateWorldTransform()},draw:function(){var g=this.skeleton.drawOrder;for(var a=0,k=g.length;a<k;a++){var j=g[a];var f=j.attachment;var b=j.bone;if(!(f instanceof spine.RegionAttachment)){continue}f.computeVertices(this.skeleton.x,this.skeleton.y,j.bone,this.vertices);try{this.alpha=j.a;this.position=new CG.Point(this.vertices[2],this.vertices[3]);this.xscale=b.worldScaleX;this.yscale=b.worldScaleY;this.rotation=-(b.worldRotation+f.rotation);this.updateDiff();this.updateMatrix.call(this);this.xoffset=f.rendererObject.x;this.yoffset=f.rendererObject.y;this.cutwidth=f.width;this.cutheight=f.height;this.xhandle=this.cutwidth/2*this.xscale;this.yhandle=this.cutheight/2*this.yscale;this.xpos=0;this.ypos=0;if(this.skeleton.flipX){this.xscale*=-1;this.xpos=this.cutwidth;this.rotation*=-1}if(this.skeleton.flipY){this.yscale*=-1;this.ypos=this.cutheight;this.rotation*=-1}this.imagerotation=0;this.image=f.rendererObject.page.rendererObject;this.width=f.rendererObject.page.rendererObject.width;this.height=f.rendererObject.page.rendererObject.height;Game.renderer.draw(this)}catch(d){}}},updateDiff:function(){}});CG.Class.extend("AtlasImage",{init:function(a){CG._extend(this,{source:"",atlasimage:"",atlasname:"",image:"",xoffset:0,yoffset:0,width:0,height:0,rotation:0});if(a){CG._extend(this,a);this.name=this.image.split(/(\\|\/)/g).pop().split(".")[0]}}});CG.Class.extend("AtlasTexturePacker",{init:function(){if(typeof ejecta==="undefined"&&!navigator.isCocoonJS){this.xml="";this.xmlDoc="";this.parser=new DOMParser()||{}}this.imagename="";this.width=0;this.height=0;this.atlasimages=[];return this},loadXml:function(d){if(typeof d=="string"){this.xml=loadString(d)}else{this.xml=d.data}this.xmlDoc=this.parser.parseFromString(this.xml,"text/xml");this.imagename=this.xmlDoc.getElementsByTagName("TextureAtlas")[0].getAttribute("imagePath");this.width=parseInt(this.xmlDoc.getElementsByTagName("TextureAtlas")[0].getAttribute("width"));this.height=parseInt(this.xmlDoc.getElementsByTagName("TextureAtlas")[0].getAttribute("height"));var f=this.xmlDoc.getElementsByTagName("sprite");for(var b=0,a=f.length;b<a;b++){var e=new CG.atlasimage({image:f[b].getAttribute("n"),xoffset:parseInt(f[b].getAttribute("x")),yoffset:parseInt(f[b].getAttribute("y")),width:parseInt(f[b].getAttribute("w")),height:parseInt(f[b].getAttribute("h"))});if(f[b].getAttribute("r")=="y"){e.rotation=90;console.log("!!! support for rotated images in atlas files would be dropped in future versions !!!")}e.atlasimage=this.imagename;e.source="xml";e.atlasname=this.imagename.split(/(\\|\/)/g).pop().split(".")[0];this.atlasimages.push(e)}return this},loadJson:function(d){if(typeof d=="string"){this.json=JSON.parse(loadString(d))}else{this.json=d.data}this.imagename=this.json.meta.image;this.width=this.json.meta.size.w;this.height=this.json.meta.size.h;for(var b=0,a=this.json.frames.length;b<a;b++){var f=this.json.frames[b];var e=new CG.AtlasImage({image:f.filename,xoffset:f.frame.x,yoffset:f.frame.y,width:f.frame.w,height:f.frame.h});if(f.rotated===true){e.rotation=90;console.log("!!! support for rotated images in atlas files would be dropped in future versions !!!")}e.atlasimage=this.imagename;e.source="json";e.atlasname=this.imagename.split(/(\\|\/)/g).pop().split(".")[0];this.atlasimages.push(e)}return this},getAtlasImages:function(){return this.atlasimages}});CG.Sprite.extend("Animation",{init:function(a){this._super(a);this.instanceOf="Animation";CG._extend(this,{loop:true,status:0,currentFrame:0,frames:0,startFrame:1,endFrame:1,fx:0,fy:0,delay:0,tempdelay:0});if(a){CG._extend(this,a)}this.startFrame=this.startFrame-1;this.endFrame=this.endFrame-1;if(this.startFrame===undefined&&this.endFrame===undefined){this.frames=1;this.startFrame=0;this.endFrame=0}else{this.currentFrame=this.startFrame-1;this.frames=this.endFrame-this.startFrame+1}return this},update:function(){if(this.status==0){this.tempdelay+=1;if(this.tempdelay>=this.delay){this.tempdelay=0;if(this.frames>1){this.currentFrame+=1;if((this.currentFrame-this.startFrame)>=this.frames){if(this.loop===false){this.status=1}else{this.currentFrame=this.startFrame}}}}}this._super()},draw:function(){Game.renderer.draw(this)}});CG.Entity.extend("Bitmap",{init:function(a){this.instanceOf="Bitmap";CG._extend(this,{x:0,y:0,tolerance:128});if(a){CG._extend(this,a)}this.bitmap_canvas=document.createElement("canvas");this.bitmap_ctx=this.bitmap_canvas.getContext("2d");this.bitmap_ctx.fillStyle="#000000";this.bitmap_canvas.width=this.width;this.bitmap_canvas.height=this.height;return this},loadImage:function(a){this.setImage(a);this.drawImageToBuffer();return this},update:function(){},draw:function(){Game.renderer.draw(this)},clearBuffer:function(){this.bitmap_ctx.clearRect(0,0,this.bitmap_canvas.width,this.bitmap_canvas.height);return this},drawImageToBuffer:function(){if(this.image){this.bitmap_ctx.drawImage(this.image,0,0)}return this},clearRect:function(b,e,d,a){this.bitmap_ctx.save();this.bitmap_ctx.globalCompositeOperation="destination-out";this.bitmap_ctx.clearRect(b,e,d,a);this.bitmap_ctx.restore()},clearCircle:function(b,d,a){this.bitmap_ctx.save();this.bitmap_ctx.globalCompositeOperation="destination-out";this.bitmap_ctx.beginPath();this.bitmap_ctx.arc(b,d,a,0,2*Math.PI,false);this.bitmap_ctx.closePath();this.bitmap_ctx.fill();this.bitmap_ctx.restore()},getPixel:function(a,b){return this.bitmap_ctx.getImageData(a,b,1,1)},getPixels:function(b,e,d,a){return this.bitmap_ctx.getImageData(b,e,d,a)},getPixelAlpha:function(a,b){return this.bitmap_ctx.getImageData(a,b,1,1).data[3]},traceContour:function(){var d=this.getStartingPixel();var g=[];if(d){var f=d.x,e=d.y,n,m,k,j,b=false;while(!b){var a=this.getSquareValue(f,e);switch(a){case 1:case 5:case 13:n=0;m=-1;break;case 8:case 10:case 11:n=0;m=1;break;case 4:case 12:case 14:n=-1;m=0;break;case 2:case 3:case 7:n=1;m=0;break;case 6:if(k==0&&j==-1){n=-1;m=0}else{n=1;m=0}break;case 9:if(k==1&&j==0){n=0;m=-1}else{n=0;m=1}break}f+=n;e+=m;g.push({x:f,y:e});k=n;j=m;if(f==d.x&&e==d.y){b=true}}}return g},drawContour:function(a){this.bitmap_ctx.save();for(var b=0;b<a.length;b++){this.bitmap_ctx.fillStyle="#f00";this.bitmap_ctx.fillRect(a[b].x,a[b].y,1,1)}this.bitmap_ctx.restore()},lightenCountur:function(b,a){var a=a||1;return ClipperLib.JS.Lighten(b,a)[0]},triangulateContour:function(a){var b=new poly2tri.SweepContext(a,{cloneArrays:true});b.triangulate();return b.getTriangles()||[]},getStartingPixel:function(){for(var b=0;b<this.height;b++){for(var a=0;a<this.width;a++){if(this.getPixelAlpha(a,b)>=this.tolerance){return{x:a,y:b}}}}return false},getSquareValue:function(a,d){var b=0;if(this.getPixelAlpha(a-1,d-1)>=this.tolerance){b+=1}if(this.getPixelAlpha(a,d-1)>=this.tolerance){b+=2}if(this.getPixelAlpha(a-1,d)>=this.tolerance){b+=4}if(this.getPixelAlpha(a,d)>=this.tolerance){b+=8}return b}});CG.Sprite.extend("Button",{init:function(a){this._super();this.instanceOf="Button";if(a){CG._extend(this,a);this.setImage(this.image)}this.clickable=true;this.clicked=false;return this},update:function(){this.ifClicked();this.ifMouseOver();this.xhandle=(this.width*this.xscale/2);this.yhandle=(this.height*this.yscale/2);if(this.clicked){if(this.callbacks.clicked){this.clicked=false;this.callbacks.clicked.apply(this)}}if(this.hover){if(this.callbacks.hover){this.hover=false;this.callbacks.hover.apply(this)}}this.updateDiff();this.updateMatrix()},draw:function(){if(this.visible==true){Game.renderer.draw(this);if(this.text){this.font.drawText(this.text,this.position.x-(this.font.getTextWidth(this.text)/2>>0),this.position.y-((this.font.getFontSize()/2)>>0))}}}});CG.Class.extend("Menu",{init:function(a){CG._extend(this,{x:0,y:0,margin:0,step:0,buttons:[]});if(a){CG._extend(this,a);this.step=this.y}return this},addButton:function(a){this.buttons.push(a)},update:function(){this.buttons.forEach(function(a){a.update()})},draw:function(){this.buttons.forEach(function(a){a.position.x=this.x;a.position.y=this.step;a.draw();this.step+=a.height;this.step+=this.margin},this);this.step=this.y}});CG.Class.extend("MediaAsset",{init:function(a){this.obj=a;this.ready=false;this.progress=0;this.images=[];this.currimage=0;this.xmls=[];this.currxml=0;this.jsons=[];this.currjson=0;this.texts=[];this.currtext=0;this.fonts=[];this.currfont=0;this.assetcount=0;this.assetcurrent=0;this.width=300;this.height=20;this.radius=10;this.linewidth=8;this.bordercolor="white";this.progresscolor="red";this.shadowcolor="#222";this.shadowblur=6;this.shadowoffsetx=2;this.shadowoffsety=2},addImage:function(b,a){this.assetcount+=1;this.images.push({name:a||"",path:b,img:new Image(),type:"image"});return this},addFont:function(b,a){this.assetcount+=1;this.fonts.push({name:a||"",path:b,data:"",type:"font"});return this},addXml:function(b,a){this.assetcount+=1;this.xmls.push({name:a||"",path:b,data:"",type:"xml"});return this},addJson:function(b,a){this.assetcount+=1;this.jsons.push({name:a||"",path:b,data:"",src:"",type:"json"});return this},addText:function(b,a){this.assetcount+=1;this.texts.push({name:a||"",path:b,data:"",type:"text"});return this},getImageByName:function(b){for(var d=0,a=this.images.length;d<a;d++){if(this.images[d].name==b){if(this.images[d] instanceof CG.AtlasImage){return this.images[d]}else{return this.images[d].img}}}throw new MediaAssetException("No image with this name in asset.")},getImagesByName:function(b){var e=[];for(var d=0,a=this.images.length;d<a;d++){if(this.images[d].name==b){if(this.images[d] instanceof CG.AtlasImage){e.push(this.images[d])}else{e.push(this.images[d].img)}}}if(e.length===0){throw new MediaAssetException("No image with this name in asset: "+b)}return e},getFontByName:function(b){for(var d=0,a=this.fonts.length;d<a;d++){if(this.fonts[d].name==b){return this.fonts[d]}}throw new MediaAssetException("No font with this name in asset: "+b)},getXmlByName:function(b){for(var d=0,a=this.xmls.length;d<a;d++){if(this.xmls[d].name==b){return this.xmls[d]}}throw new MediaAssetException("No XML with this name in asset: "+b)},getJsonByName:function(b){for(var d=0,a=this.jsons.length;d<a;d++){if(this.jsons[d].name==b){return this.jsons[d]}}throw new MediaAssetException("No JSON with this name in asset: "+b)},getTextByName:function(b){for(var d=0,a=this.jsons.length;d<a;d++){if(this.texts[d].name==b){return this.texts[d]}}throw new MediaAssetException("No Text with this name in asset: "+b)},startPreLoad:function(){this.progress=100/this.assetcount*this.assetcurrent;this.progressScreen();if(this.currimage<this.images.length){this.images[this.currimage].img.onload=function(){console.log("image loaded: "+this.images[this.currimage].path);this.currimage+=1;this.assetcurrent+=1;this.startPreLoad()}.bind(this);this.images[this.currimage].img.onerror=function(){throw new MediaAssetException("error, cant load image: "+this.images[this.currimage].path)}.bind(this);this.images[this.currimage].img.src=this.images[this.currimage].path}else{if(this.currfont<this.fonts.length){this.fonts[this.currfont].data=loadString(this.fonts[this.currfont].path);console.log("font loaded: "+this.fonts[this.currfont].path);this.currfont+=1;this.assetcurrent+=1;this.startPreLoad()}else{if(this.currxml<this.xmls.length){this.xmls[this.currxml].data=loadString(this.xmls[this.currxml].path);console.log("xml loaded: "+this.xmls[this.currxml].path);this.currxml+=1;this.assetcurrent+=1;this.startPreLoad()}else{if(this.currjson<this.jsons.length){var a=loadString(this.jsons[this.currjson].path);this.jsons[this.currjson].data=JSON.parse(a);this.jsons[this.currjson].src=a;console.log("json loaded: "+this.jsons[this.currjson].path);this.currjson+=1;this.assetcurrent+=1;this.startPreLoad()}else{if(this.currtext<this.texts.length){this.texts[this.currtext].data=loadString(this.texts[this.currtext].path);console.log("text loaded: "+this.texts[this.currtext].path);this.currtext+=1;this.assetcurrent+=1;this.startPreLoad()}else{if(this.currimage==this.images.length&&this.assetcount==this.assetcurrent){this.ready=true;this.obj.create()}}}}}}},progressScreen:function(){var a=(this.obj.bound.width-this.width)/2;var b=(this.obj.bound.height-this.height)/2;this.obj.ctx.save();this.obj.ctx.fillStyle=this.progresscolor;this.obj.ctx.fillRect((this.obj.bound.width-this.width)/2,(this.obj.bound.height-this.height)/2,this.width/100*this.progress,this.height);this.obj.ctx.strokeStyle=this.bordercolor;this.obj.ctx.shadowColor=this.shadowcolor;this.obj.ctx.shadowBlur=this.shadowblur;this.obj.ctx.shadowOffsetX=this.shadowoffsetx;this.obj.ctx.shadowOffsetY=this.shadowoffsety;this.obj.ctx.beginPath();this.obj.ctx.moveTo(a+this.radius,b);this.obj.ctx.lineTo(a+this.width-(1*this.radius),b);this.obj.ctx.arcTo(a+this.width,b,a+this.width,b+this.radius,this.radius);this.obj.ctx.arcTo(a+this.width,this.radius*2+b,a+this.width-(1*this.radius),this.radius*2+b,this.radius);this.obj.ctx.lineTo(a+this.radius,2*this.radius+b);this.obj.ctx.arcTo(a,2*this.radius+b,a,b,this.radius);this.obj.ctx.arcTo(a,b,2*this.radius+a,b,this.radius);this.obj.ctx.lineWidth=this.linewidth;this.obj.ctx.stroke();this.obj.ctx.restore()}});function MediaAssetException(a){this.msg=a;console.log(this.msg)}CG.Entity.extend("Font",{init:function(a){this.instanceOf="Font";CG._extend(this,{atlas:new Image(),fontFile:"",chars:new Array(256),x:new Array(256),y:new Array(256),width:new Array(256),height:new Array(256),xoff:new Array(256),yoff:new Array(256),xadv:new Array(256),lineHeight:0,face:"",size:0,bold:0,italic:0,base:0,scaleW:0,scaleH:0,text:"",currentX:0,currentY:0});if(a){CG._extend(this,a)}return this},update:function(){throw {name:"Font Error",message:"TODO, not defined yet."}},draw:function(){throw {name:"Font Error",message:"TODO, not defined yet."}},drawText:function(b,a,d){this.text=b;this.currentX=a;this.currentY=d;Game.renderer.draw(this)},getLineHeight:function(){return this.lineHeight},getFontSize:function(){return this.size},getTextWidth:function(e){var b=0;var f=0;for(var d=0,a=e.length;d<a;d++){b+=this.xadv[e.charCodeAt(d)]}return b},loadFont:function(g){idnum=0;if(g){CG._extend(this,g)}if(typeof this.font=="string"){this.fontFile=loadString(this.font)}else{this.fontFile=this.font.data}var d=this.fontFile.split("\n");for(l in d){line=d[l].trim();if(line.startsWith("info")||line==""){var j=line.split(/([a-zA-Z]*=[" ,.\-_()0-9a-zA-Z]*(?= |\n))/);for(i in j){var F=j[i];if(F.startsWith("face=")){var v=F.split("=");this.face=v[1].split('"').join("")}if(F.startsWith("size=")){var A=F.split("=");this.size=parseInt(A[1])}if(F.startsWith("bold=")){var C=F.split("=");this.bold=parseInt(C[1])}if(F.startsWith("italic=")){var m=F.split("=");this.italic=parseInt(m[1])}}}if(line.startsWith("padding")){continue}if(line.startsWith("common")){var n=line.split(" ");for(c in n){var z=n[c];if(z.startsWith("lineHeight=")){var H=z.split("=");this.lineHeight=parseInt(H[1])}if(z.startsWith("base=")){var q=z.split("=");this.base=parseInt(q[1])}if(z.startsWith("scaleW=")){var G=z.split("=");this.scaleW=parseInt(G[1])}if(z.startsWith("scaleH=")){var k=z.split("=");this.scaleH=parseInt(k[1])}}}if(line.startsWith("page")){var e=line.split(" ");for(p in e){data=e[p];if(data.startsWith("file=")){var s=data.split("=");this.atlas.src="media/font/"+s[1].split('"').join("")}}}if(line.startsWith("chars")){continue}if(line.startsWith("char")){var y=line.split(" ");for(l in y){ld=y[l];if(ld.startsWith("id=")){var a=ld.split("=");idnum=parseInt(a[1])}if(ld.startsWith("x=")){var D=ld.split("=");this.x[idnum]=parseInt(D[1])}if(ld.startsWith("y=")){var f=ld.split("=");this.y[idnum]=parseInt(f[1])}if(ld.startsWith("width=")){var u=ld.split("=");this.width[idnum]=parseInt(u[1])}if(ld.startsWith("height=")){var r=ld.split("=");this.height[idnum]=parseInt(r[1])}if(ld.startsWith("xoffset=")){var b=ld.split("=");this.xoff[idnum]=parseInt(b[1])}if(ld.startsWith("yoffset=")){var B=ld.split("=");this.yoff[idnum]=parseInt(B[1])}if(ld.startsWith("xadvance=")){var E=ld.split("=");this.xadv[idnum]=parseInt(E[1])}}}}return this}});CG.Entity.extend("Text",{init:function(a){this.instanceOf="Text";CG._extend(this,{text:"",textcurrent:"",x:0,y:0,width:0,height:0,textAlign:"left"});if(a){CG._extend(this,a)}return this},initAsTextblock:function(a){return this},initAsScroller:function(){},initAsTicker:function(){},setText:function(a){this.text=a;return this},update:function(){},draw:function(){}});CG.Class.extend("Director",{init:function(){CG._extend(this,{screens:[],activescreen:0,nextscreen:0,duration:20,stepx:40,stepy:30,alpha:0,mode:"fade",direction:CG.RIGHT,color:"rgb(0,0,0)"});return this},update:function(){switch(this.mode){case"scale":if(this.nextscreen!=this.activescreen){this.screens[this.activescreen].xscale-=0.4/this.duration;this.screens[this.activescreen].yscale-=0.4/this.duration}else{if(this.nextscreen==this.activescreen){this.screens[this.activescreen].xscale+=0.4/this.duration;this.screens[this.activescreen].yscale+=0.4/this.duration}}if(this.screens[this.activescreen].xscale>=1){this.screens[this.activescreen].xscale=this.screens[this.activescreen].yscale=1;this.screens[this.nextscreen].xscale=this.screens[this.nextscreen].yscale=1}if(this.screens[this.activescreen].xscale<=0){this.screens[this.activescreen].xscale=this.screens[this.activescreen].yscale=1;this.screens[this.nextscreen].xscale=this.screens[this.nextscreen].yscale=0;this.activescreen=this.nextscreen}break;case"fade":if(this.nextscreen!=this.activescreen&&this.alpha<1){this.alpha+=1/this.duration}else{if(this.nextscreen==this.activescreen&&this.alpha!=0){this.alpha-=1/this.duration}}if(this.alpha>=1){this.activescreen=this.nextscreen;this.alpha=1}if(this.alpha<0){this.alpha=0}break;case"slide":if(this.nextscreen!=this.activescreen){switch(this.direction){case CG.UP:this.screens[this.activescreen].position.y-=this.stepy;this.screens[this.nextscreen].position.y-=this.stepy;if(this.screens[this.nextscreen].position.y<0){this.resetScreens();this.activescreen=this.nextscreen}break;case CG.DOWN:this.screens[this.activescreen].position.y+=this.stepy;this.screens[this.nextscreen].position.y+=this.stepy;if(this.screens[this.nextscreen].position.y>0){this.resetScreens();this.activescreen=this.nextscreen}break;case CG.LEFT:this.screens[this.activescreen].position.x-=this.stepx;this.screens[this.nextscreen].position.x-=this.stepx;if(this.screens[this.nextscreen].position.x<0){this.resetScreens();this.activescreen=this.nextscreen}break;case CG.RIGHT:this.screens[this.activescreen].position.x+=this.stepx;this.screens[this.nextscreen].position.x+=this.stepx;if(this.screens[this.nextscreen].position.x>0){this.resetScreens();this.activescreen=this.nextscreen}break}}break}this.screens[this.activescreen].update()},draw:function(){this.screens[this.activescreen].draw();if(this.nextscreen!=this.activescreen){if(this.screens[this.nextscreen].position.x!=0||this.screens[this.nextscreen].position.y!=0){this.screens[this.nextscreen].draw()}}if(this.alpha>0){Game.b_ctx.save();Game.b_ctx.globalAlpha=this.alpha;Game.b_ctx.fillStyle=this.color;Game.b_ctx.fillRect(0,0,Game.bound.width,Game.bound.height);Game.b_ctx.restore()}},nextScreen:function(a,e,d){var b=this.getIndexOfScreen(a);if(b!=this.activescreen){this.resetScreens();this.mode=e;this.duration=d;this.stepx=Game.canvas.width/this.duration>>0;this.stepy=Game.canvas.height/this.duration>>0;this.nextscreen=b;if(this.mode==="scale"){this.alpha=0}else{if(this.mode==="fade"){}else{if(this.mode==="slide"){switch(this.direction){case CG.UP:this.screens[this.nextscreen].position.y+=CG.canvas.height;break;case CG.DOWN:this.screens[this.nextscreen].position.y-=CG.canvas.height;break;case CG.LEFT:this.screens[this.nextscreen].position.x+=CG.canvas.width;break;case CG.RIGHT:default:this.screens[this.nextscreen].position.x-=CG.canvas.width;break}}}}}return this},resetScreens:function(){this.screens[this.activescreen].position=new CG.Point(0,0);this.screens[this.nextscreen].position=new CG.Point(0,0);return this},addScreen:function(a){this.screens.push(a);return this},getScreenByName:function(d){for(var b=0,a=this.screens.length;b<a;b++){if(this.screens[b].name==d){return this.screens[b]}}return false},getIndexOfScreen:function(d){for(var b=0,a=this.screens.length;b<a;b++){if(this.screens[b].name==d){return b}}return false},getActiveScreenName:function(){return this.screens[this.activescreen].name},setDirection:function(a){this.direction=a;return this}});CG.Class.extend("Screen",{init:function(a){CG._extend(this,{name:"",position:new CG.Point(0,0),xscale:1,yscale:1,layers:[]});if(a){CG._extend(this,a)}return this},create:function(){},update:function(){for(var b=0,a=this.layers.length;b<a;b++){this.layers[b].update()}},draw:function(){Game.b_ctx.save();for(var b=0,a=this.layers.length;b<a;b++){if(this.xscale!==1||this.yscale!==1){Game.b_ctx.translate((Game.width-(Game.width*this.xscale))/2,(Game.height-(Game.height*this.yscale))/2);Game.b_ctx.scale(this.xscale,this.yscale);this.layers[b].draw()}else{if(this.layers[b].fixedPosition){Game.b_ctx.translate(0,0)}else{Game.b_ctx.translate(this.position.x,this.position.y)}this.layers[b].draw()}}Game.b_ctx.restore()},addLayer:function(a){this.layers.push(a);return this},getLayerByName:function(d){for(var b=0,a=this.layers.length;b<a;b++){if(this.layers[b].name==d){return this.layers[b]}}return false}});CG.Class.extend("Layer",{init:function(a){CG._extend(this,{name:"",visible:true,fixedPosition:false,elements:[],elementsToDelete:[]});if(a){CG._extend(this,a)}return this},update:function(){if(this.visible==true){for(var b=0,a=this.elements.length;b<a;b++){this.elements[b].update();if(this.elements[b].status==1){this.elementsToDelete.push(this.elements[b])}}if(this.elementsToDelete.length>0){this._deleteElements()}}},draw:function(){if(this.visible==true){for(var b=0,a=this.elements.length;b<a;b++){this.elements[b].draw()}}},_deleteElements:function(){this.elementsToDelete.reverse();this.elementsToDelete.forEach(this._deleteElement,this);this.elementsToDelete=[]},_deleteElement:function(a){this.elements.splice(a,1)},addElement:function(a){this.elements.push(a);return this},getElementByName:function(b){for(var d=0,a=this.elements.length;d<a;d++){if(this.elements[d].name==b){return this.elements[d]}}return false},getElementsByName:function(b){elements=[];for(var d=0,a=this.elements.length;d<a;d++){if(this.elements[d].name==b){elements.push(this.elements[d])}}return elements}});CG.Class.extend("MapTileLayer",{init:function(){this.width=0;this.height=0;this.visible=true;this.opacity=1;this.tiles=[];return this}});CG.Class.extend("MapTileProperties",{init:function(){this.animated=false;this.animDelay=0;this.animDirection=0;this.animNext=0;this.delayTimer=0;return this}});CG.Class.extend("MapPoint",{init:function(a){CG._extend(this,{gid:0,name:"",initPosition:new CG.Point(0,0),position:new CG.Point(0,0)});CG._extend(this,a);this.initPosition=this.position;return this},update:function(a){this.position.x=this.initPosition.x-a.x;this.position.y=this.initPosition.y-a.y}});CG.Class.extend("MapArea",{init:function(a){CG._extend(this,{initBound:new CG.Bound({x:0,y:0,width:0,height:0}),name:"",type:false,bound:new CG.Bound({x:0,y:0,width:0,height:0})});CG._extend(this,a);this.initBound=this.bound;return this},update:function(a){this.bound.x=this.initBound.x-a.x;this.bound.y=this.initBound.y-a.y}});CG.Entity.extend("Map",{init:function(a){this._super();this.instanceOf="Map";this.elements=[];this.points=[];this.areas=[];this.position=new CG.Point(0,0);this.mapOffset=new CG.Point(0,0);this.changemap="";this.animated=false;this.animDelayFactor=20;this.atlas=new Image();this.atlaswidth=0;this.atlasheight=0;this.atlastranscol="";if(typeof ejecta==="undefined"&&!navigator.isCocoonJS){this.xml="";this.parser=new DOMParser();this.xmlDoc=""}this.json={};this.layers=[];this.renderlayer="all";this.tileproperties=[];this.orientation="";this.width=0;this.height=0;this.mapColumns=0;this.mapRows=0;this.tilewidth=0;this.tileheight=0;this.tileset={tilewidth:0,tileheight:0,offsetx:0,offsety:0,spacing:0,margin:0};this.xspeed=0;this.yspeed=0;this.xscale=1;this.yscale=1;this.alpha=1;this.wrapX=false;this.wrapY=false;this.layertocheck=0;CG._extend(this,a);return this},loadMapXml:function(e){this.changemap="";this.animated=false;this.layers=[];if(typeof e=="string"){this.xml=loadString(e)}else{this.xml=e.data}this.removeJsonData();this.xmlDoc=this.parser.parseFromString(this.xml,"text/xml");var C=map.xmlDoc.getElementsByTagName("map")[0];this.orientation=C.getAttribute("orientation");this.mapColumns=parseInt(C.getAttribute("width"));this.mapRows=parseInt(C.getAttribute("height"));this.tilewidth=parseInt(C.getAttribute("tilewidth"));this.tileheight=parseInt(C.getAttribute("tileheight"));var m=C.childElementCount;var d=C.firstElementChild;for(var y=0;y<m;y++){console.log(">"+d.nodeName);switch(d.nodeName){case"tileset":this.tileset.tilewidth=parseInt(d.getAttribute("tilewidth"));this.tileset.tileheight=parseInt(d.getAttribute("tileheight"));if(d.getAttribute("spacing")){this.tileset.spacing=parseInt(d.getAttribute("spacing"))}if(d.getAttribute("margin")){this.tileset.margin=parseInt(d.getAttribute("margin"))}if(d.getElementsByTagName("tileoffset")[0]){this.tileset.offsetx=parseInt(d.getElementsByTagName("tileoffset")[0].getAttribute("x"));this.tileset.offsety=parseInt(d.getElementsByTagName("tileoffset")[0].getAttribute("y"))}var n=d.getElementsByTagName("image")[0];this.atlas.src="media/map/"+n.getAttribute("source");this.atlaswidth=parseInt(n.getAttribute("width"));this.atlasheight=parseInt(n.getAttribute("height"));this.atlastranscol=n.getAttribute("trans");break;case"layer":var f=new CG.MapTileLayer();data=d.getElementsByTagName("data")[0];if(data.getAttribute("encoding")=="csv"){f.tiles=data.textContent.replace(/(\r\n|\n|\r)/gm,"").split(",");console.log("map encoding csv [layer "+y+"]")}else{if(data.getAttribute("encoding")=="base64"&&data.getAttribute("compression")=="gzip"){throw"base64 gzip compressed map format not supported at the moment"}else{if(data.getAttribute("encoding")=="base64"&&data.getAttribute("compression")=="zlib"){throw"base64 zlib compressed map format not supported at the moment"}else{if(data.getAttribute("encoding")=="base64"){throw"base64 map format not supported at the moment"}else{console.log("map encoding xml [layer "+y+"]");var A=d.getElementsByTagName("tile");for(x in A){if(x<A.length){f.tiles[x]=parseInt(A[x].getAttribute("gid"))}}}}}}f.name=d.getAttribute("name");f.width=parseInt(d.getAttribute("width"));f.height=parseInt(d.getAttribute("height"));if(d.getAttribute("opacity")){f.opacity=parseFloat(d.getAttribute("opacity"))}if(d.getAttribute("visible")==="0"){f.visible=false}this.layers.push(f);break;case"objectgroup":console.log("grouplayer found");var a=d.getElementsByTagName("object");for(o in a){if(o<a.length){var k=a[o];var D=k.getAttribute("name");if(k.getAttribute("gid")){this.points.push(new CG.MapPoint({position:new CG.Point(parseInt(k.getAttribute("x")),parseInt(k.getAttribute("y"))),mapOffset:this.position,name:k.getAttribute("name"),gid:parseInt(k.getAttribute("gid"))}));console.log("tile as oject found: "+D);console.log(k)}else{if(k.getAttribute("width")){type=false;j=k.getElementsByTagName("property");console.log(j.length);for(var q=0,u=j.length;q<u;q++){if(j[q].getAttribute("name")=="type"){type=j[q].getAttribute("value")}}this.areas.push(new CG.MapArea({bound:new CG.Bound({x:parseInt(k.getAttribute("x")),y:parseInt(k.getAttribute("y")),width:parseInt(k.getAttribute("width")),height:parseInt(k.getAttribute("height"))}),mapOffset:this.position,name:k.getAttribute("name"),type:type}));console.log("group object found: "+D);console.log(k)}else{if(k.getElementsByTagName("polygon").length>0){console.log("polygon found: "+D)}else{if(k.getElementsByTagName("polyline").length>0){console.log("polyline found: "+D)}}}}}}break}d=d.nextElementSibling}this.tileproperties=Array(parseInt((this.atlaswidth/this.tilewidth))*parseInt((this.atlasheight/this.tileheight)));var A=map.xmlDoc.getElementsByTagName("tileset")[0].getElementsByTagName("tile");var g=new Date().getTime();for(y in A){var v=new CG.MapTileProperties();var B=A[y];if(y<this.tileproperties.length){var r=B.getAttribute("id");var j=B.getElementsByTagName("properties")[0].getElementsByTagName("property");for(q in j){if(q<j.length){var b=j[q];var z=b.getAttribute("name");var s=b.getAttribute("value");if(z=="name"){v.name=s}else{if(z=="anim_delay"){v.animDelay=parseInt(s);v.delayTimer=g;this.animated=true}else{if(z=="anim_direction"){v.animDirection=parseInt(s)}else{if(z=="anim_next"){v.animNext=parseInt(s);v.animated=true}}}}}}this.tileproperties[r]=v}}return this},loadMapJson:function(b){this.changemap="";this.animated=false;this.layers=[];if(typeof b=="string"){this.json=JSON.parse(loadString(b))}else{this.json=b.data}this.removeXmlData();this.orientation=this.json.orientation;this.mapColumns=this.json.width;this.mapRows=this.json.height;this.tilewidth=this.json.tilewidth;this.tileheight=this.json.tileheight;for(i=0,l=this.json.layers.length;i<l;i++){switch(this.json.layers[i].type){case"tilelayer":var k=new CG.MapTileLayer();k.tiles=this.json.layers[i].data;k.name=this.json.layers[i].name;k.width=this.json.layers[i].width;k.height=this.json.layers[i].height;k.opacity=this.json.layers[i].opacity;k.visible=this.json.layers[i].visible;this.layers.push(k);break;case"objectgroup":console.log("grouplayer found");var j=this.json.layers[i].objects;for(o in j){if(o<j.length){var e=j[o];var a=e.name;if(e.gid){this.points.push(new CG.MapPoint({position:new CG.Point(parseInt(e.x),parseInt(e.y)),mapOffset:this.position,name:e.name,gid:parseInt(e.gid)}));console.log("tile as oject found: "+a);console.log(e)}else{if(e.width){this.areas.push(new CG.MapArea({bound:new CG.Bound({x:parseInt(e.x),y:parseInt(e.y),width:parseInt(e.width),height:parseInt(e.height)}),mapOffset:this.position,name:e.name,type:e.properties.type}));console.log("group object found: "+a);console.log(e)}else{if(e.polygon){console.log("polygon found: "+a)}else{if(e.polyline){console.log("polyline found: "+a)}}}}}}break}}this.atlas.src="media/map/"+this.json.tilesets[0].image;this.atlaswidth=this.json.tilesets[0].imagewidth;this.atlasheight=this.json.tilesets[0].imageheight;this.atlastranscol=this.json.tilesets[0].transparentcolor;this.tileproperties=Array(parseInt((this.atlaswidth/this.tilewidth))*parseInt((this.atlasheight/this.tileheight)));var g=this.json.tilesets[0].tileproperties;var d=new Date().getTime();for(id in g){var m=new CG.MapTileProperties();var f=g[id];m.name=f.name;m.animDelay=parseInt(f.anim_delay);m.delayTimer=(m.animDelay>0)?d:0;m.animated=(m.animDelay>0)?true:false;m.animNext=parseInt(f.anim_next);if(m.animDelay>0){this.animated=true}m.animDirection=parseInt(f.anim_direction);this.tileproperties[id]=m}return this},drawMap:function(C,A,G,F,H,g,n){this.bx=G;this.by=F;this.bw=H;this.bh=g;this.sx=C;this.sy=A;this.callback=n||false;this.rx=0;this.ry=0;this.cx=0;this.cy=0;this.xpos=0;this.ypos=0;this.layer=0;this.updatePointsAndAreas();if(this.changemap!=""){this.loadMap(this.changemap)}if(this.visible){this.updateAnimation();if(this.layers.length>0){for(var I=0,E=this.layers.length;I<E;I++){var j=this.layers[I];if(this.renderlayer===j.name||this.renderlayer===I||this.renderlayer==="all"){if(this.orientation=="orthogonal"&&j.visible==true){var d=(this.bx*this.xscale)%this.tilewidth,b=(this.by*this.yscale)%this.tileheight,r=this.by,v=Math.floor(this.by/this.tileheight),e=(this.by+this.bh+this.tileheight);while(r<e){var s=this.bx,z=Math.floor(this.bx/this.tilewidth),f=(this.bx+this.bw+this.tilewidth);while(s<f){if((this.wrapX||(z>=0&&z<this.width))&&(this.wrapY||(v>=0&&v<this.height))){var a=z,q=v;while(a<0){a+=this.width}while(a>=this.width){a-=this.width}while(q<0){q+=this.height}while(q>=this.height){q-=this.height}B=j.tiles[a+q*j.width]-1;if(B>=0){if(d<0){d+=this.tilewidth}if(b<0){b+=this.tileheight}this.rx=s-d-this.bx;this.ry=r-b-this.by;if(this.elements.length>0&&this.layertocheck==E){for(var D=0,E=this.elements.length;D<E;D++){if(this.checkMapCollision(this.elements[0],this.rx,this.ry)){this.callback(this.elements[D],this.tileproperties[B])}}}this.cx=(B%(this.atlaswidth/this.tilewidth))*this.tilewidth;this.cy=Math.floor(this.tilewidth*B/this.atlaswidth)*this.tileheight;Game.renderer.draw(this)}}s=s+this.tilewidth;z+=1}r=r+this.tileheight;v+=1}}else{if(this.orientation=="isometric"){var u=j.width+j.height;for(var r=0;r<u;r++){var k=r,m=0;while(k>=j.height){k-=1;m+=1}while(k>=0&&m<j.width){var B=j.tiles[m+k*j.width];this.rx=(m-k-1)*this.tilewidth/2-G;this.ry=(m+k+1)*this.tileheight/2-F;if(this.rx>-this.tileset.tilewidth&&this.rx<H&&this.ry>-this.tileset.tileheight&&this.ry<g){if(B>0){this.cx=((B-1)%(this.atlaswidth/this.tilewidth))*this.tilewidth;this.cy=Math.floor(this.tilewidth*(B-1)/this.atlaswidth)*this.tileset.tileheight;Game.renderer.draw(this)}}k-=1;m+=1}}}}}}}}},updatePointsAndAreas:function(){this.points.forEach(function(a,b){a.update(this.mapOffset)},this);this.areas.forEach(function(b,a){b.update(this.mapOffset)},this)},getPointsByName:function(b){points=[];for(var d=0,a=this.points.length;d<a;d++){if(this.points[d].name===b){points.push(this.points[d])}}if(points.length>0){return points}return false},getAreasByName:function(b){areas=[];for(var d=0,a=this.areas.length;d<a;d++){if(this.areas[d].name===b){areas.push(this.areas[d])}}if(areas.length>0){return areas}return false},setLayerToRender:function(a){this.renderlayer=a;return this},update:function(){},draw:function(){this.drawMap(this.position.x,this.position.y,this.mapOffset.x,this.mapOffset.y,this.width,this.height,this.callback);return this},getBounds:function(){return{width:this.width*this.tilewidth,height:this.height*this.tileheight}},updateAnimation:function(){if(this.visible&&this.animated){if(this.layers.length>0){for(var d=0,a=this.layers.length;d<a;d++){var j=new Date().getTime();for(t=0;t<this.layers[d].tiles.length;t++){var f=this.layers[d].tiles[t];if(f>0){try{var b=this.tileproperties[f-1];if(b.animated&&b.animDirection!=0){if(j>(b.delayTimer+(b.animDelay/this.animDelayFactor))){switch(b.animDirection){case 1:this.layers[d].tiles[t]+=b.animNext;this.tileproperties[f-1+b.animNext].delayTimer=j;break;case -1:this.layers[d].tiles[t]-=b.animNext;this.tileproperties[f-1-b.animNext].delayTimer=j;break;default:break}}}}catch(g){}}}}}}},addElement:function(a){this.elements.push(a);return this},checkMapCollision:function(b,g,f){if(b.boundingradius>0){var a=b.boundingradius/2*b.xscale;var e=b.boundingradius/2*b.yscale;if(b.position.x+a>=g&&b.position.x-a<=g+this.tilewidth&&b.position.y+e>=f&&b.position.y-e<=f+this.tileheight){return true}}else{var j=b.width/2*b.xscale;var d=b.height/2*b.yscale;if(b.position.x+j>=g&&b.position.x-j<=g+this.tilewidth&&b.position.y+d>=f&&b.position.y-d<=f+this.tileheight){return true}}return false},checkElementsToAreasCollision:function(e,d){for(var b=0,a=e.length;b<a;b++){obj=e[b].checkCollision(this.areas,d)}return this},removeJsonData:function(){this.json={};return this},removeXmlData:function(){this.xml="";this.xmlDoc="";return this}});CG.Class.extend("Sequence",{init:function(a){CG._extend(this,{current:0,loop:false,translations:[]});if(a){CG._extend(this,a)}return this},addTranslation:function(a){this.translations.push(a);return this},update:function(a){if(this.current<this.translations.length){if(this.translations[this.current].finished===false){this.translations[this.current].update()}else{this.current+=1}}else{if(this.loop){this.reset()}else{}}},draw:function(){},reset:function(){for(var b=0,a=this.translations.length;b<a;b++){this.translations[b].reset()}this.current=0;return this}});CG.Class.extend("Translate",{init:function(a){CG._extend(this,{type:"",tx:0,ty:0,x1:0,y1:0,x2:0,y2:0,bx:0,by:0,object:{},r1:0,r2:0,startangle:0,angle:0,speed:0,steps:0,step:0,positions:[],finished:false});if(a){CG._extend(this,a)}return this},initTween:function(e){this.type="tween";if(e){CG._extend(this,e)}this.x1=this.startPoint.x;this.y1=this.startPoint.y;this.x2=this.endPoint.x;this.y2=this.endPoint.y;var b=(this.x2-this.x1)/this.steps;var g=(this.y2-this.y1)/this.steps;var d=this.x1>>0;var a=this.y1>>0;for(var f=0;f<=this.steps;f++){this.positions.push(new CG.Point(d,a));d+=b;a+=g}return this},initOval:function(a){this.type="oval";if(a){CG._extend(this,a)}this.x1=this.centerPoint.x;this.y1=this.centerPoint.y;this.r1=this.radius1;this.r2=this.radius2;this.speed=this.rotation;return this},initBezier:function(a){this.type="bezier";if(a){CG._extend(this,a)}this.start=this.endPoint;this.end=this.startPoint;if(this.control2=="undefined"&&this.control1=="undefined"){this.control2=new CG.Point(this.start.x+3*(this.end.x-this.start.x)/4,this.start.y+3*(this.end.y-this.start.y)/4)}else{this.control2=this.control2||this.control1}this.control1=this.control1||new CG.Point(this.start.x+(this.end.x-this.start.x)/4,this.start.y+(this.end.y-this.start.y)/4);b1=function(e){return(e*e*e)};b2=function(e){return(3*e*e*(1-e))};b3=function(e){return(3*e*(1-e)*(1-e))};b4=function(e){return((1-e)*(1-e)*(1-e))};for(var b=0;b<=this.steps;b++){percent=(1/this.steps)*b;var d=new CG.Point();d.x=this.start.x*b1(percent)+this.control1.x*b2(percent)+this.control2.x*b3(percent)+this.end.x*b4(percent);d.y=this.start.y*b1(percent)+this.control1.y*b2(percent)+this.control2.y*b3(percent)+this.end.y*b4(percent);this.positions.push(d)}return this},update:function(){var b=this.object;switch(this.type){case"bezier":case"tween":if(this.step<this.steps){b.position.x=b.position._x=this.positions[this.step].x;b.position.y=b.position._y=this.positions[this.step].y;this.step+=1}else{this.finished=true}break;case"oval":var a=this.startangle*CG.Const_PI_180;this.tx=this.x1-(this.r1*Math.cos(a));this.ty=this.y1-(this.r2*Math.sin(a));this.startangle+=this.speed;if(this.startangle>360){this.startangle=0+(this.startangle-360)}b.position.x=b.position._x=this.tx>>0;b.position.y=b.position._y=this.ty>>0;break;default:break}},draw:function(){},reset:function(){this.step=0;this.finished=false}});CG.Class.extend("Morph",{init:function(a){CG._extend(this,{mode:"",min:0,max:0,speed:0,angle:0,rad:0,_val:0});if(a){CG._extend(this,a);this.rad=this.max-this.min}return this},update:function(){switch(this.mode){case"sinus":var a=this.angle*CG.Const_PI_180;this._val=this.rad*Math.sin(a);if(this._val<0){this._val=this._val*-1}this.angle+=this.speed;if(this.angle>360){this.angle=0+(this.angle-360)}break}return this},draw:function(){},getVal:function(){return this._val}});CG.Sprite.extend("Particle",{init:function(a){this._super();this.instanceOf="Particle";CG._extend(this,{position:new CG.Point(0,0),lifetime:100,currtime:this.lifetime,aging:1,fadeout:false,gravity:0});if(a){CG._extend(this,a);this.setImage(this.image)}},update:function(){if(this.visible){if(this.fadeout){this.alpha=this.currtime/this.lifetime;if(this.alpha<=0){this.visible=false}}this.currtime-=this.aging;if(this.currtime<0){this.visible=false}this.position.x+=this.xspeed;this.position.y+=this.yspeed;this.yspeed+=this.gravity;this.rotation+=this.rotationspeed;this.xhandle=(this.width*this.xscale/2);this.yhandle=(this.height*this.yscale/2);this.updateDiff();this.updateMatrix()}},draw:function(){if(this.visible){Game.renderer.draw(this)}}});CG.Entity.extend("Emitter",{init:function(a){this._super();CG._extend(this,{particles:[],maxparticles:50,creationtime:100,currenttime:0,creationspeed:50,gravity:0.05,image:null,type:"",position:{x:0,y:0,_x:0,_y:0},rotation:0,width:200,height:200,radius:0,pspeed:10,protation:0,pdirection:0,plifetime:100,paging:1,pfadeout:false});if(a){CG._extend(this,a);this.position._x=this.position.x;this.position._y=this.position.y}return this},initAsPoint:function(a){this.image=a;this.type="point";return this},initAsExplosion:function(d,b,a){this.image=d;this.type="explosion";this.min=b;this.max=a;return this},initAsCorona:function(b,a){this.image=b;this.type="corona";this.radius=a||0;return this},initAsLine:function(d,a,b){this.image=d;this.width=a||200;this.pdirection=b||CG.UP;this.type="line";return this},initAsRectangle:function(d,b,a){this.image=d;this.width=b||200;this.height=a||200;this.type="rectangle";return this},createParticle:function(){particle=new CG.Particle({image:this.image});return particle},initParticle:function(b){if(this.pfadeout){b.fadeout=true}b.gravity=this.gravity;b.alpha=1;b.visible=true;b.lifetime=this.plifetime;b.currtime=this.plifetime;b.rotationspeed=this.protation;switch(this.type){case"corona":var a=this.getRandom(0,359)*CG.Const_PI_180;b.position.x=this.getX()-(this.radius*Math.cos(a));b.position.y=this.getY()-(this.radius*Math.sin(a));angl=Math.atan2(b.position.x-this.getX(),b.position.y-this.getY())*CG.Const_180_PI;b.xspeed=this.pspeed*Math.sin(angl*CG.Const_PI_180);b.yspeed=this.pspeed*Math.cos(angl*CG.Const_PI_180);break;case"rectangle":rndx=this.getRandom(this.width/2*-1,this.width/2);rndy=this.getRandom(this.height/2*-1,this.height/2);b.position.x=this.position._x-rndx;b.position.y=this.position._y-rndy;b.xspeed=0;b.yspeed=0;break;case"line":rnd=this.getRandom(this.width/2*-1,this.width/2);switch(this.pdirection){default:case CG.UP:b.xspeed=0;b.yspeed=this.pspeed*-1;b.position.x=rnd+this.getX();b.position.y=this.position._y;break;case CG.DOWN:b.xspeed=0;b.yspeed=this.pspeed;b.position.x=rnd+this.getX();b.position.y=this.position._y;break;case CG.LEFT:b.xspeed=this.pspeed*-1;b.yspeed=0;b.position.x=this.position._x;b.position.y=rnd+this.getY();break;case CG.RIGHT:b.xspeed=this.pspeed;b.yspeed=0;b.position.x=this.position._x;b.position.y=rnd+this.getY();break}break;case"explosion":b.position.x=this.position._x;b.position.y=this.position._y;b.xspeed=this.getRandom(this.min,this.max);b.yspeed=this.getRandom(this.min,this.max);break;case"point":default:b.xspeed=0;b.yspeed=0;b.position.x=this.position._x;b.position.y=this.position._y;break}return b},update:function(){if(this.visible){this.currenttime+=this.creationspeed;if(this.currenttime>=this.creationtime){this.currenttime=0;if(this.particles.length<this.maxparticles){this.particles.push(this.initParticle(this.createParticle()))}else{particle=this.searchInvisibleParticle();this.initParticle(particle);this.particles.sort(function(e,d){return e.currtime-d.currtime})}}for(var b=0,a=this.particles.length;b<a;b++){this.particles[b].update()}return this}},draw:function(){if(this.visible){for(var b=0,a=this.particles.length;b<a;b++){this.particles[b].draw()}return this}},searchInvisibleParticle:function(){for(var b=0,a=this.particles.length;b<a;b++){if(this.particles[b].visible==false){return this.particles[b]}}return this},setEmitterPosition:function(a){this.position=a;return this},setName:function(a){this.name=a;return this},setCreationTime:function(a){this.creationtime=a;return this},setMaxParticles:function(a){this.maxparticles=a;return this},setGravity:function(a){this.gravity=a;return this},setParticleSpeed:function(a){this.pspeed=a;return this},setProtation:function(a){this.protation=a;return this},setPLifetime:function(a){this.plifetime=a;return this},activateFadeout:function(){this.pfadeout=true;return this},deactivateFadeout:function(){this.pfadeout=false;return this},getRandom:function(b,a){return Math.random()*(a-b+1)+b>>0},getX:function(){return this.position._x},getY:function(){return this.position._y}});var COMPILED=!0,goog=goog||{};goog.global=this;goog.isDef=function(b){return void 0!==b};goog.exportPath_=function(f,e,j){f=f.split(".");j=j||goog.global;f[0] in j||!j.execScript||j.execScript("var "+f[0]);for(var g;f.length&&(g=f.shift());){!f.length&&goog.isDef(e)?j[g]=e:j=j[g]?j[g]:j[g]={}}};goog.define=function(e,d){var f=d;COMPILED||(goog.global.CLOSURE_UNCOMPILED_DEFINES&&Object.prototype.hasOwnProperty.call(goog.global.CLOSURE_UNCOMPILED_DEFINES,e)?f=goog.global.CLOSURE_UNCOMPILED_DEFINES[e]:goog.global.CLOSURE_DEFINES&&Object.prototype.hasOwnProperty.call(goog.global.CLOSURE_DEFINES,e)&&(f=goog.global.CLOSURE_DEFINES[e]));goog.exportPath_(e,f)};goog.DEBUG=!1;goog.LOCALE="en";goog.TRUSTED_SITE=!0;goog.STRICT_MODE_COMPATIBLE=!1;goog.provide=function(b){if(!COMPILED&&goog.isProvided_(b)){throw Error('Namespace "'+b+'" already declared.')}goog.constructNamespace_(b)};goog.constructNamespace_=function(e,d){if(!COMPILED){delete goog.implicitNamespaces_[e];for(var f=e;(f=f.substring(0,f.lastIndexOf(".")))&&!goog.getObjectByName(f);){goog.implicitNamespaces_[f]=!0}}goog.exportPath_(e,d)};goog.module=function(b){if(!goog.isString(b)||!b){throw Error("Invalid module identifier")}if(!goog.isInModuleLoader_()){throw Error("Module "+b+" has been loaded incorrectly.")}if(goog.moduleLoaderState_.moduleName){throw Error("goog.module may only be called once per module.")}goog.moduleLoaderState_.moduleName=b;if(!COMPILED){if(goog.isProvided_(b)){throw Error('Namespace "'+b+'" already declared.')}delete goog.implicitNamespaces_[b]}};goog.module.get=function(b){return goog.module.getInternal_(b)};goog.module.getInternal_=function(b){if(!COMPILED){return goog.isProvided_(b)?b in goog.loadedModules_?goog.loadedModules_[b]:goog.getObjectByName(b):null}};goog.moduleLoaderState_=null;goog.isInModuleLoader_=function(){return null!=goog.moduleLoaderState_};goog.module.declareTestMethods=function(){if(!goog.isInModuleLoader_()){throw Error("goog.module.declareTestMethods must be called from within a goog.module")}goog.moduleLoaderState_.declareTestMethods=!0};goog.module.declareLegacyNamespace=function(){if(!COMPILED&&!goog.isInModuleLoader_()){throw Error("goog.module.declareLegacyNamespace must be called from within a goog.module")}if(!COMPILED&&!goog.moduleLoaderState_.moduleName){throw Error("goog.module must be called prior to goog.module.declareLegacyNamespace.")}goog.moduleLoaderState_.declareLegacyNamespace=!0};goog.setTestOnly=function(b){if(COMPILED&&!goog.DEBUG){throw b=b||"",Error("Importing test-only code into non-debug environment"+(b?": "+b:"."))}};goog.forwardDeclare=function(b){};COMPILED||(goog.isProvided_=function(b){return b in goog.loadedModules_||!goog.implicitNamespaces_[b]&&goog.isDefAndNotNull(goog.getObjectByName(b))},goog.implicitNamespaces_={"goog.module":!0});goog.getObjectByName=function(g,f){for(var m=g.split("."),k=f||goog.global,j;j=m.shift();){if(goog.isDefAndNotNull(k[j])){k=k[j]}else{return null}}return k};goog.globalize=function(f,e){var j=e||goog.global,g;for(g in f){j[g]=f[g]}};goog.addDependency=function(k,j,s,r){if(goog.DEPENDENCIES_ENABLED){var q;k=k.replace(/\\/g,"/");for(var n=goog.dependencies_,m=0;q=j[m];m++){n.nameToPath[q]=k,n.pathIsModule[k]=!!r}for(r=0;j=s[r];r++){k in n.requires||(n.requires[k]={}),n.requires[k][j]=!0}}};goog.ENABLE_DEBUG_LOADER=!0;goog.logToConsole_=function(b){goog.global.console&&goog.global.console.error(b)};goog.require=function(e){if(!COMPILED){goog.ENABLE_DEBUG_LOADER&&goog.IS_OLD_IE_&&goog.maybeProcessDeferredDep_(e);if(goog.isProvided_(e)){return goog.isInModuleLoader_()?goog.module.getInternal_(e):null}if(goog.ENABLE_DEBUG_LOADER){var d=goog.getPathFromDeps_(e);if(d){return goog.included_[d]=!0,goog.writeScripts_(),null}}e="goog.require could not find: "+e;goog.logToConsole_(e);throw Error(e)}};goog.basePath="";goog.nullFunction=function(){};goog.identityFunction=function(e,d){return e};goog.abstractMethod=function(){throw Error("unimplemented abstract method")};goog.addSingletonGetter=function(b){b.getInstance=function(){if(b.instance_){return b.instance_}goog.DEBUG&&(goog.instantiatedSingletons_[goog.instantiatedSingletons_.length]=b);return b.instance_=new b}};goog.instantiatedSingletons_=[];goog.LOAD_MODULE_USING_EVAL=!0;goog.SEAL_MODULE_EXPORTS=goog.DEBUG;goog.loadedModules_={};goog.DEPENDENCIES_ENABLED=!COMPILED&&goog.ENABLE_DEBUG_LOADER;goog.DEPENDENCIES_ENABLED&&(goog.included_={},goog.dependencies_={pathIsModule:{},nameToPath:{},requires:{},visited:{},written:{},deferred:{}},goog.inHtmlDocument_=function(){var b=goog.global.document;return"undefined"!=typeof b&&"write" in b},goog.findBasePath_=function(){if(goog.global.CLOSURE_BASE_PATH){goog.basePath=goog.global.CLOSURE_BASE_PATH}else{if(goog.inHtmlDocument_()){for(var f=goog.global.document.getElementsByTagName("script"),e=f.length-1;0<=e;--e){var j=f[e].src,g=j.lastIndexOf("?"),g=-1==g?j.length:g;if("base.js"==j.substr(g-7,7)){goog.basePath=j.substr(0,g-7);break}}}}},goog.importScript_=function(e,d){(goog.global.CLOSURE_IMPORT_SCRIPT||goog.writeScriptTag_)(e,d)&&(goog.dependencies_.written[e]=!0)},goog.IS_OLD_IE_=goog.global.document&&goog.global.document.all&&!goog.global.atob,goog.importModule_=function(b){goog.importScript_("",'goog.retrieveAndExecModule_("'+b+'");')&&(goog.dependencies_.written[b]=!0)},goog.queuedModules_=[],goog.retrieveAndExecModule_=function(g){for(var f=g,m;-1!=(m=g.indexOf("/./"));){g=g.substr(0,m)+g.substr(m+2)}for(;-1!=(m=g.indexOf("/../"));){var k=g.lastIndexOf("/",m-1);g=g.substr(0,k)+g.substr(m+3)}m=goog.global.CLOSURE_IMPORT_SCRIPT||goog.writeScriptTag_;var j=null,k=new goog.global.XMLHttpRequest;k.onload=function(){j=this.responseText};k.open("get",g,!1);k.send();j=k.responseText;if(null!=j){k=goog.wrapModule_(g,j),goog.IS_OLD_IE_?(goog.dependencies_.deferred[f]=k,goog.queuedModules_.push(f)):m(g,k)}else{throw Error("load of "+g+"failed")}},goog.wrapModule_=function(e,d){return goog.LOAD_MODULE_USING_EVAL&&goog.isDef(goog.global.JSON)?"goog.loadModule("+goog.global.JSON.stringify(d+"\n//# sourceURL="+e+"\n")+");":'goog.loadModule(function(exports) {"use strict";'+d+"\n;return exports});\n//# sourceURL="+e+"\n"},goog.loadQueuedModules_=function(){var e=goog.queuedModules_.length;if(0<e){var d=goog.queuedModules_;goog.queuedModules_=[];for(var f=0;f<e;f++){goog.maybeProcessDeferredPath_(d[f])}}},goog.maybeProcessDeferredDep_=function(b){goog.isDeferredModule_(b)&&goog.allDepsAreAvailable_(b)&&(b=goog.getPathFromDeps_(b),goog.maybeProcessDeferredPath_(goog.basePath+b))},goog.isDeferredModule_=function(b){return(b=goog.getPathFromDeps_(b))&&goog.dependencies_.pathIsModule[b]?goog.basePath+b in goog.dependencies_.deferred:!1},goog.allDepsAreAvailable_=function(e){if((e=goog.getPathFromDeps_(e))&&e in goog.dependencies_.requires){for(var d in goog.dependencies_.requires[e]){if(!goog.isProvided_(d)&&!goog.isDeferredModule_(d)){return !1}}}return !0},goog.maybeProcessDeferredPath_=function(e){if(e in goog.dependencies_.deferred){var d=goog.dependencies_.deferred[e];delete goog.dependencies_.deferred[e];goog.globalEval(d)}},goog.loadModule=function(g){var f=goog.moduleLoaderState_;try{goog.moduleLoaderState_={moduleName:void 0,declareTestMethods:!1};var m;if(goog.isFunction(g)){m=g.call(goog.global,{})}else{if(goog.isString(g)){m=goog.loadModuleFromSource_.call(goog.global,g)}else{throw Error("Invalid module definition")}}var k=goog.moduleLoaderState_.moduleName;if(!goog.isString(k)||!k){throw Error('Invalid module name "'+k+'"')}goog.moduleLoaderState_.declareLegacyNamespace?goog.constructNamespace_(k,m):goog.SEAL_MODULE_EXPORTS&&Object.seal&&Object.seal(m);goog.loadedModules_[k]=m;if(goog.moduleLoaderState_.declareTestMethods){for(var j in m){if(0===j.indexOf("test",0)||"tearDown"==j||"setUp"==j||"setUpPage"==j||"tearDownPage"==j){goog.global[j]=m[j]}}}}finally{goog.moduleLoaderState_=f}},goog.loadModuleFromSource_=function(a){eval(a);return{}},goog.writeScriptTag_=function(f,e){if(goog.inHtmlDocument_()){var j=goog.global.document;if("complete"==j.readyState){if(/\bdeps.js$/.test(f)){return !1}throw Error('Cannot write "'+f+'" after document load')}var g=goog.IS_OLD_IE_;void 0===e?g?(g=" onreadystatechange='goog.onScriptLoad_(this, "+ ++goog.lastNonModuleScriptIndex_+")' ",j.write('<script type="text/javascript" src="'+f+'"'+g+">\x3c/script>")):j.write('<script type="text/javascript" src="'+f+'">\x3c/script>'):j.write('<script type="text/javascript">'+e+"\x3c/script>");return !0}return !1},goog.lastNonModuleScriptIndex_=0,goog.onScriptLoad_=function(e,d){"complete"==e.readyState&&goog.lastNonModuleScriptIndex_==d&&goog.loadQueuedModules_();return !0},goog.writeScripts_=function(){function k(b){if(!(b in r.written)){if(!(b in r.visited)&&(r.visited[b]=!0,b in r.requires)){for(var a in r.requires[b]){if(!goog.isProvided_(a)){if(a in r.nameToPath){k(r.nameToPath[a])}else{throw Error("Undefined nameToPath for "+a)}}}}b in s||(s[b]=!0,j.push(b))}}var j=[],s={},r=goog.dependencies_,q;for(q in goog.included_){r.written[q]||k(q)}for(var n=0;n<j.length;n++){q=j[n],goog.dependencies_.written[q]=!0}var m=goog.moduleLoaderState_;goog.moduleLoaderState_=null;for(n=0;n<j.length;n++){if(q=j[n]){r.pathIsModule[q]?goog.importModule_(goog.basePath+q):goog.importScript_(goog.basePath+q)}else{throw goog.moduleLoaderState_=m,Error("Undefined script input")}}goog.moduleLoaderState_=m},goog.getPathFromDeps_=function(b){return b in goog.dependencies_.nameToPath?goog.dependencies_.nameToPath[b]:null},goog.findBasePath_(),goog.global.CLOSURE_NO_DEPS||goog.importScript_(goog.basePath+"deps.js"));goog.typeOf=function(e){var d=typeof e;if("object"==d){if(e){if(e instanceof Array){return"array"}if(e instanceof Object){return d}var f=Object.prototype.toString.call(e);if("[object Window]"==f){return"object"}if("[object Array]"==f||"number"==typeof e.length&&"undefined"!=typeof e.splice&&"undefined"!=typeof e.propertyIsEnumerable&&!e.propertyIsEnumerable("splice")){return"array"}if("[object Function]"==f||"undefined"!=typeof e.call&&"undefined"!=typeof e.propertyIsEnumerable&&!e.propertyIsEnumerable("call")){return"function"}}else{return"null"}}else{if("function"==d&&"undefined"==typeof e.call){return"object"}}return d};goog.isNull=function(b){return null===b};goog.isDefAndNotNull=function(b){return null!=b};goog.isArray=function(b){return"array"==goog.typeOf(b)};goog.isArrayLike=function(e){var d=goog.typeOf(e);return"array"==d||"object"==d&&"number"==typeof e.length};goog.isDateLike=function(b){return goog.isObject(b)&&"function"==typeof b.getFullYear};goog.isString=function(b){return"string"==typeof b};goog.isBoolean=function(b){return"boolean"==typeof b};goog.isNumber=function(b){return"number"==typeof b};goog.isFunction=function(b){return"function"==goog.typeOf(b)};goog.isObject=function(e){var d=typeof e;return"object"==d&&null!=e||"function"==d};goog.getUid=function(b){return b[goog.UID_PROPERTY_]||(b[goog.UID_PROPERTY_]=++goog.uidCounter_)};goog.hasUid=function(b){return !!b[goog.UID_PROPERTY_]};goog.removeUid=function(e){"removeAttribute" in e&&e.removeAttribute(goog.UID_PROPERTY_);try{delete e[goog.UID_PROPERTY_]}catch(d){}};goog.UID_PROPERTY_="closure_uid_"+(1000000000*Math.random()>>>0);goog.uidCounter_=0;goog.getHashCode=goog.getUid;goog.removeHashCode=goog.removeUid;goog.cloneObject=function(e){var d=goog.typeOf(e);if("object"==d||"array"==d){if(e.clone){return e.clone()}var d="array"==d?[]:{},f;for(f in e){d[f]=goog.cloneObject(e[f])}return d}return e};goog.bindNative_=function(e,d,f){return e.call.apply(e.bind,arguments)};goog.bindJs_=function(f,e,j){if(!f){throw Error()}if(2<arguments.length){var g=Array.prototype.slice.call(arguments,2);return function(){var a=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(a,g);return f.apply(e,a)}}return function(){return f.apply(e,arguments)}};goog.bind=function(e,d,f){Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?goog.bind=goog.bindNative_:goog.bind=goog.bindJs_;return goog.bind.apply(null,arguments)};goog.partial=function(e,d){var f=Array.prototype.slice.call(arguments,1);return function(){var a=f.slice();a.push.apply(a,arguments);return e.apply(this,a)}};goog.mixin=function(e,d){for(var f in d){e[f]=d[f]}};goog.now=goog.TRUSTED_SITE&&Date.now||function(){return +new Date};goog.globalEval=function(a){if(goog.global.execScript){goog.global.execScript(a,"JavaScript")}else{if(goog.global.eval){if(null==goog.evalWorksForGlobals_&&(goog.global.eval("var _et_ = 1;"),"undefined"!=typeof goog.global._et_?(delete goog.global._et_,goog.evalWorksForGlobals_=!0):goog.evalWorksForGlobals_=!1),goog.evalWorksForGlobals_){goog.global.eval(a)}else{var b=goog.global.document,c=b.createElement("script");c.type="text/javascript";c.defer=!1;c.appendChild(b.createTextNode(a));b.body.appendChild(c);b.body.removeChild(c)}}else{throw Error("goog.globalEval not available")}}};goog.evalWorksForGlobals_=null;goog.getCssName=function(f,e){var j=function(b){return goog.cssNameMapping_[b]||b},g=function(m){m=m.split("-");for(var k=[],n=0;n<m.length;n++){k.push(j(m[n]))}return k.join("-")},g=goog.cssNameMapping_?"BY_WHOLE"==goog.cssNameMappingStyle_?j:g:function(b){return b};return e?f+"-"+g(e):g(f)};goog.setCssNameMapping=function(e,d){goog.cssNameMapping_=e;goog.cssNameMappingStyle_=d};!COMPILED&&goog.global.CLOSURE_CSS_NAME_MAPPING&&(goog.cssNameMapping_=goog.global.CLOSURE_CSS_NAME_MAPPING);goog.getMsg=function(e,d){d&&(e=e.replace(/\{\$([^}]+)}/g,function(b,f){return f in d?d[f]:b}));return e};goog.getMsgWithFallback=function(e,d){return e};goog.exportSymbol=function(e,d,f){goog.exportPath_(e,d,f)};goog.exportProperty=function(e,d,f){e[d]=f};goog.inherits=function(e,d){function f(){}f.prototype=d.prototype;e.superClass_=d.prototype;e.prototype=new f;e.prototype.constructor=e;e.base=function(b,m,k){var j=Array.prototype.slice.call(arguments,2);return d.prototype[m].apply(b,j)}};goog.base=function(k,j,s){var r=arguments.callee.caller;if(goog.STRICT_MODE_COMPATIBLE||goog.DEBUG&&!r){throw Error("arguments.caller not defined.  goog.base() cannot be used with strict mode code. See http://www.ecma-international.org/ecma-262/5.1/#sec-C")}if(r.superClass_){return r.superClass_.constructor.apply(k,Array.prototype.slice.call(arguments,1))}for(var q=Array.prototype.slice.call(arguments,2),n=!1,m=k.constructor;m;m=m.superClass_&&m.superClass_.constructor){if(m.prototype[j]===r){n=!0}else{if(n){return m.prototype[j].apply(k,q)}}}if(k[j]===r){return k.constructor.prototype[j].apply(k,q)}throw Error("goog.base called from a method of one name to a method of a different name")};goog.scope=function(b){b.call(goog.global)};COMPILED||(goog.global.COMPILED=COMPILED);goog.defineClass=function(f,e){var j=e.constructor,g=e.statics;j&&j!=Object.prototype.constructor||(j=function(){throw Error("cannot instantiate an interface (no constructor defined).")});j=goog.defineClass.createSealingConstructor_(j,f);f&&goog.inherits(j,f);delete e.constructor;delete e.statics;goog.defineClass.applyProperties_(j.prototype,e);null!=g&&(g instanceof Function?g(j):goog.defineClass.applyProperties_(j,g));return j};goog.defineClass.SEAL_CLASS_INSTANCES=goog.DEBUG;goog.defineClass.createSealingConstructor_=function(e,d){if(goog.defineClass.SEAL_CLASS_INSTANCES&&Object.seal instanceof Function){if(d&&d.prototype&&d.prototype[goog.UNSEALABLE_CONSTRUCTOR_PROPERTY_]){return e}var f=function(){var a=e.apply(this,arguments)||this;a[goog.UID_PROPERTY_]=a[goog.UID_PROPERTY_];this.constructor===f&&Object.seal(a);return a};return f}return e};goog.defineClass.OBJECT_PROTOTYPE_FIELDS_="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");goog.defineClass.applyProperties_=function(f,e){for(var j in e){Object.prototype.hasOwnProperty.call(e,j)&&(f[j]=e[j])}for(var g=0;g<goog.defineClass.OBJECT_PROTOTYPE_FIELDS_.length;g++){j=goog.defineClass.OBJECT_PROTOTYPE_FIELDS_[g],Object.prototype.hasOwnProperty.call(e,j)&&(f[j]=e[j])}};goog.tagUnsealableClass=function(b){!COMPILED&&goog.defineClass.SEAL_CLASS_INSTANCES&&(b.prototype[goog.UNSEALABLE_CONSTRUCTOR_PROPERTY_]=!0)};goog.UNSEALABLE_CONSTRUCTOR_PROPERTY_="goog_defineClass_legacy_unsealable";var box2d={b2Settings:{}};Object.defineProperty||(Object.defineProperty=function(e,d,f){Object.__defineGetter__&&("get" in f?e.__defineGetter__(d,f.get):"value" in f&&e.__defineGetter__(d,f.value));Object.__defineSetter__&&("set" in f?e.__defineSetter__(d,f.set):"value" in f&&e.__defineSetter__(d,f.value))});box2d.DEBUG=!1;goog.exportSymbol("box2d.DEBUG",box2d.DEBUG);box2d.ENABLE_ASSERTS=box2d.DEBUG;goog.exportSymbol("box2d.ENABLE_ASSERTS",box2d.ENABLE_ASSERTS);box2d.b2Assert=function(e,d,f){if(box2d.DEBUG&&!e){}};goog.exportSymbol("box2d.b2Assert",box2d.b2Assert);box2d.b2_maxFloat=1e+37;goog.exportSymbol("box2d.b2_maxFloat",box2d.b2_maxFloat);box2d.b2_epsilon=0.00001;goog.exportSymbol("box2d.b2_epsilon",box2d.b2_epsilon);box2d.b2_epsilon_sq=box2d.b2_epsilon*box2d.b2_epsilon;goog.exportSymbol("box2d.b2_epsilon_sq",box2d.b2_epsilon_sq);box2d.b2_pi=Math.PI;goog.exportSymbol("box2d.b2_pi",box2d.b2_pi);box2d.b2_maxManifoldPoints=2;goog.exportSymbol("box2d.b2_maxManifoldPoints",box2d.b2_maxManifoldPoints);box2d.b2_maxPolygonVertices=8;goog.exportSymbol("box2d.b2_maxPolygonVertices",box2d.b2_maxPolygonVertices);box2d.b2_aabbExtension=0.1;goog.exportSymbol("box2d.b2_aabbExtension",box2d.b2_aabbExtension);box2d.b2_aabbMultiplier=2;goog.exportSymbol("box2d.b2_aabbMultiplier",box2d.b2_aabbMultiplier);box2d.b2_linearSlop=0.008;goog.exportSymbol("box2d.b2_linearSlop",box2d.b2_linearSlop);box2d.b2_angularSlop=2/180*box2d.b2_pi;goog.exportSymbol("box2d.b2_angularSlop",box2d.b2_angularSlop);box2d.b2_polygonRadius=2*box2d.b2_linearSlop;goog.exportSymbol("box2d.b2_polygonRadius",box2d.b2_polygonRadius);box2d.b2_maxSubSteps=8;goog.exportSymbol("box2d.b2_maxSubSteps",box2d.b2_maxSubSteps);box2d.b2_maxTOIContacts=32;goog.exportSymbol("box2d.b2_maxTOIContacts",box2d.b2_maxTOIContacts);box2d.b2_velocityThreshold=1;goog.exportSymbol("box2d.b2_velocityThreshold",box2d.b2_velocityThreshold);box2d.b2_maxLinearCorrection=0.2;goog.exportSymbol("box2d.b2_maxLinearCorrection",box2d.b2_maxLinearCorrection);box2d.b2_maxAngularCorrection=8/180*box2d.b2_pi;goog.exportSymbol("box2d.b2_maxAngularCorrection",box2d.b2_maxAngularCorrection);box2d.b2_maxTranslation=2;goog.exportSymbol("box2d.b2_maxTranslation",box2d.b2_maxTranslation);box2d.b2_maxTranslationSquared=box2d.b2_maxTranslation*box2d.b2_maxTranslation;goog.exportSymbol("box2d.b2_maxTranslationSquared",box2d.b2_maxTranslationSquared);box2d.b2_maxRotation=0.5*box2d.b2_pi;goog.exportSymbol("box2d.b2_maxRotation",box2d.b2_maxRotation);box2d.b2_maxRotationSquared=box2d.b2_maxRotation*box2d.b2_maxRotation;goog.exportSymbol("box2d.b2_maxRotationSquared",box2d.b2_maxRotationSquared);box2d.b2_baumgarte=0.2;goog.exportSymbol("box2d.b2_baumgarte",box2d.b2_baumgarte);box2d.b2_toiBaumgarte=0.75;goog.exportSymbol("box2d.b2_toiBaumgarte",box2d.b2_toiBaumgarte);box2d.b2_timeToSleep=0.5;goog.exportSymbol("box2d.b2_timeToSleep",box2d.b2_timeToSleep);box2d.b2_linearSleepTolerance=0.01;goog.exportSymbol("box2d.b2_linearSleepTolerance",box2d.b2_linearSleepTolerance);box2d.b2_angularSleepTolerance=2/180*box2d.b2_pi;goog.exportSymbol("box2d.b2_angularSleepTolerance",box2d.b2_angularSleepTolerance);box2d.b2Alloc=function(b){return null};goog.exportSymbol("box2d.b2Alloc",box2d.b2Alloc);box2d.b2Free=function(b){};goog.exportSymbol("box2d.b2Free",box2d.b2Free);box2d.b2Log=function(b){goog.global.console.log.apply(null,arguments)};goog.exportSymbol("box2d.b2Log",box2d.b2Log);box2d.b2Version=function(e,d,f){this.major=e||0;this.minor=d||0;this.revision=f||0};goog.exportSymbol("box2d.b2Version",box2d.b2Version);box2d.b2Version.prototype.major=0;goog.exportProperty(box2d.b2Version.prototype,"major",box2d.b2Version.prototype.major);box2d.b2Version.prototype.minor=0;goog.exportProperty(box2d.b2Version.prototype,"minor",box2d.b2Version.prototype.minor);box2d.b2Version.prototype.revision=0;goog.exportProperty(box2d.b2Version.prototype,"revision",box2d.b2Version.prototype.revision);box2d.b2Version.prototype.toString=function(){return this.major+"."+this.minor+"."+this.revision};goog.exportProperty(box2d.b2Version.prototype,"toString",box2d.b2Version.prototype.toString);box2d.b2_version=new box2d.b2Version(2,3,2);goog.exportSymbol("box2d.b2_version",box2d.b2_version);box2d.b2_changelist=313;goog.exportSymbol("box2d.b2_changelist",box2d.b2_changelist);box2d.b2ParseInt=function(b){return parseInt(b,10)};goog.exportSymbol("box2d.b2ParseInt",box2d.b2ParseInt);box2d.b2ParseUInt=function(b){return box2d.b2Abs(parseInt(b,10))};goog.exportSymbol("box2d.b2ParseUInt",box2d.b2ParseUInt);box2d.b2MakeArray=function(f,e){f="number"===typeof f?f:0;var j=[];if("function"===typeof e){for(var g=0;g<f;++g){j.push(e(g))}}else{for(g=0;g<f;++g){j.push(null)}}return j};goog.exportSymbol("box2d.b2MakeArray",box2d.b2MakeArray);box2d.b2MakeNumberArray=function(b){return box2d.b2MakeArray(b,function(d){return 0})};goog.exportSymbol("box2d.b2MakeNumberArray",box2d.b2MakeNumberArray);box2d.b2ControllerEdge=function(){};goog.exportSymbol("box2d.b2ControllerEdge",box2d.b2ControllerEdge);box2d.b2ControllerEdge.prototype.controller=null;goog.exportProperty(box2d.b2ControllerEdge.prototype,"controller",box2d.b2ControllerEdge.prototype.controller);box2d.b2ControllerEdge.prototype.body=null;goog.exportProperty(box2d.b2ControllerEdge.prototype,"body",box2d.b2ControllerEdge.prototype.body);box2d.b2ControllerEdge.prototype.prevBody=null;goog.exportProperty(box2d.b2ControllerEdge.prototype,"prevBody",box2d.b2ControllerEdge.prototype.prevBody);box2d.b2ControllerEdge.prototype.nextBody=null;goog.exportProperty(box2d.b2ControllerEdge.prototype,"nextBody",box2d.b2ControllerEdge.prototype.nextBody);box2d.b2ControllerEdge.prototype.prevController=null;goog.exportProperty(box2d.b2ControllerEdge.prototype,"prevController",box2d.b2ControllerEdge.prototype.prevController);box2d.b2ControllerEdge.prototype.nextController=null;goog.exportProperty(box2d.b2ControllerEdge.prototype,"nextController",box2d.b2ControllerEdge.prototype.nextController);box2d.b2Controller=function(){};goog.exportSymbol("box2d.b2Controller",box2d.b2Controller);box2d.b2Controller.prototype.m_world=null;goog.exportProperty(box2d.b2Controller.prototype,"m_world",box2d.b2Controller.prototype.m_world);box2d.b2Controller.prototype.m_bodyList=null;goog.exportProperty(box2d.b2Controller.prototype,"m_bodyList",box2d.b2Controller.prototype.m_bodyList);box2d.b2Controller.prototype.m_bodyCount=0;goog.exportProperty(box2d.b2Controller.prototype,"m_bodyCount",box2d.b2Controller.prototype.m_bodyCount);box2d.b2Controller.prototype.m_prev=null;goog.exportProperty(box2d.b2Controller.prototype,"m_prev",box2d.b2Controller.prototype.m_prev);box2d.b2Controller.prototype.m_next=null;goog.exportProperty(box2d.b2Controller.prototype,"m_next",box2d.b2Controller.prototype.m_next);box2d.b2Controller.prototype.Step=function(b){};goog.exportProperty(box2d.b2Controller.prototype,"Step",box2d.b2Controller.prototype.Step);box2d.b2Controller.prototype.Draw=function(b){};goog.exportProperty(box2d.b2Controller.prototype,"Draw",box2d.b2Controller.prototype.Draw);box2d.b2Controller.prototype.GetNext=function(){return this.m_next};goog.exportProperty(box2d.b2Controller.prototype,"GetNext",box2d.b2Controller.prototype.GetNext);box2d.b2Controller.prototype.GetPrev=function(){return this.m_prev};goog.exportProperty(box2d.b2Controller.prototype,"GetPrev",box2d.b2Controller.prototype.GetPrev);box2d.b2Controller.prototype.GetWorld=function(){return this.m_world};goog.exportProperty(box2d.b2Controller.prototype,"GetWorld",box2d.b2Controller.prototype.GetWorld);box2d.b2Controller.prototype.GetBodyList=function(){return this.m_bodyList};goog.exportProperty(box2d.b2Controller.prototype,"GetBodyList",box2d.b2Controller.prototype.GetBodyList);box2d.b2Controller.prototype.AddBody=function(e){var d=new box2d.b2ControllerEdge;d.body=e;d.controller=this;d.nextBody=this.m_bodyList;d.prevBody=null;this.m_bodyList&&(this.m_bodyList.prevBody=d);this.m_bodyList=d;++this.m_bodyCount;d.nextController=e.m_controllerList;d.prevController=null;e.m_controllerList&&(e.m_controllerList.prevController=d);e.m_controllerList=d;++e.m_controllerCount};goog.exportProperty(box2d.b2Controller.prototype,"AddBody",box2d.b2Controller.prototype.AddBody);box2d.b2Controller.prototype.RemoveBody=function(e){box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<this.m_bodyCount);for(var d=this.m_bodyList;d&&d.body!==e;){d=d.nextBody}box2d.ENABLE_ASSERTS&&box2d.b2Assert(null!==d);d.prevBody&&(d.prevBody.nextBody=d.nextBody);d.nextBody&&(d.nextBody.prevBody=d.prevBody);this.m_bodyList===d&&(this.m_bodyList=d.nextBody);--this.m_bodyCount;d.nextController&&(d.nextController.prevController=d.prevController);d.prevController&&(d.prevController.nextController=d.nextController);e.m_controllerList===d&&(e.m_controllerList=d.nextController);--e.m_controllerCount};goog.exportProperty(box2d.b2Controller.prototype,"RemoveBody",box2d.b2Controller.prototype.RemoveBody);box2d.b2Controller.prototype.Clear=function(){for(;this.m_bodyList;){this.RemoveBody(this.m_bodyList.body)}this.m_bodyCount=0};goog.exportProperty(box2d.b2Controller.prototype,"Clear",box2d.b2Controller.prototype.Clear);box2d.b2Color=function(f,e,j,g){this.r=f;this.g=e;this.b=j;this.a="number"===typeof g?g:1};goog.exportSymbol("box2d.b2Color",box2d.b2Color);box2d.b2Color.prototype.r=0.5;goog.exportProperty(box2d.b2Color.prototype,"r",box2d.b2Color.prototype.r);box2d.b2Color.prototype.g=0.5;goog.exportProperty(box2d.b2Color.prototype,"g",box2d.b2Color.prototype.g);box2d.b2Color.prototype.b=0.5;goog.exportProperty(box2d.b2Color.prototype,"b",box2d.b2Color.prototype.b);box2d.b2Color.prototype.a=1;goog.exportProperty(box2d.b2Color.prototype,"a",box2d.b2Color.prototype.a);box2d.b2Color.prototype.SetRGB=function(e,d,f){this.r=e;this.g=d;this.b=f;return this};goog.exportProperty(box2d.b2Color.prototype,"SetRGB",box2d.b2Color.prototype.SetRGB);box2d.b2Color.prototype.MakeStyleString=function(f){var e=Math.round(Math.max(0,Math.min(255,255*this.r))),j=Math.round(Math.max(0,Math.min(255,255*this.g))),g=Math.round(Math.max(0,Math.min(255,255*this.b)));f="undefined"===typeof f?this.a:Math.max(0,Math.min(1,f));return box2d.b2Color.MakeStyleString(e,j,g,f)};goog.exportProperty(box2d.b2Color.prototype,"MakeStyleString",box2d.b2Color.prototype.MakeStyleString);box2d.b2Color.MakeStyleString=function(f,e,j,g){return 1>g?"rgba("+f+","+e+","+j+","+g+")":"rgb("+f+","+e+","+j+")"};goog.exportProperty(box2d.b2Color,"MakeStyleString",box2d.b2Color.MakeStyleString);box2d.b2Color.RED=new box2d.b2Color(1,0,0);goog.exportProperty(box2d.b2Color,"RED",box2d.b2Color.RED);box2d.b2Color.GREEN=new box2d.b2Color(0,1,0);goog.exportProperty(box2d.b2Color,"GREEN",box2d.b2Color.GREEN);box2d.b2Color.BLUE=new box2d.b2Color(0,0,1);goog.exportProperty(box2d.b2Color,"BLUE",box2d.b2Color.BLUE);box2d.b2DrawFlags={e_none:0,e_shapeBit:1,e_jointBit:2,e_aabbBit:4,e_pairBit:8,e_centerOfMassBit:16,e_controllerBit:32,e_all:63};goog.exportSymbol("box2d.b2DrawFlags",box2d.b2DrawFlags);goog.exportProperty(box2d.b2DrawFlags,"e_none",box2d.b2DrawFlags.e_none);goog.exportProperty(box2d.b2DrawFlags,"e_shapeBit",box2d.b2DrawFlags.e_shapeBit);goog.exportProperty(box2d.b2DrawFlags,"e_jointBit",box2d.b2DrawFlags.e_jointBit);goog.exportProperty(box2d.b2DrawFlags,"e_aabbBit",box2d.b2DrawFlags.e_aabbBit);goog.exportProperty(box2d.b2DrawFlags,"e_pairBit",box2d.b2DrawFlags.e_pairBit);goog.exportProperty(box2d.b2DrawFlags,"e_centerOfMassBit",box2d.b2DrawFlags.e_centerOfMassBit);goog.exportProperty(box2d.b2DrawFlags,"e_controllerBit",box2d.b2DrawFlags.e_controllerBit);goog.exportProperty(box2d.b2DrawFlags,"e_all",box2d.b2DrawFlags.e_all);box2d.b2Draw=function(){};goog.exportSymbol("box2d.b2Draw",box2d.b2Draw);box2d.b2Draw.prototype.m_drawFlags=box2d.b2DrawFlags.e_none;goog.exportProperty(box2d.b2Draw.prototype,"m_drawFlags",box2d.b2Draw.prototype.m_drawFlags);box2d.b2Draw.prototype.SetFlags=function(b){this.m_drawFlags=b};goog.exportProperty(box2d.b2Draw.prototype,"SetFlags",box2d.b2Draw.prototype.SetFlags);box2d.b2Draw.prototype.GetFlags=function(){return this.m_drawFlags};goog.exportProperty(box2d.b2Draw.prototype,"GetFlags",box2d.b2Draw.prototype.GetFlags);box2d.b2Draw.prototype.AppendFlags=function(b){this.m_drawFlags|=b};goog.exportProperty(box2d.b2Draw.prototype,"AppendFlags",box2d.b2Draw.prototype.AppendFlags);box2d.b2Draw.prototype.ClearFlags=function(b){this.m_drawFlags&=~b};goog.exportProperty(box2d.b2Draw.prototype,"ClearFlags",box2d.b2Draw.prototype.ClearFlags);box2d.b2Draw.prototype.PushTransform=function(b){};goog.exportProperty(box2d.b2Draw.prototype,"PushTransform",box2d.b2Draw.prototype.PushTransform);box2d.b2Draw.prototype.PopTransform=function(b){};goog.exportProperty(box2d.b2Draw.prototype,"PopTransform",box2d.b2Draw.prototype.PopTransform);box2d.b2Draw.prototype.DrawPolygon=function(e,d,f){};goog.exportProperty(box2d.b2Draw.prototype,"DrawPolygon",box2d.b2Draw.prototype.DrawPolygon);box2d.b2Draw.prototype.DrawSolidPolygon=function(e,d,f){};goog.exportProperty(box2d.b2Draw.prototype,"DrawSolidPolygon",box2d.b2Draw.prototype.DrawSolidPolygon);box2d.b2Draw.prototype.DrawCircle=function(e,d,f){};goog.exportProperty(box2d.b2Draw.prototype,"DrawCircle",box2d.b2Draw.prototype.DrawCircle);box2d.b2Draw.prototype.DrawSolidCircle=function(f,e,j,g){};goog.exportProperty(box2d.b2Draw.prototype,"DrawSolidCircle",box2d.b2Draw.prototype.DrawSolidCircle);box2d.b2Draw.prototype.DrawSegment=function(e,d,f){};goog.exportProperty(box2d.b2Draw.prototype,"DrawSegment",box2d.b2Draw.prototype.DrawSegment);box2d.b2Draw.prototype.DrawTransform=function(b){};goog.exportProperty(box2d.b2Draw.prototype,"DrawTransform",box2d.b2Draw.prototype.DrawTransform);box2d.b2GrowableStack=function(b){this.m_stack=Array(b)};goog.exportSymbol("box2d.b2GrowableStack",box2d.b2GrowableStack);box2d.b2GrowableStack.prototype.m_stack=null;goog.exportProperty(box2d.b2GrowableStack.prototype,"m_stack",box2d.b2GrowableStack.prototype.m_stack);box2d.b2GrowableStack.prototype.m_count=0;goog.exportProperty(box2d.b2GrowableStack.prototype,"m_count",box2d.b2GrowableStack.prototype.m_count);box2d.b2GrowableStack.prototype.Reset=function(){this.m_count=0;return this};goog.exportProperty(box2d.b2GrowableStack.prototype,"Reset",box2d.b2GrowableStack.prototype.Reset);box2d.b2GrowableStack.prototype.Push=function(b){this.m_stack[this.m_count]=b;++this.m_count};goog.exportProperty(box2d.b2GrowableStack.prototype,"Push",box2d.b2GrowableStack.prototype.Push);box2d.b2GrowableStack.prototype.Pop=function(){box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<this.m_count);--this.m_count;var b=this.m_stack[this.m_count];this.m_stack[this.m_count]=null;return b};goog.exportProperty(box2d.b2GrowableStack.prototype,"Pop",box2d.b2GrowableStack.prototype.Pop);box2d.b2GrowableStack.prototype.GetCount=function(){return this.m_count};goog.exportProperty(box2d.b2GrowableStack.prototype,"GetCount",box2d.b2GrowableStack.prototype.GetCount);box2d.b2Math={};box2d.b2_pi_over_180=box2d.b2_pi/180;goog.exportSymbol("box2d.b2_pi_over_180",box2d.b2_pi_over_180);box2d.b2_180_over_pi=180/box2d.b2_pi;goog.exportSymbol("box2d.b2_180_over_pi",box2d.b2_180_over_pi);box2d.b2_two_pi=2*box2d.b2_pi;goog.exportSymbol("box2d.b2_two_pi",box2d.b2_two_pi);box2d.b2Abs=function(b){return 0>b?-b:b};goog.exportSymbol("box2d.b2Abs",box2d.b2Abs);box2d.b2Min=function(e,d){return e<d?e:d};goog.exportSymbol("box2d.b2Min",box2d.b2Min);box2d.b2Max=function(e,d){return e>d?e:d};goog.exportSymbol("box2d.b2Max",box2d.b2Max);box2d.b2Clamp=function(e,d,f){return e<d?d:e>f?f:e};goog.exportSymbol("box2d.b2Clamp",box2d.b2Clamp);box2d.b2Swap=function(e,d){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1);var f=e[0];e[0]=d[0];d[0]=f};goog.exportSymbol("box2d.b2Swap",box2d.b2Swap);box2d.b2IsValid=function(b){return isFinite(b)};goog.exportSymbol("box2d.b2IsValid",box2d.b2IsValid);box2d.b2Sq=function(b){return b*b};goog.exportSymbol("box2d.b2Sq",box2d.b2Sq);box2d.b2InvSqrt=function(b){return 1/Math.sqrt(b)};goog.exportSymbol("box2d.b2InvSqrt",box2d.b2InvSqrt);box2d.b2Sqrt=function(b){return Math.sqrt(b)};goog.exportSymbol("box2d.b2Sqrt",box2d.b2Sqrt);box2d.b2Pow=function(e,d){return Math.pow(e,d)};goog.exportSymbol("box2d.b2Pow",box2d.b2Pow);box2d.b2DegToRad=function(b){return b*box2d.b2_pi_over_180};goog.exportSymbol("box2d.b2DegToRad",box2d.b2DegToRad);box2d.b2RadToDeg=function(b){return b*box2d.b2_180_over_pi};goog.exportSymbol("box2d.b2RadToDeg",box2d.b2RadToDeg);box2d.b2Cos=function(b){return Math.cos(b)};goog.exportSymbol("box2d.b2Cos",box2d.b2Cos);box2d.b2Sin=function(b){return Math.sin(b)};goog.exportSymbol("box2d.b2Sin",box2d.b2Sin);box2d.b2Acos=function(b){return Math.acos(b)};goog.exportSymbol("box2d.b2Acos",box2d.b2Acos);box2d.b2Asin=function(b){return Math.asin(b)};goog.exportSymbol("box2d.b2Asin",box2d.b2Asin);box2d.b2Atan2=function(e,d){return Math.atan2(e,d)};goog.exportSymbol("box2d.b2Atan2",box2d.b2Atan2);box2d.b2NextPowerOfTwo=function(b){b|=b>>1&2147483647;b|=b>>2&1073741823;b|=b>>4&268435455;b|=b>>8&16777215;return(b|b>>16&65535)+1};goog.exportSymbol("box2d.b2NextPowerOfTwo",box2d.b2NextPowerOfTwo);box2d.b2IsPowerOfTwo=function(b){return 0<b&&0===(b&b-1)};goog.exportSymbol("box2d.b2IsPowerOfTwo",box2d.b2IsPowerOfTwo);box2d.b2Random=function(){return 2*Math.random()-1};goog.exportSymbol("box2d.b2Random",box2d.b2Random);box2d.b2RandomRange=function(e,d){return(d-e)*Math.random()+e};goog.exportSymbol("box2d.b2RandomRange",box2d.b2RandomRange);box2d.b2Vec2=function(e,d){this.x=e||0;this.y=d||0};goog.exportSymbol("box2d.b2Vec2",box2d.b2Vec2);box2d.b2Vec2.prototype.x=0;goog.exportProperty(box2d.b2Vec2.prototype,"x",box2d.b2Vec2.prototype.x);box2d.b2Vec2.prototype.y=0;goog.exportProperty(box2d.b2Vec2.prototype,"y",box2d.b2Vec2.prototype.y);box2d.b2Vec2_zero=new box2d.b2Vec2;goog.exportSymbol("box2d.b2Vec2_zero",box2d.b2Vec2_zero);box2d.b2Vec2.ZERO=new box2d.b2Vec2;goog.exportProperty(box2d.b2Vec2,"ZERO",box2d.b2Vec2.ZERO);box2d.b2Vec2.UNITX=new box2d.b2Vec2(1,0);goog.exportProperty(box2d.b2Vec2,"UNITX",box2d.b2Vec2.UNITX);box2d.b2Vec2.UNITY=new box2d.b2Vec2(0,1);goog.exportProperty(box2d.b2Vec2,"UNITY",box2d.b2Vec2.UNITY);box2d.b2Vec2.s_t0=new box2d.b2Vec2;goog.exportProperty(box2d.b2Vec2,"s_t0",box2d.b2Vec2.s_t0);box2d.b2Vec2.s_t1=new box2d.b2Vec2;goog.exportProperty(box2d.b2Vec2,"s_t1",box2d.b2Vec2.s_t1);box2d.b2Vec2.s_t2=new box2d.b2Vec2;goog.exportProperty(box2d.b2Vec2,"s_t2",box2d.b2Vec2.s_t2);box2d.b2Vec2.s_t3=new box2d.b2Vec2;goog.exportProperty(box2d.b2Vec2,"s_t3",box2d.b2Vec2.s_t3);box2d.b2Vec2.MakeArray=function(b){return box2d.b2MakeArray(b,function(d){return new box2d.b2Vec2})};goog.exportProperty(box2d.b2Vec2,"MakeArray",box2d.b2Vec2.MakeArray);box2d.b2Vec2.prototype.Clone=function(){return new box2d.b2Vec2(this.x,this.y)};goog.exportProperty(box2d.b2Vec2.prototype,"Clone",box2d.b2Vec2.prototype.Clone);box2d.b2Vec2.prototype.SetZero=function(){this.y=this.x=0;return this};goog.exportProperty(box2d.b2Vec2.prototype,"SetZero",box2d.b2Vec2.prototype.SetZero);box2d.b2Vec2.prototype.SetXY=function(e,d){this.x=e;this.y=d;return this};goog.exportProperty(box2d.b2Vec2.prototype,"SetXY",box2d.b2Vec2.prototype.SetXY);box2d.b2Vec2.prototype.Copy=function(b){this.x=b.x;this.y=b.y;return this};goog.exportProperty(box2d.b2Vec2.prototype,"Copy",box2d.b2Vec2.prototype.Copy);box2d.b2Vec2.prototype.SelfAdd=function(b){this.x+=b.x;this.y+=b.y;return this};goog.exportProperty(box2d.b2Vec2.prototype,"SelfAdd",box2d.b2Vec2.prototype.SelfAdd);box2d.b2Vec2.prototype.SelfAddXY=function(e,d){this.x+=e;this.y+=d;return this};goog.exportProperty(box2d.b2Vec2.prototype,"SelfAddXY",box2d.b2Vec2.prototype.SelfAddXY);box2d.b2Vec2.prototype.SelfSub=function(b){this.x-=b.x;this.y-=b.y;return this};goog.exportProperty(box2d.b2Vec2.prototype,"SelfSub",box2d.b2Vec2.prototype.SelfSub);box2d.b2Vec2.prototype.SelfSubXY=function(e,d){this.x-=e;this.y-=d;return this};goog.exportProperty(box2d.b2Vec2.prototype,"SelfSubXY",box2d.b2Vec2.prototype.SelfSubXY);box2d.b2Vec2.prototype.SelfMul=function(b){this.x*=b;this.y*=b;return this};goog.exportProperty(box2d.b2Vec2.prototype,"SelfMul",box2d.b2Vec2.prototype.SelfMul);box2d.b2Vec2.prototype.SelfMulAdd=function(e,d){this.x+=e*d.x;this.y+=e*d.y;return this};goog.exportProperty(box2d.b2Vec2.prototype,"SelfMulAdd",box2d.b2Vec2.prototype.SelfMulAdd);box2d.b2Vec2.prototype.SelfMulSub=function(e,d){this.x-=e*d.x;this.y-=e*d.y;return this};goog.exportProperty(box2d.b2Vec2.prototype,"SelfMulSub",box2d.b2Vec2.prototype.SelfMulSub);box2d.b2Vec2.prototype.Dot=function(b){return this.x*b.x+this.y*b.y};goog.exportProperty(box2d.b2Vec2.prototype,"Dot",box2d.b2Vec2.prototype.Dot);box2d.b2Vec2.prototype.Cross=function(b){return this.x*b.y-this.y*b.x};goog.exportProperty(box2d.b2Vec2.prototype,"Cross",box2d.b2Vec2.prototype.Cross);box2d.b2Vec2.prototype.Length=function(){var e=this.x,d=this.y;return Math.sqrt(e*e+d*d)};goog.exportProperty(box2d.b2Vec2.prototype,"Length",box2d.b2Vec2.prototype.Length);box2d.b2Vec2.prototype.GetLength=box2d.b2Vec2.prototype.Length;goog.exportProperty(box2d.b2Vec2.prototype,"GetLength",box2d.b2Vec2.prototype.GetLength);box2d.b2Vec2.prototype.LengthSquared=function(){var e=this.x,d=this.y;return e*e+d*d};goog.exportProperty(box2d.b2Vec2.prototype,"LengthSquared",box2d.b2Vec2.prototype.LengthSquared);box2d.b2Vec2.prototype.GetLengthSquared=box2d.b2Vec2.prototype.LengthSquared;goog.exportProperty(box2d.b2Vec2.prototype,"GetLengthSquared",box2d.b2Vec2.prototype.GetLengthSquared);box2d.b2Vec2.prototype.Normalize=function(){var e=this.GetLength();if(e>=box2d.b2_epsilon){var d=1/e;this.x*=d;this.y*=d}return e};goog.exportProperty(box2d.b2Vec2.prototype,"Normalize",box2d.b2Vec2.prototype.Normalize);box2d.b2Vec2.prototype.SelfNormalize=function(){var b=this.GetLength();b>=box2d.b2_epsilon&&(b=1/b,this.x*=b,this.y*=b);return this};goog.exportProperty(box2d.b2Vec2.prototype,"SelfNormalize",box2d.b2Vec2.prototype.SelfNormalize);box2d.b2Vec2.prototype.SelfRotate=function(f,e){var j=this.x,g=this.y;this.x=f*j-e*g;this.y=e*j+f*g;return this};goog.exportProperty(box2d.b2Vec2.prototype,"SelfRotate",box2d.b2Vec2.prototype.SelfRotate);box2d.b2Vec2.prototype.SelfRotateRadians=function(b){return this.SelfRotate(Math.cos(b),Math.sin(b))};goog.exportProperty(box2d.b2Vec2.prototype,"SelfRotateRadians",box2d.b2Vec2.prototype.SelfRotateRadians);box2d.b2Vec2.prototype.SelfRotateDegrees=function(b){return this.SelfRotateRadians(box2d.b2DegToRad(b))};goog.exportProperty(box2d.b2Vec2.prototype,"SelfRotateDegrees",box2d.b2Vec2.prototype.SelfRotateDegrees);box2d.b2Vec2.prototype.IsValid=function(){return isFinite(this.x)&&isFinite(this.y)};goog.exportProperty(box2d.b2Vec2.prototype,"IsValid",box2d.b2Vec2.prototype.IsValid);box2d.b2Vec2.prototype.SelfCrossVS=function(e){var d=this.x;this.x=e*this.y;this.y=-e*d;return this};goog.exportProperty(box2d.b2Vec2.prototype,"SelfCrossVS",box2d.b2Vec2.prototype.SelfCrossVS);box2d.b2Vec2.prototype.SelfCrossSV=function(e){var d=this.x;this.x=-e*this.y;this.y=e*d;return this};goog.exportProperty(box2d.b2Vec2.prototype,"SelfCrossSV",box2d.b2Vec2.prototype.SelfCrossSV);box2d.b2Vec2.prototype.SelfMinV=function(b){this.x=box2d.b2Min(this.x,b.x);this.y=box2d.b2Min(this.y,b.y);return this};goog.exportProperty(box2d.b2Vec2.prototype,"SelfMinV",box2d.b2Vec2.prototype.SelfMinV);box2d.b2Vec2.prototype.SelfMaxV=function(b){this.x=box2d.b2Max(this.x,b.x);this.y=box2d.b2Max(this.y,b.y);return this};goog.exportProperty(box2d.b2Vec2.prototype,"SelfMaxV",box2d.b2Vec2.prototype.SelfMaxV);box2d.b2Vec2.prototype.SelfAbs=function(){this.x=box2d.b2Abs(this.x);this.y=box2d.b2Abs(this.y);return this};goog.exportProperty(box2d.b2Vec2.prototype,"SelfAbs",box2d.b2Vec2.prototype.SelfAbs);box2d.b2Vec2.prototype.SelfNeg=function(){this.x=-this.x;this.y=-this.y;return this};goog.exportProperty(box2d.b2Vec2.prototype,"SelfNeg",box2d.b2Vec2.prototype.SelfNeg);box2d.b2Vec2.prototype.SelfSkew=function(){var b=this.x;this.x=-this.y;this.y=b;return this};goog.exportProperty(box2d.b2Vec2.prototype,"SelfSkew",box2d.b2Vec2.prototype.SelfSkew);box2d.b2AbsV=function(e,d){d.x=box2d.b2Abs(e.x);d.y=box2d.b2Abs(e.y);return d};goog.exportSymbol("box2d.b2AbsV",box2d.b2AbsV);box2d.b2MinV=function(e,d,f){f.x=box2d.b2Min(e.x,d.x);f.y=box2d.b2Min(e.y,d.y);return f};goog.exportSymbol("box2d.b2MinV",box2d.b2MinV);box2d.b2MaxV=function(e,d,f){f.x=box2d.b2Max(e.x,d.x);f.y=box2d.b2Max(e.y,d.y);return f};goog.exportSymbol("box2d.b2MaxV",box2d.b2MaxV);box2d.b2ClampV=function(f,e,j,g){g.x=box2d.b2Clamp(f.x,e.x,j.x);g.y=box2d.b2Clamp(f.y,e.y,j.y);return g};goog.exportSymbol("box2d.b2ClampV",box2d.b2ClampV);box2d.b2RotateV=function(g,f,m,k){var j=g.x;g=g.y;k.x=f*j-m*g;k.y=m*j+f*g;return k};goog.exportSymbol("box2d.b2RotateV",box2d.b2RotateV);box2d.b2RotateRadiansV=function(e,d,f){return box2d.b2RotateV(e,Math.cos(d),Math.sin(d),f)};goog.exportSymbol("box2d.b2RotateRadiansV",box2d.b2RotateRadiansV);box2d.b2RotateDegreesV=function(e,d,f){return box2d.b2RotateRadiansV(e,box2d.b2DegToRad(d),f)};goog.exportSymbol("box2d.b2RotateDegreesV",box2d.b2RotateDegreesV);box2d.b2DotVV=function(e,d){return e.x*d.x+e.y*d.y};goog.exportSymbol("box2d.b2DotVV",box2d.b2DotVV);box2d.b2CrossVV=function(e,d){return e.x*d.y-e.y*d.x};goog.exportSymbol("box2d.b2CrossVV",box2d.b2CrossVV);box2d.b2CrossVS=function(f,e,j){var g=f.x;j.x=e*f.y;j.y=-e*g;return j};goog.exportSymbol("box2d.b2CrossVS",box2d.b2CrossVS);box2d.b2CrossVOne=function(e,d){var f=e.x;d.x=e.y;d.y=-f;return d};goog.exportSymbol("box2d.b2CrossVOne",box2d.b2CrossVOne);box2d.b2CrossSV=function(f,e,j){var g=e.x;j.x=-f*e.y;j.y=f*g;return j};goog.exportSymbol("box2d.b2CrossSV",box2d.b2CrossSV);box2d.b2CrossOneV=function(e,d){var f=e.x;d.x=-e.y;d.y=f;return d};goog.exportSymbol("box2d.b2CrossOneV",box2d.b2CrossOneV);box2d.b2AddVV=function(e,d,f){f.x=e.x+d.x;f.y=e.y+d.y;return f};goog.exportSymbol("box2d.b2AddVV",box2d.b2AddVV);box2d.b2SubVV=function(e,d,f){f.x=e.x-d.x;f.y=e.y-d.y;return f};goog.exportSymbol("box2d.b2SubVV",box2d.b2SubVV);box2d.b2MulSV=function(e,d,f){f.x=d.x*e;f.y=d.y*e;return f};goog.exportSymbol("box2d.b2MulSV",box2d.b2MulSV);box2d.b2AddVMulSV=function(f,e,j,g){g.x=f.x+e*j.x;g.y=f.y+e*j.y;return g};goog.exportSymbol("box2d.b2AddVMulSV",box2d.b2AddVMulSV);box2d.b2SubVMulSV=function(f,e,j,g){g.x=f.x-e*j.x;g.y=f.y-e*j.y;return g};goog.exportSymbol("box2d.b2SubVMulSV",box2d.b2SubVMulSV);box2d.b2AddVCrossSV=function(g,f,m,k){var j=m.x;k.x=g.x-f*m.y;k.y=g.y+f*j;return k};goog.exportSymbol("box2d.b2AddVCrossSV",box2d.b2AddVCrossSV);box2d.b2MidVV=function(e,d,f){f.x=0.5*(e.x+d.x);f.y=0.5*(e.y+d.y);return f};goog.exportSymbol("box2d.b2MidVV",box2d.b2MidVV);box2d.b2ExtVV=function(e,d,f){f.x=0.5*(d.x-e.x);f.y=0.5*(d.y-e.y);return f};goog.exportSymbol("box2d.b2ExtVV",box2d.b2ExtVV);box2d.b2IsEqualToV=function(e,d){return e.x===d.x&&e.y===d.y};goog.exportSymbol("box2d.b2IsEqualToV",box2d.b2IsEqualToV);box2d.b2DistanceVV=function(f,e){var j=f.x-e.x,g=f.y-e.y;return Math.sqrt(j*j+g*g)};goog.exportSymbol("box2d.b2DistanceVV",box2d.b2DistanceVV);box2d.b2DistanceSquaredVV=function(f,e){var j=f.x-e.x,g=f.y-e.y;return j*j+g*g};goog.exportSymbol("box2d.b2DistanceSquaredVV",box2d.b2DistanceSquaredVV);box2d.b2NegV=function(e,d){d.x=-e.x;d.y=-e.y;return d};goog.exportSymbol("box2d.b2NegV",box2d.b2NegV);box2d.b2Vec3=function(e,d,f){this.x=e||0;this.y=d||0;this.z=f||0};goog.exportSymbol("box2d.b2Vec3",box2d.b2Vec3);box2d.b2Vec3.prototype.x=0;goog.exportProperty(box2d.b2Vec3.prototype,"x",box2d.b2Vec3.prototype.x);box2d.b2Vec3.prototype.y=0;goog.exportProperty(box2d.b2Vec3.prototype,"y",box2d.b2Vec3.prototype.y);box2d.b2Vec3.prototype.z=0;goog.exportProperty(box2d.b2Vec3.prototype,"z",box2d.b2Vec3.prototype.z);box2d.b2Vec3.ZERO=new box2d.b2Vec3;goog.exportProperty(box2d.b2Vec3,"ZERO",box2d.b2Vec3.ZERO);box2d.b2Vec3.s_t0=new box2d.b2Vec3;goog.exportProperty(box2d.b2Vec3,"s_t0",box2d.b2Vec3.s_t0);box2d.b2Vec3.prototype.Clone=function(){return new box2d.b2Vec3(this.x,this.y,this.z)};goog.exportProperty(box2d.b2Vec3.prototype,"Clone",box2d.b2Vec3.prototype.Clone);box2d.b2Vec3.prototype.SetZero=function(){this.z=this.y=this.x=0;return this};goog.exportProperty(box2d.b2Vec3.prototype,"SetZero",box2d.b2Vec3.prototype.SetZero);box2d.b2Vec3.prototype.SetXYZ=function(e,d,f){this.x=e;this.y=d;this.z=f;return this};goog.exportProperty(box2d.b2Vec3.prototype,"SetXYZ",box2d.b2Vec3.prototype.SetXYZ);box2d.b2Vec3.prototype.Copy=function(b){this.x=b.x;this.y=b.y;this.z=b.z;return this};goog.exportProperty(box2d.b2Vec3.prototype,"Copy",box2d.b2Vec3.prototype.Copy);box2d.b2Vec3.prototype.SelfNeg=function(){this.x=-this.x;this.y=-this.y;this.z=-this.z;return this};goog.exportProperty(box2d.b2Vec3.prototype,"SelfNeg",box2d.b2Vec3.prototype.SelfNeg);box2d.b2Vec3.prototype.SelfAdd=function(b){this.x+=b.x;this.y+=b.y;this.z+=b.z;return this};goog.exportProperty(box2d.b2Vec3.prototype,"SelfAdd",box2d.b2Vec3.prototype.SelfAdd);box2d.b2Vec3.prototype.SelfAddXYZ=function(e,d,f){this.x+=e;this.y+=d;this.z+=f;return this};goog.exportProperty(box2d.b2Vec3.prototype,"SelfAddXYZ",box2d.b2Vec3.prototype.SelfAddXYZ);box2d.b2Vec3.prototype.SelfSub=function(b){this.x-=b.x;this.y-=b.y;this.z-=b.z;return this};goog.exportProperty(box2d.b2Vec3.prototype,"SelfSub",box2d.b2Vec3.prototype.SelfSub);box2d.b2Vec3.prototype.SelfSubXYZ=function(e,d,f){this.x-=e;this.y-=d;this.z-=f;return this};goog.exportProperty(box2d.b2Vec3.prototype,"SelfSubXYZ",box2d.b2Vec3.prototype.SelfSubXYZ);box2d.b2Vec3.prototype.SelfMul=function(b){this.x*=b;this.y*=b;this.z*=b;return this};goog.exportProperty(box2d.b2Vec3.prototype,"SelfMul",box2d.b2Vec3.prototype.SelfMul);box2d.b2DotV3V3=function(e,d){return e.x*d.x+e.y*d.y+e.z*d.z};goog.exportSymbol("box2d.b2DotV3V3",box2d.b2DotV3V3);box2d.b2CrossV3V3=function(k,j,s){var r=k.x,q=k.y;k=k.z;var n=j.x,m=j.y;j=j.z;s.x=q*j-k*m;s.y=k*n-r*j;s.z=r*m-q*n;return s};goog.exportSymbol("box2d.b2CrossV3V3",box2d.b2CrossV3V3);box2d.b2Mat22=function(){this.ex=new box2d.b2Vec2(1,0);this.ey=new box2d.b2Vec2(0,1)};goog.exportSymbol("box2d.b2Mat22",box2d.b2Mat22);box2d.b2Mat22.prototype.ex=null;goog.exportProperty(box2d.b2Mat22.prototype,"ex",box2d.b2Mat22.prototype.ex);box2d.b2Mat22.prototype.ey=null;goog.exportProperty(box2d.b2Mat22.prototype,"ey",box2d.b2Mat22.prototype.ey);box2d.b2Mat22.IDENTITY=new box2d.b2Mat22;goog.exportProperty(box2d.b2Mat22,"IDENTITY",box2d.b2Mat22.IDENTITY);box2d.b2Mat22.prototype.Clone=function(){return(new box2d.b2Mat22).Copy(this)};goog.exportProperty(box2d.b2Mat22.prototype,"Clone",box2d.b2Mat22.prototype.Clone);box2d.b2Mat22.FromVV=function(e,d){return(new box2d.b2Mat22).SetVV(e,d)};goog.exportProperty(box2d.b2Mat22,"FromVV",box2d.b2Mat22.FromVV);box2d.b2Mat22.FromSSSS=function(f,e,j,g){return(new box2d.b2Mat22).SetSSSS(f,e,j,g)};goog.exportProperty(box2d.b2Mat22,"FromSSSS",box2d.b2Mat22.FromSSSS);box2d.b2Mat22.FromAngleRadians=function(b){return(new box2d.b2Mat22).SetAngleRadians(b)};goog.exportProperty(box2d.b2Mat22,"FromAngleRadians",box2d.b2Mat22.FromAngleRadians);box2d.b2Mat22.prototype.SetSSSS=function(f,e,j,g){this.ex.SetXY(f,j);this.ey.SetXY(e,g);return this};goog.exportProperty(box2d.b2Mat22.prototype,"SetSSSS",box2d.b2Mat22.prototype.SetSSSS);box2d.b2Mat22.prototype.SetVV=function(e,d){this.ex.Copy(e);this.ey.Copy(d);return this};goog.exportProperty(box2d.b2Mat22.prototype,"SetVV",box2d.b2Mat22.prototype.SetVV);box2d.b2Mat22.prototype.SetAngle=function(e){var d=Math.cos(e);e=Math.sin(e);this.ex.SetXY(d,e);this.ey.SetXY(-e,d);return this};goog.exportProperty(box2d.b2Mat22.prototype,"SetAngle",box2d.b2Mat22.prototype.SetAngle);box2d.b2Mat22.prototype.SetAngleRadians=box2d.b2Mat22.prototype.SetAngle;box2d.b2Mat22.prototype.SetAngleDegrees=function(b){return this.SetAngle(box2d.b2DegToRad(b))};box2d.b2Mat22.prototype.Copy=function(b){this.ex.Copy(b.ex);this.ey.Copy(b.ey);return this};goog.exportProperty(box2d.b2Mat22.prototype,"Copy",box2d.b2Mat22.prototype.Copy);box2d.b2Mat22.prototype.SetIdentity=function(){this.ex.SetXY(1,0);this.ey.SetXY(0,1);return this};goog.exportProperty(box2d.b2Mat22.prototype,"SetIdentity",box2d.b2Mat22.prototype.SetIdentity);box2d.b2Mat22.prototype.SetZero=function(){this.ex.SetZero();this.ey.SetZero();return this};goog.exportProperty(box2d.b2Mat22.prototype,"SetZero",box2d.b2Mat22.prototype.SetZero);box2d.b2Mat22.prototype.GetAngle=function(){return Math.atan2(this.ex.y,this.ex.x)};goog.exportProperty(box2d.b2Mat22.prototype,"GetAngle",box2d.b2Mat22.prototype.GetAngle);box2d.b2Mat22.prototype.GetAngleRadians=box2d.b2Mat22.prototype.GetAngle;box2d.b2Mat22.prototype.GetInverse=function(j){var g=this.ex.x,q=this.ey.x,n=this.ex.y,m=this.ey.y,k=g*m-q*n;0!==k&&(k=1/k);j.ex.x=k*m;j.ey.x=-k*q;j.ex.y=-k*n;j.ey.y=k*g;return j};goog.exportProperty(box2d.b2Mat22.prototype,"GetInverse",box2d.b2Mat22.prototype.GetInverse);box2d.b2Mat22.prototype.Solve=function(k,j,u){var s=this.ex.x,r=this.ey.x,q=this.ex.y,n=this.ey.y,m=s*n-r*q;0!==m&&(m=1/m);u.x=m*(n*k-r*j);u.y=m*(s*j-q*k);return u};goog.exportProperty(box2d.b2Mat22.prototype,"Solve",box2d.b2Mat22.prototype.Solve);box2d.b2Mat22.prototype.SelfAbs=function(){this.ex.SelfAbs();this.ey.SelfAbs();return this};goog.exportProperty(box2d.b2Mat22.prototype,"SelfAbs",box2d.b2Mat22.prototype.SelfAbs);box2d.b2Mat22.prototype.SelfInv=function(){return this.GetInverse(this)};goog.exportProperty(box2d.b2Mat22.prototype,"SelfInv",box2d.b2Mat22.prototype.SelfInv);box2d.b2Mat22.prototype.SelfAddM=function(b){this.ex.SelfAdd(b.ex);this.ey.SelfAdd(b.ey);return this};goog.exportProperty(box2d.b2Mat22.prototype,"SelfAddM",box2d.b2Mat22.prototype.SelfAddM);box2d.b2Mat22.prototype.SelfSubM=function(b){this.ex.SelfSub(b.ex);this.ey.SelfSub(b.ey);return this};goog.exportProperty(box2d.b2Mat22.prototype,"SelfSubM",box2d.b2Mat22.prototype.SelfSubM);box2d.b2AbsM=function(f,e){var j=f.ex,g=f.ey;e.ex.x=box2d.b2Abs(j.x);e.ex.y=box2d.b2Abs(j.y);e.ey.x=box2d.b2Abs(g.x);e.ey.y=box2d.b2Abs(g.y);return e};goog.exportSymbol("box2d.b2AbsM",box2d.b2AbsM);box2d.b2MulMV=function(g,f,m){var k=g.ex;g=g.ey;var j=f.x;f=f.y;m.x=k.x*j+g.x*f;m.y=k.y*j+g.y*f;return m};goog.exportSymbol("box2d.b2MulMV",box2d.b2MulMV);box2d.b2MulTMV=function(g,f,m){var k=g.ex;g=g.ey;var j=f.x;f=f.y;m.x=k.x*j+k.y*f;m.y=g.x*j+g.y*f;return m};goog.exportSymbol("box2d.b2MulTMV",box2d.b2MulTMV);box2d.b2AddMM=function(g,f,m){var k=g.ex;g=g.ey;var j=f.ex;f=f.ey;m.ex.x=k.x+j.x;m.ex.y=k.y+j.y;m.ey.x=g.x+f.x;m.ey.y=g.y+f.y;return m};goog.exportSymbol("box2d.b2AddMM",box2d.b2AddMM);box2d.b2MulMM=function(v,u,s){var r=v.ex.x,q=v.ex.y,n=v.ey.x;v=v.ey.y;var m=u.ex.x,k=u.ex.y,j=u.ey.x;u=u.ey.y;s.ex.x=r*m+n*k;s.ex.y=q*m+v*k;s.ey.x=r*j+n*u;s.ey.y=q*j+v*u;return s};goog.exportSymbol("box2d.b2MulMM",box2d.b2MulMM);box2d.b2MulTMM=function(v,u,s){var r=v.ex.x,q=v.ex.y,n=v.ey.x;v=v.ey.y;var m=u.ex.x,k=u.ex.y,j=u.ey.x;u=u.ey.y;s.ex.x=r*m+q*k;s.ex.y=n*m+v*k;s.ey.x=r*j+q*u;s.ey.y=n*j+v*u;return s};goog.exportSymbol("box2d.b2MulTMM",box2d.b2MulTMM);box2d.b2Mat33=function(){this.ex=new box2d.b2Vec3(1,0,0);this.ey=new box2d.b2Vec3(0,1,0);this.ez=new box2d.b2Vec3(0,0,1)};goog.exportSymbol("box2d.b2Mat33",box2d.b2Mat33);box2d.b2Mat33.prototype.ex=null;goog.exportProperty(box2d.b2Mat33.prototype,"ex",box2d.b2Mat33.prototype.ex);box2d.b2Mat33.prototype.ey=null;goog.exportProperty(box2d.b2Mat33.prototype,"ey",box2d.b2Mat33.prototype.ey);box2d.b2Mat33.prototype.ez=null;goog.exportProperty(box2d.b2Mat33.prototype,"ez",box2d.b2Mat33.prototype.ez);box2d.b2Mat33.IDENTITY=new box2d.b2Mat33;goog.exportProperty(box2d.b2Mat33,"IDENTITY",box2d.b2Mat33.IDENTITY);box2d.b2Mat33.prototype.Clone=function(){return(new box2d.b2Mat33).Copy(this)};goog.exportProperty(box2d.b2Mat33.prototype,"Clone",box2d.b2Mat33.prototype.Clone);box2d.b2Mat33.prototype.SetVVV=function(e,d,f){this.ex.Copy(e);this.ey.Copy(d);this.ez.Copy(f);return this};goog.exportProperty(box2d.b2Mat33.prototype,"SetVVV",box2d.b2Mat33.prototype.SetVVV);box2d.b2Mat33.prototype.Copy=function(b){this.ex.Copy(b.ex);this.ey.Copy(b.ey);this.ez.Copy(b.ez);return this};goog.exportProperty(box2d.b2Mat33.prototype,"Copy",box2d.b2Mat33.prototype.Copy);box2d.b2Mat33.prototype.SetIdentity=function(){this.ex.SetXYZ(1,0,0);this.ey.SetXYZ(0,1,0);this.ez.SetXYZ(0,0,1);return this};goog.exportProperty(box2d.b2Mat33.prototype,"SetIdentity",box2d.b2Mat33.prototype.SetIdentity);box2d.b2Mat33.prototype.SetZero=function(){this.ex.SetZero();this.ey.SetZero();this.ez.SetZero();return this};goog.exportProperty(box2d.b2Mat33.prototype,"SetZero",box2d.b2Mat33.prototype.SetZero);box2d.b2Mat33.prototype.SelfAddM=function(b){this.ex.SelfAdd(b.ex);this.ey.SelfAdd(b.ey);this.ez.SelfAdd(b.ez);return this};goog.exportProperty(box2d.b2Mat33.prototype,"SelfAddM",box2d.b2Mat33.prototype.SelfAddM);box2d.b2Mat33.prototype.Solve33=function(G,F,E,D){var C=this.ex.x,B=this.ex.y,A=this.ex.z,z=this.ey.x,v=this.ey.y,y=this.ey.z,u=this.ez.x,s=this.ez.y,r=this.ez.z,j=C*(v*r-y*s)+B*(y*u-z*r)+A*(z*s-v*u);0!==j&&(j=1/j);D.x=j*(G*(v*r-y*s)+F*(y*u-z*r)+E*(z*s-v*u));D.y=j*(C*(F*r-E*s)+B*(E*u-G*r)+A*(G*s-F*u));D.z=j*(C*(v*E-y*F)+B*(y*G-z*E)+A*(z*F-v*G));return D};goog.exportProperty(box2d.b2Mat33.prototype,"Solve33",box2d.b2Mat33.prototype.Solve33);box2d.b2Mat33.prototype.Solve22=function(k,j,u){var s=this.ex.x,r=this.ey.x,q=this.ex.y,n=this.ey.y,m=s*n-r*q;0!==m&&(m=1/m);u.x=m*(n*k-r*j);u.y=m*(s*j-q*k);return u};goog.exportProperty(box2d.b2Mat33.prototype,"Solve22",box2d.b2Mat33.prototype.Solve22);box2d.b2Mat33.prototype.GetInverse22=function(j){var g=this.ex.x,q=this.ey.x,n=this.ex.y,m=this.ey.y,k=g*m-q*n;0!==k&&(k=1/k);j.ex.x=k*m;j.ey.x=-k*q;j.ex.z=0;j.ex.y=-k*n;j.ey.y=k*g;j.ey.z=0;j.ez.x=0;j.ez.y=0;j.ez.z=0};goog.exportProperty(box2d.b2Mat33.prototype,"GetInverse22",box2d.b2Mat33.prototype.GetInverse22);box2d.b2Mat33.prototype.GetSymInverse33=function(k){var j=box2d.b2DotV3V3(this.ex,box2d.b2CrossV3V3(this.ey,this.ez,box2d.b2Vec3.s_t0));0!==j&&(j=1/j);var u=this.ex.x,s=this.ey.x,r=this.ez.x,q=this.ey.y,n=this.ez.y,m=this.ez.z;k.ex.x=j*(q*m-n*n);k.ex.y=j*(r*n-s*m);k.ex.z=j*(s*n-r*q);k.ey.x=k.ex.y;k.ey.y=j*(u*m-r*r);k.ey.z=j*(r*s-u*n);k.ez.x=k.ex.z;k.ez.y=k.ey.z;k.ez.z=j*(u*q-s*s)};goog.exportProperty(box2d.b2Mat33.prototype,"GetSymInverse33",box2d.b2Mat33.prototype.GetSymInverse33);box2d.b2MulM33V3=function(g,f,m){var k=f.x,j=f.y;f=f.z;m.x=g.ex.x*k+g.ey.x*j+g.ez.x*f;m.y=g.ex.y*k+g.ey.y*j+g.ez.y*f;m.z=g.ex.z*k+g.ey.z*j+g.ez.z*f;return m};goog.exportSymbol("box2d.b2MulM33V3",box2d.b2MulM33V3);box2d.b2MulM33XYZ=function(g,f,m,k,j){j.x=g.ex.x*f+g.ey.x*m+g.ez.x*k;j.y=g.ex.y*f+g.ey.y*m+g.ez.y*k;j.z=g.ex.z*f+g.ey.z*m+g.ez.z*k;return j};goog.exportSymbol("box2d.b2MulM33XYZ",box2d.b2MulM33XYZ);box2d.b2MulM33V2=function(f,e,j){var g=e.x;e=e.y;j.x=f.ex.x*g+f.ey.x*e;j.y=f.ex.y*g+f.ey.y*e;return j};goog.exportSymbol("box2d.b2MulM33V2",box2d.b2MulM33V2);box2d.b2MulM33XY=function(f,e,j,g){g.x=f.ex.x*e+f.ey.x*j;g.y=f.ex.y*e+f.ey.y*j;return g};goog.exportSymbol("box2d.b2MulM33XY",box2d.b2MulM33XY);box2d.b2Rot=function(b){b&&(this.angle=b,this.s=Math.sin(b),this.c=Math.cos(b))};goog.exportSymbol("box2d.b2Rot",box2d.b2Rot);box2d.b2Rot.prototype.angle=0;goog.exportProperty(box2d.b2Rot.prototype,"angle",box2d.b2Rot.prototype.angle);box2d.b2Rot.prototype.s=0;goog.exportProperty(box2d.b2Rot.prototype,"s",box2d.b2Rot.prototype.s);box2d.b2Rot.prototype.c=1;goog.exportProperty(box2d.b2Rot.prototype,"c",box2d.b2Rot.prototype.c);box2d.b2Rot.IDENTITY=new box2d.b2Rot;goog.exportProperty(box2d.b2Rot,"IDENTITY",box2d.b2Rot.IDENTITY);box2d.b2Rot.prototype.Clone=function(){return(new box2d.b2Rot).Copy(this)};goog.exportProperty(box2d.b2Rot.prototype,"Clone",box2d.b2Rot.prototype.Clone);box2d.b2Rot.prototype.Copy=function(b){this.angle=b.angle;this.s=b.s;this.c=b.c;return this};goog.exportProperty(box2d.b2Rot.prototype,"Copy",box2d.b2Rot.prototype.Copy);box2d.b2Rot.prototype.SetAngle=function(b){this.angle!==b&&(this.angle=b,this.s=Math.sin(b),this.c=Math.cos(b));return this};goog.exportProperty(box2d.b2Rot.prototype,"SetAngle",box2d.b2Rot.prototype.SetAngle);box2d.b2Rot.prototype.SetAngleRadians=box2d.b2Rot.prototype.SetAngle;box2d.b2Rot.prototype.SetAngleDegrees=function(b){return this.SetAngle(box2d.b2DegToRad(b))};box2d.b2Rot.prototype.SetIdentity=function(){this.s=this.angle=0;this.c=1;return this};goog.exportProperty(box2d.b2Rot.prototype,"SetIdentity",box2d.b2Rot.prototype.SetIdentity);box2d.b2Rot.prototype.GetAngle=function(){return this.angle};goog.exportProperty(box2d.b2Rot.prototype,"GetAngle",box2d.b2Rot.prototype.GetAngle);box2d.b2Rot.prototype.GetAngleRadians=box2d.b2Rot.prototype.GetAngle;box2d.b2Rot.prototype.GetAngleDegrees=function(){return box2d.b2RadToDeg(this.GetAngle())};box2d.b2Rot.prototype.GetXAxis=function(b){b.x=this.c;b.y=this.s;return b};goog.exportProperty(box2d.b2Rot.prototype,"GetXAxis",box2d.b2Rot.prototype.GetXAxis);box2d.b2Rot.prototype.GetYAxis=function(b){b.x=-this.s;b.y=this.c;return b};goog.exportProperty(box2d.b2Rot.prototype,"GetYAxis",box2d.b2Rot.prototype.GetYAxis);box2d.b2MulRR=function(k,j,s){var r=k.c,q=k.s,n=j.c,m=j.s;s.s=q*n+r*m;s.c=r*n-q*m;for(s.angle=k.angle+j.angle;s.angle<-box2d.b2_pi;){s.angle+=box2d.b2_two_pi}for(;s.angle>=box2d.b2_pi;){s.angle-=box2d.b2_two_pi}return s};goog.exportSymbol("box2d.b2MulRR",box2d.b2MulRR);box2d.b2MulTRR=function(k,j,s){var r=k.c,q=k.s,n=j.c,m=j.s;s.s=r*m-q*n;s.c=r*n+q*m;for(s.angle=k.angle-j.angle;s.angle<-box2d.b2_pi;){s.angle+=box2d.b2_two_pi}for(;s.angle>=box2d.b2_pi;){s.angle-=box2d.b2_two_pi}return s};goog.exportSymbol("box2d.b2MulTRR",box2d.b2MulTRR);box2d.b2MulRV=function(g,f,m){var k=g.c;g=g.s;var j=f.x;f=f.y;m.x=k*j-g*f;m.y=g*j+k*f;return m};goog.exportSymbol("box2d.b2MulRV",box2d.b2MulRV);box2d.b2MulTRV=function(g,f,m){var k=g.c;g=g.s;var j=f.x;f=f.y;m.x=k*j+g*f;m.y=-g*j+k*f;return m};goog.exportSymbol("box2d.b2MulTRV",box2d.b2MulTRV);box2d.b2Transform=function(){this.p=new box2d.b2Vec2;this.q=new box2d.b2Rot};goog.exportSymbol("box2d.b2Transform",box2d.b2Transform);box2d.b2Transform.prototype.p=null;goog.exportProperty(box2d.b2Transform.prototype,"p",box2d.b2Transform.prototype.p);box2d.b2Transform.prototype.q=null;goog.exportProperty(box2d.b2Transform.prototype,"q",box2d.b2Transform.prototype.q);box2d.b2Transform.IDENTITY=new box2d.b2Transform;goog.exportProperty(box2d.b2Transform,"IDENTITY",box2d.b2Transform.IDENTITY);box2d.b2Transform.prototype.Clone=function(){return(new box2d.b2Transform).Copy(this)};goog.exportProperty(box2d.b2Transform.prototype,"Clone",box2d.b2Transform.prototype.Clone);box2d.b2Transform.prototype.Copy=function(b){this.p.Copy(b.p);this.q.Copy(b.q);return this};goog.exportProperty(box2d.b2Transform.prototype,"Copy",box2d.b2Transform.prototype.Copy);box2d.b2Transform.prototype.SetIdentity=function(){this.p.SetZero();this.q.SetIdentity();return this};goog.exportProperty(box2d.b2Transform.prototype,"SetIdentity",box2d.b2Transform.prototype.SetIdentity);box2d.b2Transform.prototype.SetPositionRotation=function(e,d){this.p.Copy(e);this.q.Copy(d);return this};goog.exportProperty(box2d.b2Transform.prototype,"SetPositionRotation",box2d.b2Transform.prototype.SetPositionRotation);box2d.b2Transform.prototype.SetPositionAngleRadians=function(e,d){this.p.Copy(e);this.q.SetAngleRadians(d);return this};goog.exportProperty(box2d.b2Transform.prototype,"SetPositionAngleRadians",box2d.b2Transform.prototype.SetPositionAngleRadians);box2d.b2Transform.prototype.SetPosition=function(b){this.p.Copy(b);return this};goog.exportProperty(box2d.b2Transform.prototype,"SetPosition",box2d.b2Transform.prototype.SetPosition);box2d.b2Transform.prototype.SetPositionXY=function(e,d){this.p.SetXY(e,d);return this};goog.exportProperty(box2d.b2Transform.prototype,"SetPositionXY",box2d.b2Transform.prototype.SetPositionXY);box2d.b2Transform.prototype.SetRotation=function(b){this.q.Copy(b);return this};goog.exportProperty(box2d.b2Transform.prototype,"SetRotation",box2d.b2Transform.prototype.SetRotation);box2d.b2Transform.prototype.SetRotationAngleRadians=function(b){this.q.SetAngleRadians(b);return this};goog.exportProperty(box2d.b2Transform.prototype,"SetRotationAngleRadians",box2d.b2Transform.prototype.SetRotationAngleRadians);box2d.b2Transform.prototype.GetPosition=function(){return this.p};goog.exportProperty(box2d.b2Transform.prototype,"GetPosition",box2d.b2Transform.prototype.GetPosition);box2d.b2Transform.prototype.GetRotation=function(){return this.q};goog.exportProperty(box2d.b2Transform.prototype,"GetRotation",box2d.b2Transform.prototype.GetRotation);box2d.b2Transform.prototype.GetRotationAngle=function(){return this.q.GetAngle()};goog.exportProperty(box2d.b2Transform.prototype,"GetRotationAngle",box2d.b2Transform.prototype.GetRotationAngle);box2d.b2Transform.prototype.GetRotationAngleRadians=box2d.b2Transform.prototype.GetRotationAngle;box2d.b2Transform.prototype.GetAngle=function(){return this.q.GetAngle()};goog.exportProperty(box2d.b2Transform.prototype,"GetAngle",box2d.b2Transform.prototype.GetAngle);box2d.b2Transform.prototype.GetAngleRadians=box2d.b2Transform.prototype.GetAngle;box2d.b2MulXV=function(j,g,q){var n=j.q.c,m=j.q.s,k=g.x;g=g.y;q.x=n*k-m*g+j.p.x;q.y=m*k+n*g+j.p.y;return q};goog.exportSymbol("box2d.b2MulXV",box2d.b2MulXV);box2d.b2MulTXV=function(j,g,q){var n=j.q.c,m=j.q.s,k=g.x-j.p.x;j=g.y-j.p.y;q.x=n*k+m*j;q.y=-m*k+n*j;return q};goog.exportSymbol("box2d.b2MulTXV",box2d.b2MulTXV);box2d.b2MulXX=function(e,d,f){box2d.b2MulRR(e.q,d.q,f.q);box2d.b2AddVV(box2d.b2MulRV(e.q,d.p,f.p),e.p,f.p);return f};goog.exportSymbol("box2d.b2MulXX",box2d.b2MulXX);box2d.b2MulTXX=function(e,d,f){box2d.b2MulTRR(e.q,d.q,f.q);box2d.b2MulTRV(e.q,box2d.b2SubVV(d.p,e.p,f.p),f.p);return f};goog.exportSymbol("box2d.b2MulTXX",box2d.b2MulTXX);box2d.b2Sweep=function(){this.localCenter=new box2d.b2Vec2;this.c0=new box2d.b2Vec2;this.c=new box2d.b2Vec2};goog.exportSymbol("box2d.b2Sweep",box2d.b2Sweep);box2d.b2Sweep.prototype.localCenter=null;goog.exportProperty(box2d.b2Sweep.prototype,"localCenter",box2d.b2Sweep.prototype.localCenter);box2d.b2Sweep.prototype.c0=null;goog.exportProperty(box2d.b2Sweep.prototype,"c0",box2d.b2Sweep.prototype.c0);box2d.b2Sweep.prototype.c=null;goog.exportProperty(box2d.b2Sweep.prototype,"c",box2d.b2Sweep.prototype.c);box2d.b2Sweep.prototype.a0=0;goog.exportProperty(box2d.b2Sweep.prototype,"a0",box2d.b2Sweep.prototype.a0);box2d.b2Sweep.prototype.a=0;goog.exportProperty(box2d.b2Sweep.prototype,"a",box2d.b2Sweep.prototype.a);box2d.b2Sweep.prototype.alpha0=0;goog.exportProperty(box2d.b2Sweep.prototype,"alpha0",box2d.b2Sweep.prototype.alpha0);box2d.b2Sweep.prototype.Clone=function(){return(new box2d.b2Sweep).Copy(this)};goog.exportProperty(box2d.b2Sweep.prototype,"Clone",box2d.b2Sweep.prototype.Clone);box2d.b2Sweep.prototype.Copy=function(b){this.localCenter.Copy(b.localCenter);this.c0.Copy(b.c0);this.c.Copy(b.c);this.a0=b.a0;this.a=b.a;this.alpha0=b.alpha0;return this};goog.exportProperty(box2d.b2Sweep.prototype,"Copy",box2d.b2Sweep.prototype.Copy);box2d.b2Sweep.prototype.GetTransform=function(e,d){var f=1-d;e.p.x=f*this.c0.x+d*this.c.x;e.p.y=f*this.c0.y+d*this.c.y;e.q.SetAngleRadians(f*this.a0+d*this.a);e.p.SelfSub(box2d.b2MulRV(e.q,this.localCenter,box2d.b2Vec2.s_t0));return e};goog.exportProperty(box2d.b2Sweep.prototype,"GetTransform",box2d.b2Sweep.prototype.GetTransform);box2d.b2Sweep.prototype.Advance=function(e){box2d.ENABLE_ASSERTS&&box2d.b2Assert(1>this.alpha0);var d=(e-this.alpha0)/(1-this.alpha0);this.c0.x+=d*(this.c.x-this.c0.x);this.c0.y+=d*(this.c.y-this.c0.y);this.a0+=d*(this.a-this.a0);this.alpha0=e};goog.exportProperty(box2d.b2Sweep.prototype,"Advance",box2d.b2Sweep.prototype.Advance);box2d.b2Sweep.prototype.Normalize=function(){var b=box2d.b2_two_pi*Math.floor(this.a0/box2d.b2_two_pi);this.a0-=b;this.a-=b};goog.exportProperty(box2d.b2Sweep.prototype,"Normalize",box2d.b2Sweep.prototype.Normalize);box2d.b2ConstantAccelController=function(){box2d.b2Controller.call(this);this.A=new box2d.b2Vec2(0,0)};goog.inherits(box2d.b2ConstantAccelController,box2d.b2Controller);goog.exportSymbol("box2d.b2ConstantAccelController",box2d.b2ConstantAccelController);box2d.b2ConstantAccelController.prototype.A=null;goog.exportProperty(box2d.b2ConstantAccelController.prototype,"A",box2d.b2ConstantAccelController.prototype.A);box2d.b2ConstantAccelController.prototype.Step=function(e){e=box2d.b2MulSV(e.dt,this.A,box2d.b2ConstantAccelController.prototype.Step.s_dtA);for(var d=this.m_bodyList;d;d=d.nextBody){var f=d.body;f.IsAwake()&&f.SetLinearVelocity(box2d.b2AddVV(f.GetLinearVelocity(),e,box2d.b2Vec2.s_t0))}};goog.exportProperty(box2d.b2ConstantAccelController.prototype,"Step",box2d.b2ConstantAccelController.prototype.Step);box2d.b2ConstantAccelController.prototype.Step.s_dtA=new box2d.b2Vec2;box2d.b2ConstantForceController=function(){box2d.b2Controller.call(this);this.F=new box2d.b2Vec2(0,0)};goog.inherits(box2d.b2ConstantForceController,box2d.b2Controller);goog.exportSymbol("box2d.b2ConstantForceController",box2d.b2ConstantForceController);box2d.b2ConstantAccelController.prototype.F=null;goog.exportProperty(box2d.b2ConstantAccelController.prototype,"F",box2d.b2ConstantAccelController.prototype.F);box2d.b2ConstantForceController.prototype.Step=function(e){for(e=this.m_bodyList;e;e=e.nextBody){var d=e.body;d.IsAwake()&&d.ApplyForce(this.F,d.GetWorldCenter())}};goog.exportProperty(box2d.b2ConstantForceController.prototype,"Step",box2d.b2ConstantForceController.prototype.Step);box2d.b2GravityController=function(){box2d.b2Controller.call(this)};goog.inherits(box2d.b2GravityController,box2d.b2Controller);goog.exportSymbol("box2d.b2GravityController",box2d.b2GravityController);box2d.b2GravityController.prototype.G=1;goog.exportProperty(box2d.b2GravityController.prototype,"G",box2d.b2GravityController.prototype.G);box2d.b2GravityController.prototype.invSqr=!0;goog.exportProperty(box2d.b2GravityController.prototype,"invSqr",box2d.b2GravityController.prototype.invSqr);box2d.b2GravityController.prototype.Step=function(B){if(this.invSqr){for(B=this.m_bodyList;B;B=B.nextBody){for(var A=B.body,z=A.GetWorldCenter(),y=A.GetMass(),v=this.m_bodyList;v!==B;v=v.nextBody){var u=v.body,s=u.GetWorldCenter(),r=u.GetMass(),n=s.x-z.x,q=s.y-z.y,j=n*n+q*q;j<box2d.b2_epsilon||(n=box2d.b2GravityController.prototype.Step.s_f.SetXY(n,q),n.SelfMul(this.G/j/box2d.b2Sqrt(j)*y*r),A.IsAwake()&&A.ApplyForce(n,z),u.IsAwake()&&u.ApplyForce(n.SelfMul(-1),s))}}}else{for(B=this.m_bodyList;B;B=B.nextBody){for(A=B.body,z=A.GetWorldCenter(),y=A.GetMass(),v=this.m_bodyList;v!==B;v=v.nextBody){u=v.body,s=u.GetWorldCenter(),r=u.GetMass(),n=s.x-z.x,q=s.y-z.y,j=n*n+q*q,j<box2d.b2_epsilon||(n=box2d.b2GravityController.prototype.Step.s_f.SetXY(n,q),n.SelfMul(this.G/j*y*r),A.IsAwake()&&A.ApplyForce(n,z),u.IsAwake()&&u.ApplyForce(n.SelfMul(-1),s))}}}};goog.exportProperty(box2d.b2GravityController.prototype,"Step",box2d.b2GravityController.prototype.Step);box2d.b2GravityController.prototype.Step.s_f=new box2d.b2Vec2;box2d.b2TensorDampingController=function(){box2d.b2Controller.call(this);this.T=new box2d.b2Mat22;this.maxTimestep=0};goog.inherits(box2d.b2TensorDampingController,box2d.b2Controller);goog.exportSymbol("box2d.b2TensorDampingController",box2d.b2TensorDampingController);box2d.b2TensorDampingController.prototype.T=new box2d.b2Mat22;goog.exportProperty(box2d.b2TensorDampingController.prototype,"T",box2d.b2TensorDampingController.prototype.T);box2d.b2TensorDampingController.prototype.maxTimestep=0;goog.exportProperty(box2d.b2TensorDampingController.prototype,"maxTimestep",box2d.b2TensorDampingController.prototype.maxTimestep);box2d.b2TensorDampingController.prototype.Step=function(f){f=f.dt;if(!(f<=box2d.b2_epsilon)){f>this.maxTimestep&&0<this.maxTimestep&&(f=this.maxTimestep);for(var e=this.m_bodyList;e;e=e.nextBody){var j=e.body;if(j.IsAwake()){var g=j.GetWorldVector(box2d.b2MulMV(this.T,j.GetLocalVector(j.GetLinearVelocity(),box2d.b2Vec2.s_t0),box2d.b2Vec2.s_t1),box2d.b2TensorDampingController.prototype.Step.s_damping);j.SetLinearVelocity(box2d.b2AddVV(j.GetLinearVelocity(),box2d.b2MulSV(f,g,box2d.b2Vec2.s_t0),box2d.b2Vec2.s_t1))}}}};box2d.b2TensorDampingController.prototype.Step.s_damping=new box2d.b2Vec2;box2d.b2TensorDampingController.prototype.SetAxisAligned=function(e,d){this.T.ex.x=-e;this.T.ex.y=0;this.T.ey.x=0;this.T.ey.y=-d;this.maxTimestep=0<e||0<d?1/box2d.b2Max(e,d):0};box2d.b2DistanceProxy=function(){this.m_buffer=box2d.b2Vec2.MakeArray(2)};goog.exportSymbol("box2d.b2DistanceProxy",box2d.b2DistanceProxy);box2d.b2DistanceProxy.prototype.m_buffer=null;goog.exportProperty(box2d.b2DistanceProxy.prototype,"m_buffer",box2d.b2DistanceProxy.prototype.m_buffer);box2d.b2DistanceProxy.prototype.m_vertices=null;goog.exportProperty(box2d.b2DistanceProxy.prototype,"m_vertices",box2d.b2DistanceProxy.prototype.m_vertices);box2d.b2DistanceProxy.prototype.m_count=0;goog.exportProperty(box2d.b2DistanceProxy.prototype,"m_count",box2d.b2DistanceProxy.prototype.m_count);box2d.b2DistanceProxy.prototype.m_radius=0;goog.exportProperty(box2d.b2DistanceProxy.prototype,"m_radius",box2d.b2DistanceProxy.prototype.m_radius);box2d.b2DistanceProxy.prototype.Reset=function(){this.m_vertices=null;this.m_radius=this.m_count=0;return this};goog.exportProperty(box2d.b2DistanceProxy.prototype,"Reset",box2d.b2DistanceProxy.prototype.Reset);box2d.b2DistanceProxy.prototype.SetShape=function(e,d){e.SetupDistanceProxy(this,d)};goog.exportProperty(box2d.b2DistanceProxy.prototype,"SetShape",box2d.b2DistanceProxy.prototype.SetShape);box2d.b2DistanceProxy.prototype.GetSupport=function(g){for(var f=0,m=box2d.b2DotVV(this.m_vertices[0],g),k=1;k<this.m_count;++k){var j=box2d.b2DotVV(this.m_vertices[k],g);j>m&&(f=k,m=j)}return f};goog.exportProperty(box2d.b2DistanceProxy.prototype,"GetSupport",box2d.b2DistanceProxy.prototype.GetSupport);box2d.b2DistanceProxy.prototype.GetSupportVertex=function(j,g){for(var q=0,n=box2d.b2DotVV(this.m_vertices[0],j),m=1;m<this.m_count;++m){var k=box2d.b2DotVV(this.m_vertices[m],j);k>n&&(q=m,n=k)}return g.Copy(this.m_vertices[q])};goog.exportProperty(box2d.b2DistanceProxy.prototype,"GetSupportVertex",box2d.b2DistanceProxy.prototype.GetSupportVertex);box2d.b2DistanceProxy.prototype.GetVertexCount=function(){return this.m_count};goog.exportProperty(box2d.b2DistanceProxy.prototype,"GetVertexCount",box2d.b2DistanceProxy.prototype.GetVertexCount);box2d.b2DistanceProxy.prototype.GetVertex=function(b){box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<=b&&b<this.m_count);return this.m_vertices[b]};goog.exportProperty(box2d.b2DistanceProxy.prototype,"GetVertex",box2d.b2DistanceProxy.prototype.GetVertex);box2d.b2SimplexCache=function(){this.indexA=box2d.b2MakeNumberArray(3);this.indexB=box2d.b2MakeNumberArray(3)};goog.exportSymbol("box2d.b2SimplexCache",box2d.b2SimplexCache);box2d.b2SimplexCache.prototype.metric=0;goog.exportProperty(box2d.b2SimplexCache.prototype,"metric",box2d.b2SimplexCache.prototype.metric);box2d.b2SimplexCache.prototype.count=0;goog.exportProperty(box2d.b2SimplexCache.prototype,"count",box2d.b2SimplexCache.prototype.count);box2d.b2SimplexCache.prototype.indexA=null;goog.exportProperty(box2d.b2SimplexCache.prototype,"indexA",box2d.b2SimplexCache.prototype.indexA);box2d.b2SimplexCache.prototype.indexB=null;goog.exportProperty(box2d.b2SimplexCache.prototype,"indexB",box2d.b2SimplexCache.prototype.indexB);box2d.b2SimplexCache.prototype.Reset=function(){this.count=this.metric=0;return this};goog.exportProperty(box2d.b2SimplexCache.prototype,"Reset",box2d.b2SimplexCache.prototype.Reset);box2d.b2DistanceInput=function(){this.proxyA=new box2d.b2DistanceProxy;this.proxyB=new box2d.b2DistanceProxy;this.transformA=new box2d.b2Transform;this.transformB=new box2d.b2Transform};goog.exportSymbol("box2d.b2DistanceInput",box2d.b2DistanceInput);box2d.b2DistanceInput.prototype.proxyA=null;goog.exportProperty(box2d.b2DistanceInput.prototype,"proxyA",box2d.b2DistanceInput.prototype.proxyA);box2d.b2DistanceInput.prototype.proxyB=null;goog.exportProperty(box2d.b2DistanceInput.prototype,"proxyB",box2d.b2DistanceInput.prototype.proxyB);box2d.b2DistanceInput.prototype.transformA=null;goog.exportProperty(box2d.b2DistanceInput.prototype,"transformA",box2d.b2DistanceInput.prototype.transformA);box2d.b2DistanceInput.prototype.transformB=null;goog.exportProperty(box2d.b2DistanceInput.prototype,"transformB",box2d.b2DistanceInput.prototype.transformB);box2d.b2DistanceInput.prototype.useRadii=!1;goog.exportProperty(box2d.b2DistanceInput.prototype,"useRadii",box2d.b2DistanceInput.prototype.useRadii);box2d.b2DistanceInput.prototype.Reset=function(){this.proxyA.Reset();this.proxyB.Reset();this.transformA.SetIdentity();this.transformB.SetIdentity();this.useRadii=!1;return this};goog.exportProperty(box2d.b2DistanceInput.prototype,"Reset",box2d.b2DistanceInput.prototype.Reset);box2d.b2DistanceOutput=function(){this.pointA=new box2d.b2Vec2;this.pointB=new box2d.b2Vec2};goog.exportSymbol("box2d.b2DistanceOutput",box2d.b2DistanceOutput);box2d.b2DistanceOutput.prototype.pointA=null;goog.exportProperty(box2d.b2DistanceOutput.prototype,"pointA",box2d.b2DistanceOutput.prototype.pointA);box2d.b2DistanceOutput.prototype.pointB=null;goog.exportProperty(box2d.b2DistanceOutput.prototype,"pointB",box2d.b2DistanceOutput.prototype.pointB);box2d.b2DistanceOutput.prototype.distance=0;goog.exportProperty(box2d.b2DistanceOutput.prototype,"distance",box2d.b2DistanceOutput.prototype.distance);box2d.b2DistanceOutput.prototype.iterations=0;goog.exportProperty(box2d.b2DistanceOutput.prototype,"iterations",box2d.b2DistanceOutput.prototype.iterations);box2d.b2DistanceOutput.prototype.Reset=function(){this.pointA.SetZero();this.pointB.SetZero();this.iterations=this.distance=0;return this};goog.exportProperty(box2d.b2DistanceOutput.prototype,"Reset",box2d.b2DistanceOutput.prototype.Reset);box2d.b2_gjkCalls=0;goog.exportSymbol("box2d.b2_gjkCalls",box2d.b2_gjkCalls);box2d.b2_gjkIters=0;goog.exportSymbol("box2d.b2_gjkIters",box2d.b2_gjkIters);box2d.b2_gjkMaxIters=0;goog.exportSymbol("box2d.b2_gjkMaxIters",box2d.b2_gjkMaxIters);box2d.b2SimplexVertex=function(){this.wA=new box2d.b2Vec2;this.wB=new box2d.b2Vec2;this.w=new box2d.b2Vec2};goog.exportSymbol("box2d.b2SimplexVertex",box2d.b2SimplexVertex);box2d.b2SimplexVertex.prototype.wA=null;goog.exportProperty(box2d.b2SimplexVertex.prototype,"wA",box2d.b2SimplexVertex.prototype.wA);box2d.b2SimplexVertex.prototype.wB=null;goog.exportProperty(box2d.b2SimplexVertex.prototype,"wB",box2d.b2SimplexVertex.prototype.wB);box2d.b2SimplexVertex.prototype.w=null;goog.exportProperty(box2d.b2SimplexVertex.prototype,"w",box2d.b2SimplexVertex.prototype.w);box2d.b2SimplexVertex.prototype.a=0;goog.exportProperty(box2d.b2SimplexVertex.prototype,"a",box2d.b2SimplexVertex.prototype.a);box2d.b2SimplexVertex.prototype.indexA=0;goog.exportProperty(box2d.b2SimplexVertex.prototype,"indexA",box2d.b2SimplexVertex.prototype.indexA);box2d.b2SimplexVertex.prototype.indexB=0;goog.exportProperty(box2d.b2SimplexVertex.prototype,"indexB",box2d.b2SimplexVertex.prototype.indexB);box2d.b2SimplexVertex.prototype.Copy=function(b){this.wA.Copy(b.wA);this.wB.Copy(b.wB);this.w.Copy(b.w);this.a=b.a;this.indexA=b.indexA;this.indexB=b.indexB;return this};goog.exportProperty(box2d.b2SimplexVertex.prototype,"Copy",box2d.b2SimplexVertex.prototype.Copy);box2d.b2Simplex=function(){this.m_v1=new box2d.b2SimplexVertex;this.m_v2=new box2d.b2SimplexVertex;this.m_v3=new box2d.b2SimplexVertex;this.m_vertices=Array(3);this.m_vertices[0]=this.m_v1;this.m_vertices[1]=this.m_v2;this.m_vertices[2]=this.m_v3};goog.exportSymbol("box2d.b2Simplex",box2d.b2Simplex);box2d.b2Simplex.prototype.m_v1=null;goog.exportProperty(box2d.b2Simplex.prototype,"m_v1",box2d.b2Simplex.prototype.m_v1);box2d.b2Simplex.prototype.m_v2=null;goog.exportProperty(box2d.b2Simplex.prototype,"m_v2",box2d.b2Simplex.prototype.m_v2);box2d.b2Simplex.prototype.m_v3=null;goog.exportProperty(box2d.b2Simplex.prototype,"m_v3",box2d.b2Simplex.prototype.m_v3);box2d.b2Simplex.prototype.m_vertices=null;goog.exportProperty(box2d.b2Simplex.prototype,"m_vertices",box2d.b2Simplex.prototype.m_vertices);box2d.b2Simplex.prototype.m_count=0;goog.exportProperty(box2d.b2Simplex.prototype,"m_count",box2d.b2Simplex.prototype.m_count);box2d.b2Simplex.prototype.ReadCache=function(z,y,v,u,s){box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<=z.count&&3>=z.count);this.m_count=z.count;for(var r=this.m_vertices,q=0;q<this.m_count;++q){var n=r[q];n.indexA=z.indexA[q];n.indexB=z.indexB[q];var j=y.GetVertex(n.indexA),m=u.GetVertex(n.indexB);box2d.b2MulXV(v,j,n.wA);box2d.b2MulXV(s,m,n.wB);box2d.b2SubVV(n.wB,n.wA,n.w);n.a=0}1<this.m_count&&(z=z.metric,q=this.GetMetric(),q<0.5*z||2*z<q||q<box2d.b2_epsilon)&&(this.m_count=0);0===this.m_count&&(n=r[0],n.indexA=0,n.indexB=0,j=y.GetVertex(0),m=u.GetVertex(0),box2d.b2MulXV(v,j,n.wA),box2d.b2MulXV(s,m,n.wB),box2d.b2SubVV(n.wB,n.wA,n.w),this.m_count=n.a=1)};goog.exportProperty(box2d.b2Simplex.prototype,"ReadCache",box2d.b2Simplex.prototype.ReadCache);box2d.b2Simplex.prototype.WriteCache=function(e){e.metric=this.GetMetric();e.count=this.m_count;for(var d=this.m_vertices,f=0;f<this.m_count;++f){e.indexA[f]=d[f].indexA,e.indexB[f]=d[f].indexB}};goog.exportProperty(box2d.b2Simplex.prototype,"WriteCache",box2d.b2Simplex.prototype.WriteCache);box2d.b2Simplex.prototype.GetSearchDirection=function(e){switch(this.m_count){case 1:return box2d.b2NegV(this.m_v1.w,e);case 2:var d=box2d.b2SubVV(this.m_v2.w,this.m_v1.w,e);return 0<box2d.b2CrossVV(d,box2d.b2NegV(this.m_v1.w,box2d.b2Vec2.s_t0))?box2d.b2CrossOneV(d,e):box2d.b2CrossVOne(d,e);default:return box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1),e.SetZero()}};goog.exportProperty(box2d.b2Simplex.prototype,"GetSearchDirection",box2d.b2Simplex.prototype.GetSearchDirection);box2d.b2Simplex.prototype.GetClosestPoint=function(b){switch(this.m_count){case 0:return box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1),b.SetZero();case 1:return b.Copy(this.m_v1.w);case 2:return b.SetXY(this.m_v1.a*this.m_v1.w.x+this.m_v2.a*this.m_v2.w.x,this.m_v1.a*this.m_v1.w.y+this.m_v2.a*this.m_v2.w.y);case 3:return b.SetZero();default:return box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1),b.SetZero()}};goog.exportProperty(box2d.b2Simplex.prototype,"GetClosestPoint",box2d.b2Simplex.prototype.GetClosestPoint);box2d.b2Simplex.prototype.GetWitnessPoints=function(e,d){switch(this.m_count){case 0:box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1);break;case 1:e.Copy(this.m_v1.wA);d.Copy(this.m_v1.wB);break;case 2:e.x=this.m_v1.a*this.m_v1.wA.x+this.m_v2.a*this.m_v2.wA.x;e.y=this.m_v1.a*this.m_v1.wA.y+this.m_v2.a*this.m_v2.wA.y;d.x=this.m_v1.a*this.m_v1.wB.x+this.m_v2.a*this.m_v2.wB.x;d.y=this.m_v1.a*this.m_v1.wB.y+this.m_v2.a*this.m_v2.wB.y;break;case 3:d.x=e.x=this.m_v1.a*this.m_v1.wA.x+this.m_v2.a*this.m_v2.wA.x+this.m_v3.a*this.m_v3.wA.x;d.y=e.y=this.m_v1.a*this.m_v1.wA.y+this.m_v2.a*this.m_v2.wA.y+this.m_v3.a*this.m_v3.wA.y;break;default:box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1)}};goog.exportProperty(box2d.b2Simplex.prototype,"GetWitnessPoints",box2d.b2Simplex.prototype.GetWitnessPoints);box2d.b2Simplex.prototype.GetMetric=function(){switch(this.m_count){case 0:return box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1),0;case 1:return 0;case 2:return box2d.b2DistanceVV(this.m_v1.w,this.m_v2.w);case 3:return box2d.b2CrossVV(box2d.b2SubVV(this.m_v2.w,this.m_v1.w,box2d.b2Vec2.s_t0),box2d.b2SubVV(this.m_v3.w,this.m_v1.w,box2d.b2Vec2.s_t1));default:return box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1),0}};goog.exportProperty(box2d.b2Simplex.prototype,"GetMetric",box2d.b2Simplex.prototype.GetMetric);box2d.b2Simplex.prototype.Solve2=function(){var e=this.m_v1.w,d=this.m_v2.w,f=box2d.b2SubVV(d,e,box2d.b2Simplex.s_e12),e=-box2d.b2DotVV(e,f);0>=e?this.m_count=this.m_v1.a=1:(d=box2d.b2DotVV(d,f),0>=d?(this.m_count=this.m_v2.a=1,this.m_v1.Copy(this.m_v2)):(f=1/(d+e),this.m_v1.a=d*f,this.m_v2.a=e*f,this.m_count=2))};goog.exportProperty(box2d.b2Simplex.prototype,"Solve2",box2d.b2Simplex.prototype.Solve2);box2d.b2Simplex.prototype.Solve3=function(){var B=this.m_v1.w,A=this.m_v2.w,z=this.m_v3.w,y=box2d.b2SubVV(A,B,box2d.b2Simplex.s_e12),v=box2d.b2DotVV(B,y),u=box2d.b2DotVV(A,y),v=-v,s=box2d.b2SubVV(z,B,box2d.b2Simplex.s_e13),r=box2d.b2DotVV(B,s),n=box2d.b2DotVV(z,s),r=-r,q=box2d.b2SubVV(z,A,box2d.b2Simplex.s_e23),j=box2d.b2DotVV(A,q),q=box2d.b2DotVV(z,q),j=-j,s=box2d.b2CrossVV(y,s),y=s*box2d.b2CrossVV(A,z),z=s*box2d.b2CrossVV(z,B),B=s*box2d.b2CrossVV(B,A);0>=v&&0>=r?this.m_count=this.m_v1.a=1:0<u&&0<v&&0>=B?(n=1/(u+v),this.m_v1.a=u*n,this.m_v2.a=v*n,this.m_count=2):0<n&&0<r&&0>=z?(u=1/(n+r),this.m_v1.a=n*u,this.m_v3.a=r*u,this.m_count=2,this.m_v2.Copy(this.m_v3)):0>=u&&0>=j?(this.m_count=this.m_v2.a=1,this.m_v1.Copy(this.m_v2)):0>=n&&0>=q?(this.m_count=this.m_v3.a=1,this.m_v1.Copy(this.m_v3)):0<q&&0<j&&0>=y?(u=1/(q+j),this.m_v2.a=q*u,this.m_v3.a=j*u,this.m_count=2,this.m_v1.Copy(this.m_v3)):(u=1/(y+z+B),this.m_v1.a=y*u,this.m_v2.a=z*u,this.m_v3.a=B*u,this.m_count=3)};goog.exportProperty(box2d.b2Simplex.prototype,"Solve3",box2d.b2Simplex.prototype.Solve3);box2d.b2Simplex.s_e12=new box2d.b2Vec2;box2d.b2Simplex.s_e13=new box2d.b2Vec2;box2d.b2Simplex.s_e23=new box2d.b2Vec2;box2d.b2Distance=function(I,H,G){++box2d.b2_gjkCalls;var F=G.proxyA,E=G.proxyB,D=G.transformA,C=G.transformB,B=box2d.b2Distance.s_simplex;B.ReadCache(H,F,D,E,C);for(var z=B.m_vertices,A=box2d.b2Distance.s_saveA,y=box2d.b2Distance.s_saveB,v=0,u=0;20>u;){for(var v=B.m_count,s=0;s<v;++s){A[s]=z[s].indexA,y[s]=z[s].indexB}switch(B.m_count){case 1:break;case 2:B.Solve2();break;case 3:B.Solve3();break;default:box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1)}if(3===B.m_count){break}var j=B.GetClosestPoint(box2d.b2Distance.s_p);j.GetLengthSquared();s=B.GetSearchDirection(box2d.b2Distance.s_d);if(s.GetLengthSquared()<box2d.b2_epsilon_sq){break}j=z[B.m_count];j.indexA=F.GetSupport(box2d.b2MulTRV(D.q,box2d.b2NegV(s,box2d.b2Vec2.s_t0),box2d.b2Distance.s_supportA));box2d.b2MulXV(D,F.GetVertex(j.indexA),j.wA);j.indexB=E.GetSupport(box2d.b2MulTRV(C.q,s,box2d.b2Distance.s_supportB));box2d.b2MulXV(C,E.GetVertex(j.indexB),j.wB);box2d.b2SubVV(j.wB,j.wA,j.w);++u;++box2d.b2_gjkIters;for(var J=!1,s=0;s<v;++s){if(j.indexA===A[s]&&j.indexB===y[s]){J=!0;break}}if(J){break}++B.m_count}box2d.b2_gjkMaxIters=box2d.b2Max(box2d.b2_gjkMaxIters,u);B.GetWitnessPoints(I.pointA,I.pointB);I.distance=box2d.b2DistanceVV(I.pointA,I.pointB);I.iterations=u;B.WriteCache(H);G.useRadii&&(H=F.m_radius,E=E.m_radius,I.distance>H+E&&I.distance>box2d.b2_epsilon?(I.distance-=H+E,G=box2d.b2SubVV(I.pointB,I.pointA,box2d.b2Distance.s_normal),G.Normalize(),I.pointA.SelfMulAdd(H,G),I.pointB.SelfMulSub(E,G)):(j=box2d.b2MidVV(I.pointA,I.pointB,box2d.b2Distance.s_p),I.pointA.Copy(j),I.pointB.Copy(j),I.distance=0))};goog.exportSymbol("box2d.b2Distance",box2d.b2Distance);box2d.b2Distance.s_simplex=new box2d.b2Simplex;box2d.b2Distance.s_saveA=box2d.b2MakeNumberArray(3);box2d.b2Distance.s_saveB=box2d.b2MakeNumberArray(3);box2d.b2Distance.s_p=new box2d.b2Vec2;box2d.b2Distance.s_d=new box2d.b2Vec2;box2d.b2Distance.s_normal=new box2d.b2Vec2;box2d.b2Distance.s_supportA=new box2d.b2Vec2;box2d.b2Distance.s_supportB=new box2d.b2Vec2;box2d.b2Collision={};box2d.b2ContactFeatureType={e_vertex:0,e_face:1};goog.exportSymbol("box2d.b2ContactFeatureType",box2d.b2ContactFeatureType);goog.exportProperty(box2d.b2ContactFeatureType,"e_vertex",box2d.b2ContactFeatureType.e_vertex);goog.exportProperty(box2d.b2ContactFeatureType,"e_face",box2d.b2ContactFeatureType.e_face);box2d.b2ContactFeature=function(b){this._id=b};goog.exportSymbol("box2d.b2ContactFeature",box2d.b2ContactFeature);box2d.b2ContactFeature.prototype._id=null;goog.exportProperty(box2d.b2ContactFeature.prototype,"_id",box2d.b2ContactFeature.prototype._id);box2d.b2ContactFeature.prototype._indexA=0;goog.exportProperty(box2d.b2ContactFeature.prototype,"_indexA",box2d.b2ContactFeature.prototype._indexA);box2d.b2ContactFeature.prototype._indexB=0;goog.exportProperty(box2d.b2ContactFeature.prototype,"_indexB",box2d.b2ContactFeature.prototype._indexB);box2d.b2ContactFeature.prototype._typeA=0;goog.exportProperty(box2d.b2ContactFeature.prototype,"_typeA",box2d.b2ContactFeature.prototype._typeA);box2d.b2ContactFeature.prototype._typeB=0;goog.exportProperty(box2d.b2ContactFeature.prototype,"_typeB",box2d.b2ContactFeature.prototype._typeB);Object.defineProperty(box2d.b2ContactFeature.prototype,"indexA",{enumerable:!1,configurable:!0,get:function(){return this._indexA},set:function(b){this._indexA=b;this._id._key=this._id._key&4294967040|this._indexA&255}});Object.defineProperty(box2d.b2ContactFeature.prototype,"indexB",{enumerable:!1,configurable:!0,get:function(){return this._indexB},set:function(b){this._indexB=b;this._id._key=this._id._key&4294902015|this._indexB<<8&65280}});Object.defineProperty(box2d.b2ContactFeature.prototype,"typeA",{enumerable:!1,configurable:!0,get:function(){return this._typeA},set:function(b){this._typeA=b;this._id._key=this._id._key&4278255615|this._typeA<<16&16711680}});Object.defineProperty(box2d.b2ContactFeature.prototype,"typeB",{enumerable:!1,configurable:!0,get:function(){return this._typeB},set:function(b){this._typeB=b;this._id._key=this._id._key&16777215|this._typeB<<24&4278190080}});box2d.b2ContactID=function(){this.cf=new box2d.b2ContactFeature(this)};goog.exportSymbol("box2d.b2ContactID",box2d.b2ContactID);box2d.b2ContactID.prototype.cf=null;goog.exportProperty(box2d.b2ContactID.prototype,"cf",box2d.b2ContactID.prototype.cf);box2d.b2ContactID.prototype.key=0;goog.exportProperty(box2d.b2ContactID.prototype,"key",box2d.b2ContactID.prototype.key);box2d.b2ContactID.prototype.Copy=function(b){this.key=b.key;return this};goog.exportProperty(box2d.b2ContactID.prototype,"Copy",box2d.b2ContactID.prototype.Copy);box2d.b2ContactID.prototype.Clone=function(){return(new box2d.b2ContactID).Copy(this)};goog.exportProperty(box2d.b2ContactID.prototype,"Clone",box2d.b2ContactID.prototype.Clone);Object.defineProperty(box2d.b2ContactID.prototype,"key",{enumerable:!1,configurable:!0,get:function(){return this._key},set:function(b){this._key=b;this.cf._indexA=this._key&255;this.cf._indexB=this._key>>8&255;this.cf._typeA=this._key>>16&255;this.cf._typeB=this._key>>24&255}});box2d.b2ManifoldPoint=function(){this.localPoint=new box2d.b2Vec2;this.id=new box2d.b2ContactID};goog.exportSymbol("box2d.b2ManifoldPoint",box2d.b2ManifoldPoint);box2d.b2ManifoldPoint.prototype.localPoint=null;goog.exportProperty(box2d.b2ManifoldPoint.prototype,"localPoint",box2d.b2ManifoldPoint.prototype.localPoint);box2d.b2ManifoldPoint.prototype.normalImpulse=0;goog.exportProperty(box2d.b2ManifoldPoint.prototype,"normalImpulse",box2d.b2ManifoldPoint.prototype.normalImpulse);box2d.b2ManifoldPoint.prototype.tangentImpulse=0;goog.exportProperty(box2d.b2ManifoldPoint.prototype,"tangentImpulse",box2d.b2ManifoldPoint.prototype.tangentImpulse);box2d.b2ManifoldPoint.prototype.id=null;goog.exportProperty(box2d.b2ManifoldPoint.prototype,"id",box2d.b2ManifoldPoint.prototype.id);box2d.b2ManifoldPoint.MakeArray=function(b){return box2d.b2MakeArray(b,function(d){return new box2d.b2ManifoldPoint})};goog.exportProperty(box2d.b2ManifoldPoint,"MakeArray",box2d.b2ManifoldPoint.MakeArray);box2d.b2ManifoldPoint.prototype.Reset=function(){this.localPoint.SetZero();this.tangentImpulse=this.normalImpulse=0;this.id.key=0};goog.exportProperty(box2d.b2ManifoldPoint.prototype,"Reset",box2d.b2ManifoldPoint.prototype.Reset);box2d.b2ManifoldPoint.prototype.Copy=function(b){this.localPoint.Copy(b.localPoint);this.normalImpulse=b.normalImpulse;this.tangentImpulse=b.tangentImpulse;this.id.Copy(b.id);return this};goog.exportProperty(box2d.b2ManifoldPoint.prototype,"Copy",box2d.b2ManifoldPoint.prototype.Copy);box2d.b2ManifoldType={e_unknown:-1,e_circles:0,e_faceA:1,e_faceB:2};goog.exportSymbol("box2d.b2ManifoldType",box2d.b2ManifoldType);goog.exportProperty(box2d.b2ManifoldType,"e_unknown",box2d.b2ManifoldType.e_unknown);goog.exportProperty(box2d.b2ManifoldType,"e_circles",box2d.b2ManifoldType.e_circles);goog.exportProperty(box2d.b2ManifoldType,"e_faceA",box2d.b2ManifoldType.e_faceA);goog.exportProperty(box2d.b2ManifoldType,"e_faceB",box2d.b2ManifoldType.e_faceB);box2d.b2Manifold=function(){this.points=box2d.b2ManifoldPoint.MakeArray(box2d.b2_maxManifoldPoints);this.localNormal=new box2d.b2Vec2;this.localPoint=new box2d.b2Vec2;this.type=box2d.b2ManifoldType.e_unknown;this.pointCount=0};goog.exportSymbol("box2d.b2Manifold",box2d.b2Manifold);box2d.b2Manifold.prototype.points=null;goog.exportProperty(box2d.b2Manifold.prototype,"points",box2d.b2Manifold.prototype.points);box2d.b2Manifold.prototype.localNormal=null;goog.exportProperty(box2d.b2Manifold.prototype,"localNormal",box2d.b2Manifold.prototype.localNormal);box2d.b2Manifold.prototype.localPoint=null;goog.exportProperty(box2d.b2Manifold.prototype,"localPoint",box2d.b2Manifold.prototype.localPoint);box2d.b2Manifold.prototype.type=box2d.b2ManifoldType.e_unknown;goog.exportProperty(box2d.b2Manifold.prototype,"type",box2d.b2Manifold.prototype.type);box2d.b2Manifold.prototype.pointCount=0;goog.exportProperty(box2d.b2Manifold.prototype,"pointCount",box2d.b2Manifold.prototype.pointCount);box2d.b2Manifold.prototype.Reset=function(){for(var e=0,d=box2d.b2_maxManifoldPoints;e<d;++e){this.points[e].Reset()}this.localNormal.SetZero();this.localPoint.SetZero();this.type=box2d.b2ManifoldType.e_unknown;this.pointCount=0};goog.exportProperty(box2d.b2Manifold.prototype,"Reset",box2d.b2Manifold.prototype.Reset);box2d.b2Manifold.prototype.Copy=function(e){this.pointCount=e.pointCount;for(var d=0,f=box2d.b2_maxManifoldPoints;d<f;++d){this.points[d].Copy(e.points[d])}this.localNormal.Copy(e.localNormal);this.localPoint.Copy(e.localPoint);this.type=e.type;return this};goog.exportProperty(box2d.b2Manifold.prototype,"Copy",box2d.b2Manifold.prototype.Copy);box2d.b2Manifold.prototype.Clone=function(){return(new box2d.b2Manifold).Copy(this)};goog.exportProperty(box2d.b2Manifold.prototype,"Clone",box2d.b2Manifold.prototype.Clone);box2d.b2WorldManifold=function(){this.normal=new box2d.b2Vec2;this.points=box2d.b2Vec2.MakeArray(box2d.b2_maxManifoldPoints);this.separations=box2d.b2MakeNumberArray(box2d.b2_maxManifoldPoints)};goog.exportSymbol("box2d.b2WorldManifold",box2d.b2WorldManifold);box2d.b2WorldManifold.prototype.normal=null;goog.exportProperty(box2d.b2WorldManifold.prototype,"normal",box2d.b2WorldManifold.prototype.normal);box2d.b2WorldManifold.prototype.points=null;goog.exportProperty(box2d.b2WorldManifold.prototype,"points",box2d.b2WorldManifold.prototype.points);box2d.b2WorldManifold.prototype.separations=null;goog.exportProperty(box2d.b2WorldManifold.prototype,"separations",box2d.b2WorldManifold.prototype.separations);box2d.b2WorldManifold.prototype.Initialize=function(B,A,z,y,v){if(0!==B.pointCount){switch(B.type){case box2d.b2ManifoldType.e_circles:this.normal.SetXY(1,0);A=box2d.b2MulXV(A,B.localPoint,box2d.b2WorldManifold.prototype.Initialize.s_pointA);B=box2d.b2MulXV(y,B.points[0].localPoint,box2d.b2WorldManifold.prototype.Initialize.s_pointB);box2d.b2DistanceSquaredVV(A,B)>box2d.b2_epsilon_sq&&box2d.b2SubVV(B,A,this.normal).SelfNormalize();var u=box2d.b2AddVMulSV(A,z,this.normal,box2d.b2WorldManifold.prototype.Initialize.s_cA),s=box2d.b2SubVMulSV(B,v,this.normal,box2d.b2WorldManifold.prototype.Initialize.s_cB);box2d.b2MidVV(u,s,this.points[0]);this.separations[0]=box2d.b2DotVV(box2d.b2SubVV(s,u,box2d.b2Vec2.s_t0),this.normal);break;case box2d.b2ManifoldType.e_faceA:box2d.b2MulRV(A.q,B.localNormal,this.normal);for(var r=box2d.b2MulXV(A,B.localPoint,box2d.b2WorldManifold.prototype.Initialize.s_planePoint),n=0,q=B.pointCount;n<q;++n){var j=box2d.b2MulXV(y,B.points[n].localPoint,box2d.b2WorldManifold.prototype.Initialize.s_clipPoint),u=z-box2d.b2DotVV(box2d.b2SubVV(j,r,box2d.b2Vec2.s_t0),this.normal),u=box2d.b2AddVMulSV(j,u,this.normal,box2d.b2WorldManifold.prototype.Initialize.s_cA),s=box2d.b2SubVMulSV(j,v,this.normal,box2d.b2WorldManifold.prototype.Initialize.s_cB);box2d.b2MidVV(u,s,this.points[n]);this.separations[n]=box2d.b2DotVV(box2d.b2SubVV(s,u,box2d.b2Vec2.s_t0),this.normal)}break;case box2d.b2ManifoldType.e_faceB:box2d.b2MulRV(y.q,B.localNormal,this.normal);r=box2d.b2MulXV(y,B.localPoint,box2d.b2WorldManifold.prototype.Initialize.s_planePoint);n=0;for(q=B.pointCount;n<q;++n){j=box2d.b2MulXV(A,B.points[n].localPoint,box2d.b2WorldManifold.prototype.Initialize.s_clipPoint),u=v-box2d.b2DotVV(box2d.b2SubVV(j,r,box2d.b2Vec2.s_t0),this.normal),s=box2d.b2AddVMulSV(j,u,this.normal,box2d.b2WorldManifold.prototype.Initialize.s_cB),u=box2d.b2SubVMulSV(j,z,this.normal,box2d.b2WorldManifold.prototype.Initialize.s_cA),box2d.b2MidVV(u,s,this.points[n]),this.separations[n]=box2d.b2DotVV(box2d.b2SubVV(u,s,box2d.b2Vec2.s_t0),this.normal)}this.normal.SelfNeg()}}};goog.exportProperty(box2d.b2WorldManifold.prototype,"Initialize",box2d.b2WorldManifold.prototype.Initialize);box2d.b2WorldManifold.prototype.Initialize.s_pointA=new box2d.b2Vec2;box2d.b2WorldManifold.prototype.Initialize.s_pointB=new box2d.b2Vec2;box2d.b2WorldManifold.prototype.Initialize.s_cA=new box2d.b2Vec2;box2d.b2WorldManifold.prototype.Initialize.s_cB=new box2d.b2Vec2;box2d.b2WorldManifold.prototype.Initialize.s_planePoint=new box2d.b2Vec2;box2d.b2WorldManifold.prototype.Initialize.s_clipPoint=new box2d.b2Vec2;box2d.b2PointState={b2_nullState:0,b2_addState:1,b2_persistState:2,b2_removeState:3};goog.exportSymbol("box2d.b2PointState",box2d.b2PointState);goog.exportProperty(box2d.b2PointState,"b2_nullState   ",box2d.b2PointState.b2_nullState);goog.exportProperty(box2d.b2PointState,"b2_addState    ",box2d.b2PointState.b2_addState);goog.exportProperty(box2d.b2PointState,"b2_persistState",box2d.b2PointState.b2_persistState);goog.exportProperty(box2d.b2PointState,"b2_removeState ",box2d.b2PointState.b2_removeState);box2d.b2GetPointStates=function(v,u,s,r){for(var q=0,n=s.pointCount;q<n;++q){var m=s.points[q].id,m=m.key;v[q]=box2d.b2PointState.b2_removeState;for(var k=0,j=r.pointCount;k<j;++k){if(r.points[k].id.key===m){v[q]=box2d.b2PointState.b2_persistState;break}}}for(n=box2d.b2_maxManifoldPoints;q<n;++q){v[q]=box2d.b2PointState.b2_nullState}q=0;for(n=r.pointCount;q<n;++q){for(m=r.points[q].id,m=m.key,u[q]=box2d.b2PointState.b2_addState,k=0,j=s.pointCount;k<j;++k){if(s.points[k].id.key===m){u[q]=box2d.b2PointState.b2_persistState;break}}}for(n=box2d.b2_maxManifoldPoints;q<n;++q){u[q]=box2d.b2PointState.b2_nullState}};goog.exportSymbol("box2d.b2GetPointStates",box2d.b2GetPointStates);box2d.b2ClipVertex=function(){this.v=new box2d.b2Vec2;this.id=new box2d.b2ContactID};goog.exportSymbol("box2d.b2ClipVertex",box2d.b2ClipVertex);box2d.b2ClipVertex.prototype.v=null;goog.exportProperty(box2d.b2ClipVertex.prototype,"v",box2d.b2ClipVertex.prototype.v);box2d.b2ClipVertex.prototype.id=null;goog.exportProperty(box2d.b2ClipVertex.prototype,"id",box2d.b2ClipVertex.prototype.id);box2d.b2ClipVertex.MakeArray=function(b){return box2d.b2MakeArray(b,function(d){return new box2d.b2ClipVertex})};goog.exportProperty(box2d.b2ClipVertex,"MakeArray",box2d.b2ClipVertex.MakeArray);box2d.b2ClipVertex.prototype.Copy=function(b){this.v.Copy(b.v);this.id.Copy(b.id);return this};goog.exportProperty(box2d.b2ClipVertex.prototype,"Copy",box2d.b2ClipVertex.prototype.Copy);box2d.b2RayCastInput=function(){this.p1=new box2d.b2Vec2;this.p2=new box2d.b2Vec2;this.maxFraction=1};goog.exportSymbol("box2d.b2RayCastInput",box2d.b2RayCastInput);box2d.b2RayCastInput.prototype.p1=null;goog.exportProperty(box2d.b2RayCastInput.prototype,"p1",box2d.b2RayCastInput.prototype.p1);box2d.b2RayCastInput.prototype.p2=null;goog.exportProperty(box2d.b2RayCastInput.prototype,"p2",box2d.b2RayCastInput.prototype.p2);box2d.b2RayCastInput.prototype.maxFraction=1;goog.exportProperty(box2d.b2RayCastInput.prototype,"maxFraction",box2d.b2RayCastInput.prototype.maxFraction);box2d.b2RayCastInput.prototype.Copy=function(b){this.p1.Copy(b.p1);this.p2.Copy(b.p2);this.maxFraction=b.maxFraction;return this};goog.exportProperty(box2d.b2RayCastInput.prototype,"Copy",box2d.b2RayCastInput.prototype.Copy);box2d.b2RayCastOutput=function(){this.normal=new box2d.b2Vec2;this.fraction=0};goog.exportSymbol("box2d.b2RayCastOutput",box2d.b2RayCastOutput);box2d.b2RayCastOutput.prototype.normal=null;goog.exportProperty(box2d.b2RayCastOutput.prototype,"normal",box2d.b2RayCastOutput.prototype.normal);box2d.b2RayCastOutput.prototype.fraction=0;goog.exportProperty(box2d.b2RayCastOutput.prototype,"fraction",box2d.b2RayCastOutput.prototype.fraction);box2d.b2RayCastOutput.prototype.Copy=function(b){this.normal.Copy(b.normal);this.fraction=b.fraction;return this};goog.exportProperty(box2d.b2RayCastOutput.prototype,"Copy",box2d.b2RayCastOutput.prototype.Copy);box2d.b2AABB=function(){this.lowerBound=new box2d.b2Vec2;this.upperBound=new box2d.b2Vec2;this.m_out_center=new box2d.b2Vec2;this.m_out_extent=new box2d.b2Vec2};goog.exportSymbol("box2d.b2AABB",box2d.b2AABB);box2d.b2AABB.prototype.lowerBound=null;goog.exportProperty(box2d.b2AABB.prototype,"lowerBound",box2d.b2AABB.prototype.lowerBound);box2d.b2AABB.prototype.upperBound=null;goog.exportProperty(box2d.b2AABB.prototype,"upperBound",box2d.b2AABB.prototype.upperBound);box2d.b2AABB.prototype.m_out_center=null;goog.exportProperty(box2d.b2AABB.prototype,"m_out_center",box2d.b2AABB.prototype.m_out_center);box2d.b2AABB.prototype.m_out_extent=null;goog.exportProperty(box2d.b2AABB.prototype,"m_out_extent",box2d.b2AABB.prototype.m_out_extent);box2d.b2AABB.prototype.Copy=function(b){this.lowerBound.Copy(b.lowerBound);this.upperBound.Copy(b.upperBound);return this};goog.exportProperty(box2d.b2AABB.prototype,"Copy",box2d.b2AABB.prototype.Copy);box2d.b2AABB.prototype.IsValid=function(){var b=this.upperBound.y-this.lowerBound.y;return b=(b=0<=this.upperBound.x-this.lowerBound.x&&0<=b)&&this.lowerBound.IsValid()&&this.upperBound.IsValid()};goog.exportProperty(box2d.b2AABB.prototype,"IsValid",box2d.b2AABB.prototype.IsValid);box2d.b2AABB.prototype.GetCenter=function(){return box2d.b2MidVV(this.lowerBound,this.upperBound,this.m_out_center)};goog.exportProperty(box2d.b2AABB.prototype,"GetCenter",box2d.b2AABB.prototype.GetCenter);box2d.b2AABB.prototype.GetExtents=function(){return box2d.b2ExtVV(this.lowerBound,this.upperBound,this.m_out_extent)};goog.exportProperty(box2d.b2AABB.prototype,"GetExtents",box2d.b2AABB.prototype.GetExtents);box2d.b2AABB.prototype.GetPerimeter=function(){return 2*(this.upperBound.x-this.lowerBound.x+(this.upperBound.y-this.lowerBound.y))};goog.exportProperty(box2d.b2AABB.prototype,"GetPerimeter",box2d.b2AABB.prototype.GetPerimeter);box2d.b2AABB.prototype.Combine1=function(b){this.lowerBound.x=box2d.b2Min(this.lowerBound.x,b.lowerBound.x);this.lowerBound.y=box2d.b2Min(this.lowerBound.y,b.lowerBound.y);this.upperBound.x=box2d.b2Max(this.upperBound.x,b.upperBound.x);this.upperBound.y=box2d.b2Max(this.upperBound.y,b.upperBound.y);return this};goog.exportProperty(box2d.b2AABB.prototype,"Combine1",box2d.b2AABB.prototype.Combine1);box2d.b2AABB.prototype.Combine2=function(e,d){this.lowerBound.x=box2d.b2Min(e.lowerBound.x,d.lowerBound.x);this.lowerBound.y=box2d.b2Min(e.lowerBound.y,d.lowerBound.y);this.upperBound.x=box2d.b2Max(e.upperBound.x,d.upperBound.x);this.upperBound.y=box2d.b2Max(e.upperBound.y,d.upperBound.y);return this};goog.exportProperty(box2d.b2AABB.prototype,"Combine2",box2d.b2AABB.prototype.Combine2);box2d.b2AABB.Combine=function(e,d,f){f.Combine2(e,d);return f};goog.exportProperty(box2d.b2AABB,"Combine",box2d.b2AABB.Combine);box2d.b2AABB.prototype.Contains=function(e){var d;return d=(d=(d=(d=this.lowerBound.x<=e.lowerBound.x)&&this.lowerBound.y<=e.lowerBound.y)&&e.upperBound.x<=this.upperBound.x)&&e.upperBound.y<=this.upperBound.y};goog.exportProperty(box2d.b2AABB.prototype,"Contains",box2d.b2AABB.prototype.Contains);box2d.b2AABB.prototype.RayCast=function(B,A){var z=-box2d.b2_maxFloat,y=box2d.b2_maxFloat,v=A.p1.x,u=A.p1.y,s=A.p2.x-A.p1.x,r=A.p2.y-A.p1.y,n=box2d.b2Abs(s),q=box2d.b2Abs(r),j=B.normal;if(n<box2d.b2_epsilon){if(v<this.lowerBound.x||this.upperBound.x<v){return !1}}else{if(n=1/s,s=(this.lowerBound.x-v)*n,v=(this.upperBound.x-v)*n,n=-1,s>v&&(n=s,s=v,v=n,n=1),s>z&&(j.x=n,j.y=0,z=s),y=box2d.b2Min(y,v),z>y){return !1}}if(q<box2d.b2_epsilon){if(u<this.lowerBound.y||this.upperBound.y<u){return !1}}else{if(n=1/r,s=(this.lowerBound.y-u)*n,v=(this.upperBound.y-u)*n,n=-1,s>v&&(n=s,s=v,v=n,n=1),s>z&&(j.x=0,j.y=n,z=s),y=box2d.b2Min(y,v),z>y){return !1}}if(0>z||A.maxFraction<z){return !1}B.fraction=z;return !0};goog.exportProperty(box2d.b2AABB.prototype,"RayCast",box2d.b2AABB.prototype.RayCast);box2d.b2AABB.prototype.TestOverlap=function(e){var d=e.lowerBound.y-this.upperBound.y,f=this.lowerBound.y-e.upperBound.y;return 0<e.lowerBound.x-this.upperBound.x||0<d||0<this.lowerBound.x-e.upperBound.x||0<f?!1:!0};goog.exportProperty(box2d.b2AABB.prototype,"TestOverlap",box2d.b2AABB.prototype.TestOverlap);box2d.b2TestOverlapAABB=function(f,e){var j=e.lowerBound.y-f.upperBound.y,g=f.lowerBound.y-e.upperBound.y;return 0<e.lowerBound.x-f.upperBound.x||0<j||0<f.lowerBound.x-e.upperBound.x||0<g?!1:!0};goog.exportSymbol("box2d.b2TestOverlapAABB",box2d.b2TestOverlapAABB);box2d.b2ClipSegmentToLine=function(k,j,u,s,r){var q=0,n=j[0];j=j[1];var m=box2d.b2DotVV(u,n.v)-s;u=box2d.b2DotVV(u,j.v)-s;0>=m&&k[q++].Copy(n);0>=u&&k[q++].Copy(j);0>m*u&&(u=m/(m-u),s=k[q].v,s.x=n.v.x+u*(j.v.x-n.v.x),s.y=n.v.y+u*(j.v.y-n.v.y),k=k[q].id,k.cf.indexA=r,k.cf.indexB=n.id.cf.indexB,k.cf.typeA=box2d.b2ContactFeatureType.e_vertex,k.cf.typeB=box2d.b2ContactFeatureType.e_face,++q);return q};goog.exportSymbol("box2d.b2ClipSegmentToLine",box2d.b2ClipSegmentToLine);box2d.b2TestOverlapShape=function(k,j,s,r,q,n){var m=box2d.b2TestOverlapShape.s_input.Reset();m.proxyA.SetShape(k,j);m.proxyB.SetShape(s,r);m.transformA.Copy(q);m.transformB.Copy(n);m.useRadii=!0;k=box2d.b2TestOverlapShape.s_simplexCache.Reset();k.count=0;j=box2d.b2TestOverlapShape.s_output.Reset();box2d.b2Distance(j,k,m);return j.distance<10*box2d.b2_epsilon};goog.exportSymbol("box2d.b2TestOverlapShape",box2d.b2TestOverlapShape);box2d.b2TestOverlapShape.s_input=new box2d.b2DistanceInput;box2d.b2TestOverlapShape.s_simplexCache=new box2d.b2SimplexCache;box2d.b2TestOverlapShape.s_output=new box2d.b2DistanceOutput;box2d.b2CollideCircle={};box2d.b2CollideCircles=function(g,f,m,k,j){g.pointCount=0;m=box2d.b2MulXV(m,f.m_p,box2d.b2CollideCircles.s_pA);j=box2d.b2MulXV(j,k.m_p,box2d.b2CollideCircles.s_pB);j=box2d.b2DistanceSquaredVV(m,j);m=f.m_radius+k.m_radius;j>m*m||(g.type=box2d.b2ManifoldType.e_circles,g.localPoint.Copy(f.m_p),g.localNormal.SetZero(),g.pointCount=1,g.points[0].localPoint.Copy(k.m_p),g.points[0].id.key=0)};goog.exportSymbol("box2d.b2CollideCircles",box2d.b2CollideCircles);box2d.b2CollideCircles.s_pA=new box2d.b2Vec2;box2d.b2CollideCircles.s_pB=new box2d.b2Vec2;box2d.b2CollidePolygonAndCircle=function(B,A,z,y,v){B.pointCount=0;v=box2d.b2MulXV(v,y.m_p,box2d.b2CollidePolygonAndCircle.s_c);z=box2d.b2MulTXV(z,v,box2d.b2CollidePolygonAndCircle.s_cLocal);var u=0,s=-box2d.b2_maxFloat;v=A.m_radius+y.m_radius;var r=A.m_count,n=A.m_vertices;A=A.m_normals;for(var q=0;q<r;++q){var j=box2d.b2DotVV(A[q],box2d.b2SubVV(z,n[q],box2d.b2Vec2.s_t0));if(j>v){return}j>s&&(s=j,u=q)}q=u;j=n[q];r=n[(q+1)%r];s<box2d.b2_epsilon?(B.pointCount=1,B.type=box2d.b2ManifoldType.e_faceA,B.localNormal.Copy(A[u]),box2d.b2MidVV(j,r,B.localPoint),B.points[0].localPoint.Copy(y.m_p),B.points[0].id.key=0):(s=box2d.b2DotVV(box2d.b2SubVV(z,j,box2d.b2Vec2.s_t0),box2d.b2SubVV(r,j,box2d.b2Vec2.s_t1)),u=box2d.b2DotVV(box2d.b2SubVV(z,r,box2d.b2Vec2.s_t0),box2d.b2SubVV(j,r,box2d.b2Vec2.s_t1)),0>=s?box2d.b2DistanceSquaredVV(z,j)>v*v||(B.pointCount=1,B.type=box2d.b2ManifoldType.e_faceA,box2d.b2SubVV(z,j,B.localNormal).SelfNormalize(),B.localPoint.Copy(j),B.points[0].localPoint.Copy(y.m_p),B.points[0].id.key=0):0>=u?box2d.b2DistanceSquaredVV(z,r)>v*v||(B.pointCount=1,B.type=box2d.b2ManifoldType.e_faceA,box2d.b2SubVV(z,r,B.localNormal).SelfNormalize(),B.localPoint.Copy(r),B.points[0].localPoint.Copy(y.m_p),B.points[0].id.key=0):(u=box2d.b2MidVV(j,r,box2d.b2CollidePolygonAndCircle.s_faceCenter),s=box2d.b2DotVV(box2d.b2SubVV(z,u,box2d.b2Vec2.s_t1),A[q]),s>v||(B.pointCount=1,B.type=box2d.b2ManifoldType.e_faceA,B.localNormal.Copy(A[q]).SelfNormalize(),B.localPoint.Copy(u),B.points[0].localPoint.Copy(y.m_p),B.points[0].id.key=0)))};goog.exportSymbol("box2d.b2CollidePolygonAndCircle",box2d.b2CollidePolygonAndCircle);box2d.b2CollidePolygonAndCircle.s_c=new box2d.b2Vec2;box2d.b2CollidePolygonAndCircle.s_cLocal=new box2d.b2Vec2;box2d.b2CollidePolygonAndCircle.s_faceCenter=new box2d.b2Vec2;box2d.b2CollideEdge={};box2d.b2CollideEdgeAndCircle=function(D,C,B,A,z){D.pointCount=0;B=box2d.b2MulTXV(B,box2d.b2MulXV(z,A.m_p,box2d.b2Vec2.s_t0),box2d.b2CollideEdgeAndCircle.s_Q);var y=C.m_vertex1,v=C.m_vertex2,u=box2d.b2SubVV(v,y,box2d.b2CollideEdgeAndCircle.s_e),r=box2d.b2DotVV(u,box2d.b2SubVV(v,B,box2d.b2Vec2.s_t0)),s=box2d.b2DotVV(u,box2d.b2SubVV(B,y,box2d.b2Vec2.s_t0)),q=C.m_radius+A.m_radius;z=box2d.b2CollideEdgeAndCircle.s_id;z.cf.indexB=0;z.cf.typeB=box2d.b2ContactFeatureType.e_vertex;if(0>=s){var j=y,r=box2d.b2SubVV(B,j,box2d.b2CollideEdgeAndCircle.s_d),r=box2d.b2DotVV(r,r);if(!(r>q*q)){if(C.m_hasVertex0&&(C=box2d.b2SubVV(y,C.m_vertex0,box2d.b2CollideEdgeAndCircle.s_e1),0<box2d.b2DotVV(C,box2d.b2SubVV(y,B,box2d.b2Vec2.s_t0)))){return}z.cf.indexA=0;z.cf.typeA=box2d.b2ContactFeatureType.e_vertex;D.pointCount=1;D.type=box2d.b2ManifoldType.e_circles;D.localNormal.SetZero();D.localPoint.Copy(j);D.points[0].id.Copy(z);D.points[0].localPoint.Copy(A.m_p)}}else{if(0>=r){if(j=v,r=box2d.b2SubVV(B,j,box2d.b2CollideEdgeAndCircle.s_d),r=box2d.b2DotVV(r,r),!(r>q*q)){if(C.m_hasVertex3&&(y=box2d.b2SubVV(C.m_vertex3,v,box2d.b2CollideEdgeAndCircle.s_e2),0<box2d.b2DotVV(y,box2d.b2SubVV(B,v,box2d.b2Vec2.s_t0)))){return}z.cf.indexA=1;z.cf.typeA=box2d.b2ContactFeatureType.e_vertex;D.pointCount=1;D.type=box2d.b2ManifoldType.e_circles;D.localNormal.SetZero();D.localPoint.Copy(j);D.points[0].id.Copy(z);D.points[0].localPoint.Copy(A.m_p)}}else{C=box2d.b2DotVV(u,u),box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<C),j=box2d.b2CollideEdgeAndCircle.s_P,j.x=1/C*(r*y.x+s*v.x),j.y=1/C*(r*y.y+s*v.y),r=box2d.b2SubVV(B,j,box2d.b2CollideEdgeAndCircle.s_d),r=box2d.b2DotVV(r,r),r>q*q||(j=box2d.b2CollideEdgeAndCircle.s_n.SetXY(-u.y,u.x),0>box2d.b2DotVV(j,box2d.b2SubVV(B,y,box2d.b2Vec2.s_t0))&&j.SetXY(-j.x,-j.y),j.Normalize(),z.cf.indexA=0,z.cf.typeA=box2d.b2ContactFeatureType.e_face,D.pointCount=1,D.type=box2d.b2ManifoldType.e_faceA,D.localNormal.Copy(j),D.localPoint.Copy(y),D.points[0].id.Copy(z),D.points[0].localPoint.Copy(A.m_p))}}};goog.exportSymbol("box2d.b2CollideEdgeAndCircle",box2d.b2CollideEdgeAndCircle);box2d.b2CollideEdgeAndCircle.s_Q=new box2d.b2Vec2;box2d.b2CollideEdgeAndCircle.s_e=new box2d.b2Vec2;box2d.b2CollideEdgeAndCircle.s_d=new box2d.b2Vec2;box2d.b2CollideEdgeAndCircle.s_e1=new box2d.b2Vec2;box2d.b2CollideEdgeAndCircle.s_e2=new box2d.b2Vec2;box2d.b2CollideEdgeAndCircle.s_P=new box2d.b2Vec2;box2d.b2CollideEdgeAndCircle.s_n=new box2d.b2Vec2;box2d.b2CollideEdgeAndCircle.s_id=new box2d.b2ContactID;box2d.b2EPAxisType={e_unknown:0,e_edgeA:1,e_edgeB:2};goog.exportSymbol("box2d.b2EPAxisType",box2d.b2EPAxisType);goog.exportProperty(box2d.b2EPAxisType,"e_unknown",box2d.b2EPAxisType.e_unknown);goog.exportProperty(box2d.b2EPAxisType,"e_edgeA",box2d.b2EPAxisType.e_edgeA);goog.exportProperty(box2d.b2EPAxisType,"e_edgeB",box2d.b2EPAxisType.e_edgeB);box2d.b2EPAxis=function(){};goog.exportSymbol("box2d.b2EPAxis",box2d.b2EPAxis);box2d.b2EPAxis.prototype.type=box2d.b2EPAxisType.e_unknown;goog.exportProperty(box2d.b2EPAxis.prototype,"type",box2d.b2EPAxis.prototype.type);box2d.b2EPAxis.prototype.index=0;goog.exportProperty(box2d.b2EPAxis.prototype,"index",box2d.b2EPAxis.prototype.index);box2d.b2EPAxis.prototype.separation=0;goog.exportProperty(box2d.b2EPAxis.prototype,"separation",box2d.b2EPAxis.prototype.separation);box2d.b2TempPolygon=function(){this.vertices=box2d.b2Vec2.MakeArray(box2d.b2_maxPolygonVertices);this.normals=box2d.b2Vec2.MakeArray(box2d.b2_maxPolygonVertices);this.count=0};goog.exportSymbol("box2d.b2TempPolygon",box2d.b2TempPolygon);box2d.b2TempPolygon.prototype.vertices=null;goog.exportProperty(box2d.b2TempPolygon.prototype,"vertices",box2d.b2TempPolygon.prototype.vertices);box2d.b2TempPolygon.prototype.normals=null;goog.exportProperty(box2d.b2TempPolygon.prototype,"normals",box2d.b2TempPolygon.prototype.normals);box2d.b2TempPolygon.prototype.count=0;goog.exportProperty(box2d.b2TempPolygon.prototype,"count",box2d.b2TempPolygon.prototype.count);box2d.b2ReferenceFace=function(){this.i2=this.i1=0;this.v1=new box2d.b2Vec2;this.v2=new box2d.b2Vec2;this.normal=new box2d.b2Vec2;this.sideNormal1=new box2d.b2Vec2;this.sideOffset1=0;this.sideNormal2=new box2d.b2Vec2;this.sideOffset2=0};goog.exportSymbol("box2d.b2ReferenceFace",box2d.b2ReferenceFace);box2d.b2ReferenceFace.prototype.i1=0;goog.exportProperty(box2d.b2ReferenceFace.prototype,"i1",box2d.b2ReferenceFace.prototype.i1);box2d.b2ReferenceFace.prototype.i2=0;goog.exportProperty(box2d.b2ReferenceFace.prototype,"i2",box2d.b2ReferenceFace.prototype.i2);box2d.b2ReferenceFace.prototype.v1=null;goog.exportProperty(box2d.b2ReferenceFace.prototype,"v1",box2d.b2ReferenceFace.prototype.v1);box2d.b2ReferenceFace.prototype.v2=null;goog.exportProperty(box2d.b2ReferenceFace.prototype,"v2",box2d.b2ReferenceFace.prototype.v2);box2d.b2ReferenceFace.prototype.normal=null;goog.exportProperty(box2d.b2ReferenceFace.prototype,"normal",box2d.b2ReferenceFace.prototype.normal);box2d.b2ReferenceFace.prototype.sideNormal1=null;goog.exportProperty(box2d.b2ReferenceFace.prototype,"sideNormal1",box2d.b2ReferenceFace.prototype.sideNormal1);box2d.b2ReferenceFace.prototype.sideOffset1=0;goog.exportProperty(box2d.b2ReferenceFace.prototype,"sideOffset1",box2d.b2ReferenceFace.prototype.sideOffset1);box2d.b2ReferenceFace.prototype.sideNormal2=null;goog.exportProperty(box2d.b2ReferenceFace.prototype,"sideNormal2",box2d.b2ReferenceFace.prototype.sideNormal2);box2d.b2ReferenceFace.prototype.sideOffset2=0;goog.exportProperty(box2d.b2ReferenceFace.prototype,"sideOffset2",box2d.b2ReferenceFace.prototype.sideOffset2);box2d.b2EPColliderVertexType={e_isolated:0,e_concave:1,e_convex:2};goog.exportSymbol("box2d.b2EPColliderVertexType",box2d.b2EPColliderVertexType);goog.exportProperty(box2d.b2EPColliderVertexType,"e_isolated",box2d.b2EPColliderVertexType.e_isolated);goog.exportProperty(box2d.b2EPColliderVertexType,"e_concave",box2d.b2EPColliderVertexType.e_concave);goog.exportProperty(box2d.b2EPColliderVertexType,"e_convex",box2d.b2EPColliderVertexType.e_convex);box2d.b2EPCollider=function(){this.m_polygonB=new box2d.b2TempPolygon;this.m_xf=new box2d.b2Transform;this.m_centroidB=new box2d.b2Vec2;this.m_v0=new box2d.b2Vec2;this.m_v1=new box2d.b2Vec2;this.m_v2=new box2d.b2Vec2;this.m_v3=new box2d.b2Vec2;this.m_normal0=new box2d.b2Vec2;this.m_normal1=new box2d.b2Vec2;this.m_normal2=new box2d.b2Vec2;this.m_normal=new box2d.b2Vec2;this.m_type2=this.m_type1=box2d.b2EPColliderVertexType.e_isolated;this.m_lowerLimit=new box2d.b2Vec2;this.m_upperLimit=new box2d.b2Vec2;this.m_radius=0;this.m_front=!1};goog.exportSymbol("box2d.b2EPCollider",box2d.b2EPCollider);box2d.b2EPCollider.prototype.m_polygonB=null;goog.exportProperty(box2d.b2EPCollider.prototype,"m_polygonB",box2d.b2EPCollider.prototype.m_polygonB);box2d.b2EPCollider.prototype.m_xf=null;goog.exportProperty(box2d.b2EPCollider.prototype,"m_xf",box2d.b2EPCollider.prototype.m_xf);box2d.b2EPCollider.prototype.m_centroidB=null;goog.exportProperty(box2d.b2EPCollider.prototype,"m_centroidB",box2d.b2EPCollider.prototype.m_centroidB);box2d.b2EPCollider.prototype.m_v0=null;goog.exportProperty(box2d.b2EPCollider.prototype,"m_v0",box2d.b2EPCollider.prototype.m_v0);box2d.b2EPCollider.prototype.m_v1=null;goog.exportProperty(box2d.b2EPCollider.prototype,"m_v1",box2d.b2EPCollider.prototype.m_v1);box2d.b2EPCollider.prototype.m_v2=null;goog.exportProperty(box2d.b2EPCollider.prototype,"m_v2",box2d.b2EPCollider.prototype.m_v2);box2d.b2EPCollider.prototype.m_v3=null;goog.exportProperty(box2d.b2EPCollider.prototype,"m_v3",box2d.b2EPCollider.prototype.m_v3);box2d.b2EPCollider.prototype.m_normal0=null;goog.exportProperty(box2d.b2EPCollider.prototype,"m_normal0",box2d.b2EPCollider.prototype.m_normal0);box2d.b2EPCollider.prototype.m_normal1=null;goog.exportProperty(box2d.b2EPCollider.prototype,"m_normal1",box2d.b2EPCollider.prototype.m_normal1);box2d.b2EPCollider.prototype.m_normal2=null;goog.exportProperty(box2d.b2EPCollider.prototype,"m_normal2",box2d.b2EPCollider.prototype.m_normal2);box2d.b2EPCollider.prototype.m_normal=null;goog.exportProperty(box2d.b2EPCollider.prototype,"m_normal",box2d.b2EPCollider.prototype.m_normal);box2d.b2EPCollider.prototype.m_type1=box2d.b2EPColliderVertexType.e_isolated;goog.exportProperty(box2d.b2EPCollider.prototype,"m_type1",box2d.b2EPCollider.prototype.m_type1);box2d.b2EPCollider.prototype.m_type2=box2d.b2EPColliderVertexType.e_isolated;goog.exportProperty(box2d.b2EPCollider.prototype,"m_type2",box2d.b2EPCollider.prototype.m_type2);box2d.b2EPCollider.prototype.m_lowerLimit=null;goog.exportProperty(box2d.b2EPCollider.prototype,"m_lowerLimit",box2d.b2EPCollider.prototype.m_lowerLimit);box2d.b2EPCollider.prototype.m_upperLimit=null;goog.exportProperty(box2d.b2EPCollider.prototype,"m_upperLimit",box2d.b2EPCollider.prototype.m_upperLimit);box2d.b2EPCollider.prototype.m_radius=0;goog.exportProperty(box2d.b2EPCollider.prototype,"m_radius",box2d.b2EPCollider.prototype.m_radius);box2d.b2EPCollider.prototype.m_front=!1;goog.exportProperty(box2d.b2EPCollider.prototype,"m_front",box2d.b2EPCollider.prototype.m_front);box2d.b2EPCollider.prototype.Collide=function(z,y,v,u,s){box2d.b2MulTXX(v,s,this.m_xf);box2d.b2MulXV(this.m_xf,u.m_centroid,this.m_centroidB);this.m_v0.Copy(y.m_vertex0);this.m_v1.Copy(y.m_vertex1);this.m_v2.Copy(y.m_vertex2);this.m_v3.Copy(y.m_vertex3);v=y.m_hasVertex0;y=y.m_hasVertex3;s=box2d.b2SubVV(this.m_v2,this.m_v1,box2d.b2EPCollider.s_edge1);s.Normalize();this.m_normal1.SetXY(s.y,-s.x);var r=box2d.b2DotVV(this.m_normal1,box2d.b2SubVV(this.m_centroidB,this.m_v1,box2d.b2Vec2.s_t0)),q=0,n=0,j=!1,m=!1;v&&(q=box2d.b2SubVV(this.m_v1,this.m_v0,box2d.b2EPCollider.s_edge0),q.Normalize(),this.m_normal0.SetXY(q.y,-q.x),j=0<=box2d.b2CrossVV(q,s),q=box2d.b2DotVV(this.m_normal0,box2d.b2SubVV(this.m_centroidB,this.m_v0,box2d.b2Vec2.s_t0)));y&&(n=box2d.b2SubVV(this.m_v3,this.m_v2,box2d.b2EPCollider.s_edge2),n.Normalize(),this.m_normal2.SetXY(n.y,-n.x),m=0<box2d.b2CrossVV(s,n),n=box2d.b2DotVV(this.m_normal2,box2d.b2SubVV(this.m_centroidB,this.m_v2,box2d.b2Vec2.s_t0)));v&&y?j&&m?(this.m_front=0<=q||0<=r||0<=n)?(this.m_normal.Copy(this.m_normal1),this.m_lowerLimit.Copy(this.m_normal0),this.m_upperLimit.Copy(this.m_normal2)):(this.m_normal.Copy(this.m_normal1).SelfNeg(),this.m_lowerLimit.Copy(this.m_normal1).SelfNeg(),this.m_upperLimit.Copy(this.m_normal1).SelfNeg()):j?(this.m_front=0<=q||0<=r&&0<=n)?(this.m_normal.Copy(this.m_normal1),this.m_lowerLimit.Copy(this.m_normal0),this.m_upperLimit.Copy(this.m_normal1)):(this.m_normal.Copy(this.m_normal1).SelfNeg(),this.m_lowerLimit.Copy(this.m_normal2).SelfNeg(),this.m_upperLimit.Copy(this.m_normal1).SelfNeg()):m?(this.m_front=0<=n||0<=q&&0<=r)?(this.m_normal.Copy(this.m_normal1),this.m_lowerLimit.Copy(this.m_normal1),this.m_upperLimit.Copy(this.m_normal2)):(this.m_normal.Copy(this.m_normal1).SelfNeg(),this.m_lowerLimit.Copy(this.m_normal1).SelfNeg(),this.m_upperLimit.Copy(this.m_normal0).SelfNeg()):(this.m_front=0<=q&&0<=r&&0<=n)?(this.m_normal.Copy(this.m_normal1),this.m_lowerLimit.Copy(this.m_normal1),this.m_upperLimit.Copy(this.m_normal1)):(this.m_normal.Copy(this.m_normal1).SelfNeg(),this.m_lowerLimit.Copy(this.m_normal2).SelfNeg(),this.m_upperLimit.Copy(this.m_normal0).SelfNeg()):v?j?((this.m_front=0<=q||0<=r)?(this.m_normal.Copy(this.m_normal1),this.m_lowerLimit.Copy(this.m_normal0)):(this.m_normal.Copy(this.m_normal1).SelfNeg(),this.m_lowerLimit.Copy(this.m_normal1)),this.m_upperLimit.Copy(this.m_normal1).SelfNeg()):(this.m_front=0<=q&&0<=r)?(this.m_normal.Copy(this.m_normal1),this.m_lowerLimit.Copy(this.m_normal1),this.m_upperLimit.Copy(this.m_normal1).SelfNeg()):(this.m_normal.Copy(this.m_normal1).SelfNeg(),this.m_lowerLimit.Copy(this.m_normal1),this.m_upperLimit.Copy(this.m_normal0).SelfNeg()):y?m?(this.m_front=0<=r||0<=n)?(this.m_normal.Copy(this.m_normal1),this.m_lowerLimit.Copy(this.m_normal1).SelfNeg(),this.m_upperLimit.Copy(this.m_normal2)):(this.m_normal.Copy(this.m_normal1).SelfNeg(),this.m_lowerLimit.Copy(this.m_normal1).SelfNeg(),this.m_upperLimit.Copy(this.m_normal1)):((this.m_front=0<=r&&0<=n)?(this.m_normal.Copy(this.m_normal1),this.m_lowerLimit.Copy(this.m_normal1).SelfNeg()):(this.m_normal.Copy(this.m_normal1).SelfNeg(),this.m_lowerLimit.Copy(this.m_normal2).SelfNeg()),this.m_upperLimit.Copy(this.m_normal1)):(this.m_front=0<=r)?(this.m_normal.Copy(this.m_normal1),this.m_lowerLimit.Copy(this.m_normal1).SelfNeg(),this.m_upperLimit.Copy(this.m_normal1).SelfNeg()):(this.m_normal.Copy(this.m_normal1).SelfNeg(),this.m_lowerLimit.Copy(this.m_normal1),this.m_upperLimit.Copy(this.m_normal1));this.m_polygonB.count=u.m_count;r=0;for(q=u.m_count;r<q;++r){box2d.b2MulXV(this.m_xf,u.m_vertices[r],this.m_polygonB.vertices[r]),box2d.b2MulRV(this.m_xf.q,u.m_normals[r],this.m_polygonB.normals[r])}this.m_radius=2*box2d.b2_polygonRadius;z.pointCount=0;v=this.ComputeEdgeSeparation(box2d.b2EPCollider.s_edgeAxis);if(!(v.type===box2d.b2EPAxisType.e_unknown||v.separation>this.m_radius||(y=this.ComputePolygonSeparation(box2d.b2EPCollider.s_polygonAxis),y.type!==box2d.b2EPAxisType.e_unknown&&y.separation>this.m_radius))){v=y.type===box2d.b2EPAxisType.e_unknown?v:y.separation>0.98*v.separation+0.001?y:v;s=box2d.b2EPCollider.s_ie;y=box2d.b2EPCollider.s_rf;if(v.type===box2d.b2EPAxisType.e_edgeA){z.type=box2d.b2ManifoldType.e_faceA;n=0;j=box2d.b2DotVV(this.m_normal,this.m_polygonB.normals[0]);r=1;for(q=this.m_polygonB.count;r<q;++r){m=box2d.b2DotVV(this.m_normal,this.m_polygonB.normals[r]),m<j&&(j=m,n=r)}q=n;r=(q+1)%this.m_polygonB.count;n=s[0];n.v.Copy(this.m_polygonB.vertices[q]);n.id.cf.indexA=0;n.id.cf.indexB=q;n.id.cf.typeA=box2d.b2ContactFeatureType.e_face;n.id.cf.typeB=box2d.b2ContactFeatureType.e_vertex;q=s[1];q.v.Copy(this.m_polygonB.vertices[r]);q.id.cf.indexA=0;q.id.cf.indexB=r;q.id.cf.typeA=box2d.b2ContactFeatureType.e_face;q.id.cf.typeB=box2d.b2ContactFeatureType.e_vertex;this.m_front?(y.i1=0,y.i2=1,y.v1.Copy(this.m_v1),y.v2.Copy(this.m_v2),y.normal.Copy(this.m_normal1)):(y.i1=1,y.i2=0,y.v1.Copy(this.m_v2),y.v2.Copy(this.m_v1),y.normal.Copy(this.m_normal1).SelfNeg())}else{z.type=box2d.b2ManifoldType.e_faceB,n=s[0],n.v.Copy(this.m_v1),n.id.cf.indexA=0,n.id.cf.indexB=v.index,n.id.cf.typeA=box2d.b2ContactFeatureType.e_vertex,n.id.cf.typeB=box2d.b2ContactFeatureType.e_face,q=s[1],q.v.Copy(this.m_v2),q.id.cf.indexA=0,q.id.cf.indexB=v.index,q.id.cf.typeA=box2d.b2ContactFeatureType.e_vertex,q.id.cf.typeB=box2d.b2ContactFeatureType.e_face,y.i1=v.index,y.i2=(y.i1+1)%this.m_polygonB.count,y.v1.Copy(this.m_polygonB.vertices[y.i1]),y.v2.Copy(this.m_polygonB.vertices[y.i2]),y.normal.Copy(this.m_polygonB.normals[y.i1])}y.sideNormal1.SetXY(y.normal.y,-y.normal.x);y.sideNormal2.Copy(y.sideNormal1).SelfNeg();y.sideOffset1=box2d.b2DotVV(y.sideNormal1,y.v1);y.sideOffset2=box2d.b2DotVV(y.sideNormal2,y.v2);r=box2d.b2EPCollider.s_clipPoints1;n=box2d.b2EPCollider.s_clipPoints2;q=0;q=box2d.b2ClipSegmentToLine(r,s,y.sideNormal1,y.sideOffset1,y.i1);if(!(q<box2d.b2_maxManifoldPoints||(q=box2d.b2ClipSegmentToLine(n,r,y.sideNormal2,y.sideOffset2,y.i2),q<box2d.b2_maxManifoldPoints))){v.type===box2d.b2EPAxisType.e_edgeA?(z.localNormal.Copy(y.normal),z.localPoint.Copy(y.v1)):(z.localNormal.Copy(u.m_normals[y.i1]),z.localPoint.Copy(u.m_vertices[y.i1]));r=u=0;for(q=box2d.b2_maxManifoldPoints;r<q;++r){box2d.b2DotVV(y.normal,box2d.b2SubVV(n[r].v,y.v1,box2d.b2Vec2.s_t0))<=this.m_radius&&(s=z.points[u],v.type===box2d.b2EPAxisType.e_edgeA?(box2d.b2MulTXV(this.m_xf,n[r].v,s.localPoint),s.id=n[r].id):(s.localPoint.Copy(n[r].v),s.id.cf.typeA=n[r].id.cf.typeB,s.id.cf.typeB=n[r].id.cf.typeA,s.id.cf.indexA=n[r].id.cf.indexB,s.id.cf.indexB=n[r].id.cf.indexA),++u)}z.pointCount=u}}};goog.exportProperty(box2d.b2EPCollider.prototype,"Collide",box2d.b2EPCollider.prototype.Collide);box2d.b2EPCollider.s_edge1=new box2d.b2Vec2;box2d.b2EPCollider.s_edge0=new box2d.b2Vec2;box2d.b2EPCollider.s_edge2=new box2d.b2Vec2;box2d.b2EPCollider.s_ie=box2d.b2ClipVertex.MakeArray(2);box2d.b2EPCollider.s_rf=new box2d.b2ReferenceFace;box2d.b2EPCollider.s_clipPoints1=box2d.b2ClipVertex.MakeArray(2);box2d.b2EPCollider.s_clipPoints2=box2d.b2ClipVertex.MakeArray(2);box2d.b2EPCollider.s_edgeAxis=new box2d.b2EPAxis;box2d.b2EPCollider.s_polygonAxis=new box2d.b2EPAxis;box2d.b2EPCollider.prototype.ComputeEdgeSeparation=function(f){f.type=box2d.b2EPAxisType.e_edgeA;f.index=this.m_front?0:1;f.separation=box2d.b2_maxFloat;for(var e=0,j=this.m_polygonB.count;e<j;++e){var g=box2d.b2DotVV(this.m_normal,box2d.b2SubVV(this.m_polygonB.vertices[e],this.m_v1,box2d.b2Vec2.s_t0));g<f.separation&&(f.separation=g)}return f};goog.exportProperty(box2d.b2EPCollider.prototype,"ComputeEdgeSeparation",box2d.b2EPCollider.prototype.ComputeEdgeSeparation);box2d.b2EPCollider.prototype.ComputePolygonSeparation=function(k){k.type=box2d.b2EPAxisType.e_unknown;k.index=-1;k.separation=-box2d.b2_maxFloat;for(var j=box2d.b2EPCollider.s_perp.SetXY(-this.m_normal.y,this.m_normal.x),s=0,r=this.m_polygonB.count;s<r;++s){var q=box2d.b2NegV(this.m_polygonB.normals[s],box2d.b2EPCollider.s_n),n=box2d.b2DotVV(q,box2d.b2SubVV(this.m_polygonB.vertices[s],this.m_v1,box2d.b2Vec2.s_t0)),m=box2d.b2DotVV(q,box2d.b2SubVV(this.m_polygonB.vertices[s],this.m_v2,box2d.b2Vec2.s_t0)),n=box2d.b2Min(n,m);if(n>this.m_radius){k.type=box2d.b2EPAxisType.e_edgeB;k.index=s;k.separation=n;break}if(0<=box2d.b2DotVV(q,j)){if(box2d.b2DotVV(box2d.b2SubVV(q,this.m_upperLimit,box2d.b2Vec2.s_t0),this.m_normal)<-box2d.b2_angularSlop){continue}}else{if(box2d.b2DotVV(box2d.b2SubVV(q,this.m_lowerLimit,box2d.b2Vec2.s_t0),this.m_normal)<-box2d.b2_angularSlop){continue}}n>k.separation&&(k.type=box2d.b2EPAxisType.e_edgeB,k.index=s,k.separation=n)}return k};goog.exportProperty(box2d.b2EPCollider.prototype,"ComputePolygonSeparation",box2d.b2EPCollider.prototype.ComputePolygonSeparation);box2d.b2EPCollider.s_n=new box2d.b2Vec2;box2d.b2EPCollider.s_perp=new box2d.b2Vec2;box2d.b2CollideEdgeAndPolygon=function(g,f,m,k,j){box2d.b2CollideEdgeAndPolygon.s_collider.Collide(g,f,m,k,j)};goog.exportSymbol("box2d.b2CollideEdgeAndPolygon",box2d.b2CollideEdgeAndPolygon);box2d.b2CollideEdgeAndPolygon.s_collider=new box2d.b2EPCollider;box2d.b2CollidePolygon={};box2d.b2FindMaxSeparation=function(I,H,G,F,E){var D=H.m_count,C=F.m_count,B=H.m_normals;H=H.m_vertices;F=F.m_vertices;G=box2d.b2MulTXX(E,G,box2d.b2FindMaxSeparation.s_xf);E=0;for(var z=-box2d.b2_maxFloat,A=0;A<D;++A){for(var y=box2d.b2MulRV(G.q,B[A],box2d.b2FindMaxSeparation.s_n),v=box2d.b2MulXV(G,H[A],box2d.b2FindMaxSeparation.s_v1),u=box2d.b2_maxFloat,s=0;s<C;++s){var j=box2d.b2DotVV(y,box2d.b2SubVV(F[s],v,box2d.b2Vec2.s_t0));j<u&&(u=j)}u>z&&(z=u,E=A)}I[0]=E;return z};goog.exportSymbol("box2d.b2FindMaxSeparation",box2d.b2FindMaxSeparation);box2d.b2FindMaxSeparation.s_xf=new box2d.b2Transform;box2d.b2FindMaxSeparation.s_n=new box2d.b2Vec2;box2d.b2FindMaxSeparation.s_v1=new box2d.b2Vec2;box2d.b2FindIncidentEdge=function(B,A,z,y,v,u){var s=A.m_count,r=A.m_normals,n=v.m_count;A=v.m_vertices;v=v.m_normals;box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<=y&&y<s);z=box2d.b2MulTRV(u.q,box2d.b2MulRV(z.q,r[y],box2d.b2Vec2.s_t0),box2d.b2FindIncidentEdge.s_normal1);for(var s=0,r=box2d.b2_maxFloat,q=0;q<n;++q){var j=box2d.b2DotVV(z,v[q]);j<r&&(r=j,s=q)}v=s;n=(v+1)%n;z=B[0];box2d.b2MulXV(u,A[v],z.v);z=z.id.cf;z.indexA=y;z.indexB=v;z.typeA=box2d.b2ContactFeatureType.e_face;z.typeB=box2d.b2ContactFeatureType.e_vertex;B=B[1];box2d.b2MulXV(u,A[n],B.v);u=B.id.cf;u.indexA=y;u.indexB=n;u.typeA=box2d.b2ContactFeatureType.e_face;u.typeB=box2d.b2ContactFeatureType.e_vertex};goog.exportSymbol("box2d.b2FindIncidentEdge",box2d.b2FindIncidentEdge);box2d.b2FindIncidentEdge.s_normal1=new box2d.b2Vec2;box2d.b2CollidePolygons=function(J,I,H,G,F){J.pointCount=0;var E=I.m_radius+G.m_radius,D=box2d.b2CollidePolygons.s_edgeA;D[0]=0;var C=box2d.b2FindMaxSeparation(D,I,H,G,F);if(!(C>E)){var A=box2d.b2CollidePolygons.s_edgeB;A[0]=0;var B=box2d.b2FindMaxSeparation(A,G,F,I,H);if(!(B>E)){var z=0,y=0;B>0.98*C+0.001?(C=G,G=I,I=F,z=A[0],J.type=box2d.b2ManifoldType.e_faceB,y=1):(C=I,I=H,H=F,z=D[0],J.type=box2d.b2ManifoldType.e_faceA,y=0);D=box2d.b2CollidePolygons.s_incidentEdge;box2d.b2FindIncidentEdge(D,C,I,z,G,H);F=C.m_vertices;var A=z,C=(z+1)%C.m_count,v=F[A],u=F[C],z=box2d.b2SubVV(u,v,box2d.b2CollidePolygons.s_localTangent);z.Normalize();F=box2d.b2CrossVOne(z,box2d.b2CollidePolygons.s_localNormal);G=box2d.b2MidVV(v,u,box2d.b2CollidePolygons.s_planePoint);var B=box2d.b2MulRV(I.q,z,box2d.b2CollidePolygons.s_tangent),z=box2d.b2CrossVOne(B,box2d.b2CollidePolygons.s_normal),v=box2d.b2MulXV(I,v,box2d.b2CollidePolygons.s_v11),j=box2d.b2MulXV(I,u,box2d.b2CollidePolygons.s_v12);I=box2d.b2DotVV(z,v);var u=-box2d.b2DotVV(B,v)+E,j=box2d.b2DotVV(B,j)+E,K=box2d.b2CollidePolygons.s_clipPoints1,v=box2d.b2CollidePolygons.s_clipPoints2,L=box2d.b2NegV(B,box2d.b2CollidePolygons.s_ntangent),D=box2d.b2ClipSegmentToLine(K,D,L,u,A);if(!(2>D||(D=box2d.b2ClipSegmentToLine(v,K,B,j,C),2>D))){J.localNormal.Copy(F);J.localPoint.Copy(G);for(A=D=0;A<box2d.b2_maxManifoldPoints;++A){F=v[A],box2d.b2DotVV(z,F.v)-I<=E&&(C=J.points[D],box2d.b2MulTXV(H,F.v,C.localPoint),C.id.Copy(F.id),y&&(F=C.id.cf,C.id.cf.indexA=F.indexB,C.id.cf.indexB=F.indexA,C.id.cf.typeA=F.typeB,C.id.cf.typeB=F.typeA),++D)}J.pointCount=D}}}};goog.exportSymbol("box2d.b2CollidePolygons",box2d.b2CollidePolygons);box2d.b2CollidePolygons.s_incidentEdge=box2d.b2ClipVertex.MakeArray(2);box2d.b2CollidePolygons.s_clipPoints1=box2d.b2ClipVertex.MakeArray(2);box2d.b2CollidePolygons.s_clipPoints2=box2d.b2ClipVertex.MakeArray(2);box2d.b2CollidePolygons.s_edgeA=box2d.b2MakeNumberArray(1);box2d.b2CollidePolygons.s_edgeB=box2d.b2MakeNumberArray(1);box2d.b2CollidePolygons.s_localTangent=new box2d.b2Vec2;box2d.b2CollidePolygons.s_localNormal=new box2d.b2Vec2;box2d.b2CollidePolygons.s_planePoint=new box2d.b2Vec2;box2d.b2CollidePolygons.s_normal=new box2d.b2Vec2;box2d.b2CollidePolygons.s_tangent=new box2d.b2Vec2;box2d.b2CollidePolygons.s_ntangent=new box2d.b2Vec2;box2d.b2CollidePolygons.s_v11=new box2d.b2Vec2;box2d.b2CollidePolygons.s_v12=new box2d.b2Vec2;box2d.b2TreeNode=function(b){this.m_id=b||0;this.aabb=new box2d.b2AABB};goog.exportSymbol("box2d.b2TreeNode",box2d.b2TreeNode);box2d.b2TreeNode.prototype.m_id=0;goog.exportProperty(box2d.b2TreeNode.prototype,"m_id",box2d.b2TreeNode.prototype.m_id);box2d.b2TreeNode.prototype.aabb=null;goog.exportProperty(box2d.b2TreeNode.prototype,"aabb",box2d.b2TreeNode.prototype.aabb);box2d.b2TreeNode.prototype.userData=null;goog.exportProperty(box2d.b2TreeNode.prototype,"userData",box2d.b2TreeNode.prototype.userData);box2d.b2TreeNode.prototype.parent=null;goog.exportProperty(box2d.b2TreeNode.prototype,"parent",box2d.b2TreeNode.prototype.parent);box2d.b2TreeNode.prototype.child1=null;goog.exportProperty(box2d.b2TreeNode.prototype,"child1",box2d.b2TreeNode.prototype.child1);box2d.b2TreeNode.prototype.child2=null;goog.exportProperty(box2d.b2TreeNode.prototype,"child2",box2d.b2TreeNode.prototype.child2);box2d.b2TreeNode.prototype.height=0;goog.exportProperty(box2d.b2TreeNode.prototype,"height",box2d.b2TreeNode.prototype.height);box2d.b2TreeNode.prototype.IsLeaf=function(){return null===this.child1};goog.exportProperty(box2d.b2TreeNode.prototype,"IsLeaf",box2d.b2TreeNode.prototype.IsLeaf);box2d.b2DynamicTree=function(){};goog.exportSymbol("box2d.b2DynamicTree",box2d.b2DynamicTree);box2d.b2DynamicTree.prototype.m_root=null;goog.exportProperty(box2d.b2DynamicTree.prototype,"m_root",box2d.b2DynamicTree.prototype.m_root);box2d.b2DynamicTree.prototype.m_freeList=null;goog.exportProperty(box2d.b2DynamicTree.prototype,"m_freeList",box2d.b2DynamicTree.prototype.m_freeList);box2d.b2DynamicTree.prototype.m_path=0;goog.exportProperty(box2d.b2DynamicTree.prototype,"m_path",box2d.b2DynamicTree.prototype.m_path);box2d.b2DynamicTree.prototype.m_insertionCount=0;goog.exportProperty(box2d.b2DynamicTree.prototype,"m_insertionCount",box2d.b2DynamicTree.prototype.m_insertionCount);box2d.b2DynamicTree.s_stack=new box2d.b2GrowableStack(256);box2d.b2DynamicTree.s_r=new box2d.b2Vec2;box2d.b2DynamicTree.s_v=new box2d.b2Vec2;box2d.b2DynamicTree.s_abs_v=new box2d.b2Vec2;box2d.b2DynamicTree.s_segmentAABB=new box2d.b2AABB;box2d.b2DynamicTree.s_subInput=new box2d.b2RayCastInput;box2d.b2DynamicTree.s_combinedAABB=new box2d.b2AABB;box2d.b2DynamicTree.s_aabb=new box2d.b2AABB;box2d.b2DynamicTree.prototype.GetUserData=function(b){box2d.ENABLE_ASSERTS&&box2d.b2Assert(null!==b);return b.userData};goog.exportProperty(box2d.b2DynamicTree.prototype,"GetUserData",box2d.b2DynamicTree.prototype.GetUserData);box2d.b2DynamicTree.prototype.GetFatAABB=function(b){box2d.ENABLE_ASSERTS&&box2d.b2Assert(null!==b);return b.aabb};goog.exportProperty(box2d.b2DynamicTree.prototype,"GetFatAABB",box2d.b2DynamicTree.prototype.GetFatAABB);box2d.b2DynamicTree.prototype.Query=function(f,e){if(null!==this.m_root){var j=box2d.b2DynamicTree.s_stack.Reset();for(j.Push(this.m_root);0<j.GetCount();){var g=j.Pop();if(null!==g&&g.aabb.TestOverlap(e)){if(g.IsLeaf()){if(!1===f(g)){break}}else{j.Push(g.child1),j.Push(g.child2)}}}}};goog.exportProperty(box2d.b2DynamicTree.prototype,"Query",box2d.b2DynamicTree.prototype.Query);box2d.b2DynamicTree.prototype.RayCast=function(D,C){if(null!==this.m_root){var B=C.p1,A=C.p2,z=box2d.b2SubVV(A,B,box2d.b2DynamicTree.s_r);box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<z.GetLengthSquared());z.Normalize();var z=box2d.b2CrossOneV(z,box2d.b2DynamicTree.s_v),y=box2d.b2AbsV(z,box2d.b2DynamicTree.s_abs_v),v=C.maxFraction,u=box2d.b2DynamicTree.s_segmentAABB,r=B.x+v*(A.x-B.x),s=B.y+v*(A.y-B.y);u.lowerBound.x=box2d.b2Min(B.x,r);u.lowerBound.y=box2d.b2Min(B.y,s);u.upperBound.x=box2d.b2Max(B.x,r);u.upperBound.y=box2d.b2Max(B.y,s);var q=box2d.b2DynamicTree.s_stack.Reset();for(q.Push(this.m_root);0<q.GetCount();){if(r=q.Pop(),null!==r&&!1!==box2d.b2TestOverlapAABB(r.aabb,u)){var s=r.aabb.GetCenter(),j=r.aabb.GetExtents();if(!(0<box2d.b2Abs(box2d.b2DotVV(z,box2d.b2SubVV(B,s,box2d.b2Vec2.s_t0)))-box2d.b2DotVV(y,j))){if(r.IsLeaf()){s=box2d.b2DynamicTree.s_subInput;s.p1.Copy(C.p1);s.p2.Copy(C.p2);s.maxFraction=v;r=D(s,r);if(0===r){break}0<r&&(v=r,r=B.x+v*(A.x-B.x),s=B.y+v*(A.y-B.y),u.lowerBound.x=box2d.b2Min(B.x,r),u.lowerBound.y=box2d.b2Min(B.y,s),u.upperBound.x=box2d.b2Max(B.x,r),u.upperBound.y=box2d.b2Max(B.y,s))}else{q.Push(r.child1),q.Push(r.child2)}}}}}};goog.exportProperty(box2d.b2DynamicTree.prototype,"RayCast",box2d.b2DynamicTree.prototype.RayCast);box2d.b2DynamicTree.prototype.AllocateNode=function(){if(this.m_freeList){var b=this.m_freeList;this.m_freeList=b.parent;b.parent=null;b.child1=null;b.child2=null;b.height=0;b.userData=null;return b}return new box2d.b2TreeNode(box2d.b2DynamicTree.prototype.s_node_id++)};goog.exportProperty(box2d.b2DynamicTree.prototype,"AllocateNode",box2d.b2DynamicTree.prototype.AllocateNode);box2d.b2DynamicTree.prototype.s_node_id=0;box2d.b2DynamicTree.prototype.FreeNode=function(b){b.parent=this.m_freeList;b.height=-1;this.m_freeList=b};goog.exportProperty(box2d.b2DynamicTree.prototype,"FreeNode",box2d.b2DynamicTree.prototype.FreeNode);box2d.b2DynamicTree.prototype.CreateProxy=function(g,f){var m=this.AllocateNode(),k=box2d.b2_aabbExtension,j=box2d.b2_aabbExtension;m.aabb.lowerBound.x=g.lowerBound.x-k;m.aabb.lowerBound.y=g.lowerBound.y-j;m.aabb.upperBound.x=g.upperBound.x+k;m.aabb.upperBound.y=g.upperBound.y+j;m.userData=f;m.height=0;this.InsertLeaf(m);return m};goog.exportProperty(box2d.b2DynamicTree.prototype,"CreateProxy",box2d.b2DynamicTree.prototype.CreateProxy);box2d.b2DynamicTree.prototype.DestroyProxy=function(b){box2d.ENABLE_ASSERTS&&box2d.b2Assert(b.IsLeaf());this.RemoveLeaf(b);this.FreeNode(b)};goog.exportProperty(box2d.b2DynamicTree.prototype,"DestroyProxy",box2d.b2DynamicTree.prototype.DestroyProxy);box2d.b2DynamicTree.prototype.MoveProxy=function(f,e,j){box2d.ENABLE_ASSERTS&&box2d.b2Assert(f.IsLeaf());if(f.aabb.Contains(e)){return !1}this.RemoveLeaf(f);var g=box2d.b2_aabbExtension+box2d.b2_aabbMultiplier*(0<j.x?j.x:-j.x);j=box2d.b2_aabbExtension+box2d.b2_aabbMultiplier*(0<j.y?j.y:-j.y);f.aabb.lowerBound.x=e.lowerBound.x-g;f.aabb.lowerBound.y=e.lowerBound.y-j;f.aabb.upperBound.x=e.upperBound.x+g;f.aabb.upperBound.y=e.upperBound.y+j;this.InsertLeaf(f);return !0};goog.exportProperty(box2d.b2DynamicTree.prototype,"MoveProxy",box2d.b2DynamicTree.prototype.MoveProxy);box2d.b2DynamicTree.prototype.InsertLeaf=function(B){++this.m_insertionCount;if(null===this.m_root){this.m_root=B,this.m_root.parent=null}else{var A=B.aabb;A.GetCenter();for(var z=this.m_root,y,v;!1===z.IsLeaf();){y=z.child1;v=z.child2;var u=z.aabb.GetPerimeter(),s=box2d.b2DynamicTree.s_combinedAABB;s.Combine2(z.aabb,A);var r=s.GetPerimeter(),s=2*r,r=2*(r-u),n=box2d.b2DynamicTree.s_aabb,q,j;y.IsLeaf()?(n.Combine2(A,y.aabb),u=n.GetPerimeter()+r):(n.Combine2(A,y.aabb),q=y.aabb.GetPerimeter(),j=n.GetPerimeter(),u=j-q+r);v.IsLeaf()?(n.Combine2(A,v.aabb),r=n.GetPerimeter()+r):(n.Combine2(A,v.aabb),q=v.aabb.GetPerimeter(),j=n.GetPerimeter(),r=j-q+r);if(s<u&&s<r){break}z=u<r?y:v}y=z.parent;v=this.AllocateNode();v.parent=y;v.userData=null;v.aabb.Combine2(A,z.aabb);v.height=z.height+1;y?(y.child1===z?y.child1=v:y.child2=v,v.child1=z,v.child2=B,z.parent=v,B.parent=v):(v.child1=z,v.child2=B,z.parent=v,this.m_root=B.parent=v);for(z=B.parent;null!==z;){z=this.Balance(z),y=z.child1,v=z.child2,box2d.ENABLE_ASSERTS&&box2d.b2Assert(null!==y),box2d.ENABLE_ASSERTS&&box2d.b2Assert(null!==v),z.height=1+box2d.b2Max(y.height,v.height),z.aabb.Combine2(y.aabb,v.aabb),z=z.parent}}};goog.exportProperty(box2d.b2DynamicTree.prototype,"InsertLeaf",box2d.b2DynamicTree.prototype.InsertLeaf);box2d.b2DynamicTree.prototype.RemoveLeaf=function(e){if(e===this.m_root){this.m_root=null}else{var d=e.parent,f=d.parent;e=d.child1===e?d.child2:d.child1;if(f){for(f.child1===d?f.child1=e:f.child2=e,e.parent=f,this.FreeNode(d),d=f;d;){d=this.Balance(d),f=d.child1,e=d.child2,d.aabb.Combine2(f.aabb,e.aabb),d.height=1+box2d.b2Max(f.height,e.height),d=d.parent}}else{this.m_root=e,e.parent=null,this.FreeNode(d)}}};goog.exportProperty(box2d.b2DynamicTree.prototype,"RemoveLeaf",box2d.b2DynamicTree.prototype.RemoveLeaf);box2d.b2DynamicTree.prototype.Balance=function(g){box2d.ENABLE_ASSERTS&&box2d.b2Assert(null!==g);if(g.IsLeaf()||2>g.height){return g}var f=g.child1,m=g.child2,k=m.height-f.height;if(1<k){var k=m.child1,j=m.child2;m.child1=g;m.parent=g.parent;g.parent=m;null!==m.parent?m.parent.child1===g?m.parent.child1=m:(box2d.ENABLE_ASSERTS&&box2d.b2Assert(m.parent.child2===g),m.parent.child2=m):this.m_root=m;k.height>j.height?(m.child2=k,g.child2=j,j.parent=g,g.aabb.Combine2(f.aabb,j.aabb),m.aabb.Combine2(g.aabb,k.aabb),g.height=1+box2d.b2Max(f.height,j.height),m.height=1+box2d.b2Max(g.height,k.height)):(m.child2=j,g.child2=k,k.parent=g,g.aabb.Combine2(f.aabb,k.aabb),m.aabb.Combine2(g.aabb,j.aabb),g.height=1+box2d.b2Max(f.height,k.height),m.height=1+box2d.b2Max(g.height,j.height));return m}return -1>k?(k=f.child1,j=f.child2,f.child1=g,f.parent=g.parent,g.parent=f,null!==f.parent?f.parent.child1===g?f.parent.child1=f:(box2d.ENABLE_ASSERTS&&box2d.b2Assert(f.parent.child2===g),f.parent.child2=f):this.m_root=f,k.height>j.height?(f.child2=k,g.child1=j,j.parent=g,g.aabb.Combine2(m.aabb,j.aabb),f.aabb.Combine2(g.aabb,k.aabb),g.height=1+box2d.b2Max(m.height,j.height),f.height=1+box2d.b2Max(g.height,k.height)):(f.child2=j,g.child1=k,k.parent=g,g.aabb.Combine2(m.aabb,k.aabb),f.aabb.Combine2(g.aabb,j.aabb),g.height=1+box2d.b2Max(m.height,k.height),f.height=1+box2d.b2Max(g.height,j.height)),f):g};goog.exportProperty(box2d.b2DynamicTree.prototype,"Balance",box2d.b2DynamicTree.prototype.Balance);box2d.b2DynamicTree.prototype.GetHeight=function(){return null===this.m_root?0:this.m_root.height};goog.exportProperty(box2d.b2DynamicTree.prototype,"GetHeight",box2d.b2DynamicTree.prototype.GetHeight);box2d.b2DynamicTree.prototype.GetAreaRatio=function(){if(null===this.m_root){return 0}var e=this.m_root.aabb.GetPerimeter(),d=function(b){if(null===b||b.IsLeaf()){return 0}var f=b.aabb.GetPerimeter(),f=f+d(b.child1);return f+=d(b.child2)};return d(this.m_root)/e};goog.exportProperty(box2d.b2DynamicTree.prototype,"GetAreaRatio",box2d.b2DynamicTree.prototype.GetAreaRatio);box2d.b2DynamicTree.prototype.ComputeHeightNode=function(e){if(e.IsLeaf()){return 0}var d=this.ComputeHeightNode(e.child1);e=this.ComputeHeightNode(e.child2);return 1+box2d.b2Max(d,e)};goog.exportProperty(box2d.b2DynamicTree.prototype,"ComputeHeightNode",box2d.b2DynamicTree.prototype.ComputeHeightNode);box2d.b2DynamicTree.prototype.ComputeHeight=function(){return this.ComputeHeightNode(this.m_root)};goog.exportProperty(box2d.b2DynamicTree.prototype,"ComputeHeight",box2d.b2DynamicTree.prototype.ComputeHeight);box2d.b2DynamicTree.prototype.ValidateStructure=function(e){if(null!==e){e===this.m_root&&box2d.ENABLE_ASSERTS&&box2d.b2Assert(null===e.parent);var d=e.child1,f=e.child2;e.IsLeaf()?(box2d.ENABLE_ASSERTS&&box2d.b2Assert(null===d),box2d.ENABLE_ASSERTS&&box2d.b2Assert(null===f),box2d.ENABLE_ASSERTS&&box2d.b2Assert(0===e.height)):(box2d.ENABLE_ASSERTS&&box2d.b2Assert(d.parent===e),box2d.ENABLE_ASSERTS&&box2d.b2Assert(f.parent===e),this.ValidateStructure(d),this.ValidateStructure(f))}};goog.exportProperty(box2d.b2DynamicTree.prototype,"ValidateStructure",box2d.b2DynamicTree.prototype.ValidateStructure);box2d.b2DynamicTree.prototype.ValidateMetrics=function(f){if(null!==f){var e=f.child1,j=f.child2;if(f.IsLeaf()){box2d.ENABLE_ASSERTS&&box2d.b2Assert(null===e),box2d.ENABLE_ASSERTS&&box2d.b2Assert(null===j),box2d.ENABLE_ASSERTS&&box2d.b2Assert(0===f.height)}else{var g;g=1+box2d.b2Max(e.height,j.height);box2d.ENABLE_ASSERTS&&box2d.b2Assert(f.height===g);g=box2d.b2DynamicTree.s_aabb;g.Combine2(e.aabb,j.aabb);box2d.ENABLE_ASSERTS&&box2d.b2Assert(g.lowerBound===f.aabb.lowerBound);box2d.ENABLE_ASSERTS&&box2d.b2Assert(g.upperBound===f.aabb.upperBound);this.ValidateMetrics(e);this.ValidateMetrics(j)}}};goog.exportProperty(box2d.b2DynamicTree.prototype,"ValidateMetrics",box2d.b2DynamicTree.prototype.ValidateMetrics);box2d.b2DynamicTree.prototype.Validate=function(){this.ValidateStructure(this.m_root);this.ValidateMetrics(this.m_root);for(var e=0,d=this.m_freeList;null!==d;){d=d.parent,++e}box2d.ENABLE_ASSERTS&&box2d.b2Assert(this.GetHeight()===this.ComputeHeight())};goog.exportProperty(box2d.b2DynamicTree.prototype,"Validate",box2d.b2DynamicTree.prototype.Validate);box2d.b2DynamicTree.prototype.GetMaxBalance=function(){var b;b=this.m_root;null===b?b=0:1>=b.height?b=0:(box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1===b.IsLeaf()),b=box2d.b2Abs(b.child2.height-b.child1.height),b=box2d.b2Max(0,b));return b};goog.exportProperty(box2d.b2DynamicTree.prototype,"GetMaxBalance",box2d.b2DynamicTree.prototype.GetMaxBalance);box2d.b2DynamicTree.prototype.RebuildBottomUp=function(){this.Validate()};goog.exportProperty(box2d.b2DynamicTree.prototype,"RebuildBottomUp",box2d.b2DynamicTree.prototype.RebuildBottomUp);box2d.b2DynamicTree.prototype.ShiftOrigin=function(e){var d=function(b,g){if(null!==b&&!(1>=b.height)){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1===b.IsLeaf());var f=b.child2;d(b.child1,g);d(f,g);b.aabb.lowerBound.SelfSub(g);b.aabb.upperBound.SelfSub(g)}};d(this.m_root,e)};goog.exportProperty(box2d.b2DynamicTree.prototype,"ShiftOrigin",box2d.b2DynamicTree.prototype.ShiftOrigin);box2d.b2Pair=function(){};goog.exportSymbol("box2d.b2Pair",box2d.b2Pair);box2d.b2Pair.prototype.proxyA=null;goog.exportProperty(box2d.b2Pair.prototype,"proxyA",box2d.b2Pair.prototype.proxyA);box2d.b2Pair.prototype.proxyB=null;goog.exportProperty(box2d.b2Pair.prototype,"proxyB",box2d.b2Pair.prototype.proxyB);box2d.b2BroadPhase=function(){this.m_tree=new box2d.b2DynamicTree;this.m_moveBuffer=[];this.m_pairBuffer=[]};goog.exportSymbol("box2d.b2BroadPhase",box2d.b2BroadPhase);box2d.b2BroadPhase.prototype.m_tree=null;goog.exportProperty(box2d.b2BroadPhase.prototype,"m_tree",box2d.b2BroadPhase.prototype.m_tree);box2d.b2BroadPhase.prototype.m_proxyCount=0;goog.exportProperty(box2d.b2BroadPhase.prototype,"m_proxyCount",box2d.b2BroadPhase.prototype.m_proxyCount);box2d.b2BroadPhase.prototype.m_moveCount=0;goog.exportProperty(box2d.b2BroadPhase.prototype,"m_moveCount",box2d.b2BroadPhase.prototype.m_moveCount);box2d.b2BroadPhase.prototype.m_moveBuffer=null;goog.exportProperty(box2d.b2BroadPhase.prototype,"m_moveBuffer",box2d.b2BroadPhase.prototype.m_moveBuffer);box2d.b2BroadPhase.prototype.m_pairCount=0;goog.exportProperty(box2d.b2BroadPhase.prototype,"m_pairCount",box2d.b2BroadPhase.prototype.m_pairCount);box2d.b2BroadPhase.prototype.m_pairBuffer=null;goog.exportProperty(box2d.b2BroadPhase.prototype,"m_pairBuffer",box2d.b2BroadPhase.prototype.m_pairBuffer);box2d.b2BroadPhase.prototype.CreateProxy=function(e,d){var f=this.m_tree.CreateProxy(e,d);++this.m_proxyCount;this.BufferMove(f);return f};goog.exportProperty(box2d.b2BroadPhase.prototype,"CreateProxy",box2d.b2BroadPhase.prototype.CreateProxy);box2d.b2BroadPhase.prototype.DestroyProxy=function(b){this.UnBufferMove(b);--this.m_proxyCount;this.m_tree.DestroyProxy(b)};goog.exportProperty(box2d.b2BroadPhase.prototype,"DestroyProxy",box2d.b2BroadPhase.prototype.DestroyProxy);box2d.b2BroadPhase.prototype.MoveProxy=function(e,d,f){this.m_tree.MoveProxy(e,d,f)&&this.BufferMove(e)};goog.exportProperty(box2d.b2BroadPhase.prototype,"MoveProxy",box2d.b2BroadPhase.prototype.MoveProxy);box2d.b2BroadPhase.prototype.TouchProxy=function(b){this.BufferMove(b)};goog.exportProperty(box2d.b2BroadPhase.prototype,"TouchProxy",box2d.b2BroadPhase.prototype.TouchProxy);box2d.b2BroadPhase.prototype.GetFatAABB=function(b){return this.m_tree.GetFatAABB(b)};goog.exportProperty(box2d.b2BroadPhase.prototype,"GetFatAABB",box2d.b2BroadPhase.prototype.GetFatAABB);box2d.b2BroadPhase.prototype.GetUserData=function(b){return this.m_tree.GetUserData(b)};goog.exportProperty(box2d.b2BroadPhase.prototype,"GetUserData",box2d.b2BroadPhase.prototype.GetUserData);box2d.b2BroadPhase.prototype.TestOverlap=function(f,e){var j=this.m_tree.GetFatAABB(f),g=this.m_tree.GetFatAABB(e);return box2d.b2TestOverlapAABB(j,g)};goog.exportProperty(box2d.b2BroadPhase.prototype,"TestOverlap",box2d.b2BroadPhase.prototype.TestOverlap);box2d.b2BroadPhase.prototype.GetProxyCount=function(){return this.m_proxyCount};goog.exportProperty(box2d.b2BroadPhase.prototype,"GetProxyCount",box2d.b2BroadPhase.prototype.GetProxyCount);box2d.b2BroadPhase.prototype.GetTreeHeight=function(){return this.m_tree.GetHeight()};goog.exportProperty(box2d.b2BroadPhase.prototype,"GetTreeHeight",box2d.b2BroadPhase.prototype.GetTreeHeight);box2d.b2BroadPhase.prototype.GetTreeBalance=function(){return this.m_tree.GetMaxBalance()};goog.exportProperty(box2d.b2BroadPhase.prototype,"GetTreeBalance",box2d.b2BroadPhase.prototype.GetTreeBalance);box2d.b2BroadPhase.prototype.GetTreeQuality=function(){return this.m_tree.GetAreaRatio()};goog.exportProperty(box2d.b2BroadPhase.prototype,"GetTreeQuality",box2d.b2BroadPhase.prototype.GetTreeQuality);box2d.b2BroadPhase.prototype.ShiftOrigin=function(b){this.m_tree.ShiftOrigin(b)};goog.exportProperty(box2d.b2BroadPhase.prototype,"ShiftOrigin",box2d.b2BroadPhase.prototype.ShiftOrigin);box2d.b2BroadPhase.prototype.UpdatePairs=function(k){for(var j=this.m_pairCount=0;j<this.m_moveCount;++j){var s=this.m_moveBuffer[j];if(null!==s){var r=this,q=this.m_tree.GetFatAABB(s);this.m_tree.Query(function(e){if(e.m_id===s.m_id){return !0}r.m_pairCount===r.m_pairBuffer.length&&(r.m_pairBuffer[r.m_pairCount]=new box2d.b2Pair);var d=r.m_pairBuffer[r.m_pairCount];e.m_id<s.m_id?(d.proxyA=e,d.proxyB=s):(d.proxyA=s,d.proxyB=e);++r.m_pairCount;return !0},q)}}this.m_moveCount=0;this.m_pairBuffer.length=this.m_pairCount;this.m_pairBuffer.sort(box2d.b2PairLessThan);for(j=0;j<this.m_pairCount;){var q=this.m_pairBuffer[j],n=this.m_tree.GetUserData(q.proxyA),m=this.m_tree.GetUserData(q.proxyB);k.AddPair(n,m);for(++j;j<this.m_pairCount;){n=this.m_pairBuffer[j];if(n.proxyA.m_id!==q.proxyA.m_id||n.proxyB.m_id!==q.proxyB.m_id){break}++j}}};goog.exportProperty(box2d.b2BroadPhase.prototype,"UpdatePairs",box2d.b2BroadPhase.prototype.UpdatePairs);box2d.b2BroadPhase.prototype.Query=function(e,d){this.m_tree.Query(e,d)};goog.exportProperty(box2d.b2BroadPhase.prototype,"Query",box2d.b2BroadPhase.prototype.Query);box2d.b2BroadPhase.prototype.RayCast=function(e,d){this.m_tree.RayCast(e,d)};goog.exportProperty(box2d.b2BroadPhase.prototype,"RayCast",box2d.b2BroadPhase.prototype.RayCast);box2d.b2BroadPhase.prototype.BufferMove=function(b){this.m_moveBuffer[this.m_moveCount]=b;++this.m_moveCount};goog.exportProperty(box2d.b2BroadPhase.prototype,"BufferMove",box2d.b2BroadPhase.prototype.BufferMove);box2d.b2BroadPhase.prototype.UnBufferMove=function(b){b=this.m_moveBuffer.indexOf(b);this.m_moveBuffer[b]=null};goog.exportProperty(box2d.b2BroadPhase.prototype,"UnBufferMove",box2d.b2BroadPhase.prototype.UnBufferMove);box2d.b2PairLessThan=function(e,d){return e.proxyA.m_id===d.proxyA.m_id?e.proxyB.m_id-d.proxyB.m_id:e.proxyA.m_id-d.proxyA.m_id};box2d.b2MassData=function(){this.center=new box2d.b2Vec2(0,0)};goog.exportSymbol("box2d.b2MassData",box2d.b2MassData);box2d.b2MassData.prototype.mass=0;goog.exportProperty(box2d.b2MassData.prototype,"mass",box2d.b2MassData.prototype.mass);box2d.b2MassData.prototype.center=null;goog.exportProperty(box2d.b2MassData.prototype,"center",box2d.b2MassData.prototype.center);box2d.b2MassData.prototype.I=0;goog.exportProperty(box2d.b2MassData.prototype,"I",box2d.b2MassData.prototype.I);box2d.b2ShapeType={e_unknown:-1,e_circleShape:0,e_edgeShape:1,e_polygonShape:2,e_chainShape:3,e_shapeTypeCount:4};goog.exportSymbol("box2d.b2ShapeType",box2d.b2ShapeType);goog.exportProperty(box2d.b2ShapeType,"e_unknown",box2d.b2ShapeType.e_unknown);goog.exportProperty(box2d.b2ShapeType,"e_circleShape",box2d.b2ShapeType.e_circleShape);goog.exportProperty(box2d.b2ShapeType,"e_edgeShape",box2d.b2ShapeType.e_edgeShape);goog.exportProperty(box2d.b2ShapeType,"e_polygonShape",box2d.b2ShapeType.e_polygonShape);goog.exportProperty(box2d.b2ShapeType,"e_chainShape",box2d.b2ShapeType.e_chainShape);goog.exportProperty(box2d.b2ShapeType,"e_shapeTypeCount",box2d.b2ShapeType.e_shapeTypeCount);box2d.b2Shape=function(e,d){this.m_type=e;this.m_radius=d};goog.exportSymbol("box2d.b2Shape",box2d.b2Shape);box2d.b2Shape.prototype.m_type=box2d.b2ShapeType.e_unknown;goog.exportProperty(box2d.b2Shape.prototype,"m_type",box2d.b2Shape.prototype.m_type);box2d.b2Shape.prototype.m_radius=0;goog.exportProperty(box2d.b2Shape.prototype,"m_radius",box2d.b2Shape.prototype.m_radius);box2d.b2Shape.prototype.Clone=function(){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1);return null};goog.exportProperty(box2d.b2Shape.prototype,"Clone",box2d.b2Shape.prototype.Clone);box2d.b2Shape.prototype.Copy=function(b){box2d.ENABLE_ASSERTS&&box2d.b2Assert(this.m_type===b.m_type);this.m_radius=b.m_radius;return this};goog.exportProperty(box2d.b2Shape.prototype,"Copy",box2d.b2Shape.prototype.Copy);box2d.b2Shape.prototype.GetType=function(){return this.m_type};goog.exportProperty(box2d.b2Shape.prototype,"GetType",box2d.b2Shape.prototype.GetType);box2d.b2Shape.prototype.GetChildCount=function(){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1,"pure virtual");return 0};goog.exportProperty(box2d.b2Shape.prototype,"GetChildCount",box2d.b2Shape.prototype.GetChildCount);box2d.b2Shape.prototype.TestPoint=function(e,d){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1,"pure virtual");return !1};goog.exportProperty(box2d.b2Shape.prototype,"TestPoint",box2d.b2Shape.prototype.TestPoint);box2d.b2Shape.prototype.RayCast=function(f,e,j,g){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1,"pure virtual");return !1};goog.exportProperty(box2d.b2Shape.prototype,"RayCast",box2d.b2Shape.prototype.RayCast);box2d.b2Shape.prototype.ComputeAABB=function(e,d,f){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1,"pure virtual")};goog.exportProperty(box2d.b2Shape.prototype,"ComputeAABB",box2d.b2Shape.prototype.ComputeAABB);box2d.b2Shape.prototype.ComputeMass=function(e,d){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1,"pure virtual")};goog.exportProperty(box2d.b2Shape.prototype,"ComputeMass",box2d.b2Shape.prototype.ComputeMass);box2d.b2Shape.prototype.SetupDistanceProxy=function(e,d){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1,"pure virtual")};box2d.b2Shape.prototype.ComputeSubmergedArea=function(f,e,j,g){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1,"pure virtual");return 0};goog.exportProperty(box2d.b2Shape.prototype,"ComputeSubmergedArea",box2d.b2Shape.prototype.ComputeSubmergedArea);box2d.b2Shape.prototype.Dump=function(){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1,"pure virtual")};goog.exportProperty(box2d.b2Shape.prototype,"Dump",box2d.b2Shape.prototype.Dump);box2d.b2CircleShape=function(b){box2d.b2Shape.call(this,box2d.b2ShapeType.e_circleShape,b||0);this.m_p=new box2d.b2Vec2};goog.inherits(box2d.b2CircleShape,box2d.b2Shape);goog.exportSymbol("box2d.b2CircleShape",box2d.b2CircleShape);box2d.b2CircleShape.prototype.m_p=null;goog.exportProperty(box2d.b2CircleShape.prototype,"m_p",box2d.b2CircleShape.prototype.m_p);box2d.b2CircleShape.prototype.Clone=function(){return(new box2d.b2CircleShape).Copy(this)};goog.exportProperty(box2d.b2CircleShape.prototype,"Clone",box2d.b2CircleShape.prototype.Clone);box2d.b2CircleShape.prototype.Copy=function(b){box2d.b2Shape.prototype.Copy.call(this,b);box2d.ENABLE_ASSERTS&&box2d.b2Assert(b instanceof box2d.b2CircleShape);this.m_p.Copy(b.m_p);return this};goog.exportProperty(box2d.b2CircleShape.prototype,"Copy",box2d.b2CircleShape.prototype.Copy);box2d.b2CircleShape.prototype.GetChildCount=function(){return 1};goog.exportProperty(box2d.b2CircleShape.prototype,"GetChildCount",box2d.b2CircleShape.prototype.GetChildCount);box2d.b2CircleShape.prototype.TestPoint=function(e,d){var f=box2d.b2MulXV(e,this.m_p,box2d.b2CircleShape.prototype.TestPoint.s_center),f=box2d.b2SubVV(d,f,box2d.b2CircleShape.prototype.TestPoint.s_d);return box2d.b2DotVV(f,f)<=box2d.b2Sq(this.m_radius)};goog.exportProperty(box2d.b2CircleShape.prototype,"TestPoint",box2d.b2CircleShape.prototype.TestPoint);box2d.b2CircleShape.prototype.TestPoint.s_center=new box2d.b2Vec2;box2d.b2CircleShape.prototype.TestPoint.s_d=new box2d.b2Vec2;box2d.b2CircleShape.prototype.RayCast=function(k,j,s,r){s=box2d.b2MulXV(s,this.m_p,box2d.b2CircleShape.prototype.RayCast.s_position);s=box2d.b2SubVV(j.p1,s,box2d.b2CircleShape.prototype.RayCast.s_s);var q=box2d.b2DotVV(s,s)-box2d.b2Sq(this.m_radius);r=box2d.b2SubVV(j.p2,j.p1,box2d.b2CircleShape.prototype.RayCast.s_r);var n=box2d.b2DotVV(s,r),m=box2d.b2DotVV(r,r),q=n*n-m*q;if(0>q||m<box2d.b2_epsilon){return !1}n=-(n+box2d.b2Sqrt(q));return 0<=n&&n<=j.maxFraction*m?(n/=m,k.fraction=n,box2d.b2AddVMulSV(s,n,r,k.normal).SelfNormalize(),!0):!1};goog.exportProperty(box2d.b2CircleShape.prototype,"RayCast",box2d.b2CircleShape.prototype.RayCast);box2d.b2CircleShape.prototype.RayCast.s_position=new box2d.b2Vec2;box2d.b2CircleShape.prototype.RayCast.s_s=new box2d.b2Vec2;box2d.b2CircleShape.prototype.RayCast.s_r=new box2d.b2Vec2;box2d.b2CircleShape.prototype.ComputeAABB=function(e,d,f){d=box2d.b2MulXV(d,this.m_p,box2d.b2CircleShape.prototype.ComputeAABB.s_p);e.lowerBound.SetXY(d.x-this.m_radius,d.y-this.m_radius);e.upperBound.SetXY(d.x+this.m_radius,d.y+this.m_radius)};goog.exportProperty(box2d.b2CircleShape.prototype,"ComputeAABB",box2d.b2CircleShape.prototype.ComputeAABB);box2d.b2CircleShape.prototype.ComputeAABB.s_p=new box2d.b2Vec2;box2d.b2CircleShape.prototype.ComputeMass=function(e,d){var f=box2d.b2Sq(this.m_radius);e.mass=d*box2d.b2_pi*f;e.center.Copy(this.m_p);e.I=e.mass*(0.5*f+box2d.b2DotVV(this.m_p,this.m_p))};goog.exportProperty(box2d.b2CircleShape.prototype,"ComputeMass",box2d.b2CircleShape.prototype.ComputeMass);box2d.b2CircleShape.prototype.SetupDistanceProxy=function(e,d){e.m_vertices=e.m_buffer;e.m_vertices[0].Copy(this.m_p);e.m_count=1;e.m_radius=this.m_radius};box2d.b2CircleShape.prototype.ComputeSubmergedArea=function(j,g,q,n){q=box2d.b2MulXV(q,this.m_p,new box2d.b2Vec2);var m=-(box2d.b2DotVV(j,q)-g);if(m<-this.m_radius+box2d.b2_epsilon){return 0}if(m>this.m_radius){return n.Copy(q),box2d.b2_pi*this.m_radius*this.m_radius}g=this.m_radius*this.m_radius;var k=m*m,m=g*(box2d.b2Asin(m/this.m_radius)+box2d.b2_pi/2)+m*box2d.b2Sqrt(g-k);g=-2/3*box2d.b2Pow(g-k,1.5)/m;n.x=q.x+j.x*g;n.y=q.y+j.y*g;return m};goog.exportProperty(box2d.b2CircleShape.prototype,"ComputeSubmergedArea",box2d.b2CircleShape.prototype.ComputeSubmergedArea);box2d.b2CircleShape.prototype.Dump=function(){box2d.b2Log("    /*box2d.b2CircleShape*/ var shape = new box2d.b2CircleShape();\n");box2d.b2Log("    shape.m_radius = %.15f;\n",this.m_radius);box2d.b2Log("    shape.m_p.SetXY(%.15f, %.15f);\n",this.m_p.x,this.m_p.y)};goog.exportProperty(box2d.b2CircleShape.prototype,"Dump",box2d.b2CircleShape.prototype.Dump);box2d.b2EdgeShape=function(){box2d.b2Shape.call(this,box2d.b2ShapeType.e_edgeShape,box2d.b2_polygonRadius);this.m_vertex1=new box2d.b2Vec2;this.m_vertex2=new box2d.b2Vec2;this.m_vertex0=new box2d.b2Vec2;this.m_vertex3=new box2d.b2Vec2};goog.inherits(box2d.b2EdgeShape,box2d.b2Shape);goog.exportSymbol("box2d.b2EdgeShape",box2d.b2EdgeShape);box2d.b2EdgeShape.prototype.m_vertex1=null;goog.exportProperty(box2d.b2EdgeShape.prototype,"m_vertex1",box2d.b2EdgeShape.prototype.m_vertex1);box2d.b2EdgeShape.prototype.m_vertex2=null;goog.exportProperty(box2d.b2EdgeShape.prototype,"m_vertex2",box2d.b2EdgeShape.prototype.m_vertex2);box2d.b2EdgeShape.prototype.m_vertex0=null;goog.exportProperty(box2d.b2EdgeShape.prototype,"m_vertex0",box2d.b2EdgeShape.prototype.m_vertex0);box2d.b2EdgeShape.prototype.m_vertex3=null;goog.exportProperty(box2d.b2EdgeShape.prototype,"m_vertex3",box2d.b2EdgeShape.prototype.m_vertex3);box2d.b2EdgeShape.prototype.m_hasVertex0=!1;goog.exportProperty(box2d.b2EdgeShape.prototype,"m_hasVertex0",box2d.b2EdgeShape.prototype.m_hasVertex0);box2d.b2EdgeShape.prototype.m_hasVertex3=!1;goog.exportProperty(box2d.b2EdgeShape.prototype,"m_hasVertex3",box2d.b2EdgeShape.prototype.m_hasVertex3);box2d.b2EdgeShape.prototype.Set=function(e,d){this.m_vertex1.Copy(e);this.m_vertex2.Copy(d);this.m_hasVertex3=this.m_hasVertex0=!1;return this};goog.exportProperty(box2d.b2EdgeShape.prototype,"Set",box2d.b2EdgeShape.prototype.Set);box2d.b2EdgeShape.prototype.SetAsEdge=box2d.b2EdgeShape.prototype.Set;box2d.b2EdgeShape.prototype.Clone=function(){return(new box2d.b2EdgeShape).Copy(this)};goog.exportProperty(box2d.b2EdgeShape.prototype,"Clone",box2d.b2EdgeShape.prototype.Clone);box2d.b2EdgeShape.prototype.Copy=function(b){box2d.b2Shape.prototype.Copy.call(this,b);box2d.ENABLE_ASSERTS&&box2d.b2Assert(b instanceof box2d.b2EdgeShape);this.m_vertex1.Copy(b.m_vertex1);this.m_vertex2.Copy(b.m_vertex2);this.m_vertex0.Copy(b.m_vertex0);this.m_vertex3.Copy(b.m_vertex3);this.m_hasVertex0=b.m_hasVertex0;this.m_hasVertex3=b.m_hasVertex3;return this};goog.exportProperty(box2d.b2EdgeShape.prototype,"Copy",box2d.b2EdgeShape.prototype.Copy);box2d.b2EdgeShape.prototype.GetChildCount=function(){return 1};goog.exportProperty(box2d.b2EdgeShape.prototype,"GetChildCount",box2d.b2EdgeShape.prototype.GetChildCount);box2d.b2EdgeShape.prototype.TestPoint=function(e,d){return !1};goog.exportProperty(box2d.b2EdgeShape.prototype,"TestPoint",box2d.b2EdgeShape.prototype.TestPoint);box2d.b2EdgeShape.prototype.RayCast=function(v,u,s,r){var q=box2d.b2MulTXV(s,u.p1,box2d.b2EdgeShape.prototype.RayCast.s_p1);r=box2d.b2MulTXV(s,u.p2,box2d.b2EdgeShape.prototype.RayCast.s_p2);var n=box2d.b2SubVV(r,q,box2d.b2EdgeShape.prototype.RayCast.s_d);r=this.m_vertex1;var m=this.m_vertex2,k=box2d.b2SubVV(m,r,box2d.b2EdgeShape.prototype.RayCast.s_e),j=v.normal.SetXY(k.y,-k.x).SelfNormalize(),k=box2d.b2DotVV(j,box2d.b2SubVV(r,q,box2d.b2Vec2.s_t0)),j=box2d.b2DotVV(j,n);if(0===j){return !1}j=k/j;if(0>j||u.maxFraction<j){return !1}u=box2d.b2AddVMulSV(q,j,n,box2d.b2EdgeShape.prototype.RayCast.s_q);q=box2d.b2SubVV(m,r,box2d.b2EdgeShape.prototype.RayCast.s_r);m=box2d.b2DotVV(q,q);if(0===m){return !1}r=box2d.b2DotVV(box2d.b2SubVV(u,r,box2d.b2Vec2.s_t0),q)/m;if(0>r||1<r){return !1}v.fraction=j;box2d.b2MulRV(s.q,v.normal,v.normal);0<k&&v.normal.SelfNeg();return !0};goog.exportProperty(box2d.b2EdgeShape.prototype,"RayCast",box2d.b2EdgeShape.prototype.RayCast);box2d.b2EdgeShape.prototype.RayCast.s_p1=new box2d.b2Vec2;box2d.b2EdgeShape.prototype.RayCast.s_p2=new box2d.b2Vec2;box2d.b2EdgeShape.prototype.RayCast.s_d=new box2d.b2Vec2;box2d.b2EdgeShape.prototype.RayCast.s_e=new box2d.b2Vec2;box2d.b2EdgeShape.prototype.RayCast.s_q=new box2d.b2Vec2;box2d.b2EdgeShape.prototype.RayCast.s_r=new box2d.b2Vec2;box2d.b2EdgeShape.prototype.ComputeAABB=function(e,d,f){f=box2d.b2MulXV(d,this.m_vertex1,box2d.b2EdgeShape.prototype.ComputeAABB.s_v1);d=box2d.b2MulXV(d,this.m_vertex2,box2d.b2EdgeShape.prototype.ComputeAABB.s_v2);box2d.b2MinV(f,d,e.lowerBound);box2d.b2MaxV(f,d,e.upperBound);d=this.m_radius;e.lowerBound.SelfSubXY(d,d);e.upperBound.SelfAddXY(d,d)};goog.exportProperty(box2d.b2EdgeShape.prototype,"ComputeAABB",box2d.b2EdgeShape.prototype.ComputeAABB);box2d.b2EdgeShape.prototype.ComputeAABB.s_v1=new box2d.b2Vec2;box2d.b2EdgeShape.prototype.ComputeAABB.s_v2=new box2d.b2Vec2;box2d.b2EdgeShape.prototype.ComputeMass=function(e,d){e.mass=0;box2d.b2MidVV(this.m_vertex1,this.m_vertex2,e.center);e.I=0};goog.exportProperty(box2d.b2EdgeShape.prototype,"ComputeMass",box2d.b2EdgeShape.prototype.ComputeMass);box2d.b2EdgeShape.prototype.SetupDistanceProxy=function(e,d){e.m_vertices=e.m_buffer;e.m_vertices[0].Copy(this.m_vertex1);e.m_vertices[1].Copy(this.m_vertex2);e.m_count=2;e.m_radius=this.m_radius};box2d.b2EdgeShape.prototype.ComputeSubmergedArea=function(f,e,j,g){g.SetZero();return 0};goog.exportProperty(box2d.b2EdgeShape.prototype,"ComputeSubmergedArea",box2d.b2EdgeShape.prototype.ComputeSubmergedArea);box2d.b2EdgeShape.prototype.Dump=function(){box2d.b2Log("    /*box2d.b2EdgeShape*/ var shape = new box2d.b2EdgeShape();\n");box2d.b2Log("    shape.m_radius = %.15f;\n",this.m_radius);box2d.b2Log("    shape.m_vertex0.SetXY(%.15f, %.15f);\n",this.m_vertex0.x,this.m_vertex0.y);box2d.b2Log("    shape.m_vertex1.SetXY(%.15f, %.15f);\n",this.m_vertex1.x,this.m_vertex1.y);box2d.b2Log("    shape.m_vertex2.SetXY(%.15f, %.15f);\n",this.m_vertex2.x,this.m_vertex2.y);box2d.b2Log("    shape.m_vertex3.SetXY(%.15f, %.15f);\n",this.m_vertex3.x,this.m_vertex3.y);box2d.b2Log("    shape.m_hasVertex0 = %s;\n",this.m_hasVertex0);box2d.b2Log("    shape.m_hasVertex3 = %s;\n",this.m_hasVertex3)};goog.exportProperty(box2d.b2EdgeShape.prototype,"Dump",box2d.b2EdgeShape.prototype.Dump);box2d.b2ChainShape=function(){box2d.b2Shape.call(this,box2d.b2ShapeType.e_chainShape,box2d.b2_polygonRadius);this.m_prevVertex=new box2d.b2Vec2;this.m_nextVertex=new box2d.b2Vec2};goog.inherits(box2d.b2ChainShape,box2d.b2Shape);goog.exportSymbol("box2d.b2ChainShape",box2d.b2ChainShape);box2d.b2ChainShape.prototype.m_vertices=null;goog.exportProperty(box2d.b2ChainShape.prototype,"m_vertices",box2d.b2ChainShape.prototype.m_vertices);box2d.b2ChainShape.prototype.m_count=0;goog.exportProperty(box2d.b2ChainShape.prototype,"m_count",box2d.b2ChainShape.prototype.m_count);box2d.b2ChainShape.prototype.m_prevVertex=null;goog.exportProperty(box2d.b2ChainShape.prototype,"m_prevVertex",box2d.b2ChainShape.prototype.m_prevVertex);box2d.b2ChainShape.prototype.m_nextVertex=null;goog.exportProperty(box2d.b2ChainShape.prototype,"m_nextVertex",box2d.b2ChainShape.prototype.m_nextVertex);box2d.b2ChainShape.prototype.m_hasPrevVertex=!1;goog.exportProperty(box2d.b2ChainShape.prototype,"m_hasPrevVertex",box2d.b2ChainShape.prototype.m_hasPrevVertex);box2d.b2ChainShape.prototype.m_hasNextVertex=!1;goog.exportProperty(box2d.b2ChainShape.prototype,"m_hasNextVertex",box2d.b2ChainShape.prototype.m_hasNextVertex);box2d.b2ChainShape.prototype.Clear=function(){this.m_vertices=null;this.m_count=0};goog.exportProperty(box2d.b2ChainShape.prototype,"Clear",box2d.b2ChainShape.prototype.Clear);box2d.b2ChainShape.prototype.CreateLoop=function(e,d){d=d||e.length;box2d.ENABLE_ASSERTS&&box2d.b2Assert(null===this.m_vertices&&0===this.m_count);box2d.ENABLE_ASSERTS&&box2d.b2Assert(3<=d);if(box2d.ENABLE_ASSERTS){for(var f=1;f<d;++f){box2d.b2Assert(box2d.b2DistanceSquaredVV(e[f-1],e[f])>box2d.b2_linearSlop*box2d.b2_linearSlop)}}this.m_count=d+1;this.m_vertices=box2d.b2Vec2.MakeArray(this.m_count);for(f=0;f<d;++f){this.m_vertices[f].Copy(e[f])}this.m_vertices[d].Copy(this.m_vertices[0]);this.m_prevVertex.Copy(this.m_vertices[this.m_count-2]);this.m_nextVertex.Copy(this.m_vertices[1]);this.m_hasNextVertex=this.m_hasPrevVertex=!0;return this};goog.exportProperty(box2d.b2ChainShape.prototype,"CreateLoop",box2d.b2ChainShape.prototype.CreateLoop);box2d.b2ChainShape.prototype.CreateChain=function(e,d){d=d||e.length;box2d.ENABLE_ASSERTS&&box2d.b2Assert(null===this.m_vertices&&0===this.m_count);box2d.ENABLE_ASSERTS&&box2d.b2Assert(2<=d);if(box2d.ENABLE_ASSERTS){for(var f=1;f<d;++f){box2d.b2Assert(box2d.b2DistanceSquaredVV(e[f-1],e[f])>box2d.b2_linearSlop*box2d.b2_linearSlop)}}this.m_count=d;this.m_vertices=box2d.b2Vec2.MakeArray(d);for(f=0;f<d;++f){this.m_vertices[f].Copy(e[f])}this.m_hasNextVertex=this.m_hasPrevVertex=!1;this.m_prevVertex.SetZero();this.m_nextVertex.SetZero();return this};goog.exportProperty(box2d.b2ChainShape.prototype,"CreateChain",box2d.b2ChainShape.prototype.CreateChain);box2d.b2ChainShape.prototype.SetPrevVertex=function(b){this.m_prevVertex.Copy(b);this.m_hasPrevVertex=!0;return this};goog.exportProperty(box2d.b2ChainShape.prototype,"SetPrevVertex",box2d.b2ChainShape.prototype.SetPrevVertex);box2d.b2ChainShape.prototype.SetNextVertex=function(b){this.m_nextVertex.Copy(b);this.m_hasNextVertex=!0;return this};goog.exportProperty(box2d.b2ChainShape.prototype,"SetNextVertex",box2d.b2ChainShape.prototype.SetNextVertex);box2d.b2ChainShape.prototype.Clone=function(){return(new box2d.b2ChainShape).Copy(this)};goog.exportProperty(box2d.b2ChainShape.prototype,"Clone",box2d.b2ChainShape.prototype.Clone);box2d.b2ChainShape.prototype.Copy=function(b){box2d.b2Shape.prototype.Copy.call(this,b);box2d.ENABLE_ASSERTS&&box2d.b2Assert(b instanceof box2d.b2ChainShape);this.CreateChain(b.m_vertices,b.m_count);this.m_prevVertex.Copy(b.m_prevVertex);this.m_nextVertex.Copy(b.m_nextVertex);this.m_hasPrevVertex=b.m_hasPrevVertex;this.m_hasNextVertex=b.m_hasNextVertex;return this};goog.exportProperty(box2d.b2ChainShape.prototype,"Copy",box2d.b2ChainShape.prototype.Copy);box2d.b2ChainShape.prototype.GetChildCount=function(){return this.m_count-1};goog.exportProperty(box2d.b2ChainShape.prototype,"GetChildCount",box2d.b2ChainShape.prototype.GetChildCount);box2d.b2ChainShape.prototype.GetChildEdge=function(e,d){box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<=d&&d<this.m_count-1);e.m_type=box2d.b2ShapeType.e_edgeShape;e.m_radius=this.m_radius;e.m_vertex1.Copy(this.m_vertices[d]);e.m_vertex2.Copy(this.m_vertices[d+1]);0<d?(e.m_vertex0.Copy(this.m_vertices[d-1]),e.m_hasVertex0=!0):(e.m_vertex0.Copy(this.m_prevVertex),e.m_hasVertex0=this.m_hasPrevVertex);d<this.m_count-2?(e.m_vertex3.Copy(this.m_vertices[d+2]),e.m_hasVertex3=!0):(e.m_vertex3.Copy(this.m_nextVertex),e.m_hasVertex3=this.m_hasNextVertex)};goog.exportProperty(box2d.b2ChainShape.prototype,"GetChildEdge",box2d.b2ChainShape.prototype.GetChildEdge);box2d.b2ChainShape.prototype.TestPoint=function(e,d){return !1};goog.exportProperty(box2d.b2ChainShape.prototype,"TestPoint",box2d.b2ChainShape.prototype.TestPoint);box2d.b2ChainShape.prototype.RayCast=function(g,f,m,k){box2d.ENABLE_ASSERTS&&box2d.b2Assert(k<this.m_count);var j=box2d.b2ChainShape.s_edgeShape;j.m_vertex1.Copy(this.m_vertices[k]);j.m_vertex2.Copy(this.m_vertices[(k+1)%this.m_count]);return j.RayCast(g,f,m,0)};goog.exportProperty(box2d.b2ChainShape.prototype,"RayCast",box2d.b2ChainShape.prototype.RayCast);box2d.b2ChainShape.s_edgeShape=new box2d.b2EdgeShape;goog.exportProperty(box2d.b2ChainShape,"s_edgeShape",box2d.b2ChainShape.s_edgeShape);box2d.b2ChainShape.prototype.ComputeAABB=function(f,e,j){box2d.ENABLE_ASSERTS&&box2d.b2Assert(j<this.m_count);var g=this.m_vertices[(j+1)%this.m_count];j=box2d.b2MulXV(e,this.m_vertices[j],box2d.b2ChainShape.prototype.ComputeAABB.s_v1);e=box2d.b2MulXV(e,g,box2d.b2ChainShape.prototype.ComputeAABB.s_v2);box2d.b2MinV(j,e,f.lowerBound);box2d.b2MaxV(j,e,f.upperBound)};goog.exportProperty(box2d.b2ChainShape.prototype,"ComputeAABB",box2d.b2ChainShape.prototype.ComputeAABB);box2d.b2ChainShape.prototype.ComputeAABB.s_v1=new box2d.b2Vec2;goog.exportProperty(box2d.b2ChainShape.prototype.ComputeAABB,"s_v1",box2d.b2ChainShape.prototype.ComputeAABB.s_v1);box2d.b2ChainShape.prototype.ComputeAABB.s_v2=new box2d.b2Vec2;goog.exportProperty(box2d.b2ChainShape.prototype.ComputeAABB,"s_v2",box2d.b2ChainShape.prototype.ComputeAABB.s_v2);box2d.b2ChainShape.prototype.ComputeMass=function(e,d){e.mass=0;e.center.SetZero();e.I=0};goog.exportProperty(box2d.b2ChainShape.prototype,"ComputeMass",box2d.b2ChainShape.prototype.ComputeMass);box2d.b2ChainShape.prototype.SetupDistanceProxy=function(e,d){box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<=d&&d<this.m_count);e.m_buffer[0].Copy(this.m_vertices[d]);d+1<this.m_count?e.m_buffer[1].Copy(this.m_vertices[d+1]):e.m_buffer[1].Copy(this.m_vertices[0]);e.m_vertices=e.m_buffer;e.m_count=2;e.m_radius=this.m_radius};box2d.b2ChainShape.prototype.ComputeSubmergedArea=function(f,e,j,g){g.SetZero();return 0};goog.exportProperty(box2d.b2ChainShape.prototype,"ComputeSubmergedArea",box2d.b2ChainShape.prototype.ComputeSubmergedArea);box2d.b2ChainShape.prototype.Dump=function(){box2d.b2Log("    /*box2d.b2ChainShape*/ var shape = new box2d.b2ChainShape();\n");box2d.b2Log("    /*box2d.b2Vec2[]*/ var vs = box2d.b2Vec2.MakeArray(%d);\n",box2d.b2_maxPolygonVertices);for(var b=0;b<this.m_count;++b){box2d.b2Log("    vs[%d].SetXY(%.15f, %.15f);\n",b,this.m_vertices[b].x,this.m_vertices[b].y)}box2d.b2Log("    shape.CreateChain(vs, %d);\n",this.m_count);box2d.b2Log("    shape.m_prevVertex.SetXY(%.15f, %.15f);\n",this.m_prevVertex.x,this.m_prevVertex.y);box2d.b2Log("    shape.m_nextVertex.SetXY(%.15f, %.15f);\n",this.m_nextVertex.x,this.m_nextVertex.y);box2d.b2Log("    shape.m_hasPrevVertex = %s;\n",this.m_hasPrevVertex?"true":"false");box2d.b2Log("    shape.m_hasNextVertex = %s;\n",this.m_hasNextVertex?"true":"false")};goog.exportProperty(box2d.b2ChainShape.prototype,"Dump",box2d.b2ChainShape.prototype.Dump);box2d.b2PolygonShape=function(){box2d.b2Shape.call(this,box2d.b2ShapeType.e_polygonShape,box2d.b2_polygonRadius);this.m_centroid=new box2d.b2Vec2(0,0);this.m_vertices=box2d.b2Vec2.MakeArray(box2d.b2_maxPolygonVertices);this.m_normals=box2d.b2Vec2.MakeArray(box2d.b2_maxPolygonVertices)};goog.inherits(box2d.b2PolygonShape,box2d.b2Shape);goog.exportSymbol("box2d.b2PolygonShape",box2d.b2PolygonShape);box2d.b2PolygonShape.prototype.m_centroid=null;goog.exportProperty(box2d.b2PolygonShape.prototype,"m_centroid",box2d.b2PolygonShape.prototype.m_centroid);box2d.b2PolygonShape.prototype.m_vertices=null;goog.exportProperty(box2d.b2PolygonShape.prototype,"m_vertices",box2d.b2PolygonShape.prototype.m_vertices);box2d.b2PolygonShape.prototype.m_normals=null;goog.exportProperty(box2d.b2PolygonShape.prototype,"m_normals",box2d.b2PolygonShape.prototype.m_normals);box2d.b2PolygonShape.prototype.m_count=0;goog.exportProperty(box2d.b2PolygonShape.prototype,"m_count",box2d.b2PolygonShape.prototype.m_count);box2d.b2PolygonShape.prototype.Clone=function(){return(new box2d.b2PolygonShape).Copy(this)};goog.exportProperty(box2d.b2PolygonShape.prototype,"Clone",box2d.b2PolygonShape.prototype.Clone);box2d.b2PolygonShape.prototype.Copy=function(e){box2d.b2Shape.prototype.Copy.call(this,e);box2d.ENABLE_ASSERTS&&box2d.b2Assert(e instanceof box2d.b2PolygonShape);this.m_centroid.Copy(e.m_centroid);this.m_count=e.m_count;for(var d=0,f=this.m_count;d<f;++d){this.m_vertices[d].Copy(e.m_vertices[d]),this.m_normals[d].Copy(e.m_normals[d])}return this};goog.exportProperty(box2d.b2PolygonShape.prototype,"Copy",box2d.b2PolygonShape.prototype.Copy);box2d.b2PolygonShape.prototype.SetAsBox=function(e,d){this.m_count=4;this.m_vertices[0].SetXY(-e,-d);this.m_vertices[1].SetXY(e,-d);this.m_vertices[2].SetXY(e,d);this.m_vertices[3].SetXY(-e,d);this.m_normals[0].SetXY(0,-1);this.m_normals[1].SetXY(1,0);this.m_normals[2].SetXY(0,1);this.m_normals[3].SetXY(-1,0);this.m_centroid.SetZero();return this};goog.exportProperty(box2d.b2PolygonShape.prototype,"SetAsBox",box2d.b2PolygonShape.prototype.SetAsBox);box2d.b2PolygonShape.prototype.SetAsOrientedBox=function(f,e,j,g){this.m_count=4;this.m_vertices[0].SetXY(-f,-e);this.m_vertices[1].SetXY(f,-e);this.m_vertices[2].SetXY(f,e);this.m_vertices[3].SetXY(-f,e);this.m_normals[0].SetXY(0,-1);this.m_normals[1].SetXY(1,0);this.m_normals[2].SetXY(0,1);this.m_normals[3].SetXY(-1,0);this.m_centroid.Copy(j);f=new box2d.b2Transform;f.SetPosition(j);f.SetRotationAngleRadians(g);j=0;for(g=this.m_count;j<g;++j){box2d.b2MulXV(f,this.m_vertices[j],this.m_vertices[j]),box2d.b2MulRV(f.q,this.m_normals[j],this.m_normals[j])}return this};goog.exportProperty(box2d.b2PolygonShape.prototype,"SetAsOrientedBox",box2d.b2PolygonShape.prototype.SetAsOrientedBox);box2d.b2PolygonShape.prototype.Set=function(E,D){D="number"===typeof D?D:E.length;box2d.ENABLE_ASSERTS&&box2d.b2Assert(3<=D&&D<=box2d.b2_maxPolygonVertices);if(3>D){return this.SetAsBox(1,1)}for(var C=box2d.b2Min(D,box2d.b2_maxPolygonVertices),B=box2d.b2PolygonShape.prototype.Set.s_ps,A=0,z=0;z<C;++z){for(var y=E[z],v=!0,s=0;s<A;++s){if(box2d.b2DistanceSquaredVV(y,B[s])<0.5*box2d.b2_linearSlop){v=!1;break}}v&&B[A++].Copy(y)}C=A;if(3>C){return box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1),this.SetAsBox(1,1)}A=0;y=B[0].x;for(z=1;z<C;++z){if(s=B[z].x,s>y||s===y&&B[z].y<B[A].y){A=z,y=s}}for(var u=box2d.b2PolygonShape.prototype.Set.s_hull,v=0,z=A;;){u[v]=z;for(var r=0,s=1;s<C;++s){if(r===z){r=s}else{var q=box2d.b2SubVV(B[r],B[u[v]],box2d.b2PolygonShape.prototype.Set.s_r),y=box2d.b2SubVV(B[s],B[u[v]],box2d.b2PolygonShape.prototype.Set.s_v),j=box2d.b2CrossVV(q,y);0>j&&(r=s);0===j&&y.GetLengthSquared()>q.GetLengthSquared()&&(r=s)}}++v;z=r;if(r===A){break}}if(3>v){return box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1),this.SetAsBox(1,1)}this.m_count=v;for(z=0;z<v;++z){this.m_vertices[z].Copy(B[u[z]])}z=0;for(C=v;z<C;++z){B=box2d.b2SubVV(this.m_vertices[(z+1)%C],this.m_vertices[z],box2d.b2Vec2.s_t0),box2d.ENABLE_ASSERTS&&box2d.b2Assert(B.GetLengthSquared()>box2d.b2_epsilon_sq),box2d.b2CrossVOne(B,this.m_normals[z]).SelfNormalize()}box2d.b2PolygonShape.ComputeCentroid(this.m_vertices,v,this.m_centroid);return this};goog.exportProperty(box2d.b2PolygonShape.prototype,"Set",box2d.b2PolygonShape.prototype.Set);box2d.b2PolygonShape.prototype.Set.s_ps=box2d.b2Vec2.MakeArray(box2d.b2_maxPolygonVertices);box2d.b2PolygonShape.prototype.Set.s_hull=box2d.b2MakeNumberArray(box2d.b2_maxPolygonVertices);box2d.b2PolygonShape.prototype.Set.s_r=new box2d.b2Vec2;box2d.b2PolygonShape.prototype.Set.s_v=new box2d.b2Vec2;box2d.b2PolygonShape.prototype.SetAsVector=function(e,d){this.Set(e,d);return this};goog.exportProperty(box2d.b2PolygonShape.prototype,"SetAsVector",box2d.b2PolygonShape.prototype.SetAsVector);box2d.b2PolygonShape.prototype.SetAsArray=function(e,d){this.Set(e,d);return this};goog.exportProperty(box2d.b2PolygonShape.prototype,"SetAsArray",box2d.b2PolygonShape.prototype.SetAsArray);box2d.b2PolygonShape.prototype.GetChildCount=function(){return 1};goog.exportProperty(box2d.b2PolygonShape.prototype,"GetChildCount",box2d.b2PolygonShape.prototype.GetChildCount);box2d.b2PolygonShape.prototype.TestPoint=function(g,f){for(var m=box2d.b2MulTXV(g,f,box2d.b2PolygonShape.prototype.TestPoint.s_pLocal),k=0,j=this.m_count;k<j;++k){if(0<box2d.b2DotVV(this.m_normals[k],box2d.b2SubVV(m,this.m_vertices[k],box2d.b2Vec2.s_t0))){return !1}}return !0};goog.exportProperty(box2d.b2PolygonShape.prototype,"TestPoint",box2d.b2PolygonShape.prototype.TestPoint);box2d.b2PolygonShape.prototype.TestPoint.s_pLocal=new box2d.b2Vec2;box2d.b2PolygonShape.prototype.RayCast=function(D,C,B,A){A=box2d.b2MulTXV(B,C.p1,box2d.b2PolygonShape.prototype.RayCast.s_p1);for(var z=box2d.b2MulTXV(B,C.p2,box2d.b2PolygonShape.prototype.RayCast.s_p2),z=box2d.b2SubVV(z,A,box2d.b2PolygonShape.prototype.RayCast.s_d),y=0,v=C.maxFraction,u=-1,r=0,s=this.m_count;r<s;++r){var q=box2d.b2DotVV(this.m_normals[r],box2d.b2SubVV(this.m_vertices[r],A,box2d.b2Vec2.s_t0)),j=box2d.b2DotVV(this.m_normals[r],z);if(0===j){if(0>q){return !1}}else{0>j&&q<y*j?(y=q/j,u=r):0<j&&q<v*j&&(v=q/j)}if(v<y){return !1}}box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<=y&&y<=C.maxFraction);return 0<=u?(D.fraction=y,box2d.b2MulRV(B.q,this.m_normals[u],D.normal),!0):!1};goog.exportProperty(box2d.b2PolygonShape.prototype,"RayCast",box2d.b2PolygonShape.prototype.RayCast);box2d.b2PolygonShape.prototype.RayCast.s_p1=new box2d.b2Vec2;box2d.b2PolygonShape.prototype.RayCast.s_p2=new box2d.b2Vec2;box2d.b2PolygonShape.prototype.RayCast.s_d=new box2d.b2Vec2;box2d.b2PolygonShape.prototype.ComputeAABB=function(j,g,q){q=box2d.b2MulXV(g,this.m_vertices[0],j.lowerBound);j=j.upperBound.Copy(q);for(var n=0,m=this.m_count;n<m;++n){var k=box2d.b2MulXV(g,this.m_vertices[n],box2d.b2PolygonShape.prototype.ComputeAABB.s_v);box2d.b2MinV(k,q,q);box2d.b2MaxV(k,j,j)}g=this.m_radius;q.SelfSubXY(g,g);j.SelfAddXY(g,g)};goog.exportProperty(box2d.b2PolygonShape.prototype,"ComputeAABB",box2d.b2PolygonShape.prototype.ComputeAABB);box2d.b2PolygonShape.prototype.ComputeAABB.s_v=new box2d.b2Vec2;box2d.b2PolygonShape.prototype.ComputeMass=function(G,F){box2d.ENABLE_ASSERTS&&box2d.b2Assert(3<=this.m_count);for(var E=box2d.b2PolygonShape.prototype.ComputeMass.s_center.SetZero(),D=0,C=0,B=box2d.b2PolygonShape.prototype.ComputeMass.s_s.SetZero(),A=0,z=this.m_count;A<z;++A){B.SelfAdd(this.m_vertices[A])}B.SelfMul(1/this.m_count);for(var v=1/3,A=0,z=this.m_count;A<z;++A){var y=box2d.b2SubVV(this.m_vertices[A],B,box2d.b2PolygonShape.prototype.ComputeMass.s_e1),u=box2d.b2SubVV(this.m_vertices[(A+1)%z],B,box2d.b2PolygonShape.prototype.ComputeMass.s_e2),s=box2d.b2CrossVV(y,u),r=0.5*s,D=D+r;E.SelfAdd(box2d.b2MulSV(r*v,box2d.b2AddVV(y,u,box2d.b2Vec2.s_t0),box2d.b2Vec2.s_t1));var r=y.x,y=y.y,j=u.x,u=u.y,C=C+0.25*v*s*(r*r+j*r+j*j+(y*y+u*y+u*u))}G.mass=F*D;box2d.ENABLE_ASSERTS&&box2d.b2Assert(D>box2d.b2_epsilon);E.SelfMul(1/D);box2d.b2AddVV(E,B,G.center);G.I=F*C;G.I+=G.mass*(box2d.b2DotVV(G.center,G.center)-box2d.b2DotVV(E,E))};goog.exportProperty(box2d.b2PolygonShape.prototype,"ComputeMass",box2d.b2PolygonShape.prototype.ComputeMass);box2d.b2PolygonShape.prototype.ComputeMass.s_center=new box2d.b2Vec2;box2d.b2PolygonShape.prototype.ComputeMass.s_s=new box2d.b2Vec2;box2d.b2PolygonShape.prototype.ComputeMass.s_e1=new box2d.b2Vec2;box2d.b2PolygonShape.prototype.ComputeMass.s_e2=new box2d.b2Vec2;box2d.b2PolygonShape.prototype.Validate=function(){for(var k=0;k<this.m_count;++k){for(var j=k,s=(k+1)%this.m_count,r=this.m_vertices[j],q=box2d.b2SubVV(this.m_vertices[s],r,box2d.b2PolygonShape.prototype.Validate.s_e),n=0;n<this.m_count;++n){if(n!==j&&n!==s){var m=box2d.b2SubVV(this.m_vertices[n],r,box2d.b2PolygonShape.prototype.Validate.s_v);if(0>box2d.b2CrossVV(q,m)){return !1}}}}return !0};goog.exportProperty(box2d.b2PolygonShape.prototype,"Validate",box2d.b2PolygonShape.prototype.Validate);box2d.b2PolygonShape.prototype.Validate.s_e=new box2d.b2Vec2;box2d.b2PolygonShape.prototype.Validate.s_v=new box2d.b2Vec2;box2d.b2PolygonShape.prototype.SetupDistanceProxy=function(e,d){e.m_vertices=this.m_vertices;e.m_count=this.m_count;e.m_radius=this.m_radius};box2d.b2PolygonShape.prototype.ComputeSubmergedArea=function(D,C,B,A){var z=box2d.b2MulTRV(B.q,D,box2d.b2PolygonShape.prototype.ComputeSubmergedArea.s_normalL),y=C-box2d.b2DotVV(D,B.p),v=box2d.b2PolygonShape.prototype.ComputeSubmergedArea.s_depths,u=0,r=-1;C=-1;var s=!1;D=0;for(var q=this.m_count;D<q;++D){v[D]=box2d.b2DotVV(z,this.m_vertices[D])-y;var j=v[D]<-box2d.b2_epsilon;0<D&&(j?s||(r=D-1,u++):s&&(C=D-1,u++));s=j}switch(u){case 0:return s?(D=box2d.b2PolygonShape.prototype.ComputeSubmergedArea.s_md,this.ComputeMass(D,1),box2d.b2MulXV(B,D.center,A),D.mass):0;case 1:-1===r?r=this.m_count-1:C=this.m_count-1}D=(r+1)%this.m_count;z=(C+1)%this.m_count;y=(0-v[r])/(v[D]-v[r]);v=(0-v[C])/(v[z]-v[C]);r=box2d.b2PolygonShape.prototype.ComputeSubmergedArea.s_intoVec.SetXY(this.m_vertices[r].x*(1-y)+this.m_vertices[D].x*y,this.m_vertices[r].y*(1-y)+this.m_vertices[D].y*y);C=box2d.b2PolygonShape.prototype.ComputeSubmergedArea.s_outoVec.SetXY(this.m_vertices[C].x*(1-v)+this.m_vertices[z].x*v,this.m_vertices[C].y*(1-v)+this.m_vertices[z].y*v);v=0;y=box2d.b2PolygonShape.prototype.ComputeSubmergedArea.s_center.SetZero();u=this.m_vertices[D];for(s=null;D!==z;){D=(D+1)%this.m_count,s=D===z?C:this.m_vertices[D],q=0.5*((u.x-r.x)*(s.y-r.y)-(u.y-r.y)*(s.x-r.x)),v+=q,y.x+=q*(r.x+u.x+s.x)/3,y.y+=q*(r.y+u.y+s.y)/3,u=s}y.SelfMul(1/v);box2d.b2MulXV(B,y,A);return v};goog.exportProperty(box2d.b2PolygonShape.prototype,"ComputeSubmergedArea",box2d.b2PolygonShape.prototype.ComputeSubmergedArea);box2d.b2PolygonShape.prototype.ComputeSubmergedArea.s_normalL=new box2d.b2Vec2;box2d.b2PolygonShape.prototype.ComputeSubmergedArea.s_depths=box2d.b2MakeNumberArray(box2d.b2_maxPolygonVertices);box2d.b2PolygonShape.prototype.ComputeSubmergedArea.s_md=new box2d.b2MassData;box2d.b2PolygonShape.prototype.ComputeSubmergedArea.s_intoVec=new box2d.b2Vec2;box2d.b2PolygonShape.prototype.ComputeSubmergedArea.s_outoVec=new box2d.b2Vec2;box2d.b2PolygonShape.prototype.ComputeSubmergedArea.s_center=new box2d.b2Vec2;box2d.b2PolygonShape.prototype.Dump=function(){box2d.b2Log("    /*box2d.b2PolygonShape*/ var shape = new box2d.b2PolygonShape();\n");box2d.b2Log("    /*box2d.b2Vec2[]*/ var vs = box2d.b2Vec2.MakeArray(%d);\n",box2d.b2_maxPolygonVertices);for(var b=0;b<this.m_count;++b){box2d.b2Log("    vs[%d].SetXY(%.15f, %.15f);\n",b,this.m_vertices[b].x,this.m_vertices[b].y)}box2d.b2Log("    shape.Set(vs, %d);\n",this.m_count)};goog.exportProperty(box2d.b2PolygonShape.prototype,"Dump",box2d.b2PolygonShape.prototype.Dump);box2d.b2PolygonShape.ComputeCentroid=function(D,C,B){box2d.ENABLE_ASSERTS&&box2d.b2Assert(3<=C);B.SetZero();for(var A=0,z=box2d.b2PolygonShape.ComputeCentroid.s_pRef.SetZero(),y=1/3,v=0;v<C;++v){var u=z,r=D[v],s=D[(v+1)%C],q=box2d.b2SubVV(r,u,box2d.b2PolygonShape.ComputeCentroid.s_e1),j=box2d.b2SubVV(s,u,box2d.b2PolygonShape.ComputeCentroid.s_e2),q=0.5*box2d.b2CrossVV(q,j),A=A+q;B.x+=q*y*(u.x+r.x+s.x);B.y+=q*y*(u.y+r.y+s.y)}box2d.ENABLE_ASSERTS&&box2d.b2Assert(A>box2d.b2_epsilon);B.SelfMul(1/A);return B};goog.exportProperty(box2d.b2PolygonShape,"ComputeCentroid",box2d.b2PolygonShape.ComputeCentroid);box2d.b2PolygonShape.ComputeCentroid.s_pRef=new box2d.b2Vec2;box2d.b2PolygonShape.ComputeCentroid.s_e1=new box2d.b2Vec2;box2d.b2PolygonShape.ComputeCentroid.s_e2=new box2d.b2Vec2;box2d.b2Timer=function(){this.m_start=(new Date).getTime()};goog.exportSymbol("box2d.b2Timer",box2d.b2Timer);box2d.b2Timer.prototype.m_start=0;goog.exportProperty(box2d.b2Timer.prototype,"m_start",box2d.b2Timer.prototype.m_start);box2d.b2Timer.prototype.Reset=function(){this.m_start=(new Date).getTime();return this};goog.exportProperty(box2d.b2Timer.prototype,"Reset",box2d.b2Timer.prototype.Reset);box2d.b2Timer.prototype.GetMilliseconds=function(){return(new Date).getTime()-this.m_start};goog.exportProperty(box2d.b2Timer.prototype,"GetMilliseconds",box2d.b2Timer.prototype.GetMilliseconds);box2d.b2Counter=function(){};goog.exportSymbol("box2d.b2Counter",box2d.b2Counter);box2d.b2Counter.prototype.m_count=0;goog.exportProperty(box2d.b2Counter.prototype,"m_count",box2d.b2Counter.prototype.m_count);box2d.b2Counter.prototype.m_min_count=0;goog.exportProperty(box2d.b2Counter.prototype,"m_min_count",box2d.b2Counter.prototype.m_min_count);box2d.b2Counter.prototype.m_max_count=0;goog.exportProperty(box2d.b2Counter.prototype,"m_max_count",box2d.b2Counter.prototype.m_max_count);box2d.b2Counter.prototype.GetCount=function(){return this.m_count};goog.exportProperty(box2d.b2Counter.prototype,"GetCount",box2d.b2Counter.prototype.GetCount);box2d.b2Counter.prototype.GetMinCount=function(){return this.m_min_count};goog.exportProperty(box2d.b2Counter.prototype,"GetMinCount",box2d.b2Counter.prototype.GetMinCount);box2d.b2Counter.prototype.GetMaxCount=function(){return this.m_max_count};goog.exportProperty(box2d.b2Counter.prototype,"GetMaxCount",box2d.b2Counter.prototype.GetMaxCount);box2d.b2Counter.prototype.ResetCount=function(){var b=this.m_count;this.m_count=0;return b};goog.exportProperty(box2d.b2Counter.prototype,"ResetCount",box2d.b2Counter.prototype.ResetCount);box2d.b2Counter.prototype.ResetMinCount=function(){this.m_min_count=0};goog.exportProperty(box2d.b2Counter.prototype,"ResetMinCount",box2d.b2Counter.prototype.ResetMinCount);box2d.b2Counter.prototype.ResetMaxCount=function(){this.m_max_count=0};goog.exportProperty(box2d.b2Counter.prototype,"ResetMaxCount",box2d.b2Counter.prototype.ResetMaxCount);box2d.b2Counter.prototype.Increment=function(){this.m_count++;this.m_max_count<this.m_count&&(this.m_max_count=this.m_count)};goog.exportProperty(box2d.b2Counter.prototype,"Increment",box2d.b2Counter.prototype.Increment);box2d.b2Counter.prototype.Decrement=function(){this.m_count--;this.m_min_count>this.m_count&&(this.m_min_count=this.m_count)};goog.exportProperty(box2d.b2Counter.prototype,"Decrement",box2d.b2Counter.prototype.Decrement);box2d.b2_toiTime=0;goog.exportSymbol("box2d.b2_toiTime",box2d.b2_toiTime);box2d.b2_toiMaxTime=0;goog.exportSymbol("box2d.b2_toiMaxTime",box2d.b2_toiMaxTime);box2d.b2_toiCalls=0;goog.exportSymbol("box2d.b2_toiCalls",box2d.b2_toiCalls);box2d.b2_toiIters=0;goog.exportSymbol("box2d.b2_toiIters",box2d.b2_toiIters);box2d.b2_toiMaxIters=0;goog.exportSymbol("box2d.b2_toiMaxIters",box2d.b2_toiMaxIters);box2d.b2_toiRootIters=0;goog.exportSymbol("box2d.b2_toiRootIters",box2d.b2_toiRootIters);box2d.b2_toiMaxRootIters=0;goog.exportSymbol("box2d.b2_toiMaxRootIters",box2d.b2_toiMaxRootIters);box2d.b2TOIInput=function(){this.proxyA=new box2d.b2DistanceProxy;this.proxyB=new box2d.b2DistanceProxy;this.sweepA=new box2d.b2Sweep;this.sweepB=new box2d.b2Sweep};goog.exportSymbol("box2d.b2TOIInput",box2d.b2TOIInput);box2d.b2TOIInput.prototype.proxyA=null;goog.exportProperty(box2d.b2TOIInput.prototype,"proxyA",box2d.b2TOIInput.prototype.proxyA);box2d.b2TOIInput.prototype.proxyB=null;goog.exportProperty(box2d.b2TOIInput.prototype,"proxyB",box2d.b2TOIInput.prototype.proxyB);box2d.b2TOIInput.prototype.sweepA=null;goog.exportProperty(box2d.b2TOIInput.prototype,"sweepA",box2d.b2TOIInput.prototype.sweepA);box2d.b2TOIInput.prototype.sweepB=null;goog.exportProperty(box2d.b2TOIInput.prototype,"sweepB",box2d.b2TOIInput.prototype.sweepB);box2d.b2TOIInput.prototype.tMax=0;goog.exportProperty(box2d.b2TOIInput.prototype,"tMax",box2d.b2TOIInput.prototype.tMax);box2d.b2TOIOutputState={e_unknown:0,e_failed:1,e_overlapped:2,e_touching:3,e_separated:4};goog.exportSymbol("box2d.b2TOIOutputState",box2d.b2TOIOutputState);goog.exportProperty(box2d.b2TOIOutputState,"e_unknown",box2d.b2TOIOutputState.e_unknown);goog.exportProperty(box2d.b2TOIOutputState,"e_failed",box2d.b2TOIOutputState.e_failed);goog.exportProperty(box2d.b2TOIOutputState,"e_overlapped",box2d.b2TOIOutputState.e_overlapped);goog.exportProperty(box2d.b2TOIOutputState,"e_touching",box2d.b2TOIOutputState.e_touching);goog.exportProperty(box2d.b2TOIOutputState,"e_separated",box2d.b2TOIOutputState.e_separated);box2d.b2TOIOutput=function(){};goog.exportSymbol("box2d.b2TOIOutput",box2d.b2TOIOutput);box2d.b2TOIOutput.prototype.state=box2d.b2TOIOutputState.e_unknown;goog.exportProperty(box2d.b2TOIOutput.prototype,"state",box2d.b2TOIOutput.prototype.state);box2d.b2TOIOutput.prototype.t=0;goog.exportProperty(box2d.b2TOIOutput.prototype,"t",box2d.b2TOIOutput.prototype.t);box2d.b2SeparationFunctionType={e_unknown:-1,e_points:0,e_faceA:1,e_faceB:2};goog.exportSymbol("box2d.b2SeparationFunctionType",box2d.b2SeparationFunctionType);goog.exportProperty(box2d.b2SeparationFunctionType,"e_unknown",box2d.b2SeparationFunctionType.e_unknown);goog.exportProperty(box2d.b2SeparationFunctionType,"e_points",box2d.b2SeparationFunctionType.e_points);goog.exportProperty(box2d.b2SeparationFunctionType,"e_faceA",box2d.b2SeparationFunctionType.e_faceA);goog.exportProperty(box2d.b2SeparationFunctionType,"e_faceB",box2d.b2SeparationFunctionType.e_faceB);box2d.b2SeparationFunction=function(){this.m_sweepA=new box2d.b2Sweep;this.m_sweepB=new box2d.b2Sweep;this.m_localPoint=new box2d.b2Vec2;this.m_axis=new box2d.b2Vec2};goog.exportSymbol("box2d.b2SeparationFunction",box2d.b2SeparationFunction);box2d.b2SeparationFunction.prototype.m_proxyA=null;goog.exportProperty(box2d.b2SeparationFunction.prototype,"m_proxyA",box2d.b2SeparationFunction.prototype.m_proxyA);box2d.b2SeparationFunction.prototype.m_proxyB=null;goog.exportProperty(box2d.b2SeparationFunction.prototype,"m_proxyB",box2d.b2SeparationFunction.prototype.m_proxyB);box2d.b2SeparationFunction.prototype.m_sweepA=null;goog.exportProperty(box2d.b2SeparationFunction.prototype,"m_sweepA",box2d.b2SeparationFunction.prototype.m_sweepA);box2d.b2SeparationFunction.prototype.m_sweepB=null;goog.exportProperty(box2d.b2SeparationFunction.prototype,"m_sweepB",box2d.b2SeparationFunction.prototype.m_sweepB);box2d.b2SeparationFunction.prototype.m_type=box2d.b2SeparationFunctionType.e_unknown;goog.exportProperty(box2d.b2SeparationFunction.prototype,"m_type",box2d.b2SeparationFunction.prototype.m_type);box2d.b2SeparationFunction.prototype.m_localPoint=null;goog.exportProperty(box2d.b2SeparationFunction.prototype,"m_localPoint",box2d.b2SeparationFunction.prototype.m_localPoint);box2d.b2SeparationFunction.prototype.m_axis=null;goog.exportProperty(box2d.b2SeparationFunction.prototype,"m_axis",box2d.b2SeparationFunction.prototype.m_axis);box2d.b2SeparationFunction.prototype.Initialize=function(j,g,q,n,m,k){this.m_proxyA=g;this.m_proxyB=n;g=j.count;box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<g&&3>g);this.m_sweepA.Copy(q);this.m_sweepB.Copy(m);q=box2d.b2TimeOfImpact.s_xfA;m=box2d.b2TimeOfImpact.s_xfB;this.m_sweepA.GetTransform(q,k);this.m_sweepB.GetTransform(m,k);1===g?(this.m_type=box2d.b2SeparationFunctionType.e_points,g=this.m_proxyA.GetVertex(j.indexA[0]),j=this.m_proxyB.GetVertex(j.indexB[0]),q=box2d.b2MulXV(q,g,box2d.b2TimeOfImpact.s_pointA),m=box2d.b2MulXV(m,j,box2d.b2TimeOfImpact.s_pointB),box2d.b2SubVV(m,q,this.m_axis),j=this.m_axis.Normalize()):(j.indexA[0]===j.indexA[1]?(this.m_type=box2d.b2SeparationFunctionType.e_faceB,g=this.m_proxyB.GetVertex(j.indexB[0]),n=this.m_proxyB.GetVertex(j.indexB[1]),box2d.b2CrossVOne(box2d.b2SubVV(n,g,box2d.b2Vec2.s_t0),this.m_axis).SelfNormalize(),k=box2d.b2MulRV(m.q,this.m_axis,box2d.b2TimeOfImpact.s_normal),box2d.b2MidVV(g,n,this.m_localPoint),m=box2d.b2MulXV(m,this.m_localPoint,box2d.b2TimeOfImpact.s_pointB),g=this.m_proxyA.GetVertex(j.indexA[0]),q=box2d.b2MulXV(q,g,box2d.b2TimeOfImpact.s_pointA),j=box2d.b2DotVV(box2d.b2SubVV(q,m,box2d.b2Vec2.s_t0),k)):(this.m_type=box2d.b2SeparationFunctionType.e_faceA,g=this.m_proxyA.GetVertex(j.indexA[0]),n=this.m_proxyA.GetVertex(j.indexA[1]),box2d.b2CrossVOne(box2d.b2SubVV(n,g,box2d.b2Vec2.s_t0),this.m_axis).SelfNormalize(),k=box2d.b2MulRV(q.q,this.m_axis,box2d.b2TimeOfImpact.s_normal),box2d.b2MidVV(g,n,this.m_localPoint),q=box2d.b2MulXV(q,this.m_localPoint,box2d.b2TimeOfImpact.s_pointA),j=this.m_proxyB.GetVertex(j.indexB[0]),m=box2d.b2MulXV(m,j,box2d.b2TimeOfImpact.s_pointB),j=box2d.b2DotVV(box2d.b2SubVV(m,q,box2d.b2Vec2.s_t0),k)),0>j&&(this.m_axis.SelfNeg(),j=-j));return j};goog.exportProperty(box2d.b2SeparationFunction.prototype,"Initialize",box2d.b2SeparationFunction.prototype.Initialize);box2d.b2SeparationFunction.prototype.FindMinSeparation=function(k,j,s){var r=box2d.b2TimeOfImpact.s_xfA,q=box2d.b2TimeOfImpact.s_xfB;this.m_sweepA.GetTransform(r,s);this.m_sweepB.GetTransform(q,s);switch(this.m_type){case box2d.b2SeparationFunctionType.e_points:var n=box2d.b2MulTRV(r.q,this.m_axis,box2d.b2TimeOfImpact.s_axisA),m=box2d.b2MulTRV(q.q,box2d.b2NegV(this.m_axis,box2d.b2Vec2.s_t0),box2d.b2TimeOfImpact.s_axisB);k[0]=this.m_proxyA.GetSupport(n);j[0]=this.m_proxyB.GetSupport(m);k=this.m_proxyA.GetVertex(k[0]);j=this.m_proxyB.GetVertex(j[0]);r=box2d.b2MulXV(r,k,box2d.b2TimeOfImpact.s_pointA);q=box2d.b2MulXV(q,j,box2d.b2TimeOfImpact.s_pointB);return j=box2d.b2DotVV(box2d.b2SubVV(q,r,box2d.b2Vec2.s_t0),this.m_axis);case box2d.b2SeparationFunctionType.e_faceA:return s=box2d.b2MulRV(r.q,this.m_axis,box2d.b2TimeOfImpact.s_normal),r=box2d.b2MulXV(r,this.m_localPoint,box2d.b2TimeOfImpact.s_pointA),m=box2d.b2MulTRV(q.q,box2d.b2NegV(s,box2d.b2Vec2.s_t0),box2d.b2TimeOfImpact.s_axisB),k[0]=-1,j[0]=this.m_proxyB.GetSupport(m),j=this.m_proxyB.GetVertex(j[0]),q=box2d.b2MulXV(q,j,box2d.b2TimeOfImpact.s_pointB),j=box2d.b2DotVV(box2d.b2SubVV(q,r,box2d.b2Vec2.s_t0),s);case box2d.b2SeparationFunctionType.e_faceB:return s=box2d.b2MulRV(q.q,this.m_axis,box2d.b2TimeOfImpact.s_normal),q=box2d.b2MulXV(q,this.m_localPoint,box2d.b2TimeOfImpact.s_pointB),n=box2d.b2MulTRV(r.q,box2d.b2NegV(s,box2d.b2Vec2.s_t0),box2d.b2TimeOfImpact.s_axisA),j[0]=-1,k[0]=this.m_proxyA.GetSupport(n),k=this.m_proxyA.GetVertex(k[0]),r=box2d.b2MulXV(r,k,box2d.b2TimeOfImpact.s_pointA),j=box2d.b2DotVV(box2d.b2SubVV(r,q,box2d.b2Vec2.s_t0),s);default:return box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1),k[0]=-1,j[0]=-1,0}};goog.exportProperty(box2d.b2SeparationFunction.prototype,"FindMinSeparation",box2d.b2SeparationFunction.prototype.FindMinSeparation);box2d.b2SeparationFunction.prototype.Evaluate=function(g,f,m){var k=box2d.b2TimeOfImpact.s_xfA,j=box2d.b2TimeOfImpact.s_xfB;this.m_sweepA.GetTransform(k,m);this.m_sweepB.GetTransform(j,m);switch(this.m_type){case box2d.b2SeparationFunctionType.e_points:return g=this.m_proxyA.GetVertex(g),f=this.m_proxyB.GetVertex(f),k=box2d.b2MulXV(k,g,box2d.b2TimeOfImpact.s_pointA),j=box2d.b2MulXV(j,f,box2d.b2TimeOfImpact.s_pointB),k=box2d.b2DotVV(box2d.b2SubVV(j,k,box2d.b2Vec2.s_t0),this.m_axis);case box2d.b2SeparationFunctionType.e_faceA:return m=box2d.b2MulRV(k.q,this.m_axis,box2d.b2TimeOfImpact.s_normal),k=box2d.b2MulXV(k,this.m_localPoint,box2d.b2TimeOfImpact.s_pointA),f=this.m_proxyB.GetVertex(f),j=box2d.b2MulXV(j,f,box2d.b2TimeOfImpact.s_pointB),k=box2d.b2DotVV(box2d.b2SubVV(j,k,box2d.b2Vec2.s_t0),m);case box2d.b2SeparationFunctionType.e_faceB:return m=box2d.b2MulRV(j.q,this.m_axis,box2d.b2TimeOfImpact.s_normal),j=box2d.b2MulXV(j,this.m_localPoint,box2d.b2TimeOfImpact.s_pointB),g=this.m_proxyA.GetVertex(g),k=box2d.b2MulXV(k,g,box2d.b2TimeOfImpact.s_pointA),k=box2d.b2DotVV(box2d.b2SubVV(k,j,box2d.b2Vec2.s_t0),m);default:return box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1),0}};goog.exportProperty(box2d.b2SeparationFunction.prototype,"Evaluate",box2d.b2SeparationFunction.prototype.Evaluate);box2d.b2TimeOfImpact=function(ae,ad){var ac=box2d.b2TimeOfImpact.s_timer.Reset();++box2d.b2_toiCalls;ae.state=box2d.b2TOIOutputState.e_unknown;ae.t=ad.tMax;var ab=ad.proxyA,aa=ad.proxyB,Z=box2d.b2TimeOfImpact.s_sweepA.Copy(ad.sweepA),Y=box2d.b2TimeOfImpact.s_sweepB.Copy(ad.sweepB);Z.Normalize();Y.Normalize();var X=ad.tMax,V=box2d.b2Max(box2d.b2_linearSlop,ab.m_radius+aa.m_radius-3*box2d.b2_linearSlop),W=0.25*box2d.b2_linearSlop;box2d.ENABLE_ASSERTS&&box2d.b2Assert(V>W);var U=0,T=0,S=box2d.b2TimeOfImpact.s_cache;S.count=0;var P=box2d.b2TimeOfImpact.s_distanceInput;P.proxyA=ad.proxyA;P.proxyB=ad.proxyB;for(P.useRadii=!1;;){var N=box2d.b2TimeOfImpact.s_xfA,J=box2d.b2TimeOfImpact.s_xfB;Z.GetTransform(N,U);Y.GetTransform(J,U);P.transformA.Copy(N);P.transformB.Copy(J);N=box2d.b2TimeOfImpact.s_distanceOutput;box2d.b2Distance(N,S,P);if(0>=N.distance){ae.state=box2d.b2TOIOutputState.e_overlapped;ae.t=0;break}if(N.distance<V+W){ae.state=box2d.b2TOIOutputState.e_touching;ae.t=U;break}N=box2d.b2TimeOfImpact.s_fcn;N.Initialize(S,ab,Z,aa,Y,U);for(var J=!1,L=X,G=0;;){var F=box2d.b2TimeOfImpact.s_indexA,H=box2d.b2TimeOfImpact.s_indexB,M=N.FindMinSeparation(F,H,L);if(M>V+W){ae.state=box2d.b2TOIOutputState.e_separated;ae.t=X;J=!0;break}if(M>V-W){U=L;break}var z=N.Evaluate(F[0],H[0],U);if(z<V-W){ae.state=box2d.b2TOIOutputState.e_failed;ae.t=U;J=!0;break}if(z<=V+W){ae.state=box2d.b2TOIOutputState.e_touching;ae.t=U;J=!0;break}for(var j=0,R=U,O=L;;){var I=0,I=j&1?R+(V-z)*(O-R)/(M-z):0.5*(R+O);++j;++box2d.b2_toiRootIters;var K=N.Evaluate(F[0],H[0],I);if(box2d.b2Abs(K-V)<W){L=I;break}K>V?(R=I,z=K):(O=I,M=K);if(50===j){break}}box2d.b2_toiMaxRootIters=box2d.b2Max(box2d.b2_toiMaxRootIters,j);++G;if(G===box2d.b2_maxPolygonVertices){break}}++T;++box2d.b2_toiIters;if(J){break}if(20===T){ae.state=box2d.b2TOIOutputState.e_failed;ae.t=U;break}}box2d.b2_toiMaxIters=box2d.b2Max(box2d.b2_toiMaxIters,T);ac=ac.GetMilliseconds();box2d.b2_toiMaxTime=box2d.b2Max(box2d.b2_toiMaxTime,ac);box2d.b2_toiTime+=ac};goog.exportSymbol("box2d.b2TimeOfImpact",box2d.b2TimeOfImpact);box2d.b2TimeOfImpact.s_timer=new box2d.b2Timer;box2d.b2TimeOfImpact.s_cache=new box2d.b2SimplexCache;box2d.b2TimeOfImpact.s_distanceInput=new box2d.b2DistanceInput;box2d.b2TimeOfImpact.s_distanceOutput=new box2d.b2DistanceOutput;box2d.b2TimeOfImpact.s_xfA=new box2d.b2Transform;box2d.b2TimeOfImpact.s_xfB=new box2d.b2Transform;box2d.b2TimeOfImpact.s_indexA=box2d.b2MakeNumberArray(1);box2d.b2TimeOfImpact.s_indexB=box2d.b2MakeNumberArray(1);box2d.b2TimeOfImpact.s_fcn=new box2d.b2SeparationFunction;box2d.b2TimeOfImpact.s_sweepA=new box2d.b2Sweep;box2d.b2TimeOfImpact.s_sweepB=new box2d.b2Sweep;box2d.b2TimeOfImpact.s_pointA=new box2d.b2Vec2;box2d.b2TimeOfImpact.s_pointB=new box2d.b2Vec2;box2d.b2TimeOfImpact.s_normal=new box2d.b2Vec2;box2d.b2TimeOfImpact.s_axisA=new box2d.b2Vec2;box2d.b2TimeOfImpact.s_axisB=new box2d.b2Vec2;box2d.b2Filter=function(){};goog.exportSymbol("box2d.b2Filter",box2d.b2Filter);box2d.b2Filter.prototype.categoryBits=1;goog.exportProperty(box2d.b2Filter.prototype,"categoryBits",box2d.b2Filter.prototype.categoryBits);box2d.b2Filter.prototype.maskBits=65535;goog.exportProperty(box2d.b2Filter.prototype,"maskBits",box2d.b2Filter.prototype.maskBits);box2d.b2Filter.prototype.groupIndex=0;goog.exportProperty(box2d.b2Filter.prototype,"groupIndex",box2d.b2Filter.prototype.groupIndex);box2d.b2Filter.prototype.Clone=function(){return(new box2d.b2Filter).Copy(this)};goog.exportProperty(box2d.b2Filter.prototype,"Clone",box2d.b2Filter.prototype.Clone);box2d.b2Filter.prototype.Copy=function(b){box2d.ENABLE_ASSERTS&&box2d.b2Assert(this!==b);this.categoryBits=b.categoryBits;this.maskBits=b.maskBits;this.groupIndex=b.groupIndex;return this};goog.exportProperty(box2d.b2Filter.prototype,"Copy",box2d.b2Filter.prototype.Copy);box2d.b2FixtureDef=function(){this.filter=new box2d.b2Filter};goog.exportSymbol("box2d.b2FixtureDef",box2d.b2FixtureDef);box2d.b2FixtureDef.prototype.shape=null;goog.exportProperty(box2d.b2FixtureDef.prototype,"shape",box2d.b2FixtureDef.prototype.shape);box2d.b2FixtureDef.prototype.userData=null;goog.exportProperty(box2d.b2FixtureDef.prototype,"userData",box2d.b2FixtureDef.prototype.userData);box2d.b2FixtureDef.prototype.friction=0.2;goog.exportProperty(box2d.b2FixtureDef.prototype,"friction",box2d.b2FixtureDef.prototype.friction);box2d.b2FixtureDef.prototype.restitution=0;goog.exportProperty(box2d.b2FixtureDef.prototype,"restitution",box2d.b2FixtureDef.prototype.restitution);box2d.b2FixtureDef.prototype.density=0;goog.exportProperty(box2d.b2FixtureDef.prototype,"density",box2d.b2FixtureDef.prototype.density);box2d.b2FixtureDef.prototype.isSensor=!1;goog.exportProperty(box2d.b2FixtureDef.prototype,"isSensor",box2d.b2FixtureDef.prototype.isSensor);box2d.b2FixtureDef.prototype.filter=null;goog.exportProperty(box2d.b2FixtureDef.prototype,"filter",box2d.b2FixtureDef.prototype.filter);box2d.b2FixtureProxy=function(){this.aabb=new box2d.b2AABB};goog.exportSymbol("box2d.b2FixtureProxy",box2d.b2FixtureProxy);box2d.b2FixtureProxy.prototype.aabb=null;goog.exportProperty(box2d.b2FixtureProxy.prototype,"aabb",box2d.b2FixtureProxy.prototype.aabb);box2d.b2FixtureProxy.prototype.fixture=null;goog.exportProperty(box2d.b2FixtureProxy.prototype,"fixture",box2d.b2FixtureProxy.prototype.fixture);box2d.b2FixtureProxy.prototype.childIndex=0;goog.exportProperty(box2d.b2FixtureProxy.prototype,"childIndex",box2d.b2FixtureProxy.prototype.childIndex);box2d.b2FixtureProxy.prototype.proxy=null;goog.exportProperty(box2d.b2FixtureProxy.prototype,"proxy",box2d.b2FixtureProxy.prototype.proxy);box2d.b2FixtureProxy.MakeArray=function(b){return box2d.b2MakeArray(b,function(d){return new box2d.b2FixtureProxy})};goog.exportProperty(box2d.b2FixtureProxy,"MakeArray",box2d.b2FixtureProxy.MakeArray);box2d.b2Fixture=function(){this.m_proxyCount=0;this.m_filter=new box2d.b2Filter};goog.exportSymbol("box2d.b2Fixture",box2d.b2Fixture);box2d.b2Fixture.prototype.m_density=0;goog.exportProperty(box2d.b2Fixture.prototype,"m_density",box2d.b2Fixture.prototype.m_density);box2d.b2Fixture.prototype.m_next=null;goog.exportProperty(box2d.b2Fixture.prototype,"m_next",box2d.b2Fixture.prototype.m_next);box2d.b2Fixture.prototype.m_body=null;goog.exportProperty(box2d.b2Fixture.prototype,"m_body",box2d.b2Fixture.prototype.m_body);box2d.b2Fixture.prototype.m_shape=null;goog.exportProperty(box2d.b2Fixture.prototype,"m_shape",box2d.b2Fixture.prototype.m_shape);box2d.b2Fixture.prototype.m_friction=0;goog.exportProperty(box2d.b2Fixture.prototype,"m_friction",box2d.b2Fixture.prototype.m_friction);box2d.b2Fixture.prototype.m_restitution=0;goog.exportProperty(box2d.b2Fixture.prototype,"m_restitution",box2d.b2Fixture.prototype.m_restitution);box2d.b2Fixture.prototype.m_proxies=null;goog.exportProperty(box2d.b2Fixture.prototype,"m_proxies",box2d.b2Fixture.prototype.m_proxies);box2d.b2Fixture.prototype.m_proxyCount=0;goog.exportProperty(box2d.b2Fixture.prototype,"m_proxyCount",box2d.b2Fixture.prototype.m_proxyCount);box2d.b2Fixture.prototype.m_filter=null;goog.exportProperty(box2d.b2Fixture.prototype,"m_filter",box2d.b2Fixture.prototype.m_filter);box2d.b2Fixture.prototype.m_isSensor=!1;goog.exportProperty(box2d.b2Fixture.prototype,"m_isSensor",box2d.b2Fixture.prototype.m_isSensor);box2d.b2Fixture.prototype.m_userData=null;goog.exportProperty(box2d.b2Fixture.prototype,"m_userData",box2d.b2Fixture.prototype.m_userData);box2d.b2Fixture.prototype.GetType=function(){return this.m_shape.GetType()};goog.exportProperty(box2d.b2Fixture.prototype,"GetType",box2d.b2Fixture.prototype.GetType);box2d.b2Fixture.prototype.GetShape=function(){return this.m_shape};goog.exportProperty(box2d.b2Fixture.prototype,"GetShape",box2d.b2Fixture.prototype.GetShape);box2d.b2Fixture.prototype.IsSensor=function(){return this.m_isSensor};goog.exportProperty(box2d.b2Fixture.prototype,"IsSensor",box2d.b2Fixture.prototype.IsSensor);box2d.b2Fixture.prototype.GetFilterData=function(b){b=b||new box2d.b2Filter;return b.Copy(this.m_filter)};goog.exportProperty(box2d.b2Fixture.prototype,"GetFilterData",box2d.b2Fixture.prototype.GetFilterData);box2d.b2Fixture.prototype.GetUserData=function(){return this.m_userData};goog.exportProperty(box2d.b2Fixture.prototype,"GetUserData",box2d.b2Fixture.prototype.GetUserData);box2d.b2Fixture.prototype.SetUserData=function(b){this.m_userData=b};goog.exportProperty(box2d.b2Fixture.prototype,"SetUserData",box2d.b2Fixture.prototype.SetUserData);box2d.b2Fixture.prototype.GetBody=function(){return this.m_body};goog.exportProperty(box2d.b2Fixture.prototype,"GetBody",box2d.b2Fixture.prototype.GetBody);box2d.b2Fixture.prototype.GetNext=function(){return this.m_next};goog.exportProperty(box2d.b2Fixture.prototype,"GetNext",box2d.b2Fixture.prototype.GetNext);box2d.b2Fixture.prototype.SetDensity=function(b){this.m_density=b};goog.exportProperty(box2d.b2Fixture.prototype,"SetDensity",box2d.b2Fixture.prototype.SetDensity);box2d.b2Fixture.prototype.GetDensity=function(){return this.m_density};goog.exportProperty(box2d.b2Fixture.prototype,"GetDensity",box2d.b2Fixture.prototype.GetDensity);box2d.b2Fixture.prototype.GetFriction=function(){return this.m_friction};goog.exportProperty(box2d.b2Fixture.prototype,"GetFriction",box2d.b2Fixture.prototype.GetFriction);box2d.b2Fixture.prototype.SetFriction=function(b){this.m_friction=b};goog.exportProperty(box2d.b2Fixture.prototype,"SetFriction",box2d.b2Fixture.prototype.SetFriction);box2d.b2Fixture.prototype.GetRestitution=function(){return this.m_restitution};goog.exportProperty(box2d.b2Fixture.prototype,"GetRestitution",box2d.b2Fixture.prototype.GetRestitution);box2d.b2Fixture.prototype.SetRestitution=function(b){this.m_restitution=b};goog.exportProperty(box2d.b2Fixture.prototype,"SetRestitution",box2d.b2Fixture.prototype.SetRestitution);box2d.b2Fixture.prototype.TestPoint=function(b){return this.m_shape.TestPoint(this.m_body.GetTransform(),b)};goog.exportProperty(box2d.b2Fixture.prototype,"TestPoint",box2d.b2Fixture.prototype.TestPoint);box2d.b2Fixture.prototype.RayCast=function(e,d,f){return this.m_shape.RayCast(e,d,this.m_body.GetTransform(),f)};goog.exportProperty(box2d.b2Fixture.prototype,"RayCast",box2d.b2Fixture.prototype.RayCast);box2d.b2Fixture.prototype.GetMassData=function(b){b=b||new box2d.b2MassData;this.m_shape.ComputeMass(b,this.m_density);return b};goog.exportProperty(box2d.b2Fixture.prototype,"GetMassData",box2d.b2Fixture.prototype.GetMassData);box2d.b2Fixture.prototype.GetAABB=function(b){box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<=b&&b<this.m_proxyCount);return this.m_proxies[b].aabb};goog.exportProperty(box2d.b2Fixture.prototype,"GetAABB",box2d.b2Fixture.prototype.GetAABB);box2d.b2Fixture.prototype.Create=function(e,d){this.m_userData=d.userData;this.m_friction=d.friction;this.m_restitution=d.restitution;this.m_body=e;this.m_next=null;this.m_filter.Copy(d.filter);this.m_isSensor=d.isSensor;this.m_shape=d.shape.Clone();this.m_proxies=box2d.b2FixtureProxy.MakeArray(this.m_shape.GetChildCount());this.m_proxyCount=0;this.m_density=d.density};goog.exportProperty(box2d.b2Fixture.prototype,"Create",box2d.b2Fixture.prototype.Create);box2d.b2Fixture.prototype.Destroy=function(){box2d.ENABLE_ASSERTS&&box2d.b2Assert(0===this.m_proxyCount);this.m_shape=null};goog.exportProperty(box2d.b2Fixture.prototype,"Destroy",box2d.b2Fixture.prototype.Destroy);box2d.b2Fixture.prototype.CreateProxies=function(f,e){box2d.ENABLE_ASSERTS&&box2d.b2Assert(0===this.m_proxyCount);this.m_proxyCount=this.m_shape.GetChildCount();for(var j=0;j<this.m_proxyCount;++j){var g=this.m_proxies[j];this.m_shape.ComputeAABB(g.aabb,e,j);g.proxy=f.CreateProxy(g.aabb,g);g.fixture=this;g.childIndex=j}};goog.exportProperty(box2d.b2Fixture.prototype,"CreateProxies",box2d.b2Fixture.prototype.CreateProxies);box2d.b2Fixture.prototype.DestroyProxies=function(e){for(var d=0;d<this.m_proxyCount;++d){var f=this.m_proxies[d];e.DestroyProxy(f.proxy);f.proxy=null}this.m_proxyCount=0};goog.exportProperty(box2d.b2Fixture.prototype,"DestroyProxies",box2d.b2Fixture.prototype.DestroyProxies);box2d.b2Fixture.prototype.Synchronize=function(k,j,s){if(0!==this.m_proxyCount){for(var r=0;r<this.m_proxyCount;++r){var q=this.m_proxies[r],n=box2d.b2Fixture.prototype.Synchronize.s_aabb1,m=box2d.b2Fixture.prototype.Synchronize.s_aabb2;this.m_shape.ComputeAABB(n,j,r);this.m_shape.ComputeAABB(m,s,r);q.aabb.Combine2(n,m);n=box2d.b2SubVV(s.p,j.p,box2d.b2Fixture.prototype.Synchronize.s_displacement);k.MoveProxy(q.proxy,q.aabb,n)}}};goog.exportProperty(box2d.b2Fixture.prototype,"Synchronize",box2d.b2Fixture.prototype.Synchronize);box2d.b2Fixture.prototype.Synchronize.s_aabb1=new box2d.b2AABB;box2d.b2Fixture.prototype.Synchronize.s_aabb2=new box2d.b2AABB;box2d.b2Fixture.prototype.Synchronize.s_displacement=new box2d.b2Vec2;box2d.b2Fixture.prototype.SetFilterData=function(b){this.m_filter.Copy(b);this.Refilter()};goog.exportProperty(box2d.b2Fixture.prototype,"SetFilterData",box2d.b2Fixture.prototype.SetFilterData);box2d.b2Fixture.prototype.Refilter=function(){if(!this.m_body){for(var f=this.m_body.GetContactList();f;){var e=f.contact,j=e.GetFixtureA(),g=e.GetFixtureB();j!==this&&g!==this||e.FlagForFiltering();f=f.next}f=this.m_body.GetWorld();if(null!==f){for(f=f.m_contactManager.m_broadPhase,e=0;e<this.m_proxyCount;++e){f.TouchProxy(this.m_proxies[e].proxy)}}}};goog.exportProperty(box2d.b2Fixture.prototype,"Refilter",box2d.b2Fixture.prototype.Refilter);box2d.b2Fixture.prototype.SetSensor=function(b){b!==this.m_isSensor&&(this.m_body.SetAwake(!0),this.m_isSensor=b)};goog.exportProperty(box2d.b2Fixture.prototype,"SetSensor",box2d.b2Fixture.prototype.SetSensor);box2d.b2Fixture.prototype.Dump=function(b){box2d.DEBUG&&(box2d.b2Log("    /*box2d.b2FixtureDef*/ var fd = new box2d.b2FixtureDef();\n"),box2d.b2Log("    fd.friction = %.15f;\n",this.m_friction),box2d.b2Log("    fd.restitution = %.15f;\n",this.m_restitution),box2d.b2Log("    fd.density = %.15f;\n",this.m_density),box2d.b2Log("    fd.isSensor = %s;\n",this.m_isSensor?"true":"false"),box2d.b2Log("    fd.filter.categoryBits = %d;\n",this.m_filter.categoryBits),box2d.b2Log("    fd.filter.maskBits = %d;\n",this.m_filter.maskBits),box2d.b2Log("    fd.filter.groupIndex = %d;\n",this.m_filter.groupIndex),this.m_shape.Dump(),box2d.b2Log("\n"),box2d.b2Log("    fd.shape = shape;\n"),box2d.b2Log("\n"),box2d.b2Log("    bodies[%d].CreateFixture(fd);\n",b))};goog.exportProperty(box2d.b2Fixture.prototype,"Dump",box2d.b2Fixture.prototype.Dump);box2d.b2BodyType={b2_unknown:-1,b2_staticBody:0,b2_kinematicBody:1,b2_dynamicBody:2,b2_bulletBody:3};goog.exportSymbol("box2d.b2BodyType",box2d.b2BodyType);goog.exportProperty(box2d.b2BodyType,"b2_unknown",box2d.b2BodyType.b2_unknown);goog.exportProperty(box2d.b2BodyType,"b2_staticBody",box2d.b2BodyType.b2_staticBody);goog.exportProperty(box2d.b2BodyType,"b2_kinematicBody",box2d.b2BodyType.b2_kinematicBody);goog.exportProperty(box2d.b2BodyType,"b2_dynamicBody",box2d.b2BodyType.b2_dynamicBody);goog.exportProperty(box2d.b2BodyType,"b2_bulletBody",box2d.b2BodyType.b2_bulletBody);box2d.b2BodyDef=function(){this.position=new box2d.b2Vec2(0,0);this.linearVelocity=new box2d.b2Vec2(0,0)};goog.exportSymbol("box2d.b2BodyDef",box2d.b2BodyDef);box2d.b2BodyDef.prototype.type=box2d.b2BodyType.b2_staticBody;goog.exportProperty(box2d.b2BodyDef.prototype,"type",box2d.b2BodyDef.prototype.type);box2d.b2BodyDef.prototype.position=null;goog.exportProperty(box2d.b2BodyDef.prototype,"position",box2d.b2BodyDef.prototype.position);box2d.b2BodyDef.prototype.angle=0;goog.exportProperty(box2d.b2BodyDef.prototype,"angle",box2d.b2BodyDef.prototype.angle);box2d.b2BodyDef.prototype.linearVelocity=null;goog.exportProperty(box2d.b2BodyDef.prototype,"linearVelocity",box2d.b2BodyDef.prototype.linearVelocity);box2d.b2BodyDef.prototype.angularVelocity=0;goog.exportProperty(box2d.b2BodyDef.prototype,"angularVelocity",box2d.b2BodyDef.prototype.angularVelocity);box2d.b2BodyDef.prototype.linearDamping=0;goog.exportProperty(box2d.b2BodyDef.prototype,"linearDamping",box2d.b2BodyDef.prototype.linearDamping);box2d.b2BodyDef.prototype.angularDamping=0;goog.exportProperty(box2d.b2BodyDef.prototype,"angularDamping",box2d.b2BodyDef.prototype.angularDamping);box2d.b2BodyDef.prototype.allowSleep=!0;goog.exportProperty(box2d.b2BodyDef.prototype,"allowSleep",box2d.b2BodyDef.prototype.allowSleep);box2d.b2BodyDef.prototype.awake=!0;goog.exportProperty(box2d.b2BodyDef.prototype,"awake",box2d.b2BodyDef.prototype.awake);box2d.b2BodyDef.prototype.fixedRotation=!1;goog.exportProperty(box2d.b2BodyDef.prototype,"fixedRotation",box2d.b2BodyDef.prototype.fixedRotation);box2d.b2BodyDef.prototype.bullet=!1;goog.exportProperty(box2d.b2BodyDef.prototype,"bullet",box2d.b2BodyDef.prototype.bullet);box2d.b2BodyDef.prototype.active=!0;goog.exportProperty(box2d.b2BodyDef.prototype,"active",box2d.b2BodyDef.prototype.active);box2d.b2BodyDef.prototype.userData=null;goog.exportProperty(box2d.b2BodyDef.prototype,"userData",box2d.b2BodyDef.prototype.userData);box2d.b2BodyDef.prototype.gravityScale=1;goog.exportProperty(box2d.b2BodyDef.prototype,"gravityScale",box2d.b2BodyDef.prototype.gravityScale);box2d.b2BodyFlag={e_none:0,e_islandFlag:1,e_awakeFlag:2,e_autoSleepFlag:4,e_bulletFlag:8,e_fixedRotationFlag:16,e_activeFlag:32,e_toiFlag:64};goog.exportProperty(box2d.b2BodyFlag,"e_none",box2d.b2BodyFlag.e_none);goog.exportProperty(box2d.b2BodyFlag,"e_islandFlag",box2d.b2BodyFlag.e_islandFlag);goog.exportProperty(box2d.b2BodyFlag,"e_awakeFlag",box2d.b2BodyFlag.e_awakeFlag);goog.exportProperty(box2d.b2BodyFlag,"e_autoSleepFlag",box2d.b2BodyFlag.e_autoSleepFlag);goog.exportProperty(box2d.b2BodyFlag,"e_bulletFlag",box2d.b2BodyFlag.e_bulletFlag);goog.exportProperty(box2d.b2BodyFlag,"e_fixedRotationFlag",box2d.b2BodyFlag.e_fixedRotationFlag);goog.exportProperty(box2d.b2BodyFlag,"e_activeFlag",box2d.b2BodyFlag.e_activeFlag);goog.exportProperty(box2d.b2BodyFlag,"e_toiFlag",box2d.b2BodyFlag.e_toiFlag);box2d.b2Body=function(e,d){this.m_xf=new box2d.b2Transform;this.m_out_xf=new box2d.b2Transform;this.m_sweep=new box2d.b2Sweep;this.m_out_sweep=new box2d.b2Sweep;this.m_linearVelocity=new box2d.b2Vec2;this.m_out_linearVelocity=new box2d.b2Vec2;this.m_force=new box2d.b2Vec2;box2d.ENABLE_ASSERTS&&box2d.b2Assert(e.position.IsValid());box2d.ENABLE_ASSERTS&&box2d.b2Assert(e.linearVelocity.IsValid());box2d.ENABLE_ASSERTS&&box2d.b2Assert(box2d.b2IsValid(e.angle));box2d.ENABLE_ASSERTS&&box2d.b2Assert(box2d.b2IsValid(e.angularVelocity));box2d.ENABLE_ASSERTS&&box2d.b2Assert(box2d.b2IsValid(e.gravityScale)&&0<=e.gravityScale);box2d.ENABLE_ASSERTS&&box2d.b2Assert(box2d.b2IsValid(e.angularDamping)&&0<=e.angularDamping);box2d.ENABLE_ASSERTS&&box2d.b2Assert(box2d.b2IsValid(e.linearDamping)&&0<=e.linearDamping);this.m_flags=box2d.b2BodyFlag.e_none;e.bullet&&(this.m_flags|=box2d.b2BodyFlag.e_bulletFlag);e.fixedRotation&&(this.m_flags|=box2d.b2BodyFlag.e_fixedRotationFlag);e.allowSleep&&(this.m_flags|=box2d.b2BodyFlag.e_autoSleepFlag);e.awake&&(this.m_flags|=box2d.b2BodyFlag.e_awakeFlag);e.active&&(this.m_flags|=box2d.b2BodyFlag.e_activeFlag);this.m_world=d;this.m_xf.p.Copy(e.position);this.m_xf.q.SetAngleRadians(e.angle);this.m_sweep.localCenter.SetZero();this.m_sweep.c0.Copy(this.m_xf.p);this.m_sweep.c.Copy(this.m_xf.p);this.m_sweep.a0=e.angle;this.m_sweep.a=e.angle;this.m_sweep.alpha0=0;this.m_linearVelocity.Copy(e.linearVelocity);this.m_angularVelocity=e.angularVelocity;this.m_linearDamping=e.linearDamping;this.m_angularDamping=e.angularDamping;this.m_gravityScale=e.gravityScale;this.m_force.SetZero();this.m_sleepTime=this.m_torque=0;this.m_type=e.type;this.m_invMass=e.type===box2d.b2BodyType.b2_dynamicBody?this.m_mass=1:this.m_mass=0;this.m_invI=this.m_I=0;this.m_userData=e.userData;this.m_fixtureList=null;this.m_fixtureCount=0;this.m_controllerList=null;this.m_controllerCount=0};goog.exportSymbol("box2d.b2Body",box2d.b2Body);box2d.b2Body.prototype.m_flags=box2d.b2BodyFlag.e_none;goog.exportProperty(box2d.b2Body.prototype,"m_flags",box2d.b2Body.prototype.m_flags);box2d.b2Body.prototype.m_islandIndex=0;goog.exportProperty(box2d.b2Body.prototype,"m_islandIndex",box2d.b2Body.prototype.m_islandIndex);box2d.b2Body.prototype.m_world=null;goog.exportProperty(box2d.b2Body.prototype,"m_world",box2d.b2Body.prototype.m_world);box2d.b2Body.prototype.m_xf=null;goog.exportProperty(box2d.b2Body.prototype,"m_xf",box2d.b2Body.prototype.m_xf);box2d.b2Body.prototype.m_out_xf=null;goog.exportProperty(box2d.b2Body.prototype,"m_out_xf",box2d.b2Body.prototype.m_out_xf);box2d.b2Body.prototype.m_sweep=null;goog.exportProperty(box2d.b2Body.prototype,"m_sweep",box2d.b2Body.prototype.m_sweep);box2d.b2Body.prototype.m_out_sweep=null;goog.exportProperty(box2d.b2Body.prototype,"m_out_sweep",box2d.b2Body.prototype.m_out_sweep);box2d.b2Body.prototype.m_jointList=null;goog.exportProperty(box2d.b2Body.prototype,"m_jointList",box2d.b2Body.prototype.m_jointList);box2d.b2Body.prototype.m_contactList=null;goog.exportProperty(box2d.b2Body.prototype,"m_contactList",box2d.b2Body.prototype.m_contactList);box2d.b2Body.prototype.m_prev=null;goog.exportProperty(box2d.b2Body.prototype,"m_prev",box2d.b2Body.prototype.m_prev);box2d.b2Body.prototype.m_next=null;goog.exportProperty(box2d.b2Body.prototype,"m_next",box2d.b2Body.prototype.m_next);box2d.b2Body.prototype.m_linearVelocity=null;goog.exportProperty(box2d.b2Body.prototype,"m_linearVelocity",box2d.b2Body.prototype.m_linearVelocity);box2d.b2Body.prototype.m_out_linearVelocity=null;goog.exportProperty(box2d.b2Body.prototype,"m_out_linearVelocity",box2d.b2Body.prototype.m_out_linearVelocity);box2d.b2Body.prototype.m_angularVelocity=0;goog.exportProperty(box2d.b2Body.prototype,"m_angularVelocity",box2d.b2Body.prototype.m_angularVelocity);box2d.b2Body.prototype.m_linearDamping=0;goog.exportProperty(box2d.b2Body.prototype,"m_linearDamping",box2d.b2Body.prototype.m_linearDamping);box2d.b2Body.prototype.m_angularDamping=0;goog.exportProperty(box2d.b2Body.prototype,"m_angularDamping",box2d.b2Body.prototype.m_angularDamping);box2d.b2Body.prototype.m_gravityScale=1;goog.exportProperty(box2d.b2Body.prototype,"m_gravityScale",box2d.b2Body.prototype.m_gravityScale);box2d.b2Body.prototype.m_force=null;goog.exportProperty(box2d.b2Body.prototype,"m_force",box2d.b2Body.prototype.m_force);box2d.b2Body.prototype.m_torque=0;goog.exportProperty(box2d.b2Body.prototype,"m_torque",box2d.b2Body.prototype.m_torque);box2d.b2Body.prototype.m_sleepTime=0;goog.exportProperty(box2d.b2Body.prototype,"m_sleepTime",box2d.b2Body.prototype.m_sleepTime);box2d.b2Body.prototype.m_type=box2d.b2BodyType.b2_staticBody;goog.exportProperty(box2d.b2Body.prototype,"m_type",box2d.b2Body.prototype.m_type);box2d.b2Body.prototype.m_mass=1;goog.exportProperty(box2d.b2Body.prototype,"m_mass",box2d.b2Body.prototype.m_mass);box2d.b2Body.prototype.m_invMass=1;goog.exportProperty(box2d.b2Body.prototype,"m_invMass",box2d.b2Body.prototype.m_invMass);box2d.b2Body.prototype.m_I=0;goog.exportProperty(box2d.b2Body.prototype,"m_I",box2d.b2Body.prototype.m_I);box2d.b2Body.prototype.m_invI=0;goog.exportProperty(box2d.b2Body.prototype,"m_invI",box2d.b2Body.prototype.m_invI);box2d.b2Body.prototype.m_userData=null;goog.exportProperty(box2d.b2Body.prototype,"m_userData",box2d.b2Body.prototype.m_userData);box2d.b2Body.prototype.m_fixtureList=null;goog.exportProperty(box2d.b2Body.prototype,"m_fixtureList",box2d.b2Body.prototype.m_fixtureList);box2d.b2Body.prototype.m_fixtureCount=0;goog.exportProperty(box2d.b2Body.prototype,"m_fixtureCount",box2d.b2Body.prototype.m_fixtureCount);box2d.b2Body.prototype.m_controllerList=null;goog.exportProperty(box2d.b2Body.prototype,"m_controllerList",box2d.b2Body.prototype.m_controllerList);box2d.b2Body.prototype.m_controllerCount=0;goog.exportProperty(box2d.b2Body.prototype,"m_controllerCount",box2d.b2Body.prototype.m_controllerCount);box2d.b2Body.prototype.CreateFixture=function(e){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1===this.m_world.IsLocked());if(!0===this.m_world.IsLocked()){return null}var d=new box2d.b2Fixture;d.Create(this,e);this.m_flags&box2d.b2BodyFlag.e_activeFlag&&d.CreateProxies(this.m_world.m_contactManager.m_broadPhase,this.m_xf);d.m_next=this.m_fixtureList;this.m_fixtureList=d;++this.m_fixtureCount;d.m_body=this;0<d.m_density&&this.ResetMassData();this.m_world.m_flags|=box2d.b2WorldFlag.e_newFixture;return d};goog.exportProperty(box2d.b2Body.prototype,"CreateFixture",box2d.b2Body.prototype.CreateFixture);box2d.b2Body.prototype.CreateFixture2=function(e,d){var f=box2d.b2Body.prototype.CreateFixture2.s_def;f.shape=e;f.density="number"===typeof d?d:0;return this.CreateFixture(f)};goog.exportProperty(box2d.b2Body.prototype,"CreateFixture2",box2d.b2Body.prototype.CreateFixture2);box2d.b2Body.prototype.CreateFixture2.s_def=new box2d.b2FixtureDef;box2d.b2Body.prototype.DestroyFixture=function(g){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1===this.m_world.IsLocked());if(!0!==this.m_world.IsLocked()){box2d.ENABLE_ASSERTS&&box2d.b2Assert(g.m_body===this);box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<this.m_fixtureCount);for(var f=this.m_fixtureList,m=null,k=!1;null!==f;){if(f===g){m?m.m_next=g.m_next:this.m_fixtureList=g.m_next;k=!0;break}m=f;f=f.m_next}box2d.ENABLE_ASSERTS&&box2d.b2Assert(k);for(f=this.m_contactList;f;){var m=f.contact,f=f.next,k=m.GetFixtureA(),j=m.GetFixtureB();g!==k&&g!==j||this.m_world.m_contactManager.Destroy(m)}this.m_flags&box2d.b2BodyFlag.e_activeFlag&&g.DestroyProxies(this.m_world.m_contactManager.m_broadPhase);g.Destroy();g.m_body=null;g.m_next=null;--this.m_fixtureCount;this.ResetMassData()}};goog.exportProperty(box2d.b2Body.prototype,"DestroyFixture",box2d.b2Body.prototype.DestroyFixture);box2d.b2Body.prototype.SetTransformVecRadians=function(e,d){this.SetTransformXYRadians(e.x,e.y,d)};goog.exportProperty(box2d.b2Body.prototype,"SetTransformVecRadians",box2d.b2Body.prototype.SetTransformVecRadians);box2d.b2Body.prototype.SetTransformXYRadians=function(e,d,f){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1===this.m_world.IsLocked());if(!0!==this.m_world.IsLocked()&&(this.m_xf.p.x!==e||this.m_xf.p.y!==d||this.m_xf.q.GetAngleRadians()!==f)){for(this.m_xf.q.SetAngleRadians(f),this.m_xf.p.SetXY(e,d),box2d.b2MulXV(this.m_xf,this.m_sweep.localCenter,this.m_sweep.c),this.m_sweep.a=f,this.m_sweep.c0.Copy(this.m_sweep.c),this.m_sweep.a0=f,e=this.m_world.m_contactManager.m_broadPhase,d=this.m_fixtureList;d;d=d.m_next){d.Synchronize(e,this.m_xf,this.m_xf)}}};goog.exportProperty(box2d.b2Body.prototype,"SetTransformXYRadians",box2d.b2Body.prototype.SetTransformXYRadians);box2d.b2Body.prototype.SetTransform=function(b){this.SetTransformVecRadians(b.p,b.GetAngleRadians())};goog.exportProperty(box2d.b2Body.prototype,"SetTransform",box2d.b2Body.prototype.SetTransform);box2d.b2Body.prototype.GetTransform=function(b){b=b||this.m_out_xf;return b.Copy(this.m_xf)};goog.exportProperty(box2d.b2Body.prototype,"GetTransform",box2d.b2Body.prototype.GetTransform);box2d.b2Body.prototype.GetPosition=function(b){b=b||this.m_out_xf.p;return b.Copy(this.m_xf.p)};goog.exportProperty(box2d.b2Body.prototype,"GetPosition",box2d.b2Body.prototype.GetPosition);box2d.b2Body.prototype.SetPosition=function(b){this.SetTransformVecRadians(b,this.GetAngleRadians())};goog.exportProperty(box2d.b2Body.prototype,"SetPosition",box2d.b2Body.prototype.SetPosition);box2d.b2Body.prototype.SetPositionXY=function(e,d){this.SetTransformXYRadians(e,d,this.GetAngleRadians())};goog.exportProperty(box2d.b2Body.prototype,"SetPositionXY",box2d.b2Body.prototype.SetPositionXY);box2d.b2Body.prototype.GetAngle=function(){return this.m_sweep.a};goog.exportProperty(box2d.b2Body.prototype,"GetAngle",box2d.b2Body.prototype.GetAngle);box2d.b2Body.prototype.GetAngleRadians=box2d.b2Body.prototype.GetAngle;box2d.b2Body.prototype.GetAngleDegrees=function(){return box2d.b2RadToDeg(this.GetAngle())};box2d.b2Body.prototype.SetAngle=function(b){this.SetTransformVecRadians(this.GetPosition(),b)};goog.exportProperty(box2d.b2Body.prototype,"SetAngle",box2d.b2Body.prototype.SetAngle);box2d.b2Body.prototype.SetAngleRadians=box2d.b2Body.prototype.SetAngle;box2d.b2Body.prototype.SetAngleDegrees=function(b){this.SetAngle(box2d.b2DegToRad(b))};box2d.b2Body.prototype.GetWorldCenter=function(b){b=b||this.m_out_sweep.c;return b.Copy(this.m_sweep.c)};goog.exportProperty(box2d.b2Body.prototype,"GetWorldCenter",box2d.b2Body.prototype.GetWorldCenter);box2d.b2Body.prototype.GetLocalCenter=function(b){b=b||this.m_out_sweep.localCenter;return b.Copy(this.m_sweep.localCenter)};goog.exportProperty(box2d.b2Body.prototype,"GetLocalCenter",box2d.b2Body.prototype.GetLocalCenter);box2d.b2Body.prototype.SetLinearVelocity=function(b){this.m_type!==box2d.b2BodyType.b2_staticBody&&(0<box2d.b2DotVV(b,b)&&this.SetAwake(!0),this.m_linearVelocity.Copy(b))};goog.exportProperty(box2d.b2Body.prototype,"SetLinearVelocity",box2d.b2Body.prototype.SetLinearVelocity);box2d.b2Body.prototype.GetLinearVelocity=function(b){b=b||this.m_out_linearVelocity;return b.Copy(this.m_linearVelocity)};goog.exportProperty(box2d.b2Body.prototype,"GetLinearVelocity",box2d.b2Body.prototype.GetLinearVelocity);box2d.b2Body.prototype.SetAngularVelocity=function(b){this.m_type!==box2d.b2BodyType.b2_staticBody&&(0<b*b&&this.SetAwake(!0),this.m_angularVelocity=b)};goog.exportProperty(box2d.b2Body.prototype,"SetAngularVelocity",box2d.b2Body.prototype.SetAngularVelocity);box2d.b2Body.prototype.GetAngularVelocity=function(){return this.m_angularVelocity};goog.exportProperty(box2d.b2Body.prototype,"GetAngularVelocity",box2d.b2Body.prototype.GetAngularVelocity);box2d.b2Body.prototype.GetDefinition=function(b){b.type=this.GetType();b.allowSleep=(this.m_flags&box2d.b2BodyFlag.e_autoSleepFlag)===box2d.b2BodyFlag.e_autoSleepFlag;b.angle=this.GetAngleRadians();b.angularDamping=this.m_angularDamping;b.gravityScale=this.m_gravityScale;b.angularVelocity=this.m_angularVelocity;b.fixedRotation=(this.m_flags&box2d.b2BodyFlag.e_fixedRotationFlag)===box2d.b2BodyFlag.e_fixedRotationFlag;b.bullet=(this.m_flags&box2d.b2BodyFlag.e_bulletFlag)===box2d.b2BodyFlag.e_bulletFlag;b.awake=(this.m_flags&box2d.b2BodyFlag.e_awakeFlag)===box2d.b2BodyFlag.e_awakeFlag;b.linearDamping=this.m_linearDamping;b.linearVelocity.Copy(this.GetLinearVelocity());b.position.Copy(this.GetPosition());b.userData=this.GetUserData();return b};goog.exportProperty(box2d.b2Body.prototype,"GetDefinition",box2d.b2Body.prototype.GetDefinition);box2d.b2Body.prototype.ApplyForce=function(e,d,f){this.m_type===box2d.b2BodyType.b2_dynamicBody&&(0===(this.m_flags&box2d.b2BodyFlag.e_awakeFlag)&&this.SetAwake(!0),this.m_flags&box2d.b2BodyFlag.e_awakeFlag&&(this.m_force.x+=e.x,this.m_force.y+=e.y,this.m_torque+=(d.x-this.m_sweep.c.x)*e.y-(d.y-this.m_sweep.c.y)*e.x))};goog.exportProperty(box2d.b2Body.prototype,"ApplyForce",box2d.b2Body.prototype.ApplyForce);box2d.b2Body.prototype.ApplyForceToCenter=function(e,d){this.m_type===box2d.b2BodyType.b2_dynamicBody&&(0===(this.m_flags&box2d.b2BodyFlag.e_awakeFlag)&&this.SetAwake(!0),this.m_flags&box2d.b2BodyFlag.e_awakeFlag&&(this.m_force.x+=e.x,this.m_force.y+=e.y))};goog.exportProperty(box2d.b2Body.prototype,"ApplyForceToCenter",box2d.b2Body.prototype.ApplyForceToCenter);box2d.b2Body.prototype.ApplyTorque=function(e,d){this.m_type===box2d.b2BodyType.b2_dynamicBody&&(0===(this.m_flags&box2d.b2BodyFlag.e_awakeFlag)&&this.SetAwake(!0),this.m_flags&box2d.b2BodyFlag.e_awakeFlag&&(this.m_torque+=e))};goog.exportProperty(box2d.b2Body.prototype,"ApplyTorque",box2d.b2Body.prototype.ApplyTorque);box2d.b2Body.prototype.ApplyLinearImpulse=function(e,d,f){this.m_type===box2d.b2BodyType.b2_dynamicBody&&(0===(this.m_flags&box2d.b2BodyFlag.e_awakeFlag)&&this.SetAwake(!0),this.m_flags&box2d.b2BodyFlag.e_awakeFlag&&(this.m_linearVelocity.x+=this.m_invMass*e.x,this.m_linearVelocity.y+=this.m_invMass*e.y,this.m_angularVelocity+=this.m_invI*((d.x-this.m_sweep.c.x)*e.y-(d.y-this.m_sweep.c.y)*e.x)))};goog.exportProperty(box2d.b2Body.prototype,"ApplyLinearImpulse",box2d.b2Body.prototype.ApplyLinearImpulse);box2d.b2Body.prototype.ApplyAngularImpulse=function(e,d){this.m_type===box2d.b2BodyType.b2_dynamicBody&&(0===(this.m_flags&box2d.b2BodyFlag.e_awakeFlag)&&this.SetAwake(!0),this.m_flags&box2d.b2BodyFlag.e_awakeFlag&&(this.m_angularVelocity+=this.m_invI*e))};goog.exportProperty(box2d.b2Body.prototype,"ApplyAngularImpulse",box2d.b2Body.prototype.ApplyAngularImpulse);box2d.b2Body.prototype.GetMass=function(){return this.m_mass};goog.exportProperty(box2d.b2Body.prototype,"GetMass",box2d.b2Body.prototype.GetMass);box2d.b2Body.prototype.GetInertia=function(){return this.m_I+this.m_mass*box2d.b2DotVV(this.m_sweep.localCenter,this.m_sweep.localCenter)};goog.exportProperty(box2d.b2Body.prototype,"GetInertia",box2d.b2Body.prototype.GetInertia);box2d.b2Body.prototype.GetMassData=function(b){b.mass=this.m_mass;b.I=this.m_I+this.m_mass*box2d.b2DotVV(this.m_sweep.localCenter,this.m_sweep.localCenter);b.center.Copy(this.m_sweep.localCenter);return b};goog.exportProperty(box2d.b2Body.prototype,"GetMassData",box2d.b2Body.prototype.GetMassData);box2d.b2Body.prototype.SetMassData=function(e){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1===this.m_world.IsLocked());if(!0!==this.m_world.IsLocked()&&this.m_type===box2d.b2BodyType.b2_dynamicBody){this.m_invI=this.m_I=this.m_invMass=0;this.m_mass=e.mass;0>=this.m_mass&&(this.m_mass=1);this.m_invMass=1/this.m_mass;0<e.I&&0===(this.m_flags&box2d.b2BodyFlag.e_fixedRotationFlag)&&(this.m_I=e.I-this.m_mass*box2d.b2DotVV(e.center,e.center),box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<this.m_I),this.m_invI=1/this.m_I);var d=box2d.b2Body.prototype.SetMassData.s_oldCenter.Copy(this.m_sweep.c);this.m_sweep.localCenter.Copy(e.center);box2d.b2MulXV(this.m_xf,this.m_sweep.localCenter,this.m_sweep.c);this.m_sweep.c0.Copy(this.m_sweep.c);box2d.b2AddVCrossSV(this.m_linearVelocity,this.m_angularVelocity,box2d.b2SubVV(this.m_sweep.c,d,box2d.b2Vec2.s_t0),this.m_linearVelocity)}};goog.exportProperty(box2d.b2Body.prototype,"SetMassData",box2d.b2Body.prototype.SetMassData);box2d.b2Body.prototype.SetMassData.s_oldCenter=new box2d.b2Vec2;box2d.b2Body.prototype.ResetMassData=function(){this.m_invI=this.m_I=this.m_invMass=this.m_mass=0;this.m_sweep.localCenter.SetZero();if(this.m_type===box2d.b2BodyType.b2_staticBody||this.m_type===box2d.b2BodyType.b2_kinematicBody){this.m_sweep.c0.Copy(this.m_xf.p),this.m_sweep.c.Copy(this.m_xf.p),this.m_sweep.a0=this.m_sweep.a}else{box2d.ENABLE_ASSERTS&&box2d.b2Assert(this.m_type===box2d.b2BodyType.b2_dynamicBody);for(var e=box2d.b2Body.prototype.ResetMassData.s_localCenter.SetZero(),d=this.m_fixtureList;d;d=d.m_next){if(0!==d.m_density){var f=d.GetMassData(box2d.b2Body.prototype.ResetMassData.s_massData);this.m_mass+=f.mass;e.x+=f.center.x*f.mass;e.y+=f.center.y*f.mass;this.m_I+=f.I}}0<this.m_mass?(this.m_invMass=1/this.m_mass,e.x*=this.m_invMass,e.y*=this.m_invMass):this.m_invMass=this.m_mass=1;0<this.m_I&&0===(this.m_flags&box2d.b2BodyFlag.e_fixedRotationFlag)?(this.m_I-=this.m_mass*box2d.b2DotVV(e,e),box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<this.m_I),this.m_invI=1/this.m_I):this.m_invI=this.m_I=0;d=box2d.b2Body.prototype.ResetMassData.s_oldCenter.Copy(this.m_sweep.c);this.m_sweep.localCenter.Copy(e);box2d.b2MulXV(this.m_xf,this.m_sweep.localCenter,this.m_sweep.c);this.m_sweep.c0.Copy(this.m_sweep.c);box2d.b2AddVCrossSV(this.m_linearVelocity,this.m_angularVelocity,box2d.b2SubVV(this.m_sweep.c,d,box2d.b2Vec2.s_t0),this.m_linearVelocity)}};goog.exportProperty(box2d.b2Body.prototype,"ResetMassData",box2d.b2Body.prototype.ResetMassData);box2d.b2Body.prototype.ResetMassData.s_localCenter=new box2d.b2Vec2;box2d.b2Body.prototype.ResetMassData.s_oldCenter=new box2d.b2Vec2;box2d.b2Body.prototype.ResetMassData.s_massData=new box2d.b2MassData;box2d.b2Body.prototype.GetWorldPoint=function(e,d){return box2d.b2MulXV(this.m_xf,e,d)};goog.exportProperty(box2d.b2Body.prototype,"GetWorldPoint",box2d.b2Body.prototype.GetWorldPoint);box2d.b2Body.prototype.GetWorldVector=function(e,d){return box2d.b2MulRV(this.m_xf.q,e,d)};goog.exportProperty(box2d.b2Body.prototype,"GetWorldVector",box2d.b2Body.prototype.GetWorldVector);box2d.b2Body.prototype.GetLocalPoint=function(e,d){return box2d.b2MulTXV(this.m_xf,e,d)};goog.exportProperty(box2d.b2Body.prototype,"GetLocalPoint",box2d.b2Body.prototype.GetLocalPoint);box2d.b2Body.prototype.GetLocalVector=function(e,d){return box2d.b2MulTRV(this.m_xf.q,e,d)};goog.exportProperty(box2d.b2Body.prototype,"GetLocalVector",box2d.b2Body.prototype.GetLocalVector);box2d.b2Body.prototype.GetLinearVelocityFromWorldPoint=function(e,d){return box2d.b2AddVCrossSV(this.m_linearVelocity,this.m_angularVelocity,box2d.b2SubVV(e,this.m_sweep.c,box2d.b2Vec2.s_t0),d)};goog.exportProperty(box2d.b2Body.prototype,"GetLinearVelocityFromWorldPoint",box2d.b2Body.prototype.GetLinearVelocityFromWorldPoint);box2d.b2Body.prototype.GetLinearVelocityFromLocalPoint=function(e,d){return this.GetLinearVelocityFromWorldPoint(this.GetWorldPoint(e,d),d)};goog.exportProperty(box2d.b2Body.prototype,"GetLinearVelocityFromLocalPoint",box2d.b2Body.prototype.GetLinearVelocityFromLocalPoint);box2d.b2Body.prototype.GetLinearDamping=function(){return this.m_linearDamping};goog.exportProperty(box2d.b2Body.prototype,"GetLinearDamping",box2d.b2Body.prototype.GetLinearDamping);box2d.b2Body.prototype.SetLinearDamping=function(b){this.m_linearDamping=b};goog.exportProperty(box2d.b2Body.prototype,"SetLinearDamping",box2d.b2Body.prototype.SetLinearDamping);box2d.b2Body.prototype.GetAngularDamping=function(){return this.m_angularDamping};goog.exportProperty(box2d.b2Body.prototype,"GetAngularDamping",box2d.b2Body.prototype.GetAngularDamping);box2d.b2Body.prototype.SetAngularDamping=function(b){this.m_angularDamping=b};goog.exportProperty(box2d.b2Body.prototype,"SetAngularDamping",box2d.b2Body.prototype.SetAngularDamping);box2d.b2Body.prototype.GetGravityScale=function(){return this.m_gravityScale};goog.exportProperty(box2d.b2Body.prototype,"GetGravityScale",box2d.b2Body.prototype.GetGravityScale);box2d.b2Body.prototype.SetGravityScale=function(b){this.m_gravityScale=b};goog.exportProperty(box2d.b2Body.prototype,"SetGravityScale",box2d.b2Body.prototype.SetGravityScale);box2d.b2Body.prototype.SetType=function(f){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1===this.m_world.IsLocked());if(!0!==this.m_world.IsLocked()&&this.m_type!==f){this.m_type=f;this.ResetMassData();this.m_type===box2d.b2BodyType.b2_staticBody&&(this.m_linearVelocity.SetZero(),this.m_angularVelocity=0,this.m_sweep.a0=this.m_sweep.a,this.m_sweep.c0.Copy(this.m_sweep.c),this.SynchronizeFixtures());this.SetAwake(!0);this.m_force.SetZero();this.m_torque=0;for(f=this.m_contactList;f;){var e=f;f=f.next;this.m_world.m_contactManager.Destroy(e.contact)}this.m_contactList=null;f=this.m_world.m_contactManager.m_broadPhase;for(e=this.m_fixtureList;e;e=e.m_next){for(var j=e.m_proxyCount,g=0;g<j;++g){f.TouchProxy(e.m_proxies[g].proxy)}}}};goog.exportProperty(box2d.b2Body.prototype,"SetType",box2d.b2Body.prototype.SetType);box2d.b2Body.prototype.GetType=function(){return this.m_type};goog.exportProperty(box2d.b2Body.prototype,"GetType",box2d.b2Body.prototype.GetType);box2d.b2Body.prototype.SetBullet=function(b){this.m_flags=b?this.m_flags|box2d.b2BodyFlag.e_bulletFlag:this.m_flags&~box2d.b2BodyFlag.e_bulletFlag};goog.exportProperty(box2d.b2Body.prototype,"SetBullet",box2d.b2Body.prototype.SetBullet);box2d.b2Body.prototype.IsBullet=function(){return(this.m_flags&box2d.b2BodyFlag.e_bulletFlag)===box2d.b2BodyFlag.e_bulletFlag};goog.exportProperty(box2d.b2Body.prototype,"IsBullet",box2d.b2Body.prototype.IsBullet);box2d.b2Body.prototype.SetSleepingAllowed=function(b){b?this.m_flags|=box2d.b2BodyFlag.e_autoSleepFlag:(this.m_flags&=~box2d.b2BodyFlag.e_autoSleepFlag,this.SetAwake(!0))};goog.exportProperty(box2d.b2Body.prototype,"SetSleepingAllowed",box2d.b2Body.prototype.SetSleepingAllowed);box2d.b2Body.prototype.IsSleepingAllowed=function(){return(this.m_flags&box2d.b2BodyFlag.e_autoSleepFlag)===box2d.b2BodyFlag.e_autoSleepFlag};goog.exportProperty(box2d.b2Body.prototype,"IsSleepingAllowed",box2d.b2Body.prototype.IsSleepingAllowed);box2d.b2Body.prototype.SetAwake=function(b){b?0===(this.m_flags&box2d.b2BodyFlag.e_awakeFlag)&&(this.m_flags|=box2d.b2BodyFlag.e_awakeFlag,this.m_sleepTime=0):(this.m_flags&=~box2d.b2BodyFlag.e_awakeFlag,this.m_sleepTime=0,this.m_linearVelocity.SetZero(),this.m_angularVelocity=0,this.m_force.SetZero(),this.m_torque=0)};goog.exportProperty(box2d.b2Body.prototype,"SetAwake",box2d.b2Body.prototype.SetAwake);box2d.b2Body.prototype.IsAwake=function(){return(this.m_flags&box2d.b2BodyFlag.e_awakeFlag)===box2d.b2BodyFlag.e_awakeFlag};goog.exportProperty(box2d.b2Body.prototype,"IsAwake",box2d.b2Body.prototype.IsAwake);box2d.b2Body.prototype.SetActive=function(e){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1===this.m_world.IsLocked());if(e!==this.IsActive()){if(e){this.m_flags|=box2d.b2BodyFlag.e_activeFlag;e=this.m_world.m_contactManager.m_broadPhase;for(var d=this.m_fixtureList;d;d=d.m_next){d.CreateProxies(e,this.m_xf)}}else{this.m_flags&=~box2d.b2BodyFlag.e_activeFlag;e=this.m_world.m_contactManager.m_broadPhase;for(d=this.m_fixtureList;d;d=d.m_next){d.DestroyProxies(e)}for(e=this.m_contactList;e;){d=e,e=e.next,this.m_world.m_contactManager.Destroy(d.contact)}this.m_contactList=null}}};goog.exportProperty(box2d.b2Body.prototype,"SetActive",box2d.b2Body.prototype.SetActive);box2d.b2Body.prototype.IsActive=function(){return(this.m_flags&box2d.b2BodyFlag.e_activeFlag)===box2d.b2BodyFlag.e_activeFlag};goog.exportProperty(box2d.b2Body.prototype,"IsActive",box2d.b2Body.prototype.IsActive);box2d.b2Body.prototype.SetFixedRotation=function(b){(this.m_flags&box2d.b2BodyFlag.e_fixedRotationFlag)===box2d.b2BodyFlag.e_fixedRotationFlag!==b&&(this.m_flags=b?this.m_flags|box2d.b2BodyFlag.e_fixedRotationFlag:this.m_flags&~box2d.b2BodyFlag.e_fixedRotationFlag,this.m_angularVelocity=0,this.ResetMassData())};goog.exportProperty(box2d.b2Body.prototype,"SetFixedRotation",box2d.b2Body.prototype.SetFixedRotation);box2d.b2Body.prototype.IsFixedRotation=function(){return(this.m_flags&box2d.b2BodyFlag.e_fixedRotationFlag)===box2d.b2BodyFlag.e_fixedRotationFlag};goog.exportProperty(box2d.b2Body.prototype,"IsFixedRotation",box2d.b2Body.prototype.IsFixedRotation);box2d.b2Body.prototype.GetFixtureList=function(){return this.m_fixtureList};goog.exportProperty(box2d.b2Body.prototype,"GetFixtureList",box2d.b2Body.prototype.GetFixtureList);box2d.b2Body.prototype.GetJointList=function(){return this.m_jointList};goog.exportProperty(box2d.b2Body.prototype,"GetJointList",box2d.b2Body.prototype.GetJointList);box2d.b2Body.prototype.GetContactList=function(){return this.m_contactList};goog.exportProperty(box2d.b2Body.prototype,"GetContactList",box2d.b2Body.prototype.GetContactList);box2d.b2Body.prototype.GetNext=function(){return this.m_next};goog.exportProperty(box2d.b2Body.prototype,"GetNext",box2d.b2Body.prototype.GetNext);box2d.b2Body.prototype.GetUserData=function(){return this.m_userData};goog.exportProperty(box2d.b2Body.prototype,"GetUserData",box2d.b2Body.prototype.GetUserData);box2d.b2Body.prototype.SetUserData=function(b){this.m_userData=b};goog.exportProperty(box2d.b2Body.prototype,"SetUserData",box2d.b2Body.prototype.SetUserData);box2d.b2Body.prototype.GetWorld=function(){return this.m_world};goog.exportProperty(box2d.b2Body.prototype,"GetWorld",box2d.b2Body.prototype.GetWorld);box2d.b2Body.prototype.SynchronizeFixtures=function(){var e=box2d.b2Body.prototype.SynchronizeFixtures.s_xf1;e.q.SetAngleRadians(this.m_sweep.a0);box2d.b2MulRV(e.q,this.m_sweep.localCenter,e.p);box2d.b2SubVV(this.m_sweep.c0,e.p,e.p);for(var d=this.m_world.m_contactManager.m_broadPhase,f=this.m_fixtureList;f;f=f.m_next){f.Synchronize(d,e,this.m_xf)}};goog.exportProperty(box2d.b2Body.prototype,"SynchronizeFixtures",box2d.b2Body.prototype.SynchronizeFixtures);box2d.b2Body.prototype.SynchronizeFixtures.s_xf1=new box2d.b2Transform;box2d.b2Body.prototype.SynchronizeTransform=function(){this.m_xf.q.SetAngleRadians(this.m_sweep.a);box2d.b2MulRV(this.m_xf.q,this.m_sweep.localCenter,this.m_xf.p);box2d.b2SubVV(this.m_sweep.c,this.m_xf.p,this.m_xf.p)};goog.exportProperty(box2d.b2Body.prototype,"SynchronizeTransform",box2d.b2Body.prototype.SynchronizeTransform);box2d.b2Body.prototype.ShouldCollide=function(e){if(this.m_type!==box2d.b2BodyType.b2_dynamicBody&&e.m_type!==box2d.b2BodyType.b2_dynamicBody){return !1}for(var d=this.m_jointList;d;d=d.next){if(d.other===e&&!1===d.joint.m_collideConnected){return !1}}return !0};goog.exportProperty(box2d.b2Body.prototype,"ShouldCollide",box2d.b2Body.prototype.ShouldCollide);box2d.b2Body.prototype.Advance=function(b){this.m_sweep.Advance(b);this.m_sweep.c.Copy(this.m_sweep.c0);this.m_sweep.a=this.m_sweep.a0;this.m_xf.q.SetAngleRadians(this.m_sweep.a);box2d.b2MulRV(this.m_xf.q,this.m_sweep.localCenter,this.m_xf.p);box2d.b2SubVV(this.m_sweep.c,this.m_xf.p,this.m_xf.p)};goog.exportProperty(box2d.b2Body.prototype,"Advance",box2d.b2Body.prototype.Advance);box2d.b2Body.prototype.Dump=function(){if(box2d.DEBUG){var e=this.m_islandIndex;box2d.b2Log("if (true)\n");box2d.b2Log("{\n");box2d.b2Log("  /*box2d.b2BodyDef*/ var bd = new box2d.b2BodyDef();\n");var d="";switch(this.m_type){case box2d.b2BodyType.b2_staticBody:d="box2d.b2BodyType.b2_staticBody";break;case box2d.b2BodyType.b2_kinematicBody:d="box2d.b2BodyType.b2_kinematicBody";break;case box2d.b2BodyType.b2_dynamicBody:d="box2d.b2BodyType.b2_dynamicBody";break;default:box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1)}box2d.b2Log("  bd.type = %s;\n",d);box2d.b2Log("  bd.position.SetXY(%.15f, %.15f);\n",this.m_xf.p.x,this.m_xf.p.y);box2d.b2Log("  bd.angle = %.15f;\n",this.m_sweep.a);box2d.b2Log("  bd.linearVelocity.SetXY(%.15f, %.15f);\n",this.m_linearVelocity.x,this.m_linearVelocity.y);box2d.b2Log("  bd.angularVelocity = %.15f;\n",this.m_angularVelocity);box2d.b2Log("  bd.linearDamping = %.15f;\n",this.m_linearDamping);box2d.b2Log("  bd.angularDamping = %.15f;\n",this.m_angularDamping);box2d.b2Log("  bd.allowSleep = %s;\n",this.m_flags&box2d.b2BodyFlag.e_autoSleepFlag?"true":"false");box2d.b2Log("  bd.awake = %s;\n",this.m_flags&box2d.b2BodyFlag.e_awakeFlag?"true":"false");box2d.b2Log("  bd.fixedRotation = %s;\n",this.m_flags&box2d.b2BodyFlag.e_fixedRotationFlag?"true":"false");box2d.b2Log("  bd.bullet = %s;\n",this.m_flags&box2d.b2BodyFlag.e_bulletFlag?"true":"false");box2d.b2Log("  bd.active = %s;\n",this.m_flags&box2d.b2BodyFlag.e_activeFlag?"true":"false");box2d.b2Log("  bd.gravityScale = %.15f;\n",this.m_gravityScale);box2d.b2Log("\n");box2d.b2Log("  bodies[%d] = this.m_world.CreateBody(bd);\n",this.m_islandIndex);box2d.b2Log("\n");for(d=this.m_fixtureList;d;d=d.m_next){box2d.b2Log("  if (true)\n"),box2d.b2Log("  {\n"),d.Dump(e),box2d.b2Log("  }\n")}box2d.b2Log("}\n")}};goog.exportProperty(box2d.b2Body.prototype,"Dump",box2d.b2Body.prototype.Dump);box2d.b2Body.prototype.GetControllerList=function(){return this.m_controllerList};goog.exportProperty(box2d.b2Body.prototype,"GetControllerList",box2d.b2Body.prototype.GetControllerList);box2d.b2Body.prototype.GetControllerCount=function(){return this.m_controllerCount};goog.exportProperty(box2d.b2Body.prototype,"GetControllerCount",box2d.b2Body.prototype.GetControllerCount);box2d.b2Profile=function(){};goog.exportSymbol("box2d.b2Profile",box2d.b2Profile);box2d.b2Profile.prototype.step=0;goog.exportProperty(box2d.b2Profile.prototype,"step",box2d.b2Profile.prototype.step);box2d.b2Profile.prototype.collide=0;goog.exportProperty(box2d.b2Profile.prototype,"collide",box2d.b2Profile.prototype.collide);box2d.b2Profile.prototype.solve=0;goog.exportProperty(box2d.b2Profile.prototype,"solve",box2d.b2Profile.prototype.solve);box2d.b2Profile.prototype.solveInit=0;goog.exportProperty(box2d.b2Profile.prototype,"solveInit",box2d.b2Profile.prototype.solveInit);box2d.b2Profile.prototype.solveVelocity=0;goog.exportProperty(box2d.b2Profile.prototype,"solveVelocity",box2d.b2Profile.prototype.solveVelocity);box2d.b2Profile.prototype.solvePosition=0;goog.exportProperty(box2d.b2Profile.prototype,"solvePosition",box2d.b2Profile.prototype.solvePosition);box2d.b2Profile.prototype.broadphase=0;goog.exportProperty(box2d.b2Profile.prototype,"broadphase",box2d.b2Profile.prototype.broadphase);box2d.b2Profile.prototype.solveTOI=0;goog.exportProperty(box2d.b2Profile.prototype,"solveTOI",box2d.b2Profile.prototype.solveTOI);box2d.b2Profile.prototype.Reset=function(){this.solveTOI=this.broadphase=this.solvePosition=this.solveVelocity=this.solveInit=this.solve=this.collide=this.step=0;return this};goog.exportProperty(box2d.b2Profile.prototype,"Reset",box2d.b2Profile.prototype.Reset);box2d.b2TimeStep=function(){};goog.exportSymbol("box2d.b2TimeStep",box2d.b2TimeStep);box2d.b2TimeStep.prototype.dt=0;goog.exportProperty(box2d.b2TimeStep.prototype,"dt",box2d.b2TimeStep.prototype.dt);box2d.b2TimeStep.prototype.inv_dt=0;goog.exportProperty(box2d.b2TimeStep.prototype,"inv_dt",box2d.b2TimeStep.prototype.inv_dt);box2d.b2TimeStep.prototype.dtRatio=0;goog.exportProperty(box2d.b2TimeStep.prototype,"dtRatio",box2d.b2TimeStep.prototype.dtRatio);box2d.b2TimeStep.prototype.velocityIterations=0;goog.exportProperty(box2d.b2TimeStep.prototype,"velocityIterations",box2d.b2TimeStep.prototype.velocityIterations);box2d.b2TimeStep.prototype.positionIterations=0;goog.exportProperty(box2d.b2TimeStep.prototype,"positionIterations",box2d.b2TimeStep.prototype.positionIterations);box2d.b2TimeStep.prototype.warmStarting=!1;goog.exportProperty(box2d.b2TimeStep.prototype,"warmStarting",box2d.b2TimeStep.prototype.warmStarting);box2d.b2TimeStep.prototype.Copy=function(b){this.dt=b.dt;this.inv_dt=b.inv_dt;this.dtRatio=b.dtRatio;this.positionIterations=b.positionIterations;this.velocityIterations=b.velocityIterations;this.warmStarting=b.warmStarting;return this};goog.exportProperty(box2d.b2TimeStep.prototype,"Copy",box2d.b2TimeStep.prototype.Copy);box2d.b2Position=function(){this.c=new box2d.b2Vec2};goog.exportSymbol("box2d.b2Position",box2d.b2Position);box2d.b2Position.prototype.c=null;goog.exportProperty(box2d.b2Position.prototype,"c",box2d.b2Position.prototype.c);box2d.b2Position.prototype.a=0;goog.exportProperty(box2d.b2Position.prototype,"a",box2d.b2Position.prototype.a);box2d.b2Position.MakeArray=function(b){return box2d.b2MakeArray(b,function(d){return new box2d.b2Position})};goog.exportProperty(box2d.b2Position,"MakeArray",box2d.b2Position.MakeArray);box2d.b2Velocity=function(){this.v=new box2d.b2Vec2};goog.exportSymbol("box2d.b2Velocity",box2d.b2Velocity);box2d.b2Velocity.prototype.v=null;goog.exportProperty(box2d.b2Velocity.prototype,"v",box2d.b2Velocity.prototype.v);box2d.b2Velocity.prototype.w=0;goog.exportProperty(box2d.b2Velocity.prototype,"w",box2d.b2Velocity.prototype.w);box2d.b2Velocity.MakeArray=function(b){return box2d.b2MakeArray(b,function(d){return new box2d.b2Velocity})};goog.exportProperty(box2d.b2Velocity,"MakeArray",box2d.b2Velocity.MakeArray);box2d.b2SolverData=function(){this.step=new box2d.b2TimeStep};goog.exportSymbol("box2d.b2SolverData",box2d.b2SolverData);box2d.b2SolverData.prototype.step=null;goog.exportProperty(box2d.b2SolverData.prototype,"step",box2d.b2SolverData.prototype.step);box2d.b2SolverData.prototype.positions=null;goog.exportProperty(box2d.b2SolverData.prototype,"positions",box2d.b2SolverData.prototype.positions);box2d.b2SolverData.prototype.velocities=null;goog.exportProperty(box2d.b2SolverData.prototype,"velocities",box2d.b2SolverData.prototype.velocities);box2d.b2WorldCallbacks={};box2d.b2DestructionListener=function(){};goog.exportSymbol("box2d.b2DestructionListener",box2d.b2DestructionListener);box2d.b2DestructionListener.prototype.SayGoodbyeJoint=function(b){};goog.exportProperty(box2d.b2DestructionListener.prototype,"SayGoodbyeJoint",box2d.b2DestructionListener.prototype.SayGoodbyeJoint);box2d.b2DestructionListener.prototype.SayGoodbyeFixture=function(b){};goog.exportProperty(box2d.b2DestructionListener.prototype,"SayGoodbyeFixture",box2d.b2DestructionListener.prototype.SayGoodbyeFixture);box2d.b2ContactFilter=function(){};goog.exportSymbol("box2d.b2ContactFilter",box2d.b2ContactFilter);box2d.b2ContactFilter.prototype.ShouldCollide=function(f,e){var j=f.GetFilterData(),g=e.GetFilterData();return j.groupIndex===g.groupIndex&&0!==j.groupIndex?0<j.groupIndex:0!==(j.maskBits&g.categoryBits)&&0!==(j.categoryBits&g.maskBits)};goog.exportProperty(box2d.b2ContactFilter.prototype,"ShouldCollide",box2d.b2ContactFilter.prototype.ShouldCollide);box2d.b2ContactFilter.b2_defaultFilter=new box2d.b2ContactFilter;box2d.b2ContactImpulse=function(){this.normalImpulses=box2d.b2MakeNumberArray(box2d.b2_maxManifoldPoints);this.tangentImpulses=box2d.b2MakeNumberArray(box2d.b2_maxManifoldPoints)};goog.exportSymbol("box2d.b2ContactImpulse",box2d.b2ContactImpulse);box2d.b2ContactImpulse.prototype.normalImpulses=null;box2d.b2ContactImpulse.prototype.tangentImpulses=null;box2d.b2ContactImpulse.prototype.count=0;box2d.b2ContactListener=function(){};goog.exportSymbol("box2d.b2ContactListener",box2d.b2ContactListener);box2d.b2ContactListener.prototype.BeginContact=function(b){};goog.exportProperty(box2d.b2ContactListener.prototype,"BeginContact",box2d.b2ContactListener.prototype.BeginContact);box2d.b2ContactListener.prototype.EndContact=function(b){};goog.exportProperty(box2d.b2ContactListener.prototype,"EndContact",box2d.b2ContactListener.prototype.EndContact);box2d.b2ContactListener.prototype.PreSolve=function(e,d){};goog.exportProperty(box2d.b2ContactListener.prototype,"PreSolve",box2d.b2ContactListener.prototype.PreSolve);box2d.b2ContactListener.prototype.PostSolve=function(e,d){};goog.exportProperty(box2d.b2ContactListener.prototype,"PostSolve",box2d.b2ContactListener.prototype.PostSolve);box2d.b2ContactListener.b2_defaultListener=new box2d.b2ContactListener;goog.exportProperty(box2d.b2ContactListener,"b2_defaultListener",box2d.b2ContactListener.b2_defaultListener);box2d.b2QueryCallback=function(){};goog.exportSymbol("box2d.b2QueryCallback",box2d.b2QueryCallback);box2d.b2QueryCallback.prototype.ReportFixture=function(b){return !0};goog.exportProperty(box2d.b2QueryCallback.prototype,"ReportFixture",box2d.b2QueryCallback.prototype.ReportFixture);box2d.b2RayCastCallback=function(){};goog.exportSymbol("box2d.b2RayCastCallback",box2d.b2RayCastCallback);box2d.b2RayCastCallback.prototype.ReportFixture=function(f,e,j,g){return g};goog.exportProperty(box2d.b2RayCastCallback.prototype,"ReportFixture",box2d.b2RayCastCallback.prototype.ReportFixture);box2d.b2BuoyancyController=function(){box2d.b2Controller.call(this);this.normal=new box2d.b2Vec2(0,1);this.velocity=new box2d.b2Vec2(0,0);this.gravity=new box2d.b2Vec2(0,0)};goog.inherits(box2d.b2BuoyancyController,box2d.b2Controller);goog.exportSymbol("box2d.b2BuoyancyController",box2d.b2BuoyancyController);box2d.b2BuoyancyController.prototype.normal=null;goog.exportProperty(box2d.b2BuoyancyController.prototype,"normal",box2d.b2BuoyancyController.prototype.normal);box2d.b2BuoyancyController.prototype.offset=0;goog.exportProperty(box2d.b2BuoyancyController.prototype,"offset",box2d.b2BuoyancyController.prototype.offset);box2d.b2BuoyancyController.prototype.density=0;goog.exportProperty(box2d.b2BuoyancyController.prototype,"density",box2d.b2BuoyancyController.prototype.density);box2d.b2BuoyancyController.prototype.velocity=null;goog.exportProperty(box2d.b2BuoyancyController.prototype,"velocity",box2d.b2BuoyancyController.prototype.velocity);box2d.b2BuoyancyController.prototype.linearDrag=0;goog.exportProperty(box2d.b2BuoyancyController.prototype,"linearDrag",box2d.b2BuoyancyController.prototype.linearDrag);box2d.b2BuoyancyController.prototype.angularDrag=0;goog.exportProperty(box2d.b2BuoyancyController.prototype,"angularDrag",box2d.b2BuoyancyController.prototype.angularDrag);box2d.b2BuoyancyController.prototype.useDensity=!1;goog.exportProperty(box2d.b2BuoyancyController.prototype,"useDensity",box2d.b2BuoyancyController.prototype.useDensity);box2d.b2BuoyancyController.prototype.useWorldGravity=!0;goog.exportProperty(box2d.b2BuoyancyController.prototype,"useWorldGravity",box2d.b2BuoyancyController.prototype.useWorldGravity);box2d.b2BuoyancyController.prototype.gravity=null;goog.exportProperty(box2d.b2BuoyancyController.prototype,"gravity",box2d.b2BuoyancyController.prototype.gravity);box2d.b2BuoyancyController.prototype.Step=function(z){if(this.m_bodyList){for(this.useWorldGravity&&this.gravity.Copy(this.GetWorld().GetGravity()),z=this.m_bodyList;z;z=z.nextBody){var y=z.body;if(!1!==y.IsAwake()){for(var v=new box2d.b2Vec2,u=new box2d.b2Vec2,s=0,r=0,q=y.GetFixtureList();q;q=q.m_next){var n=new box2d.b2Vec2,j=q.GetShape().ComputeSubmergedArea(this.normal,this.offset,y.GetTransform(),n),s=s+j;v.x+=j*n.x;v.y+=j*n.y;var m=0,m=this.useDensity?q.GetDensity():1,r=r+j*m;u.x+=j*n.x*m;u.y+=j*n.y*m}v.x/=s;v.y/=s;u.x/=r;u.y/=r;s<box2d.b2_epsilon||(r=box2d.b2NegV(this.gravity,new box2d.b2Vec2),r.SelfMul(this.density*s),y.ApplyForce(r,u),u=y.GetLinearVelocityFromWorldPoint(v,new box2d.b2Vec2),u.SelfSub(this.velocity),u.SelfMul(-this.linearDrag*s),y.ApplyForce(u,v),y.ApplyTorque(-y.GetInertia()/y.GetMass()*s*y.GetAngularVelocity()*this.angularDrag))}}}};goog.exportProperty(box2d.b2BuoyancyController.prototype,"Step",box2d.b2BuoyancyController.prototype.Step);box2d.b2BuoyancyController.prototype.Draw=function(f){var e=new box2d.b2Vec2,j=new box2d.b2Vec2;e.x=this.normal.x*this.offset+100*this.normal.y;e.y=this.normal.y*this.offset-100*this.normal.x;j.x=this.normal.x*this.offset-100*this.normal.y;j.y=this.normal.y*this.offset+100*this.normal.x;var g=new box2d.b2Color(0,0,0.8);f.DrawSegment(e,j,g)};goog.exportProperty(box2d.b2BuoyancyController.prototype,"Draw",box2d.b2BuoyancyController.prototype.Draw);box2d.b2MixFriction=function(e,d){return box2d.b2Sqrt(e*d)};goog.exportSymbol("box2d.b2MixFriction",box2d.b2MixFriction);box2d.b2MixRestitution=function(e,d){return e>d?e:d};goog.exportSymbol("box2d.b2MixRestitution",box2d.b2MixRestitution);box2d.b2ContactEdge=function(){};goog.exportSymbol("box2d.b2ContactEdge",box2d.b2ContactEdge);box2d.b2ContactEdge.prototype.other=null;goog.exportProperty(box2d.b2ContactEdge.prototype,"other",box2d.b2ContactEdge.prototype.other);box2d.b2ContactEdge.prototype.contact=null;goog.exportProperty(box2d.b2ContactEdge.prototype,"contact",box2d.b2ContactEdge.prototype.contact);box2d.b2ContactEdge.prototype.prev=null;goog.exportProperty(box2d.b2ContactEdge.prototype,"prev",box2d.b2ContactEdge.prototype.prev);box2d.b2ContactEdge.prototype.next=null;goog.exportProperty(box2d.b2ContactEdge.prototype,"next",box2d.b2ContactEdge.prototype.next);box2d.b2ContactFlag={e_none:0,e_islandFlag:1,e_touchingFlag:2,e_enabledFlag:4,e_filterFlag:8,e_bulletHitFlag:16,e_toiFlag:32};goog.exportProperty(box2d.b2ContactFlag,"e_none",box2d.b2ContactFlag.e_none);goog.exportProperty(box2d.b2ContactFlag,"e_islandFlag",box2d.b2ContactFlag.e_islandFlag);goog.exportProperty(box2d.b2ContactFlag,"e_touchingFlag",box2d.b2ContactFlag.e_touchingFlag);goog.exportProperty(box2d.b2ContactFlag,"e_enabledFlag",box2d.b2ContactFlag.e_enabledFlag);goog.exportProperty(box2d.b2ContactFlag,"e_filterFlag",box2d.b2ContactFlag.e_filterFlag);goog.exportProperty(box2d.b2ContactFlag,"e_bulletHitFlag",box2d.b2ContactFlag.e_bulletHitFlag);goog.exportProperty(box2d.b2ContactFlag,"e_toiFlag",box2d.b2ContactFlag.e_toiFlag);box2d.b2Contact=function(){this.m_nodeA=new box2d.b2ContactEdge;this.m_nodeB=new box2d.b2ContactEdge;this.m_manifold=new box2d.b2Manifold;this.m_oldManifold=new box2d.b2Manifold};goog.exportSymbol("box2d.b2Contact",box2d.b2Contact);box2d.b2Contact.prototype.m_flags=box2d.b2ContactFlag.e_none;goog.exportProperty(box2d.b2Contact.prototype,"m_flags",box2d.b2Contact.prototype.m_flags);box2d.b2Contact.prototype.m_prev=null;goog.exportProperty(box2d.b2Contact.prototype,"m_prev",box2d.b2Contact.prototype.m_prev);box2d.b2Contact.prototype.m_next=null;goog.exportProperty(box2d.b2Contact.prototype,"m_next",box2d.b2Contact.prototype.m_next);box2d.b2Contact.prototype.m_nodeA=null;goog.exportProperty(box2d.b2Contact.prototype,"m_nodeA",box2d.b2Contact.prototype.m_nodeA);box2d.b2Contact.prototype.m_nodeB=null;goog.exportProperty(box2d.b2Contact.prototype,"m_nodeB",box2d.b2Contact.prototype.m_nodeB);box2d.b2Contact.prototype.m_fixtureA=null;goog.exportProperty(box2d.b2Contact.prototype,"m_fixtureA",box2d.b2Contact.prototype.m_fixtureA);box2d.b2Contact.prototype.m_fixtureB=null;goog.exportProperty(box2d.b2Contact.prototype,"m_fixtureB",box2d.b2Contact.prototype.m_fixtureB);box2d.b2Contact.prototype.m_indexA=0;goog.exportProperty(box2d.b2Contact.prototype,"m_indexA",box2d.b2Contact.prototype.m_indexA);box2d.b2Contact.prototype.m_indexB=0;goog.exportProperty(box2d.b2Contact.prototype,"m_indexB",box2d.b2Contact.prototype.m_indexB);box2d.b2Contact.prototype.m_manifold=null;goog.exportProperty(box2d.b2Contact.prototype,"m_manifold",box2d.b2Contact.prototype.m_manifold);box2d.b2Contact.prototype.m_toiCount=0;goog.exportProperty(box2d.b2Contact.prototype,"m_toiCount",box2d.b2Contact.prototype.m_toiCount);box2d.b2Contact.prototype.m_toi=0;goog.exportProperty(box2d.b2Contact.prototype,"m_toi",box2d.b2Contact.prototype.m_toi);box2d.b2Contact.prototype.m_friction=0;goog.exportProperty(box2d.b2Contact.prototype,"m_friction",box2d.b2Contact.prototype.m_friction);box2d.b2Contact.prototype.m_restitution=0;goog.exportProperty(box2d.b2Contact.prototype,"m_restitution",box2d.b2Contact.prototype.m_restitution);box2d.b2Contact.prototype.m_tangentSpeed=0;goog.exportProperty(box2d.b2Contact.prototype,"m_tangentSpeed",box2d.b2Contact.prototype.m_tangentSpeed);box2d.b2Contact.prototype.m_oldManifold=null;goog.exportProperty(box2d.b2Contact.prototype,"m_oldManifold",box2d.b2Contact.prototype.m_oldManifold);box2d.b2Contact.prototype.GetManifold=function(){return this.m_manifold};goog.exportProperty(box2d.b2Contact.prototype,"GetManifold",box2d.b2Contact.prototype.GetManifold);box2d.b2Contact.prototype.GetWorldManifold=function(g){var f=this.m_fixtureA.GetBody(),m=this.m_fixtureB.GetBody(),k=this.m_fixtureA.GetShape(),j=this.m_fixtureB.GetShape();g.Initialize(this.m_manifold,f.GetTransform(),k.m_radius,m.GetTransform(),j.m_radius)};goog.exportProperty(box2d.b2Contact.prototype,"GetWorldManifold",box2d.b2Contact.prototype.GetWorldManifold);box2d.b2Contact.prototype.IsTouching=function(){return(this.m_flags&box2d.b2ContactFlag.e_touchingFlag)===box2d.b2ContactFlag.e_touchingFlag};goog.exportProperty(box2d.b2Contact.prototype,"IsTouching",box2d.b2Contact.prototype.IsTouching);box2d.b2Contact.prototype.SetEnabled=function(b){this.m_flags=b?this.m_flags|box2d.b2ContactFlag.e_enabledFlag:this.m_flags&~box2d.b2ContactFlag.e_enabledFlag};goog.exportProperty(box2d.b2Contact.prototype,"SetEnabled",box2d.b2Contact.prototype.SetEnabled);box2d.b2Contact.prototype.IsEnabled=function(){return(this.m_flags&box2d.b2ContactFlag.e_enabledFlag)===box2d.b2ContactFlag.e_enabledFlag};goog.exportProperty(box2d.b2Contact.prototype,"IsEnabled",box2d.b2Contact.prototype.IsEnabled);box2d.b2Contact.prototype.GetNext=function(){return this.m_next};goog.exportProperty(box2d.b2Contact.prototype,"GetNext",box2d.b2Contact.prototype.GetNext);box2d.b2Contact.prototype.GetFixtureA=function(){return this.m_fixtureA};goog.exportProperty(box2d.b2Contact.prototype,"GetFixtureA",box2d.b2Contact.prototype.GetFixtureA);box2d.b2Contact.prototype.GetChildIndexA=function(){return this.m_indexA};goog.exportProperty(box2d.b2Contact.prototype,"GetChildIndexA",box2d.b2Contact.prototype.GetChildIndexA);box2d.b2Contact.prototype.GetFixtureB=function(){return this.m_fixtureB};goog.exportProperty(box2d.b2Contact.prototype,"GetFixtureB",box2d.b2Contact.prototype.GetFixtureB);box2d.b2Contact.prototype.GetChildIndexB=function(){return this.m_indexB};goog.exportProperty(box2d.b2Contact.prototype,"GetChildIndexB",box2d.b2Contact.prototype.GetChildIndexB);box2d.b2Contact.prototype.Evaluate=function(e,d,f){};goog.exportProperty(box2d.b2Contact.prototype,"Evaluate",box2d.b2Contact.prototype.Evaluate);box2d.b2Contact.prototype.FlagForFiltering=function(){this.m_flags|=box2d.b2ContactFlag.e_filterFlag};goog.exportProperty(box2d.b2Contact.prototype,"FlagForFiltering",box2d.b2Contact.prototype.FlagForFiltering);box2d.b2Contact.prototype.SetFriction=function(b){this.m_friction=b};goog.exportProperty(box2d.b2Contact.prototype,"SetFriction",box2d.b2Contact.prototype.SetFriction);box2d.b2Contact.prototype.GetFriction=function(){return this.m_friction};goog.exportProperty(box2d.b2Contact.prototype,"GetFriction",box2d.b2Contact.prototype.GetFriction);box2d.b2Contact.prototype.ResetFriction=function(){this.m_friction=box2d.b2MixFriction(this.m_fixtureA.m_friction,this.m_fixtureB.m_friction)};goog.exportProperty(box2d.b2Contact.prototype,"ResetFriction",box2d.b2Contact.prototype.ResetFriction);box2d.b2Contact.prototype.SetRestitution=function(b){this.m_restitution=b};goog.exportProperty(box2d.b2Contact.prototype,"SetRestitution",box2d.b2Contact.prototype.SetRestitution);box2d.b2Contact.prototype.GetRestitution=function(){return this.m_restitution};goog.exportProperty(box2d.b2Contact.prototype,"GetRestitution",box2d.b2Contact.prototype.GetRestitution);box2d.b2Contact.prototype.ResetRestitution=function(){this.m_restitution=box2d.b2MixRestitution(this.m_fixtureA.m_restitution,this.m_fixtureB.m_restitution)};goog.exportProperty(box2d.b2Contact.prototype,"ResetRestitution",box2d.b2Contact.prototype.ResetRestitution);box2d.b2Contact.prototype.SetTangentSpeed=function(b){this.m_tangentSpeed=b};goog.exportProperty(box2d.b2Contact.prototype,"SetTangentSpeed",box2d.b2Contact.prototype.SetTangentSpeed);box2d.b2Contact.prototype.GetTangentSpeed=function(){return this.m_tangentSpeed};goog.exportProperty(box2d.b2Contact.prototype,"GetTangentSpeed",box2d.b2Contact.prototype.GetTangentSpeed);box2d.b2Contact.prototype.Reset=function(f,e,j,g){this.m_flags=box2d.b2ContactFlag.e_enabledFlag;this.m_fixtureA=f;this.m_fixtureB=j;this.m_indexA=e;this.m_indexB=g;this.m_manifold.pointCount=0;this.m_next=this.m_prev=null;this.m_nodeA.contact=null;this.m_nodeA.prev=null;this.m_nodeA.next=null;this.m_nodeA.other=null;this.m_nodeB.contact=null;this.m_nodeB.prev=null;this.m_nodeB.next=null;this.m_nodeB.other=null;this.m_toiCount=0;this.m_friction=box2d.b2MixFriction(this.m_fixtureA.m_friction,this.m_fixtureB.m_friction);this.m_restitution=box2d.b2MixRestitution(this.m_fixtureA.m_restitution,this.m_fixtureB.m_restitution)};goog.exportProperty(box2d.b2Contact.prototype,"Reset",box2d.b2Contact.prototype.Reset);box2d.b2Contact.prototype.Update=function(B){var A=this.m_oldManifold;this.m_oldManifold=this.m_manifold;this.m_manifold=A;this.m_flags|=box2d.b2ContactFlag.e_enabledFlag;var z=!1,A=(this.m_flags&box2d.b2ContactFlag.e_touchingFlag)===box2d.b2ContactFlag.e_touchingFlag,y=this.m_fixtureA.IsSensor(),v=this.m_fixtureB.IsSensor(),y=y||v,v=this.m_fixtureA.GetBody(),u=this.m_fixtureB.GetBody(),z=v.GetTransform(),s=u.GetTransform();if(y){v=this.m_fixtureA.GetShape(),u=this.m_fixtureB.GetShape(),z=box2d.b2TestOverlapShape(v,this.m_indexA,u,this.m_indexB,z,s),this.m_manifold.pointCount=0}else{this.Evaluate(this.m_manifold,z,s);z=0<this.m_manifold.pointCount;for(s=0;s<this.m_manifold.pointCount;++s){var r=this.m_manifold.points[s];r.normalImpulse=0;r.tangentImpulse=0;for(var n=r.id,q=0;q<this.m_oldManifold.pointCount;++q){var j=this.m_oldManifold.points[q];if(j.id.key===n.key){r.normalImpulse=j.normalImpulse;r.tangentImpulse=j.tangentImpulse;break}}}z!==A&&(v.SetAwake(!0),u.SetAwake(!0))}this.m_flags=z?this.m_flags|box2d.b2ContactFlag.e_touchingFlag:this.m_flags&~box2d.b2ContactFlag.e_touchingFlag;!1===A&&!0===z&&B&&B.BeginContact(this);!0===A&&!1===z&&B&&B.EndContact(this);!1===y&&z&&B&&B.PreSolve(this,this.m_oldManifold)};goog.exportProperty(box2d.b2Contact.prototype,"Update",box2d.b2Contact.prototype.Update);box2d.b2Contact.prototype.ComputeTOI=function(f,e){var j=box2d.b2Contact.prototype.ComputeTOI.s_input;j.proxyA.SetShape(this.m_fixtureA.GetShape(),this.m_indexA);j.proxyB.SetShape(this.m_fixtureB.GetShape(),this.m_indexB);j.sweepA.Copy(f);j.sweepB.Copy(e);j.tMax=box2d.b2_linearSlop;var g=box2d.b2Contact.prototype.ComputeTOI.s_output;box2d.b2TimeOfImpact(g,j);return g.t};goog.exportProperty(box2d.b2Contact.prototype,"ComputeTOI",box2d.b2Contact.prototype.ComputeTOI);box2d.b2Contact.prototype.ComputeTOI.s_input=new box2d.b2TOIInput;box2d.b2Contact.prototype.ComputeTOI.s_output=new box2d.b2TOIOutput;box2d.b2ChainAndCircleContact=function(){box2d.b2Contact.call(this)};goog.inherits(box2d.b2ChainAndCircleContact,box2d.b2Contact);goog.exportSymbol("box2d.b2ChainAndCircleContact",box2d.b2ChainAndCircleContact);box2d.b2ChainAndCircleContact.Create=function(b){return new box2d.b2ChainAndCircleContact};goog.exportProperty(box2d.b2ChainAndCircleContact,"Create",box2d.b2ChainAndCircleContact.Create);box2d.b2ChainAndCircleContact.Destroy=function(e,d){};goog.exportProperty(box2d.b2ChainAndCircleContact,"Destroy",box2d.b2ChainAndCircleContact.Destroy);box2d.b2ChainAndCircleContact.prototype.Evaluate=function(j,g,q){var n=this.m_fixtureA.GetShape(),m=this.m_fixtureB.GetShape();box2d.ENABLE_ASSERTS&&box2d.b2Assert(n instanceof box2d.b2ChainShape);box2d.ENABLE_ASSERTS&&box2d.b2Assert(m instanceof box2d.b2CircleShape);var k=box2d.b2ChainAndCircleContact.prototype.Evaluate.s_edge;(n instanceof box2d.b2ChainShape?n:null).GetChildEdge(k,this.m_indexA);box2d.b2CollideEdgeAndCircle(j,k,g,m instanceof box2d.b2CircleShape?m:null,q)};goog.exportProperty(box2d.b2ChainAndCircleContact.prototype,"Evaluate",box2d.b2ChainAndCircleContact.prototype.Evaluate);box2d.b2ChainAndCircleContact.prototype.Evaluate.s_edge=new box2d.b2EdgeShape;box2d.b2ChainAndPolygonContact=function(){box2d.b2Contact.call(this)};goog.inherits(box2d.b2ChainAndPolygonContact,box2d.b2Contact);goog.exportSymbol("box2d.b2ChainAndPolygonContact",box2d.b2ChainAndPolygonContact);box2d.b2ChainAndPolygonContact.Create=function(b){return new box2d.b2ChainAndPolygonContact};goog.exportProperty(box2d.b2ChainAndPolygonContact,"Create",box2d.b2ChainAndPolygonContact.Create);box2d.b2ChainAndPolygonContact.Destroy=function(e,d){};goog.exportProperty(box2d.b2ChainAndPolygonContact,"Destroy",box2d.b2ChainAndPolygonContact.Destroy);box2d.b2ChainAndPolygonContact.prototype.Evaluate=function(j,g,q){var n=this.m_fixtureA.GetShape(),m=this.m_fixtureB.GetShape();box2d.ENABLE_ASSERTS&&box2d.b2Assert(n instanceof box2d.b2ChainShape);box2d.ENABLE_ASSERTS&&box2d.b2Assert(m instanceof box2d.b2PolygonShape);var k=box2d.b2ChainAndPolygonContact.prototype.Evaluate.s_edge;(n instanceof box2d.b2ChainShape?n:null).GetChildEdge(k,this.m_indexA);box2d.b2CollideEdgeAndPolygon(j,k,g,m instanceof box2d.b2PolygonShape?m:null,q)};goog.exportProperty(box2d.b2ChainAndPolygonContact.prototype,"Evaluate",box2d.b2ChainAndPolygonContact.prototype.Evaluate);box2d.b2ChainAndPolygonContact.prototype.Evaluate.s_edge=new box2d.b2EdgeShape;box2d.b2CircleContact=function(){box2d.b2Contact.call(this)};goog.inherits(box2d.b2CircleContact,box2d.b2Contact);goog.exportSymbol("box2d.b2CircleContact",box2d.b2CircleContact);box2d.b2CircleContact.Create=function(b){return new box2d.b2CircleContact};goog.exportProperty(box2d.b2CircleContact,"Create",box2d.b2CircleContact.Create);box2d.b2CircleContact.Destroy=function(e,d){};goog.exportProperty(box2d.b2CircleContact,"Destroy",box2d.b2CircleContact.Destroy);box2d.b2CircleContact.prototype.Evaluate=function(g,f,m){var k=this.m_fixtureA.GetShape(),j=this.m_fixtureB.GetShape();box2d.ENABLE_ASSERTS&&box2d.b2Assert(k instanceof box2d.b2CircleShape);box2d.ENABLE_ASSERTS&&box2d.b2Assert(j instanceof box2d.b2CircleShape);box2d.b2CollideCircles(g,k instanceof box2d.b2CircleShape?k:null,f,j instanceof box2d.b2CircleShape?j:null,m)};goog.exportProperty(box2d.b2CircleContact.prototype,"Evaluate",box2d.b2CircleContact.prototype.Evaluate);box2d.b2ContactRegister=function(){};goog.exportSymbol("box2d.b2ContactRegister",box2d.b2ContactRegister);box2d.b2ContactRegister.prototype.createFcn=null;box2d.b2ContactRegister.prototype.destroyFcn=null;box2d.b2ContactRegister.prototype.primary=!1;box2d.b2ContactFactory=function(b){this.m_allocator=b;this.InitializeRegisters()};goog.exportSymbol("box2d.b2ContactFactory",box2d.b2ContactFactory);box2d.b2ContactFactory.prototype.m_allocator=null;box2d.b2ContactFactory.prototype.AddType=function(j,g,q,n){var m=box2d.b2MakeArray(256,function(a){return j()});g=function(a){return 0<m.length?m.pop():j(a)};var k=function(e,d){m.push(e)};this.m_registers[q][n].pool=m;this.m_registers[q][n].createFcn=g;this.m_registers[q][n].destroyFcn=k;this.m_registers[q][n].primary=!0;q!==n&&(this.m_registers[n][q].pool=m,this.m_registers[n][q].createFcn=g,this.m_registers[n][q].destroyFcn=k,this.m_registers[n][q].primary=!1)};goog.exportProperty(box2d.b2ContactFactory.prototype,"AddType",box2d.b2ContactFactory.prototype.AddType);box2d.b2ContactFactory.prototype.InitializeRegisters=function(){this.m_registers=Array(box2d.b2ShapeType.e_shapeTypeCount);for(var e=0;e<box2d.b2ShapeType.e_shapeTypeCount;e++){this.m_registers[e]=Array(box2d.b2ShapeType.e_shapeTypeCount);for(var d=0;d<box2d.b2ShapeType.e_shapeTypeCount;d++){this.m_registers[e][d]=new box2d.b2ContactRegister}}this.AddType(box2d.b2CircleContact.Create,box2d.b2CircleContact.Destroy,box2d.b2ShapeType.e_circleShape,box2d.b2ShapeType.e_circleShape);this.AddType(box2d.b2PolygonAndCircleContact.Create,box2d.b2PolygonAndCircleContact.Destroy,box2d.b2ShapeType.e_polygonShape,box2d.b2ShapeType.e_circleShape);this.AddType(box2d.b2PolygonContact.Create,box2d.b2PolygonContact.Destroy,box2d.b2ShapeType.e_polygonShape,box2d.b2ShapeType.e_polygonShape);this.AddType(box2d.b2EdgeAndCircleContact.Create,box2d.b2EdgeAndCircleContact.Destroy,box2d.b2ShapeType.e_edgeShape,box2d.b2ShapeType.e_circleShape);this.AddType(box2d.b2EdgeAndPolygonContact.Create,box2d.b2EdgeAndPolygonContact.Destroy,box2d.b2ShapeType.e_edgeShape,box2d.b2ShapeType.e_polygonShape);this.AddType(box2d.b2ChainAndCircleContact.Create,box2d.b2ChainAndCircleContact.Destroy,box2d.b2ShapeType.e_chainShape,box2d.b2ShapeType.e_circleShape);this.AddType(box2d.b2ChainAndPolygonContact.Create,box2d.b2ChainAndPolygonContact.Destroy,box2d.b2ShapeType.e_chainShape,box2d.b2ShapeType.e_polygonShape)};goog.exportProperty(box2d.b2ContactFactory.prototype,"InitializeRegisters",box2d.b2ContactFactory.prototype.InitializeRegisters);box2d.b2ContactFactory.prototype.Create=function(j,g,q,n){var m=j.GetType(),k=q.GetType();box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<=m&&m<box2d.b2ShapeType.e_shapeTypeCount);box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<=k&&k<box2d.b2ShapeType.e_shapeTypeCount);m=this.m_registers[m][k];k=m.createFcn;return null!==k?(m.primary?(m=k(this.m_allocator),m.Reset(j,g,q,n)):(m=k(this.m_allocator),m.Reset(q,n,j,g)),m):null};goog.exportProperty(box2d.b2ContactFactory.prototype,"Create",box2d.b2ContactFactory.prototype.Create);box2d.b2ContactFactory.prototype.Destroy=function(e){var d=e.m_fixtureA,f=e.m_fixtureB;0<e.m_manifold.pointCount&&!1===d.IsSensor()&&!1===f.IsSensor()&&(d.GetBody().SetAwake(!0),f.GetBody().SetAwake(!0));d=d.GetType();f=f.GetType();box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<=d&&f<box2d.b2ShapeType.e_shapeTypeCount);box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<=d&&f<box2d.b2ShapeType.e_shapeTypeCount);f=this.m_registers[d][f].destroyFcn;f(e,this.m_allocator)};goog.exportProperty(box2d.b2ContactFactory.prototype,"Destroy",box2d.b2ContactFactory.prototype.Destroy);box2d.b2ContactManager=function(){this.m_broadPhase=new box2d.b2BroadPhase;this.m_contactFactory=new box2d.b2ContactFactory(this.m_allocator)};box2d.b2ContactManager.prototype.m_broadPhase=null;goog.exportSymbol("box2d.b2ContactManager.prototype.m_broadPhase",box2d.b2ContactManager.prototype.m_broadPhase);box2d.b2ContactManager.prototype.m_contactList=null;goog.exportSymbol("box2d.b2ContactManager.prototype.m_contactList",box2d.b2ContactManager.prototype.m_contactList);box2d.b2ContactManager.prototype.m_contactCount=0;goog.exportSymbol("box2d.b2ContactManager.prototype.m_contactCount",box2d.b2ContactManager.prototype.m_contactCount);box2d.b2ContactManager.prototype.m_contactFilter=box2d.b2ContactFilter.b2_defaultFilter;goog.exportSymbol("box2d.b2ContactManager.prototype.m_contactFilter",box2d.b2ContactManager.prototype.m_contactFilter);box2d.b2ContactManager.prototype.m_contactListener=box2d.b2ContactListener.b2_defaultListener;goog.exportSymbol("box2d.b2ContactManager.prototype.m_contactListener",box2d.b2ContactManager.prototype.m_contactListener);box2d.b2ContactManager.prototype.m_allocator=null;goog.exportSymbol("box2d.b2ContactManager.prototype.m_allocator",box2d.b2ContactManager.prototype.m_allocator);box2d.b2ContactManager.prototype.m_contactFactory=null;goog.exportSymbol("box2d.b2ContactManager.prototype.m_contactFactory",box2d.b2ContactManager.prototype.m_contactFactory);box2d.b2ContactManager.prototype.Destroy=function(e){var d=e.GetFixtureA(),f=e.GetFixtureB(),d=d.GetBody(),f=f.GetBody();this.m_contactListener&&e.IsTouching()&&this.m_contactListener.EndContact(e);e.m_prev&&(e.m_prev.m_next=e.m_next);e.m_next&&(e.m_next.m_prev=e.m_prev);e===this.m_contactList&&(this.m_contactList=e.m_next);e.m_nodeA.prev&&(e.m_nodeA.prev.next=e.m_nodeA.next);e.m_nodeA.next&&(e.m_nodeA.next.prev=e.m_nodeA.prev);e.m_nodeA===d.m_contactList&&(d.m_contactList=e.m_nodeA.next);e.m_nodeB.prev&&(e.m_nodeB.prev.next=e.m_nodeB.next);e.m_nodeB.next&&(e.m_nodeB.next.prev=e.m_nodeB.prev);e.m_nodeB===f.m_contactList&&(f.m_contactList=e.m_nodeB.next);this.m_contactFactory.Destroy(e);--this.m_contactCount};goog.exportSymbol("box2d.b2ContactManager.prototype.Destroy",box2d.b2ContactManager.prototype.Destroy);box2d.b2ContactManager.prototype.Collide=function(){for(var k=this.m_contactList;k;){var j=k.GetFixtureA(),s=k.GetFixtureB(),r=k.GetChildIndexA(),q=k.GetChildIndexB(),n=j.GetBody(),m=s.GetBody();if(k.m_flags&box2d.b2ContactFlag.e_filterFlag){if(!1===m.ShouldCollide(n)){j=k;k=j.m_next;this.Destroy(j);continue}if(this.m_contactFilter&&!1===this.m_contactFilter.ShouldCollide(j,s)){j=k;k=j.m_next;this.Destroy(j);continue}k.m_flags&=~box2d.b2ContactFlag.e_filterFlag}n=n.IsAwake()&&n.m_type!==box2d.b2BodyType.b2_staticBody;m=m.IsAwake()&&m.m_type!==box2d.b2BodyType.b2_staticBody;!1===n&&!1===m?k=k.m_next:!1===this.m_broadPhase.TestOverlap(j.m_proxies[r].proxy,s.m_proxies[q].proxy)?(j=k,k=j.m_next,this.Destroy(j)):(k.Update(this.m_contactListener),k=k.m_next)}};goog.exportSymbol("box2d.b2ContactManager.prototype.Collide",box2d.b2ContactManager.prototype.Collide);box2d.b2ContactManager.prototype.FindNewContacts=function(){this.m_broadPhase.UpdatePairs(this)};goog.exportSymbol("box2d.b2ContactManager.prototype.FindNewContacts",box2d.b2ContactManager.prototype.FindNewContacts);box2d.b2ContactManager.prototype.AddPair=function(E,D){box2d.ENABLE_ASSERTS&&box2d.b2Assert(E instanceof box2d.b2FixtureProxy);box2d.ENABLE_ASSERTS&&box2d.b2Assert(D instanceof box2d.b2FixtureProxy);var C=E.fixture,B=D.fixture,A=E.childIndex,z=D.childIndex,y=C.GetBody(),v=B.GetBody();if(y!==v){for(var s=v.GetContactList();s;){if(s.other===y){var u=s.contact.GetFixtureA(),r=s.contact.GetFixtureB(),q=s.contact.GetChildIndexA(),j=s.contact.GetChildIndexB();if(u===C&&r===B&&q===A&&j===z||u===B&&r===C&&q===z&&j===A){return}}s=s.next}!1===v.ShouldCollide(y)||this.m_contactFilter&&!1===this.m_contactFilter.ShouldCollide(C,B)||(A=this.m_contactFactory.Create(C,A,B,z),null!==A&&(C=A.GetFixtureA(),B=A.GetFixtureB(),A.GetChildIndexA(),A.GetChildIndexB(),y=C.m_body,v=B.m_body,A.m_prev=null,A.m_next=this.m_contactList,null!==this.m_contactList&&(this.m_contactList.m_prev=A),this.m_contactList=A,A.m_nodeA.contact=A,A.m_nodeA.other=v,A.m_nodeA.prev=null,A.m_nodeA.next=y.m_contactList,null!==y.m_contactList&&(y.m_contactList.prev=A.m_nodeA),y.m_contactList=A.m_nodeA,A.m_nodeB.contact=A,A.m_nodeB.other=y,A.m_nodeB.prev=null,A.m_nodeB.next=v.m_contactList,null!==v.m_contactList&&(v.m_contactList.prev=A.m_nodeB),v.m_contactList=A.m_nodeB,!1===C.IsSensor()&&!1===B.IsSensor()&&(y.SetAwake(!0),v.SetAwake(!0)),++this.m_contactCount))}};goog.exportSymbol("box2d.b2ContactManager.prototype.AddPair",box2d.b2ContactManager.prototype.AddPair);box2d.b2EdgeAndCircleContact=function(){box2d.b2Contact.call(this)};goog.inherits(box2d.b2EdgeAndCircleContact,box2d.b2Contact);goog.exportSymbol("box2d.b2EdgeAndCircleContact",box2d.b2EdgeAndCircleContact);box2d.b2EdgeAndCircleContact.Create=function(b){return new box2d.b2EdgeAndCircleContact};goog.exportProperty(box2d.b2EdgeAndCircleContact,"Create",box2d.b2EdgeAndCircleContact.Create);box2d.b2EdgeAndCircleContact.Destroy=function(e,d){};goog.exportProperty(box2d.b2EdgeAndCircleContact,"Destroy",box2d.b2EdgeAndCircleContact.Destroy);box2d.b2EdgeAndCircleContact.prototype.Evaluate=function(g,f,m){var k=this.m_fixtureA.GetShape(),j=this.m_fixtureB.GetShape();box2d.ENABLE_ASSERTS&&box2d.b2Assert(k instanceof box2d.b2EdgeShape);box2d.ENABLE_ASSERTS&&box2d.b2Assert(j instanceof box2d.b2CircleShape);box2d.b2CollideEdgeAndCircle(g,k instanceof box2d.b2EdgeShape?k:null,f,j instanceof box2d.b2CircleShape?j:null,m)};goog.exportProperty(box2d.b2EdgeAndCircleContact.prototype,"Evaluate",box2d.b2EdgeAndCircleContact.prototype.Evaluate);box2d.b2EdgeAndPolygonContact=function(){box2d.b2Contact.call(this)};goog.inherits(box2d.b2EdgeAndPolygonContact,box2d.b2Contact);goog.exportSymbol("box2d.b2EdgeAndPolygonContact",box2d.b2EdgeAndPolygonContact);box2d.b2EdgeAndPolygonContact.Create=function(b){return new box2d.b2EdgeAndPolygonContact};goog.exportProperty(box2d.b2EdgeAndPolygonContact,"Create",box2d.b2EdgeAndPolygonContact.Create);box2d.b2EdgeAndPolygonContact.Destroy=function(e,d){};goog.exportProperty(box2d.b2EdgeAndPolygonContact,"Destroy",box2d.b2EdgeAndPolygonContact.Destroy);box2d.b2EdgeAndPolygonContact.prototype.Evaluate=function(g,f,m){var k=this.m_fixtureA.GetShape(),j=this.m_fixtureB.GetShape();box2d.ENABLE_ASSERTS&&box2d.b2Assert(k instanceof box2d.b2EdgeShape);box2d.ENABLE_ASSERTS&&box2d.b2Assert(j instanceof box2d.b2PolygonShape);box2d.b2CollideEdgeAndPolygon(g,k instanceof box2d.b2EdgeShape?k:null,f,j instanceof box2d.b2PolygonShape?j:null,m)};goog.exportProperty(box2d.b2EdgeAndPolygonContact.prototype,"Evaluate",box2d.b2EdgeAndPolygonContact.prototype.Evaluate);box2d.b2PolygonAndCircleContact=function(){box2d.b2Contact.call(this)};goog.inherits(box2d.b2PolygonAndCircleContact,box2d.b2Contact);goog.exportSymbol("box2d.b2PolygonAndCircleContact",box2d.b2PolygonAndCircleContact);box2d.b2PolygonAndCircleContact.Create=function(b){return new box2d.b2PolygonAndCircleContact};goog.exportProperty(box2d.b2PolygonAndCircleContact,"Create",box2d.b2PolygonAndCircleContact.Create);box2d.b2PolygonAndCircleContact.Destroy=function(e,d){};goog.exportProperty(box2d.b2PolygonAndCircleContact,"Destroy",box2d.b2PolygonAndCircleContact.Destroy);box2d.b2PolygonAndCircleContact.prototype.Evaluate=function(g,f,m){var k=this.m_fixtureA.GetShape(),j=this.m_fixtureB.GetShape();box2d.ENABLE_ASSERTS&&box2d.b2Assert(k instanceof box2d.b2PolygonShape);box2d.ENABLE_ASSERTS&&box2d.b2Assert(j instanceof box2d.b2CircleShape);box2d.b2CollidePolygonAndCircle(g,k instanceof box2d.b2PolygonShape?k:null,f,j instanceof box2d.b2CircleShape?j:null,m)};goog.exportProperty(box2d.b2PolygonAndCircleContact.prototype,"Evaluate",box2d.b2PolygonAndCircleContact.prototype.Evaluate);box2d.b2PolygonContact=function(){box2d.b2Contact.call(this)};goog.inherits(box2d.b2PolygonContact,box2d.b2Contact);goog.exportSymbol("box2d.b2PolygonContact",box2d.b2PolygonContact);box2d.b2PolygonContact.Create=function(b){return new box2d.b2PolygonContact};goog.exportProperty(box2d.b2PolygonContact,"Create",box2d.b2PolygonContact.Create);box2d.b2PolygonContact.Destroy=function(e,d){};goog.exportProperty(box2d.b2PolygonContact,"Destroy",box2d.b2PolygonContact.Destroy);box2d.b2PolygonContact.prototype.Evaluate=function(g,f,m){var k=this.m_fixtureA.GetShape(),j=this.m_fixtureB.GetShape();box2d.ENABLE_ASSERTS&&box2d.b2Assert(k instanceof box2d.b2PolygonShape);box2d.ENABLE_ASSERTS&&box2d.b2Assert(j instanceof box2d.b2PolygonShape);box2d.b2CollidePolygons(g,k instanceof box2d.b2PolygonShape?k:null,f,j instanceof box2d.b2PolygonShape?j:null,m)};goog.exportProperty(box2d.b2PolygonContact.prototype,"Evaluate",box2d.b2PolygonContact.prototype.Evaluate);box2d.g_blockSolve=!0;box2d.b2VelocityConstraintPoint=function(){this.rA=new box2d.b2Vec2;this.rB=new box2d.b2Vec2};goog.exportSymbol("box2d.b2VelocityConstraintPoint",box2d.b2VelocityConstraintPoint);box2d.b2VelocityConstraintPoint.prototype.rA=null;goog.exportProperty(box2d.b2VelocityConstraintPoint.prototype,"rA",box2d.b2VelocityConstraintPoint.prototype.rA);box2d.b2VelocityConstraintPoint.prototype.rB=null;goog.exportProperty(box2d.b2VelocityConstraintPoint.prototype,"rB",box2d.b2VelocityConstraintPoint.prototype.rB);box2d.b2VelocityConstraintPoint.prototype.normalImpulse=0;goog.exportProperty(box2d.b2VelocityConstraintPoint.prototype,"normalImpulse",box2d.b2VelocityConstraintPoint.prototype.normalImpulse);box2d.b2VelocityConstraintPoint.prototype.tangentImpulse=0;goog.exportProperty(box2d.b2VelocityConstraintPoint.prototype,"tangentImpulse",box2d.b2VelocityConstraintPoint.prototype.tangentImpulse);box2d.b2VelocityConstraintPoint.prototype.normalMass=0;goog.exportProperty(box2d.b2VelocityConstraintPoint.prototype,"normalMass",box2d.b2VelocityConstraintPoint.prototype.normalMass);box2d.b2VelocityConstraintPoint.prototype.tangentMass=0;goog.exportProperty(box2d.b2VelocityConstraintPoint.prototype,"tangentMass",box2d.b2VelocityConstraintPoint.prototype.tangentMass);box2d.b2VelocityConstraintPoint.prototype.velocityBias=0;goog.exportProperty(box2d.b2VelocityConstraintPoint.prototype,"velocityBias",box2d.b2VelocityConstraintPoint.prototype.velocityBias);box2d.b2VelocityConstraintPoint.MakeArray=function(b){return box2d.b2MakeArray(b,function(d){return new box2d.b2VelocityConstraintPoint})};goog.exportProperty(box2d.b2VelocityConstraintPoint,"MakeArray",box2d.b2VelocityConstraintPoint.MakeArray);box2d.b2ContactVelocityConstraint=function(){this.points=box2d.b2VelocityConstraintPoint.MakeArray(box2d.b2_maxManifoldPoints);this.normal=new box2d.b2Vec2;this.tangent=new box2d.b2Vec2;this.normalMass=new box2d.b2Mat22;this.K=new box2d.b2Mat22};goog.exportSymbol("box2d.b2ContactVelocityConstraint",box2d.b2ContactVelocityConstraint);box2d.b2ContactVelocityConstraint.prototype.points=null;goog.exportProperty(box2d.b2ContactVelocityConstraint.prototype,"points",box2d.b2ContactVelocityConstraint.prototype.points);box2d.b2ContactVelocityConstraint.prototype.normal=null;goog.exportProperty(box2d.b2ContactVelocityConstraint.prototype,"normal",box2d.b2ContactVelocityConstraint.prototype.normal);box2d.b2ContactVelocityConstraint.prototype.tangent=null;goog.exportProperty(box2d.b2ContactVelocityConstraint.prototype,"tangent",box2d.b2ContactVelocityConstraint.prototype.tangent);box2d.b2ContactVelocityConstraint.prototype.normalMass=null;goog.exportProperty(box2d.b2ContactVelocityConstraint.prototype,"normalMass",box2d.b2ContactVelocityConstraint.prototype.normalMass);box2d.b2ContactVelocityConstraint.prototype.K=null;goog.exportProperty(box2d.b2ContactVelocityConstraint.prototype,"K",box2d.b2ContactVelocityConstraint.prototype.K);box2d.b2ContactVelocityConstraint.prototype.indexA=0;goog.exportProperty(box2d.b2ContactVelocityConstraint.prototype,"indexA",box2d.b2ContactVelocityConstraint.prototype.indexA);box2d.b2ContactVelocityConstraint.prototype.indexB=0;goog.exportProperty(box2d.b2ContactVelocityConstraint.prototype,"indexB",box2d.b2ContactVelocityConstraint.prototype.indexB);box2d.b2ContactVelocityConstraint.prototype.invMassA=0;goog.exportProperty(box2d.b2ContactVelocityConstraint.prototype,"invMassA",box2d.b2ContactVelocityConstraint.prototype.invMassA);box2d.b2ContactVelocityConstraint.prototype.invMassB=0;goog.exportProperty(box2d.b2ContactVelocityConstraint.prototype,"invMassB",box2d.b2ContactVelocityConstraint.prototype.invMassB);box2d.b2ContactVelocityConstraint.prototype.invIA=0;goog.exportProperty(box2d.b2ContactVelocityConstraint.prototype,"invIA",box2d.b2ContactVelocityConstraint.prototype.invIA);box2d.b2ContactVelocityConstraint.prototype.invIB=0;goog.exportProperty(box2d.b2ContactVelocityConstraint.prototype,"invIB",box2d.b2ContactVelocityConstraint.prototype.invIB);box2d.b2ContactVelocityConstraint.prototype.friction=0;goog.exportProperty(box2d.b2ContactVelocityConstraint.prototype,"friction",box2d.b2ContactVelocityConstraint.prototype.friction);box2d.b2ContactVelocityConstraint.prototype.restitution=0;goog.exportProperty(box2d.b2ContactVelocityConstraint.prototype,"restitution",box2d.b2ContactVelocityConstraint.prototype.restitution);box2d.b2ContactVelocityConstraint.prototype.tangentSpeed=0;goog.exportProperty(box2d.b2ContactVelocityConstraint.prototype,"tangentSpeed",box2d.b2ContactVelocityConstraint.prototype.tangentSpeed);box2d.b2ContactVelocityConstraint.prototype.pointCount=0;goog.exportProperty(box2d.b2ContactVelocityConstraint.prototype,"pointCount",box2d.b2ContactVelocityConstraint.prototype.pointCount);box2d.b2ContactVelocityConstraint.prototype.contactIndex=0;goog.exportProperty(box2d.b2ContactVelocityConstraint.prototype,"contactIndex",box2d.b2ContactVelocityConstraint.prototype.contactIndex);box2d.b2ContactVelocityConstraint.MakeArray=function(b){return box2d.b2MakeArray(b,function(d){return new box2d.b2ContactVelocityConstraint})};goog.exportProperty(box2d.b2ContactVelocityConstraint,"MakeArray",box2d.b2ContactVelocityConstraint.MakeArray);box2d.b2ContactPositionConstraint=function(){this.localPoints=box2d.b2Vec2.MakeArray(box2d.b2_maxManifoldPoints);this.localNormal=new box2d.b2Vec2;this.localPoint=new box2d.b2Vec2;this.localCenterA=new box2d.b2Vec2;this.localCenterB=new box2d.b2Vec2};goog.exportSymbol("box2d.b2ContactPositionConstraint",box2d.b2ContactPositionConstraint);box2d.b2ContactPositionConstraint.prototype.localPoints=null;goog.exportProperty(box2d.b2ContactPositionConstraint.prototype,"localPoints",box2d.b2ContactPositionConstraint.prototype.localPoints);box2d.b2ContactPositionConstraint.prototype.localNormal=null;goog.exportProperty(box2d.b2ContactPositionConstraint.prototype,"localNormal",box2d.b2ContactPositionConstraint.prototype.localNormal);box2d.b2ContactPositionConstraint.prototype.localPoint=null;goog.exportProperty(box2d.b2ContactPositionConstraint.prototype,"localPoint",box2d.b2ContactPositionConstraint.prototype.localPoint);box2d.b2ContactPositionConstraint.prototype.indexA=0;goog.exportProperty(box2d.b2ContactPositionConstraint.prototype,"indexA",box2d.b2ContactPositionConstraint.prototype.indexA);box2d.b2ContactPositionConstraint.prototype.indexB=0;goog.exportProperty(box2d.b2ContactPositionConstraint.prototype,"indexB",box2d.b2ContactPositionConstraint.prototype.indexB);box2d.b2ContactPositionConstraint.prototype.invMassA=0;goog.exportProperty(box2d.b2ContactPositionConstraint.prototype,"invMassA",box2d.b2ContactPositionConstraint.prototype.invMassA);box2d.b2ContactPositionConstraint.prototype.invMassB=0;goog.exportProperty(box2d.b2ContactPositionConstraint.prototype,"invMassB",box2d.b2ContactPositionConstraint.prototype.invMassB);box2d.b2ContactPositionConstraint.prototype.localCenterA=null;goog.exportProperty(box2d.b2ContactPositionConstraint.prototype,"localCenterA",box2d.b2ContactPositionConstraint.prototype.localCenterA);box2d.b2ContactPositionConstraint.prototype.localCenterB=null;goog.exportProperty(box2d.b2ContactPositionConstraint.prototype,"localCenterB",box2d.b2ContactPositionConstraint.prototype.localCenterB);box2d.b2ContactPositionConstraint.prototype.invIA=0;goog.exportProperty(box2d.b2ContactPositionConstraint.prototype,"invIA",box2d.b2ContactPositionConstraint.prototype.invIA);box2d.b2ContactPositionConstraint.prototype.invIB=0;goog.exportProperty(box2d.b2ContactPositionConstraint.prototype,"invIB",box2d.b2ContactPositionConstraint.prototype.invIB);box2d.b2ContactPositionConstraint.prototype.type=box2d.b2ManifoldType.e_unknown;goog.exportProperty(box2d.b2ContactPositionConstraint.prototype,"type",box2d.b2ContactPositionConstraint.prototype.type);box2d.b2ContactPositionConstraint.prototype.radiusA=0;goog.exportProperty(box2d.b2ContactPositionConstraint.prototype,"radiusA",box2d.b2ContactPositionConstraint.prototype.radiusA);box2d.b2ContactPositionConstraint.prototype.radiusB=0;goog.exportProperty(box2d.b2ContactPositionConstraint.prototype,"radiusB",box2d.b2ContactPositionConstraint.prototype.radiusB);box2d.b2ContactPositionConstraint.prototype.pointCount=0;goog.exportProperty(box2d.b2ContactPositionConstraint.prototype,"pointCount",box2d.b2ContactPositionConstraint.prototype.pointCount);box2d.b2ContactPositionConstraint.MakeArray=function(b){return box2d.b2MakeArray(b,function(d){return new box2d.b2ContactPositionConstraint})};goog.exportProperty(box2d.b2ContactPositionConstraint,"MakeArray",box2d.b2ContactPositionConstraint.MakeArray);box2d.b2ContactSolverDef=function(){this.step=new box2d.b2TimeStep};goog.exportSymbol("box2d.b2ContactSolverDef",box2d.b2ContactSolverDef);box2d.b2ContactSolverDef.prototype.step=null;goog.exportProperty(box2d.b2ContactSolverDef.prototype,"step",box2d.b2ContactSolverDef.prototype.step);box2d.b2ContactSolverDef.prototype.contacts=null;goog.exportProperty(box2d.b2ContactSolverDef.prototype,"contacts",box2d.b2ContactSolverDef.prototype.contacts);box2d.b2ContactSolverDef.prototype.count=0;goog.exportProperty(box2d.b2ContactSolverDef.prototype,"count",box2d.b2ContactSolverDef.prototype.count);box2d.b2ContactSolverDef.prototype.positions=null;goog.exportProperty(box2d.b2ContactSolverDef.prototype,"positions",box2d.b2ContactSolverDef.prototype.positions);box2d.b2ContactSolverDef.prototype.velocities=null;goog.exportProperty(box2d.b2ContactSolverDef.prototype,"velocities",box2d.b2ContactSolverDef.prototype.velocities);box2d.b2ContactSolverDef.prototype.allocator=null;goog.exportProperty(box2d.b2ContactSolverDef.prototype,"allocator",box2d.b2ContactSolverDef.prototype.allocator);box2d.b2ContactSolver=function(){this.m_step=new box2d.b2TimeStep;this.m_positionConstraints=box2d.b2ContactPositionConstraint.MakeArray(1024);this.m_velocityConstraints=box2d.b2ContactVelocityConstraint.MakeArray(1024)};goog.exportSymbol("box2d.b2ContactSolver",box2d.b2ContactSolver);box2d.b2ContactSolver.prototype.m_step=null;goog.exportProperty(box2d.b2ContactSolver.prototype,"m_step",box2d.b2ContactSolver.prototype.m_step);box2d.b2ContactSolver.prototype.m_positions=null;goog.exportProperty(box2d.b2ContactSolver.prototype,"m_positions",box2d.b2ContactSolver.prototype.m_positions);box2d.b2ContactSolver.prototype.m_velocities=null;goog.exportProperty(box2d.b2ContactSolver.prototype,"m_velocities",box2d.b2ContactSolver.prototype.m_velocities);box2d.b2ContactSolver.prototype.m_allocator=null;goog.exportProperty(box2d.b2ContactSolver.prototype,"m_allocator",box2d.b2ContactSolver.prototype.m_allocator);box2d.b2ContactSolver.prototype.m_positionConstraints=null;goog.exportProperty(box2d.b2ContactSolver.prototype,"m_positionConstraints",box2d.b2ContactSolver.prototype.m_positionConstraints);box2d.b2ContactSolver.prototype.m_velocityConstraints=null;goog.exportProperty(box2d.b2ContactSolver.prototype,"m_velocityConstraints",box2d.b2ContactSolver.prototype.m_velocityConstraints);box2d.b2ContactSolver.prototype.m_contacts=null;goog.exportProperty(box2d.b2ContactSolver.prototype,"m_contacts",box2d.b2ContactSolver.prototype.m_contacts);box2d.b2ContactSolver.prototype.m_count=0;goog.exportProperty(box2d.b2ContactSolver.prototype,"m_count",box2d.b2ContactSolver.prototype.m_count);box2d.b2ContactSolver.prototype.Initialize=function(z){this.m_step.Copy(z.step);this.m_allocator=z.allocator;this.m_count=z.count;if(this.m_positionConstraints.length<this.m_count){var y=box2d.b2Max(2*this.m_positionConstraints.length,this.m_count);for(box2d.DEBUG&&window.console.log("box2d.b2ContactSolver.m_positionConstraints: "+y);this.m_positionConstraints.length<y;){this.m_positionConstraints[this.m_positionConstraints.length]=new box2d.b2ContactPositionConstraint}}if(this.m_velocityConstraints.length<this.m_count){for(y=box2d.b2Max(2*this.m_velocityConstraints.length,this.m_count),box2d.DEBUG&&window.console.log("box2d.b2ContactSolver.m_velocityConstraints: "+y);this.m_velocityConstraints.length<y;){this.m_velocityConstraints[this.m_velocityConstraints.length]=new box2d.b2ContactVelocityConstraint}}this.m_positions=z.positions;this.m_velocities=z.velocities;this.m_contacts=z.contacts;var v,u,s,r,q,n,j,m;z=0;for(y=this.m_count;z<y;++z){for(s=this.m_contacts[z],r=s.m_fixtureA,q=s.m_fixtureB,v=r.GetShape(),u=q.GetShape(),v=v.m_radius,u=u.m_radius,n=r.GetBody(),j=q.GetBody(),q=s.GetManifold(),m=q.pointCount,box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<m),r=this.m_velocityConstraints[z],r.friction=s.m_friction,r.restitution=s.m_restitution,r.tangentSpeed=s.m_tangentSpeed,r.indexA=n.m_islandIndex,r.indexB=j.m_islandIndex,r.invMassA=n.m_invMass,r.invMassB=j.m_invMass,r.invIA=n.m_invI,r.invIB=j.m_invI,r.contactIndex=z,r.pointCount=m,r.K.SetZero(),r.normalMass.SetZero(),s=this.m_positionConstraints[z],s.indexA=n.m_islandIndex,s.indexB=j.m_islandIndex,s.invMassA=n.m_invMass,s.invMassB=j.m_invMass,s.localCenterA.Copy(n.m_sweep.localCenter),s.localCenterB.Copy(j.m_sweep.localCenter),s.invIA=n.m_invI,s.invIB=j.m_invI,s.localNormal.Copy(q.localNormal),s.localPoint.Copy(q.localPoint),s.pointCount=m,s.radiusA=v,s.radiusB=u,s.type=q.type,v=0,u=m;v<u;++v){n=q.points[v],m=r.points[v],this.m_step.warmStarting?(m.normalImpulse=this.m_step.dtRatio*n.normalImpulse,m.tangentImpulse=this.m_step.dtRatio*n.tangentImpulse):(m.normalImpulse=0,m.tangentImpulse=0),m.rA.SetZero(),m.rB.SetZero(),m.normalMass=0,m.tangentMass=0,m.velocityBias=0,s.localPoints[v].Copy(n.localPoint)}}return this};goog.exportProperty(box2d.b2ContactSolver.prototype,"Initialize",box2d.b2ContactSolver.prototype.Initialize);box2d.b2ContactSolver.prototype.InitializeVelocityConstraints=function(){var W,V,U,T,S,R,P,O,M,N,L,K,J,I,H,E,F,B,A,D,G=box2d.b2ContactSolver.prototype.InitializeVelocityConstraints.s_xfA,z=box2d.b2ContactSolver.prototype.InitializeVelocityConstraints.s_xfB,j=box2d.b2ContactSolver.prototype.InitializeVelocityConstraints.s_worldManifold;W=0;for(V=this.m_count;W<V;++W){S=this.m_velocityConstraints[W];R=this.m_positionConstraints[W];U=R.radiusA;T=R.radiusB;P=this.m_contacts[S.contactIndex].GetManifold();O=S.indexA;M=S.indexB;N=S.invMassA;L=S.invMassB;K=S.invIA;J=S.invIB;I=R.localCenterA;H=R.localCenterB;R=this.m_positions[O].c;E=this.m_positions[O].a;F=this.m_velocities[O].v;O=this.m_velocities[O].w;B=this.m_positions[M].c;A=this.m_positions[M].a;D=this.m_velocities[M].v;M=this.m_velocities[M].w;box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<P.pointCount);G.q.SetAngleRadians(E);z.q.SetAngleRadians(A);box2d.b2SubVV(R,box2d.b2MulRV(G.q,I,box2d.b2Vec2.s_t0),G.p);box2d.b2SubVV(B,box2d.b2MulRV(z.q,H,box2d.b2Vec2.s_t0),z.p);j.Initialize(P,G,U,z,T);S.normal.Copy(j.normal);box2d.b2CrossVOne(S.normal,S.tangent);T=S.pointCount;for(U=0;U<T;++U){P=S.points[U],box2d.b2SubVV(j.points[U],R,P.rA),box2d.b2SubVV(j.points[U],B,P.rB),I=box2d.b2CrossVV(P.rA,S.normal),H=box2d.b2CrossVV(P.rB,S.normal),I=N+L+K*I*I+J*H*H,P.normalMass=0<I?1/I:0,H=S.tangent,I=box2d.b2CrossVV(P.rA,H),H=box2d.b2CrossVV(P.rB,H),I=N+L+K*I*I+J*H*H,P.tangentMass=0<I?1/I:0,P.velocityBias=0,I=box2d.b2DotVV(S.normal,box2d.b2SubVV(box2d.b2AddVCrossSV(D,M,P.rB,box2d.b2Vec2.s_t0),box2d.b2AddVCrossSV(F,O,P.rA,box2d.b2Vec2.s_t1),box2d.b2Vec2.s_t0)),I<-box2d.b2_velocityThreshold&&(P.velocityBias+=-S.restitution*I)}2===S.pointCount&&box2d.g_blockSolve&&(F=S.points[0],B=S.points[1],R=box2d.b2CrossVV(F.rA,S.normal),F=box2d.b2CrossVV(F.rB,S.normal),O=box2d.b2CrossVV(B.rA,S.normal),M=box2d.b2CrossVV(B.rB,S.normal),B=N+L+K*R*R+J*F*F,D=N+L+K*O*O+J*M*M,N=N+L+K*R*O+J*F*M,B*B<1000*(B*D-N*N)?(S.K.ex.SetXY(B,N),S.K.ey.SetXY(N,D),S.K.GetInverse(S.normalMass)):S.pointCount=1)}};goog.exportProperty(box2d.b2ContactSolver.prototype,"InitializeVelocityConstraints",box2d.b2ContactSolver.prototype.InitializeVelocityConstraints);box2d.b2ContactSolver.prototype.InitializeVelocityConstraints.s_xfA=new box2d.b2Transform;box2d.b2ContactSolver.prototype.InitializeVelocityConstraints.s_xfB=new box2d.b2Transform;box2d.b2ContactSolver.prototype.InitializeVelocityConstraints.s_worldManifold=new box2d.b2WorldManifold;box2d.b2ContactSolver.prototype.WarmStart=function(){var O,N,M,L,K,J,I,H,F,G,E,D,C,B,A,y,z,u,j=box2d.b2ContactSolver.prototype.WarmStart.s_P;O=0;for(N=this.m_count;O<N;++O){K=this.m_velocityConstraints[O];J=K.indexA;I=K.indexB;H=K.invMassA;F=K.invIA;G=K.invMassB;E=K.invIB;L=K.pointCount;D=this.m_velocities[J].v;C=this.m_velocities[J].w;B=this.m_velocities[I].v;A=this.m_velocities[I].w;y=K.normal;z=K.tangent;for(M=0;M<L;++M){u=K.points[M],box2d.b2AddVV(box2d.b2MulSV(u.normalImpulse,y,box2d.b2Vec2.s_t0),box2d.b2MulSV(u.tangentImpulse,z,box2d.b2Vec2.s_t1),j),C-=F*box2d.b2CrossVV(u.rA,j),D.SelfMulSub(H,j),A+=E*box2d.b2CrossVV(u.rB,j),B.SelfMulAdd(G,j)}this.m_velocities[J].w=C;this.m_velocities[I].w=A}};goog.exportProperty(box2d.b2ContactSolver.prototype,"WarmStart",box2d.b2ContactSolver.prototype.WarmStart);box2d.b2ContactSolver.prototype.WarmStart.s_P=new box2d.b2Vec2;box2d.b2ContactSolver.prototype.SolveVelocityConstraints=function(){var aq,ap,ao,an,am,al,ak,aj,ah,ai,ag,af,ae,ac,aa,W,Y,S,P,U,Z=box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_dv,N=box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_dv1,L=box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_dv2,ad,ab,V=box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_P,X=box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_a,T=box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_b,j=box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_x,R=box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_d,O=box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_P1,M=box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_P2,K=box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_P1P2;aq=0;for(ap=this.m_count;aq<ap;++aq){am=this.m_velocityConstraints[aq];al=am.indexA;ak=am.indexB;aj=am.invMassA;ah=am.invIA;ai=am.invMassB;ag=am.invIB;af=am.pointCount;ae=this.m_velocities[al].v;ac=this.m_velocities[al].w;aa=this.m_velocities[ak].v;W=this.m_velocities[ak].w;Y=am.normal;S=am.tangent;P=am.friction;box2d.ENABLE_ASSERTS&&box2d.b2Assert(1===af||2===af);ao=0;for(an=af;ao<an;++ao){U=am.points[ao],box2d.b2SubVV(box2d.b2AddVCrossSV(aa,W,U.rB,box2d.b2Vec2.s_t0),box2d.b2AddVCrossSV(ae,ac,U.rA,box2d.b2Vec2.s_t1),Z),ad=box2d.b2DotVV(Z,S)-am.tangentSpeed,ad=U.tangentMass*-ad,ab=P*U.normalImpulse,ab=box2d.b2Clamp(U.tangentImpulse+ad,-ab,ab),ad=ab-U.tangentImpulse,U.tangentImpulse=ab,box2d.b2MulSV(ad,S,V),ae.SelfMulSub(aj,V),ac-=ah*box2d.b2CrossVV(U.rA,V),aa.SelfMulAdd(ai,V),W+=ag*box2d.b2CrossVV(U.rB,V)}if(1===am.pointCount||!1===box2d.g_blockSolve){for(ao=0;ao<af;++ao){U=am.points[ao],box2d.b2SubVV(box2d.b2AddVCrossSV(aa,W,U.rB,box2d.b2Vec2.s_t0),box2d.b2AddVCrossSV(ae,ac,U.rA,box2d.b2Vec2.s_t1),Z),an=box2d.b2DotVV(Z,Y),ad=-U.normalMass*(an-U.velocityBias),ab=box2d.b2Max(U.normalImpulse+ad,0),ad=ab-U.normalImpulse,U.normalImpulse=ab,box2d.b2MulSV(ad,Y,V),ae.SelfMulSub(aj,V),ac-=ah*box2d.b2CrossVV(U.rA,V),aa.SelfMulAdd(ai,V),W+=ag*box2d.b2CrossVV(U.rB,V)}}else{for(af=am.points[0],U=am.points[1],X.SetXY(af.normalImpulse,U.normalImpulse),box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<=X.x&&0<=X.y),box2d.b2SubVV(box2d.b2AddVCrossSV(aa,W,af.rB,box2d.b2Vec2.s_t0),box2d.b2AddVCrossSV(ae,ac,af.rA,box2d.b2Vec2.s_t1),N),box2d.b2SubVV(box2d.b2AddVCrossSV(aa,W,U.rB,box2d.b2Vec2.s_t0),box2d.b2AddVCrossSV(ae,ac,U.rA,box2d.b2Vec2.s_t1),L),ao=box2d.b2DotVV(N,Y),an=box2d.b2DotVV(L,Y),T.x=ao-af.velocityBias,T.y=an-U.velocityBias,T.SelfSub(box2d.b2MulMV(am.K,X,box2d.b2Vec2.s_t0));;){box2d.b2MulMV(am.normalMass,T,j).SelfNeg();if(0<=j.x&&0<=j.y){box2d.b2SubVV(j,X,R);box2d.b2MulSV(R.x,Y,O);box2d.b2MulSV(R.y,Y,M);box2d.b2AddVV(O,M,K);ae.SelfMulSub(aj,K);ac-=ah*(box2d.b2CrossVV(af.rA,O)+box2d.b2CrossVV(U.rA,M));aa.SelfMulAdd(ai,K);W+=ag*(box2d.b2CrossVV(af.rB,O)+box2d.b2CrossVV(U.rB,M));af.normalImpulse=j.x;U.normalImpulse=j.y;break}j.x=-af.normalMass*T.x;j.y=0;an=am.K.ex.y*j.x+T.y;if(0<=j.x&&0<=an){box2d.b2SubVV(j,X,R);box2d.b2MulSV(R.x,Y,O);box2d.b2MulSV(R.y,Y,M);box2d.b2AddVV(O,M,K);ae.SelfMulSub(aj,K);ac-=ah*(box2d.b2CrossVV(af.rA,O)+box2d.b2CrossVV(U.rA,M));aa.SelfMulAdd(ai,K);W+=ag*(box2d.b2CrossVV(af.rB,O)+box2d.b2CrossVV(U.rB,M));af.normalImpulse=j.x;U.normalImpulse=j.y;break}j.x=0;j.y=-U.normalMass*T.y;ao=am.K.ey.x*j.y+T.x;if(0<=j.y&&0<=ao){box2d.b2SubVV(j,X,R);box2d.b2MulSV(R.x,Y,O);box2d.b2MulSV(R.y,Y,M);box2d.b2AddVV(O,M,K);ae.SelfMulSub(aj,K);ac-=ah*(box2d.b2CrossVV(af.rA,O)+box2d.b2CrossVV(U.rA,M));aa.SelfMulAdd(ai,K);W+=ag*(box2d.b2CrossVV(af.rB,O)+box2d.b2CrossVV(U.rB,M));af.normalImpulse=j.x;U.normalImpulse=j.y;break}j.x=0;j.y=0;ao=T.x;an=T.y;if(0<=ao&&0<=an){box2d.b2SubVV(j,X,R);box2d.b2MulSV(R.x,Y,O);box2d.b2MulSV(R.y,Y,M);box2d.b2AddVV(O,M,K);ae.SelfMulSub(aj,K);ac-=ah*(box2d.b2CrossVV(af.rA,O)+box2d.b2CrossVV(U.rA,M));aa.SelfMulAdd(ai,K);W+=ag*(box2d.b2CrossVV(af.rB,O)+box2d.b2CrossVV(U.rB,M));af.normalImpulse=j.x;U.normalImpulse=j.y;break}break}}this.m_velocities[al].w=ac;this.m_velocities[ak].w=W}};goog.exportProperty(box2d.b2ContactSolver.prototype,"SolveVelocityConstraints",box2d.b2ContactSolver.prototype.SolveVelocityConstraints);box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_dv=new box2d.b2Vec2;box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_dv1=new box2d.b2Vec2;box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_dv2=new box2d.b2Vec2;box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_P=new box2d.b2Vec2;box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_a=new box2d.b2Vec2;box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_b=new box2d.b2Vec2;box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_x=new box2d.b2Vec2;box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_d=new box2d.b2Vec2;box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_P1=new box2d.b2Vec2;box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_P2=new box2d.b2Vec2;box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_P1P2=new box2d.b2Vec2;box2d.b2ContactSolver.prototype.StoreImpulses=function(){var j,g,q,n,m,k;j=0;for(g=this.m_count;j<g;++j){for(m=this.m_velocityConstraints[j],k=this.m_contacts[m.contactIndex].GetManifold(),q=0,n=m.pointCount;q<n;++q){k.points[q].normalImpulse=m.points[q].normalImpulse,k.points[q].tangentImpulse=m.points[q].tangentImpulse}}};goog.exportProperty(box2d.b2ContactSolver.prototype,"StoreImpulses",box2d.b2ContactSolver.prototype.StoreImpulses);box2d.b2PositionSolverManifold=function(){this.normal=new box2d.b2Vec2;this.point=new box2d.b2Vec2};goog.exportSymbol("box2d.b2PositionSolverManifold",box2d.b2PositionSolverManifold);box2d.b2PositionSolverManifold.prototype.normal=null;goog.exportProperty(box2d.b2PositionSolverManifold.prototype,"normal",box2d.b2PositionSolverManifold.prototype.normal);box2d.b2PositionSolverManifold.prototype.point=null;goog.exportProperty(box2d.b2PositionSolverManifold.prototype,"point",box2d.b2PositionSolverManifold.prototype.point);box2d.b2PositionSolverManifold.prototype.separation=0;goog.exportProperty(box2d.b2PositionSolverManifold.prototype,"separation",box2d.b2PositionSolverManifold.prototype.separation);box2d.b2PositionSolverManifold.prototype.Initialize=function(k,j,u,s){var r=box2d.b2PositionSolverManifold.prototype.Initialize.s_pointA,q=box2d.b2PositionSolverManifold.prototype.Initialize.s_pointB,n=box2d.b2PositionSolverManifold.prototype.Initialize.s_planePoint,m=box2d.b2PositionSolverManifold.prototype.Initialize.s_clipPoint;box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<k.pointCount);switch(k.type){case box2d.b2ManifoldType.e_circles:box2d.b2MulXV(j,k.localPoint,r);box2d.b2MulXV(u,k.localPoints[0],q);box2d.b2SubVV(q,r,this.normal).SelfNormalize();box2d.b2MidVV(r,q,this.point);this.separation=box2d.b2DotVV(box2d.b2SubVV(q,r,box2d.b2Vec2.s_t0),this.normal)-k.radiusA-k.radiusB;break;case box2d.b2ManifoldType.e_faceA:box2d.b2MulRV(j.q,k.localNormal,this.normal);box2d.b2MulXV(j,k.localPoint,n);box2d.b2MulXV(u,k.localPoints[s],m);this.separation=box2d.b2DotVV(box2d.b2SubVV(m,n,box2d.b2Vec2.s_t0),this.normal)-k.radiusA-k.radiusB;this.point.Copy(m);break;case box2d.b2ManifoldType.e_faceB:box2d.b2MulRV(u.q,k.localNormal,this.normal),box2d.b2MulXV(u,k.localPoint,n),box2d.b2MulXV(j,k.localPoints[s],m),this.separation=box2d.b2DotVV(box2d.b2SubVV(m,n,box2d.b2Vec2.s_t0),this.normal)-k.radiusA-k.radiusB,this.point.Copy(m),this.normal.SelfNeg()}};goog.exportProperty(box2d.b2PositionSolverManifold.prototype,"Initialize",box2d.b2PositionSolverManifold.prototype.Initialize);box2d.b2PositionSolverManifold.prototype.Initialize.s_pointA=new box2d.b2Vec2;box2d.b2PositionSolverManifold.prototype.Initialize.s_pointB=new box2d.b2Vec2;box2d.b2PositionSolverManifold.prototype.Initialize.s_planePoint=new box2d.b2Vec2;box2d.b2PositionSolverManifold.prototype.Initialize.s_clipPoint=new box2d.b2Vec2;box2d.b2ContactSolver.prototype.SolvePositionConstraints=function(){var ag,af,ae,ad,ac,ab,aa,Z,X,Y,W,V,U,S,P,L,N,H=box2d.b2ContactSolver.prototype.SolvePositionConstraints.s_xfA,G=box2d.b2ContactSolver.prototype.SolvePositionConstraints.s_xfB,J=box2d.b2ContactSolver.prototype.SolvePositionConstraints.s_psm,O,z,j,T=box2d.b2ContactSolver.prototype.SolvePositionConstraints.s_rA,R=box2d.b2ContactSolver.prototype.SolvePositionConstraints.s_rB,K,M=box2d.b2ContactSolver.prototype.SolvePositionConstraints.s_P,I=0;ag=0;for(af=this.m_count;ag<af;++ag){ac=this.m_positionConstraints[ag];ab=ac.indexA;aa=ac.indexB;Z=ac.localCenterA;X=ac.invMassA;Y=ac.invIA;W=ac.localCenterB;V=ac.invMassB;U=ac.invIB;ad=ac.pointCount;S=this.m_positions[ab].c;P=this.m_positions[ab].a;L=this.m_positions[aa].c;N=this.m_positions[aa].a;for(ae=0;ae<ad;++ae){H.q.SetAngleRadians(P),G.q.SetAngleRadians(N),box2d.b2SubVV(S,box2d.b2MulRV(H.q,Z,box2d.b2Vec2.s_t0),H.p),box2d.b2SubVV(L,box2d.b2MulRV(G.q,W,box2d.b2Vec2.s_t0),G.p),J.Initialize(ac,H,G,ae),O=J.normal,z=J.point,j=J.separation,box2d.b2SubVV(z,S,T),box2d.b2SubVV(z,L,R),I=box2d.b2Min(I,j),z=box2d.b2Clamp(box2d.b2_baumgarte*(j+box2d.b2_linearSlop),-box2d.b2_maxLinearCorrection,0),j=box2d.b2CrossVV(T,O),K=box2d.b2CrossVV(R,O),j=X+V+Y*j*j+U*K*K,z=0<j?-z/j:0,box2d.b2MulSV(z,O,M),S.SelfMulSub(X,M),P-=Y*box2d.b2CrossVV(T,M),L.SelfMulAdd(V,M),N+=U*box2d.b2CrossVV(R,M)}this.m_positions[ab].a=P;this.m_positions[aa].a=N}return I>-3*box2d.b2_linearSlop};goog.exportProperty(box2d.b2ContactSolver.prototype,"SolvePositionConstraints",box2d.b2ContactSolver.prototype.SolvePositionConstraints);box2d.b2ContactSolver.prototype.SolvePositionConstraints.s_xfA=new box2d.b2Transform;box2d.b2ContactSolver.prototype.SolvePositionConstraints.s_xfB=new box2d.b2Transform;box2d.b2ContactSolver.prototype.SolvePositionConstraints.s_psm=new box2d.b2PositionSolverManifold;box2d.b2ContactSolver.prototype.SolvePositionConstraints.s_rA=new box2d.b2Vec2;box2d.b2ContactSolver.prototype.SolvePositionConstraints.s_rB=new box2d.b2Vec2;box2d.b2ContactSolver.prototype.SolvePositionConstraints.s_P=new box2d.b2Vec2;box2d.b2ContactSolver.prototype.SolveTOIPositionConstraints=function(ak,aj){var ai,ah,ag,af,ae,ad,ab,ac,aa,Z,Y,W,U,P,S,L,J,N=box2d.b2ContactSolver.prototype.SolveTOIPositionConstraints.s_xfA,T=box2d.b2ContactSolver.prototype.SolveTOIPositionConstraints.s_xfB,I=box2d.b2ContactSolver.prototype.SolveTOIPositionConstraints.s_psm,H,X,V,O=box2d.b2ContactSolver.prototype.SolveTOIPositionConstraints.s_rA,R=box2d.b2ContactSolver.prototype.SolveTOIPositionConstraints.s_rB,M,j=box2d.b2ContactSolver.prototype.SolveTOIPositionConstraints.s_P,K=0;ai=0;for(ah=this.m_count;ai<ah;++ai){ae=this.m_positionConstraints[ai];ad=ae.indexA;ab=ae.indexB;ac=ae.localCenterA;aa=ae.localCenterB;af=ae.pointCount;Y=Z=0;if(ad===ak||ad===aj){Z=ae.invMassA,Y=ae.invIA}U=W=0;if(ab===ak||ab===aj){W=ae.invMassB,U=ae.invIB}P=this.m_positions[ad].c;S=this.m_positions[ad].a;L=this.m_positions[ab].c;J=this.m_positions[ab].a;for(ag=0;ag<af;++ag){N.q.SetAngleRadians(S),T.q.SetAngleRadians(J),box2d.b2SubVV(P,box2d.b2MulRV(N.q,ac,box2d.b2Vec2.s_t0),N.p),box2d.b2SubVV(L,box2d.b2MulRV(T.q,aa,box2d.b2Vec2.s_t0),T.p),I.Initialize(ae,N,T,ag),H=I.normal,X=I.point,V=I.separation,box2d.b2SubVV(X,P,O),box2d.b2SubVV(X,L,R),K=box2d.b2Min(K,V),X=box2d.b2Clamp(box2d.b2_toiBaumgarte*(V+box2d.b2_linearSlop),-box2d.b2_maxLinearCorrection,0),V=box2d.b2CrossVV(O,H),M=box2d.b2CrossVV(R,H),V=Z+W+Y*V*V+U*M*M,X=0<V?-X/V:0,box2d.b2MulSV(X,H,j),P.SelfMulSub(Z,j),S-=Y*box2d.b2CrossVV(O,j),L.SelfMulAdd(W,j),J+=U*box2d.b2CrossVV(R,j)}this.m_positions[ad].a=S;this.m_positions[ab].a=J}return K>=-1.5*box2d.b2_linearSlop};goog.exportProperty(box2d.b2ContactSolver.prototype,"SolveTOIPositionConstraints",box2d.b2ContactSolver.prototype.SolveTOIPositionConstraints);box2d.b2ContactSolver.prototype.SolveTOIPositionConstraints.s_xfA=new box2d.b2Transform;box2d.b2ContactSolver.prototype.SolveTOIPositionConstraints.s_xfB=new box2d.b2Transform;box2d.b2ContactSolver.prototype.SolveTOIPositionConstraints.s_psm=new box2d.b2PositionSolverManifold;box2d.b2ContactSolver.prototype.SolveTOIPositionConstraints.s_rA=new box2d.b2Vec2;box2d.b2ContactSolver.prototype.SolveTOIPositionConstraints.s_rB=new box2d.b2Vec2;box2d.b2ContactSolver.prototype.SolveTOIPositionConstraints.s_P=new box2d.b2Vec2;box2d.b2Island=function(){this.m_bodies=Array(1024);this.m_contacts=Array(1024);this.m_joints=Array(1024);this.m_positions=box2d.b2Position.MakeArray(1024);this.m_velocities=box2d.b2Velocity.MakeArray(1024)};goog.exportSymbol("box2d.b2Island",box2d.b2Island);box2d.b2Island.prototype.m_allocator=null;goog.exportProperty(box2d.b2Island.prototype,"m_allocator",box2d.b2Island.prototype.m_allocator);box2d.b2Island.prototype.m_listener=null;goog.exportProperty(box2d.b2Island.prototype,"m_listener",box2d.b2Island.prototype.m_listener);box2d.b2Island.prototype.m_bodies=null;goog.exportProperty(box2d.b2Island.prototype,"m_bodies",box2d.b2Island.prototype.m_bodies);box2d.b2Island.prototype.m_contacts=null;goog.exportProperty(box2d.b2Island.prototype,"m_contacts",box2d.b2Island.prototype.m_contacts);box2d.b2Island.prototype.m_joints=null;goog.exportProperty(box2d.b2Island.prototype,"m_joints",box2d.b2Island.prototype.m_joints);box2d.b2Island.prototype.m_positions=null;goog.exportProperty(box2d.b2Island.prototype,"m_positions",box2d.b2Island.prototype.m_positions);box2d.b2Island.prototype.m_velocities=null;goog.exportProperty(box2d.b2Island.prototype,"m_velocities",box2d.b2Island.prototype.m_velocities);box2d.b2Island.prototype.m_bodyCount=0;goog.exportProperty(box2d.b2Island.prototype,"m_bodyCount",box2d.b2Island.prototype.m_bodyCount);box2d.b2Island.prototype.m_jointCount=0;goog.exportProperty(box2d.b2Island.prototype,"m_jointCount",box2d.b2Island.prototype.m_jointCount);box2d.b2Island.prototype.m_contactCount=0;goog.exportProperty(box2d.b2Island.prototype,"m_contactCount",box2d.b2Island.prototype.m_contactCount);box2d.b2Island.prototype.m_bodyCapacity=0;goog.exportProperty(box2d.b2Island.prototype,"m_bodyCapacity",box2d.b2Island.prototype.m_bodyCapacity);box2d.b2Island.prototype.m_contactCapacity=0;goog.exportProperty(box2d.b2Island.prototype,"m_contactCapacity",box2d.b2Island.prototype.m_contactCapacity);box2d.b2Island.prototype.m_jointCapacity=0;goog.exportProperty(box2d.b2Island.prototype,"m_jointCapacity",box2d.b2Island.prototype.m_jointCapacity);box2d.b2Island.prototype.Initialize=function(g,f,m,k,j){this.m_bodyCapacity=g;this.m_contactCapacity=f;this.m_jointCapacity=m;this.m_jointCount=this.m_contactCount=this.m_bodyCount=0;this.m_allocator=k;for(this.m_listener=j;this.m_bodies.length<g;){this.m_bodies[this.m_bodies.length]=null}for(;this.m_contacts.length<f;){this.m_contacts[this.m_contacts.length]=null}for(;this.m_joints.length<m;){this.m_joints[this.m_joints.length]=null}if(this.m_positions.length<g){for(f=box2d.b2Max(2*this.m_positions.length,g),box2d.DEBUG&&window.console.log("box2d.b2Island.m_positions: "+f);this.m_positions.length<f;){this.m_positions[this.m_positions.length]=new box2d.b2Position}}if(this.m_velocities.length<g){for(f=box2d.b2Max(2*this.m_velocities.length,g),box2d.DEBUG&&window.console.log("box2d.b2Island.m_velocities: "+f);this.m_velocities.length<f;){this.m_velocities[this.m_velocities.length]=new box2d.b2Velocity}}};goog.exportProperty(box2d.b2Island.prototype,"Initialize",box2d.b2Island.prototype.Initialize);box2d.b2Island.prototype.Clear=function(){this.m_jointCount=this.m_contactCount=this.m_bodyCount=0};goog.exportProperty(box2d.b2Island.prototype,"Clear",box2d.b2Island.prototype.Clear);box2d.b2Island.prototype.AddBody=function(b){box2d.ENABLE_ASSERTS&&box2d.b2Assert(this.m_bodyCount<this.m_bodyCapacity);b.m_islandIndex=this.m_bodyCount;this.m_bodies[this.m_bodyCount++]=b};goog.exportProperty(box2d.b2Island.prototype,"AddBody",box2d.b2Island.prototype.AddBody);box2d.b2Island.prototype.AddContact=function(b){box2d.ENABLE_ASSERTS&&box2d.b2Assert(this.m_contactCount<this.m_contactCapacity);this.m_contacts[this.m_contactCount++]=b};goog.exportProperty(box2d.b2Island.prototype,"AddContact",box2d.b2Island.prototype.AddContact);box2d.b2Island.prototype.AddJoint=function(b){box2d.ENABLE_ASSERTS&&box2d.b2Assert(this.m_jointCount<this.m_jointCapacity);this.m_joints[this.m_jointCount++]=b};goog.exportProperty(box2d.b2Island.prototype,"AddJoint",box2d.b2Island.prototype.AddJoint);box2d.b2Island.prototype.Solve=function(E,D,C,B){for(var A=box2d.b2Island.s_timer.Reset(),z=D.dt,y=0;y<this.m_bodyCount;++y){var v=this.m_bodies[y],s=this.m_positions[y].c.Copy(v.m_sweep.c),u=v.m_sweep.a,r=this.m_velocities[y].v.Copy(v.m_linearVelocity),q=v.m_angularVelocity;v.m_sweep.c0.Copy(v.m_sweep.c);v.m_sweep.a0=v.m_sweep.a;v.m_type===box2d.b2BodyType.b2_dynamicBody&&(r.x+=z*(v.m_gravityScale*C.x+v.m_invMass*v.m_force.x),r.y+=z*(v.m_gravityScale*C.y+v.m_invMass*v.m_force.y),q+=z*v.m_invI*v.m_torque,r.SelfMul(1/(1+z*v.m_linearDamping)),q*=1/(1+z*v.m_angularDamping));this.m_positions[y].a=u;this.m_velocities[y].w=q}A.Reset();v=box2d.b2Island.s_solverData;v.step.Copy(D);v.positions=this.m_positions;v.velocities=this.m_velocities;y=box2d.b2Island.s_contactSolverDef;y.step.Copy(D);y.contacts=this.m_contacts;y.count=this.m_contactCount;y.positions=this.m_positions;y.velocities=this.m_velocities;y.allocator=this.m_allocator;C=box2d.b2Island.s_contactSolver.Initialize(y);C.InitializeVelocityConstraints();D.warmStarting&&C.WarmStart();for(y=0;y<this.m_jointCount;++y){this.m_joints[y].InitVelocityConstraints(v)}E.solveInit=A.GetMilliseconds();A.Reset();for(y=0;y<D.velocityIterations;++y){for(u=0;u<this.m_jointCount;++u){this.m_joints[u].SolveVelocityConstraints(v)}C.SolveVelocityConstraints()}C.StoreImpulses();E.solveVelocity=A.GetMilliseconds();for(y=0;y<this.m_bodyCount;++y){var s=this.m_positions[y].c,u=this.m_positions[y].a,r=this.m_velocities[y].v,q=this.m_velocities[y].w,j=box2d.b2MulSV(z,r,box2d.b2Island.s_translation);box2d.b2DotVV(j,j)>box2d.b2_maxTranslationSquared&&(j=box2d.b2_maxTranslation/j.GetLength(),r.SelfMul(j));j=z*q;j*j>box2d.b2_maxRotationSquared&&(j=box2d.b2_maxRotation/box2d.b2Abs(j),q*=j);s.x+=z*r.x;s.y+=z*r.y;u+=z*q;this.m_positions[y].a=u;this.m_velocities[y].w=q}A.Reset();s=!1;for(y=0;y<D.positionIterations;++y){r=C.SolvePositionConstraints();q=!0;for(u=0;u<this.m_jointCount;++u){j=this.m_joints[u].SolvePositionConstraints(v),q=q&&j}if(r&&q){s=!0;break}}for(y=0;y<this.m_bodyCount;++y){D=this.m_bodies[y],D.m_sweep.c.Copy(this.m_positions[y].c),D.m_sweep.a=this.m_positions[y].a,D.m_linearVelocity.Copy(this.m_velocities[y].v),D.m_angularVelocity=this.m_velocities[y].w,D.SynchronizeTransform()}E.solvePosition=A.GetMilliseconds();this.Report(C.m_velocityConstraints);if(B){E=box2d.b2_maxFloat;B=box2d.b2_linearSleepTolerance*box2d.b2_linearSleepTolerance;A=box2d.b2_angularSleepTolerance*box2d.b2_angularSleepTolerance;for(y=0;y<this.m_bodyCount;++y){v=this.m_bodies[y],v.GetType()!==box2d.b2BodyType.b2_staticBody&&(0===(v.m_flags&box2d.b2BodyFlag.e_autoSleepFlag)||v.m_angularVelocity*v.m_angularVelocity>A||box2d.b2DotVV(v.m_linearVelocity,v.m_linearVelocity)>B?E=v.m_sleepTime=0:(v.m_sleepTime+=z,E=box2d.b2Min(E,v.m_sleepTime)))}if(E>=box2d.b2_timeToSleep&&s){for(y=0;y<this.m_bodyCount;++y){v=this.m_bodies[y],v.SetAwake(!1)}}}};goog.exportProperty(box2d.b2Island.prototype,"Solve",box2d.b2Island.prototype.Solve);box2d.b2Island.prototype.SolveTOI=function(k,j,u){box2d.ENABLE_ASSERTS&&box2d.b2Assert(j<this.m_bodyCount);box2d.ENABLE_ASSERTS&&box2d.b2Assert(u<this.m_bodyCount);for(var s=0;s<this.m_bodyCount;++s){var r=this.m_bodies[s];this.m_positions[s].c.Copy(r.m_sweep.c);this.m_positions[s].a=r.m_sweep.a;this.m_velocities[s].v.Copy(r.m_linearVelocity);this.m_velocities[s].w=r.m_angularVelocity}s=box2d.b2Island.s_contactSolverDef;s.contacts=this.m_contacts;s.count=this.m_contactCount;s.allocator=this.m_allocator;s.step.Copy(k);s.positions=this.m_positions;s.velocities=this.m_velocities;r=box2d.b2Island.s_contactSolver.Initialize(s);for(s=0;s<k.positionIterations&&!r.SolveTOIPositionConstraints(j,u);++s){}this.m_bodies[j].m_sweep.c0.Copy(this.m_positions[j].c);this.m_bodies[j].m_sweep.a0=this.m_positions[j].a;this.m_bodies[u].m_sweep.c0.Copy(this.m_positions[u].c);this.m_bodies[u].m_sweep.a0=this.m_positions[u].a;r.InitializeVelocityConstraints();for(s=0;s<k.velocityIterations;++s){r.SolveVelocityConstraints()}k=k.dt;for(s=0;s<this.m_bodyCount;++s){j=this.m_positions[s].c;u=this.m_positions[s].a;var q=this.m_velocities[s].v,n=this.m_velocities[s].w,m=box2d.b2MulSV(k,q,box2d.b2Island.s_translation);box2d.b2DotVV(m,m)>box2d.b2_maxTranslationSquared&&(m=box2d.b2_maxTranslation/m.GetLength(),q.SelfMul(m));m=k*n;m*m>box2d.b2_maxRotationSquared&&(m=box2d.b2_maxRotation/box2d.b2Abs(m),n*=m);j.SelfMulAdd(k,q);u+=k*n;this.m_positions[s].a=u;this.m_velocities[s].w=n;m=this.m_bodies[s];m.m_sweep.c.Copy(j);m.m_sweep.a=u;m.m_linearVelocity.Copy(q);m.m_angularVelocity=n;m.SynchronizeTransform()}this.Report(r.m_velocityConstraints)};goog.exportProperty(box2d.b2Island.prototype,"SolveTOI",box2d.b2Island.prototype.SolveTOI);box2d.b2Island.prototype.Report=function(j){if(null!==this.m_listener){for(var g=0;g<this.m_contactCount;++g){var q=this.m_contacts[g];if(q){var n=j[g],m=box2d.b2Island.s_impulse;m.count=n.pointCount;for(var k=0;k<n.pointCount;++k){m.normalImpulses[k]=n.points[k].normalImpulse,m.tangentImpulses[k]=n.points[k].tangentImpulse}this.m_listener.PostSolve(q,m)}}}};goog.exportProperty(box2d.b2Island.prototype,"Report",box2d.b2Island.prototype.Report);box2d.b2Island.s_timer=new box2d.b2Timer;box2d.b2Island.s_solverData=new box2d.b2SolverData;box2d.b2Island.s_contactSolverDef=new box2d.b2ContactSolverDef;box2d.b2Island.s_contactSolver=new box2d.b2ContactSolver;box2d.b2Island.s_translation=new box2d.b2Vec2;box2d.b2Island.s_impulse=new box2d.b2ContactImpulse;box2d.b2JointType={e_unknownJoint:0,e_revoluteJoint:1,e_prismaticJoint:2,e_distanceJoint:3,e_pulleyJoint:4,e_mouseJoint:5,e_gearJoint:6,e_wheelJoint:7,e_weldJoint:8,e_frictionJoint:9,e_ropeJoint:10,e_motorJoint:11,e_areaJoint:12};goog.exportSymbol("box2d.b2JointType",box2d.b2JointType);goog.exportProperty(box2d.b2JointType,"e_unknownJoint",box2d.b2JointType.e_unknownJoint);goog.exportProperty(box2d.b2JointType,"e_revoluteJoint",box2d.b2JointType.e_revoluteJoint);goog.exportProperty(box2d.b2JointType,"e_prismaticJoint",box2d.b2JointType.e_prismaticJoint);goog.exportProperty(box2d.b2JointType,"e_distanceJoint",box2d.b2JointType.e_distanceJoint);goog.exportProperty(box2d.b2JointType,"e_pulleyJoint",box2d.b2JointType.e_pulleyJoint);goog.exportProperty(box2d.b2JointType,"e_mouseJoint",box2d.b2JointType.e_mouseJoint);goog.exportProperty(box2d.b2JointType,"e_gearJoint",box2d.b2JointType.e_gearJoint);goog.exportProperty(box2d.b2JointType,"e_wheelJoint",box2d.b2JointType.e_wheelJoint);goog.exportProperty(box2d.b2JointType,"e_weldJoint",box2d.b2JointType.e_weldJoint);goog.exportProperty(box2d.b2JointType,"e_frictionJoint",box2d.b2JointType.e_frictionJoint);goog.exportProperty(box2d.b2JointType,"e_ropeJoint",box2d.b2JointType.e_ropeJoint);goog.exportProperty(box2d.b2JointType,"e_motorJoint",box2d.b2JointType.e_motorJoint);goog.exportProperty(box2d.b2JointType,"e_areaJoint",box2d.b2JointType.e_areaJoint);box2d.b2LimitState={e_inactiveLimit:0,e_atLowerLimit:1,e_atUpperLimit:2,e_equalLimits:3};goog.exportSymbol("box2d.b2LimitState",box2d.b2LimitState);goog.exportProperty(box2d.b2LimitState,"e_inactiveLimit",box2d.b2LimitState.e_inactiveLimit);goog.exportProperty(box2d.b2LimitState,"e_atLowerLimit",box2d.b2LimitState.e_atLowerLimit);goog.exportProperty(box2d.b2LimitState,"e_atUpperLimit",box2d.b2LimitState.e_atUpperLimit);goog.exportProperty(box2d.b2LimitState,"e_equalLimits",box2d.b2LimitState.e_equalLimits);box2d.b2Jacobian=function(){this.linear=new box2d.b2Vec2};goog.exportSymbol("box2d.b2Jacobian",box2d.b2Jacobian);box2d.b2Jacobian.prototype.linear=null;goog.exportProperty(box2d.b2Jacobian.prototype,"linear",box2d.b2Jacobian.prototype.linear);box2d.b2Jacobian.prototype.angularA=0;goog.exportProperty(box2d.b2Jacobian.prototype,"angularA",box2d.b2Jacobian.prototype.angularA);box2d.b2Jacobian.prototype.angularB=0;goog.exportProperty(box2d.b2Jacobian.prototype,"angularB",box2d.b2Jacobian.prototype.angularB);box2d.b2Jacobian.prototype.SetZero=function(){this.linear.SetZero();this.angularB=this.angularA=0;return this};goog.exportProperty(box2d.b2Jacobian.prototype,"SetZero",box2d.b2Jacobian.prototype.SetZero);box2d.b2Jacobian.prototype.Set=function(e,d,f){this.linear.Copy(e);this.angularA=d;this.angularB=f;return this};goog.exportProperty(box2d.b2Jacobian.prototype,"Set",box2d.b2Jacobian.prototype.Set);box2d.b2JointEdge=function(){};goog.exportSymbol("box2d.b2JointEdge",box2d.b2JointEdge);box2d.b2JointEdge.prototype.other=null;goog.exportProperty(box2d.b2JointEdge.prototype,"other",box2d.b2JointEdge.prototype.other);box2d.b2JointEdge.prototype.joint=null;goog.exportProperty(box2d.b2JointEdge.prototype,"joint",box2d.b2JointEdge.prototype.joint);box2d.b2JointEdge.prototype.prev=null;goog.exportProperty(box2d.b2JointEdge.prototype,"prev",box2d.b2JointEdge.prototype.prev);box2d.b2JointEdge.prototype.next=null;goog.exportProperty(box2d.b2JointEdge.prototype,"next",box2d.b2JointEdge.prototype.next);box2d.b2JointDef=function(b){this.type=b};goog.exportSymbol("box2d.b2JointDef",box2d.b2JointDef);box2d.b2JointDef.prototype.type=box2d.b2JointType.e_unknownJoint;goog.exportProperty(box2d.b2JointDef.prototype,"type",box2d.b2JointDef.prototype.type);box2d.b2JointDef.prototype.userData=null;goog.exportProperty(box2d.b2JointDef.prototype,"userData",box2d.b2JointDef.prototype.userData);box2d.b2JointDef.prototype.bodyA=null;goog.exportProperty(box2d.b2JointDef.prototype,"bodyA",box2d.b2JointDef.prototype.bodyA);box2d.b2JointDef.prototype.bodyB=null;goog.exportProperty(box2d.b2JointDef.prototype,"bodyB",box2d.b2JointDef.prototype.bodyB);box2d.b2JointDef.prototype.collideConnected=!1;goog.exportProperty(box2d.b2JointDef.prototype,"collideConnected",box2d.b2JointDef.prototype.collideConnected);box2d.b2Joint=function(b){box2d.ENABLE_ASSERTS&&box2d.b2Assert(b.bodyA!==b.bodyB);this.m_type=b.type;this.m_edgeA=new box2d.b2JointEdge;this.m_edgeB=new box2d.b2JointEdge;this.m_bodyA=b.bodyA;this.m_bodyB=b.bodyB;this.m_collideConnected=b.collideConnected;this.m_userData=b.userData};goog.exportSymbol("box2d.b2Joint",box2d.b2Joint);box2d.b2Joint.prototype.m_type=box2d.b2JointType.e_unknownJoint;goog.exportProperty(box2d.b2Joint.prototype,"m_type",box2d.b2Joint.prototype.m_type);box2d.b2Joint.prototype.m_prev=null;goog.exportProperty(box2d.b2Joint.prototype,"m_prev",box2d.b2Joint.prototype.m_prev);box2d.b2Joint.prototype.m_next=null;goog.exportProperty(box2d.b2Joint.prototype,"m_next",box2d.b2Joint.prototype.m_next);box2d.b2Joint.prototype.m_edgeA=null;goog.exportProperty(box2d.b2Joint.prototype,"m_edgeA",box2d.b2Joint.prototype.m_edgeA);box2d.b2Joint.prototype.m_edgeB=null;goog.exportProperty(box2d.b2Joint.prototype,"m_edgeB",box2d.b2Joint.prototype.m_edgeB);box2d.b2Joint.prototype.m_bodyA=null;goog.exportProperty(box2d.b2Joint.prototype,"m_bodyA",box2d.b2Joint.prototype.m_bodyA);box2d.b2Joint.prototype.m_bodyB=null;goog.exportProperty(box2d.b2Joint.prototype,"m_bodyB",box2d.b2Joint.prototype.m_bodyB);box2d.b2Joint.prototype.m_index=0;goog.exportProperty(box2d.b2Joint.prototype,"m_index",box2d.b2Joint.prototype.m_index);box2d.b2Joint.prototype.m_islandFlag=!1;goog.exportProperty(box2d.b2Joint.prototype,"m_islandFlag",box2d.b2Joint.prototype.m_islandFlag);box2d.b2Joint.prototype.m_collideConnected=!1;goog.exportProperty(box2d.b2Joint.prototype,"m_collideConnected",box2d.b2Joint.prototype.m_collideConnected);box2d.b2Joint.prototype.m_userData=null;goog.exportProperty(box2d.b2Joint.prototype,"m_userData",box2d.b2Joint.prototype.m_userData);box2d.b2Joint.prototype.GetAnchorA=function(b){return b.SetZero()};goog.exportProperty(box2d.b2Joint.prototype,"GetAnchorA",box2d.b2Joint.prototype.GetAnchorA);box2d.b2Joint.prototype.GetAnchorB=function(b){return b.SetZero()};goog.exportProperty(box2d.b2Joint.prototype,"GetAnchorB",box2d.b2Joint.prototype.GetAnchorB);box2d.b2Joint.prototype.GetReactionForce=function(e,d){return d.SetZero()};goog.exportProperty(box2d.b2Joint.prototype,"GetReactionForce",box2d.b2Joint.prototype.GetReactionForce);box2d.b2Joint.prototype.GetReactionTorque=function(b){return 0};goog.exportProperty(box2d.b2Joint.prototype,"GetReactionTorque",box2d.b2Joint.prototype.GetReactionTorque);box2d.b2Joint.prototype.InitVelocityConstraints=function(b){};goog.exportProperty(box2d.b2Joint.prototype,"InitVelocityConstraints",box2d.b2Joint.prototype.InitVelocityConstraints);box2d.b2Joint.prototype.SolveVelocityConstraints=function(b){};goog.exportProperty(box2d.b2Joint.prototype,"SolveVelocityConstraints",box2d.b2Joint.prototype.SolveVelocityConstraints);box2d.b2Joint.prototype.SolvePositionConstraints=function(b){return !1};goog.exportProperty(box2d.b2Joint.prototype,"SolvePositionConstraints",box2d.b2Joint.prototype.SolvePositionConstraints);box2d.b2Joint.prototype.GetType=function(){return this.m_type};goog.exportProperty(box2d.b2Joint.prototype,"GetType",box2d.b2Joint.prototype.GetType);box2d.b2Joint.prototype.GetBodyA=function(){return this.m_bodyA};goog.exportProperty(box2d.b2Joint.prototype,"GetBodyA",box2d.b2Joint.prototype.GetBodyA);box2d.b2Joint.prototype.GetBodyB=function(){return this.m_bodyB};goog.exportProperty(box2d.b2Joint.prototype,"GetBodyB",box2d.b2Joint.prototype.GetBodyB);box2d.b2Joint.prototype.GetNext=function(){return this.m_next};goog.exportProperty(box2d.b2Joint.prototype,"GetNext",box2d.b2Joint.prototype.GetNext);box2d.b2Joint.prototype.GetUserData=function(){return this.m_userData};goog.exportProperty(box2d.b2Joint.prototype,"GetUserData",box2d.b2Joint.prototype.GetUserData);box2d.b2Joint.prototype.SetUserData=function(b){this.m_userData=b};goog.exportProperty(box2d.b2Joint.prototype,"SetUserData",box2d.b2Joint.prototype.SetUserData);box2d.b2Joint.prototype.GetCollideConnected=function(){return this.m_collideConnected};goog.exportProperty(box2d.b2Joint.prototype,"GetCollideConnected",box2d.b2Joint.prototype.GetCollideConnected);box2d.b2Joint.prototype.Dump=function(){box2d.DEBUG&&box2d.b2Log("// Dump is not supported for this joint type.\n")};goog.exportProperty(box2d.b2Joint.prototype,"Dump",box2d.b2Joint.prototype.Dump);box2d.b2Joint.prototype.IsActive=function(){return this.m_bodyA.IsActive()&&this.m_bodyB.IsActive()};goog.exportProperty(box2d.b2Joint.prototype,"IsActive",box2d.b2Joint.prototype.IsActive);box2d.b2Joint.prototype.ShiftOrigin=function(b){};goog.exportProperty(box2d.b2Joint.prototype,"ShiftOrigin",box2d.b2Joint.prototype.ShiftOrigin);box2d.b2AreaJointDef=function(){box2d.b2JointDef.call(this,box2d.b2JointType.e_areaJoint);this.bodies=[]};goog.inherits(box2d.b2AreaJointDef,box2d.b2JointDef);goog.exportSymbol("box2d.b2AreaJointDef",box2d.b2AreaJointDef);box2d.b2AreaJointDef.prototype.world=null;goog.exportProperty(box2d.b2AreaJointDef.prototype,"world",box2d.b2AreaJointDef.prototype.world);box2d.b2AreaJointDef.prototype.bodies=null;goog.exportProperty(box2d.b2AreaJointDef.prototype,"bodies",box2d.b2AreaJointDef.prototype.bodies);box2d.b2AreaJointDef.prototype.frequencyHz=0;goog.exportProperty(box2d.b2AreaJointDef.prototype,"frequencyHz",box2d.b2AreaJointDef.prototype.frequencyHz);box2d.b2AreaJointDef.prototype.dampingRatio=0;goog.exportProperty(box2d.b2AreaJointDef.prototype,"dampingRatio",box2d.b2AreaJointDef.prototype.dampingRatio);box2d.b2AreaJointDef.prototype.AddBody=function(b){this.bodies.push(b);1===this.bodies.length?this.bodyA=b:2===this.bodies.length&&(this.bodyB=b)};goog.exportProperty(box2d.b2AreaJointDef.prototype,"AddBody",box2d.b2AreaJointDef.prototype.AddBody);box2d.b2AreaJoint=function(k){box2d.b2Joint.call(this,k);box2d.ENABLE_ASSERTS&&box2d.b2Assert(3<=k.bodies.length,"You cannot create an area joint with less than three bodies.");this.m_bodies=k.bodies;this.m_frequencyHz=k.frequencyHz;this.m_dampingRatio=k.dampingRatio;this.m_targetLengths=box2d.b2MakeNumberArray(k.bodies.length);this.m_normals=box2d.b2Vec2.MakeArray(k.bodies.length);this.m_joints=Array(k.bodies.length);this.m_deltas=box2d.b2Vec2.MakeArray(k.bodies.length);this.m_delta=new box2d.b2Vec2;var j=new box2d.b2DistanceJointDef;j.frequencyHz=k.frequencyHz;j.dampingRatio=k.dampingRatio;for(var u=this.m_targetArea=0,s=this.m_bodies.length;u<s;++u){var r=this.m_bodies[u],q=this.m_bodies[(u+1)%s],n=r.GetWorldCenter(),m=q.GetWorldCenter();this.m_targetLengths[u]=box2d.b2DistanceVV(n,m);this.m_targetArea+=box2d.b2CrossVV(n,m);j.Initialize(r,q,n,m);this.m_joints[u]=k.world.CreateJoint(j)}this.m_targetArea*=0.5};goog.inherits(box2d.b2AreaJoint,box2d.b2Joint);goog.exportSymbol("box2d.b2AreaJoint",box2d.b2AreaJoint);box2d.b2AreaJoint.prototype.m_bodies=null;goog.exportProperty(box2d.b2AreaJoint.prototype,"m_bodies",box2d.b2AreaJoint.prototype.m_bodies);box2d.b2AreaJoint.prototype.m_frequencyHz=0;goog.exportProperty(box2d.b2AreaJoint.prototype,"m_frequencyHz",box2d.b2AreaJoint.prototype.m_frequencyHz);box2d.b2AreaJoint.prototype.m_dampingRatio=0;goog.exportProperty(box2d.b2AreaJoint.prototype,"m_dampingRatio",box2d.b2AreaJoint.prototype.m_dampingRatio);box2d.b2AreaJoint.prototype.m_impulse=0;goog.exportProperty(box2d.b2AreaJoint.prototype,"m_impulse",box2d.b2AreaJoint.prototype.m_impulse);box2d.b2AreaJoint.prototype.m_targetLengths=null;box2d.b2AreaJoint.prototype.m_targetArea=0;box2d.b2AreaJoint.prototype.m_normals=null;box2d.b2AreaJoint.prototype.m_joints=null;box2d.b2AreaJoint.prototype.m_deltas=null;box2d.b2AreaJoint.prototype.m_delta=null;box2d.b2AreaJoint.prototype.GetAnchorA=function(b){return b.SetZero()};goog.exportProperty(box2d.b2AreaJoint.prototype,"GetAnchorA",box2d.b2AreaJoint.prototype.GetAnchorA);box2d.b2AreaJoint.prototype.GetAnchorB=function(b){return b.SetZero()};goog.exportProperty(box2d.b2AreaJoint.prototype,"GetAnchorB",box2d.b2AreaJoint.prototype.GetAnchorB);box2d.b2AreaJoint.prototype.GetReactionForce=function(e,d){return d.SetZero()};goog.exportProperty(box2d.b2AreaJoint.prototype,"GetReactionForce",box2d.b2AreaJoint.prototype.GetReactionForce);box2d.b2AreaJoint.prototype.GetReactionTorque=function(b){return 0};goog.exportProperty(box2d.b2AreaJoint.prototype,"GetReactionTorque",box2d.b2AreaJoint.prototype.GetReactionTorque);box2d.b2AreaJoint.prototype.SetFrequency=function(e){this.m_frequencyHz=e;for(var d=0,f=this.m_joints.length;d<f;++d){this.m_joints[d].SetFrequency(e)}};goog.exportProperty(box2d.b2AreaJoint.prototype,"SetFrequency",box2d.b2AreaJoint.prototype.SetFrequency);box2d.b2AreaJoint.prototype.GetFrequency=function(){return this.m_frequencyHz};goog.exportProperty(box2d.b2AreaJoint.prototype,"GetFrequency",box2d.b2AreaJoint.prototype.GetFrequency);box2d.b2AreaJoint.prototype.SetDampingRatio=function(e){this.m_dampingRatio=e;for(var d=0,f=this.m_joints.length;d<f;++d){this.m_joints[d].SetDampingRatio(e)}};goog.exportProperty(box2d.b2AreaJoint.prototype,"SetDampingRatio",box2d.b2AreaJoint.prototype.SetDampingRatio);box2d.b2AreaJoint.prototype.GetDampingRatio=function(){return this.m_dampingRatio};goog.exportProperty(box2d.b2AreaJoint.prototype,"GetDampingRatio",box2d.b2AreaJoint.prototype.GetDampingRatio);box2d.b2AreaJoint.prototype.Dump=function(){box2d.DEBUG&&box2d.b2Log("Area joint dumping is not supported.\n")};goog.exportProperty(box2d.b2AreaJoint.prototype,"Dump",box2d.b2AreaJoint.prototype.Dump);box2d.b2AreaJoint.prototype.InitVelocityConstraints=function(j){for(var g=0,q=this.m_bodies.length;g<q;++g){var n=this.m_deltas[g];box2d.b2SubVV(j.positions[this.m_bodies[(g+1)%q].m_islandIndex].c,j.positions[this.m_bodies[(g+q-1)%q].m_islandIndex].c,n)}if(j.step.warmStarting){for(this.m_impulse*=j.step.dtRatio,g=0,q=this.m_bodies.length;g<q;++g){var m=this.m_bodies[g],k=j.velocities[m.m_islandIndex].v,n=this.m_deltas[g];k.x+=m.m_invMass*n.y*0.5*this.m_impulse;k.y+=m.m_invMass*-n.x*0.5*this.m_impulse}}else{this.m_impulse=0}};goog.exportProperty(box2d.b2AreaJoint.prototype,"InitVelocityConstraints",box2d.b2AreaJoint.prototype.InitVelocityConstraints);box2d.b2AreaJoint.prototype.SolveVelocityConstraints=function(k){for(var j=0,u=0,s=0,r=this.m_bodies.length;s<r;++s){var q=this.m_bodies[s],n=k.velocities[q.m_islandIndex].v,m=this.m_deltas[s],j=j+m.GetLengthSquared()/q.GetMass(),u=u+box2d.b2CrossVV(n,m)}j=-2*u/j;this.m_impulse+=j;s=0;for(r=this.m_bodies.length;s<r;++s){q=this.m_bodies[s],n=k.velocities[q.m_islandIndex].v,m=this.m_deltas[s],n.x+=q.m_invMass*m.y*0.5*j,n.y+=q.m_invMass*-m.x*0.5*j}};goog.exportProperty(box2d.b2AreaJoint.prototype,"SolveVelocityConstraints",box2d.b2AreaJoint.prototype.SolveVelocityConstraints);box2d.b2AreaJoint.prototype.SolvePositionConstraints=function(v){for(var u=0,s=0,r=0,q=this.m_bodies.length;r<q;++r){var n=this.m_bodies[r],n=v.positions[n.m_islandIndex].c,m=v.positions[this.m_bodies[(r+1)%q].m_islandIndex].c,k=box2d.b2SubVV(m,n,this.m_delta),j=k.GetLength();j<box2d.b2_epsilon&&(j=1);this.m_normals[r].x=k.y/j;this.m_normals[r].y=-k.x/j;u+=j;s+=box2d.b2CrossVV(n,m)}u=0.5*(this.m_targetArea-0.5*s)/u;s=!0;r=0;for(q=this.m_bodies.length;r<q;++r){n=this.m_bodies[r],n=v.positions[n.m_islandIndex].c,k=box2d.b2AddVV(this.m_normals[r],this.m_normals[(r+1)%q],this.m_delta),k.SelfMul(u),m=k.GetLengthSquared(),m>box2d.b2Sq(box2d.b2_maxLinearCorrection)&&k.SelfMul(box2d.b2_maxLinearCorrection/box2d.b2Sqrt(m)),m>box2d.b2Sq(box2d.b2_linearSlop)&&(s=!1),n.x+=k.x,n.y+=k.y}return s};goog.exportProperty(box2d.b2AreaJoint.prototype,"SolvePositionConstraints",box2d.b2AreaJoint.prototype.SolvePositionConstraints);box2d.b2DistanceJointDef=function(){box2d.b2JointDef.call(this,box2d.b2JointType.e_distanceJoint);this.localAnchorA=new box2d.b2Vec2;this.localAnchorB=new box2d.b2Vec2};goog.inherits(box2d.b2DistanceJointDef,box2d.b2JointDef);goog.exportSymbol("box2d.b2DistanceJointDef",box2d.b2DistanceJointDef);box2d.b2DistanceJointDef.prototype.localAnchorA=null;goog.exportProperty(box2d.b2DistanceJointDef.prototype,"localAnchorA",box2d.b2DistanceJointDef.prototype.localAnchorA);box2d.b2DistanceJointDef.prototype.localAnchorB=null;goog.exportProperty(box2d.b2DistanceJointDef.prototype,"localAnchorB",box2d.b2DistanceJointDef.prototype.localAnchorB);box2d.b2DistanceJointDef.prototype.length=1;goog.exportProperty(box2d.b2DistanceJointDef.prototype,"length",box2d.b2DistanceJointDef.prototype.length);box2d.b2DistanceJointDef.prototype.frequencyHz=0;goog.exportProperty(box2d.b2DistanceJointDef.prototype,"frequencyHz",box2d.b2DistanceJointDef.prototype.frequencyHz);box2d.b2DistanceJointDef.prototype.dampingRatio=0;goog.exportProperty(box2d.b2DistanceJointDef.prototype,"dampingRatio",box2d.b2DistanceJointDef.prototype.dampingRatio);box2d.b2DistanceJointDef.prototype.Initialize=function(f,e,j,g){this.bodyA=f;this.bodyB=e;this.bodyA.GetLocalPoint(j,this.localAnchorA);this.bodyB.GetLocalPoint(g,this.localAnchorB);this.length=box2d.b2DistanceVV(j,g);this.dampingRatio=this.frequencyHz=0};goog.exportProperty(box2d.b2DistanceJointDef.prototype,"Initialize",box2d.b2DistanceJointDef.prototype.Initialize);box2d.b2DistanceJoint=function(b){box2d.b2Joint.call(this,b);this.m_u=new box2d.b2Vec2;this.m_rA=new box2d.b2Vec2;this.m_rB=new box2d.b2Vec2;this.m_localCenterA=new box2d.b2Vec2;this.m_localCenterB=new box2d.b2Vec2;this.m_qA=new box2d.b2Rot;this.m_qB=new box2d.b2Rot;this.m_lalcA=new box2d.b2Vec2;this.m_lalcB=new box2d.b2Vec2;this.m_frequencyHz=b.frequencyHz;this.m_dampingRatio=b.dampingRatio;this.m_localAnchorA=b.localAnchorA.Clone();this.m_localAnchorB=b.localAnchorB.Clone();this.m_length=b.length};goog.inherits(box2d.b2DistanceJoint,box2d.b2Joint);goog.exportSymbol("box2d.b2DistanceJoint",box2d.b2DistanceJoint);box2d.b2DistanceJoint.prototype.m_frequencyHz=0;goog.exportProperty(box2d.b2DistanceJoint.prototype,"m_frequencyHz",box2d.b2DistanceJoint.prototype.m_frequencyHz);box2d.b2DistanceJoint.prototype.m_dampingRatio=0;goog.exportProperty(box2d.b2DistanceJoint.prototype,"m_dampingRatio",box2d.b2DistanceJoint.prototype.m_dampingRatio);box2d.b2DistanceJoint.prototype.m_bias=0;goog.exportProperty(box2d.b2DistanceJoint.prototype,"m_bias",box2d.b2DistanceJoint.prototype.m_bias);box2d.b2DistanceJoint.prototype.m_localAnchorA=null;goog.exportProperty(box2d.b2DistanceJoint.prototype,"m_localAnchorA",box2d.b2DistanceJoint.prototype.m_localAnchorA);box2d.b2DistanceJoint.prototype.m_localAnchorB=null;goog.exportProperty(box2d.b2DistanceJoint.prototype,"m_localAnchorB",box2d.b2DistanceJoint.prototype.m_localAnchorB);box2d.b2DistanceJoint.prototype.m_gamma=0;goog.exportProperty(box2d.b2DistanceJoint.prototype,"m_gamma",box2d.b2DistanceJoint.prototype.m_gamma);box2d.b2DistanceJoint.prototype.m_impulse=0;goog.exportProperty(box2d.b2DistanceJoint.prototype,"m_impulse",box2d.b2DistanceJoint.prototype.m_impulse);box2d.b2DistanceJoint.prototype.m_length=0;goog.exportProperty(box2d.b2DistanceJoint.prototype,"m_length",box2d.b2DistanceJoint.prototype.m_length);box2d.b2DistanceJoint.prototype.m_indexA=0;goog.exportProperty(box2d.b2DistanceJoint.prototype,"m_indexA",box2d.b2DistanceJoint.prototype.m_indexA);box2d.b2DistanceJoint.prototype.m_indexB=0;goog.exportProperty(box2d.b2DistanceJoint.prototype,"m_indexB",box2d.b2DistanceJoint.prototype.m_indexB);box2d.b2DistanceJoint.prototype.m_u=null;goog.exportProperty(box2d.b2DistanceJoint.prototype,"m_u",box2d.b2DistanceJoint.prototype.m_u);box2d.b2DistanceJoint.prototype.m_rA=null;goog.exportProperty(box2d.b2DistanceJoint.prototype,"m_rA",box2d.b2DistanceJoint.prototype.m_rA);box2d.b2DistanceJoint.prototype.m_rB=null;goog.exportProperty(box2d.b2DistanceJoint.prototype,"m_rB",box2d.b2DistanceJoint.prototype.m_rB);box2d.b2DistanceJoint.prototype.m_localCenterA=null;goog.exportProperty(box2d.b2DistanceJoint.prototype,"m_localCenterA",box2d.b2DistanceJoint.prototype.m_localCenterA);box2d.b2DistanceJoint.prototype.m_localCenterB=null;goog.exportProperty(box2d.b2DistanceJoint.prototype,"m_localCenterB",box2d.b2DistanceJoint.prototype.m_localCenterB);box2d.b2DistanceJoint.prototype.m_invMassA=0;goog.exportProperty(box2d.b2DistanceJoint.prototype,"m_invMassA",box2d.b2DistanceJoint.prototype.m_invMassA);box2d.b2DistanceJoint.prototype.m_invMassB=0;goog.exportProperty(box2d.b2DistanceJoint.prototype,"m_invMassB",box2d.b2DistanceJoint.prototype.m_invMassB);box2d.b2DistanceJoint.prototype.m_invIA=0;goog.exportProperty(box2d.b2DistanceJoint.prototype,"m_invIA",box2d.b2DistanceJoint.prototype.m_invIA);box2d.b2DistanceJoint.prototype.m_invIB=0;goog.exportProperty(box2d.b2DistanceJoint.prototype,"m_invIB",box2d.b2DistanceJoint.prototype.m_invIB);box2d.b2DistanceJoint.prototype.m_mass=0;goog.exportProperty(box2d.b2DistanceJoint.prototype,"m_mass",box2d.b2DistanceJoint.prototype.m_mass);box2d.b2DistanceJoint.prototype.m_qA=null;goog.exportProperty(box2d.b2DistanceJoint.prototype,"m_qA",box2d.b2DistanceJoint.prototype.m_qA);box2d.b2DistanceJoint.prototype.m_qB=null;goog.exportProperty(box2d.b2DistanceJoint.prototype,"m_qB",box2d.b2DistanceJoint.prototype.m_qB);box2d.b2DistanceJoint.prototype.m_lalcA=null;goog.exportProperty(box2d.b2DistanceJoint.prototype,"m_lalcA",box2d.b2DistanceJoint.prototype.m_lalcA);box2d.b2DistanceJoint.prototype.m_lalcB=null;goog.exportProperty(box2d.b2DistanceJoint.prototype,"m_lalcB",box2d.b2DistanceJoint.prototype.m_lalcB);box2d.b2DistanceJoint.prototype.GetAnchorA=function(b){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,b)};goog.exportProperty(box2d.b2DistanceJoint.prototype,"GetAnchorA",box2d.b2DistanceJoint.prototype.GetAnchorA);box2d.b2DistanceJoint.prototype.GetAnchorB=function(b){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,b)};goog.exportProperty(box2d.b2DistanceJoint.prototype,"GetAnchorB",box2d.b2DistanceJoint.prototype.GetAnchorB);box2d.b2DistanceJoint.prototype.GetReactionForce=function(e,d){return d.SetXY(e*this.m_impulse*this.m_u.x,e*this.m_impulse*this.m_u.y)};goog.exportProperty(box2d.b2DistanceJoint.prototype,"GetReactionForce",box2d.b2DistanceJoint.prototype.GetReactionForce);box2d.b2DistanceJoint.prototype.GetReactionTorque=function(b){return 0};goog.exportProperty(box2d.b2DistanceJoint.prototype,"GetReactionTorque",box2d.b2DistanceJoint.prototype.GetReactionTorque);box2d.b2DistanceJoint.prototype.GetLocalAnchorA=function(b){return b.Copy(this.m_localAnchorA)};goog.exportProperty(box2d.b2DistanceJoint.prototype,"GetLocalAnchorA",box2d.b2DistanceJoint.prototype.GetLocalAnchorA);box2d.b2DistanceJoint.prototype.GetLocalAnchorB=function(b){return b.Copy(this.m_localAnchorB)};goog.exportProperty(box2d.b2DistanceJoint.prototype,"GetLocalAnchorB",box2d.b2DistanceJoint.prototype.GetLocalAnchorB);box2d.b2DistanceJoint.prototype.SetLength=function(b){this.m_length=b};goog.exportProperty(box2d.b2DistanceJoint.prototype,"SetLength",box2d.b2DistanceJoint.prototype.SetLength);box2d.b2DistanceJoint.prototype.GetLength=function(){return this.m_length};goog.exportProperty(box2d.b2DistanceJoint.prototype,"GetLength",box2d.b2DistanceJoint.prototype.GetLength);box2d.b2DistanceJoint.prototype.SetFrequency=function(b){this.m_frequencyHz=b};goog.exportProperty(box2d.b2DistanceJoint.prototype,"SetFrequency",box2d.b2DistanceJoint.prototype.SetFrequency);box2d.b2DistanceJoint.prototype.GetFrequency=function(){return this.m_frequencyHz};goog.exportProperty(box2d.b2DistanceJoint.prototype,"GetFrequency",box2d.b2DistanceJoint.prototype.GetFrequency);box2d.b2DistanceJoint.prototype.SetDampingRatio=function(b){this.m_dampingRatio=b};goog.exportProperty(box2d.b2DistanceJoint.prototype,"SetDampingRatio",box2d.b2DistanceJoint.prototype.SetDampingRatio);box2d.b2DistanceJoint.prototype.GetDampingRatio=function(){return this.m_dampingRatio};goog.exportProperty(box2d.b2DistanceJoint.prototype,"GetDampingRatio",box2d.b2DistanceJoint.prototype.GetDampingRatio);box2d.b2DistanceJoint.prototype.Dump=function(){if(box2d.DEBUG){var e=this.m_bodyA.m_islandIndex,d=this.m_bodyB.m_islandIndex;box2d.b2Log("  /*box2d.b2DistanceJointDef*/ var jd = new box2d.b2DistanceJointDef();\n");box2d.b2Log("  jd.bodyA = bodies[%d];\n",e);box2d.b2Log("  jd.bodyB = bodies[%d];\n",d);box2d.b2Log("  jd.collideConnected = %s;\n",this.m_collideConnected?"true":"false");box2d.b2Log("  jd.localAnchorA.SetXY(%.15f, %.15f);\n",this.m_localAnchorA.x,this.m_localAnchorA.y);box2d.b2Log("  jd.localAnchorB.SetXY(%.15f, %.15f);\n",this.m_localAnchorB.x,this.m_localAnchorB.y);box2d.b2Log("  jd.length = %.15f;\n",this.m_length);box2d.b2Log("  jd.frequencyHz = %.15f;\n",this.m_frequencyHz);box2d.b2Log("  jd.dampingRatio = %.15f;\n",this.m_dampingRatio);box2d.b2Log("  joints[%d] = this.m_world.CreateJoint(jd);\n",this.m_index)}};goog.exportProperty(box2d.b2DistanceJoint.prototype,"Dump",box2d.b2DistanceJoint.prototype.Dump);box2d.b2DistanceJoint.prototype.InitVelocityConstraints=function(z){this.m_indexA=this.m_bodyA.m_islandIndex;this.m_indexB=this.m_bodyB.m_islandIndex;this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter);this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter);this.m_invMassA=this.m_bodyA.m_invMass;this.m_invMassB=this.m_bodyB.m_invMass;this.m_invIA=this.m_bodyA.m_invI;this.m_invIB=this.m_bodyB.m_invI;var y=z.positions[this.m_indexA].c,v=z.velocities[this.m_indexA].v,u=z.velocities[this.m_indexA].w,s=z.positions[this.m_indexB].c,r=z.positions[this.m_indexB].a,q=z.velocities[this.m_indexB].v,n=z.velocities[this.m_indexB].w,j=this.m_qA.SetAngleRadians(z.positions[this.m_indexA].a),r=this.m_qB.SetAngleRadians(r);box2d.b2SubVV(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA);box2d.b2MulRV(j,this.m_lalcA,this.m_rA);box2d.b2SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB);box2d.b2MulRV(r,this.m_lalcB,this.m_rB);this.m_u.x=s.x+this.m_rB.x-y.x-this.m_rA.x;this.m_u.y=s.y+this.m_rB.y-y.y-this.m_rA.y;s=this.m_u.GetLength();s>box2d.b2_linearSlop?this.m_u.SelfMul(1/s):this.m_u.SetZero();y=box2d.b2CrossVV(this.m_rA,this.m_u);j=box2d.b2CrossVV(this.m_rB,this.m_u);y=this.m_invMassA+this.m_invIA*y*y+this.m_invMassB+this.m_invIB*j*j;this.m_mass=0!==y?1/y:0;if(0<this.m_frequencyHz){var s=s-this.m_length,j=2*box2d.b2_pi*this.m_frequencyHz,r=this.m_mass*j*j,m=z.step.dt;this.m_gamma=m*(2*this.m_mass*this.m_dampingRatio*j+m*r);this.m_gamma=0!==this.m_gamma?1/this.m_gamma:0;this.m_bias=s*m*r*this.m_gamma;y+=this.m_gamma;this.m_mass=0!==y?1/y:0}else{this.m_bias=this.m_gamma=0}z.step.warmStarting?(this.m_impulse*=z.step.dtRatio,y=box2d.b2MulSV(this.m_impulse,this.m_u,box2d.b2DistanceJoint.prototype.InitVelocityConstraints.s_P),v.SelfMulSub(this.m_invMassA,y),u-=this.m_invIA*box2d.b2CrossVV(this.m_rA,y),q.SelfMulAdd(this.m_invMassB,y),n+=this.m_invIB*box2d.b2CrossVV(this.m_rB,y)):this.m_impulse=0;z.velocities[this.m_indexA].w=u;z.velocities[this.m_indexB].w=n};goog.exportProperty(box2d.b2DistanceJoint.prototype,"InitVelocityConstraints",box2d.b2DistanceJoint.prototype.InitVelocityConstraints);box2d.b2DistanceJoint.prototype.InitVelocityConstraints.s_P=new box2d.b2Vec2;box2d.b2DistanceJoint.prototype.SolveVelocityConstraints=function(k){var j=k.velocities[this.m_indexA].v,s=k.velocities[this.m_indexA].w,r=k.velocities[this.m_indexB].v,q=k.velocities[this.m_indexB].w,n=box2d.b2AddVCrossSV(j,s,this.m_rA,box2d.b2DistanceJoint.prototype.SolveVelocityConstraints.s_vpA),m=box2d.b2AddVCrossSV(r,q,this.m_rB,box2d.b2DistanceJoint.prototype.SolveVelocityConstraints.s_vpB),n=box2d.b2DotVV(this.m_u,box2d.b2SubVV(m,n,box2d.b2Vec2.s_t0)),n=-this.m_mass*(n+this.m_bias+this.m_gamma*this.m_impulse);this.m_impulse+=n;n=box2d.b2MulSV(n,this.m_u,box2d.b2DistanceJoint.prototype.SolveVelocityConstraints.s_P);j.SelfMulSub(this.m_invMassA,n);s-=this.m_invIA*box2d.b2CrossVV(this.m_rA,n);r.SelfMulAdd(this.m_invMassB,n);q+=this.m_invIB*box2d.b2CrossVV(this.m_rB,n);k.velocities[this.m_indexA].w=s;k.velocities[this.m_indexB].w=q};goog.exportProperty(box2d.b2DistanceJoint.prototype,"SolveVelocityConstraints",box2d.b2DistanceJoint.prototype.SolveVelocityConstraints);box2d.b2DistanceJoint.prototype.SolveVelocityConstraints.s_vpA=new box2d.b2Vec2;box2d.b2DistanceJoint.prototype.SolveVelocityConstraints.s_vpB=new box2d.b2Vec2;box2d.b2DistanceJoint.prototype.SolveVelocityConstraints.s_P=new box2d.b2Vec2;box2d.b2DistanceJoint.prototype.SolvePositionConstraints=function(v){if(0<this.m_frequencyHz){return !0}var u=v.positions[this.m_indexA].c,s=v.positions[this.m_indexA].a,r=v.positions[this.m_indexB].c,q=v.positions[this.m_indexB].a;this.m_qA.SetAngleRadians(s);this.m_qB.SetAngleRadians(q);var n=box2d.b2MulRV(this.m_qA,this.m_lalcA,this.m_rA),m=box2d.b2MulRV(this.m_qB,this.m_lalcB,this.m_rB),k=this.m_u;k.x=r.x+m.x-u.x-n.x;k.y=r.y+m.y-u.y-n.y;var j=this.m_u.Normalize()-this.m_length,j=box2d.b2Clamp(j,-box2d.b2_maxLinearCorrection,box2d.b2_maxLinearCorrection),k=box2d.b2MulSV(-this.m_mass*j,k,box2d.b2DistanceJoint.prototype.SolvePositionConstraints.s_P);u.SelfMulSub(this.m_invMassA,k);s-=this.m_invIA*box2d.b2CrossVV(n,k);r.SelfMulAdd(this.m_invMassB,k);q+=this.m_invIB*box2d.b2CrossVV(m,k);v.positions[this.m_indexA].a=s;v.positions[this.m_indexB].a=q;return box2d.b2Abs(j)<box2d.b2_linearSlop};goog.exportProperty(box2d.b2DistanceJoint.prototype,"SolvePositionConstraints",box2d.b2DistanceJoint.prototype.SolvePositionConstraints);box2d.b2DistanceJoint.prototype.SolvePositionConstraints.s_P=new box2d.b2Vec2;box2d.b2FrictionJointDef=function(){box2d.b2JointDef.call(this,box2d.b2JointType.e_frictionJoint);this.localAnchorA=new box2d.b2Vec2;this.localAnchorB=new box2d.b2Vec2};goog.inherits(box2d.b2FrictionJointDef,box2d.b2JointDef);goog.exportSymbol("box2d.b2FrictionJointDef",box2d.b2FrictionJointDef);box2d.b2FrictionJointDef.prototype.localAnchorA=null;goog.exportProperty(box2d.b2FrictionJointDef.prototype,"localAnchorA",box2d.b2FrictionJointDef.prototype.localAnchorA);box2d.b2FrictionJointDef.prototype.localAnchorB=null;goog.exportProperty(box2d.b2FrictionJointDef.prototype,"localAnchorB",box2d.b2FrictionJointDef.prototype.localAnchorB);box2d.b2FrictionJointDef.prototype.maxForce=0;goog.exportProperty(box2d.b2FrictionJointDef.prototype,"maxForce",box2d.b2FrictionJointDef.prototype.maxForce);box2d.b2FrictionJointDef.prototype.maxTorque=0;goog.exportProperty(box2d.b2FrictionJointDef.prototype,"maxTorque",box2d.b2FrictionJointDef.prototype.maxTorque);box2d.b2FrictionJointDef.prototype.Initialize=function(e,d,f){this.bodyA=e;this.bodyB=d;this.bodyA.GetLocalPoint(f,this.localAnchorA);this.bodyB.GetLocalPoint(f,this.localAnchorB)};goog.exportProperty(box2d.b2FrictionJointDef.prototype,"Initialize",box2d.b2FrictionJointDef.prototype.Initialize);box2d.b2FrictionJoint=function(b){box2d.b2Joint.call(this,b);this.m_localAnchorA=b.localAnchorA.Clone();this.m_localAnchorB=b.localAnchorB.Clone();this.m_linearImpulse=(new box2d.b2Vec2).SetZero();this.m_maxForce=b.maxForce;this.m_maxTorque=b.maxTorque;this.m_rA=new box2d.b2Vec2;this.m_rB=new box2d.b2Vec2;this.m_localCenterA=new box2d.b2Vec2;this.m_localCenterB=new box2d.b2Vec2;this.m_linearMass=(new box2d.b2Mat22).SetZero();this.m_qA=new box2d.b2Rot;this.m_qB=new box2d.b2Rot;this.m_lalcA=new box2d.b2Vec2;this.m_lalcB=new box2d.b2Vec2;this.m_K=new box2d.b2Mat22};goog.inherits(box2d.b2FrictionJoint,box2d.b2Joint);goog.exportSymbol("box2d.b2FrictionJoint",box2d.b2FrictionJoint);box2d.b2FrictionJoint.prototype.m_localAnchorA=null;goog.exportProperty(box2d.b2FrictionJoint.prototype,"m_localAnchorA",box2d.b2FrictionJoint.prototype.m_localAnchorA);box2d.b2FrictionJoint.prototype.m_localAnchorB=null;goog.exportProperty(box2d.b2FrictionJoint.prototype,"m_localAnchorB",box2d.b2FrictionJoint.prototype.m_localAnchorB);box2d.b2FrictionJoint.prototype.m_linearImpulse=null;goog.exportProperty(box2d.b2FrictionJoint.prototype,"m_linearImpulse",box2d.b2FrictionJoint.prototype.m_linearImpulse);box2d.b2FrictionJoint.prototype.m_angularImpulse=0;goog.exportProperty(box2d.b2FrictionJoint.prototype,"m_angularImpulse",box2d.b2FrictionJoint.prototype.m_angularImpulse);box2d.b2FrictionJoint.prototype.m_maxForce=0;goog.exportProperty(box2d.b2FrictionJoint.prototype,"m_maxForce",box2d.b2FrictionJoint.prototype.m_maxForce);box2d.b2FrictionJoint.prototype.m_maxTorque=0;goog.exportProperty(box2d.b2FrictionJoint.prototype,"m_maxTorque",box2d.b2FrictionJoint.prototype.m_maxTorque);box2d.b2FrictionJoint.prototype.m_indexA=0;goog.exportProperty(box2d.b2FrictionJoint.prototype,"m_indexA",box2d.b2FrictionJoint.prototype.m_indexA);box2d.b2FrictionJoint.prototype.m_indexB=0;goog.exportProperty(box2d.b2FrictionJoint.prototype,"m_indexB",box2d.b2FrictionJoint.prototype.m_indexB);box2d.b2FrictionJoint.prototype.m_rA=null;goog.exportProperty(box2d.b2FrictionJoint.prototype,"m_rA",box2d.b2FrictionJoint.prototype.m_rA);box2d.b2FrictionJoint.prototype.m_rB=null;goog.exportProperty(box2d.b2FrictionJoint.prototype,"m_rB",box2d.b2FrictionJoint.prototype.m_rB);box2d.b2FrictionJoint.prototype.m_localCenterA=null;goog.exportProperty(box2d.b2FrictionJoint.prototype,"m_localCenterA",box2d.b2FrictionJoint.prototype.m_localCenterA);box2d.b2FrictionJoint.prototype.m_localCenterB=null;goog.exportProperty(box2d.b2FrictionJoint.prototype,"m_localCenterB",box2d.b2FrictionJoint.prototype.m_localCenterB);box2d.b2FrictionJoint.prototype.m_invMassA=0;goog.exportProperty(box2d.b2FrictionJoint.prototype,"m_invMassA",box2d.b2FrictionJoint.prototype.m_invMassA);box2d.b2FrictionJoint.prototype.m_invMassB=0;goog.exportProperty(box2d.b2FrictionJoint.prototype,"m_invMassB",box2d.b2FrictionJoint.prototype.m_invMassB);box2d.b2FrictionJoint.prototype.m_invIA=0;goog.exportProperty(box2d.b2FrictionJoint.prototype,"m_invIA",box2d.b2FrictionJoint.prototype.m_invIA);box2d.b2FrictionJoint.prototype.m_invIB=0;goog.exportProperty(box2d.b2FrictionJoint.prototype,"m_invIB",box2d.b2FrictionJoint.prototype.m_invIB);box2d.b2FrictionJoint.prototype.m_linearMass=null;goog.exportProperty(box2d.b2FrictionJoint.prototype,"m_linearMass",box2d.b2FrictionJoint.prototype.m_linearMass);box2d.b2FrictionJoint.prototype.m_angularMass=0;goog.exportProperty(box2d.b2FrictionJoint.prototype,"m_angularMass",box2d.b2FrictionJoint.prototype.m_angularMass);box2d.b2FrictionJoint.prototype.m_qA=null;goog.exportProperty(box2d.b2FrictionJoint.prototype,"m_qA",box2d.b2FrictionJoint.prototype.m_qA);box2d.b2FrictionJoint.prototype.m_qB=null;goog.exportProperty(box2d.b2FrictionJoint.prototype,"m_qB",box2d.b2FrictionJoint.prototype.m_qB);box2d.b2FrictionJoint.prototype.m_lalcA=null;goog.exportProperty(box2d.b2FrictionJoint.prototype,"m_lalcA",box2d.b2FrictionJoint.prototype.m_lalcA);box2d.b2FrictionJoint.prototype.m_lalcB=null;goog.exportProperty(box2d.b2FrictionJoint.prototype,"m_lalcB",box2d.b2FrictionJoint.prototype.m_lalcB);box2d.b2FrictionJoint.prototype.m_K=null;goog.exportProperty(box2d.b2FrictionJoint.prototype,"m_K",box2d.b2FrictionJoint.prototype.m_K);box2d.b2FrictionJoint.prototype.InitVelocityConstraints=function(D){this.m_indexA=this.m_bodyA.m_islandIndex;this.m_indexB=this.m_bodyB.m_islandIndex;this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter);this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter);this.m_invMassA=this.m_bodyA.m_invMass;this.m_invMassB=this.m_bodyB.m_invMass;this.m_invIA=this.m_bodyA.m_invI;this.m_invIB=this.m_bodyB.m_invI;var C=D.velocities[this.m_indexA].v,B=D.velocities[this.m_indexA].w,A=D.positions[this.m_indexB].a,z=D.velocities[this.m_indexB].v,y=D.velocities[this.m_indexB].w,v=this.m_qA.SetAngleRadians(D.positions[this.m_indexA].a),A=this.m_qB.SetAngleRadians(A);box2d.b2SubVV(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA);v=box2d.b2MulRV(v,this.m_lalcA,this.m_rA);box2d.b2SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB);var u=box2d.b2MulRV(A,this.m_lalcB,this.m_rB),A=this.m_invMassA,r=this.m_invMassB,s=this.m_invIA,q=this.m_invIB,j=this.m_K;j.ex.x=A+r+s*v.y*v.y+q*u.y*u.y;j.ex.y=-s*v.x*v.y-q*u.x*u.y;j.ey.x=j.ex.y;j.ey.y=A+r+s*v.x*v.x+q*u.x*u.x;j.GetInverse(this.m_linearMass);this.m_angularMass=s+q;0<this.m_angularMass&&(this.m_angularMass=1/this.m_angularMass);D.step.warmStarting?(this.m_linearImpulse.SelfMul(D.step.dtRatio),this.m_angularImpulse*=D.step.dtRatio,v=this.m_linearImpulse,C.SelfMulSub(A,v),B-=s*(box2d.b2CrossVV(this.m_rA,v)+this.m_angularImpulse),z.SelfMulAdd(r,v),y+=q*(box2d.b2CrossVV(this.m_rB,v)+this.m_angularImpulse)):(this.m_linearImpulse.SetZero(),this.m_angularImpulse=0);D.velocities[this.m_indexA].w=B;D.velocities[this.m_indexB].w=y};goog.exportProperty(box2d.b2FrictionJoint.prototype,"InitVelocityConstraints",box2d.b2FrictionJoint.prototype.InitVelocityConstraints);box2d.b2FrictionJoint.prototype.SolveVelocityConstraints=function(E){var D=E.velocities[this.m_indexA].v,C=E.velocities[this.m_indexA].w,B=E.velocities[this.m_indexB].v,A=E.velocities[this.m_indexB].w,z=this.m_invMassA,y=this.m_invMassB,v=this.m_invIA,s=this.m_invIB,u=E.step.dt,r,q=-this.m_angularMass*(A-C),j=this.m_angularImpulse;r=u*this.m_maxTorque;this.m_angularImpulse=box2d.b2Clamp(this.m_angularImpulse+q,-r,r);q=this.m_angularImpulse-j;C-=v*q;A+=s*q;r=box2d.b2SubVV(box2d.b2AddVCrossSV(B,A,this.m_rB,box2d.b2Vec2.s_t0),box2d.b2AddVCrossSV(D,C,this.m_rA,box2d.b2Vec2.s_t1),box2d.b2FrictionJoint.prototype.SolveVelocityConstraints.s_Cdot);q=box2d.b2MulMV(this.m_linearMass,r,box2d.b2FrictionJoint.prototype.SolveVelocityConstraints.s_impulseV).SelfNeg();j=box2d.b2FrictionJoint.prototype.SolveVelocityConstraints.s_oldImpulseV.Copy(this.m_linearImpulse);this.m_linearImpulse.SelfAdd(q);r=u*this.m_maxForce;this.m_linearImpulse.GetLengthSquared()>r*r&&(this.m_linearImpulse.Normalize(),this.m_linearImpulse.SelfMul(r));box2d.b2SubVV(this.m_linearImpulse,j,q);D.SelfMulSub(z,q);C-=v*box2d.b2CrossVV(this.m_rA,q);B.SelfMulAdd(y,q);A+=s*box2d.b2CrossVV(this.m_rB,q);E.velocities[this.m_indexA].w=C;E.velocities[this.m_indexB].w=A};goog.exportProperty(box2d.b2FrictionJoint.prototype,"SolveVelocityConstraints",box2d.b2FrictionJoint.prototype.SolveVelocityConstraints);box2d.b2FrictionJoint.prototype.SolveVelocityConstraints.s_Cdot=new box2d.b2Vec2;box2d.b2FrictionJoint.prototype.SolveVelocityConstraints.s_impulseV=new box2d.b2Vec2;box2d.b2FrictionJoint.prototype.SolveVelocityConstraints.s_oldImpulseV=new box2d.b2Vec2;box2d.b2FrictionJoint.prototype.SolvePositionConstraints=function(b){return !0};goog.exportProperty(box2d.b2FrictionJoint.prototype,"SolvePositionConstraints",box2d.b2FrictionJoint.prototype.SolvePositionConstraints);box2d.b2FrictionJoint.prototype.GetAnchorA=function(b){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,b)};goog.exportProperty(box2d.b2FrictionJoint.prototype,"GetAnchorA",box2d.b2FrictionJoint.prototype.GetAnchorA);box2d.b2FrictionJoint.prototype.GetAnchorB=function(b){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,b)};goog.exportProperty(box2d.b2FrictionJoint.prototype,"GetAnchorB",box2d.b2FrictionJoint.prototype.GetAnchorB);box2d.b2FrictionJoint.prototype.GetReactionForce=function(e,d){return d.SetXY(e*this.m_linearImpulse.x,e*this.m_linearImpulse.y)};goog.exportProperty(box2d.b2FrictionJoint.prototype,"GetReactionForce",box2d.b2FrictionJoint.prototype.GetReactionForce);box2d.b2FrictionJoint.prototype.GetReactionTorque=function(b){return b*this.m_angularImpulse};goog.exportProperty(box2d.b2FrictionJoint.prototype,"GetReactionTorque",box2d.b2FrictionJoint.prototype.GetReactionTorque);box2d.b2FrictionJoint.prototype.GetLocalAnchorA=function(b){return b.Copy(this.m_localAnchorA)};goog.exportProperty(box2d.b2FrictionJoint.prototype,"GetLocalAnchorA",box2d.b2FrictionJoint.prototype.GetLocalAnchorA);box2d.b2FrictionJoint.prototype.GetLocalAnchorB=function(b){return b.Copy(this.m_localAnchorB)};goog.exportProperty(box2d.b2FrictionJoint.prototype,"GetLocalAnchorB",box2d.b2FrictionJoint.prototype.GetLocalAnchorB);box2d.b2FrictionJoint.prototype.SetMaxForce=function(b){this.m_maxForce=b};goog.exportProperty(box2d.b2FrictionJoint.prototype,"SetMaxForce",box2d.b2FrictionJoint.prototype.SetMaxForce);box2d.b2FrictionJoint.prototype.GetMaxForce=function(){return this.m_maxForce};goog.exportProperty(box2d.b2FrictionJoint.prototype,"GetMaxForce",box2d.b2FrictionJoint.prototype.GetMaxForce);box2d.b2FrictionJoint.prototype.SetMaxTorque=function(b){this.m_maxTorque=b};goog.exportProperty(box2d.b2FrictionJoint.prototype,"SetMaxTorque",box2d.b2FrictionJoint.prototype.SetMaxTorque);box2d.b2FrictionJoint.prototype.GetMaxTorque=function(){return this.m_maxTorque};goog.exportProperty(box2d.b2FrictionJoint.prototype,"GetMaxTorque",box2d.b2FrictionJoint.prototype.GetMaxTorque);box2d.b2FrictionJoint.prototype.Dump=function(){if(box2d.DEBUG){var e=this.m_bodyA.m_islandIndex,d=this.m_bodyB.m_islandIndex;box2d.b2Log("  /*box2d.b2FrictionJointDef*/ var jd = new box2d.b2FrictionJointDef();\n");box2d.b2Log("  jd.bodyA = bodies[%d];\n",e);box2d.b2Log("  jd.bodyB = bodies[%d];\n",d);box2d.b2Log("  jd.collideConnected = %s;\n",this.m_collideConnected?"true":"false");box2d.b2Log("  jd.localAnchorA.SetXY(%.15f, %.15f);\n",this.m_localAnchorA.x,this.m_localAnchorA.y);box2d.b2Log("  jd.localAnchorB.SetXY(%.15f, %.15f);\n",this.m_localAnchorB.x,this.m_localAnchorB.y);box2d.b2Log("  jd.maxForce = %.15f;\n",this.m_maxForce);box2d.b2Log("  jd.maxTorque = %.15f;\n",this.m_maxTorque);box2d.b2Log("  joints[%d] = this.m_world.CreateJoint(jd);\n",this.m_index)}};goog.exportProperty(box2d.b2FrictionJoint.prototype,"Dump",box2d.b2FrictionJoint.prototype.Dump);box2d.b2JointFactory={};box2d.b2JointFactory.Create=function(e,d){var f=null;switch(e.type){case box2d.b2JointType.e_distanceJoint:f=new box2d.b2DistanceJoint(e instanceof box2d.b2DistanceJointDef?e:null);break;case box2d.b2JointType.e_mouseJoint:f=new box2d.b2MouseJoint(e instanceof box2d.b2MouseJointDef?e:null);break;case box2d.b2JointType.e_prismaticJoint:f=new box2d.b2PrismaticJoint(e instanceof box2d.b2PrismaticJointDef?e:null);break;case box2d.b2JointType.e_revoluteJoint:f=new box2d.b2RevoluteJoint(e instanceof box2d.b2RevoluteJointDef?e:null);break;case box2d.b2JointType.e_pulleyJoint:f=new box2d.b2PulleyJoint(e instanceof box2d.b2PulleyJointDef?e:null);break;case box2d.b2JointType.e_gearJoint:f=new box2d.b2GearJoint(e instanceof box2d.b2GearJointDef?e:null);break;case box2d.b2JointType.e_wheelJoint:f=new box2d.b2WheelJoint(e instanceof box2d.b2WheelJointDef?e:null);break;case box2d.b2JointType.e_weldJoint:f=new box2d.b2WeldJoint(e instanceof box2d.b2WeldJointDef?e:null);break;case box2d.b2JointType.e_frictionJoint:f=new box2d.b2FrictionJoint(e instanceof box2d.b2FrictionJointDef?e:null);break;case box2d.b2JointType.e_ropeJoint:f=new box2d.b2RopeJoint(e instanceof box2d.b2RopeJointDef?e:null);break;case box2d.b2JointType.e_motorJoint:f=new box2d.b2MotorJoint(e instanceof box2d.b2MotorJointDef?e:null);break;case box2d.b2JointType.e_areaJoint:f=new box2d.b2AreaJoint(e instanceof box2d.b2AreaJointDef?e:null);break;default:box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1)}return f};goog.exportSymbol("box2d.b2JointFactory.Create",box2d.b2JointFactory.Create);box2d.b2JointFactory.Destroy=function(e,d){};goog.exportSymbol("box2d.b2JointFactory.Destroy",box2d.b2JointFactory.Destroy);box2d.b2WorldFlag={e_none:0,e_newFixture:1,e_locked:2,e_clearForces:4};goog.exportSymbol("box2d.b2WorldFlag",box2d.b2WorldFlag);goog.exportProperty(box2d.b2WorldFlag,"e_none",box2d.b2WorldFlag.e_none);goog.exportProperty(box2d.b2WorldFlag,"e_newFixture",box2d.b2WorldFlag.e_newFixture);goog.exportProperty(box2d.b2WorldFlag,"e_locked",box2d.b2WorldFlag.e_locked);goog.exportProperty(box2d.b2WorldFlag,"e_clearForces",box2d.b2WorldFlag.e_clearForces);box2d.b2World=function(b){this.m_flags=box2d.b2WorldFlag.e_clearForces;this.m_contactManager=new box2d.b2ContactManager;this.m_gravity=b.Clone();this.m_out_gravity=new box2d.b2Vec2;this.m_allowSleep=!0;this.m_debugDraw=this.m_destructionListener=null;this.m_continuousPhysics=this.m_warmStarting=!0;this.m_subStepping=!1;this.m_stepComplete=!0;this.m_profile=new box2d.b2Profile;this.m_island=new box2d.b2Island;this.s_stack=[]};goog.exportSymbol("box2d.b2World",box2d.b2World);box2d.b2World.prototype.m_flags=box2d.b2WorldFlag.e_none;goog.exportProperty(box2d.b2World.prototype,"m_flags",box2d.b2World.prototype.m_flags);box2d.b2World.prototype.m_contactManager=null;goog.exportProperty(box2d.b2World.prototype,"m_contactManager",box2d.b2World.prototype.m_contactManager);box2d.b2World.prototype.m_bodyList=null;goog.exportProperty(box2d.b2World.prototype,"m_bodyList",box2d.b2World.prototype.m_bodyList);box2d.b2World.prototype.m_jointList=null;goog.exportProperty(box2d.b2World.prototype,"m_jointList",box2d.b2World.prototype.m_jointList);box2d.b2World.prototype.m_bodyCount=0;goog.exportProperty(box2d.b2World.prototype,"m_bodyCount",box2d.b2World.prototype.m_bodyCount);box2d.b2World.prototype.m_jointCount=0;goog.exportProperty(box2d.b2World.prototype,"m_jointCount",box2d.b2World.prototype.m_jointCount);box2d.b2World.prototype.m_gravity=null;goog.exportProperty(box2d.b2World.prototype,"m_gravity",box2d.b2World.prototype.m_gravity);box2d.b2World.prototype.m_out_gravity=null;goog.exportProperty(box2d.b2World.prototype,"m_out_gravity",box2d.b2World.prototype.m_out_gravity);box2d.b2World.prototype.m_allowSleep=!0;goog.exportProperty(box2d.b2World.prototype,"m_allowSleep",box2d.b2World.prototype.m_allowSleep);box2d.b2World.prototype.m_destructionListener=null;goog.exportProperty(box2d.b2World.prototype,"m_destructionListener",box2d.b2World.prototype.m_destructionListener);box2d.b2World.prototype.m_debugDraw=null;goog.exportProperty(box2d.b2World.prototype,"m_debugDraw",box2d.b2World.prototype.m_debugDraw);box2d.b2World.prototype.m_inv_dt0=0;goog.exportProperty(box2d.b2World.prototype,"m_inv_dt0",box2d.b2World.prototype.m_inv_dt0);box2d.b2World.prototype.m_warmStarting=!0;goog.exportProperty(box2d.b2World.prototype,"m_warmStarting",box2d.b2World.prototype.m_warmStarting);box2d.b2World.prototype.m_continuousPhysics=!0;goog.exportProperty(box2d.b2World.prototype,"m_continuousPhysics",box2d.b2World.prototype.m_continuousPhysics);box2d.b2World.prototype.m_subStepping=!1;goog.exportProperty(box2d.b2World.prototype,"m_subStepping",box2d.b2World.prototype.m_subStepping);box2d.b2World.prototype.m_stepComplete=!0;goog.exportProperty(box2d.b2World.prototype,"m_stepComplete",box2d.b2World.prototype.m_stepComplete);box2d.b2World.prototype.m_profile=null;goog.exportProperty(box2d.b2World.prototype,"m_profile",box2d.b2World.prototype.m_profile);box2d.b2World.prototype.m_island=null;goog.exportProperty(box2d.b2World.prototype,"m_island",box2d.b2World.prototype.m_island);box2d.b2World.prototype.s_stack=null;goog.exportProperty(box2d.b2World.prototype,"s_stack",box2d.b2World.prototype.s_stack);box2d.b2World.prototype.m_controllerList=null;goog.exportProperty(box2d.b2World.prototype,"m_controllerList",box2d.b2World.prototype.m_controllerList);box2d.b2World.prototype.m_controllerCount=0;goog.exportProperty(box2d.b2World.prototype,"m_controllerCount",box2d.b2World.prototype.m_controllerCount);box2d.b2World.prototype.SetAllowSleeping=function(b){if(b!==this.m_allowSleep&&(this.m_allowSleep=b,!1===this.m_allowSleep)){for(b=this.m_bodyList;b;b=b.m_next){b.SetAwake(!0)}}};goog.exportProperty(box2d.b2World.prototype,"SetAllowSleeping",box2d.b2World.prototype.SetAllowSleeping);box2d.b2World.prototype.GetAllowSleeping=function(){return this.m_allowSleep};goog.exportProperty(box2d.b2World.prototype,"GetAllowSleeping",box2d.b2World.prototype.GetAllowSleeping);box2d.b2World.prototype.SetWarmStarting=function(b){this.m_warmStarting=b};goog.exportProperty(box2d.b2World.prototype,"SetWarmStarting",box2d.b2World.prototype.SetWarmStarting);box2d.b2World.prototype.GetWarmStarting=function(){return this.m_warmStarting};goog.exportProperty(box2d.b2World.prototype,"GetWarmStarting",box2d.b2World.prototype.GetWarmStarting);box2d.b2World.prototype.SetContinuousPhysics=function(b){this.m_continuousPhysics=b};goog.exportProperty(box2d.b2World.prototype,"SetContinuousPhysics",box2d.b2World.prototype.SetContinuousPhysics);box2d.b2World.prototype.GetContinuousPhysics=function(){return this.m_continuousPhysics};goog.exportProperty(box2d.b2World.prototype,"GetContinuousPhysics",box2d.b2World.prototype.GetContinuousPhysics);box2d.b2World.prototype.SetSubStepping=function(b){this.m_subStepping=b};goog.exportProperty(box2d.b2World.prototype,"SetSubStepping",box2d.b2World.prototype.SetSubStepping);box2d.b2World.prototype.GetSubStepping=function(){return this.m_subStepping};goog.exportProperty(box2d.b2World.prototype,"GetSubStepping",box2d.b2World.prototype.GetSubStepping);box2d.b2World.prototype.GetBodyList=function(){return this.m_bodyList};goog.exportProperty(box2d.b2World.prototype,"GetBodyList",box2d.b2World.prototype.GetBodyList);box2d.b2World.prototype.GetJointList=function(){return this.m_jointList};goog.exportProperty(box2d.b2World.prototype,"GetJointList",box2d.b2World.prototype.GetJointList);box2d.b2World.prototype.GetContactList=function(){return this.m_contactManager.m_contactList};goog.exportProperty(box2d.b2World.prototype,"GetContactList",box2d.b2World.prototype.GetContactList);box2d.b2World.prototype.GetBodyCount=function(){return this.m_bodyCount};goog.exportProperty(box2d.b2World.prototype,"GetBodyCount",box2d.b2World.prototype.GetBodyCount);box2d.b2World.prototype.GetJointCount=function(){return this.m_jointCount};goog.exportProperty(box2d.b2World.prototype,"GetJointCount",box2d.b2World.prototype.GetJointCount);box2d.b2World.prototype.GetContactCount=function(){return this.m_contactManager.m_contactCount};goog.exportProperty(box2d.b2World.prototype,"GetContactCount",box2d.b2World.prototype.GetContactCount);box2d.b2World.prototype.SetGravity=function(e,d){d=d||!0;if(this.m_gravity.x!==e.x||this.m_gravity.y!==e.y){if(this.m_gravity.Copy(e),d){for(var f=this.m_bodyList;f;f=f.m_next){f.SetAwake(!0)}}}};goog.exportProperty(box2d.b2World.prototype,"SetGravity",box2d.b2World.prototype.SetGravity);box2d.b2World.prototype.GetGravity=function(b){b=b||this.m_out_gravity;return b.Copy(this.m_gravity)};goog.exportProperty(box2d.b2World.prototype,"GetGravity",box2d.b2World.prototype.GetGravity);box2d.b2World.prototype.IsLocked=function(){return 0<(this.m_flags&box2d.b2WorldFlag.e_locked)};goog.exportProperty(box2d.b2World.prototype,"IsLocked",box2d.b2World.prototype.IsLocked);box2d.b2World.prototype.SetAutoClearForces=function(b){this.m_flags=b?this.m_flags|box2d.b2WorldFlag.e_clearForces:this.m_flags&~box2d.b2WorldFlag.e_clearForces};goog.exportProperty(box2d.b2World.prototype,"SetAutoClearForces",box2d.b2World.prototype.SetAutoClearForces);box2d.b2World.prototype.GetAutoClearForces=function(){return(this.m_flags&box2d.b2WorldFlag.e_clearForces)===box2d.b2WorldFlag.e_clearForces};goog.exportProperty(box2d.b2World.prototype,"GetAutoClearForces",box2d.b2World.prototype.GetAutoClearForces);box2d.b2World.prototype.GetContactManager=function(){return this.m_contactManager};goog.exportProperty(box2d.b2World.prototype,"GetContactManager",box2d.b2World.prototype.GetContactManager);box2d.b2World.prototype.GetProfile=function(){return this.m_profile};goog.exportProperty(box2d.b2World.prototype,"GetProfile",box2d.b2World.prototype.GetProfile);box2d.b2World.prototype.SetDestructionListener=function(b){this.m_destructionListener=b};goog.exportProperty(box2d.b2World.prototype,"SetDestructionListener",box2d.b2World.prototype.SetDestructionListener);box2d.b2World.prototype.SetContactFilter=function(b){this.m_contactManager.m_contactFilter=b};goog.exportProperty(box2d.b2World.prototype,"SetContactFilter",box2d.b2World.prototype.SetContactFilter);box2d.b2World.prototype.SetContactListener=function(b){this.m_contactManager.m_contactListener=b};goog.exportProperty(box2d.b2World.prototype,"SetContactListener",box2d.b2World.prototype.SetContactListener);box2d.b2World.prototype.SetDebugDraw=function(b){this.m_debugDraw=b};goog.exportProperty(box2d.b2World.prototype,"SetDebugDraw",box2d.b2World.prototype.SetDebugDraw);box2d.b2World.prototype.CreateBody=function(b){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1===this.IsLocked());if(this.IsLocked()){return null}b=new box2d.b2Body(b,this);b.m_prev=null;if(b.m_next=this.m_bodyList){this.m_bodyList.m_prev=b}this.m_bodyList=b;++this.m_bodyCount;return b};goog.exportProperty(box2d.b2World.prototype,"CreateBody",box2d.b2World.prototype.CreateBody);box2d.b2World.prototype.DestroyBody=function(e){box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<this.m_bodyCount);box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1===this.IsLocked());if(!this.IsLocked()){for(var d=e.m_jointList;d;){var f=d,d=d.next;this.m_destructionListener&&this.m_destructionListener.SayGoodbyeJoint(f.joint);this.DestroyJoint(f.joint);e.m_jointList=d}e.m_jointList=null;for(d=e.m_controllerList;d;){f=d,d=d.nextController,f.controller.RemoveBody(e)}for(d=e.m_contactList;d;){f=d,d=d.next,this.m_contactManager.Destroy(f.contact)}e.m_contactList=null;for(d=e.m_fixtureList;d;){f=d,d=d.m_next,this.m_destructionListener&&this.m_destructionListener.SayGoodbyeFixture(f),f.DestroyProxies(this.m_contactManager.m_broadPhase),f.Destroy(),e.m_fixtureList=d,--e.m_fixtureCount}e.m_fixtureList=null;e.m_fixtureCount=0;e.m_prev&&(e.m_prev.m_next=e.m_next);e.m_next&&(e.m_next.m_prev=e.m_prev);e===this.m_bodyList&&(this.m_bodyList=e.m_next);--this.m_bodyCount}};goog.exportProperty(box2d.b2World.prototype,"DestroyBody",box2d.b2World.prototype.DestroyBody);box2d.b2World.prototype.CreateJoint=function(f){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1===this.IsLocked());if(this.IsLocked()){return null}var e=box2d.b2JointFactory.Create(f,null);e.m_prev=null;if(e.m_next=this.m_jointList){this.m_jointList.m_prev=e}this.m_jointList=e;++this.m_jointCount;e.m_edgeA.joint=e;e.m_edgeA.other=e.m_bodyB;e.m_edgeA.prev=null;if(e.m_edgeA.next=e.m_bodyA.m_jointList){e.m_bodyA.m_jointList.prev=e.m_edgeA}e.m_bodyA.m_jointList=e.m_edgeA;e.m_edgeB.joint=e;e.m_edgeB.other=e.m_bodyA;e.m_edgeB.prev=null;if(e.m_edgeB.next=e.m_bodyB.m_jointList){e.m_bodyB.m_jointList.prev=e.m_edgeB}e.m_bodyB.m_jointList=e.m_edgeB;var j=f.bodyA,g=f.bodyB;if(!1===f.collideConnected){for(f=g.GetContactList();f;){f.other===j&&f.contact.FlagForFiltering(),f=f.next}}return e};goog.exportProperty(box2d.b2World.prototype,"CreateJoint",box2d.b2World.prototype.CreateJoint);box2d.b2World.prototype.DestroyJoint=function(f){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1===this.IsLocked());if(!this.IsLocked()){var e=f.m_collideConnected;f.m_prev&&(f.m_prev.m_next=f.m_next);f.m_next&&(f.m_next.m_prev=f.m_prev);f===this.m_jointList&&(this.m_jointList=f.m_next);var j=f.m_bodyA,g=f.m_bodyB;j.SetAwake(!0);g.SetAwake(!0);f.m_edgeA.prev&&(f.m_edgeA.prev.next=f.m_edgeA.next);f.m_edgeA.next&&(f.m_edgeA.next.prev=f.m_edgeA.prev);f.m_edgeA===j.m_jointList&&(j.m_jointList=f.m_edgeA.next);f.m_edgeA.prev=null;f.m_edgeA.next=null;f.m_edgeB.prev&&(f.m_edgeB.prev.next=f.m_edgeB.next);f.m_edgeB.next&&(f.m_edgeB.next.prev=f.m_edgeB.prev);f.m_edgeB===g.m_jointList&&(g.m_jointList=f.m_edgeB.next);f.m_edgeB.prev=null;f.m_edgeB.next=null;box2d.b2JointFactory.Destroy(f,null);box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<this.m_jointCount);--this.m_jointCount;if(!1===e){for(f=g.GetContactList();f;){f.other===j&&f.contact.FlagForFiltering(),f=f.next}}}};goog.exportProperty(box2d.b2World.prototype,"DestroyJoint",box2d.b2World.prototype.DestroyJoint);box2d.b2World.prototype.Solve=function(z){for(var y=this.m_controllerList;y;y=y.m_next){y.Step(z)}this.m_profile.solveInit=0;this.m_profile.solveVelocity=0;this.m_profile.solvePosition=0;y=this.m_island;y.Initialize(this.m_bodyCount,this.m_contactManager.m_contactCount,this.m_jointCount,null,this.m_contactManager.m_contactListener);for(var v=this.m_bodyList;v;v=v.m_next){v.m_flags&=~box2d.b2BodyFlag.e_islandFlag}for(var u=this.m_contactManager.m_contactList;u;u=u.m_next){u.m_flags&=~box2d.b2ContactFlag.e_islandFlag}for(u=this.m_jointList;u;u=u.m_next){u.m_islandFlag=!1}for(var u=this.m_bodyCount,s=this.s_stack,r=this.m_bodyList;r;r=r.m_next){if(!(r.m_flags&box2d.b2BodyFlag.e_islandFlag)&&!1!==r.IsAwake()&&!1!==r.IsActive()&&r.GetType()!==box2d.b2BodyType.b2_staticBody){y.Clear();var q=0;s[q++]=r;for(r.m_flags|=box2d.b2BodyFlag.e_islandFlag;0<q;){if(v=s[--q],box2d.ENABLE_ASSERTS&&box2d.b2Assert(!0===v.IsActive()),y.AddBody(v),v.SetAwake(!0),v.GetType()!==box2d.b2BodyType.b2_staticBody){for(var n=v.m_contactList;n;n=n.next){var j=n.contact;if(!(j.m_flags&box2d.b2ContactFlag.e_islandFlag)&&!1!==j.IsEnabled()&&!1!==j.IsTouching()){var m=j.m_fixtureB.m_isSensor;j.m_fixtureA.m_isSensor||m||(y.AddContact(j),j.m_flags|=box2d.b2ContactFlag.e_islandFlag,j=n.other,j.m_flags&box2d.b2BodyFlag.e_islandFlag||(box2d.ENABLE_ASSERTS&&box2d.b2Assert(q<u),s[q++]=j,j.m_flags|=box2d.b2BodyFlag.e_islandFlag))}}for(v=v.m_jointList;v;v=v.next){!0!==v.joint.m_islandFlag&&(j=v.other,!1!==j.IsActive()&&(y.AddJoint(v.joint),v.joint.m_islandFlag=!0,j.m_flags&box2d.b2BodyFlag.e_islandFlag||(box2d.ENABLE_ASSERTS&&box2d.b2Assert(q<u),s[q++]=j,j.m_flags|=box2d.b2BodyFlag.e_islandFlag)))}}}v=new box2d.b2Profile;y.Solve(v,z,this.m_gravity,this.m_allowSleep);this.m_profile.solveInit+=v.solveInit;this.m_profile.solveVelocity+=v.solveVelocity;this.m_profile.solvePosition+=v.solvePosition;for(q=0;q<y.m_bodyCount;++q){v=y.m_bodies[q],v.GetType()===box2d.b2BodyType.b2_staticBody&&(v.m_flags&=~box2d.b2BodyFlag.e_islandFlag)}}}for(q=0;q<s.length&&s[q];++q){s[q]=null}z=new box2d.b2Timer;for(v=this.m_bodyList;v;v=v.m_next){0!==(v.m_flags&box2d.b2BodyFlag.e_islandFlag)&&v.GetType()!==box2d.b2BodyType.b2_staticBody&&v.SynchronizeFixtures()}this.m_contactManager.FindNewContacts();this.m_profile.broadphase=z.GetMilliseconds()};goog.exportProperty(box2d.b2World.prototype,"Solve",box2d.b2World.prototype.Solve);box2d.b2World.prototype.SolveTOI=function(E){var D=this.m_island;D.Initialize(2*box2d.b2_maxTOIContacts,box2d.b2_maxTOIContacts,0,null,this.m_contactManager.m_contactListener);if(this.m_stepComplete){for(var C=this.m_bodyList;C;C=C.m_next){C.m_flags&=~box2d.b2BodyFlag.e_islandFlag,C.m_sweep.alpha0=0}for(var B=this.m_contactManager.m_contactList;B;B=B.m_next){B.m_flags&=~(box2d.b2ContactFlag.e_toiFlag|box2d.b2ContactFlag.e_islandFlag),B.m_toiCount=0,B.m_toi=1}}for(;;){for(var A=null,C=1,B=this.m_contactManager.m_contactList;B;B=B.m_next){if(!1!==B.IsEnabled()&&!(B.m_toiCount>box2d.b2_maxSubSteps)){var z=1;if(B.m_flags&box2d.b2ContactFlag.e_toiFlag){z=B.m_toi}else{var y=B.GetFixtureA(),v=B.GetFixtureB();if(y.IsSensor()||v.IsSensor()){continue}var z=y.GetBody(),s=v.GetBody(),u=z.m_type,r=s.m_type;box2d.ENABLE_ASSERTS&&box2d.b2Assert(u===box2d.b2BodyType.b2_dynamicBody||r===box2d.b2BodyType.b2_dynamicBody);var q=z.IsAwake()&&u!==box2d.b2BodyType.b2_staticBody,j=s.IsAwake()&&r!==box2d.b2BodyType.b2_staticBody;if(!1===q&&!1===j){continue}u=z.IsBullet()||u!==box2d.b2BodyType.b2_dynamicBody;r=s.IsBullet()||r!==box2d.b2BodyType.b2_dynamicBody;if(!1===u&&!1===r){continue}r=z.m_sweep.alpha0;z.m_sweep.alpha0<s.m_sweep.alpha0?(r=s.m_sweep.alpha0,z.m_sweep.Advance(r)):s.m_sweep.alpha0<z.m_sweep.alpha0&&(r=z.m_sweep.alpha0,s.m_sweep.Advance(r));box2d.ENABLE_ASSERTS&&box2d.b2Assert(1>r);q=B.GetChildIndexA();j=B.GetChildIndexB();u=box2d.b2World.prototype.SolveTOI.s_toi_input;u.proxyA.SetShape(y.GetShape(),q);u.proxyB.SetShape(v.GetShape(),j);u.sweepA.Copy(z.m_sweep);u.sweepB.Copy(s.m_sweep);u.tMax=1;z=box2d.b2World.prototype.SolveTOI.s_toi_output;box2d.b2TimeOfImpact(z,u);s=z.t;z=z.state===box2d.b2TOIOutputState.e_touching?box2d.b2Min(r+(1-r)*s,1):1;B.m_toi=z;B.m_flags|=box2d.b2ContactFlag.e_toiFlag}z<C&&(A=B,C=z)}}if(null===A||1-10*box2d.b2_epsilon<C){this.m_stepComplete=!0;break}y=A.GetFixtureA();v=A.GetFixtureB();z=y.GetBody();s=v.GetBody();B=box2d.b2World.prototype.SolveTOI.s_backup1.Copy(z.m_sweep);y=box2d.b2World.prototype.SolveTOI.s_backup2.Copy(s.m_sweep);z.Advance(C);s.Advance(C);A.Update(this.m_contactManager.m_contactListener);A.m_flags&=~box2d.b2ContactFlag.e_toiFlag;++A.m_toiCount;if(!1===A.IsEnabled()||!1===A.IsTouching()){A.SetEnabled(!1),z.m_sweep.Copy(B),s.m_sweep.Copy(y),z.SynchronizeTransform(),s.SynchronizeTransform()}else{z.SetAwake(!0);s.SetAwake(!0);D.Clear();D.AddBody(z);D.AddBody(s);D.AddContact(A);z.m_flags|=box2d.b2BodyFlag.e_islandFlag;s.m_flags|=box2d.b2BodyFlag.e_islandFlag;A.m_flags|=box2d.b2ContactFlag.e_islandFlag;for(A=0;2>A;++A){if(B=0===A?z:s,B.m_type===box2d.b2BodyType.b2_dynamicBody){for(y=B.m_contactList;y&&D.m_bodyCount!==D.m_bodyCapacity&&D.m_contactCount!==D.m_contactCapacity;y=y.next){v=y.contact,v.m_flags&box2d.b2ContactFlag.e_islandFlag||(r=y.other,r.m_type===box2d.b2BodyType.b2_dynamicBody&&!1===B.IsBullet()&&!1===r.IsBullet())||(u=v.m_fixtureB.m_isSensor,v.m_fixtureA.m_isSensor||u||(u=box2d.b2World.prototype.SolveTOI.s_backup.Copy(r.m_sweep),0===(r.m_flags&box2d.b2BodyFlag.e_islandFlag)&&r.Advance(C),v.Update(this.m_contactManager.m_contactListener),!1===v.IsEnabled()?(r.m_sweep.Copy(u),r.SynchronizeTransform()):!1===v.IsTouching()?(r.m_sweep.Copy(u),r.SynchronizeTransform()):(v.m_flags|=box2d.b2ContactFlag.e_islandFlag,D.AddContact(v),r.m_flags&box2d.b2BodyFlag.e_islandFlag||(r.m_flags|=box2d.b2BodyFlag.e_islandFlag,r.m_type!==box2d.b2BodyType.b2_staticBody&&r.SetAwake(!0),D.AddBody(r)))))}}}A=box2d.b2World.prototype.SolveTOI.s_subStep;A.dt=(1-C)*E.dt;A.inv_dt=1/A.dt;A.dtRatio=1;A.positionIterations=20;A.velocityIterations=E.velocityIterations;A.warmStarting=!1;D.SolveTOI(A,z.m_islandIndex,s.m_islandIndex);for(A=0;A<D.m_bodyCount;++A){if(B=D.m_bodies[A],B.m_flags&=~box2d.b2BodyFlag.e_islandFlag,B.m_type===box2d.b2BodyType.b2_dynamicBody){for(B.SynchronizeFixtures(),y=B.m_contactList;y;y=y.next){y.contact.m_flags&=~(box2d.b2ContactFlag.e_toiFlag|box2d.b2ContactFlag.e_islandFlag)}}}this.m_contactManager.FindNewContacts();if(this.m_subStepping){this.m_stepComplete=!1;break}}}};goog.exportProperty(box2d.b2World.prototype,"SolveTOI",box2d.b2World.prototype.SolveTOI);box2d.b2World.prototype.SolveTOI.s_subStep=new box2d.b2TimeStep;box2d.b2World.prototype.SolveTOI.s_backup=new box2d.b2Sweep;box2d.b2World.prototype.SolveTOI.s_backup1=new box2d.b2Sweep;box2d.b2World.prototype.SolveTOI.s_backup2=new box2d.b2Sweep;box2d.b2World.prototype.SolveTOI.s_toi_input=new box2d.b2TOIInput;box2d.b2World.prototype.SolveTOI.s_toi_output=new box2d.b2TOIOutput;box2d.b2World.prototype.Step=function(g,f,m){var k=new box2d.b2Timer;this.m_flags&box2d.b2WorldFlag.e_newFixture&&(this.m_contactManager.FindNewContacts(),this.m_flags&=~box2d.b2WorldFlag.e_newFixture);this.m_flags|=box2d.b2WorldFlag.e_locked;var j=box2d.b2World.prototype.Step.s_step;j.dt=g;j.velocityIterations=f;j.positionIterations=m;j.inv_dt=0<g?1/g:0;j.dtRatio=this.m_inv_dt0*g;j.warmStarting=this.m_warmStarting;g=new box2d.b2Timer;this.m_contactManager.Collide();this.m_profile.collide=g.GetMilliseconds();this.m_stepComplete&&0<j.dt&&(g=new box2d.b2Timer,this.Solve(j),this.m_profile.solve=g.GetMilliseconds());this.m_continuousPhysics&&0<j.dt&&(g=new box2d.b2Timer,this.SolveTOI(j),this.m_profile.solveTOI=g.GetMilliseconds());0<j.dt&&(this.m_inv_dt0=j.inv_dt);this.m_flags&box2d.b2WorldFlag.e_clearForces&&this.ClearForces();this.m_flags&=~box2d.b2WorldFlag.e_locked;this.m_profile.step=k.GetMilliseconds()};goog.exportProperty(box2d.b2World.prototype,"Step",box2d.b2World.prototype.Step);box2d.b2World.prototype.Step.s_step=new box2d.b2TimeStep;box2d.b2World.prototype.ClearForces=function(){for(var b=this.m_bodyList;b;b=b.m_next){b.m_force.SetZero(),b.m_torque=0}};goog.exportProperty(box2d.b2World.prototype,"ClearForces",box2d.b2World.prototype.ClearForces);box2d.b2World.prototype.QueryAABB=function(e,d){var f=this.m_contactManager.m_broadPhase;f.Query(function(a){a=f.GetUserData(a);box2d.ENABLE_ASSERTS&&box2d.b2Assert(a instanceof box2d.b2FixtureProxy);a=a.fixture;return e instanceof box2d.b2QueryCallback?e.ReportFixture(a):e(a)},d)};goog.exportProperty(box2d.b2World.prototype,"QueryAABB",box2d.b2World.prototype.QueryAABB);box2d.b2World.prototype.QueryShape=function(g,f,m){var k=this.m_contactManager.m_broadPhase,j=box2d.b2World.prototype.QueryShape.s_aabb;f.ComputeAABB(j,m,0);k.Query(function(a){a=k.GetUserData(a);box2d.ENABLE_ASSERTS&&box2d.b2Assert(a instanceof box2d.b2FixtureProxy);a=a.fixture;return box2d.b2TestOverlapShape(f,0,a.GetShape(),0,m,a.GetBody().GetTransform())?g instanceof box2d.b2QueryCallback?g.ReportFixture(a):g(a):!0},j)};goog.exportProperty(box2d.b2World.prototype,"QueryShape",box2d.b2World.prototype.QueryShape);box2d.b2World.prototype.QueryShape.s_aabb=new box2d.b2AABB;box2d.b2World.prototype.QueryPoint=function(f,e){var j=this.m_contactManager.m_broadPhase,g=box2d.b2World.prototype.QueryPoint.s_aabb;g.lowerBound.SetXY(e.x-box2d.b2_linearSlop,e.y-box2d.b2_linearSlop);g.upperBound.SetXY(e.x+box2d.b2_linearSlop,e.y+box2d.b2_linearSlop);j.Query(function(a){a=j.GetUserData(a);box2d.ENABLE_ASSERTS&&box2d.b2Assert(a instanceof box2d.b2FixtureProxy);a=a.fixture;return a.TestPoint(e)?f instanceof box2d.b2QueryCallback?f.ReportFixture(a):f(a):!0},g)};goog.exportProperty(box2d.b2World.prototype,"QueryPoint",box2d.b2World.prototype.QueryPoint);box2d.b2World.prototype.QueryPoint.s_aabb=new box2d.b2AABB;box2d.b2World.prototype.RayCast=function(g,f,m){var k=this.m_contactManager.m_broadPhase,j=box2d.b2World.prototype.RayCast.s_input;j.maxFraction=1;j.p1.Copy(f);j.p2.Copy(m);k.RayCast(function(r,q){var n=k.GetUserData(q);box2d.ENABLE_ASSERTS&&box2d.b2Assert(n instanceof box2d.b2FixtureProxy);var b=n.fixture,d=box2d.b2World.prototype.RayCast.s_output;if(b.RayCast(d,r,n.childIndex)){var n=d.fraction,a=box2d.b2World.prototype.RayCast.s_point;a.SetXY((1-n)*f.x+n*m.x,(1-n)*f.y+n*m.y);return g instanceof box2d.b2RayCastCallback?g.ReportFixture(b,a,d.normal,n):g(b,a,d.normal,n)}return r.maxFraction},j)};goog.exportProperty(box2d.b2World.prototype,"RayCast",box2d.b2World.prototype.RayCast);box2d.b2World.prototype.RayCast.s_input=new box2d.b2RayCastInput;box2d.b2World.prototype.RayCast.s_output=new box2d.b2RayCastOutput;box2d.b2World.prototype.RayCast.s_point=new box2d.b2Vec2;box2d.b2World.prototype.RayCastOne=function(f,e){var j=null,g=1;this.RayCast(function(k,d,n,m){m<g&&(g=m,j=k);return g},f,e);return j};goog.exportProperty(box2d.b2World.prototype,"RayCastOne",box2d.b2World.prototype.RayCastOne);box2d.b2World.prototype.RayCastAll=function(e,d,f){f.length=0;this.RayCast(function(k,j,n,m){f.push(k);return 1},e,d);return f};goog.exportProperty(box2d.b2World.prototype,"RayCastAll",box2d.b2World.prototype.RayCastAll);box2d.b2World.prototype.DrawShape=function(k,j){var s=k.GetShape();switch(s.m_type){case box2d.b2ShapeType.e_circleShape:s=s instanceof box2d.b2CircleShape?s:null;this.m_debugDraw.DrawSolidCircle(s.m_p,s.m_radius,box2d.b2Vec2.UNITX,j);break;case box2d.b2ShapeType.e_edgeShape:var r=s instanceof box2d.b2EdgeShape?s:null,s=r.m_vertex1,q=r.m_vertex2;this.m_debugDraw.DrawSegment(s,q,j);break;case box2d.b2ShapeType.e_chainShape:var s=s instanceof box2d.b2ChainShape?s:null,r=s.m_count,n=s.m_vertices,s=n[0];this.m_debugDraw.DrawCircle(s,0.05,j);for(var m=1;m<r;++m){q=n[m],this.m_debugDraw.DrawSegment(s,q,j),this.m_debugDraw.DrawCircle(q,0.05,j),s=q}break;case box2d.b2ShapeType.e_polygonShape:r=s instanceof box2d.b2PolygonShape?s:null,s=r.m_count,n=r.m_vertices,this.m_debugDraw.DrawSolidPolygon(n,s,j)}};goog.exportProperty(box2d.b2World.prototype,"DrawShape",box2d.b2World.prototype.DrawShape);box2d.b2World.prototype.DrawJoint=function(j){var g=j.GetBodyA(),q=j.GetBodyB(),n=g.m_xf.p,m=q.m_xf.p,q=j.GetAnchorA(box2d.b2World.prototype.DrawJoint.s_p1),g=j.GetAnchorB(box2d.b2World.prototype.DrawJoint.s_p2),k=box2d.b2World.prototype.DrawJoint.s_color.SetRGB(0.5,0.8,0.8);switch(j.m_type){case box2d.b2JointType.e_distanceJoint:this.m_debugDraw.DrawSegment(q,g,k);break;case box2d.b2JointType.e_pulleyJoint:n=j instanceof box2d.b2PulleyJoint?j:null;j=n.GetGroundAnchorA(box2d.b2World.prototype.DrawJoint.s_s1);n=n.GetGroundAnchorB(box2d.b2World.prototype.DrawJoint.s_s2);this.m_debugDraw.DrawSegment(j,q,k);this.m_debugDraw.DrawSegment(n,g,k);this.m_debugDraw.DrawSegment(j,n,k);break;case box2d.b2JointType.e_mouseJoint:this.m_debugDraw.DrawSegment(q,g,k);break;default:this.m_debugDraw.DrawSegment(n,q,k),this.m_debugDraw.DrawSegment(q,g,k),this.m_debugDraw.DrawSegment(m,g,k)}};goog.exportProperty(box2d.b2World.prototype,"DrawJoint",box2d.b2World.prototype.DrawJoint);box2d.b2World.prototype.DrawJoint.s_p1=new box2d.b2Vec2;box2d.b2World.prototype.DrawJoint.s_p2=new box2d.b2Vec2;box2d.b2World.prototype.DrawJoint.s_color=new box2d.b2Color(0.5,0.8,0.8);box2d.b2World.prototype.DrawJoint.s_s1=new box2d.b2Vec2;box2d.b2World.prototype.DrawJoint.s_s2=new box2d.b2Vec2;box2d.b2World.prototype.DrawDebugData=function(){if(null!==this.m_debugDraw){var k=this.m_debugDraw.GetFlags(),j=box2d.b2World.prototype.DrawDebugData.s_color.SetRGB(0,0,0);if(k&box2d.b2DrawFlags.e_shapeBit){for(var u=this.m_bodyList;u;u=u.m_next){var s=u.m_xf;this.m_debugDraw.PushTransform(s);for(var r=u.GetFixtureList();r;r=r.m_next){!1===u.IsActive()?j.SetRGB(0.5,0.5,0.3):u.GetType()===box2d.b2BodyType.b2_staticBody?j.SetRGB(0.5,0.9,0.5):u.GetType()===box2d.b2BodyType.b2_kinematicBody?j.SetRGB(0.5,0.5,0.9):!1===u.IsAwake()?j.SetRGB(0.6,0.6,0.6):j.SetRGB(0.9,0.7,0.7),this.DrawShape(r,j)}this.m_debugDraw.PopTransform(s)}}if(k&box2d.b2DrawFlags.e_jointBit){for(u=this.m_jointList;u;u=u.m_next){this.DrawJoint(u)}}if(k&box2d.b2DrawFlags.e_aabbBit){j.SetRGB(0.9,0.3,0.9);for(var s=this.m_contactManager.m_broadPhase,q=box2d.b2World.prototype.DrawDebugData.s_vs,u=this.m_bodyList;u;u=u.m_next){if(!1!==u.IsActive()){for(r=u.GetFixtureList();r;r=r.m_next){for(var n=0;n<r.m_proxyCount;++n){var m=s.GetFatAABB(r.m_proxies[n].proxy);q[0].SetXY(m.lowerBound.x,m.lowerBound.y);q[1].SetXY(m.upperBound.x,m.lowerBound.y);q[2].SetXY(m.upperBound.x,m.upperBound.y);q[3].SetXY(m.lowerBound.x,m.upperBound.y);this.m_debugDraw.DrawPolygon(q,4,j)}}}}}if(k&box2d.b2DrawFlags.e_centerOfMassBit){for(u=this.m_bodyList;u;u=u.m_next){s=box2d.b2World.prototype.DrawDebugData.s_xf,s.q.Copy(u.m_xf.q),s.p.Copy(u.GetWorldCenter()),this.m_debugDraw.DrawTransform(s)}}if(k&box2d.b2DrawFlags.e_controllerBit){for(k=this.m_controllerList;k;k=k.m_next){k.Draw(this.m_debugDraw)}}}};goog.exportProperty(box2d.b2World.prototype,"DrawDebugData",box2d.b2World.prototype.DrawDebugData);box2d.b2World.prototype.DrawDebugData.s_color=new box2d.b2Color(0,0,0);box2d.b2World.prototype.DrawDebugData.s_vs=box2d.b2Vec2.MakeArray(4);box2d.b2World.prototype.DrawDebugData.s_xf=new box2d.b2Transform;box2d.b2World.prototype.SetBroadPhase=function(f){var e=this.m_contactManager.m_broadPhase;this.m_contactManager.m_broadPhase=f;for(var j=this.m_bodyList;j;j=j.m_next){for(var g=j.m_fixtureList;g;g=g.m_next){g.m_proxy=f.CreateProxy(e.GetFatAABB(g.m_proxy),g)}}};goog.exportProperty(box2d.b2World.prototype,"SetBroadPhase",box2d.b2World.prototype.SetBroadPhase);box2d.b2World.prototype.GetProxyCount=function(){return this.m_contactManager.m_broadPhase.GetProxyCount()};goog.exportProperty(box2d.b2World.prototype,"GetProxyCount",box2d.b2World.prototype.GetProxyCount);box2d.b2World.prototype.GetTreeHeight=function(){return this.m_contactManager.m_broadPhase.GetTreeHeight()};goog.exportProperty(box2d.b2World.prototype,"GetTreeHeight",box2d.b2World.prototype.GetTreeHeight);box2d.b2World.prototype.GetTreeBalance=function(){return this.m_contactManager.m_broadPhase.GetTreeBalance()};goog.exportProperty(box2d.b2World.prototype,"GetTreeBalance",box2d.b2World.prototype.GetTreeBalance);box2d.b2World.prototype.GetTreeQuality=function(){return this.m_contactManager.m_broadPhase.GetTreeQuality()};goog.exportProperty(box2d.b2World.prototype,"GetTreeQuality",box2d.b2World.prototype.GetTreeQuality);box2d.b2World.prototype.ShiftOrigin=function(e){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1===this.IsLocked());if(!this.IsLocked()){for(var d=this.m_bodyList;d;d=d.m_next){d.m_xf.p.SelfSub(e),d.m_sweep.c0.SelfSub(e),d.m_sweep.c.SelfSub(e)}for(d=this.m_jointList;d;d=d.m_next){d.ShiftOrigin(e)}this.m_contactManager.m_broadPhase.ShiftOrigin(e)}};goog.exportProperty(box2d.b2World.prototype,"ShiftOrigin",box2d.b2World.prototype.ShiftOrigin);box2d.b2World.prototype.Dump=function(){if(box2d.DEBUG&&(this.m_flags&box2d.b2WorldFlag.e_locked)!==box2d.b2WorldFlag.e_locked){box2d.b2Log("/** @type {box2d.b2Vec2} */ var g = new box2d.b2Vec2(%.15f, %.15f);\n",this.m_gravity.x,this.m_gravity.y);box2d.b2Log("this.m_world.SetGravity(g);\n");box2d.b2Log("/** @type {Array.<box2d.b2Body>} */ var bodies = new Array(%d);\n",this.m_bodyCount);box2d.b2Log("/** @type {Array.<box2d.b2Joint>} */ var joints = new Array(%d);\n",this.m_jointCount);for(var e=0,d=this.m_bodyList;d;d=d.m_next){d.m_islandIndex=e,d.Dump(),++e}e=0;for(d=this.m_jointList;d;d=d.m_next){d.m_index=e,++e}for(d=this.m_jointList;d;d=d.m_next){d.m_type!==box2d.b2JointType.e_gearJoint&&(box2d.b2Log("if (true)\n"),box2d.b2Log("{\n"),d.Dump(),box2d.b2Log("}\n"))}for(d=this.m_jointList;d;d=d.m_next){d.m_type===box2d.b2JointType.e_gearJoint&&(box2d.b2Log("if (true)\n"),box2d.b2Log("{\n"),d.Dump(),box2d.b2Log("}\n"))}}};goog.exportProperty(box2d.b2World.prototype,"Dump",box2d.b2World.prototype.Dump);box2d.b2World.prototype.AddController=function(b){box2d.ENABLE_ASSERTS&&box2d.b2Assert(null===b.m_world,"Controller can only be a member of one world");b.m_world=this;b.m_next=this.m_controllerList;b.m_prev=null;this.m_controllerList&&(this.m_controllerList.m_prev=b);this.m_controllerList=b;++this.m_controllerCount;return b};goog.exportProperty(box2d.b2World.prototype,"AddController",box2d.b2World.prototype.AddController);box2d.b2World.prototype.RemoveController=function(b){box2d.ENABLE_ASSERTS&&box2d.b2Assert(b.m_world===this,"Controller is not a member of this world");b.m_prev&&(b.m_prev.m_next=b.m_next);b.m_next&&(b.m_next.m_prev=b.m_prev);this.m_controllerList===b&&(this.m_controllerList=b.m_next);--this.m_controllerCount;b.m_prev=null;b.m_next=null;b.m_world=null};goog.exportProperty(box2d.b2World.prototype,"RemoveController",box2d.b2World.prototype.RemoveController);box2d.b2MotorJointDef=function(){box2d.b2JointDef.call(this,box2d.b2JointType.e_motorJoint);this.linearOffset=new box2d.b2Vec2(0,0)};goog.inherits(box2d.b2MotorJointDef,box2d.b2JointDef);goog.exportSymbol("box2d.b2MotorJointDef",box2d.b2MotorJointDef);box2d.b2MotorJointDef.prototype.linearOffset=null;goog.exportProperty(box2d.b2MotorJointDef.prototype,"linearOffset",box2d.b2MotorJointDef.prototype.linearOffset);box2d.b2MotorJointDef.prototype.angularOffset=0;goog.exportProperty(box2d.b2MotorJointDef.prototype,"angularOffset",box2d.b2MotorJointDef.prototype.angularOffset);box2d.b2MotorJointDef.prototype.maxForce=1;goog.exportProperty(box2d.b2MotorJointDef.prototype,"maxForce",box2d.b2MotorJointDef.prototype.maxForce);box2d.b2MotorJointDef.prototype.maxTorque=1;goog.exportProperty(box2d.b2MotorJointDef.prototype,"maxTorque",box2d.b2MotorJointDef.prototype.maxTorque);box2d.b2MotorJointDef.prototype.correctionFactor=0.3;goog.exportProperty(box2d.b2MotorJointDef.prototype,"correctionFactor",box2d.b2MotorJointDef.prototype.correctionFactor);box2d.b2MotorJointDef.prototype.Initialize=function(e,d){this.bodyA=e;this.bodyB=d;this.bodyA.GetLocalPoint(this.bodyB.GetPosition(),this.linearOffset);var f=this.bodyA.GetAngleRadians();this.angularOffset=this.bodyB.GetAngleRadians()-f};goog.exportProperty(box2d.b2MotorJointDef.prototype,"Initialize",box2d.b2MotorJointDef.prototype.Initialize);box2d.b2MotorJoint=function(b){box2d.b2Joint.call(this,b);this.m_linearOffset=b.linearOffset.Clone();this.m_linearImpulse=new box2d.b2Vec2(0,0);this.m_maxForce=b.maxForce;this.m_maxTorque=b.maxTorque;this.m_correctionFactor=b.correctionFactor;this.m_rA=new box2d.b2Vec2(0,0);this.m_rB=new box2d.b2Vec2(0,0);this.m_localCenterA=new box2d.b2Vec2(0,0);this.m_localCenterB=new box2d.b2Vec2(0,0);this.m_linearError=new box2d.b2Vec2(0,0);this.m_linearMass=new box2d.b2Mat22;this.m_qA=new box2d.b2Rot;this.m_qB=new box2d.b2Rot;this.m_K=new box2d.b2Mat22};goog.inherits(box2d.b2MotorJoint,box2d.b2Joint);goog.exportSymbol("box2d.b2MotorJoint",box2d.b2MotorJoint);box2d.b2MotorJoint.prototype.m_linearOffset=null;goog.exportProperty(box2d.b2MotorJoint.prototype,"m_linearOffset",box2d.b2MotorJoint.prototype.m_linearOffset);box2d.b2MotorJoint.prototype.m_angularOffset=0;goog.exportProperty(box2d.b2MotorJoint.prototype,"m_angularOffset",box2d.b2MotorJoint.prototype.m_angularOffset);box2d.b2MotorJoint.prototype.m_linearImpulse=null;goog.exportProperty(box2d.b2MotorJoint.prototype,"m_linearImpulse",box2d.b2MotorJoint.prototype.m_linearImpulse);box2d.b2MotorJoint.prototype.m_angularImpulse=0;goog.exportProperty(box2d.b2MotorJoint.prototype,"m_angularImpulse",box2d.b2MotorJoint.prototype.m_angularImpulse);box2d.b2MotorJoint.prototype.m_maxForce=0;goog.exportProperty(box2d.b2MotorJoint.prototype,"m_maxForce",box2d.b2MotorJoint.prototype.m_maxForce);box2d.b2MotorJoint.prototype.m_maxTorque=0;goog.exportProperty(box2d.b2MotorJoint.prototype,"m_maxTorque",box2d.b2MotorJoint.prototype.m_maxTorque);box2d.b2MotorJoint.prototype.m_correctionFactor=0.3;goog.exportProperty(box2d.b2MotorJoint.prototype,"m_correctionFactor",box2d.b2MotorJoint.prototype.m_correctionFactor);box2d.b2MotorJoint.prototype.m_indexA=0;goog.exportProperty(box2d.b2MotorJoint.prototype,"m_indexA",box2d.b2MotorJoint.prototype.m_indexA);box2d.b2MotorJoint.prototype.m_indexB=0;goog.exportProperty(box2d.b2MotorJoint.prototype,"m_indexB",box2d.b2MotorJoint.prototype.m_indexB);box2d.b2MotorJoint.prototype.m_rA=null;goog.exportProperty(box2d.b2MotorJoint.prototype,"m_rA",box2d.b2MotorJoint.prototype.m_rA);box2d.b2MotorJoint.prototype.m_rB=null;goog.exportProperty(box2d.b2MotorJoint.prototype,"m_rB",box2d.b2MotorJoint.prototype.m_rB);box2d.b2MotorJoint.prototype.m_localCenterA=null;goog.exportProperty(box2d.b2MotorJoint.prototype,"m_localCenterA",box2d.b2MotorJoint.prototype.m_localCenterA);box2d.b2MotorJoint.prototype.m_localCenterB=null;goog.exportProperty(box2d.b2MotorJoint.prototype,"m_localCenterB",box2d.b2MotorJoint.prototype.m_localCenterB);box2d.b2MotorJoint.prototype.m_linearError=null;goog.exportProperty(box2d.b2MotorJoint.prototype,"m_linearError",box2d.b2MotorJoint.prototype.m_linearError);box2d.b2MotorJoint.prototype.m_angularError=0;goog.exportProperty(box2d.b2MotorJoint.prototype,"m_angularError",box2d.b2MotorJoint.prototype.m_angularError);box2d.b2MotorJoint.prototype.m_invMassA=0;goog.exportProperty(box2d.b2MotorJoint.prototype,"m_invMassA",box2d.b2MotorJoint.prototype.m_invMassA);box2d.b2MotorJoint.prototype.m_invMassB=0;goog.exportProperty(box2d.b2MotorJoint.prototype,"m_invMassB",box2d.b2MotorJoint.prototype.m_invMassB);box2d.b2MotorJoint.prototype.m_invIA=0;goog.exportProperty(box2d.b2MotorJoint.prototype,"m_invIA",box2d.b2MotorJoint.prototype.m_invIA);box2d.b2MotorJoint.prototype.m_invIB=0;goog.exportProperty(box2d.b2MotorJoint.prototype,"m_invIB",box2d.b2MotorJoint.prototype.m_invIB);box2d.b2MotorJoint.prototype.m_linearMass=null;goog.exportProperty(box2d.b2MotorJoint.prototype,"m_linearMass",box2d.b2MotorJoint.prototype.m_linearMass);box2d.b2MotorJoint.prototype.m_angularMass=0;goog.exportProperty(box2d.b2MotorJoint.prototype,"m_angularMass",box2d.b2MotorJoint.prototype.m_angularMass);box2d.b2MotorJoint.prototype.m_qA=null;goog.exportProperty(box2d.b2MotorJoint.prototype,"m_qA",box2d.b2MotorJoint.prototype.m_qA);box2d.b2MotorJoint.prototype.m_qB=null;goog.exportProperty(box2d.b2MotorJoint.prototype,"m_qB",box2d.b2MotorJoint.prototype.m_qB);box2d.b2MotorJoint.prototype.m_K=null;goog.exportProperty(box2d.b2MotorJoint.prototype,"m_K",box2d.b2MotorJoint.prototype.m_K);box2d.b2MotorJoint.prototype.GetAnchorA=function(b){return this.m_bodyA.GetPosition(b)};goog.exportProperty(box2d.b2MotorJoint.prototype,"GetAnchorA",box2d.b2MotorJoint.prototype.GetAnchorA);box2d.b2MotorJoint.prototype.GetAnchorB=function(b){return this.m_bodyB.GetPosition(b)};goog.exportProperty(box2d.b2MotorJoint.prototype,"GetAnchorB",box2d.b2MotorJoint.prototype.GetAnchorB);box2d.b2MotorJoint.prototype.GetReactionForce=function(e,d){return box2d.b2MulSV(e,this.m_linearImpulse,d)};goog.exportProperty(box2d.b2MotorJoint.prototype,"GetReactionForce",box2d.b2MotorJoint.prototype.GetReactionForce);box2d.b2MotorJoint.prototype.GetReactionTorque=function(b){return b*this.m_angularImpulse};goog.exportProperty(box2d.b2MotorJoint.prototype,"GetReactionTorque",box2d.b2MotorJoint.prototype.GetReactionTorque);box2d.b2MotorJoint.prototype.SetCorrectionFactor=function(b){box2d.ENABLE_ASSERTS&&box2d.b2Assert(box2d.b2IsValid(b)&&0<=b&&1>=b);this._correctionFactor=b};box2d.b2MotorJoint.prototype.GetCorrectionFactor=function(){return this.m_correctionFactor};box2d.b2MotorJoint.prototype.SetLinearOffset=function(b){box2d.b2IsEqualToV(b,this.m_linearOffset)||(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_linearOffset.Copy(b))};goog.exportProperty(box2d.b2MotorJoint.prototype,"SetLinearOffset",box2d.b2MotorJoint.prototype.SetLinearOffset);box2d.b2MotorJoint.prototype.GetLinearOffset=function(b){return b.Copy(this.m_linearOffset)};goog.exportProperty(box2d.b2MotorJoint.prototype,"GetLinearOffset",box2d.b2MotorJoint.prototype.GetLinearOffset);box2d.b2MotorJoint.prototype.SetAngularOffset=function(b){b!==this.m_angularOffset&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_angularOffset=b)};goog.exportProperty(box2d.b2MotorJoint.prototype,"SetAngularOffset",box2d.b2MotorJoint.prototype.SetAngularOffset);box2d.b2MotorJoint.prototype.GetAngularOffset=function(){return this.m_angularOffset};goog.exportProperty(box2d.b2MotorJoint.prototype,"GetAngularOffset",box2d.b2MotorJoint.prototype.GetAngularOffset);box2d.b2MotorJoint.prototype.SetMaxForce=function(b){box2d.ENABLE_ASSERTS&&box2d.b2Assert(box2d.b2IsValid(b)&&0<=b);this.m_maxForce=b};goog.exportProperty(box2d.b2MotorJoint.prototype,"SetMaxForce",box2d.b2MotorJoint.prototype.SetMaxForce);box2d.b2MotorJoint.prototype.GetMaxForce=function(){return this.m_maxForce};goog.exportProperty(box2d.b2MotorJoint.prototype,"GetMaxForce",box2d.b2MotorJoint.prototype.GetMaxForce);box2d.b2MotorJoint.prototype.SetMaxTorque=function(b){box2d.ENABLE_ASSERTS&&box2d.b2Assert(box2d.b2IsValid(b)&&0<=b);this.m_maxTorque=b};goog.exportProperty(box2d.b2MotorJoint.prototype,"SetMaxTorque",box2d.b2MotorJoint.prototype.SetMaxTorque);box2d.b2MotorJoint.prototype.GetMaxTorque=function(){return this.m_maxTorque};goog.exportProperty(box2d.b2MotorJoint.prototype,"GetMaxTorque",box2d.b2MotorJoint.prototype.GetMaxTorque);box2d.b2MotorJoint.prototype.InitVelocityConstraints=function(J){this.m_indexA=this.m_bodyA.m_islandIndex;this.m_indexB=this.m_bodyB.m_islandIndex;this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter);this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter);this.m_invMassA=this.m_bodyA.m_invMass;this.m_invMassB=this.m_bodyB.m_invMass;this.m_invIA=this.m_bodyA.m_invI;this.m_invIB=this.m_bodyB.m_invI;var I=J.positions[this.m_indexA].c,H=J.positions[this.m_indexA].a,G=J.velocities[this.m_indexA].v,F=J.velocities[this.m_indexA].w,E=J.positions[this.m_indexB].c,D=J.positions[this.m_indexB].a,C=J.velocities[this.m_indexB].v,A=J.velocities[this.m_indexB].w,B=this.m_qA.SetAngleRadians(H),z=this.m_qB.SetAngleRadians(D),y=box2d.b2MulRV(B,box2d.b2NegV(this.m_localCenterA,box2d.b2Vec2.s_t0),this.m_rA),z=box2d.b2MulRV(z,box2d.b2NegV(this.m_localCenterB,box2d.b2Vec2.s_t0),this.m_rB),v=this.m_invMassA,u=this.m_invMassB,j=this.m_invIA,K=this.m_invIB,L=this.m_K;L.ex.x=v+u+j*y.y*y.y+K*z.y*z.y;L.ex.y=-j*y.x*y.y-K*z.x*z.y;L.ey.x=L.ex.y;L.ey.y=v+u+j*y.x*y.x+K*z.x*z.x;L.GetInverse(this.m_linearMass);this.m_angularMass=j+K;0<this.m_angularMass&&(this.m_angularMass=1/this.m_angularMass);box2d.b2SubVV(box2d.b2SubVV(box2d.b2AddVV(E,z,box2d.b2Vec2.s_t0),box2d.b2AddVV(I,y,box2d.b2Vec2.s_t1),box2d.b2Vec2.s_t2),box2d.b2MulRV(B,this.m_linearOffset,box2d.b2Vec2.s_t3),this.m_linearError);this.m_angularError=D-H-this.m_angularOffset;J.step.warmStarting?(this.m_linearImpulse.SelfMul(J.step.dtRatio),this.m_angularImpulse*=J.step.dtRatio,I=this.m_linearImpulse,G.SelfMulSub(v,I),F-=j*(box2d.b2CrossVV(y,I)+this.m_angularImpulse),C.SelfMulAdd(u,I),A+=K*(box2d.b2CrossVV(z,I)+this.m_angularImpulse)):(this.m_linearImpulse.SetZero(),this.m_angularImpulse=0);J.velocities[this.m_indexA].w=F;J.velocities[this.m_indexB].w=A};goog.exportProperty(box2d.b2MotorJoint.prototype,"InitVelocityConstraints",box2d.b2MotorJoint.prototype.InitVelocityConstraints);box2d.b2MotorJoint.prototype.SolveVelocityConstraints=function(I){var H=I.velocities[this.m_indexA].v,G=I.velocities[this.m_indexA].w,F=I.velocities[this.m_indexB].v,E=I.velocities[this.m_indexB].w,D=this.m_invMassA,C=this.m_invMassB,B=this.m_invIA,z=this.m_invIB,A=I.step.dt,y=I.step.inv_dt,v=E-G+y*this.m_correctionFactor*this.m_angularError,v=-this.m_angularMass*v,u=this.m_angularImpulse,s=A*this.m_maxTorque;this.m_angularImpulse=box2d.b2Clamp(this.m_angularImpulse+v,-s,s);var v=this.m_angularImpulse-u,G=G-B*v,E=E+z*v,j=this.m_rA,J=this.m_rB,v=box2d.b2AddVV(box2d.b2SubVV(box2d.b2AddVV(F,box2d.b2CrossSV(E,J,box2d.b2Vec2.s_t0),box2d.b2Vec2.s_t0),box2d.b2AddVV(H,box2d.b2CrossSV(G,j,box2d.b2Vec2.s_t1),box2d.b2Vec2.s_t1),box2d.b2Vec2.s_t2),box2d.b2MulSV(y*this.m_correctionFactor,this.m_linearError,box2d.b2Vec2.s_t3),box2d.b2MotorJoint.prototype.SolveVelocityConstraints.s_Cdot),v=box2d.b2MulMV(this.m_linearMass,v,box2d.b2MotorJoint.prototype.SolveVelocityConstraints.s_impulse).SelfNeg(),u=box2d.b2MotorJoint.prototype.SolveVelocityConstraints.s_oldImpulse.Copy(this.m_linearImpulse);this.m_linearImpulse.SelfAdd(v);s=A*this.m_maxForce;this.m_linearImpulse.GetLengthSquared()>s*s&&(this.m_linearImpulse.Normalize(),this.m_linearImpulse.SelfMul(s));box2d.b2SubVV(this.m_linearImpulse,u,v);H.SelfMulSub(D,v);G-=B*box2d.b2CrossVV(j,v);F.SelfMulAdd(C,v);E+=z*box2d.b2CrossVV(J,v);I.velocities[this.m_indexA].w=G;I.velocities[this.m_indexB].w=E};goog.exportProperty(box2d.b2MotorJoint.prototype,"SolveVelocityConstraints",box2d.b2MotorJoint.prototype.SolveVelocityConstraints);box2d.b2MotorJoint.prototype.SolveVelocityConstraints.s_Cdot=new box2d.b2Vec2;box2d.b2MotorJoint.prototype.SolveVelocityConstraints.s_impulse=new box2d.b2Vec2;box2d.b2MotorJoint.prototype.SolveVelocityConstraints.s_oldImpulse=new box2d.b2Vec2;box2d.b2MotorJoint.prototype.SolvePositionConstraints=function(b){return !0};goog.exportProperty(box2d.b2MotorJoint.prototype,"SolvePositionConstraints",box2d.b2MotorJoint.prototype.SolvePositionConstraints);box2d.b2MotorJoint.prototype.Dump=function(){if(box2d.DEBUG){var e=this.m_bodyA.m_islandIndex,d=this.m_bodyB.m_islandIndex;box2d.b2Log("  /*box2d.b2MotorJointDef*/ var jd = new box2d.b2MotorJointDef();\n");box2d.b2Log("  jd.bodyA = bodies[%d];\n",e);box2d.b2Log("  jd.bodyB = bodies[%d];\n",d);box2d.b2Log("  jd.collideConnected = %s;\n",this.m_collideConnected?"true":"false");box2d.b2Log("  jd.linearOffset.SetXY(%.15f, %.15f);\n",this.m_linearOffset.x,this.m_linearOffset.y);box2d.b2Log("  jd.angularOffset = %.15f;\n",this.m_angularOffset);box2d.b2Log("  jd.maxForce = %.15f;\n",this.m_maxForce);box2d.b2Log("  jd.maxTorque = %.15f;\n",this.m_maxTorque);box2d.b2Log("  jd.correctionFactor = %.15f;\n",this.m_correctionFactor);box2d.b2Log("  joints[%d] = this.m_world.CreateJoint(jd);\n",this.m_index)}};goog.exportProperty(box2d.b2MotorJoint.prototype,"Dump",box2d.b2MotorJoint.prototype.Dump);box2d.b2MouseJointDef=function(){box2d.b2JointDef.call(this,box2d.b2JointType.e_mouseJoint);this.target=new box2d.b2Vec2};goog.inherits(box2d.b2MouseJointDef,box2d.b2JointDef);goog.exportSymbol("box2d.b2MouseJointDef",box2d.b2MouseJointDef);box2d.b2MouseJointDef.prototype.target=null;goog.exportProperty(box2d.b2MouseJointDef.prototype,"target",box2d.b2MouseJointDef.prototype.target);box2d.b2MouseJointDef.prototype.maxForce=0;goog.exportProperty(box2d.b2MouseJointDef.prototype,"maxForce",box2d.b2MouseJointDef.prototype.maxForce);box2d.b2MouseJointDef.prototype.frequencyHz=5;goog.exportProperty(box2d.b2MouseJointDef.prototype,"frequencyHz",box2d.b2MouseJointDef.prototype.frequencyHz);box2d.b2MouseJointDef.prototype.dampingRatio=0.7;goog.exportProperty(box2d.b2MouseJointDef.prototype,"dampingRatio",box2d.b2MouseJointDef.prototype.dampingRatio);box2d.b2MouseJoint=function(b){box2d.b2Joint.call(this,b);this.m_localAnchorB=new box2d.b2Vec2;this.m_targetA=new box2d.b2Vec2;this.m_impulse=new box2d.b2Vec2;this.m_rB=new box2d.b2Vec2;this.m_localCenterB=new box2d.b2Vec2;this.m_mass=new box2d.b2Mat22;this.m_C=new box2d.b2Vec2;this.m_qB=new box2d.b2Rot;this.m_lalcB=new box2d.b2Vec2;this.m_K=new box2d.b2Mat22;box2d.ENABLE_ASSERTS&&box2d.b2Assert(b.target.IsValid());box2d.ENABLE_ASSERTS&&box2d.b2Assert(box2d.b2IsValid(b.maxForce)&&0<=b.maxForce);box2d.ENABLE_ASSERTS&&box2d.b2Assert(box2d.b2IsValid(b.frequencyHz)&&0<=b.frequencyHz);box2d.ENABLE_ASSERTS&&box2d.b2Assert(box2d.b2IsValid(b.dampingRatio)&&0<=b.dampingRatio);this.m_targetA.Copy(b.target);box2d.b2MulTXV(this.m_bodyB.GetTransform(),this.m_targetA,this.m_localAnchorB);this.m_maxForce=b.maxForce;this.m_impulse.SetZero();this.m_frequencyHz=b.frequencyHz;this.m_dampingRatio=b.dampingRatio;this.m_gamma=this.m_beta=0};goog.inherits(box2d.b2MouseJoint,box2d.b2Joint);goog.exportSymbol("box2d.b2MouseJoint",box2d.b2MouseJoint);box2d.b2MouseJoint.prototype.m_localAnchorB=null;goog.exportProperty(box2d.b2MouseJoint.prototype,"m_localAnchorB",box2d.b2MouseJoint.prototype.m_localAnchorB);box2d.b2MouseJoint.prototype.m_targetA=null;goog.exportProperty(box2d.b2MouseJoint.prototype,"m_targetA",box2d.b2MouseJoint.prototype.m_targetA);box2d.b2MouseJoint.prototype.m_frequencyHz=0;goog.exportProperty(box2d.b2MouseJoint.prototype,"m_frequencyHz",box2d.b2MouseJoint.prototype.m_frequencyHz);box2d.b2MouseJoint.prototype.m_dampingRatio=0;goog.exportProperty(box2d.b2MouseJoint.prototype,"m_dampingRatio",box2d.b2MouseJoint.prototype.m_dampingRatio);box2d.b2MouseJoint.prototype.m_beta=0;goog.exportProperty(box2d.b2MouseJoint.prototype,"m_beta",box2d.b2MouseJoint.prototype.m_beta);box2d.b2MouseJoint.prototype.m_impulse=null;goog.exportProperty(box2d.b2MouseJoint.prototype,"m_impulse",box2d.b2MouseJoint.prototype.m_impulse);box2d.b2MouseJoint.prototype.m_maxForce=0;goog.exportProperty(box2d.b2MouseJoint.prototype,"m_maxForce",box2d.b2MouseJoint.prototype.m_maxForce);box2d.b2MouseJoint.prototype.m_gamma=0;goog.exportProperty(box2d.b2MouseJoint.prototype,"m_gamma",box2d.b2MouseJoint.prototype.m_gamma);box2d.b2MouseJoint.prototype.m_indexA=0;goog.exportProperty(box2d.b2MouseJoint.prototype,"m_indexA",box2d.b2MouseJoint.prototype.m_indexA);box2d.b2MouseJoint.prototype.m_indexB=0;goog.exportProperty(box2d.b2MouseJoint.prototype,"m_indexB",box2d.b2MouseJoint.prototype.m_indexB);box2d.b2MouseJoint.prototype.m_rB=null;goog.exportProperty(box2d.b2MouseJoint.prototype,"m_rB",box2d.b2MouseJoint.prototype.m_rB);box2d.b2MouseJoint.prototype.m_localCenterB=null;goog.exportProperty(box2d.b2MouseJoint.prototype,"m_localCenterB",box2d.b2MouseJoint.prototype.m_localCenterB);box2d.b2MouseJoint.prototype.m_invMassB=0;goog.exportProperty(box2d.b2MouseJoint.prototype,"m_invMassB",box2d.b2MouseJoint.prototype.m_invMassB);box2d.b2MouseJoint.prototype.m_invIB=0;goog.exportProperty(box2d.b2MouseJoint.prototype,"m_invIB",box2d.b2MouseJoint.prototype.m_invIB);box2d.b2MouseJoint.prototype.m_mass=null;goog.exportProperty(box2d.b2MouseJoint.prototype,"m_mass",box2d.b2MouseJoint.prototype.m_mass);box2d.b2MouseJoint.prototype.m_C=null;goog.exportProperty(box2d.b2MouseJoint.prototype,"m_C",box2d.b2MouseJoint.prototype.m_C);box2d.b2MouseJoint.prototype.m_qB=null;goog.exportProperty(box2d.b2MouseJoint.prototype,"m_qB",box2d.b2MouseJoint.prototype.m_qB);box2d.b2MouseJoint.prototype.m_lalcB=null;goog.exportProperty(box2d.b2MouseJoint.prototype,"m_lalcB",box2d.b2MouseJoint.prototype.m_lalcB);box2d.b2MouseJoint.prototype.m_K=null;goog.exportProperty(box2d.b2MouseJoint.prototype,"m_K",box2d.b2MouseJoint.prototype.m_K);box2d.b2MouseJoint.prototype.SetTarget=function(b){!1===this.m_bodyB.IsAwake()&&this.m_bodyB.SetAwake(!0);this.m_targetA.Copy(b)};goog.exportProperty(box2d.b2MouseJoint.prototype,"SetTarget",box2d.b2MouseJoint.prototype.SetTarget);box2d.b2MouseJoint.prototype.GetTarget=function(b){return b.Copy(this.m_targetA)};goog.exportProperty(box2d.b2MouseJoint.prototype,"GetTarget",box2d.b2MouseJoint.prototype.GetTarget);box2d.b2MouseJoint.prototype.SetMaxForce=function(b){this.m_maxForce=b};goog.exportProperty(box2d.b2MouseJoint.prototype,"SetMaxForce",box2d.b2MouseJoint.prototype.SetMaxForce);box2d.b2MouseJoint.prototype.GetMaxForce=function(){return this.m_maxForce};goog.exportProperty(box2d.b2MouseJoint.prototype,"GetMaxForce",box2d.b2MouseJoint.prototype.GetMaxForce);box2d.b2MouseJoint.prototype.SetFrequency=function(b){this.m_frequencyHz=b};goog.exportProperty(box2d.b2MouseJoint.prototype,"SetFrequency",box2d.b2MouseJoint.prototype.SetFrequency);box2d.b2MouseJoint.prototype.GetFrequency=function(){return this.m_frequencyHz};goog.exportProperty(box2d.b2MouseJoint.prototype,"GetFrequency",box2d.b2MouseJoint.prototype.GetFrequency);box2d.b2MouseJoint.prototype.SetDampingRatio=function(b){this.m_dampingRatio=b};goog.exportProperty(box2d.b2MouseJoint.prototype,"SetDampingRatio",box2d.b2MouseJoint.prototype.SetDampingRatio);box2d.b2MouseJoint.prototype.GetDampingRatio=function(){return this.m_dampingRatio};goog.exportProperty(box2d.b2MouseJoint.prototype,"GetDampingRatio",box2d.b2MouseJoint.prototype.GetDampingRatio);box2d.b2MouseJoint.prototype.InitVelocityConstraints=function(k){this.m_indexB=this.m_bodyB.m_islandIndex;this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter);this.m_invMassB=this.m_bodyB.m_invMass;this.m_invIB=this.m_bodyB.m_invI;var j=k.positions[this.m_indexB].c,u=k.velocities[this.m_indexB].v,s=k.velocities[this.m_indexB].w,r=this.m_qB.SetAngleRadians(k.positions[this.m_indexB].a),q=this.m_bodyB.GetMass(),n=2*box2d.b2_pi*this.m_frequencyHz,m=2*q*this.m_dampingRatio*n,q=q*n*n,n=k.step.dt;box2d.ENABLE_ASSERTS&&box2d.b2Assert(m+n*q>box2d.b2_epsilon);this.m_gamma=n*(m+n*q);0!==this.m_gamma&&(this.m_gamma=1/this.m_gamma);this.m_beta=n*q*this.m_gamma;box2d.b2SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB);box2d.b2MulRV(r,this.m_lalcB,this.m_rB);r=this.m_K;r.ex.x=this.m_invMassB+this.m_invIB*this.m_rB.y*this.m_rB.y+this.m_gamma;r.ex.y=-this.m_invIB*this.m_rB.x*this.m_rB.y;r.ey.x=r.ex.y;r.ey.y=this.m_invMassB+this.m_invIB*this.m_rB.x*this.m_rB.x+this.m_gamma;r.GetInverse(this.m_mass);this.m_C.x=j.x+this.m_rB.x-this.m_targetA.x;this.m_C.y=j.y+this.m_rB.y-this.m_targetA.y;this.m_C.SelfMul(this.m_beta);s*=0.98;k.step.warmStarting?(this.m_impulse.SelfMul(k.step.dtRatio),u.x+=this.m_invMassB*this.m_impulse.x,u.y+=this.m_invMassB*this.m_impulse.y,s+=this.m_invIB*box2d.b2CrossVV(this.m_rB,this.m_impulse)):this.m_impulse.SetZero();k.velocities[this.m_indexB].w=s};goog.exportProperty(box2d.b2MouseJoint.prototype,"InitVelocityConstraints",box2d.b2MouseJoint.prototype.InitVelocityConstraints);box2d.b2MouseJoint.prototype.SolveVelocityConstraints=function(j){var g=j.velocities[this.m_indexB].v,q=j.velocities[this.m_indexB].w,n=box2d.b2AddVCrossSV(g,q,this.m_rB,box2d.b2MouseJoint.prototype.SolveVelocityConstraints.s_Cdot),n=box2d.b2MulMV(this.m_mass,box2d.b2AddVV(n,box2d.b2AddVV(this.m_C,box2d.b2MulSV(this.m_gamma,this.m_impulse,box2d.b2Vec2.s_t0),box2d.b2Vec2.s_t0),box2d.b2Vec2.s_t0).SelfNeg(),box2d.b2MouseJoint.prototype.SolveVelocityConstraints.s_impulse),m=box2d.b2MouseJoint.prototype.SolveVelocityConstraints.s_oldImpulse.Copy(this.m_impulse);this.m_impulse.SelfAdd(n);var k=j.step.dt*this.m_maxForce;this.m_impulse.GetLengthSquared()>k*k&&this.m_impulse.SelfMul(k/this.m_impulse.GetLength());box2d.b2SubVV(this.m_impulse,m,n);g.SelfMulAdd(this.m_invMassB,n);q+=this.m_invIB*box2d.b2CrossVV(this.m_rB,n);j.velocities[this.m_indexB].w=q};goog.exportProperty(box2d.b2MouseJoint.prototype,"SolveVelocityConstraints",box2d.b2MouseJoint.prototype.SolveVelocityConstraints);box2d.b2MouseJoint.prototype.SolveVelocityConstraints.s_Cdot=new box2d.b2Vec2;box2d.b2MouseJoint.prototype.SolveVelocityConstraints.s_impulse=new box2d.b2Vec2;box2d.b2MouseJoint.prototype.SolveVelocityConstraints.s_oldImpulse=new box2d.b2Vec2;box2d.b2MouseJoint.prototype.SolvePositionConstraints=function(b){return !0};goog.exportProperty(box2d.b2MouseJoint.prototype,"SolvePositionConstraints",box2d.b2MouseJoint.prototype.SolvePositionConstraints);box2d.b2MouseJoint.prototype.GetAnchorA=function(b){return b.Copy(this.m_targetA)};goog.exportProperty(box2d.b2MouseJoint.prototype,"GetAnchorA",box2d.b2MouseJoint.prototype.GetAnchorA);box2d.b2MouseJoint.prototype.GetAnchorB=function(b){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,b)};goog.exportProperty(box2d.b2MouseJoint.prototype,"GetAnchorB",box2d.b2MouseJoint.prototype.GetAnchorB);box2d.b2MouseJoint.prototype.GetReactionForce=function(e,d){return box2d.b2MulSV(e,this.m_impulse,d)};goog.exportProperty(box2d.b2MouseJoint.prototype,"GetReactionForce",box2d.b2MouseJoint.prototype.GetReactionForce);box2d.b2MouseJoint.prototype.GetReactionTorque=function(b){return 0};goog.exportProperty(box2d.b2MouseJoint.prototype,"GetReactionTorque",box2d.b2MouseJoint.prototype.GetReactionTorque);box2d.b2MouseJoint.prototype.Dump=function(){box2d.DEBUG&&box2d.b2Log("Mouse joint dumping is not supported.\n")};goog.exportProperty(box2d.b2MouseJoint.prototype,"Dump",box2d.b2MouseJoint.prototype.Dump);box2d.b2MouseJoint.prototype.ShiftOrigin=function(b){this.m_targetA.SelfSub(b)};goog.exportProperty(box2d.b2MouseJoint.prototype,"ShiftOrigin",box2d.b2MouseJoint.prototype.ShiftOrigin);box2d.b2PrismaticJointDef=function(){box2d.b2JointDef.call(this,box2d.b2JointType.e_prismaticJoint);this.localAnchorA=new box2d.b2Vec2;this.localAnchorB=new box2d.b2Vec2;this.localAxisA=new box2d.b2Vec2(1,0)};goog.inherits(box2d.b2PrismaticJointDef,box2d.b2JointDef);goog.exportSymbol("box2d.b2PrismaticJointDef",box2d.b2PrismaticJointDef);box2d.b2PrismaticJointDef.prototype.localAnchorA=null;goog.exportProperty(box2d.b2PrismaticJointDef.prototype,"localAnchorA",box2d.b2PrismaticJointDef.prototype.localAnchorA);box2d.b2PrismaticJointDef.prototype.localAnchorB=null;goog.exportProperty(box2d.b2PrismaticJointDef.prototype,"localAnchorB",box2d.b2PrismaticJointDef.prototype.localAnchorB);box2d.b2PrismaticJointDef.prototype.localAxisA=null;goog.exportProperty(box2d.b2PrismaticJointDef.prototype,"localAxisA",box2d.b2PrismaticJointDef.prototype.localAxisA);box2d.b2PrismaticJointDef.prototype.referenceAngle=0;goog.exportProperty(box2d.b2PrismaticJointDef.prototype,"referenceAngle",box2d.b2PrismaticJointDef.prototype.referenceAngle);box2d.b2PrismaticJointDef.prototype.enableLimit=!1;goog.exportProperty(box2d.b2PrismaticJointDef.prototype,"enableLimit",box2d.b2PrismaticJointDef.prototype.enableLimit);box2d.b2PrismaticJointDef.prototype.lowerTranslation=0;goog.exportProperty(box2d.b2PrismaticJointDef.prototype,"lowerTranslation",box2d.b2PrismaticJointDef.prototype.lowerTranslation);box2d.b2PrismaticJointDef.prototype.upperTranslation=0;goog.exportProperty(box2d.b2PrismaticJointDef.prototype,"upperTranslation",box2d.b2PrismaticJointDef.prototype.upperTranslation);box2d.b2PrismaticJointDef.prototype.enableMotor=!1;goog.exportProperty(box2d.b2PrismaticJointDef.prototype,"enableMotor",box2d.b2PrismaticJointDef.prototype.enableMotor);box2d.b2PrismaticJointDef.prototype.maxMotorForce=0;goog.exportProperty(box2d.b2PrismaticJointDef.prototype,"maxMotorForce",box2d.b2PrismaticJointDef.prototype.maxMotorForce);box2d.b2PrismaticJointDef.prototype.motorSpeed=0;goog.exportProperty(box2d.b2PrismaticJointDef.prototype,"motorSpeed",box2d.b2PrismaticJointDef.prototype.motorSpeed);box2d.b2PrismaticJointDef.prototype.Initialize=function(f,e,j,g){this.bodyA=f;this.bodyB=e;this.bodyA.GetLocalPoint(j,this.localAnchorA);this.bodyB.GetLocalPoint(j,this.localAnchorB);this.bodyA.GetLocalVector(g,this.localAxisA);this.referenceAngle=this.bodyB.GetAngleRadians()-this.bodyA.GetAngleRadians()};goog.exportProperty(box2d.b2PrismaticJointDef.prototype,"Initialize",box2d.b2PrismaticJointDef.prototype.Initialize);box2d.b2PrismaticJoint=function(b){box2d.b2Joint.call(this,b);this.m_localAnchorA=b.localAnchorA.Clone();this.m_localAnchorB=b.localAnchorB.Clone();this.m_localXAxisA=b.localAxisA.Clone().SelfNormalize();this.m_localYAxisA=box2d.b2CrossOneV(this.m_localXAxisA,new box2d.b2Vec2);this.m_referenceAngle=b.referenceAngle;this.m_impulse=new box2d.b2Vec3(0,0,0);this.m_lowerTranslation=b.lowerTranslation;this.m_upperTranslation=b.upperTranslation;this.m_maxMotorForce=b.maxMotorForce;this.m_motorSpeed=b.motorSpeed;this.m_enableLimit=b.enableLimit;this.m_enableMotor=b.enableMotor;this.m_localCenterA=new box2d.b2Vec2;this.m_localCenterB=new box2d.b2Vec2;this.m_axis=new box2d.b2Vec2(0,0);this.m_perp=new box2d.b2Vec2(0,0);this.m_K=new box2d.b2Mat33;this.m_K3=new box2d.b2Mat33;this.m_K2=new box2d.b2Mat22;this.m_qA=new box2d.b2Rot;this.m_qB=new box2d.b2Rot;this.m_lalcA=new box2d.b2Vec2;this.m_lalcB=new box2d.b2Vec2;this.m_rA=new box2d.b2Vec2;this.m_rB=new box2d.b2Vec2};goog.inherits(box2d.b2PrismaticJoint,box2d.b2Joint);goog.exportSymbol("box2d.b2PrismaticJoint",box2d.b2PrismaticJoint);box2d.b2PrismaticJoint.prototype.m_localAnchorA=null;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_localAnchorA",box2d.b2PrismaticJoint.prototype.m_localAnchorA);box2d.b2PrismaticJoint.prototype.m_localAnchorB=null;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_localAnchorB",box2d.b2PrismaticJoint.prototype.m_localAnchorB);box2d.b2PrismaticJoint.prototype.m_localXAxisA=null;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_localXAxisA",box2d.b2PrismaticJoint.prototype.m_localXAxisA);box2d.b2PrismaticJoint.prototype.m_localYAxisA=null;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_localYAxisA",box2d.b2PrismaticJoint.prototype.m_localYAxisA);box2d.b2PrismaticJoint.prototype.m_referenceAngle=0;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_referenceAngle",box2d.b2PrismaticJoint.prototype.m_referenceAngle);box2d.b2PrismaticJoint.prototype.m_impulse=null;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_impulse",box2d.b2PrismaticJoint.prototype.m_impulse);box2d.b2PrismaticJoint.prototype.m_motorImpulse=0;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_motorImpulse",box2d.b2PrismaticJoint.prototype.m_motorImpulse);box2d.b2PrismaticJoint.prototype.m_lowerTranslation=0;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_lowerTranslation",box2d.b2PrismaticJoint.prototype.m_lowerTranslation);box2d.b2PrismaticJoint.prototype.m_upperTranslation=0;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_upperTranslation",box2d.b2PrismaticJoint.prototype.m_upperTranslation);box2d.b2PrismaticJoint.prototype.m_maxMotorForce=0;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_maxMotorForce",box2d.b2PrismaticJoint.prototype.m_maxMotorForce);box2d.b2PrismaticJoint.prototype.m_motorSpeed=0;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_motorSpeed",box2d.b2PrismaticJoint.prototype.m_motorSpeed);box2d.b2PrismaticJoint.prototype.m_enableLimit=!1;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_enableLimit",box2d.b2PrismaticJoint.prototype.m_enableLimit);box2d.b2PrismaticJoint.prototype.m_enableMotor=!1;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_enableMotor",box2d.b2PrismaticJoint.prototype.m_enableMotor);box2d.b2PrismaticJoint.prototype.m_limitState=box2d.b2LimitState.e_inactiveLimit;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_limitState",box2d.b2PrismaticJoint.prototype.m_limitState);box2d.b2PrismaticJoint.prototype.m_indexA=0;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_indexA",box2d.b2PrismaticJoint.prototype.m_indexA);box2d.b2PrismaticJoint.prototype.m_indexB=0;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_indexB",box2d.b2PrismaticJoint.prototype.m_indexB);box2d.b2PrismaticJoint.prototype.m_localCenterA=null;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_localCenterA",box2d.b2PrismaticJoint.prototype.m_localCenterA);box2d.b2PrismaticJoint.prototype.m_localCenterB=null;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_localCenterB",box2d.b2PrismaticJoint.prototype.m_localCenterB);box2d.b2PrismaticJoint.prototype.m_invMassA=0;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_invMassA",box2d.b2PrismaticJoint.prototype.m_invMassA);box2d.b2PrismaticJoint.prototype.m_invMassB=0;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_invMassB",box2d.b2PrismaticJoint.prototype.m_invMassB);box2d.b2PrismaticJoint.prototype.m_invIA=0;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_invIA",box2d.b2PrismaticJoint.prototype.m_invIA);box2d.b2PrismaticJoint.prototype.m_invIB=0;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_invIB",box2d.b2PrismaticJoint.prototype.m_invIB);box2d.b2PrismaticJoint.prototype.m_axis=null;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_axis",box2d.b2PrismaticJoint.prototype.m_axis);box2d.b2PrismaticJoint.prototype.m_perp=null;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_perp",box2d.b2PrismaticJoint.prototype.m_perp);box2d.b2PrismaticJoint.prototype.m_s1=0;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_s1",box2d.b2PrismaticJoint.prototype.m_s1);box2d.b2PrismaticJoint.prototype.m_s2=0;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_s2",box2d.b2PrismaticJoint.prototype.m_s2);box2d.b2PrismaticJoint.prototype.m_a1=0;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_a1",box2d.b2PrismaticJoint.prototype.m_a1);box2d.b2PrismaticJoint.prototype.m_a2=0;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_a2",box2d.b2PrismaticJoint.prototype.m_a2);box2d.b2PrismaticJoint.prototype.m_K=null;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_K",box2d.b2PrismaticJoint.prototype.m_K);box2d.b2PrismaticJoint.prototype.m_K3=null;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_K3",box2d.b2PrismaticJoint.prototype.m_K3);box2d.b2PrismaticJoint.prototype.m_K2=null;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_K2",box2d.b2PrismaticJoint.prototype.m_K2);box2d.b2PrismaticJoint.prototype.m_motorMass=0;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_motorMass",box2d.b2PrismaticJoint.prototype.m_motorMass);box2d.b2PrismaticJoint.prototype.m_qA=null;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_qA",box2d.b2PrismaticJoint.prototype.m_qA);box2d.b2PrismaticJoint.prototype.m_qB=null;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_qB",box2d.b2PrismaticJoint.prototype.m_qB);box2d.b2PrismaticJoint.prototype.m_lalcA=null;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_lalcA",box2d.b2PrismaticJoint.prototype.m_lalcA);box2d.b2PrismaticJoint.prototype.m_lalcB=null;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_lalcB",box2d.b2PrismaticJoint.prototype.m_lalcB);box2d.b2PrismaticJoint.prototype.m_rA=null;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_rA",box2d.b2PrismaticJoint.prototype.m_rA);box2d.b2PrismaticJoint.prototype.m_rB=null;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_rB",box2d.b2PrismaticJoint.prototype.m_rB);box2d.b2PrismaticJoint.prototype.InitVelocityConstraints=function(E){this.m_indexA=this.m_bodyA.m_islandIndex;this.m_indexB=this.m_bodyB.m_islandIndex;this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter);this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter);this.m_invMassA=this.m_bodyA.m_invMass;this.m_invMassB=this.m_bodyB.m_invMass;this.m_invIA=this.m_bodyA.m_invI;this.m_invIB=this.m_bodyB.m_invI;var D=E.positions[this.m_indexA].c,C=E.velocities[this.m_indexA].v,B=E.velocities[this.m_indexA].w,A=E.positions[this.m_indexB].c,z=E.positions[this.m_indexB].a,y=E.velocities[this.m_indexB].v,v=E.velocities[this.m_indexB].w,s=this.m_qA.SetAngleRadians(E.positions[this.m_indexA].a),z=this.m_qB.SetAngleRadians(z);box2d.b2SubVV(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA);var u=box2d.b2MulRV(s,this.m_lalcA,this.m_rA);box2d.b2SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB);var r=box2d.b2MulRV(z,this.m_lalcB,this.m_rB),q=box2d.b2AddVV(box2d.b2SubVV(A,D,box2d.b2Vec2.s_t0),box2d.b2SubVV(r,u,box2d.b2Vec2.s_t1),box2d.b2PrismaticJoint.prototype.InitVelocityConstraints.s_d),D=this.m_invMassA,A=this.m_invMassB,z=this.m_invIA,j=this.m_invIB;box2d.b2MulRV(s,this.m_localXAxisA,this.m_axis);this.m_a1=box2d.b2CrossVV(box2d.b2AddVV(q,u,box2d.b2Vec2.s_t0),this.m_axis);this.m_a2=box2d.b2CrossVV(r,this.m_axis);this.m_motorMass=D+A+z*this.m_a1*this.m_a1+j*this.m_a2*this.m_a2;0<this.m_motorMass&&(this.m_motorMass=1/this.m_motorMass);box2d.b2MulRV(s,this.m_localYAxisA,this.m_perp);this.m_s1=box2d.b2CrossVV(box2d.b2AddVV(q,u,box2d.b2Vec2.s_t0),this.m_perp);this.m_s2=box2d.b2CrossVV(r,this.m_perp);this.m_K.ex.x=D+A+z*this.m_s1*this.m_s1+j*this.m_s2*this.m_s2;this.m_K.ex.y=z*this.m_s1+j*this.m_s2;this.m_K.ex.z=z*this.m_s1*this.m_a1+j*this.m_s2*this.m_a2;this.m_K.ey.x=this.m_K.ex.y;this.m_K.ey.y=z+j;0===this.m_K.ey.y&&(this.m_K.ey.y=1);this.m_K.ey.z=z*this.m_a1+j*this.m_a2;this.m_K.ez.x=this.m_K.ex.z;this.m_K.ez.y=this.m_K.ey.z;this.m_K.ez.z=D+A+z*this.m_a1*this.m_a1+j*this.m_a2*this.m_a2;this.m_enableLimit?(s=box2d.b2DotVV(this.m_axis,q),box2d.b2Abs(this.m_upperTranslation-this.m_lowerTranslation)<2*box2d.b2_linearSlop?this.m_limitState=box2d.b2LimitState.e_equalLimits:s<=this.m_lowerTranslation?this.m_limitState!==box2d.b2LimitState.e_atLowerLimit&&(this.m_limitState=box2d.b2LimitState.e_atLowerLimit,this.m_impulse.z=0):s>=this.m_upperTranslation?this.m_limitState!==box2d.b2LimitState.e_atUpperLimit&&(this.m_limitState=box2d.b2LimitState.e_atUpperLimit,this.m_impulse.z=0):(this.m_limitState=box2d.b2LimitState.e_inactiveLimit,this.m_impulse.z=0)):(this.m_limitState=box2d.b2LimitState.e_inactiveLimit,this.m_impulse.z=0);!1===this.m_enableMotor&&(this.m_motorImpulse=0);E.step.warmStarting?(this.m_impulse.SelfMul(E.step.dtRatio),this.m_motorImpulse*=E.step.dtRatio,s=box2d.b2AddVV(box2d.b2MulSV(this.m_impulse.x,this.m_perp,box2d.b2Vec2.s_t0),box2d.b2MulSV(this.m_motorImpulse+this.m_impulse.z,this.m_axis,box2d.b2Vec2.s_t1),box2d.b2PrismaticJoint.prototype.InitVelocityConstraints.s_P),u=this.m_impulse.x*this.m_s1+this.m_impulse.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_a1,r=this.m_impulse.x*this.m_s2+this.m_impulse.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_a2,C.SelfMulSub(D,s),B-=z*u,y.SelfMulAdd(A,s),v+=j*r):(this.m_impulse.SetZero(),this.m_motorImpulse=0);E.velocities[this.m_indexA].w=B;E.velocities[this.m_indexB].w=v};goog.exportProperty(box2d.b2PrismaticJoint.prototype,"InitVelocityConstraints",box2d.b2PrismaticJoint.prototype.InitVelocityConstraints);box2d.b2PrismaticJoint.prototype.InitVelocityConstraints.s_d=new box2d.b2Vec2;box2d.b2PrismaticJoint.prototype.InitVelocityConstraints.s_P=new box2d.b2Vec2;box2d.b2PrismaticJoint.prototype.SolveVelocityConstraints=function(E){var D=E.velocities[this.m_indexA].v,C=E.velocities[this.m_indexA].w,B=E.velocities[this.m_indexB].v,A=E.velocities[this.m_indexB].w,z=this.m_invMassA,y=this.m_invMassB,v=this.m_invIA,s=this.m_invIB;if(this.m_enableMotor&&this.m_limitState!==box2d.b2LimitState.e_equalLimits){var u=box2d.b2DotVV(this.m_axis,box2d.b2SubVV(B,D,box2d.b2Vec2.s_t0))+this.m_a2*A-this.m_a1*C,u=this.m_motorMass*(this.m_motorSpeed-u),r=this.m_motorImpulse,q=E.step.dt*this.m_maxMotorForce;this.m_motorImpulse=box2d.b2Clamp(this.m_motorImpulse+u,-q,q);u=this.m_motorImpulse-r;r=box2d.b2MulSV(u,this.m_axis,box2d.b2PrismaticJoint.prototype.SolveVelocityConstraints.s_P);q=u*this.m_a1;u*=this.m_a2;D.SelfMulSub(z,r);C-=v*q;B.SelfMulAdd(y,r);A+=s*u}var q=box2d.b2DotVV(this.m_perp,box2d.b2SubVV(B,D,box2d.b2Vec2.s_t0))+this.m_s2*A-this.m_s1*C,j=A-C;this.m_enableLimit&&this.m_limitState!==box2d.b2LimitState.e_inactiveLimit?(u=box2d.b2DotVV(this.m_axis,box2d.b2SubVV(B,D,box2d.b2Vec2.s_t0))+this.m_a2*A-this.m_a1*C,r=box2d.b2PrismaticJoint.prototype.SolveVelocityConstraints.s_f1.Copy(this.m_impulse),u=this.m_K.Solve33(-q,-j,-u,box2d.b2PrismaticJoint.prototype.SolveVelocityConstraints.s_df3),this.m_impulse.SelfAdd(u),this.m_limitState===box2d.b2LimitState.e_atLowerLimit?this.m_impulse.z=box2d.b2Max(this.m_impulse.z,0):this.m_limitState===box2d.b2LimitState.e_atUpperLimit&&(this.m_impulse.z=box2d.b2Min(this.m_impulse.z,0)),q=this.m_K.Solve22(-q-(this.m_impulse.z-r.z)*this.m_K.ez.x,-j-(this.m_impulse.z-r.z)*this.m_K.ez.y,box2d.b2PrismaticJoint.prototype.SolveVelocityConstraints.s_f2r),q.x+=r.x,q.y+=r.y,this.m_impulse.x=q.x,this.m_impulse.y=q.y,u.x=this.m_impulse.x-r.x,u.y=this.m_impulse.y-r.y,u.z=this.m_impulse.z-r.z,r=box2d.b2AddVV(box2d.b2MulSV(u.x,this.m_perp,box2d.b2Vec2.s_t0),box2d.b2MulSV(u.z,this.m_axis,box2d.b2Vec2.s_t1),box2d.b2PrismaticJoint.prototype.SolveVelocityConstraints.s_P),q=u.x*this.m_s1+u.y+u.z*this.m_a1,u=u.x*this.m_s2+u.y+u.z*this.m_a2):(u=this.m_K.Solve22(-q,-j,box2d.b2PrismaticJoint.prototype.SolveVelocityConstraints.s_df2),this.m_impulse.x+=u.x,this.m_impulse.y+=u.y,r=box2d.b2MulSV(u.x,this.m_perp,box2d.b2PrismaticJoint.prototype.SolveVelocityConstraints.s_P),q=u.x*this.m_s1+u.y,u=u.x*this.m_s2+u.y);D.SelfMulSub(z,r);C-=v*q;B.SelfMulAdd(y,r);E.velocities[this.m_indexA].w=C;E.velocities[this.m_indexB].w=A+s*u};goog.exportProperty(box2d.b2PrismaticJoint.prototype,"SolveVelocityConstraints",box2d.b2PrismaticJoint.prototype.SolveVelocityConstraints);box2d.b2PrismaticJoint.prototype.SolveVelocityConstraints.s_P=new box2d.b2Vec2;box2d.b2PrismaticJoint.prototype.SolveVelocityConstraints.s_f2r=new box2d.b2Vec2;box2d.b2PrismaticJoint.prototype.SolveVelocityConstraints.s_f1=new box2d.b2Vec3;box2d.b2PrismaticJoint.prototype.SolveVelocityConstraints.s_df3=new box2d.b2Vec3;box2d.b2PrismaticJoint.prototype.SolveVelocityConstraints.s_df2=new box2d.b2Vec2;box2d.b2PrismaticJoint.prototype.SolvePositionConstraints=function(ae){var ad=ae.positions[this.m_indexA].c,ac=ae.positions[this.m_indexA].a,ab=ae.positions[this.m_indexB].c,aa=ae.positions[this.m_indexB].a,Z=this.m_qA.SetAngleRadians(ac),Y=this.m_qB.SetAngleRadians(aa),X=this.m_invMassA,V=this.m_invMassB,W=this.m_invIA,U=this.m_invIB,T=box2d.b2MulRV(Z,this.m_lalcA,this.m_rA),S=box2d.b2MulRV(Y,this.m_lalcB,this.m_rB),P=box2d.b2SubVV(box2d.b2AddVV(ab,S,box2d.b2Vec2.s_t0),box2d.b2AddVV(ad,T,box2d.b2Vec2.s_t1),box2d.b2PrismaticJoint.prototype.SolvePositionConstraints.s_d),N=box2d.b2MulRV(Z,this.m_localXAxisA,this.m_axis),J=box2d.b2CrossVV(box2d.b2AddVV(P,T,box2d.b2Vec2.s_t0),N),Y=box2d.b2CrossVV(S,N),Z=box2d.b2MulRV(Z,this.m_localYAxisA,this.m_perp),L=box2d.b2CrossVV(box2d.b2AddVV(P,T,box2d.b2Vec2.s_t0),Z),G=box2d.b2CrossVV(S,Z),F=box2d.b2PrismaticJoint.prototype.SolvePositionConstraints.s_impulse,H=box2d.b2DotVV(Z,P),M=aa-ac-this.m_referenceAngle,T=box2d.b2Abs(H),S=box2d.b2Abs(M),z=!1,j=0;this.m_enableLimit&&(P=box2d.b2DotVV(N,P),box2d.b2Abs(this.m_upperTranslation-this.m_lowerTranslation)<2*box2d.b2_linearSlop?(j=box2d.b2Clamp(P,-box2d.b2_maxLinearCorrection,box2d.b2_maxLinearCorrection),T=box2d.b2Max(T,box2d.b2Abs(P)),z=!0):P<=this.m_lowerTranslation?(j=box2d.b2Clamp(P-this.m_lowerTranslation+box2d.b2_linearSlop,-box2d.b2_maxLinearCorrection,0),T=box2d.b2Max(T,this.m_lowerTranslation-P),z=!0):P>=this.m_upperTranslation&&(j=box2d.b2Clamp(P-this.m_upperTranslation-box2d.b2_linearSlop,0,box2d.b2_maxLinearCorrection),T=box2d.b2Max(T,P-this.m_upperTranslation),z=!0));if(z){var P=W*L+U*G,R=W*L*J+U*G*Y,z=W+U;0===z&&(z=1);var O=W*J+U*Y,I=X+V+W*J*J+U*Y*Y,K=this.m_K3;K.ex.SetXYZ(X+V+W*L*L+U*G*G,P,R);K.ey.SetXYZ(P,z,O);K.ez.SetXYZ(R,O,I);F=K.Solve33(-H,-M,-j,F)}else{P=W*L+U*G,z=W+U,0===z&&(z=1),j=this.m_K2,j.ex.SetXY(X+V+W*L*L+U*G*G,P),j.ey.SetXY(P,z),H=j.Solve(-H,-M,box2d.b2PrismaticJoint.prototype.SolvePositionConstraints.s_impulse1),F.x=H.x,F.y=H.y,F.z=0}N=box2d.b2AddVV(box2d.b2MulSV(F.x,Z,box2d.b2Vec2.s_t0),box2d.b2MulSV(F.z,N,box2d.b2Vec2.s_t1),box2d.b2PrismaticJoint.prototype.SolvePositionConstraints.s_P);J=F.x*L+F.y+F.z*J;Y=F.x*G+F.y+F.z*Y;ad.SelfMulSub(X,N);ac-=W*J;ab.SelfMulAdd(V,N);ae.positions[this.m_indexA].a=ac;ae.positions[this.m_indexB].a=aa+U*Y;return T<=box2d.b2_linearSlop&&S<=box2d.b2_angularSlop};goog.exportProperty(box2d.b2PrismaticJoint.prototype,"SolvePositionConstraints",box2d.b2PrismaticJoint.prototype.SolvePositionConstraints);box2d.b2PrismaticJoint.prototype.SolvePositionConstraints.s_d=new box2d.b2Vec2;box2d.b2PrismaticJoint.prototype.SolvePositionConstraints.s_impulse=new box2d.b2Vec3;box2d.b2PrismaticJoint.prototype.SolvePositionConstraints.s_impulse1=new box2d.b2Vec2;box2d.b2PrismaticJoint.prototype.SolvePositionConstraints.s_P=new box2d.b2Vec2;box2d.b2PrismaticJoint.prototype.GetAnchorA=function(b){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,b)};goog.exportProperty(box2d.b2PrismaticJoint.prototype,"GetAnchorA",box2d.b2PrismaticJoint.prototype.GetAnchorA);box2d.b2PrismaticJoint.prototype.GetAnchorB=function(b){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,b)};goog.exportProperty(box2d.b2PrismaticJoint.prototype,"GetAnchorB",box2d.b2PrismaticJoint.prototype.GetAnchorB);box2d.b2PrismaticJoint.prototype.GetReactionForce=function(e,d){return d.SetXY(e*(this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.x),e*(this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.y))};goog.exportProperty(box2d.b2PrismaticJoint.prototype,"GetReactionForce",box2d.b2PrismaticJoint.prototype.GetReactionForce);box2d.b2PrismaticJoint.prototype.GetReactionTorque=function(b){return b*this.m_impulse.y};goog.exportProperty(box2d.b2PrismaticJoint.prototype,"GetReactionTorque",box2d.b2PrismaticJoint.prototype.GetReactionTorque);box2d.b2PrismaticJoint.prototype.GetLocalAnchorA=function(b){return b.Copy(this.m_localAnchorA)};goog.exportProperty(box2d.b2PrismaticJoint.prototype,"GetLocalAnchorA",box2d.b2PrismaticJoint.prototype.GetLocalAnchorA);box2d.b2PrismaticJoint.prototype.GetLocalAnchorB=function(b){return b.Copy(this.m_localAnchorB)};goog.exportProperty(box2d.b2PrismaticJoint.prototype,"GetLocalAnchorB",box2d.b2PrismaticJoint.prototype.GetLocalAnchorB);box2d.b2PrismaticJoint.prototype.GetLocalAxisA=function(b){return b.Copy(this.m_localXAxisA)};goog.exportProperty(box2d.b2PrismaticJoint.prototype,"GetLocalAxisA",box2d.b2PrismaticJoint.prototype.GetLocalAxisA);box2d.b2PrismaticJoint.prototype.GetReferenceAngle=function(){return this.m_referenceAngle};goog.exportProperty(box2d.b2PrismaticJoint.prototype,"GetReferenceAngle",box2d.b2PrismaticJoint.prototype.GetReferenceAngle);box2d.b2PrismaticJoint.prototype.GetJointTranslation=function(){var e=this.m_bodyA.GetWorldPoint(this.m_localAnchorA,box2d.b2PrismaticJoint.prototype.GetJointTranslation.s_pA),d=this.m_bodyB.GetWorldPoint(this.m_localAnchorB,box2d.b2PrismaticJoint.prototype.GetJointTranslation.s_pB),e=box2d.b2SubVV(d,e,box2d.b2PrismaticJoint.prototype.GetJointTranslation.s_d),d=this.m_bodyA.GetWorldVector(this.m_localXAxisA,box2d.b2PrismaticJoint.prototype.GetJointTranslation.s_axis);return box2d.b2DotVV(e,d)};goog.exportProperty(box2d.b2PrismaticJoint.prototype,"GetJointTranslation",box2d.b2PrismaticJoint.prototype.GetJointTranslation);box2d.b2PrismaticJoint.prototype.GetJointTranslation.s_pA=new box2d.b2Vec2;box2d.b2PrismaticJoint.prototype.GetJointTranslation.s_pB=new box2d.b2Vec2;box2d.b2PrismaticJoint.prototype.GetJointTranslation.s_d=new box2d.b2Vec2;box2d.b2PrismaticJoint.prototype.GetJointTranslation.s_axis=new box2d.b2Vec2;box2d.b2PrismaticJoint.prototype.GetJointSpeed=function(){var k=this.m_bodyA,j=this.m_bodyB;box2d.b2SubVV(this.m_localAnchorA,k.m_sweep.localCenter,this.m_lalcA);var u=box2d.b2MulRV(k.m_xf.q,this.m_lalcA,this.m_rA);box2d.b2SubVV(this.m_localAnchorB,j.m_sweep.localCenter,this.m_lalcB);var s=box2d.b2MulRV(j.m_xf.q,this.m_lalcB,this.m_rB),r=box2d.b2AddVV(k.m_sweep.c,u,box2d.b2Vec2.s_t0),q=box2d.b2AddVV(j.m_sweep.c,s,box2d.b2Vec2.s_t1),r=box2d.b2SubVV(q,r,box2d.b2Vec2.s_t2),q=k.GetWorldVector(this.m_localXAxisA,this.m_axis),n=k.m_linearVelocity,m=j.m_linearVelocity,k=k.m_angularVelocity,j=j.m_angularVelocity;return box2d.b2DotVV(r,box2d.b2CrossSV(k,q,box2d.b2Vec2.s_t0))+box2d.b2DotVV(q,box2d.b2SubVV(box2d.b2AddVCrossSV(m,j,s,box2d.b2Vec2.s_t0),box2d.b2AddVCrossSV(n,k,u,box2d.b2Vec2.s_t1),box2d.b2Vec2.s_t0))};goog.exportProperty(box2d.b2PrismaticJoint.prototype,"GetJointSpeed",box2d.b2PrismaticJoint.prototype.GetJointSpeed);box2d.b2PrismaticJoint.prototype.IsLimitEnabled=function(){return this.m_enableLimit};goog.exportProperty(box2d.b2PrismaticJoint.prototype,"IsLimitEnabled",box2d.b2PrismaticJoint.prototype.IsLimitEnabled);box2d.b2PrismaticJoint.prototype.EnableLimit=function(b){b!==this.m_enableLimit&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableLimit=b,this.m_impulse.z=0)};goog.exportProperty(box2d.b2PrismaticJoint.prototype,"EnableLimit",box2d.b2PrismaticJoint.prototype.EnableLimit);box2d.b2PrismaticJoint.prototype.GetLowerLimit=function(){return this.m_lowerTranslation};goog.exportProperty(box2d.b2PrismaticJoint.prototype,"GetLowerLimit",box2d.b2PrismaticJoint.prototype.GetLowerLimit);box2d.b2PrismaticJoint.prototype.GetUpperLimit=function(){return this.m_upperTranslation};goog.exportProperty(box2d.b2PrismaticJoint.prototype,"GetUpperLimit",box2d.b2PrismaticJoint.prototype.GetUpperLimit);box2d.b2PrismaticJoint.prototype.SetLimits=function(e,d){if(e!==this.m_lowerTranslation||d!==this.m_upperTranslation){this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_lowerTranslation=e,this.m_upperTranslation=d,this.m_impulse.z=0}};goog.exportProperty(box2d.b2PrismaticJoint.prototype,"SetLimits",box2d.b2PrismaticJoint.prototype.SetLimits);box2d.b2PrismaticJoint.prototype.IsMotorEnabled=function(){return this.m_enableMotor};goog.exportProperty(box2d.b2PrismaticJoint.prototype,"IsMotorEnabled",box2d.b2PrismaticJoint.prototype.IsMotorEnabled);box2d.b2PrismaticJoint.prototype.EnableMotor=function(b){this.m_bodyA.SetAwake(!0);this.m_bodyB.SetAwake(!0);this.m_enableMotor=b};goog.exportProperty(box2d.b2PrismaticJoint.prototype,"EnableMotor",box2d.b2PrismaticJoint.prototype.EnableMotor);box2d.b2PrismaticJoint.prototype.SetMotorSpeed=function(b){this.m_bodyA.SetAwake(!0);this.m_bodyB.SetAwake(!0);this.m_motorSpeed=b};goog.exportProperty(box2d.b2PrismaticJoint.prototype,"SetMotorSpeed",box2d.b2PrismaticJoint.prototype.SetMotorSpeed);box2d.b2PrismaticJoint.prototype.GetMotorSpeed=function(){return this.m_motorSpeed};goog.exportProperty(box2d.b2PrismaticJoint.prototype,"GetMotorSpeed",box2d.b2PrismaticJoint.prototype.GetMotorSpeed);box2d.b2PrismaticJoint.prototype.SetMaxMotorForce=function(b){this.m_bodyA.SetAwake(!0);this.m_bodyB.SetAwake(!0);this.m_maxMotorForce=b};goog.exportProperty(box2d.b2PrismaticJoint.prototype,"SetMaxMotorForce",box2d.b2PrismaticJoint.prototype.SetMaxMotorForce);box2d.b2PrismaticJoint.prototype.GetMaxMotorForce=function(){return this.m_maxMotorForce};goog.exportProperty(box2d.b2PrismaticJoint.prototype,"GetMaxMotorForce",box2d.b2PrismaticJoint.prototype.GetMaxMotorForce);box2d.b2PrismaticJoint.prototype.GetMotorForce=function(b){return b*this.m_motorImpulse};goog.exportProperty(box2d.b2PrismaticJoint.prototype,"GetMotorForce",box2d.b2PrismaticJoint.prototype.GetMotorForce);box2d.b2PrismaticJoint.prototype.Dump=function(){if(box2d.DEBUG){var e=this.m_bodyA.m_islandIndex,d=this.m_bodyB.m_islandIndex;box2d.b2Log("  /*box2d.b2PrismaticJointDef*/ var jd = new box2d.b2PrismaticJointDef();\n");box2d.b2Log("  jd.bodyA = bodies[%d];\n",e);box2d.b2Log("  jd.bodyB = bodies[%d];\n",d);box2d.b2Log("  jd.collideConnected = %s;\n",this.m_collideConnected?"true":"false");box2d.b2Log("  jd.localAnchorA.SetXY(%.15f, %.15f);\n",this.m_localAnchorA.x,this.m_localAnchorA.y);box2d.b2Log("  jd.localAnchorB.SetXY(%.15f, %.15f);\n",this.m_localAnchorB.x,this.m_localAnchorB.y);box2d.b2Log("  jd.localAxisA.SetXY(%.15f, %.15f);\n",this.m_localXAxisA.x,this.m_localXAxisA.y);box2d.b2Log("  jd.referenceAngle = %.15f;\n",this.m_referenceAngle);box2d.b2Log("  jd.enableLimit = %s;\n",this.m_enableLimit?"true":"false");box2d.b2Log("  jd.lowerTranslation = %.15f;\n",this.m_lowerTranslation);box2d.b2Log("  jd.upperTranslation = %.15f;\n",this.m_upperTranslation);box2d.b2Log("  jd.enableMotor = %s;\n",this.m_enableMotor?"true":"false");box2d.b2Log("  jd.motorSpeed = %.15f;\n",this.m_motorSpeed);box2d.b2Log("  jd.maxMotorForce = %.15f;\n",this.m_maxMotorForce);box2d.b2Log("  joints[%d] = this.m_world.CreateJoint(jd);\n",this.m_index)}};goog.exportProperty(box2d.b2PrismaticJoint.prototype,"Dump",box2d.b2PrismaticJoint.prototype.Dump);box2d.b2_minPulleyLength=2;goog.exportSymbol("box2d.b2_minPulleyLength",box2d.b2_minPulleyLength);box2d.b2PulleyJointDef=function(){box2d.b2JointDef.call(this,box2d.b2JointType.e_pulleyJoint);this.collideConnected=!0;this.groundAnchorA=new box2d.b2Vec2(-1,1);this.groundAnchorB=new box2d.b2Vec2(1,1);this.localAnchorA=new box2d.b2Vec2(-1,0);this.localAnchorB=new box2d.b2Vec2(1,0)};goog.inherits(box2d.b2PulleyJointDef,box2d.b2JointDef);goog.exportSymbol("box2d.b2PulleyJointDef",box2d.b2PulleyJointDef);box2d.b2PulleyJointDef.prototype.groundAnchorA=null;goog.exportProperty(box2d.b2PulleyJointDef.prototype,"groundAnchorA",box2d.b2PulleyJointDef.prototype.groundAnchorA);box2d.b2PulleyJointDef.prototype.groundAnchorB=null;goog.exportProperty(box2d.b2PulleyJointDef.prototype,"groundAnchorB",box2d.b2PulleyJointDef.prototype.groundAnchorB);box2d.b2PulleyJointDef.prototype.localAnchorA=null;goog.exportProperty(box2d.b2PulleyJointDef.prototype,"localAnchorA",box2d.b2PulleyJointDef.prototype.localAnchorA);box2d.b2PulleyJointDef.prototype.localAnchorB=null;goog.exportProperty(box2d.b2PulleyJointDef.prototype,"localAnchorB",box2d.b2PulleyJointDef.prototype.localAnchorB);box2d.b2PulleyJointDef.prototype.lengthA=0;goog.exportProperty(box2d.b2PulleyJointDef.prototype,"lengthA",box2d.b2PulleyJointDef.prototype.lengthA);box2d.b2PulleyJointDef.prototype.lengthB=0;goog.exportProperty(box2d.b2PulleyJointDef.prototype,"lengthB",box2d.b2PulleyJointDef.prototype.lengthB);box2d.b2PulleyJointDef.prototype.ratio=1;goog.exportProperty(box2d.b2PulleyJointDef.prototype,"ratio",box2d.b2PulleyJointDef.prototype.ratio);box2d.b2PulleyJointDef.prototype.Initialize=function(k,j,s,r,q,n,m){this.bodyA=k;this.bodyB=j;this.groundAnchorA.Copy(s);this.groundAnchorB.Copy(r);this.bodyA.GetLocalPoint(q,this.localAnchorA);this.bodyB.GetLocalPoint(n,this.localAnchorB);this.lengthA=box2d.b2DistanceVV(q,s);this.lengthB=box2d.b2DistanceVV(n,r);this.ratio=m;box2d.ENABLE_ASSERTS&&box2d.b2Assert(this.ratio>box2d.b2_epsilon)};goog.exportProperty(box2d.b2PulleyJointDef.prototype,"Initialize",box2d.b2PulleyJointDef.prototype.Initialize);box2d.b2PulleyJoint=function(b){box2d.b2Joint.call(this,b);this.m_groundAnchorA=new box2d.b2Vec2;this.m_groundAnchorB=new box2d.b2Vec2;this.m_localAnchorA=new box2d.b2Vec2;this.m_localAnchorB=new box2d.b2Vec2;this.m_uA=new box2d.b2Vec2;this.m_uB=new box2d.b2Vec2;this.m_rA=new box2d.b2Vec2;this.m_rB=new box2d.b2Vec2;this.m_localCenterA=new box2d.b2Vec2;this.m_localCenterB=new box2d.b2Vec2;this.m_qA=new box2d.b2Rot;this.m_qB=new box2d.b2Rot;this.m_lalcA=new box2d.b2Vec2;this.m_lalcB=new box2d.b2Vec2;this.m_groundAnchorA.Copy(b.groundAnchorA);this.m_groundAnchorB.Copy(b.groundAnchorB);this.m_localAnchorA.Copy(b.localAnchorA);this.m_localAnchorB.Copy(b.localAnchorB);this.m_lengthA=b.lengthA;this.m_lengthB=b.lengthB;box2d.ENABLE_ASSERTS&&box2d.b2Assert(0!==b.ratio);this.m_ratio=b.ratio;this.m_constant=b.lengthA+this.m_ratio*b.lengthB;this.m_impulse=0};goog.inherits(box2d.b2PulleyJoint,box2d.b2Joint);goog.exportSymbol("box2d.b2PulleyJoint",box2d.b2PulleyJoint);box2d.b2PulleyJoint.prototype.m_groundAnchorA=null;goog.exportProperty(box2d.b2PulleyJoint.prototype,"m_groundAnchorA",box2d.b2PulleyJoint.prototype.m_groundAnchorA);box2d.b2PulleyJoint.prototype.m_groundAnchorB=null;goog.exportProperty(box2d.b2PulleyJoint.prototype,"m_groundAnchorB",box2d.b2PulleyJoint.prototype.m_groundAnchorB);box2d.b2PulleyJoint.prototype.m_lengthA=0;goog.exportProperty(box2d.b2PulleyJoint.prototype,"m_lengthA",box2d.b2PulleyJoint.prototype.m_lengthA);box2d.b2PulleyJoint.prototype.m_lengthB=0;goog.exportProperty(box2d.b2PulleyJoint.prototype,"m_lengthB",box2d.b2PulleyJoint.prototype.m_lengthB);box2d.b2PulleyJoint.prototype.m_localAnchorA=null;goog.exportProperty(box2d.b2PulleyJoint.prototype,"m_localAnchorA",box2d.b2PulleyJoint.prototype.m_localAnchorA);box2d.b2PulleyJoint.prototype.m_localAnchorB=null;goog.exportProperty(box2d.b2PulleyJoint.prototype,"m_localAnchorB",box2d.b2PulleyJoint.prototype.m_localAnchorB);box2d.b2PulleyJoint.prototype.m_constant=0;goog.exportProperty(box2d.b2PulleyJoint.prototype,"m_constant",box2d.b2PulleyJoint.prototype.m_constant);box2d.b2PulleyJoint.prototype.m_ratio=0;goog.exportProperty(box2d.b2PulleyJoint.prototype,"m_ratio",box2d.b2PulleyJoint.prototype.m_ratio);box2d.b2PulleyJoint.prototype.m_impulse=0;goog.exportProperty(box2d.b2PulleyJoint.prototype,"m_impulse",box2d.b2PulleyJoint.prototype.m_impulse);box2d.b2PulleyJoint.prototype.m_indexA=0;goog.exportProperty(box2d.b2PulleyJoint.prototype,"m_indexA",box2d.b2PulleyJoint.prototype.m_indexA);box2d.b2PulleyJoint.prototype.m_indexB=0;goog.exportProperty(box2d.b2PulleyJoint.prototype,"m_indexB",box2d.b2PulleyJoint.prototype.m_indexB);box2d.b2PulleyJoint.prototype.m_uA=null;goog.exportProperty(box2d.b2PulleyJoint.prototype,"m_uA",box2d.b2PulleyJoint.prototype.m_uA);box2d.b2PulleyJoint.prototype.m_uB=null;goog.exportProperty(box2d.b2PulleyJoint.prototype,"m_uB",box2d.b2PulleyJoint.prototype.m_uB);box2d.b2PulleyJoint.prototype.m_rA=null;goog.exportProperty(box2d.b2PulleyJoint.prototype,"m_rA",box2d.b2PulleyJoint.prototype.m_rA);box2d.b2PulleyJoint.prototype.m_rB=null;goog.exportProperty(box2d.b2PulleyJoint.prototype,"m_rB",box2d.b2PulleyJoint.prototype.m_rB);box2d.b2PulleyJoint.prototype.m_localCenterA=null;goog.exportProperty(box2d.b2PulleyJoint.prototype,"m_localCenterA",box2d.b2PulleyJoint.prototype.m_localCenterA);box2d.b2PulleyJoint.prototype.m_localCenterB=null;goog.exportProperty(box2d.b2PulleyJoint.prototype,"m_localCenterB",box2d.b2PulleyJoint.prototype.m_localCenterB);box2d.b2PulleyJoint.prototype.m_invMassA=0;goog.exportProperty(box2d.b2PulleyJoint.prototype,"m_invMassA",box2d.b2PulleyJoint.prototype.m_invMassA);box2d.b2PulleyJoint.prototype.m_invMassB=0;goog.exportProperty(box2d.b2PulleyJoint.prototype,"m_invMassB",box2d.b2PulleyJoint.prototype.m_invMassB);box2d.b2PulleyJoint.prototype.m_invIA=0;goog.exportProperty(box2d.b2PulleyJoint.prototype,"m_invIA",box2d.b2PulleyJoint.prototype.m_invIA);box2d.b2PulleyJoint.prototype.m_invIB=0;goog.exportProperty(box2d.b2PulleyJoint.prototype,"m_invIB",box2d.b2PulleyJoint.prototype.m_invIB);box2d.b2PulleyJoint.prototype.m_mass=0;goog.exportProperty(box2d.b2PulleyJoint.prototype,"m_mass",box2d.b2PulleyJoint.prototype.m_mass);box2d.b2PulleyJoint.prototype.m_qA=null;goog.exportProperty(box2d.b2PulleyJoint.prototype,"m_qA",box2d.b2PulleyJoint.prototype.m_qA);box2d.b2PulleyJoint.prototype.m_qB=null;goog.exportProperty(box2d.b2PulleyJoint.prototype,"m_qB",box2d.b2PulleyJoint.prototype.m_qB);box2d.b2PulleyJoint.prototype.m_lalcA=null;goog.exportProperty(box2d.b2PulleyJoint.prototype,"m_lalcA",box2d.b2PulleyJoint.prototype.m_lalcA);box2d.b2PulleyJoint.prototype.m_lalcB=null;goog.exportProperty(box2d.b2PulleyJoint.prototype,"m_lalcB",box2d.b2PulleyJoint.prototype.m_lalcB);box2d.b2PulleyJoint.prototype.InitVelocityConstraints=function(v){this.m_indexA=this.m_bodyA.m_islandIndex;this.m_indexB=this.m_bodyB.m_islandIndex;this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter);this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter);this.m_invMassA=this.m_bodyA.m_invMass;this.m_invMassB=this.m_bodyB.m_invMass;this.m_invIA=this.m_bodyA.m_invI;this.m_invIB=this.m_bodyB.m_invI;var u=v.positions[this.m_indexA].c,s=v.velocities[this.m_indexA].v,r=v.velocities[this.m_indexA].w,q=v.positions[this.m_indexB].c,n=v.positions[this.m_indexB].a,m=v.velocities[this.m_indexB].v,k=v.velocities[this.m_indexB].w,j=this.m_qA.SetAngleRadians(v.positions[this.m_indexA].a),n=this.m_qB.SetAngleRadians(n);box2d.b2SubVV(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA);box2d.b2MulRV(j,this.m_lalcA,this.m_rA);box2d.b2SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB);box2d.b2MulRV(n,this.m_lalcB,this.m_rB);this.m_uA.Copy(u).SelfAdd(this.m_rA).SelfSub(this.m_groundAnchorA);this.m_uB.Copy(q).SelfAdd(this.m_rB).SelfSub(this.m_groundAnchorB);u=this.m_uA.GetLength();q=this.m_uB.GetLength();u>10*box2d.b2_linearSlop?this.m_uA.SelfMul(1/u):this.m_uA.SetZero();q>10*box2d.b2_linearSlop?this.m_uB.SelfMul(1/q):this.m_uB.SetZero();u=box2d.b2CrossVV(this.m_rA,this.m_uA);q=box2d.b2CrossVV(this.m_rB,this.m_uB);this.m_mass=this.m_invMassA+this.m_invIA*u*u+this.m_ratio*this.m_ratio*(this.m_invMassB+this.m_invIB*q*q);0<this.m_mass&&(this.m_mass=1/this.m_mass);v.step.warmStarting?(this.m_impulse*=v.step.dtRatio,u=box2d.b2MulSV(-this.m_impulse,this.m_uA,box2d.b2PulleyJoint.prototype.InitVelocityConstraints.s_PA),q=box2d.b2MulSV(-this.m_ratio*this.m_impulse,this.m_uB,box2d.b2PulleyJoint.prototype.InitVelocityConstraints.s_PB),s.SelfMulAdd(this.m_invMassA,u),r+=this.m_invIA*box2d.b2CrossVV(this.m_rA,u),m.SelfMulAdd(this.m_invMassB,q),k+=this.m_invIB*box2d.b2CrossVV(this.m_rB,q)):this.m_impulse=0;v.velocities[this.m_indexA].w=r;v.velocities[this.m_indexB].w=k};goog.exportProperty(box2d.b2PulleyJoint.prototype,"InitVelocityConstraints",box2d.b2PulleyJoint.prototype.InitVelocityConstraints);box2d.b2PulleyJoint.prototype.InitVelocityConstraints.s_PA=new box2d.b2Vec2;box2d.b2PulleyJoint.prototype.InitVelocityConstraints.s_PB=new box2d.b2Vec2;box2d.b2PulleyJoint.prototype.SolveVelocityConstraints=function(k){var j=k.velocities[this.m_indexA].v,s=k.velocities[this.m_indexA].w,r=k.velocities[this.m_indexB].v,q=k.velocities[this.m_indexB].w,n=box2d.b2AddVCrossSV(j,s,this.m_rA,box2d.b2PulleyJoint.prototype.SolveVelocityConstraints.s_vpA),m=box2d.b2AddVCrossSV(r,q,this.m_rB,box2d.b2PulleyJoint.prototype.SolveVelocityConstraints.s_vpB),n=-box2d.b2DotVV(this.m_uA,n)-this.m_ratio*box2d.b2DotVV(this.m_uB,m),m=-this.m_mass*n;this.m_impulse+=m;n=box2d.b2MulSV(-m,this.m_uA,box2d.b2PulleyJoint.prototype.SolveVelocityConstraints.s_PA);m=box2d.b2MulSV(-this.m_ratio*m,this.m_uB,box2d.b2PulleyJoint.prototype.SolveVelocityConstraints.s_PB);j.SelfMulAdd(this.m_invMassA,n);s+=this.m_invIA*box2d.b2CrossVV(this.m_rA,n);r.SelfMulAdd(this.m_invMassB,m);q+=this.m_invIB*box2d.b2CrossVV(this.m_rB,m);k.velocities[this.m_indexA].w=s;k.velocities[this.m_indexB].w=q};goog.exportProperty(box2d.b2PulleyJoint.prototype,"SolveVelocityConstraints",box2d.b2PulleyJoint.prototype.SolveVelocityConstraints);box2d.b2PulleyJoint.prototype.SolveVelocityConstraints.s_vpA=new box2d.b2Vec2;box2d.b2PulleyJoint.prototype.SolveVelocityConstraints.s_vpB=new box2d.b2Vec2;box2d.b2PulleyJoint.prototype.SolveVelocityConstraints.s_PA=new box2d.b2Vec2;box2d.b2PulleyJoint.prototype.SolveVelocityConstraints.s_PB=new box2d.b2Vec2;box2d.b2PulleyJoint.prototype.SolvePositionConstraints=function(E){var D=E.positions[this.m_indexA].c,C=E.positions[this.m_indexA].a,B=E.positions[this.m_indexB].c,A=E.positions[this.m_indexB].a,z=this.m_qA.SetAngleRadians(C),y=this.m_qB.SetAngleRadians(A);box2d.b2SubVV(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA);z=box2d.b2MulRV(z,this.m_lalcA,this.m_rA);box2d.b2SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB);var y=box2d.b2MulRV(y,this.m_lalcB,this.m_rB),v=this.m_uA.Copy(D).SelfAdd(z).SelfSub(this.m_groundAnchorA),s=this.m_uB.Copy(B).SelfAdd(y).SelfSub(this.m_groundAnchorB),u=v.GetLength(),r=s.GetLength();u>10*box2d.b2_linearSlop?v.SelfMul(1/u):v.SetZero();r>10*box2d.b2_linearSlop?s.SelfMul(1/r):s.SetZero();var q=box2d.b2CrossVV(z,v),j=box2d.b2CrossVV(y,s),q=this.m_invMassA+this.m_invIA*q*q+this.m_ratio*this.m_ratio*(this.m_invMassB+this.m_invIB*j*j);0<q&&(q=1/q);r=this.m_constant-u-this.m_ratio*r;u=box2d.b2Abs(r);r*=-q;v=box2d.b2MulSV(-r,v,box2d.b2PulleyJoint.prototype.SolvePositionConstraints.s_PA);s=box2d.b2MulSV(-this.m_ratio*r,s,box2d.b2PulleyJoint.prototype.SolvePositionConstraints.s_PB);D.SelfMulAdd(this.m_invMassA,v);C+=this.m_invIA*box2d.b2CrossVV(z,v);B.SelfMulAdd(this.m_invMassB,s);A+=this.m_invIB*box2d.b2CrossVV(y,s);E.positions[this.m_indexA].a=C;E.positions[this.m_indexB].a=A;return u<box2d.b2_linearSlop};goog.exportProperty(box2d.b2PulleyJoint.prototype,"SolvePositionConstraints",box2d.b2PulleyJoint.prototype.SolvePositionConstraints);box2d.b2PulleyJoint.prototype.SolvePositionConstraints.s_PA=new box2d.b2Vec2;box2d.b2PulleyJoint.prototype.SolvePositionConstraints.s_PB=new box2d.b2Vec2;box2d.b2PulleyJoint.prototype.GetAnchorA=function(b){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,b)};goog.exportProperty(box2d.b2PulleyJoint.prototype,"GetAnchorA",box2d.b2PulleyJoint.prototype.GetAnchorA);box2d.b2PulleyJoint.prototype.GetAnchorB=function(b){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,b)};goog.exportProperty(box2d.b2PulleyJoint.prototype,"GetAnchorB",box2d.b2PulleyJoint.prototype.GetAnchorB);box2d.b2PulleyJoint.prototype.GetReactionForce=function(e,d){return d.SetXY(e*this.m_impulse*this.m_uB.x,e*this.m_impulse*this.m_uB.y)};goog.exportProperty(box2d.b2PulleyJoint.prototype,"GetReactionForce",box2d.b2PulleyJoint.prototype.GetReactionForce);box2d.b2PulleyJoint.prototype.GetReactionTorque=function(b){return 0};goog.exportProperty(box2d.b2PulleyJoint.prototype,"GetReactionTorque",box2d.b2PulleyJoint.prototype.GetReactionTorque);box2d.b2PulleyJoint.prototype.GetGroundAnchorA=function(b){return b.Copy(this.m_groundAnchorA)};goog.exportProperty(box2d.b2PulleyJoint.prototype,"GetGroundAnchorA",box2d.b2PulleyJoint.prototype.GetGroundAnchorA);box2d.b2PulleyJoint.prototype.GetGroundAnchorB=function(b){return b.Copy(this.m_groundAnchorB)};goog.exportProperty(box2d.b2PulleyJoint.prototype,"GetGroundAnchorB",box2d.b2PulleyJoint.prototype.GetGroundAnchorB);box2d.b2PulleyJoint.prototype.GetLengthA=function(){return this.m_lengthA};goog.exportProperty(box2d.b2PulleyJoint.prototype,"GetLengthA",box2d.b2PulleyJoint.prototype.GetLengthA);box2d.b2PulleyJoint.prototype.GetLengthB=function(){return this.m_lengthB};goog.exportProperty(box2d.b2PulleyJoint.prototype,"GetLengthB",box2d.b2PulleyJoint.prototype.GetLengthB);box2d.b2PulleyJoint.prototype.GetRatio=function(){return this.m_ratio};goog.exportProperty(box2d.b2PulleyJoint.prototype,"GetRatio",box2d.b2PulleyJoint.prototype.GetRatio);box2d.b2PulleyJoint.prototype.GetCurrentLengthA=function(){var b=this.m_bodyA.GetWorldPoint(this.m_localAnchorA,box2d.b2PulleyJoint.prototype.GetCurrentLengthA.s_p);return box2d.b2DistanceVV(b,this.m_groundAnchorA)};goog.exportProperty(box2d.b2PulleyJoint.prototype,"GetCurrentLengthA",box2d.b2PulleyJoint.prototype.GetCurrentLengthA);box2d.b2PulleyJoint.prototype.GetCurrentLengthA.s_p=new box2d.b2Vec2;box2d.b2PulleyJoint.prototype.GetCurrentLengthB=function(){var b=this.m_bodyB.GetWorldPoint(this.m_localAnchorB,box2d.b2PulleyJoint.prototype.GetCurrentLengthB.s_p);return box2d.b2DistanceVV(b,this.m_groundAnchorB)};goog.exportProperty(box2d.b2PulleyJoint.prototype,"GetCurrentLengthB",box2d.b2PulleyJoint.prototype.GetCurrentLengthB);box2d.b2PulleyJoint.prototype.GetCurrentLengthB.s_p=new box2d.b2Vec2;box2d.b2PulleyJoint.prototype.Dump=function(){if(box2d.DEBUG){var e=this.m_bodyA.m_islandIndex,d=this.m_bodyB.m_islandIndex;box2d.b2Log("  /*box2d.b2PulleyJointDef*/ var jd = new box2d.b2PulleyJointDef();\n");box2d.b2Log("  jd.bodyA = bodies[%d];\n",e);box2d.b2Log("  jd.bodyB = bodies[%d];\n",d);box2d.b2Log("  jd.collideConnected = %s;\n",this.m_collideConnected?"true":"false");box2d.b2Log("  jd.groundAnchorA.SetXY(%.15f, %.15f);\n",this.m_groundAnchorA.x,this.m_groundAnchorA.y);box2d.b2Log("  jd.groundAnchorB.SetXY(%.15f, %.15f);\n",this.m_groundAnchorB.x,this.m_groundAnchorB.y);box2d.b2Log("  jd.localAnchorA.SetXY(%.15f, %.15f);\n",this.m_localAnchorA.x,this.m_localAnchorA.y);box2d.b2Log("  jd.localAnchorB.SetXY(%.15f, %.15f);\n",this.m_localAnchorB.x,this.m_localAnchorB.y);box2d.b2Log("  jd.lengthA = %.15f;\n",this.m_lengthA);box2d.b2Log("  jd.lengthB = %.15f;\n",this.m_lengthB);box2d.b2Log("  jd.ratio = %.15f;\n",this.m_ratio);box2d.b2Log("  joints[%d] = this.m_world.CreateJoint(jd);\n",this.m_index)}};goog.exportProperty(box2d.b2PulleyJoint.prototype,"Dump",box2d.b2PulleyJoint.prototype.Dump);box2d.b2PulleyJoint.prototype.ShiftOrigin=function(b){this.m_groundAnchorA.SelfSub(b);this.m_groundAnchorB.SelfSub(b)};goog.exportProperty(box2d.b2PulleyJoint.prototype,"ShiftOrigin",box2d.b2PulleyJoint.prototype.ShiftOrigin);box2d.b2RevoluteJointDef=function(){box2d.b2JointDef.call(this,box2d.b2JointType.e_revoluteJoint);this.localAnchorA=new box2d.b2Vec2(0,0);this.localAnchorB=new box2d.b2Vec2(0,0)};goog.inherits(box2d.b2RevoluteJointDef,box2d.b2JointDef);goog.exportSymbol("box2d.b2RevoluteJointDef",box2d.b2RevoluteJointDef);box2d.b2RevoluteJointDef.prototype.localAnchorA=null;goog.exportProperty(box2d.b2RevoluteJointDef.prototype,"localAnchorA",box2d.b2RevoluteJointDef.prototype.localAnchorA);box2d.b2RevoluteJointDef.prototype.localAnchorB=null;goog.exportProperty(box2d.b2RevoluteJointDef.prototype,"localAnchorB",box2d.b2RevoluteJointDef.prototype.localAnchorB);box2d.b2RevoluteJointDef.prototype.referenceAngle=0;goog.exportProperty(box2d.b2RevoluteJointDef.prototype,"referenceAngle",box2d.b2RevoluteJointDef.prototype.referenceAngle);box2d.b2RevoluteJointDef.prototype.enableLimit=!1;goog.exportProperty(box2d.b2RevoluteJointDef.prototype,"enableLimit",box2d.b2RevoluteJointDef.prototype.enableLimit);box2d.b2RevoluteJointDef.prototype.lowerAngle=0;goog.exportProperty(box2d.b2RevoluteJointDef.prototype,"lowerAngle",box2d.b2RevoluteJointDef.prototype.lowerAngle);box2d.b2RevoluteJointDef.prototype.upperAngle=0;goog.exportProperty(box2d.b2RevoluteJointDef.prototype,"upperAngle",box2d.b2RevoluteJointDef.prototype.upperAngle);box2d.b2RevoluteJointDef.prototype.enableMotor=!1;goog.exportProperty(box2d.b2RevoluteJointDef.prototype,"enableMotor",box2d.b2RevoluteJointDef.prototype.enableMotor);box2d.b2RevoluteJointDef.prototype.motorSpeed=0;goog.exportProperty(box2d.b2RevoluteJointDef.prototype,"motorSpeed",box2d.b2RevoluteJointDef.prototype.motorSpeed);box2d.b2RevoluteJointDef.prototype.maxMotorTorque=0;goog.exportProperty(box2d.b2RevoluteJointDef.prototype,"maxMotorTorque",box2d.b2RevoluteJointDef.prototype.maxMotorTorque);box2d.b2RevoluteJointDef.prototype.Initialize=function(e,d,f){this.bodyA=e;this.bodyB=d;this.bodyA.GetLocalPoint(f,this.localAnchorA);this.bodyB.GetLocalPoint(f,this.localAnchorB);this.referenceAngle=this.bodyB.GetAngleRadians()-this.bodyA.GetAngleRadians()};goog.exportProperty(box2d.b2RevoluteJointDef.prototype,"Initialize",box2d.b2RevoluteJointDef.prototype.Initialize);box2d.b2RevoluteJoint=function(b){box2d.b2Joint.call(this,b);this.m_localAnchorA=new box2d.b2Vec2;this.m_localAnchorB=new box2d.b2Vec2;this.m_impulse=new box2d.b2Vec3;this.m_rA=new box2d.b2Vec2;this.m_rB=new box2d.b2Vec2;this.m_localCenterA=new box2d.b2Vec2;this.m_localCenterB=new box2d.b2Vec2;this.m_mass=new box2d.b2Mat33;this.m_qA=new box2d.b2Rot;this.m_qB=new box2d.b2Rot;this.m_lalcA=new box2d.b2Vec2;this.m_lalcB=new box2d.b2Vec2;this.m_K=new box2d.b2Mat22;this.m_localAnchorA.Copy(b.localAnchorA);this.m_localAnchorB.Copy(b.localAnchorB);this.m_referenceAngle=b.referenceAngle;this.m_impulse.SetZero();this.m_motorImpulse=0;this.m_lowerAngle=b.lowerAngle;this.m_upperAngle=b.upperAngle;this.m_maxMotorTorque=b.maxMotorTorque;this.m_motorSpeed=b.motorSpeed;this.m_enableLimit=b.enableLimit;this.m_enableMotor=b.enableMotor;this.m_limitState=box2d.b2LimitState.e_inactiveLimit};goog.inherits(box2d.b2RevoluteJoint,box2d.b2Joint);goog.exportSymbol("box2d.b2RevoluteJoint",box2d.b2RevoluteJoint);box2d.b2RevoluteJoint.prototype.m_localAnchorA=null;goog.exportProperty(box2d.b2RevoluteJoint.prototype,"m_localAnchorA",box2d.b2RevoluteJoint.prototype.m_localAnchorA);box2d.b2RevoluteJoint.prototype.m_localAnchorB=null;goog.exportProperty(box2d.b2RevoluteJoint.prototype,"m_localAnchorB",box2d.b2RevoluteJoint.prototype.m_localAnchorB);box2d.b2RevoluteJoint.prototype.m_impulse=null;goog.exportProperty(box2d.b2RevoluteJoint.prototype,"m_impulse",box2d.b2RevoluteJoint.prototype.m_impulse);box2d.b2RevoluteJoint.prototype.m_motorImpulse=0;goog.exportProperty(box2d.b2RevoluteJoint.prototype,"m_motorImpulse",box2d.b2RevoluteJoint.prototype.m_motorImpulse);box2d.b2RevoluteJoint.prototype.m_enableMotor=!1;goog.exportProperty(box2d.b2RevoluteJoint.prototype,"m_enableMotor",box2d.b2RevoluteJoint.prototype.m_enableMotor);box2d.b2RevoluteJoint.prototype.m_maxMotorTorque=0;goog.exportProperty(box2d.b2RevoluteJoint.prototype,"m_maxMotorTorque",box2d.b2RevoluteJoint.prototype.m_maxMotorTorque);box2d.b2RevoluteJoint.prototype.m_motorSpeed=0;goog.exportProperty(box2d.b2RevoluteJoint.prototype,"m_motorSpeed",box2d.b2RevoluteJoint.prototype.m_motorSpeed);box2d.b2RevoluteJoint.prototype.m_enableLimit=!1;goog.exportProperty(box2d.b2RevoluteJoint.prototype,"m_enableLimit",box2d.b2RevoluteJoint.prototype.m_enableLimit);box2d.b2RevoluteJoint.prototype.m_referenceAngle=0;goog.exportProperty(box2d.b2RevoluteJoint.prototype,"m_referenceAngle",box2d.b2RevoluteJoint.prototype.m_referenceAngle);box2d.b2RevoluteJoint.prototype.m_lowerAngle=0;goog.exportProperty(box2d.b2RevoluteJoint.prototype,"m_lowerAngle",box2d.b2RevoluteJoint.prototype.m_lowerAngle);box2d.b2RevoluteJoint.prototype.m_upperAngle=0;goog.exportProperty(box2d.b2RevoluteJoint.prototype,"m_upperAngle",box2d.b2RevoluteJoint.prototype.m_upperAngle);box2d.b2RevoluteJoint.prototype.m_indexA=0;goog.exportProperty(box2d.b2RevoluteJoint.prototype,"m_indexA",box2d.b2RevoluteJoint.prototype.m_indexA);box2d.b2RevoluteJoint.prototype.m_indexB=0;goog.exportProperty(box2d.b2RevoluteJoint.prototype,"m_indexB",box2d.b2RevoluteJoint.prototype.m_indexB);box2d.b2RevoluteJoint.prototype.m_rA=null;goog.exportProperty(box2d.b2RevoluteJoint.prototype,"m_rA",box2d.b2RevoluteJoint.prototype.m_rA);box2d.b2RevoluteJoint.prototype.m_rB=null;goog.exportProperty(box2d.b2RevoluteJoint.prototype,"m_rB",box2d.b2RevoluteJoint.prototype.m_rB);box2d.b2RevoluteJoint.prototype.m_localCenterA=null;goog.exportProperty(box2d.b2RevoluteJoint.prototype,"m_localCenterA",box2d.b2RevoluteJoint.prototype.m_localCenterA);box2d.b2RevoluteJoint.prototype.m_localCenterB=null;goog.exportProperty(box2d.b2RevoluteJoint.prototype,"m_localCenterB",box2d.b2RevoluteJoint.prototype.m_localCenterB);box2d.b2RevoluteJoint.prototype.m_invMassA=0;goog.exportProperty(box2d.b2RevoluteJoint.prototype,"m_invMassA",box2d.b2RevoluteJoint.prototype.m_invMassA);box2d.b2RevoluteJoint.prototype.m_invMassB=0;goog.exportProperty(box2d.b2RevoluteJoint.prototype,"m_invMassB",box2d.b2RevoluteJoint.prototype.m_invMassB);box2d.b2RevoluteJoint.prototype.m_invIA=0;goog.exportProperty(box2d.b2RevoluteJoint.prototype,"m_invIA",box2d.b2RevoluteJoint.prototype.m_invIA);box2d.b2RevoluteJoint.prototype.m_invIB=0;goog.exportProperty(box2d.b2RevoluteJoint.prototype,"m_invIB",box2d.b2RevoluteJoint.prototype.m_invIB);box2d.b2RevoluteJoint.prototype.m_mass=null;goog.exportProperty(box2d.b2RevoluteJoint.prototype,"m_mass",box2d.b2RevoluteJoint.prototype.m_mass);box2d.b2RevoluteJoint.prototype.m_motorMass=0;goog.exportProperty(box2d.b2RevoluteJoint.prototype,"m_motorMass",box2d.b2RevoluteJoint.prototype.m_motorMass);box2d.b2RevoluteJoint.prototype.m_limitState=box2d.b2LimitState.e_inactiveLimit;goog.exportProperty(box2d.b2RevoluteJoint.prototype,"m_limitState",box2d.b2RevoluteJoint.prototype.m_limitState);box2d.b2RevoluteJoint.prototype.m_qA=null;goog.exportProperty(box2d.b2RevoluteJoint.prototype,"m_qA",box2d.b2RevoluteJoint.prototype.m_qA);box2d.b2RevoluteJoint.prototype.m_qB=null;goog.exportProperty(box2d.b2RevoluteJoint.prototype,"m_qB",box2d.b2RevoluteJoint.prototype.m_qB);box2d.b2RevoluteJoint.prototype.m_lalcA=null;goog.exportProperty(box2d.b2RevoluteJoint.prototype,"m_lalcA",box2d.b2RevoluteJoint.prototype.m_lalcA);box2d.b2RevoluteJoint.prototype.m_lalcB=null;goog.exportProperty(box2d.b2RevoluteJoint.prototype,"m_lalcB",box2d.b2RevoluteJoint.prototype.m_lalcB);box2d.b2RevoluteJoint.prototype.m_K=null;goog.exportProperty(box2d.b2RevoluteJoint.prototype,"m_K",box2d.b2RevoluteJoint.prototype.m_K);box2d.b2RevoluteJoint.prototype.InitVelocityConstraints=function(D){this.m_indexA=this.m_bodyA.m_islandIndex;this.m_indexB=this.m_bodyB.m_islandIndex;this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter);this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter);this.m_invMassA=this.m_bodyA.m_invMass;this.m_invMassB=this.m_bodyB.m_invMass;this.m_invIA=this.m_bodyA.m_invI;this.m_invIB=this.m_bodyB.m_invI;var C=D.positions[this.m_indexA].a,B=D.velocities[this.m_indexA].v,A=D.velocities[this.m_indexA].w,z=D.positions[this.m_indexB].a,y=D.velocities[this.m_indexB].v,v=D.velocities[this.m_indexB].w,u=this.m_qA.SetAngleRadians(C),r=this.m_qB.SetAngleRadians(z);box2d.b2SubVV(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA);box2d.b2MulRV(u,this.m_lalcA,this.m_rA);box2d.b2SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB);box2d.b2MulRV(r,this.m_lalcB,this.m_rB);var u=this.m_invMassA,r=this.m_invMassB,s=this.m_invIA,q=this.m_invIB,j=0===s+q;this.m_mass.ex.x=u+r+this.m_rA.y*this.m_rA.y*s+this.m_rB.y*this.m_rB.y*q;this.m_mass.ey.x=-this.m_rA.y*this.m_rA.x*s-this.m_rB.y*this.m_rB.x*q;this.m_mass.ez.x=-this.m_rA.y*s-this.m_rB.y*q;this.m_mass.ex.y=this.m_mass.ey.x;this.m_mass.ey.y=u+r+this.m_rA.x*this.m_rA.x*s+this.m_rB.x*this.m_rB.x*q;this.m_mass.ez.y=this.m_rA.x*s+this.m_rB.x*q;this.m_mass.ex.z=this.m_mass.ez.x;this.m_mass.ey.z=this.m_mass.ez.y;this.m_mass.ez.z=s+q;this.m_motorMass=s+q;0<this.m_motorMass&&(this.m_motorMass=1/this.m_motorMass);if(!1===this.m_enableMotor||j){this.m_motorImpulse=0}this.m_enableLimit&&!1===j?(C=z-C-this.m_referenceAngle,box2d.b2Abs(this.m_upperAngle-this.m_lowerAngle)<2*box2d.b2_angularSlop?this.m_limitState=box2d.b2LimitState.e_equalLimits:C<=this.m_lowerAngle?(this.m_limitState!==box2d.b2LimitState.e_atLowerLimit&&(this.m_impulse.z=0),this.m_limitState=box2d.b2LimitState.e_atLowerLimit):C>=this.m_upperAngle?(this.m_limitState!==box2d.b2LimitState.e_atUpperLimit&&(this.m_impulse.z=0),this.m_limitState=box2d.b2LimitState.e_atUpperLimit):(this.m_limitState=box2d.b2LimitState.e_inactiveLimit,this.m_impulse.z=0)):this.m_limitState=box2d.b2LimitState.e_inactiveLimit;D.step.warmStarting?(this.m_impulse.SelfMul(D.step.dtRatio),this.m_motorImpulse*=D.step.dtRatio,C=box2d.b2RevoluteJoint.prototype.InitVelocityConstraints.s_P.SetXY(this.m_impulse.x,this.m_impulse.y),B.SelfMulSub(u,C),A-=s*(box2d.b2CrossVV(this.m_rA,C)+this.m_motorImpulse+this.m_impulse.z),y.SelfMulAdd(r,C),v+=q*(box2d.b2CrossVV(this.m_rB,C)+this.m_motorImpulse+this.m_impulse.z)):(this.m_impulse.SetZero(),this.m_motorImpulse=0);D.velocities[this.m_indexA].w=A;D.velocities[this.m_indexB].w=v};goog.exportProperty(box2d.b2RevoluteJoint.prototype,"InitVelocityConstraints",box2d.b2RevoluteJoint.prototype.InitVelocityConstraints);box2d.b2RevoluteJoint.prototype.InitVelocityConstraints.s_P=new box2d.b2Vec2;box2d.b2RevoluteJoint.prototype.SolveVelocityConstraints=function(E){var D=E.velocities[this.m_indexA].v,C=E.velocities[this.m_indexA].w,B=E.velocities[this.m_indexB].v,A=E.velocities[this.m_indexB].w,z=this.m_invMassA,y=this.m_invMassB,v=this.m_invIA,s=this.m_invIB,u=0===v+s;if(this.m_enableMotor&&this.m_limitState!==box2d.b2LimitState.e_equalLimits&&!1===u){var r=A-C-this.m_motorSpeed,r=-this.m_motorMass*r,q=this.m_motorImpulse,j=E.step.dt*this.m_maxMotorTorque;this.m_motorImpulse=box2d.b2Clamp(this.m_motorImpulse+r,-j,j);r=this.m_motorImpulse-q;C-=v*r;A+=s*r}this.m_enableLimit&&this.m_limitState!==box2d.b2LimitState.e_inactiveLimit&&!1===u?(u=box2d.b2SubVV(box2d.b2AddVCrossSV(B,A,this.m_rB,box2d.b2Vec2.s_t0),box2d.b2AddVCrossSV(D,C,this.m_rA,box2d.b2Vec2.s_t1),box2d.b2RevoluteJoint.prototype.SolveVelocityConstraints.s_Cdot1),r=this.m_mass.Solve33(u.x,u.y,A-C,box2d.b2RevoluteJoint.prototype.SolveVelocityConstraints.s_impulse3).SelfNeg(),this.m_limitState===box2d.b2LimitState.e_equalLimits?this.m_impulse.SelfAdd(r):this.m_limitState===box2d.b2LimitState.e_atLowerLimit?(q=this.m_impulse.z+r.z,0>q?(q=-u.x+this.m_impulse.z*this.m_mass.ez.x,u=-u.y+this.m_impulse.z*this.m_mass.ez.y,u=this.m_mass.Solve22(q,u,box2d.b2RevoluteJoint.prototype.SolveVelocityConstraints.s_reduced),r.x=u.x,r.y=u.y,r.z=-this.m_impulse.z,this.m_impulse.x+=u.x,this.m_impulse.y+=u.y,this.m_impulse.z=0):this.m_impulse.SelfAdd(r)):this.m_limitState===box2d.b2LimitState.e_atUpperLimit&&(q=this.m_impulse.z+r.z,0<q?(q=-u.x+this.m_impulse.z*this.m_mass.ez.x,u=-u.y+this.m_impulse.z*this.m_mass.ez.y,u=this.m_mass.Solve22(q,u,box2d.b2RevoluteJoint.prototype.SolveVelocityConstraints.s_reduced),r.x=u.x,r.y=u.y,r.z=-this.m_impulse.z,this.m_impulse.x+=u.x,this.m_impulse.y+=u.y,this.m_impulse.z=0):this.m_impulse.SelfAdd(r)),u=box2d.b2RevoluteJoint.prototype.SolveVelocityConstraints.s_P.SetXY(r.x,r.y),D.SelfMulSub(z,u),C-=v*(box2d.b2CrossVV(this.m_rA,u)+r.z),B.SelfMulAdd(y,u),A+=s*(box2d.b2CrossVV(this.m_rB,u)+r.z)):(r=box2d.b2SubVV(box2d.b2AddVCrossSV(B,A,this.m_rB,box2d.b2Vec2.s_t0),box2d.b2AddVCrossSV(D,C,this.m_rA,box2d.b2Vec2.s_t1),box2d.b2RevoluteJoint.prototype.SolveVelocityConstraints.s_Cdot),r=this.m_mass.Solve22(-r.x,-r.y,box2d.b2RevoluteJoint.prototype.SolveVelocityConstraints.s_impulse2),this.m_impulse.x+=r.x,this.m_impulse.y+=r.y,D.SelfMulSub(z,r),C-=v*box2d.b2CrossVV(this.m_rA,r),B.SelfMulAdd(y,r),A+=s*box2d.b2CrossVV(this.m_rB,r));E.velocities[this.m_indexA].w=C;E.velocities[this.m_indexB].w=A};goog.exportProperty(box2d.b2RevoluteJoint.prototype,"SolveVelocityConstraints",box2d.b2RevoluteJoint.prototype.SolveVelocityConstraints);box2d.b2RevoluteJoint.prototype.SolveVelocityConstraints.s_P=new box2d.b2Vec2;box2d.b2RevoluteJoint.prototype.SolveVelocityConstraints.s_Cdot=new box2d.b2Vec2;box2d.b2RevoluteJoint.prototype.SolveVelocityConstraints.s_Cdot1=new box2d.b2Vec2;box2d.b2RevoluteJoint.prototype.SolveVelocityConstraints.s_impulse3=new box2d.b2Vec3;box2d.b2RevoluteJoint.prototype.SolveVelocityConstraints.s_reduced=new box2d.b2Vec2;box2d.b2RevoluteJoint.prototype.SolveVelocityConstraints.s_impulse2=new box2d.b2Vec2;box2d.b2RevoluteJoint.prototype.SolvePositionConstraints=function(I){var H=I.positions[this.m_indexA].c,G=I.positions[this.m_indexA].a,F=I.positions[this.m_indexB].c,E=I.positions[this.m_indexB].a,D=this.m_qA.SetAngleRadians(G),C=this.m_qB.SetAngleRadians(E),B=0,z=0,z=0===this.m_invIA+this.m_invIB;if(this.m_enableLimit&&this.m_limitState!==box2d.b2LimitState.e_inactiveLimit&&!1===z){var A=E-G-this.m_referenceAngle,z=0;this.m_limitState===box2d.b2LimitState.e_equalLimits?(A=box2d.b2Clamp(A-this.m_lowerAngle,-box2d.b2_maxAngularCorrection,box2d.b2_maxAngularCorrection),z=-this.m_motorMass*A,B=box2d.b2Abs(A)):this.m_limitState===box2d.b2LimitState.e_atLowerLimit?(A-=this.m_lowerAngle,B=-A,A=box2d.b2Clamp(A+box2d.b2_angularSlop,-box2d.b2_maxAngularCorrection,0),z=-this.m_motorMass*A):this.m_limitState===box2d.b2LimitState.e_atUpperLimit&&(B=A-=this.m_upperAngle,A=box2d.b2Clamp(A-box2d.b2_angularSlop,0,box2d.b2_maxAngularCorrection),z=-this.m_motorMass*A);G-=this.m_invIA*z;E+=this.m_invIB*z}D.SetAngleRadians(G);C.SetAngleRadians(E);box2d.b2SubVV(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA);D=box2d.b2MulRV(D,this.m_lalcA,this.m_rA);box2d.b2SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB);var C=box2d.b2MulRV(C,this.m_lalcB,this.m_rB),A=box2d.b2SubVV(box2d.b2AddVV(F,C,box2d.b2Vec2.s_t0),box2d.b2AddVV(H,D,box2d.b2Vec2.s_t1),box2d.b2RevoluteJoint.prototype.SolvePositionConstraints.s_C),z=A.GetLength(),y=this.m_invMassA,v=this.m_invMassB,u=this.m_invIA,s=this.m_invIB,j=this.m_K;j.ex.x=y+v+u*D.y*D.y+s*C.y*C.y;j.ex.y=-u*D.x*D.y-s*C.x*C.y;j.ey.x=j.ex.y;j.ey.y=y+v+u*D.x*D.x+s*C.x*C.x;A=j.Solve(A.x,A.y,box2d.b2RevoluteJoint.prototype.SolvePositionConstraints.s_impulse).SelfNeg();H.SelfMulSub(y,A);G-=u*box2d.b2CrossVV(D,A);F.SelfMulAdd(v,A);E+=s*box2d.b2CrossVV(C,A);I.positions[this.m_indexA].a=G;I.positions[this.m_indexB].a=E;return z<=box2d.b2_linearSlop&&B<=box2d.b2_angularSlop};goog.exportProperty(box2d.b2RevoluteJoint.prototype,"SolvePositionConstraints",box2d.b2RevoluteJoint.prototype.SolvePositionConstraints);box2d.b2RevoluteJoint.prototype.SolvePositionConstraints.s_C=new box2d.b2Vec2;box2d.b2RevoluteJoint.prototype.SolvePositionConstraints.s_impulse=new box2d.b2Vec2;box2d.b2RevoluteJoint.prototype.GetAnchorA=function(b){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,b)};goog.exportProperty(box2d.b2RevoluteJoint.prototype,"GetAnchorA",box2d.b2RevoluteJoint.prototype.GetAnchorA);box2d.b2RevoluteJoint.prototype.GetAnchorB=function(b){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,b)};goog.exportProperty(box2d.b2RevoluteJoint.prototype,"GetAnchorB",box2d.b2RevoluteJoint.prototype.GetAnchorB);box2d.b2RevoluteJoint.prototype.GetReactionForce=function(e,d){return d.SetXY(e*this.m_impulse.x,e*this.m_impulse.y)};goog.exportProperty(box2d.b2RevoluteJoint.prototype,"GetReactionForce",box2d.b2RevoluteJoint.prototype.GetReactionForce);box2d.b2RevoluteJoint.prototype.GetReactionTorque=function(b){return b*this.m_impulse.z};goog.exportProperty(box2d.b2RevoluteJoint.prototype,"GetReactionTorque",box2d.b2RevoluteJoint.prototype.GetReactionTorque);box2d.b2RevoluteJoint.prototype.GetLocalAnchorA=function(b){return b.Copy(this.m_localAnchorA)};goog.exportProperty(box2d.b2RevoluteJoint.prototype,"GetLocalAnchorA",box2d.b2RevoluteJoint.prototype.GetLocalAnchorA);box2d.b2RevoluteJoint.prototype.GetLocalAnchorB=function(b){return b.Copy(this.m_localAnchorB)};goog.exportProperty(box2d.b2RevoluteJoint.prototype,"GetLocalAnchorB",box2d.b2RevoluteJoint.prototype.GetLocalAnchorB);box2d.b2RevoluteJoint.prototype.GetReferenceAngle=function(){return this.m_referenceAngle};goog.exportProperty(box2d.b2RevoluteJoint.prototype,"GetReferenceAngle",box2d.b2RevoluteJoint.prototype.GetReferenceAngle);box2d.b2RevoluteJoint.prototype.GetJointAngle=function(){return this.m_bodyB.m_sweep.a-this.m_bodyA.m_sweep.a-this.m_referenceAngle};goog.exportProperty(box2d.b2RevoluteJoint.prototype,"GetJointAngle",box2d.b2RevoluteJoint.prototype.GetJointAngle);box2d.b2RevoluteJoint.prototype.GetJointSpeed=function(){return this.m_bodyB.m_angularVelocity-this.m_bodyA.m_angularVelocity};goog.exportProperty(box2d.b2RevoluteJoint.prototype,"GetJointSpeed",box2d.b2RevoluteJoint.prototype.GetJointSpeed);box2d.b2RevoluteJoint.prototype.IsMotorEnabled=function(){return this.m_enableMotor};goog.exportProperty(box2d.b2RevoluteJoint.prototype,"IsMotorEnabled",box2d.b2RevoluteJoint.prototype.IsMotorEnabled);box2d.b2RevoluteJoint.prototype.EnableMotor=function(b){this.m_enableMotor!==b&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableMotor=b)};goog.exportProperty(box2d.b2RevoluteJoint.prototype,"EnableMotor",box2d.b2RevoluteJoint.prototype.EnableMotor);box2d.b2RevoluteJoint.prototype.GetMotorTorque=function(b){return b*this.m_motorImpulse};goog.exportProperty(box2d.b2RevoluteJoint.prototype,"GetMotorTorque",box2d.b2RevoluteJoint.prototype.GetMotorTorque);box2d.b2RevoluteJoint.prototype.GetMotorSpeed=function(){return this.m_motorSpeed};goog.exportProperty(box2d.b2RevoluteJoint.prototype,"GetMotorSpeed",box2d.b2RevoluteJoint.prototype.GetMotorSpeed);box2d.b2RevoluteJoint.prototype.SetMaxMotorTorque=function(b){this.m_maxMotorTorque=b};goog.exportProperty(box2d.b2RevoluteJoint.prototype,"SetMaxMotorTorque",box2d.b2RevoluteJoint.prototype.SetMaxMotorTorque);box2d.b2RevoluteJoint.prototype.GetMaxMotorTorque=function(){return this.m_maxMotorTorque};goog.exportProperty(box2d.b2RevoluteJoint.prototype,"GetMaxMotorTorque",box2d.b2RevoluteJoint.prototype.GetMaxMotorTorque);box2d.b2RevoluteJoint.prototype.IsLimitEnabled=function(){return this.m_enableLimit};goog.exportProperty(box2d.b2RevoluteJoint.prototype,"IsLimitEnabled",box2d.b2RevoluteJoint.prototype.IsLimitEnabled);box2d.b2RevoluteJoint.prototype.EnableLimit=function(b){b!==this.m_enableLimit&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableLimit=b,this.m_impulse.z=0)};goog.exportProperty(box2d.b2RevoluteJoint.prototype,"EnableLimit",box2d.b2RevoluteJoint.prototype.EnableLimit);box2d.b2RevoluteJoint.prototype.GetLowerLimit=function(){return this.m_lowerAngle};goog.exportProperty(box2d.b2RevoluteJoint.prototype,"GetLowerLimit",box2d.b2RevoluteJoint.prototype.GetLowerLimit);box2d.b2RevoluteJoint.prototype.GetUpperLimit=function(){return this.m_upperAngle};goog.exportProperty(box2d.b2RevoluteJoint.prototype,"GetUpperLimit",box2d.b2RevoluteJoint.prototype.GetUpperLimit);box2d.b2RevoluteJoint.prototype.SetLimits=function(e,d){if(e!==this.m_lowerAngle||d!==this.m_upperAngle){this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_impulse.z=0,this.m_lowerAngle=e,this.m_upperAngle=d}};goog.exportProperty(box2d.b2RevoluteJoint.prototype,"SetLimits",box2d.b2RevoluteJoint.prototype.SetLimits);box2d.b2RevoluteJoint.prototype.SetMotorSpeed=function(b){this.m_motorSpeed!==b&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_motorSpeed=b)};goog.exportProperty(box2d.b2RevoluteJoint.prototype,"SetMotorSpeed",box2d.b2RevoluteJoint.prototype.SetMotorSpeed);box2d.b2RevoluteJoint.prototype.Dump=function(){if(box2d.DEBUG){var e=this.m_bodyA.m_islandIndex,d=this.m_bodyB.m_islandIndex;box2d.b2Log("  /*box2d.b2RevoluteJointDef*/ var jd = new box2d.b2RevoluteJointDef();\n");box2d.b2Log("  jd.bodyA = bodies[%d];\n",e);box2d.b2Log("  jd.bodyB = bodies[%d];\n",d);box2d.b2Log("  jd.collideConnected = %s;\n",this.m_collideConnected?"true":"false");box2d.b2Log("  jd.localAnchorA.SetXY(%.15f, %.15f);\n",this.m_localAnchorA.x,this.m_localAnchorA.y);box2d.b2Log("  jd.localAnchorB.SetXY(%.15f, %.15f);\n",this.m_localAnchorB.x,this.m_localAnchorB.y);box2d.b2Log("  jd.referenceAngle = %.15f;\n",this.m_referenceAngle);box2d.b2Log("  jd.enableLimit = %s;\n",this.m_enableLimit?"true":"false");box2d.b2Log("  jd.lowerAngle = %.15f;\n",this.m_lowerAngle);box2d.b2Log("  jd.upperAngle = %.15f;\n",this.m_upperAngle);box2d.b2Log("  jd.enableMotor = %s;\n",this.m_enableMotor?"true":"false");box2d.b2Log("  jd.motorSpeed = %.15f;\n",this.m_motorSpeed);box2d.b2Log("  jd.maxMotorTorque = %.15f;\n",this.m_maxMotorTorque);box2d.b2Log("  joints[%d] = this.m_world.CreateJoint(jd);\n",this.m_index)}};goog.exportProperty(box2d.b2RevoluteJoint.prototype,"Dump",box2d.b2RevoluteJoint.prototype.Dump);box2d.b2GearJointDef=function(){box2d.b2JointDef.call(this,box2d.b2JointType.e_gearJoint)};goog.inherits(box2d.b2GearJointDef,box2d.b2JointDef);goog.exportSymbol("box2d.b2GearJointDef",box2d.b2GearJointDef);box2d.b2GearJointDef.prototype.joint1=null;goog.exportProperty(box2d.b2GearJointDef.prototype,"joint1",box2d.b2GearJointDef.prototype.joint1);box2d.b2GearJointDef.prototype.joint2=null;goog.exportProperty(box2d.b2GearJointDef.prototype,"joint2",box2d.b2GearJointDef.prototype.joint2);box2d.b2GearJointDef.prototype.ratio=1;goog.exportProperty(box2d.b2GearJointDef.prototype,"ratio",box2d.b2GearJointDef.prototype.ratio);box2d.b2GearJoint=function(j){box2d.b2Joint.call(this,j);this.m_joint1=j.joint1;this.m_joint2=j.joint2;this.m_localAnchorA=new box2d.b2Vec2;this.m_localAnchorB=new box2d.b2Vec2;this.m_localAnchorC=new box2d.b2Vec2;this.m_localAnchorD=new box2d.b2Vec2;this.m_localAxisC=new box2d.b2Vec2;this.m_localAxisD=new box2d.b2Vec2;this.m_lcA=new box2d.b2Vec2;this.m_lcB=new box2d.b2Vec2;this.m_lcC=new box2d.b2Vec2;this.m_lcD=new box2d.b2Vec2;this.m_JvAC=new box2d.b2Vec2;this.m_JvBD=new box2d.b2Vec2;this.m_qA=new box2d.b2Rot;this.m_qB=new box2d.b2Rot;this.m_qC=new box2d.b2Rot;this.m_qD=new box2d.b2Rot;this.m_lalcA=new box2d.b2Vec2;this.m_lalcB=new box2d.b2Vec2;this.m_lalcC=new box2d.b2Vec2;this.m_lalcD=new box2d.b2Vec2;this.m_typeA=this.m_joint1.GetType();this.m_typeB=this.m_joint2.GetType();box2d.ENABLE_ASSERTS&&box2d.b2Assert(this.m_typeA===box2d.b2JointType.e_revoluteJoint||this.m_typeA===box2d.b2JointType.e_prismaticJoint);box2d.ENABLE_ASSERTS&&box2d.b2Assert(this.m_typeB===box2d.b2JointType.e_revoluteJoint||this.m_typeB===box2d.b2JointType.e_prismaticJoint);var g,q;this.m_bodyC=this.m_joint1.GetBodyA();this.m_bodyA=this.m_joint1.GetBodyB();g=this.m_bodyA.m_xf;var n=this.m_bodyA.m_sweep.a;q=this.m_bodyC.m_xf;var m=this.m_bodyC.m_sweep.a;this.m_typeA===box2d.b2JointType.e_revoluteJoint?(q=j.joint1,this.m_localAnchorC.Copy(q.m_localAnchorA),this.m_localAnchorA.Copy(q.m_localAnchorB),this.m_referenceAngleA=q.m_referenceAngle,this.m_localAxisC.SetZero(),g=n-m-this.m_referenceAngleA):(m=j.joint1,this.m_localAnchorC.Copy(m.m_localAnchorA),this.m_localAnchorA.Copy(m.m_localAnchorB),this.m_referenceAngleA=m.m_referenceAngle,this.m_localAxisC.Copy(m.m_localXAxisA),n=this.m_localAnchorC,g=box2d.b2MulTRV(q.q,box2d.b2AddVV(box2d.b2MulRV(g.q,this.m_localAnchorA,box2d.b2Vec2.s_t0),box2d.b2SubVV(g.p,q.p,box2d.b2Vec2.s_t1),box2d.b2Vec2.s_t0),box2d.b2Vec2.s_t0),g=box2d.b2DotVV(box2d.b2SubVV(g,n,box2d.b2Vec2.s_t0),this.m_localAxisC));this.m_bodyD=this.m_joint2.GetBodyA();this.m_bodyB=this.m_joint2.GetBodyB();q=this.m_bodyB.m_xf;var m=this.m_bodyB.m_sweep.a,n=this.m_bodyD.m_xf,k=this.m_bodyD.m_sweep.a;this.m_typeB===box2d.b2JointType.e_revoluteJoint?(q=j.joint2,this.m_localAnchorD.Copy(q.m_localAnchorA),this.m_localAnchorB.Copy(q.m_localAnchorB),this.m_referenceAngleB=q.m_referenceAngle,this.m_localAxisD.SetZero(),q=m-k-this.m_referenceAngleB):(m=j.joint2,this.m_localAnchorD.Copy(m.m_localAnchorA),this.m_localAnchorB.Copy(m.m_localAnchorB),this.m_referenceAngleB=m.m_referenceAngle,this.m_localAxisD.Copy(m.m_localXAxisA),m=this.m_localAnchorD,q=box2d.b2MulTRV(n.q,box2d.b2AddVV(box2d.b2MulRV(q.q,this.m_localAnchorB,box2d.b2Vec2.s_t0),box2d.b2SubVV(q.p,n.p,box2d.b2Vec2.s_t1),box2d.b2Vec2.s_t0),box2d.b2Vec2.s_t0),q=box2d.b2DotVV(box2d.b2SubVV(q,m,box2d.b2Vec2.s_t0),this.m_localAxisD));this.m_ratio=j.ratio;this.m_constant=g+this.m_ratio*q;this.m_impulse=0};goog.inherits(box2d.b2GearJoint,box2d.b2Joint);goog.exportSymbol("box2d.b2GearJoint",box2d.b2GearJoint);box2d.b2GearJoint.prototype.m_joint1=null;goog.exportProperty(box2d.b2GearJoint.prototype,"m_joint1",box2d.b2GearJoint.prototype.m_joint1);box2d.b2GearJoint.prototype.m_joint2=null;goog.exportProperty(box2d.b2GearJoint.prototype,"m_joint2",box2d.b2GearJoint.prototype.m_joint2);box2d.b2GearJoint.prototype.m_typeA=box2d.b2JointType.e_unknownJoint;goog.exportProperty(box2d.b2GearJoint.prototype,"m_typeA",box2d.b2GearJoint.prototype.m_typeA);box2d.b2GearJoint.prototype.m_typeB=box2d.b2JointType.e_unknownJoint;goog.exportProperty(box2d.b2GearJoint.prototype,"m_typeB",box2d.b2GearJoint.prototype.m_typeB);box2d.b2GearJoint.prototype.m_bodyC=null;goog.exportProperty(box2d.b2GearJoint.prototype,"m_bodyC",box2d.b2GearJoint.prototype.m_bodyC);box2d.b2GearJoint.prototype.m_bodyD=null;goog.exportProperty(box2d.b2GearJoint.prototype,"m_bodyD",box2d.b2GearJoint.prototype.m_bodyD);box2d.b2GearJoint.prototype.m_localAnchorA=null;goog.exportProperty(box2d.b2GearJoint.prototype,"m_localAnchorA",box2d.b2GearJoint.prototype.m_localAnchorA);box2d.b2GearJoint.prototype.m_localAnchorB=null;goog.exportProperty(box2d.b2GearJoint.prototype,"m_localAnchorB",box2d.b2GearJoint.prototype.m_localAnchorB);box2d.b2GearJoint.prototype.m_localAnchorC=null;goog.exportProperty(box2d.b2GearJoint.prototype,"m_localAnchorC",box2d.b2GearJoint.prototype.m_localAnchorC);box2d.b2GearJoint.prototype.m_localAnchorD=null;goog.exportProperty(box2d.b2GearJoint.prototype,"m_localAnchorD",box2d.b2GearJoint.prototype.m_localAnchorD);box2d.b2GearJoint.prototype.m_localAxisC=null;goog.exportProperty(box2d.b2GearJoint.prototype,"m_localAxisC",box2d.b2GearJoint.prototype.m_localAxisC);box2d.b2GearJoint.prototype.m_localAxisD=null;goog.exportProperty(box2d.b2GearJoint.prototype,"m_localAxisD",box2d.b2GearJoint.prototype.m_localAxisD);box2d.b2GearJoint.prototype.m_referenceAngleA=0;goog.exportProperty(box2d.b2GearJoint.prototype,"m_referenceAngleA",box2d.b2GearJoint.prototype.m_referenceAngleA);box2d.b2GearJoint.prototype.m_referenceAngleB=0;goog.exportProperty(box2d.b2GearJoint.prototype,"m_referenceAngleB",box2d.b2GearJoint.prototype.m_referenceAngleB);box2d.b2GearJoint.prototype.m_constant=0;goog.exportProperty(box2d.b2GearJoint.prototype,"m_constant",box2d.b2GearJoint.prototype.m_constant);box2d.b2GearJoint.prototype.m_ratio=0;goog.exportProperty(box2d.b2GearJoint.prototype,"m_ratio",box2d.b2GearJoint.prototype.m_ratio);box2d.b2GearJoint.prototype.m_impulse=0;goog.exportProperty(box2d.b2GearJoint.prototype,"m_impulse",box2d.b2GearJoint.prototype.m_impulse);box2d.b2GearJoint.prototype.m_indexA=0;goog.exportProperty(box2d.b2GearJoint.prototype,"m_indexA",box2d.b2GearJoint.prototype.m_indexA);box2d.b2GearJoint.prototype.m_indexB=0;goog.exportProperty(box2d.b2GearJoint.prototype,"m_indexB",box2d.b2GearJoint.prototype.m_indexB);box2d.b2GearJoint.prototype.m_indexC=0;goog.exportProperty(box2d.b2GearJoint.prototype,"m_indexC",box2d.b2GearJoint.prototype.m_indexC);box2d.b2GearJoint.prototype.m_indexD=0;goog.exportProperty(box2d.b2GearJoint.prototype,"m_indexD",box2d.b2GearJoint.prototype.m_indexD);box2d.b2GearJoint.prototype.m_lcA=null;goog.exportProperty(box2d.b2GearJoint.prototype,"m_lcA",box2d.b2GearJoint.prototype.m_lcA);box2d.b2GearJoint.prototype.m_lcB=null;goog.exportProperty(box2d.b2GearJoint.prototype,"m_lcB",box2d.b2GearJoint.prototype.m_lcB);box2d.b2GearJoint.prototype.m_lcC=null;goog.exportProperty(box2d.b2GearJoint.prototype,"m_lcC",box2d.b2GearJoint.prototype.m_lcC);box2d.b2GearJoint.prototype.m_lcD=null;goog.exportProperty(box2d.b2GearJoint.prototype,"m_lcD",box2d.b2GearJoint.prototype.m_lcD);box2d.b2GearJoint.prototype.m_mA=0;goog.exportProperty(box2d.b2GearJoint.prototype,"m_mA",box2d.b2GearJoint.prototype.m_mA);box2d.b2GearJoint.prototype.m_mB=0;goog.exportProperty(box2d.b2GearJoint.prototype,"m_mB",box2d.b2GearJoint.prototype.m_mB);box2d.b2GearJoint.prototype.m_mC=0;goog.exportProperty(box2d.b2GearJoint.prototype,"m_mC",box2d.b2GearJoint.prototype.m_mC);box2d.b2GearJoint.prototype.m_mD=0;goog.exportProperty(box2d.b2GearJoint.prototype,"m_mD",box2d.b2GearJoint.prototype.m_mD);box2d.b2GearJoint.prototype.m_iA=0;goog.exportProperty(box2d.b2GearJoint.prototype,"m_iA",box2d.b2GearJoint.prototype.m_iA);box2d.b2GearJoint.prototype.m_iB=0;goog.exportProperty(box2d.b2GearJoint.prototype,"m_iB",box2d.b2GearJoint.prototype.m_iB);box2d.b2GearJoint.prototype.m_iC=0;goog.exportProperty(box2d.b2GearJoint.prototype,"m_iC",box2d.b2GearJoint.prototype.m_iC);box2d.b2GearJoint.prototype.m_iD=0;goog.exportProperty(box2d.b2GearJoint.prototype,"m_iD",box2d.b2GearJoint.prototype.m_iD);box2d.b2GearJoint.prototype.m_JvAC=null;goog.exportProperty(box2d.b2GearJoint.prototype,"m_JvAC",box2d.b2GearJoint.prototype.m_JvAC);box2d.b2GearJoint.prototype.m_JvBD=null;goog.exportProperty(box2d.b2GearJoint.prototype,"m_JvBD",box2d.b2GearJoint.prototype.m_JvBD);box2d.b2GearJoint.prototype.m_JwA=0;goog.exportProperty(box2d.b2GearJoint.prototype,"m_JwA",box2d.b2GearJoint.prototype.m_JwA);box2d.b2GearJoint.prototype.m_JwB=0;goog.exportProperty(box2d.b2GearJoint.prototype,"m_JwB",box2d.b2GearJoint.prototype.m_JwB);box2d.b2GearJoint.prototype.m_JwC=0;goog.exportProperty(box2d.b2GearJoint.prototype,"m_JwC",box2d.b2GearJoint.prototype.m_JwC);box2d.b2GearJoint.prototype.m_JwD=0;goog.exportProperty(box2d.b2GearJoint.prototype,"m_JwD",box2d.b2GearJoint.prototype.m_JwD);box2d.b2GearJoint.prototype.m_mass=0;goog.exportProperty(box2d.b2GearJoint.prototype,"m_mass",box2d.b2GearJoint.prototype.m_mass);box2d.b2GearJoint.prototype.m_qA=null;goog.exportProperty(box2d.b2GearJoint.prototype,"m_qA",box2d.b2GearJoint.prototype.m_qA);box2d.b2GearJoint.prototype.m_qB=null;goog.exportProperty(box2d.b2GearJoint.prototype,"m_qB",box2d.b2GearJoint.prototype.m_qB);box2d.b2GearJoint.prototype.m_qC=null;goog.exportProperty(box2d.b2GearJoint.prototype,"m_qC",box2d.b2GearJoint.prototype.m_qC);box2d.b2GearJoint.prototype.m_qD=null;goog.exportProperty(box2d.b2GearJoint.prototype,"m_qD",box2d.b2GearJoint.prototype.m_qD);box2d.b2GearJoint.prototype.m_lalcA=null;goog.exportProperty(box2d.b2GearJoint.prototype,"m_lalcA",box2d.b2GearJoint.prototype.m_lalcA);box2d.b2GearJoint.prototype.m_lalcB=null;goog.exportProperty(box2d.b2GearJoint.prototype,"m_lalcB",box2d.b2GearJoint.prototype.m_lalcB);box2d.b2GearJoint.prototype.m_lalcC=null;goog.exportProperty(box2d.b2GearJoint.prototype,"m_lalcC",box2d.b2GearJoint.prototype.m_lalcC);box2d.b2GearJoint.prototype.m_lalcD=null;goog.exportProperty(box2d.b2GearJoint.prototype,"m_lalcD",box2d.b2GearJoint.prototype.m_lalcD);box2d.b2GearJoint.prototype.InitVelocityConstraints=function(G){this.m_indexA=this.m_bodyA.m_islandIndex;this.m_indexB=this.m_bodyB.m_islandIndex;this.m_indexC=this.m_bodyC.m_islandIndex;this.m_indexD=this.m_bodyD.m_islandIndex;this.m_lcA.Copy(this.m_bodyA.m_sweep.localCenter);this.m_lcB.Copy(this.m_bodyB.m_sweep.localCenter);this.m_lcC.Copy(this.m_bodyC.m_sweep.localCenter);this.m_lcD.Copy(this.m_bodyD.m_sweep.localCenter);this.m_mA=this.m_bodyA.m_invMass;this.m_mB=this.m_bodyB.m_invMass;this.m_mC=this.m_bodyC.m_invMass;this.m_mD=this.m_bodyD.m_invMass;this.m_iA=this.m_bodyA.m_invI;this.m_iB=this.m_bodyB.m_invI;this.m_iC=this.m_bodyC.m_invI;this.m_iD=this.m_bodyD.m_invI;var F=G.velocities[this.m_indexA].v,E=G.velocities[this.m_indexA].w,D=G.positions[this.m_indexB].a,C=G.velocities[this.m_indexB].v,B=G.velocities[this.m_indexB].w,A=G.positions[this.m_indexC].a,z=G.velocities[this.m_indexC].v,v=G.velocities[this.m_indexC].w,y=G.positions[this.m_indexD].a,u=G.velocities[this.m_indexD].v,s=G.velocities[this.m_indexD].w,r=this.m_qA.SetAngleRadians(G.positions[this.m_indexA].a),D=this.m_qB.SetAngleRadians(D),j=this.m_qC.SetAngleRadians(A),A=this.m_qD.SetAngleRadians(y);this.m_mass=0;this.m_typeA===box2d.b2JointType.e_revoluteJoint?(this.m_JvAC.SetZero(),this.m_JwC=this.m_JwA=1,this.m_mass+=this.m_iA+this.m_iC):(y=box2d.b2MulRV(j,this.m_localAxisC,box2d.b2GearJoint.prototype.InitVelocityConstraints.s_u),box2d.b2SubVV(this.m_localAnchorC,this.m_lcC,this.m_lalcC),j=box2d.b2MulRV(j,this.m_lalcC,box2d.b2GearJoint.prototype.InitVelocityConstraints.s_rC),box2d.b2SubVV(this.m_localAnchorA,this.m_lcA,this.m_lalcA),r=box2d.b2MulRV(r,this.m_lalcA,box2d.b2GearJoint.prototype.InitVelocityConstraints.s_rA),this.m_JvAC.Copy(y),this.m_JwC=box2d.b2CrossVV(j,y),this.m_JwA=box2d.b2CrossVV(r,y),this.m_mass+=this.m_mC+this.m_mA+this.m_iC*this.m_JwC*this.m_JwC+this.m_iA*this.m_JwA*this.m_JwA);this.m_typeB===box2d.b2JointType.e_revoluteJoint?(this.m_JvBD.SetZero(),this.m_JwD=this.m_JwB=this.m_ratio,this.m_mass+=this.m_ratio*this.m_ratio*(this.m_iB+this.m_iD)):(y=box2d.b2MulRV(A,this.m_localAxisD,box2d.b2GearJoint.prototype.InitVelocityConstraints.s_u),box2d.b2SubVV(this.m_localAnchorD,this.m_lcD,this.m_lalcD),r=box2d.b2MulRV(A,this.m_lalcD,box2d.b2GearJoint.prototype.InitVelocityConstraints.s_rD),box2d.b2SubVV(this.m_localAnchorB,this.m_lcB,this.m_lalcB),D=box2d.b2MulRV(D,this.m_lalcB,box2d.b2GearJoint.prototype.InitVelocityConstraints.s_rB),box2d.b2MulSV(this.m_ratio,y,this.m_JvBD),this.m_JwD=this.m_ratio*box2d.b2CrossVV(r,y),this.m_JwB=this.m_ratio*box2d.b2CrossVV(D,y),this.m_mass+=this.m_ratio*this.m_ratio*(this.m_mD+this.m_mB)+this.m_iD*this.m_JwD*this.m_JwD+this.m_iB*this.m_JwB*this.m_JwB);this.m_mass=0<this.m_mass?1/this.m_mass:0;G.step.warmStarting?(F.SelfMulAdd(this.m_mA*this.m_impulse,this.m_JvAC),E+=this.m_iA*this.m_impulse*this.m_JwA,C.SelfMulAdd(this.m_mB*this.m_impulse,this.m_JvBD),B+=this.m_iB*this.m_impulse*this.m_JwB,z.SelfMulSub(this.m_mC*this.m_impulse,this.m_JvAC),v-=this.m_iC*this.m_impulse*this.m_JwC,u.SelfMulSub(this.m_mD*this.m_impulse,this.m_JvBD),s-=this.m_iD*this.m_impulse*this.m_JwD):this.m_impulse=0;G.velocities[this.m_indexA].w=E;G.velocities[this.m_indexB].w=B;G.velocities[this.m_indexC].w=v;G.velocities[this.m_indexD].w=s};box2d.b2GearJoint.prototype.InitVelocityConstraints.s_u=new box2d.b2Vec2;box2d.b2GearJoint.prototype.InitVelocityConstraints.s_rA=new box2d.b2Vec2;box2d.b2GearJoint.prototype.InitVelocityConstraints.s_rB=new box2d.b2Vec2;box2d.b2GearJoint.prototype.InitVelocityConstraints.s_rC=new box2d.b2Vec2;box2d.b2GearJoint.prototype.InitVelocityConstraints.s_rD=new box2d.b2Vec2;box2d.b2GearJoint.prototype.SolveVelocityConstraints=function(z){var y=z.velocities[this.m_indexA].v,v=z.velocities[this.m_indexA].w,u=z.velocities[this.m_indexB].v,s=z.velocities[this.m_indexB].w,r=z.velocities[this.m_indexC].v,q=z.velocities[this.m_indexC].w,n=z.velocities[this.m_indexD].v,j=z.velocities[this.m_indexD].w,m=box2d.b2DotVV(this.m_JvAC,box2d.b2SubVV(y,r,box2d.b2Vec2.s_t0))+box2d.b2DotVV(this.m_JvBD,box2d.b2SubVV(u,n,box2d.b2Vec2.s_t0)),m=m+(this.m_JwA*v-this.m_JwC*q+(this.m_JwB*s-this.m_JwD*j)),m=-this.m_mass*m;this.m_impulse+=m;y.SelfMulAdd(this.m_mA*m,this.m_JvAC);v+=this.m_iA*m*this.m_JwA;u.SelfMulAdd(this.m_mB*m,this.m_JvBD);s+=this.m_iB*m*this.m_JwB;r.SelfMulSub(this.m_mC*m,this.m_JvAC);q-=this.m_iC*m*this.m_JwC;n.SelfMulSub(this.m_mD*m,this.m_JvBD);j-=this.m_iD*m*this.m_JwD;z.velocities[this.m_indexA].w=v;z.velocities[this.m_indexB].w=s;z.velocities[this.m_indexC].w=q;z.velocities[this.m_indexD].w=j};box2d.b2GearJoint.prototype.SolvePositionConstraints=function(R){var P=R.positions[this.m_indexA].c,O=R.positions[this.m_indexA].a,N=R.positions[this.m_indexB].c,M=R.positions[this.m_indexB].a,L=R.positions[this.m_indexC].c,K=R.positions[this.m_indexC].a,J=R.positions[this.m_indexD].c,H=R.positions[this.m_indexD].a,I=this.m_qA.SetAngleRadians(O),G=this.m_qB.SetAngleRadians(M),F=this.m_qC.SetAngleRadians(K),E=this.m_qD.SetAngleRadians(H),D=this.m_JvAC,C=this.m_JvBD,A,B,y=0;if(this.m_typeA===box2d.b2JointType.e_revoluteJoint){D.SetZero(),I=A=1,y+=this.m_iA+this.m_iC,F=O-K-this.m_referenceAngleA}else{B=box2d.b2MulRV(F,this.m_localAxisC,box2d.b2GearJoint.prototype.SolvePositionConstraints.s_u);A=box2d.b2MulRV(F,this.m_lalcC,box2d.b2GearJoint.prototype.SolvePositionConstraints.s_rC);var j=box2d.b2MulRV(I,this.m_lalcA,box2d.b2GearJoint.prototype.SolvePositionConstraints.s_rA);D.Copy(B);I=box2d.b2CrossVV(A,B);A=box2d.b2CrossVV(j,B);y+=this.m_mC+this.m_mA+this.m_iC*I*I+this.m_iA*A*A;B=this.m_lalcC;F=box2d.b2MulTRV(F,box2d.b2AddVV(j,box2d.b2SubVV(P,L,box2d.b2Vec2.s_t0),box2d.b2Vec2.s_t0),box2d.b2Vec2.s_t0);F=box2d.b2DotVV(box2d.b2SubVV(F,B,box2d.b2Vec2.s_t0),this.m_localAxisC)}if(this.m_typeB===box2d.b2JointType.e_revoluteJoint){C.SetZero(),G=B=this.m_ratio,y+=this.m_ratio*this.m_ratio*(this.m_iB+this.m_iD),E=M-H-this.m_referenceAngleB}else{B=box2d.b2MulRV(E,this.m_localAxisD,box2d.b2GearJoint.prototype.SolvePositionConstraints.s_u);var z=box2d.b2MulRV(E,this.m_lalcD,box2d.b2GearJoint.prototype.SolvePositionConstraints.s_rD),j=box2d.b2MulRV(G,this.m_lalcB,box2d.b2GearJoint.prototype.SolvePositionConstraints.s_rB);box2d.b2MulSV(this.m_ratio,B,C);G=this.m_ratio*box2d.b2CrossVV(z,B);B=this.m_ratio*box2d.b2CrossVV(j,B);y+=this.m_ratio*this.m_ratio*(this.m_mD+this.m_mB)+this.m_iD*G*G+this.m_iB*B*B;z=this.m_lalcD;E=box2d.b2MulTRV(E,box2d.b2AddVV(j,box2d.b2SubVV(N,J,box2d.b2Vec2.s_t0),box2d.b2Vec2.s_t0),box2d.b2Vec2.s_t0);E=box2d.b2DotVV(box2d.b2SubVV(E,z,box2d.b2Vec2.s_t0),this.m_localAxisD)}E=F+this.m_ratio*E-this.m_constant;F=0;0<y&&(F=-E/y);P.SelfMulAdd(this.m_mA*F,D);O+=this.m_iA*F*A;N.SelfMulAdd(this.m_mB*F,C);M+=this.m_iB*F*B;L.SelfMulSub(this.m_mC*F,D);K-=this.m_iC*F*I;J.SelfMulSub(this.m_mD*F,C);H-=this.m_iD*F*G;R.positions[this.m_indexA].a=O;R.positions[this.m_indexB].a=M;R.positions[this.m_indexC].a=K;R.positions[this.m_indexD].a=H;return 0<box2d.b2_linearSlop};goog.exportProperty(box2d.b2GearJoint.prototype,"SolvePositionConstraints",box2d.b2GearJoint.prototype.SolvePositionConstraints);box2d.b2GearJoint.prototype.SolvePositionConstraints.s_u=new box2d.b2Vec2;box2d.b2GearJoint.prototype.SolvePositionConstraints.s_rA=new box2d.b2Vec2;box2d.b2GearJoint.prototype.SolvePositionConstraints.s_rB=new box2d.b2Vec2;box2d.b2GearJoint.prototype.SolvePositionConstraints.s_rC=new box2d.b2Vec2;box2d.b2GearJoint.prototype.SolvePositionConstraints.s_rD=new box2d.b2Vec2;box2d.b2GearJoint.prototype.GetAnchorA=function(b){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,b)};goog.exportProperty(box2d.b2GearJoint.prototype,"GetAnchorA",box2d.b2GearJoint.prototype.GetAnchorA);box2d.b2GearJoint.prototype.GetAnchorB=function(b){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,b)};goog.exportProperty(box2d.b2GearJoint.prototype,"GetAnchorB",box2d.b2GearJoint.prototype.GetAnchorB);box2d.b2GearJoint.prototype.GetReactionForce=function(e,d){return box2d.b2MulSV(e*this.m_impulse,this.m_JvAC,d)};goog.exportProperty(box2d.b2GearJoint.prototype,"GetReactionForce",box2d.b2GearJoint.prototype.GetReactionForce);box2d.b2GearJoint.prototype.GetReactionTorque=function(b){return b*this.m_impulse*this.m_JwA};goog.exportProperty(box2d.b2GearJoint.prototype,"GetReactionTorque",box2d.b2GearJoint.prototype.GetReactionTorque);box2d.b2GearJoint.prototype.GetJoint1=function(){return this.m_joint1};goog.exportProperty(box2d.b2GearJoint.prototype,"GetJoint1",box2d.b2GearJoint.prototype.GetJoint1);box2d.b2GearJoint.prototype.GetJoint2=function(){return this.m_joint2};goog.exportProperty(box2d.b2GearJoint.prototype,"GetJoint2",box2d.b2GearJoint.prototype.GetJoint2);box2d.b2GearJoint.prototype.GetRatio=function(){return this.m_ratio};goog.exportProperty(box2d.b2GearJoint.prototype,"GetRatio",box2d.b2GearJoint.prototype.GetRatio);box2d.b2GearJoint.prototype.SetRatio=function(b){box2d.ENABLE_ASSERTS&&box2d.b2Assert(box2d.b2IsValid(b));this.m_ratio=b};goog.exportProperty(box2d.b2GearJoint.prototype,"SetRatio",box2d.b2GearJoint.prototype.SetRatio);box2d.b2GearJoint.prototype.Dump=function(){if(box2d.DEBUG){var f=this.m_bodyA.m_islandIndex,e=this.m_bodyB.m_islandIndex,j=this.m_joint1.m_index,g=this.m_joint2.m_index;box2d.b2Log("  /*box2d.b2GearJointDef*/ var jd = new box2d.b2GearJointDef();\n");box2d.b2Log("  jd.bodyA = bodies[%d];\n",f);box2d.b2Log("  jd.bodyB = bodies[%d];\n",e);box2d.b2Log("  jd.collideConnected = %s;\n",this.m_collideConnected?"true":"false");box2d.b2Log("  jd.joint1 = joints[%d];\n",j);box2d.b2Log("  jd.joint2 = joints[%d];\n",g);box2d.b2Log("  jd.ratio = %.15f;\n",this.m_ratio);box2d.b2Log("  joints[%d] = this.m_world.CreateJoint(jd);\n",this.m_index)}};goog.exportProperty(box2d.b2GearJoint.prototype,"Dump",box2d.b2GearJoint.prototype.Dump);box2d.b2RopeJointDef=function(){box2d.b2JointDef.call(this,box2d.b2JointType.e_ropeJoint);this.localAnchorA=new box2d.b2Vec2(-1,0);this.localAnchorB=new box2d.b2Vec2(1,0)};goog.inherits(box2d.b2RopeJointDef,box2d.b2JointDef);goog.exportSymbol("box2d.b2RopeJointDef",box2d.b2RopeJointDef);box2d.b2RopeJointDef.prototype.localAnchorA=null;goog.exportProperty(box2d.b2RopeJointDef.prototype,"localAnchorA",box2d.b2RopeJointDef.prototype.localAnchorA);box2d.b2RopeJointDef.prototype.localAnchorB=null;goog.exportProperty(box2d.b2RopeJointDef.prototype,"localAnchorB",box2d.b2RopeJointDef.prototype.localAnchorB);box2d.b2RopeJointDef.prototype.maxLength=0;goog.exportProperty(box2d.b2RopeJointDef.prototype,"maxLength",box2d.b2RopeJointDef.prototype.maxLength);box2d.b2RopeJoint=function(b){box2d.b2Joint.call(this,b);this.m_localAnchorA=b.localAnchorA.Clone();this.m_localAnchorB=b.localAnchorB.Clone();this.m_maxLength=b.maxLength;this.m_u=new box2d.b2Vec2;this.m_rA=new box2d.b2Vec2;this.m_rB=new box2d.b2Vec2;this.m_localCenterA=new box2d.b2Vec2;this.m_localCenterB=new box2d.b2Vec2;this.m_qA=new box2d.b2Rot;this.m_qB=new box2d.b2Rot;this.m_lalcA=new box2d.b2Vec2;this.m_lalcB=new box2d.b2Vec2};goog.inherits(box2d.b2RopeJoint,box2d.b2Joint);goog.exportSymbol("box2d.b2RopeJoint",box2d.b2RopeJoint);box2d.b2RopeJoint.prototype.m_localAnchorA=null;goog.exportProperty(box2d.b2RopeJoint.prototype,"m_localAnchorA",box2d.b2RopeJoint.prototype.m_localAnchorA);box2d.b2RopeJoint.prototype.m_localAnchorB=null;goog.exportProperty(box2d.b2RopeJoint.prototype,"m_localAnchorB",box2d.b2RopeJoint.prototype.m_localAnchorB);box2d.b2RopeJoint.prototype.m_maxLength=0;goog.exportProperty(box2d.b2RopeJoint.prototype,"m_maxLength",box2d.b2RopeJoint.prototype.m_maxLength);box2d.b2RopeJoint.prototype.m_length=0;goog.exportProperty(box2d.b2RopeJoint.prototype,"m_length",box2d.b2RopeJoint.prototype.m_length);box2d.b2RopeJoint.prototype.m_impulse=0;goog.exportProperty(box2d.b2RopeJoint.prototype,"m_impulse",box2d.b2RopeJoint.prototype.m_impulse);box2d.b2RopeJoint.prototype.m_indexA=0;goog.exportProperty(box2d.b2RopeJoint.prototype,"m_indexA",box2d.b2RopeJoint.prototype.m_indexA);box2d.b2RopeJoint.prototype.m_indexB=0;goog.exportProperty(box2d.b2RopeJoint.prototype,"m_indexB",box2d.b2RopeJoint.prototype.m_indexB);box2d.b2RopeJoint.prototype.m_u=null;goog.exportProperty(box2d.b2RopeJoint.prototype,"m_u",box2d.b2RopeJoint.prototype.m_u);box2d.b2RopeJoint.prototype.m_rA=null;goog.exportProperty(box2d.b2RopeJoint.prototype,"m_rA",box2d.b2RopeJoint.prototype.m_rA);box2d.b2RopeJoint.prototype.m_rB=null;goog.exportProperty(box2d.b2RopeJoint.prototype,"m_rB",box2d.b2RopeJoint.prototype.m_rB);box2d.b2RopeJoint.prototype.m_localCenterA=null;goog.exportProperty(box2d.b2RopeJoint.prototype,"m_localCenterA",box2d.b2RopeJoint.prototype.m_localCenterA);box2d.b2RopeJoint.prototype.m_localCenterB=null;goog.exportProperty(box2d.b2RopeJoint.prototype,"m_localCenterB",box2d.b2RopeJoint.prototype.m_localCenterB);box2d.b2RopeJoint.prototype.m_invMassA=0;goog.exportProperty(box2d.b2RopeJoint.prototype,"m_invMassA",box2d.b2RopeJoint.prototype.m_invMassA);box2d.b2RopeJoint.prototype.m_invMassB=0;goog.exportProperty(box2d.b2RopeJoint.prototype,"m_invMassB",box2d.b2RopeJoint.prototype.m_invMassB);box2d.b2RopeJoint.prototype.m_invIA=0;goog.exportProperty(box2d.b2RopeJoint.prototype,"m_invIA",box2d.b2RopeJoint.prototype.m_invIA);box2d.b2RopeJoint.prototype.m_invIB=0;goog.exportProperty(box2d.b2RopeJoint.prototype,"m_invIB",box2d.b2RopeJoint.prototype.m_invIB);box2d.b2RopeJoint.prototype.m_mass=0;goog.exportProperty(box2d.b2RopeJoint.prototype,"m_mass",box2d.b2RopeJoint.prototype.m_mass);box2d.b2RopeJoint.prototype.m_state=box2d.b2LimitState.e_inactiveLimit;goog.exportProperty(box2d.b2RopeJoint.prototype,"m_state",box2d.b2RopeJoint.prototype.m_state);box2d.b2RopeJoint.prototype.m_qA=null;goog.exportProperty(box2d.b2RopeJoint.prototype,"m_qA",box2d.b2RopeJoint.prototype.m_qA);box2d.b2RopeJoint.prototype.m_qB=null;goog.exportProperty(box2d.b2RopeJoint.prototype,"m_qB",box2d.b2RopeJoint.prototype.m_qB);box2d.b2RopeJoint.prototype.m_lalcA=null;goog.exportProperty(box2d.b2RopeJoint.prototype,"m_lalcA",box2d.b2RopeJoint.prototype.m_lalcA);box2d.b2RopeJoint.prototype.m_lalcB=null;goog.exportProperty(box2d.b2RopeJoint.prototype,"m_lalcB",box2d.b2RopeJoint.prototype.m_lalcB);box2d.b2RopeJoint.prototype.InitVelocityConstraints=function(v){this.m_indexA=this.m_bodyA.m_islandIndex;this.m_indexB=this.m_bodyB.m_islandIndex;this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter);this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter);this.m_invMassA=this.m_bodyA.m_invMass;this.m_invMassB=this.m_bodyB.m_invMass;this.m_invIA=this.m_bodyA.m_invI;this.m_invIB=this.m_bodyB.m_invI;var u=v.positions[this.m_indexA].c,s=v.velocities[this.m_indexA].v,r=v.velocities[this.m_indexA].w,q=v.positions[this.m_indexB].c,n=v.positions[this.m_indexB].a,m=v.velocities[this.m_indexB].v,k=v.velocities[this.m_indexB].w,j=this.m_qA.SetAngleRadians(v.positions[this.m_indexA].a),n=this.m_qB.SetAngleRadians(n);box2d.b2SubVV(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA);box2d.b2MulRV(j,this.m_lalcA,this.m_rA);box2d.b2SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB);box2d.b2MulRV(n,this.m_lalcB,this.m_rB);this.m_u.Copy(q).SelfAdd(this.m_rB).SelfSub(u).SelfSub(this.m_rA);this.m_length=this.m_u.GetLength();this.m_state=0<this.m_length-this.m_maxLength?box2d.b2LimitState.e_atUpperLimit:box2d.b2LimitState.e_inactiveLimit;this.m_length>box2d.b2_linearSlop?(this.m_u.SelfMul(1/this.m_length),u=box2d.b2CrossVV(this.m_rA,this.m_u),q=box2d.b2CrossVV(this.m_rB,this.m_u),u=this.m_invMassA+this.m_invIA*u*u+this.m_invMassB+this.m_invIB*q*q,this.m_mass=0!==u?1/u:0,v.step.warmStarting?(this.m_impulse*=v.step.dtRatio,u=box2d.b2MulSV(this.m_impulse,this.m_u,box2d.b2RopeJoint.prototype.InitVelocityConstraints.s_P),s.SelfMulSub(this.m_invMassA,u),r-=this.m_invIA*box2d.b2CrossVV(this.m_rA,u),m.SelfMulAdd(this.m_invMassB,u),k+=this.m_invIB*box2d.b2CrossVV(this.m_rB,u)):this.m_impulse=0,v.velocities[this.m_indexA].w=r,v.velocities[this.m_indexB].w=k):(this.m_u.SetZero(),this.m_impulse=this.m_mass=0)};goog.exportProperty(box2d.b2RopeJoint.prototype,"InitVelocityConstraints",box2d.b2RopeJoint.prototype.InitVelocityConstraints);box2d.b2RopeJoint.prototype.InitVelocityConstraints.s_P=new box2d.b2Vec2;box2d.b2RopeJoint.prototype.SolveVelocityConstraints=function(k){var j=k.velocities[this.m_indexA].v,u=k.velocities[this.m_indexA].w,s=k.velocities[this.m_indexB].v,r=k.velocities[this.m_indexB].w,q=box2d.b2AddVCrossSV(j,u,this.m_rA,box2d.b2RopeJoint.prototype.SolveVelocityConstraints.s_vpA),n=box2d.b2AddVCrossSV(s,r,this.m_rB,box2d.b2RopeJoint.prototype.SolveVelocityConstraints.s_vpB),m=this.m_length-this.m_maxLength,q=box2d.b2DotVV(this.m_u,box2d.b2SubVV(n,q,box2d.b2Vec2.s_t0));0>m&&(q+=k.step.inv_dt*m);m=-this.m_mass*q;q=this.m_impulse;this.m_impulse=box2d.b2Min(0,this.m_impulse+m);m=this.m_impulse-q;m=box2d.b2MulSV(m,this.m_u,box2d.b2RopeJoint.prototype.SolveVelocityConstraints.s_P);j.SelfMulSub(this.m_invMassA,m);u-=this.m_invIA*box2d.b2CrossVV(this.m_rA,m);s.SelfMulAdd(this.m_invMassB,m);r+=this.m_invIB*box2d.b2CrossVV(this.m_rB,m);k.velocities[this.m_indexA].w=u;k.velocities[this.m_indexB].w=r};goog.exportProperty(box2d.b2RopeJoint.prototype,"SolveVelocityConstraints",box2d.b2RopeJoint.prototype.SolveVelocityConstraints);box2d.b2RopeJoint.prototype.SolveVelocityConstraints.s_vpA=new box2d.b2Vec2;box2d.b2RopeJoint.prototype.SolveVelocityConstraints.s_vpB=new box2d.b2Vec2;box2d.b2RopeJoint.prototype.SolveVelocityConstraints.s_P=new box2d.b2Vec2;box2d.b2RopeJoint.prototype.SolvePositionConstraints=function(z){var y=z.positions[this.m_indexA].c,v=z.positions[this.m_indexA].a,u=z.positions[this.m_indexB].c,s=z.positions[this.m_indexB].a,r=this.m_qA.SetAngleRadians(v),q=this.m_qB.SetAngleRadians(s);box2d.b2SubVV(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA);r=box2d.b2MulRV(r,this.m_lalcA,this.m_rA);box2d.b2SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB);var q=box2d.b2MulRV(q,this.m_lalcB,this.m_rB),n=this.m_u.Copy(u).SelfAdd(q).SelfSub(y).SelfSub(r),j=n.Normalize(),m=j-this.m_maxLength,m=box2d.b2Clamp(m,0,box2d.b2_maxLinearCorrection),n=box2d.b2MulSV(-this.m_mass*m,n,box2d.b2RopeJoint.prototype.SolvePositionConstraints.s_P);y.SelfMulSub(this.m_invMassA,n);v-=this.m_invIA*box2d.b2CrossVV(r,n);u.SelfMulAdd(this.m_invMassB,n);s+=this.m_invIB*box2d.b2CrossVV(q,n);z.positions[this.m_indexA].a=v;z.positions[this.m_indexB].a=s;return j-this.m_maxLength<box2d.b2_linearSlop};goog.exportProperty(box2d.b2RopeJoint.prototype,"SolvePositionConstraints",box2d.b2RopeJoint.prototype.SolvePositionConstraints);box2d.b2RopeJoint.prototype.SolvePositionConstraints.s_P=new box2d.b2Vec2;box2d.b2RopeJoint.prototype.GetAnchorA=function(b){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,b)};goog.exportProperty(box2d.b2RopeJoint.prototype,"GetAnchorA",box2d.b2RopeJoint.prototype.GetAnchorA);box2d.b2RopeJoint.prototype.GetAnchorB=function(b){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,b)};goog.exportProperty(box2d.b2RopeJoint.prototype,"GetAnchorB",box2d.b2RopeJoint.prototype.GetAnchorB);box2d.b2RopeJoint.prototype.GetReactionForce=function(e,d){return box2d.b2MulSV(e*this.m_impulse,this.m_u,d)};goog.exportProperty(box2d.b2RopeJoint.prototype,"GetReactionForce",box2d.b2RopeJoint.prototype.GetReactionForce);box2d.b2RopeJoint.prototype.GetReactionTorque=function(b){return 0};goog.exportProperty(box2d.b2RopeJoint.prototype,"GetReactionTorque",box2d.b2RopeJoint.prototype.GetReactionTorque);box2d.b2RopeJoint.prototype.GetLocalAnchorA=function(b){return b.Copy(this.m_localAnchorA)};goog.exportProperty(box2d.b2RopeJoint.prototype,"GetLocalAnchorA",box2d.b2RopeJoint.prototype.GetLocalAnchorA);box2d.b2RopeJoint.prototype.GetLocalAnchorB=function(b){return b.Copy(this.m_localAnchorB)};goog.exportProperty(box2d.b2RopeJoint.prototype,"GetLocalAnchorB",box2d.b2RopeJoint.prototype.GetLocalAnchorB);box2d.b2RopeJoint.prototype.SetMaxLength=function(b){this.m_maxLength=b};goog.exportProperty(box2d.b2RopeJoint.prototype,"SetMaxLength",box2d.b2RopeJoint.prototype.SetMaxLength);box2d.b2RopeJoint.prototype.GetMaxLength=function(){return this.m_maxLength};goog.exportProperty(box2d.b2RopeJoint.prototype,"GetMaxLength",box2d.b2RopeJoint.prototype.GetMaxLength);box2d.b2RopeJoint.prototype.GetLimitState=function(){return this.m_state};goog.exportProperty(box2d.b2RopeJoint.prototype,"GetLimitState",box2d.b2RopeJoint.prototype.GetLimitState);box2d.b2RopeJoint.prototype.Dump=function(){if(box2d.DEBUG){var e=this.m_bodyA.m_islandIndex,d=this.m_bodyB.m_islandIndex;box2d.b2Log("  /*box2d.b2RopeJointDef*/ var jd = new box2d.b2RopeJointDef();\n");box2d.b2Log("  jd.bodyA = bodies[%d];\n",e);box2d.b2Log("  jd.bodyB = bodies[%d];\n",d);box2d.b2Log("  jd.collideConnected = %s;\n",this.m_collideConnected?"true":"false");box2d.b2Log("  jd.localAnchorA.SetXY(%.15f, %.15f);\n",this.m_localAnchorA.x,this.m_localAnchorA.y);box2d.b2Log("  jd.localAnchorB.SetXY(%.15f, %.15f);\n",this.m_localAnchorB.x,this.m_localAnchorB.y);box2d.b2Log("  jd.maxLength = %.15f;\n",this.m_maxLength);box2d.b2Log("  joints[%d] = this.m_world.CreateJoint(jd);\n",this.m_index)}};goog.exportProperty(box2d.b2RopeJoint.prototype,"Dump",box2d.b2RopeJoint.prototype.Dump);box2d.b2WeldJointDef=function(){box2d.b2JointDef.call(this,box2d.b2JointType.e_weldJoint);this.localAnchorA=new box2d.b2Vec2;this.localAnchorB=new box2d.b2Vec2};goog.inherits(box2d.b2WeldJointDef,box2d.b2JointDef);goog.exportSymbol("box2d.b2WeldJointDef",box2d.b2WeldJointDef);box2d.b2WeldJointDef.prototype.localAnchorA=null;goog.exportProperty(box2d.b2WeldJointDef.prototype,"localAnchorA",box2d.b2WeldJointDef.prototype.localAnchorA);box2d.b2WeldJointDef.prototype.localAnchorB=null;goog.exportProperty(box2d.b2WeldJointDef.prototype,"localAnchorB",box2d.b2WeldJointDef.prototype.localAnchorB);box2d.b2WeldJointDef.prototype.referenceAngle=0;goog.exportProperty(box2d.b2WeldJointDef.prototype,"referenceAngle",box2d.b2WeldJointDef.prototype.referenceAngle);box2d.b2WeldJointDef.prototype.frequencyHz=0;goog.exportProperty(box2d.b2WeldJointDef.prototype,"frequencyHz",box2d.b2WeldJointDef.prototype.frequencyHz);box2d.b2WeldJointDef.prototype.dampingRatio=0;goog.exportProperty(box2d.b2WeldJointDef.prototype,"dampingRatio",box2d.b2WeldJointDef.prototype.dampingRatio);box2d.b2WeldJointDef.prototype.Initialize=function(e,d,f){this.bodyA=e;this.bodyB=d;this.bodyA.GetLocalPoint(f,this.localAnchorA);this.bodyB.GetLocalPoint(f,this.localAnchorB);this.referenceAngle=this.bodyB.GetAngleRadians()-this.bodyA.GetAngleRadians()};goog.exportProperty(box2d.b2WeldJointDef.prototype,"Initialize",box2d.b2WeldJointDef.prototype.Initialize);box2d.b2WeldJoint=function(b){box2d.b2Joint.call(this,b);this.m_frequencyHz=b.frequencyHz;this.m_dampingRatio=b.dampingRatio;this.m_localAnchorA=b.localAnchorA.Clone();this.m_localAnchorB=b.localAnchorB.Clone();this.m_referenceAngle=b.referenceAngle;this.m_impulse=new box2d.b2Vec3(0,0,0);this.m_rA=new box2d.b2Vec2;this.m_rB=new box2d.b2Vec2;this.m_localCenterA=new box2d.b2Vec2;this.m_localCenterB=new box2d.b2Vec2;this.m_mass=new box2d.b2Mat33;this.m_qA=new box2d.b2Rot;this.m_qB=new box2d.b2Rot;this.m_lalcA=new box2d.b2Vec2;this.m_lalcB=new box2d.b2Vec2;this.m_K=new box2d.b2Mat33};goog.inherits(box2d.b2WeldJoint,box2d.b2Joint);goog.exportSymbol("box2d.b2WeldJoint",box2d.b2WeldJoint);box2d.b2WeldJoint.prototype.m_frequencyHz=0;goog.exportProperty(box2d.b2WeldJoint.prototype,"m_frequencyHz",box2d.b2WeldJoint.prototype.m_frequencyHz);box2d.b2WeldJoint.prototype.m_dampingRatio=0;goog.exportProperty(box2d.b2WeldJoint.prototype,"m_dampingRatio",box2d.b2WeldJoint.prototype.m_dampingRatio);box2d.b2WeldJoint.prototype.m_bias=0;goog.exportProperty(box2d.b2WeldJoint.prototype,"m_bias",box2d.b2WeldJoint.prototype.m_bias);box2d.b2WeldJoint.prototype.m_localAnchorA=null;goog.exportProperty(box2d.b2WeldJoint.prototype,"m_localAnchorA",box2d.b2WeldJoint.prototype.m_localAnchorA);box2d.b2WeldJoint.prototype.m_localAnchorB=null;goog.exportProperty(box2d.b2WeldJoint.prototype,"m_localAnchorB",box2d.b2WeldJoint.prototype.m_localAnchorB);box2d.b2WeldJoint.prototype.m_referenceAngle=0;goog.exportProperty(box2d.b2WeldJoint.prototype,"m_referenceAngle",box2d.b2WeldJoint.prototype.m_referenceAngle);box2d.b2WeldJoint.prototype.m_gamma=0;goog.exportProperty(box2d.b2WeldJoint.prototype,"m_gamma",box2d.b2WeldJoint.prototype.m_gamma);box2d.b2WeldJoint.prototype.m_impulse=null;goog.exportProperty(box2d.b2WeldJoint.prototype,"m_impulse",box2d.b2WeldJoint.prototype.m_impulse);box2d.b2WeldJoint.prototype.m_indexA=0;goog.exportProperty(box2d.b2WeldJoint.prototype,"m_indexA",box2d.b2WeldJoint.prototype.m_indexA);box2d.b2WeldJoint.prototype.m_indexB=0;goog.exportProperty(box2d.b2WeldJoint.prototype,"m_indexB",box2d.b2WeldJoint.prototype.m_indexB);box2d.b2WeldJoint.prototype.m_rA=null;goog.exportProperty(box2d.b2WeldJoint.prototype,"m_rA",box2d.b2WeldJoint.prototype.m_rA);box2d.b2WeldJoint.prototype.m_rB=null;goog.exportProperty(box2d.b2WeldJoint.prototype,"m_rB",box2d.b2WeldJoint.prototype.m_rB);box2d.b2WeldJoint.prototype.m_localCenterA=null;goog.exportProperty(box2d.b2WeldJoint.prototype,"m_localCenterA",box2d.b2WeldJoint.prototype.m_localCenterA);box2d.b2WeldJoint.prototype.m_localCenterB=null;goog.exportProperty(box2d.b2WeldJoint.prototype,"m_localCenterB",box2d.b2WeldJoint.prototype.m_localCenterB);box2d.b2WeldJoint.prototype.m_invMassA=0;goog.exportProperty(box2d.b2WeldJoint.prototype,"m_invMassA",box2d.b2WeldJoint.prototype.m_invMassA);box2d.b2WeldJoint.prototype.m_invMassB=0;goog.exportProperty(box2d.b2WeldJoint.prototype,"m_invMassB",box2d.b2WeldJoint.prototype.m_invMassB);box2d.b2WeldJoint.prototype.m_invIA=0;goog.exportProperty(box2d.b2WeldJoint.prototype,"m_invIA",box2d.b2WeldJoint.prototype.m_invIA);box2d.b2WeldJoint.prototype.m_invIB=0;goog.exportProperty(box2d.b2WeldJoint.prototype,"m_invIB",box2d.b2WeldJoint.prototype.m_invIB);box2d.b2WeldJoint.prototype.m_mass=null;goog.exportProperty(box2d.b2WeldJoint.prototype,"m_mass",box2d.b2WeldJoint.prototype.m_mass);box2d.b2WeldJoint.prototype.m_qA=null;goog.exportProperty(box2d.b2WeldJoint.prototype,"m_qA",box2d.b2WeldJoint.prototype.m_qA);box2d.b2WeldJoint.prototype.m_qB=null;goog.exportProperty(box2d.b2WeldJoint.prototype,"m_qB",box2d.b2WeldJoint.prototype.m_qB);box2d.b2WeldJoint.prototype.m_lalcA=null;goog.exportProperty(box2d.b2WeldJoint.prototype,"m_lalcA",box2d.b2WeldJoint.prototype.m_lalcA);box2d.b2WeldJoint.prototype.m_lalcB=null;goog.exportProperty(box2d.b2WeldJoint.prototype,"m_lalcB",box2d.b2WeldJoint.prototype.m_lalcB);box2d.b2WeldJoint.prototype.m_K=null;goog.exportProperty(box2d.b2WeldJoint.prototype,"m_K",box2d.b2WeldJoint.prototype.m_K);box2d.b2WeldJoint.prototype.InitVelocityConstraints=function(I){this.m_indexA=this.m_bodyA.m_islandIndex;this.m_indexB=this.m_bodyB.m_islandIndex;this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter);this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter);this.m_invMassA=this.m_bodyA.m_invMass;this.m_invMassB=this.m_bodyB.m_invMass;this.m_invIA=this.m_bodyA.m_invI;this.m_invIB=this.m_bodyB.m_invI;var H=I.positions[this.m_indexA].a,G=I.velocities[this.m_indexA].v,F=I.velocities[this.m_indexA].w,E=I.positions[this.m_indexB].a,D=I.velocities[this.m_indexB].v,C=I.velocities[this.m_indexB].w,B=this.m_qA.SetAngleRadians(H),z=this.m_qB.SetAngleRadians(E);box2d.b2SubVV(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA);box2d.b2MulRV(B,this.m_lalcA,this.m_rA);box2d.b2SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB);box2d.b2MulRV(z,this.m_lalcB,this.m_rB);var B=this.m_invMassA,z=this.m_invMassB,A=this.m_invIA,y=this.m_invIB,v=this.m_K;v.ex.x=B+z+this.m_rA.y*this.m_rA.y*A+this.m_rB.y*this.m_rB.y*y;v.ey.x=-this.m_rA.y*this.m_rA.x*A-this.m_rB.y*this.m_rB.x*y;v.ez.x=-this.m_rA.y*A-this.m_rB.y*y;v.ex.y=v.ey.x;v.ey.y=B+z+this.m_rA.x*this.m_rA.x*A+this.m_rB.x*this.m_rB.x*y;v.ez.y=this.m_rA.x*A+this.m_rB.x*y;v.ex.z=v.ez.x;v.ey.z=v.ez.y;v.ez.z=A+y;if(0<this.m_frequencyHz){v.GetInverse22(this.m_mass);var v=A+y,u=0<v?1/v:0,H=E-H-this.m_referenceAngle,E=2*box2d.b2_pi*this.m_frequencyHz,s=u*E*E,j=I.step.dt;this.m_gamma=j*(2*u*this.m_dampingRatio*E+j*s);this.m_gamma=0!==this.m_gamma?1/this.m_gamma:0;this.m_bias=H*j*s*this.m_gamma;v+=this.m_gamma;this.m_mass.ez.z=0!==v?1/v:0}else{0===v.ez.z?v.GetInverse22(this.m_mass):v.GetSymInverse33(this.m_mass),this.m_bias=this.m_gamma=0}I.step.warmStarting?(this.m_impulse.SelfMul(I.step.dtRatio),v=box2d.b2WeldJoint.prototype.InitVelocityConstraints.s_P.SetXY(this.m_impulse.x,this.m_impulse.y),G.SelfMulSub(B,v),F-=A*(box2d.b2CrossVV(this.m_rA,v)+this.m_impulse.z),D.SelfMulAdd(z,v),C+=y*(box2d.b2CrossVV(this.m_rB,v)+this.m_impulse.z)):this.m_impulse.SetZero();I.velocities[this.m_indexA].w=F;I.velocities[this.m_indexB].w=C};box2d.b2WeldJoint.prototype.InitVelocityConstraints.s_P=new box2d.b2Vec2;box2d.b2WeldJoint.prototype.SolveVelocityConstraints=function(B){var A=B.velocities[this.m_indexA].v,z=B.velocities[this.m_indexA].w,y=B.velocities[this.m_indexB].v,v=B.velocities[this.m_indexB].w,u=this.m_invMassA,s=this.m_invMassB,r=this.m_invIA,n=this.m_invIB;if(0<this.m_frequencyHz){var q=-this.m_mass.ez.z*(v-z+this.m_bias+this.m_gamma*this.m_impulse.z);this.m_impulse.z+=q;z-=r*q;v+=n*q;q=box2d.b2SubVV(box2d.b2AddVCrossSV(y,v,this.m_rB,box2d.b2Vec2.s_t0),box2d.b2AddVCrossSV(A,z,this.m_rA,box2d.b2Vec2.s_t1),box2d.b2WeldJoint.prototype.SolveVelocityConstraints.s_Cdot1);q=box2d.b2MulM33XY(this.m_mass,q.x,q.y,box2d.b2WeldJoint.prototype.SolveVelocityConstraints.s_impulse1).SelfNeg();this.m_impulse.x+=q.x;this.m_impulse.y+=q.y;A.SelfMulSub(u,q);z-=r*box2d.b2CrossVV(this.m_rA,q);y.SelfMulAdd(s,q);v+=n*box2d.b2CrossVV(this.m_rB,q)}else{var q=box2d.b2SubVV(box2d.b2AddVCrossSV(y,v,this.m_rB,box2d.b2Vec2.s_t0),box2d.b2AddVCrossSV(A,z,this.m_rA,box2d.b2Vec2.s_t1),box2d.b2WeldJoint.prototype.SolveVelocityConstraints.s_Cdot1),j=box2d.b2MulM33XYZ(this.m_mass,q.x,q.y,v-z,box2d.b2WeldJoint.prototype.SolveVelocityConstraints.s_impulse).SelfNeg();this.m_impulse.SelfAdd(j);q=box2d.b2WeldJoint.prototype.SolveVelocityConstraints.s_P.SetXY(j.x,j.y);A.SelfMulSub(u,q);z-=r*(box2d.b2CrossVV(this.m_rA,q)+j.z);y.SelfMulAdd(s,q);v+=n*(box2d.b2CrossVV(this.m_rB,q)+j.z)}B.velocities[this.m_indexA].w=z;B.velocities[this.m_indexB].w=v};goog.exportProperty(box2d.b2WeldJoint.prototype,"SolveVelocityConstraints",box2d.b2WeldJoint.prototype.SolveVelocityConstraints);box2d.b2WeldJoint.prototype.SolveVelocityConstraints.s_Cdot1=new box2d.b2Vec2;box2d.b2WeldJoint.prototype.SolveVelocityConstraints.s_impulse1=new box2d.b2Vec2;box2d.b2WeldJoint.prototype.SolveVelocityConstraints.s_impulse=new box2d.b2Vec3;box2d.b2WeldJoint.prototype.SolveVelocityConstraints.s_P=new box2d.b2Vec2;box2d.b2WeldJoint.prototype.SolvePositionConstraints=function(I){var H=I.positions[this.m_indexA].c,G=I.positions[this.m_indexA].a,F=I.positions[this.m_indexB].c,E=I.positions[this.m_indexB].a,D=this.m_qA.SetAngleRadians(G),C=this.m_qB.SetAngleRadians(E),B=this.m_invMassA,z=this.m_invMassB,A=this.m_invIA,y=this.m_invIB;box2d.b2SubVV(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA);var v=box2d.b2MulRV(D,this.m_lalcA,this.m_rA);box2d.b2SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB);var u=box2d.b2MulRV(C,this.m_lalcB,this.m_rB),s=this.m_K;s.ex.x=B+z+v.y*v.y*A+u.y*u.y*y;s.ey.x=-v.y*v.x*A-u.y*u.x*y;s.ez.x=-v.y*A-u.y*y;s.ex.y=s.ey.x;s.ey.y=B+z+v.x*v.x*A+u.x*u.x*y;s.ez.y=v.x*A+u.x*y;s.ex.z=s.ez.x;s.ey.z=s.ez.y;s.ez.z=A+y;if(0<this.m_frequencyHz){var j=box2d.b2SubVV(box2d.b2AddVV(F,u,box2d.b2Vec2.s_t0),box2d.b2AddVV(H,v,box2d.b2Vec2.s_t1),box2d.b2WeldJoint.prototype.SolvePositionConstraints.s_C1),C=j.GetLength(),D=0,s=s.Solve22(j.x,j.y,box2d.b2WeldJoint.prototype.SolvePositionConstraints.s_P).SelfNeg();H.SelfMulSub(B,s);G-=A*box2d.b2CrossVV(v,s);F.SelfMulAdd(z,s);E+=y*box2d.b2CrossVV(u,s)}else{j=box2d.b2SubVV(box2d.b2AddVV(F,u,box2d.b2Vec2.s_t0),box2d.b2AddVV(H,v,box2d.b2Vec2.s_t1),box2d.b2WeldJoint.prototype.SolvePositionConstraints.s_C1),u=E-G-this.m_referenceAngle,C=j.GetLength(),D=box2d.b2Abs(u),v=box2d.b2WeldJoint.prototype.SolvePositionConstraints.s_impulse,0<s.ez.z?s.Solve33(j.x,j.y,u,v).SelfNeg():(s=s.Solve22(j.x,j.y,box2d.b2WeldJoint.prototype.SolvePositionConstraints.s_impulse2).SelfNeg(),v.x=s.x,v.y=s.y,v.z=0),s=box2d.b2WeldJoint.prototype.SolvePositionConstraints.s_P.SetXY(v.x,v.y),H.SelfMulSub(B,s),G-=A*(box2d.b2CrossVV(this.m_rA,s)+v.z),F.SelfMulAdd(z,s),E+=y*(box2d.b2CrossVV(this.m_rB,s)+v.z)}I.positions[this.m_indexA].a=G;I.positions[this.m_indexB].a=E;return C<=box2d.b2_linearSlop&&D<=box2d.b2_angularSlop};goog.exportProperty(box2d.b2WeldJoint.prototype,"SolvePositionConstraints",box2d.b2WeldJoint.prototype.SolvePositionConstraints);box2d.b2WeldJoint.prototype.SolvePositionConstraints.s_C1=new box2d.b2Vec2;box2d.b2WeldJoint.prototype.SolvePositionConstraints.s_P=new box2d.b2Vec2;box2d.b2WeldJoint.prototype.SolvePositionConstraints.s_impulse=new box2d.b2Vec3;box2d.b2WeldJoint.prototype.SolvePositionConstraints.s_impulse2=new box2d.b2Vec2;box2d.b2WeldJoint.prototype.GetAnchorA=function(b){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,b)};goog.exportProperty(box2d.b2WeldJoint.prototype,"GetAnchorA",box2d.b2WeldJoint.prototype.GetAnchorA);box2d.b2WeldJoint.prototype.GetAnchorB=function(b){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,b)};goog.exportProperty(box2d.b2WeldJoint.prototype,"GetAnchorB",box2d.b2WeldJoint.prototype.GetAnchorB);box2d.b2WeldJoint.prototype.GetReactionForce=function(e,d){return d.SetXY(e*this.m_impulse.x,e*this.m_impulse.y)};goog.exportProperty(box2d.b2WeldJoint.prototype,"GetReactionForce",box2d.b2WeldJoint.prototype.GetReactionForce);box2d.b2WeldJoint.prototype.GetReactionTorque=function(b){return b*this.m_impulse.z};goog.exportProperty(box2d.b2WeldJoint.prototype,"GetReactionTorque",box2d.b2WeldJoint.prototype.GetReactionTorque);box2d.b2WeldJoint.prototype.GetLocalAnchorA=function(b){return b.Copy(this.m_localAnchorA)};goog.exportProperty(box2d.b2WeldJoint.prototype,"GetLocalAnchorA",box2d.b2WeldJoint.prototype.GetLocalAnchorA);box2d.b2WeldJoint.prototype.GetLocalAnchorB=function(b){return b.Copy(this.m_localAnchorB)};goog.exportProperty(box2d.b2WeldJoint.prototype,"GetLocalAnchorB",box2d.b2WeldJoint.prototype.GetLocalAnchorB);box2d.b2WeldJoint.prototype.GetReferenceAngle=function(){return this.m_referenceAngle};goog.exportProperty(box2d.b2WeldJoint.prototype,"GetReferenceAngle",box2d.b2WeldJoint.prototype.GetReferenceAngle);box2d.b2WeldJoint.prototype.SetFrequency=function(b){this.m_frequencyHz=b};box2d.b2WeldJoint.prototype.GetFrequency=function(){return this.m_frequencyHz};goog.exportProperty(box2d.b2WeldJoint.prototype,"GetFrequency",box2d.b2WeldJoint.prototype.GetFrequency);box2d.b2WeldJoint.prototype.SetDampingRatio=function(b){this.m_dampingRatio=b};box2d.b2WeldJoint.prototype.GetDampingRatio=function(){return this.m_dampingRatio};goog.exportProperty(box2d.b2WeldJoint.prototype,"GetDampingRatio",box2d.b2WeldJoint.prototype.GetDampingRatio);box2d.b2WeldJoint.prototype.Dump=function(){if(box2d.DEBUG){var e=this.m_bodyA.m_islandIndex,d=this.m_bodyB.m_islandIndex;box2d.b2Log("  /*box2d.b2WeldJointDef*/ var jd = new box2d.b2WeldJointDef();\n");box2d.b2Log("  jd.bodyA = bodies[%d];\n",e);box2d.b2Log("  jd.bodyB = bodies[%d];\n",d);box2d.b2Log("  jd.collideConnected = %s;\n",this.m_collideConnected?"true":"false");box2d.b2Log("  jd.localAnchorA.SetXY(%.15f, %.15f);\n",this.m_localAnchorA.x,this.m_localAnchorA.y);box2d.b2Log("  jd.localAnchorB.SetXY(%.15f, %.15f);\n",this.m_localAnchorB.x,this.m_localAnchorB.y);box2d.b2Log("  jd.referenceAngle = %.15f;\n",this.m_referenceAngle);box2d.b2Log("  jd.frequencyHz = %.15f;\n",this.m_frequencyHz);box2d.b2Log("  jd.dampingRatio = %.15f;\n",this.m_dampingRatio);box2d.b2Log("  joints[%d] = this.m_world.CreateJoint(jd);\n",this.m_index)}};goog.exportProperty(box2d.b2WeldJoint.prototype,"Dump",box2d.b2WeldJoint.prototype.Dump);box2d.b2WheelJointDef=function(){box2d.b2JointDef.call(this,box2d.b2JointType.e_wheelJoint);this.localAnchorA=new box2d.b2Vec2(0,0);this.localAnchorB=new box2d.b2Vec2(0,0);this.localAxisA=new box2d.b2Vec2(1,0)};goog.inherits(box2d.b2WheelJointDef,box2d.b2JointDef);goog.exportSymbol("box2d.b2WheelJointDef",box2d.b2WheelJointDef);box2d.b2WheelJointDef.prototype.localAnchorA=null;goog.exportProperty(box2d.b2WheelJointDef.prototype,"localAnchorA",box2d.b2WheelJointDef.prototype.localAnchorA);box2d.b2WheelJointDef.prototype.localAnchorB=null;goog.exportProperty(box2d.b2WheelJointDef.prototype,"localAnchorB",box2d.b2WheelJointDef.prototype.localAnchorB);box2d.b2WheelJointDef.prototype.localAxisA=null;goog.exportProperty(box2d.b2WheelJointDef.prototype,"localAxisA",box2d.b2WheelJointDef.prototype.localAxisA);box2d.b2WheelJointDef.prototype.enableMotor=!1;goog.exportProperty(box2d.b2WheelJointDef.prototype,"enableMotor",box2d.b2WheelJointDef.prototype.enableMotor);box2d.b2WheelJointDef.prototype.maxMotorTorque=0;goog.exportProperty(box2d.b2WheelJointDef.prototype,"maxMotorTorque",box2d.b2WheelJointDef.prototype.maxMotorTorque);box2d.b2WheelJointDef.prototype.motorSpeed=0;goog.exportProperty(box2d.b2WheelJointDef.prototype,"motorSpeed",box2d.b2WheelJointDef.prototype.motorSpeed);box2d.b2WheelJointDef.prototype.frequencyHz=2;goog.exportProperty(box2d.b2WheelJointDef.prototype,"frequencyHz",box2d.b2WheelJointDef.prototype.frequencyHz);box2d.b2WheelJointDef.prototype.dampingRatio=0.7;goog.exportProperty(box2d.b2WheelJointDef.prototype,"dampingRatio",box2d.b2WheelJointDef.prototype.dampingRatio);box2d.b2WheelJointDef.prototype.Initialize=function(f,e,j,g){this.bodyA=f;this.bodyB=e;this.bodyA.GetLocalPoint(j,this.localAnchorA);this.bodyB.GetLocalPoint(j,this.localAnchorB);this.bodyA.GetLocalVector(g,this.localAxisA)};goog.exportProperty(box2d.b2WheelJointDef.prototype,"Initialize",box2d.b2WheelJointDef.prototype.Initialize);box2d.b2WheelJoint=function(b){box2d.b2Joint.call(this,b);this.m_frequencyHz=b.frequencyHz;this.m_dampingRatio=b.dampingRatio;this.m_localAnchorA=b.localAnchorA.Clone();this.m_localAnchorB=b.localAnchorB.Clone();this.m_localXAxisA=b.localAxisA.Clone();this.m_localYAxisA=box2d.b2CrossOneV(this.m_localXAxisA,new box2d.b2Vec2);this.m_maxMotorTorque=b.maxMotorTorque;this.m_motorSpeed=b.motorSpeed;this.m_enableMotor=b.enableMotor;this.m_localCenterA=new box2d.b2Vec2;this.m_localCenterB=new box2d.b2Vec2;this.m_ax=new box2d.b2Vec2;this.m_ay=new box2d.b2Vec2;this.m_qA=new box2d.b2Rot;this.m_qB=new box2d.b2Rot;this.m_lalcA=new box2d.b2Vec2;this.m_lalcB=new box2d.b2Vec2;this.m_rA=new box2d.b2Vec2;this.m_rB=new box2d.b2Vec2;this.m_ax.SetZero();this.m_ay.SetZero()};goog.inherits(box2d.b2WheelJoint,box2d.b2Joint);goog.exportSymbol("box2d.b2WheelJoint",box2d.b2WheelJoint);box2d.b2WheelJoint.prototype.m_frequencyHz=0;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_frequencyHz",box2d.b2WheelJoint.prototype.m_frequencyHz);box2d.b2WheelJoint.prototype.m_dampingRatio=0;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_dampingRatio",box2d.b2WheelJoint.prototype.m_dampingRatio);box2d.b2WheelJoint.prototype.m_localAnchorA=null;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_localAnchorA",box2d.b2WheelJoint.prototype.m_localAnchorA);box2d.b2WheelJoint.prototype.m_localAnchorB=null;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_localAnchorB",box2d.b2WheelJoint.prototype.m_localAnchorB);box2d.b2WheelJoint.prototype.m_localXAxisA=null;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_localXAxisA",box2d.b2WheelJoint.prototype.m_localXAxisA);box2d.b2WheelJoint.prototype.m_localYAxisA=null;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_localYAxisA",box2d.b2WheelJoint.prototype.m_localYAxisA);box2d.b2WheelJoint.prototype.m_impulse=0;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_impulse",box2d.b2WheelJoint.prototype.m_impulse);box2d.b2WheelJoint.prototype.m_motorImpulse=0;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_motorImpulse",box2d.b2WheelJoint.prototype.m_motorImpulse);box2d.b2WheelJoint.prototype.m_springImpulse=0;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_springImpulse",box2d.b2WheelJoint.prototype.m_springImpulse);box2d.b2WheelJoint.prototype.m_maxMotorTorque=0;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_maxMotorTorque",box2d.b2WheelJoint.prototype.m_maxMotorTorque);box2d.b2WheelJoint.prototype.m_motorSpeed=0;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_motorSpeed",box2d.b2WheelJoint.prototype.m_motorSpeed);box2d.b2WheelJoint.prototype.m_enableMotor=!1;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_enableMotor",box2d.b2WheelJoint.prototype.m_enableMotor);box2d.b2WheelJoint.prototype.m_indexA=0;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_indexA",box2d.b2WheelJoint.prototype.m_indexA);box2d.b2WheelJoint.prototype.m_indexB=0;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_indexB",box2d.b2WheelJoint.prototype.m_indexB);box2d.b2WheelJoint.prototype.m_localCenterA=null;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_localCenterA",box2d.b2WheelJoint.prototype.m_localCenterA);box2d.b2WheelJoint.prototype.m_localCenterB=null;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_localCenterB",box2d.b2WheelJoint.prototype.m_localCenterB);box2d.b2WheelJoint.prototype.m_invMassA=0;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_invMassA",box2d.b2WheelJoint.prototype.m_invMassA);box2d.b2WheelJoint.prototype.m_invMassB=0;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_invMassB",box2d.b2WheelJoint.prototype.m_invMassB);box2d.b2WheelJoint.prototype.m_invIA=0;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_invIA",box2d.b2WheelJoint.prototype.m_invIA);box2d.b2WheelJoint.prototype.m_invIB=0;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_invIB",box2d.b2WheelJoint.prototype.m_invIB);box2d.b2WheelJoint.prototype.m_ax=null;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_ax",box2d.b2WheelJoint.prototype.m_ax);box2d.b2WheelJoint.prototype.m_ay=null;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_ay",box2d.b2WheelJoint.prototype.m_ay);box2d.b2WheelJoint.prototype.m_sAx=0;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_sAx",box2d.b2WheelJoint.prototype.m_sAx);box2d.b2WheelJoint.prototype.m_sBx=0;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_sBx",box2d.b2WheelJoint.prototype.m_sBx);box2d.b2WheelJoint.prototype.m_sAy=0;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_sAy",box2d.b2WheelJoint.prototype.m_sAy);box2d.b2WheelJoint.prototype.m_sBy=0;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_sBy",box2d.b2WheelJoint.prototype.m_sBy);box2d.b2WheelJoint.prototype.m_mass=0;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_mass",box2d.b2WheelJoint.prototype.m_mass);box2d.b2WheelJoint.prototype.m_motorMass=0;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_motorMass",box2d.b2WheelJoint.prototype.m_motorMass);box2d.b2WheelJoint.prototype.m_springMass=0;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_springMass",box2d.b2WheelJoint.prototype.m_springMass);box2d.b2WheelJoint.prototype.m_bias=0;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_bias",box2d.b2WheelJoint.prototype.m_bias);box2d.b2WheelJoint.prototype.m_gamma=0;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_gamma",box2d.b2WheelJoint.prototype.m_gamma);box2d.b2WheelJoint.prototype.m_qA=null;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_qA",box2d.b2WheelJoint.prototype.m_qA);box2d.b2WheelJoint.prototype.m_qB=null;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_qB",box2d.b2WheelJoint.prototype.m_qB);box2d.b2WheelJoint.prototype.m_lalcA=null;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_lalcA",box2d.b2WheelJoint.prototype.m_lalcA);box2d.b2WheelJoint.prototype.m_lalcB=null;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_lalcB",box2d.b2WheelJoint.prototype.m_lalcB);box2d.b2WheelJoint.prototype.m_rA=null;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_rA",box2d.b2WheelJoint.prototype.m_rA);box2d.b2WheelJoint.prototype.m_rB=null;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_rB",box2d.b2WheelJoint.prototype.m_rB);box2d.b2WheelJoint.prototype.GetMotorSpeed=function(){return this.m_motorSpeed};goog.exportProperty(box2d.b2WheelJoint.prototype,"GetMotorSpeed",box2d.b2WheelJoint.prototype.GetMotorSpeed);box2d.b2WheelJoint.prototype.GetMaxMotorTorque=function(){return this.m_maxMotorTorque};goog.exportProperty(box2d.b2WheelJoint.prototype,"GetMaxMotorTorque",box2d.b2WheelJoint.prototype.GetMaxMotorTorque);box2d.b2WheelJoint.prototype.SetSpringFrequencyHz=function(b){this.m_frequencyHz=b};goog.exportProperty(box2d.b2WheelJoint.prototype,"SetSpringFrequencyHz",box2d.b2WheelJoint.prototype.SetSpringFrequencyHz);box2d.b2WheelJoint.prototype.GetSpringFrequencyHz=function(){return this.m_frequencyHz};goog.exportProperty(box2d.b2WheelJoint.prototype,"GetSpringFrequencyHz",box2d.b2WheelJoint.prototype.GetSpringFrequencyHz);box2d.b2WheelJoint.prototype.SetSpringDampingRatio=function(b){this.m_dampingRatio=b};goog.exportProperty(box2d.b2WheelJoint.prototype,"SetSpringDampingRatio",box2d.b2WheelJoint.prototype.SetSpringDampingRatio);box2d.b2WheelJoint.prototype.GetSpringDampingRatio=function(){return this.m_dampingRatio};goog.exportProperty(box2d.b2WheelJoint.prototype,"GetSpringDampingRatio",box2d.b2WheelJoint.prototype.GetSpringDampingRatio);box2d.b2WheelJoint.prototype.InitVelocityConstraints=function(G){this.m_indexA=this.m_bodyA.m_islandIndex;this.m_indexB=this.m_bodyB.m_islandIndex;this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter);this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter);this.m_invMassA=this.m_bodyA.m_invMass;this.m_invMassB=this.m_bodyB.m_invMass;this.m_invIA=this.m_bodyA.m_invI;this.m_invIB=this.m_bodyB.m_invI;var F=this.m_invMassA,E=this.m_invMassB,D=this.m_invIA,C=this.m_invIB,B=G.positions[this.m_indexA].c,A=G.velocities[this.m_indexA].v,z=G.velocities[this.m_indexA].w,v=G.positions[this.m_indexB].c,y=G.positions[this.m_indexB].a,u=G.velocities[this.m_indexB].v,s=G.velocities[this.m_indexB].w,r=this.m_qA.SetAngleRadians(G.positions[this.m_indexA].a),j=this.m_qB.SetAngleRadians(y);box2d.b2SubVV(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA);y=box2d.b2MulRV(r,this.m_lalcA,this.m_rA);box2d.b2SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB);j=box2d.b2MulRV(j,this.m_lalcB,this.m_rB);B=box2d.b2SubVV(box2d.b2AddVV(v,j,box2d.b2Vec2.s_t0),box2d.b2AddVV(B,y,box2d.b2Vec2.s_t1),box2d.b2WheelJoint.prototype.InitVelocityConstraints.s_d);box2d.b2MulRV(r,this.m_localYAxisA,this.m_ay);this.m_sAy=box2d.b2CrossVV(box2d.b2AddVV(B,y,box2d.b2Vec2.s_t0),this.m_ay);this.m_sBy=box2d.b2CrossVV(j,this.m_ay);this.m_mass=F+E+D*this.m_sAy*this.m_sAy+C*this.m_sBy*this.m_sBy;0<this.m_mass&&(this.m_mass=1/this.m_mass);this.m_gamma=this.m_bias=this.m_springMass=0;0<this.m_frequencyHz?(box2d.b2MulRV(r,this.m_localXAxisA,this.m_ax),this.m_sAx=box2d.b2CrossVV(box2d.b2AddVV(B,y,box2d.b2Vec2.s_t0),this.m_ax),this.m_sBx=box2d.b2CrossVV(j,this.m_ax),F=F+E+D*this.m_sAx*this.m_sAx+C*this.m_sBx*this.m_sBx,0<F&&(this.m_springMass=1/F,E=box2d.b2DotVV(B,this.m_ax),r=2*box2d.b2_pi*this.m_frequencyHz,B=this.m_springMass*r*r,v=G.step.dt,this.m_gamma=v*(2*this.m_springMass*this.m_dampingRatio*r+v*B),0<this.m_gamma&&(this.m_gamma=1/this.m_gamma),this.m_bias=E*v*B*this.m_gamma,this.m_springMass=F+this.m_gamma,0<this.m_springMass&&(this.m_springMass=1/this.m_springMass))):this.m_springImpulse=0;this.m_enableMotor?(this.m_motorMass=D+C,0<this.m_motorMass&&(this.m_motorMass=1/this.m_motorMass)):this.m_motorImpulse=this.m_motorMass=0;G.step.warmStarting?(this.m_impulse*=G.step.dtRatio,this.m_springImpulse*=G.step.dtRatio,this.m_motorImpulse*=G.step.dtRatio,D=box2d.b2AddVV(box2d.b2MulSV(this.m_impulse,this.m_ay,box2d.b2Vec2.s_t0),box2d.b2MulSV(this.m_springImpulse,this.m_ax,box2d.b2Vec2.s_t1),box2d.b2WheelJoint.prototype.InitVelocityConstraints.s_P),C=this.m_impulse*this.m_sAy+this.m_springImpulse*this.m_sAx+this.m_motorImpulse,F=this.m_impulse*this.m_sBy+this.m_springImpulse*this.m_sBx+this.m_motorImpulse,A.SelfMulSub(this.m_invMassA,D),z-=this.m_invIA*C,u.SelfMulAdd(this.m_invMassB,D),s+=this.m_invIB*F):this.m_motorImpulse=this.m_springImpulse=this.m_impulse=0;G.velocities[this.m_indexA].w=z;G.velocities[this.m_indexB].w=s};goog.exportProperty(box2d.b2WheelJoint.prototype,"InitVelocityConstraints",box2d.b2WheelJoint.prototype.InitVelocityConstraints);box2d.b2WheelJoint.prototype.InitVelocityConstraints.s_d=new box2d.b2Vec2;box2d.b2WheelJoint.prototype.InitVelocityConstraints.s_P=new box2d.b2Vec2;box2d.b2WheelJoint.prototype.SolveVelocityConstraints=function(D){var C=this.m_invMassA,B=this.m_invMassB,A=this.m_invIA,z=this.m_invIB,y=D.velocities[this.m_indexA].v,v=D.velocities[this.m_indexA].w,u=D.velocities[this.m_indexB].v,r=D.velocities[this.m_indexB].w,s=box2d.b2DotVV(this.m_ax,box2d.b2SubVV(u,y,box2d.b2Vec2.s_t0))+this.m_sBx*r-this.m_sAx*v,s=-this.m_springMass*(s+this.m_bias+this.m_gamma*this.m_springImpulse);this.m_springImpulse+=s;var q=box2d.b2MulSV(s,this.m_ax,box2d.b2WheelJoint.prototype.SolveVelocityConstraints.s_P),j=s*this.m_sAx,s=s*this.m_sBx;y.SelfMulSub(C,q);v-=A*j;u.SelfMulAdd(B,q);r+=z*s;s=r-v-this.m_motorSpeed;s*=-this.m_motorMass;q=this.m_motorImpulse;j=D.step.dt*this.m_maxMotorTorque;this.m_motorImpulse=box2d.b2Clamp(this.m_motorImpulse+s,-j,j);s=this.m_motorImpulse-q;v-=A*s;r+=z*s;s=box2d.b2DotVV(this.m_ay,box2d.b2SubVV(u,y,box2d.b2Vec2.s_t0))+this.m_sBy*r-this.m_sAy*v;s*=-this.m_mass;this.m_impulse+=s;q=box2d.b2MulSV(s,this.m_ay,box2d.b2WheelJoint.prototype.SolveVelocityConstraints.s_P);j=s*this.m_sAy;s*=this.m_sBy;y.SelfMulSub(C,q);v-=A*j;u.SelfMulAdd(B,q);D.velocities[this.m_indexA].w=v;D.velocities[this.m_indexB].w=r+z*s};goog.exportProperty(box2d.b2WheelJoint.prototype,"SolveVelocityConstraints",box2d.b2WheelJoint.prototype.SolveVelocityConstraints);box2d.b2WheelJoint.prototype.SolveVelocityConstraints.s_P=new box2d.b2Vec2;box2d.b2WheelJoint.prototype.SolvePositionConstraints=function(z){var y=z.positions[this.m_indexA].c,v=z.positions[this.m_indexA].a,u=z.positions[this.m_indexB].c,s=z.positions[this.m_indexB].a,r=this.m_qA.SetAngleRadians(v),q=this.m_qB.SetAngleRadians(s);box2d.b2SubVV(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA);var n=box2d.b2MulRV(r,this.m_lalcA,this.m_rA);box2d.b2SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB);var q=box2d.b2MulRV(q,this.m_lalcB,this.m_rB),j=box2d.b2AddVV(box2d.b2SubVV(u,y,box2d.b2Vec2.s_t0),box2d.b2SubVV(q,n,box2d.b2Vec2.s_t1),box2d.b2WheelJoint.prototype.SolvePositionConstraints.s_d),r=box2d.b2MulRV(r,this.m_localYAxisA,this.m_ay),n=box2d.b2CrossVV(box2d.b2AddVV(j,n,box2d.b2Vec2.s_t0),r),q=box2d.b2CrossVV(q,r),j=box2d.b2DotVV(j,this.m_ay),m=this.m_invMassA+this.m_invMassB+this.m_invIA*this.m_sAy*this.m_sAy+this.m_invIB*this.m_sBy*this.m_sBy,m=0!==m?-j/m:0,r=box2d.b2MulSV(m,r,box2d.b2WheelJoint.prototype.SolvePositionConstraints.s_P),n=m*n,q=m*q;y.SelfMulSub(this.m_invMassA,r);v-=this.m_invIA*n;u.SelfMulAdd(this.m_invMassB,r);s+=this.m_invIB*q;z.positions[this.m_indexA].a=v;z.positions[this.m_indexB].a=s;return box2d.b2Abs(j)<=box2d.b2_linearSlop};goog.exportProperty(box2d.b2WheelJoint.prototype,"SolvePositionConstraints",box2d.b2WheelJoint.prototype.SolvePositionConstraints);box2d.b2WheelJoint.prototype.SolvePositionConstraints.s_d=new box2d.b2Vec2;box2d.b2WheelJoint.prototype.SolvePositionConstraints.s_P=new box2d.b2Vec2;box2d.b2WheelJoint.prototype.GetDefinition=function(b){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1);return b};goog.exportProperty(box2d.b2WheelJoint.prototype,"GetDefinition",box2d.b2WheelJoint.prototype.GetDefinition);box2d.b2WheelJoint.prototype.GetAnchorA=function(b){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,b)};goog.exportProperty(box2d.b2WheelJoint.prototype,"GetAnchorA",box2d.b2WheelJoint.prototype.GetAnchorA);box2d.b2WheelJoint.prototype.GetAnchorB=function(b){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,b)};goog.exportProperty(box2d.b2WheelJoint.prototype,"GetAnchorB",box2d.b2WheelJoint.prototype.GetAnchorB);box2d.b2WheelJoint.prototype.GetReactionForce=function(e,d){d.x=e*(this.m_impulse*this.m_ay.x+this.m_springImpulse*this.m_ax.x);d.y=e*(this.m_impulse*this.m_ay.y+this.m_springImpulse*this.m_ax.y);return d};goog.exportProperty(box2d.b2WheelJoint.prototype,"GetReactionForce",box2d.b2WheelJoint.prototype.GetReactionForce);box2d.b2WheelJoint.prototype.GetReactionTorque=function(b){return b*this.m_motorImpulse};goog.exportProperty(box2d.b2WheelJoint.prototype,"GetReactionTorque",box2d.b2WheelJoint.prototype.GetReactionTorque);box2d.b2WheelJoint.prototype.GetLocalAnchorA=function(b){return b.Copy(this.m_localAnchorA)};goog.exportProperty(box2d.b2WheelJoint.prototype,"GetLocalAnchorA",box2d.b2WheelJoint.prototype.GetLocalAnchorA);box2d.b2WheelJoint.prototype.GetLocalAnchorB=function(b){return b.Copy(this.m_localAnchorB)};goog.exportProperty(box2d.b2WheelJoint.prototype,"GetLocalAnchorB",box2d.b2WheelJoint.prototype.GetLocalAnchorB);box2d.b2WheelJoint.prototype.GetLocalAxisA=function(b){return b.Copy(this.m_localXAxisA)};goog.exportProperty(box2d.b2WheelJoint.prototype,"GetLocalAxisA",box2d.b2WheelJoint.prototype.GetLocalAxisA);box2d.b2WheelJoint.prototype.GetJointTranslation=function(){var e=this.m_bodyA,d=this.m_bodyB,f=e.GetWorldPoint(this.m_localAnchorA,new box2d.b2Vec2),d=d.GetWorldPoint(this.m_localAnchorB,new box2d.b2Vec2),f=box2d.b2SubVV(d,f,new box2d.b2Vec2),e=e.GetWorldVector(this.m_localXAxisA,new box2d.b2Vec2);return box2d.b2DotVV(f,e)};goog.exportProperty(box2d.b2WheelJoint.prototype,"GetJointTranslation",box2d.b2WheelJoint.prototype.GetJointTranslation);box2d.b2WheelJoint.prototype.GetJointSpeed=function(){return this.m_bodyB.m_angularVelocity-this.m_bodyA.m_angularVelocity};goog.exportProperty(box2d.b2WheelJoint.prototype,"GetJointSpeed",box2d.b2WheelJoint.prototype.GetJointSpeed);box2d.b2WheelJoint.prototype.IsMotorEnabled=function(){return this.m_enableMotor};goog.exportProperty(box2d.b2WheelJoint.prototype,"IsMotorEnabled",box2d.b2WheelJoint.prototype.IsMotorEnabled);box2d.b2WheelJoint.prototype.EnableMotor=function(b){this.m_bodyA.SetAwake(!0);this.m_bodyB.SetAwake(!0);this.m_enableMotor=b};goog.exportProperty(box2d.b2WheelJoint.prototype,"EnableMotor",box2d.b2WheelJoint.prototype.EnableMotor);box2d.b2WheelJoint.prototype.SetMotorSpeed=function(b){this.m_bodyA.SetAwake(!0);this.m_bodyB.SetAwake(!0);this.m_motorSpeed=b};goog.exportProperty(box2d.b2WheelJoint.prototype,"SetMotorSpeed",box2d.b2WheelJoint.prototype.SetMotorSpeed);box2d.b2WheelJoint.prototype.SetMaxMotorTorque=function(b){this.m_bodyA.SetAwake(!0);this.m_bodyB.SetAwake(!0);this.m_maxMotorTorque=b};goog.exportProperty(box2d.b2WheelJoint.prototype,"SetMaxMotorTorque",box2d.b2WheelJoint.prototype.SetMaxMotorTorque);box2d.b2WheelJoint.prototype.GetMotorTorque=function(b){return b*this.m_motorImpulse};goog.exportProperty(box2d.b2WheelJoint.prototype,"GetMotorTorque",box2d.b2WheelJoint.prototype.GetMotorTorque);box2d.b2WheelJoint.prototype.Dump=function(){if(box2d.DEBUG){var e=this.m_bodyA.m_islandIndex,d=this.m_bodyB.m_islandIndex;box2d.b2Log("  /*box2d.b2WheelJointDef*/ var jd = new box2d.b2WheelJointDef();\n");box2d.b2Log("  jd.bodyA = bodies[%d];\n",e);box2d.b2Log("  jd.bodyB = bodies[%d];\n",d);box2d.b2Log("  jd.collideConnected = %s;\n",this.m_collideConnected?"true":"false");box2d.b2Log("  jd.localAnchorA.SetXY(%.15f, %.15f);\n",this.m_localAnchorA.x,this.m_localAnchorA.y);box2d.b2Log("  jd.localAnchorB.SetXY(%.15f, %.15f);\n",this.m_localAnchorB.x,this.m_localAnchorB.y);box2d.b2Log("  jd.localAxisA.Set(%.15f, %.15f);\n",this.m_localXAxisA.x,this.m_localXAxisA.y);box2d.b2Log("  jd.enableMotor = %s;\n",this.m_enableMotor?"true":"false");box2d.b2Log("  jd.motorSpeed = %.15f;\n",this.m_motorSpeed);box2d.b2Log("  jd.maxMotorTorque = %.15f;\n",this.m_maxMotorTorque);box2d.b2Log("  jd.frequencyHz = %.15f;\n",this.m_frequencyHz);box2d.b2Log("  jd.dampingRatio = %.15f;\n",this.m_dampingRatio);box2d.b2Log("  joints[%d] = this.m_world.CreateJoint(jd);\n",this.m_index)}};goog.exportProperty(box2d.b2WheelJoint.prototype,"Dump",box2d.b2WheelJoint.prototype.Dump);box2d.b2RopeDef=function(){this.vertices=[];this.masses=[];this.gravity=new box2d.b2Vec2};goog.exportSymbol("box2d.b2RopeDef",box2d.b2RopeDef);box2d.b2RopeDef.prototype.vertices=null;box2d.b2RopeDef.prototype.count=0;box2d.b2RopeDef.prototype.masses=null;box2d.b2RopeDef.prototype.gravity=null;box2d.b2RopeDef.prototype.damping=0.1;box2d.b2RopeDef.prototype.k2=0.9;box2d.b2RopeDef.prototype.k3=0.1;box2d.b2Rope=function(){this.m_gravity=new box2d.b2Vec2};goog.exportSymbol("box2d.b2Rope",box2d.b2Rope);box2d.b2Rope.prototype.m_count=0;box2d.b2Rope.prototype.m_ps=null;box2d.b2Rope.prototype.m_p0s=null;box2d.b2Rope.prototype.m_vs=null;box2d.b2Rope.prototype.m_ims=null;box2d.b2Rope.prototype.m_Ls=null;box2d.b2Rope.prototype.m_as=null;box2d.b2Rope.prototype.m_gravity=null;box2d.b2Rope.prototype.m_damping=0;box2d.b2Rope.prototype.m_k2=1;box2d.b2Rope.prototype.m_k3=0.1;box2d.b2Rope.prototype.GetVertexCount=function(){return this.m_count};goog.exportProperty(box2d.b2Rope.prototype,"GetVertexCount",box2d.b2Rope.prototype.GetVertexCount);box2d.b2Rope.prototype.GetVertices=function(){return this.m_ps};goog.exportProperty(box2d.b2Rope.prototype,"GetVertices",box2d.b2Rope.prototype.GetVertices);box2d.b2Rope.prototype.Initialize=function(j){box2d.ENABLE_ASSERTS&&box2d.b2Assert(3<=j.count);this.m_count=j.count;this.m_ps=box2d.b2Vec2.MakeArray(this.m_count);this.m_p0s=box2d.b2Vec2.MakeArray(this.m_count);this.m_vs=box2d.b2Vec2.MakeArray(this.m_count);this.m_ims=box2d.b2MakeNumberArray(this.m_count);for(var g=0;g<this.m_count;++g){this.m_ps[g].Copy(j.vertices[g]);this.m_p0s[g].Copy(j.vertices[g]);this.m_vs[g].SetZero();var q=j.masses[g];this.m_ims[g]=0<q?1/q:0}var n=this.m_count-1,q=this.m_count-2;this.m_Ls=box2d.b2MakeNumberArray(n);this.m_as=box2d.b2MakeNumberArray(q);for(g=0;g<n;++g){var m=this.m_ps[g],k=this.m_ps[g+1];this.m_Ls[g]=box2d.b2DistanceVV(m,k)}for(g=0;g<q;++g){m=this.m_ps[g],k=this.m_ps[g+1],n=this.m_ps[g+2],m=box2d.b2SubVV(k,m,box2d.b2Vec2.s_t0),n=box2d.b2SubVV(n,k,box2d.b2Vec2.s_t1),k=box2d.b2CrossVV(m,n),m=box2d.b2DotVV(m,n),this.m_as[g]=box2d.b2Atan2(k,m)}this.m_gravity.Copy(j.gravity);this.m_damping=j.damping;this.m_k2=j.k2;this.m_k3=j.k3};goog.exportProperty(box2d.b2Rope.prototype,"Initialize",box2d.b2Rope.prototype.Initialize);box2d.b2Rope.prototype.Step=function(f,e){if(0!==f){for(var j=Math.exp(-f*this.m_damping),g=0;g<this.m_count;++g){this.m_p0s[g].Copy(this.m_ps[g]),0<this.m_ims[g]&&this.m_vs[g].SelfMulAdd(f,this.m_gravity),this.m_vs[g].SelfMul(j),this.m_ps[g].SelfMulAdd(f,this.m_vs[g])}for(g=0;g<e;++g){this.SolveC2(),this.SolveC3(),this.SolveC2()}j=1/f;for(g=0;g<this.m_count;++g){box2d.b2MulSV(j,box2d.b2SubVV(this.m_ps[g],this.m_p0s[g],box2d.b2Vec2.s_t0),this.m_vs[g])}}};goog.exportProperty(box2d.b2Rope.prototype,"Step",box2d.b2Rope.prototype.Step);box2d.b2Rope.prototype.SolveC2=function(){for(var v=this.m_count-1,u=0;u<v;++u){var s=this.m_ps[u],r=this.m_ps[u+1],q=box2d.b2SubVV(r,s,box2d.b2Rope.s_d),n=q.Normalize(),m=this.m_ims[u],k=this.m_ims[u+1];if(0!==m+k){var j=k/(m+k);s.SelfMulSub(m/(m+k)*this.m_k2*(this.m_Ls[u]-n),q);r.SelfMulAdd(this.m_k2*j*(this.m_Ls[u]-n),q)}}};goog.exportProperty(box2d.b2Rope.prototype,"SolveC2",box2d.b2Rope.prototype.SolveC2);box2d.b2Rope.s_d=new box2d.b2Vec2;box2d.b2Rope.prototype.SetAngleRadians=function(e){for(var d=this.m_count-2,f=0;f<d;++f){this.m_as[f]=e}};goog.exportProperty(box2d.b2Rope.prototype,"SetAngleRadians",box2d.b2Rope.prototype.SetAngleRadians);box2d.b2Rope.prototype.SolveC3=function(){for(var G=this.m_count-2,F=0;F<G;++F){var E=this.m_ps[F],D=this.m_ps[F+1],C=this.m_ps[F+2],B=this.m_ims[F],A=this.m_ims[F+1],z=this.m_ims[F+2],v=box2d.b2SubVV(D,E,box2d.b2Rope.s_d1),y=box2d.b2SubVV(C,D,box2d.b2Rope.s_d2),u=v.GetLengthSquared(),s=y.GetLengthSquared();if(0!==u*s){var r=box2d.b2CrossVV(v,y),j=box2d.b2DotVV(v,y),r=box2d.b2Atan2(r,j),v=box2d.b2MulSV(-1/u,v.SelfSkew(),box2d.b2Rope.s_Jd1),u=box2d.b2MulSV(1/s,y.SelfSkew(),box2d.b2Rope.s_Jd2),y=box2d.b2NegV(v,box2d.b2Rope.s_J1),s=box2d.b2SubVV(v,u,box2d.b2Rope.s_J2),v=u,u=B*box2d.b2DotVV(y,y)+A*box2d.b2DotVV(s,s)+z*box2d.b2DotVV(v,v);if(0!==u){u=1/u;for(j=r-this.m_as[F];j>box2d.b2_pi;){r-=2*box2d.b2_pi,j=r-this.m_as[F]}for(;j<-box2d.b2_pi;){r+=2*box2d.b2_pi,j=r-this.m_as[F]}r=-this.m_k3*u*j;E.SelfMulAdd(B*r,y);D.SelfMulAdd(A*r,s);C.SelfMulAdd(z*r,v)}}}};goog.exportProperty(box2d.b2Rope.prototype,"SolveC3",box2d.b2Rope.prototype.SolveC3);box2d.b2Rope.s_d1=new box2d.b2Vec2;box2d.b2Rope.s_d2=new box2d.b2Vec2;box2d.b2Rope.s_Jd1=new box2d.b2Vec2;box2d.b2Rope.s_Jd2=new box2d.b2Vec2;box2d.b2Rope.s_J1=new box2d.b2Vec2;box2d.b2Rope.s_J2=new box2d.b2Vec2;box2d.b2Rope.prototype.Draw=function(e){for(var d=new box2d.b2Color(0.4,0.5,0.7),f=0;f<this.m_count-1;++f){e.DrawSegment(this.m_ps[f],this.m_ps[f+1],d)}};goog.exportProperty(box2d.b2Rope.prototype,"Draw",box2d.b2Rope.prototype.Draw);goog.provide("box2d.Render");box2d.b2DebugDraw=function(a){goog.base(this);this.scale=a.scale;this.m_canvas=a.canvas||false;this.m_ctx=a.ctx||false;this.m_settings=a.flags||(box2d.b2DrawFlags.e_shapeBit|box2d.b2DrawFlags.e_centerOfMassBit);this.alpha=a.alpha||0.5};goog.inherits(box2d.b2DebugDraw,box2d.b2Draw);box2d.b2DebugDraw.prototype.m_canvas=null;box2d.b2DebugDraw.prototype.m_ctx=null;box2d.b2DebugDraw.prototype.m_settings=null;box2d.b2DebugDraw.prototype.scale=40;box2d.b2DebugDraw.prototype.alpha=0.5;box2d.b2DebugDraw.prototype.PushTransform=function(b){var a=this.m_ctx;a.save();a.globalAlpha=this.alpha;a.translate(b.p.x*this.scale,b.p.y*this.scale);a.rotate(b.q.GetAngleRadians())};box2d.b2DebugDraw.prototype.PopTransform=function(b){var a=this.m_ctx;a.restore()};box2d.b2DebugDraw.prototype.DrawPolygon=function(d,f,b){if(!f){return}var a=this.m_ctx;a.globalAlpha=1;a.beginPath();a.moveTo(d[0].x*this.scale,d[0].y*this.scale);for(var e=1;e<f;e++){a.lineTo(d[e].x*this.scale,d[e].y*this.scale)}a.closePath();a.strokeStyle=b.MakeStyleString(1);a.stroke()};box2d.b2DebugDraw.prototype.DrawSolidPolygon=function(d,f,b){if(!f){return}var a=this.m_ctx;a.beginPath();a.moveTo(d[0].x*this.scale,d[0].y*this.scale);for(var e=1;e<f;e++){a.lineTo(d[e].x*this.scale,d[e].y*this.scale)}a.closePath();a.fillStyle=b.MakeStyleString(0.5);a.fill();a.strokeStyle=b.MakeStyleString(1);a.stroke()};box2d.b2DebugDraw.prototype.DrawCircle=function(b,a,e){if(!a){return}var d=this.m_ctx;d.beginPath();d.arc(b.x*this.scale,b.y*this.scale,a*this.scale,0,box2d.b2_pi*2,true);d.strokeStyle=e.MakeStyleString(1);d.stroke()};box2d.b2DebugDraw.prototype.DrawSolidCircle=function(d,b,g,f){if(!b){return}var e=this.m_ctx;var a=d.x*this.scale;var j=d.y*this.scale;e.beginPath();e.arc(a,j,b,0,box2d.b2_pi*2,true);e.moveTo(a,j);e.lineTo((a+g.x*this.scale*b),(j+g.y*this.scale*b));e.fillStyle=f.MakeStyleString(0.5);e.fill();e.strokeStyle=f.MakeStyleString(1);e.stroke()};box2d.b2DebugDraw.prototype.DrawSegment=function(e,d,b){var a=this.m_ctx;a.beginPath();a.moveTo(e.x*this.scale,e.y*this.scale);a.lineTo(d.x*this.scale,d.y*this.scale);a.strokeStyle=b.MakeStyleString(1);a.stroke()};box2d.b2DebugDraw.prototype.DrawTransform=function(b){var a=this.m_ctx;this.PushTransform(b);a.beginPath();a.moveTo(0,0);a.lineTo(10,0);a.strokeStyle=box2d.b2Color.RED.MakeStyleString(1);a.stroke();a.beginPath();a.moveTo(0,0);a.lineTo(0,10);a.strokeStyle=box2d.b2Color.GREEN.MakeStyleString(1);a.stroke();this.PopTransform(b)};box2d.b2DebugDraw.prototype.DrawPoint=function(f,e,d){var b=this.m_ctx;b.fillStyle=d.MakeStyleString();e/=this.m_settings.viewZoom;e/=this.m_settings.canvasScale;var a=e/2;b.fillRect(f.x*this.scale-a,f.y*this.scale-a,e,e)};box2d.b2DebugDraw.prototype.DrawString=function(a,k,g,j){var b=this.m_ctx;var f=Array.prototype.slice.call(arguments);var e=goog.string.format.apply(null,f.slice(2));b.save();b.setTransform(1,0,0,1,0,0);b.font="18pt helvetica";var d=box2d.b2DebugDraw.prototype.DrawString.s_color;b.fillStyle=d.MakeStyleString();b.fillText(e,a*this.scale,k*this.scale);b.restore()};box2d.b2DebugDraw.prototype.DrawString.s_color=new box2d.b2Color(0.9,0.6,0.6);box2d.b2DebugDraw.prototype.DrawStringWorld=function(k,j,n,m){var a=box2d.b2DebugDraw.prototype.DrawStringWorld.s_p.SetXY(k,j);var q=this.m_settings.viewCenter;box2d.b2SubVV(a,q,a);var u=this.m_settings.viewRotation;box2d.b2MulTRV(u,a,a);var s=this.m_settings.viewZoom;box2d.b2MulSV(s,a,a);var f=this.m_settings.canvasScale;box2d.b2MulSV(f,a,a);a.y*=-1;var b=box2d.b2DebugDraw.prototype.DrawStringWorld.s_cc.SetXY(0.5*this.m_canvas.width,0.5*this.m_canvas.height);box2d.b2AddVV(a,b,a);var r=this.m_ctx;var g=Array.prototype.slice.call(arguments);var e=goog.string.format.apply(null,g.slice(2));r.save();r.setTransform(1,0,0,1,0,0);r.font="18pt helvetica";var d=box2d.b2DebugDraw.prototype.DrawStringWorld.s_color;r.fillStyle=d.MakeStyleString();r.fillText(e,a.x*this.scale,a.y*this.scale);r.restore()};box2d.b2DebugDraw.prototype.DrawStringWorld.s_p=new box2d.b2Vec2();box2d.b2DebugDraw.prototype.DrawStringWorld.s_cc=new box2d.b2Vec2();box2d.b2DebugDraw.prototype.DrawStringWorld.s_color=new box2d.b2Color(0.5,0.9,0.5);box2d.b2DebugDraw.prototype.DrawAABB=function(e,f){var d=this.m_ctx;d.strokeStyle=f.MakeStyleString();var a=e.lowerBound.x;var j=e.lowerBound.y;var b=e.upperBound.x-e.lowerBound.x;var g=e.upperBound.y-e.lowerBound.y;d.strokeRect(a*this.scale,j*this.scale,b*this.scale,g*this.scale)};box2d.b2DebugDraw.prototype.SetFlags=function(a){this.m_settings=a};box2d.b2DebugDraw.prototype.GetFlags=function(){return this.m_settings};var b2AABB=box2d.b2AABB,b2Body=box2d.b2Body,b2BodyDef=box2d.b2BodyDef,b2ChainShape=box2d.b2ChainShape,b2CircleShape=box2d.b2CircleShape,b2ContactListener=box2d.b2ContactListener,b2DebugDraw=box2d.b2DebugDraw,b2EdgeChainDef=box2d.b2EdgeChainDef,b2EdgeShape=box2d.b2EdgeShape,b2Fixture=box2d.b2Fixture,b2FixtureDef=box2d.b2FixtureDef,b2Joint=box2d.b2Joint,b2MassData=box2d.b2MassData,b2Mat22=box2d.b2Mat22,b2MouseJointDef=box2d.b2MouseJointDef,b2PolygonShape=box2d.b2PolygonShape,b2PrismaticJointDef=box2d.b2PrismaticJointDef,b2RevoluteJointDef=box2d.b2RevoluteJointDef,b2Settings=box2d.b2Settings,b2Shape=box2d.b2Shape,b2World=box2d.b2World,b2WorldManifold=box2d.b2WorldManifold,b2Vec2=box2d.b2Vec2;CG.Entity.extend("B2DEntity",{init:function(a){this._super();this.instanceOf="B2DEntity";CG._extend(this,{world:{},scale:{},body:{},bodyType:box2d.b2BodyType.b2_dynamicBody,bullet:false,alpha:1,x:0,y:0,scale:40,id:{name:"",uid:0},world:{},isHit:false,strength:100,dead:false,angle:0,density:1,restitution:0.1,friction:1,allowSleep:true,awake:true,fixedRotation:false,bodyDef:new b2BodyDef,fixDef:new b2FixtureDef});if(a){CG._extend(this,a);this.id.name=a.name}this.bodyDef.allowSleep=this.allowSleep;this.bodyDef.awake=this.awake;this.bodyDef.bullet=this.bullet;this.bodyDef.angle=this.angle;this.bodyDef.fixedRotation=this.fixedRotation;this.fixDef.density=this.density;this.fixDef.friction=this.friction;this.fixDef.restitution=this.restitution;return this},hit:function(b,a){this.isHit=true;if(this.strength){this.strength-=b;if(this.strength<=0){this.dead=true}}},update:function(){},draw:function(){Game.renderer.draw(this)},addVelocity:function(b){var a=this.body.GetLinearVelocity();a.SelfAdd(b);if(Math.abs(a.y)>this.max_ver_vel){a.y=this.max_ver_vel*a.y/Math.abs(a.y)}if(Math.abs(a.x)>this.max_hor_vel){a.x=this.max_hor_vel*a.x/Math.abs(a.x)}this.body.SetLinearVelocity(a)},applyImpulse:function(b,a){if(this.body){this.body.ApplyLinearImpulse(new b2Vec2(Math.cos(b*CG.Const_PI_180)*a,Math.sin(b*CG.Const_PI_180)*a),this.body.GetWorldCenter())}},setType:function(a){this.body.SetType(a)},setPosition:function(a){this.body.SetPosition(a)},getPosition:function(){return this.body.GetPosition()}});CG.B2DEntity.extend("B2DCircle",{init:function(a){CG._extend(this,{radius:0});this._super(a);this.instanceOf="B2DCircle";this.setImage(this.image);this.bodyDef.type=this.bodyType;this.bodyDef.position.x=this.x/this.scale;this.bodyDef.position.y=this.y/this.scale;this.bodyDef.userData=this.id;this.fixDef.shape=new b2CircleShape(this.radius/this.scale);this.body=this.world.CreateBody(this.bodyDef);this.body.CreateFixture(this.fixDef);return this}});CG.B2DEntity.extend("B2DLine",{init:function(a){CG._extend(this,{body:{},startPoint:new b2Vec2(0,0),endPoint:new b2Vec2(0,0)});this._super(a);this.instanceOf="B2DLine";this.convertPoints();this.fixDef.shape=new b2EdgeShape();this.fixDef.shape.Set(this.startPoint,this.endPoint);this.bodyDef.type=box2d.b2BodyType.b2_staticBody;this.bodyDef.position.SetXY(0/this.scale,0/this.scale);this.bodyDef.userData=this.id;this.body=this.world.CreateBody(this.bodyDef);this.body.CreateFixture(this.fixDef);return this},convertPoints:function(){this.startPoint.x=this.startPoint.x/this.scale;this.startPoint.y=this.startPoint.y/this.scale;this.endPoint.x=this.endPoint.x/this.scale;this.endPoint.y=this.endPoint.y/this.scale},update:function(){},draw:function(){}});CG.B2DEntity.extend("B2DRectangle",{init:function(a){this._super(a);this.instanceOf="B2DRectangle";this.setImage(this.image);this.fixDef.shape=new b2PolygonShape;this.fixDef.shape.SetAsBox(this.width/this.scale*0.5,this.height/this.scale*0.5);this.bodyDef.type=this.bodyType;this.bodyDef.position.x=this.x/this.scale;this.bodyDef.position.y=this.y/this.scale;this.bodyDef.userData=this.id;this.body=this.world.CreateBody(this.bodyDef);this.body.CreateFixture(this.fixDef);return this}});CG.B2DEntity.extend("B2DPolygon",{init:function(b){CG._extend(this,{polys:new Array(),bullet:false});this._super(b);this.instanceOf="B2DPolygon";this.setImage(this.image);this.jsondata=this.texturepacker.data[this.name];this.vecs=new Array();this.vecs=this.getPolysFromJson(this.texturepacker);this.bodyDef.type=this.bodyType;this.bodyDef.position.SetXY(this.x/this.scale,this.y/this.scale);this.bodyDef.userData=this.id;this.bodyDef.bullet=this.bullet;this.body=this.world.CreateBody(this.bodyDef);for(var d=0,a=this.vecs.length;d<a;d++){this.bodyShapePoly=new b2PolygonShape;this.bodyShapePoly.bounce=this.jsondata[d].bounce;this.makeVecsCentroid(this.vecs[d]);this.bodyShapePoly.SetAsArray(this.vecs[d],this.vecs[d].length);this.fixDef.density=this.jsondata[d].density;this.fixDef.friction=this.jsondata[d].friction;this.fixDef.shape=this.bodyShapePoly;this.body.CreateFixture(this.fixDef)}return this},getPolysFromJson:function(){var j=[];for(var f=0,b=this.jsondata.length;f<b;f++){var k=this.jsondata[f].shape;var d=[];for(var g=0,a=k.length;g<a;g=g+2){var e=new b2Vec2(k[g]/this.scale,k[g+1]/this.scale);d.push(e)}j.push(d)}return j},getPolysFromBitmapTrace:function(b){var a=[];return a},makeVecsCentroid:function(d){var f=this.xhandle/this.scale,a=this.yhandle/this.scale;for(var e=0,b=d.length;e<b;e++){d[e].x=d[e].x-f;d[e].y=d[e].y-a}}});CG.B2DEntity.extend("B2DTerrain",{init:function(a){CG._extend(this,{bitmap:new CG.Bitmap({width:Game.width,height:Game.height}),image:false,polys:new Array(),terrainShape:[],terrainTriangles:[],holes:[]});this._super(a);this.instanceOf="B2DTerrain";if(typeof this.image!==undefined){this.bitmap.loadImage(this.image)}this.bodyDef.type=box2d.b2BodyType.b2_staticBody;this.bodyDef.position.SetXY(this.x/this.scale,this.y/this.scale);this.bodyDef.userData=this.id;this.createTerrain();return this},createTerrain:function(){this.body=this.world.CreateBody(this.bodyDef);try{for(var d=0,a=this.terrainShape.length;d<a;d++){var j=this.terrainShape[d].outer;if(typeof j==="undefined"){continue}var g=new poly2tri.SweepContext(j,{cloneArrays:true});if(this.terrainShape[d].holes.length>0){for(var f=0,b=this.terrainShape[d].holes.length;f<b;f++){g.addHole(this.terrainShape[d].holes[f])}}g.triangulate();this.terrainTriangles=this.terrainTriangles.concat(g.getTriangles()||[])}for(var f=0,b=this.terrainTriangles.length;f<b;f++){this.bodyShapePoly=new b2PolygonShape;this.bodyShapePoly.bounce=0.5;this.bodyShapePoly.SetAsArray(this.getPolysFromTriangulation(this.terrainTriangles[f].points_),this.terrainTriangles[f].points_.length);this.fixDef.density=this.density;this.fixDef.restitution=this.restitution;this.fixDef.friction=this.friction;this.fixDef.shape=this.bodyShapePoly;this.body.CreateFixture(this.fixDef)}}catch(k){}},deleteTerrain:function(){this.terrainTriangles=[];this.world.DestroyBody(this.body)},clipTerrain:function(d){var f=this.createCircle(d);for(var e=0,m=this.terrainShape.length;e<m;e++){this.terrainShape[e].holes.push(f)}var u=[];var b=[];var s=[];for(var e=0,m=this.terrainShape.length;e<m;e++){b=[this.terrainShape[e].outer];s=[];if(this.terrainShape[e].holes.length>0){for(var j=0,g=this.terrainShape[e].holes.length;j<g;j++){s.push(this.terrainShape[e].holes[j])}}var n=new ClipperLib.Clipper();n.PreserveCollinear=true;n.StrictlySimple=true;var r=new ClipperLib.PolyTree();n.AddPaths(b,ClipperLib.PolyType.ptSubject,true);n.AddPaths(s,ClipperLib.PolyType.ptClip,true);n.Execute(ClipperLib.ClipType.ctDifference,r,ClipperLib.PolyFillType.pftNonZero,ClipperLib.PolyFillType.pftNonZero);var q=ClipperLib.JS.PolyTreeToExPolygons(r);if(q.length>0){for(var a=0,k=q.length;a<k;a++){u.push(q[a])}}}this.terrainShape=u;this.lightenTerrain();this.deleteTerrain();this.createTerrain();this.bitmap.clearCircle(d.x,d.y,d.radius)},lightenTerrain:function(){var e=0.02;for(var f=0,a=this.terrainShape.length;f<a;f++){var d=ClipperLib.JS.Lighten(this.terrainShape[f].outer,e*this.scale);this.terrainShape[f].outer=d[0];if(this.terrainShape[f].holes.length>0){for(var g=0,b=this.terrainShape[f].holes.length;g<b;g++){var d=ClipperLib.JS.Lighten(this.terrainShape[f].holes[g],e*this.scale);this.terrainShape[f].holes[g]=d[0]}}}},cleanTerrain:function(){var e=0.1;for(var f=0,a=this.terrainShape.length;f<a;f++){var d=ClipperLib.JS.Clean(this.terrainShape[f].outer,e*this.scale);this.terrainShape[f].outer=d[0];if(this.terrainShape[f].holes.length>0){for(var g=0,b=this.terrainShape[f].holes.length;g<b;g++){var d=ClipperLib.JS.Clean(this.terrainShape[f].holes[g],e*this.scale);this.terrainShape[f].holes[g]=d[0]}}}},getPolysFromTriangulation:function(f){var d=[];for(var b=0,a=f.length;b<a;b++){var e=f[b];d.push(new b2Vec2(e.x/this.scale,e.y/this.scale))}return d},createCircle:function(d){var e=2*Math.PI/d.points;var b=[];for(var a=0;a<d.points;a++){b.push({x:d.x+d.radius*Math.cos(e*a),y:d.y+d.radius*Math.sin(e*a)})}return b.reverse()},draw:function(){Game.renderer.draw(this.bitmap)},polys2SvgImage:function(d,f){var e="",b,a;if(!f){f=1}for(b=0;b<d.length;b++){for(a=0;a<d[b].length;a++){if(!a){e+="M"}else{e+="L"}e+=(d[b][a].X/f)+", "+(d[b][a].Y/f)}e+="Z"}return e}});CG.B2DEntity.extend("B2DChainShape",{init:function(a){this._super(a);this.instanceOf="B2DChainShape";CG._extend(this,{vertices:[],bodyType:box2d.b2BodyType.b2_staticBody});this.vertices=this.convertRealWorldPointToBox2DVec2(this.points);this.bodyDef.type=this.bodyType;this.bodyDef.position.SetXY(this.x/this.scale,this.y/this.scale);this.bodyDef.userData=this.id;this.fixDef.shape=new b2ChainShape();this.fixDef.shape.CreateChain(this.vertices,this.vertices.length);this.body=this.world.CreateBody(this.bodyDef);this.body.CreateFixture(this.fixDef);return this},convertRealWorldPointToBox2DVec2:function(b){var f=[];for(var e=0,a=b.length;e<a;e++){var d=new b2Vec2(b[e].x/this.scale,b[e].y/this.scale);f.push(d)}return f},update:function(){},draw:function(){}});CG.B2DEntity.extend("B2DRope",{init:function(b){CG._extend(this,{length:0,segments:0,segmentHeight:0,segmentWidth:0,anchor:new b2Vec2(),prevBody:{},bodyGroup:[],bodyCount:0,lowerAngle:-25,upperAngle:25,enableLimit:true});this._super(b);this.instanceOf="B2DRope";this.setImage(this.image);this.segmentHeight=((this.length-this.y)/this.segments)/2;this.fixtureDef=new b2FixtureDef();this.bodyShapeCircle=new b2CircleShape();this.bodyDef=new b2BodyDef();this.bodyDef.userData=this.id;this.bodyShapeCircle.m_radius=this.segmentWidth/this.scale;this.fixtureDef.density=this.density;this.fixtureDef.restitution=this.restitution;this.fixtureDef.friction=this.friction;this.fixtureDef.shape=this.bodyShapeCircle;this.bodyDef.position.SetXY(this.x/this.scale,this.y/this.scale);this.body=this.bodyGroup[0]=this.world.CreateBody(this.bodyDef);this.bodyGroup[0].CreateFixture(this.fixtureDef);this.prevBody=this.bodyGroup[0];this.fixtureDef=new b2FixtureDef();this.bodyShapePoly=new b2PolygonShape();this.bodyDef=new b2BodyDef();this.bodyDef.userData=this.id;this.bodyShapePoly.SetAsBox(this.segmentWidth/this.scale,this.segmentHeight/this.scale);this.bodyDef.type=box2d.b2BodyType.b2_dynamicBody;this.fixtureDef.shape=this.bodyShapePoly;this.fixtureDef.density=this.density;this.fixtureDef.restitution=this.restitution;this.fixtureDef.friction=this.friction;this.jointDef=new b2RevoluteJointDef();this.jointDef.lowerAngle=this.lowerAngle/CG.Const_180_PI;this.jointDef.upperAngle=this.upperAngle/CG.Const_180_PI;this.jointDef.enableLimit=this.enableLimit;for(var d=0,a=this.segments;d<a;d++){this.bodyDef.position.SetXY(this.x/this.scale,((this.y+this.segmentHeight)+(this.segmentHeight*2)*d)/this.scale);this.bodyGroup[d+1]=this.world.CreateBody(this.bodyDef);this.bodyGroup[d+1].CreateFixture(this.fixtureDef);this.anchor.SetXY(this.x/this.scale,(this.y+(this.segmentHeight*2)*d)/this.scale);this.jointDef.Initialize(this.prevBody,this.bodyGroup[d+1],this.anchor);this.world.CreateJoint(this.jointDef);this.prevBody=this.bodyGroup[d+1];this.bodyCount=d+1}return this},draw:function(){for(var a=1;a<=this.bodyCount;a++){this.body=this.bodyGroup[a];Game.renderer.draw(this)}}});CG.B2DEntity.extend("B2DBridge",{init:function(b){CG._extend(this,{x:0,y:0,length:0,segments:0,segmentWidth:0,segmentHeight:0,anchor:new b2Vec2(),prevBody:{},bodyGroup:[],bodyCount:0,lowerAngle:-25,upperAngle:25,enableLimit:true});this._super(b);this.instanceOf="B2DBridge";this.setImage(this.image);this.segmentWidth=((this.length-this.x)/this.segments)/2;this.fixtureDef=new b2FixtureDef();this.bodyShapeCircle=new b2CircleShape();this.bodyDef=new b2BodyDef();this.bodyDef.userData=this.id;this.bodyShapeCircle.m_radius=this.segmentHeight/this.scale;this.fixtureDef.density=this.density;this.fixtureDef.restitution=this.restitution;this.fixtureDef.friction=this.friction;this.fixtureDef.shape=this.bodyShapeCircle;this.bodyDef.position.SetXY(this.x/this.scale,this.y/this.scale);this.body=this.bodyGroup[0]=this.world.CreateBody(this.bodyDef);this.bodyGroup[0].CreateFixture(this.fixtureDef);this.prevBody=this.bodyGroup[0];this.bodyDef.position.SetXY(this.length/this.scale,this.y/this.scale);this.bodyDef.userData=this.id;this.bodyGroup[1]=this.world.CreateBody(this.bodyDef);this.bodyGroup[1].CreateFixture(this.fixtureDef);this.fixtureDef=new b2FixtureDef();this.bodyShapePoly=new b2PolygonShape();this.bodyDef=new b2BodyDef();this.bodyDef.userData=this.id;this.bodyShapePoly.SetAsBox(this.segmentWidth/this.scale,this.segmentHeight/this.scale);this.bodyDef.type=box2d.b2BodyType.b2_dynamicBody;this.fixtureDef.shape=this.bodyShapePoly;this.fixtureDef.density=this.density;this.fixtureDef.restitution=this.restitution;this.fixtureDef.friction=this.friction;this.jointDef=new b2RevoluteJointDef();this.jointDef.lowerAngle=this.lowerAngle/CG.Const_180_PI;this.jointDef.upperAngle=this.upperAngle/CG.Const_180_PI;this.jointDef.enableLimit=this.enableLimit;for(var d=0,a=this.segments;d<a;d++){this.bodyDef.position.SetXY(((this.x+this.segmentWidth)+(this.segmentWidth*2)*d)/this.scale,this.y/this.scale);this.bodyGroup[d+2]=this.world.CreateBody(this.bodyDef);this.bodyGroup[d+2].CreateFixture(this.fixtureDef);this.anchor.SetXY((this.x+(this.segmentWidth*2)*d)/this.scale,this.y/this.scale);this.jointDef.Initialize(this.prevBody,this.bodyGroup[d+2],this.anchor);this.world.CreateJoint(this.jointDef);this.prevBody=this.bodyGroup[d+2];this.bodyCount=d+2}this.anchor.SetXY((this.x+(this.segmentWidth*2)*this.segments-1)/this.scale,this.y/this.scale);this.jointDef.Initialize(this.prevBody,this.bodyGroup[1],this.anchor);this.world.CreateJoint(this.jointDef);return this},draw:function(){for(var a=2;a<=this.bodyCount;a++){this.body=this.bodyGroup[a];Game.renderer.draw(this)}}});CG.Layer.extend("B2DWorld",{init:function(a){CG._extend(this,{framerate:1/30,name:"",debug:false,x:0,y:0,elements:[],uid:0,scale:40,sleep:true});if(a){CG._extend(this,a)}this.world=new b2World(new b2Vec2(0,10),this.sleep);this.world.m_groundBody=this.world.CreateBody(new b2BodyDef());var b=new b2DebugDraw({scale:this.scale,canvas:Game.b_canvas,ctx:Game.b_ctx,flags:box2d.b2DrawFlags.e_shapeBit|box2d.b2DrawFlags.e_jointBit|box2d.b2DrawFlags.e_centerOfMassBit});this.world.SetDebugDraw(b)},update:function(){this.world.Step(this.framerate,10,10);if(CG.mousedown){this.mouseDownAt(mousex,mousey)}else{if(this.isMouseDown()){this.mouseUp()}}for(var b=0,a=this.elements.length;b<a;b++){this.elements[b].update()}},draw:function(){Game.b_ctx.save();Game.b_ctx.translate(this.x,this.y);for(var b=0,a=this.elements.length;b<a;b++){this.elements[b].draw()}if(this.debug){this.world.DrawDebugData();this.world.ClearForces()}Game.b_ctx.restore()},addCustom:function(a){this.uid=this.uid+1;a.id.uid=this.uid;this.elements.push(a);return a},checkIfBodyExists:function(a){if(a){for(var d=0,b=this.elements.length;d<b;d++){if(this.elements[d].body.m_userData.uid==a.m_userData.uid){return true}}}return false},createBox:function(b){b.world=this.world;b.scale=this.scale;this.uid=this.uid+1;var a=new CG.B2DRectangle(b);a.id.uid=this.uid;this.elements.push(a);return a},createLine:function(b){b.world=this.world;b.scale=this.scale;this.uid=this.uid+1;var a=new CG.B2DLine(b);a.id.uid=this.uid;this.elements.push(a);return a},createCircle:function(b){b.world=this.world;b.scale=this.scale;this.uid=this.uid+1;var a=new CG.B2DCircle(b);a.id.uid=this.uid;this.elements.push(a);return a},createPolyBody:function(b){b.world=this.world;b.scale=this.scale;this.uid=this.uid+1;var a=new CG.B2DPolygon(b);a.id.uid=this.uid;this.elements.push(a);return a},createTerrain:function(b){b.world=this.world;b.scale=this.scale;this.uid=this.uid+1;var a=new CG.B2DTerrain(b);a.id.uid=this.uid;this.elements.push(a);return a},createChainShape:function(b){b.world=this.world;b.scale=this.scale;this.uid=this.uid+1;var a=new CG.B2DChainShape(b);a.id.uid=this.uid;this.elements.push(a);return a},createBridge:function(b){b.world=this.world;b.scale=this.scale;this.uid=this.uid+1;var a=new CG.B2DBridge(b);a.id.uid=this.uid;this.elements.push(a);return a},createRope:function(b){b.world=this.world;b.scale=this.scale;this.uid=this.uid+1;var a=new CG.B2DRope(b);a.id.uid=this.uid;this.elements.push(a);return a},mouseDownAt:function(b,e){if(!this.mouseJoint){var a=this.getBodyAt(b,e);if(a){var d=new b2MouseJointDef();d.bodyA=this.world.m_groundBody;d.bodyB=a;d.target.SetXY((b-this.x)/this.scale,(e-this.y)/this.scale);d.collideConnected=true;d.maxForce=300*a.GetMass();this.mouseJoint=this.world.CreateJoint(d);a.SetAwake(true)}}else{this.mouseJoint.SetTarget(new b2Vec2((b-this.x)/this.scale,(e-this.y)/this.scale))}},mouseUp:function(){this.world.DestroyJoint(this.mouseJoint);this.mouseJoint=null},getBodyAt:function(a,j){var g=(a-this.x)/this.scale;var f=(j-this.y)/this.scale;var e=new b2Vec2(g,f);var d=new b2AABB();d.lowerBound.SetXY(g-0.001,f-0.001);d.upperBound.SetXY(g+0.001,f+0.001);var b=null;this.world.QueryAABB(function(k){if(k.GetBody().GetType()!=b2Body.b2_staticBody){if(k.GetShape().TestPoint(k.GetBody().GetTransform(),e)){b=k.GetBody();return false}}return true},d);return b},deleteBodyAt:function(a,e){body=this.getBodyAt(a,e);if(body){for(var d=0,b=this.elements.length;d<b;d++){if(this.elements[d].body.m_userData.uid==body.m_userData.uid){this.removeElementByIndex(d);this.world.DestroyBody(body);return true}}}return false},isMouseDown:function(){return(this.mouseJoint!=null)},removeElementByIndex:function(a){this.elements.splice(a,1)},removeElementByUid:function(d){for(var b=0,a=this.elements.length;b<a;b++){if(typeof this.elements[b]==="object"&&typeof this.elements[b].id!=="undefined"){if(this.elements[b].id.uid===d){this.elements.splice(b,1)}}}},applyImpulse:function(a,d,b){if(a){a.ApplyLinearImpulse(new b2Vec2(Math.cos(d*CG.Const_PI_180)*b,Math.sin(d*CG.Const_PI_180)*b),a.GetWorldCenter())}},addContactListener:function(a){var b=new box2d.b2ContactListener;if(a.BeginContact){b.BeginContact=function(d){a.BeginContact(d.GetFixtureA().GetBody(),d.GetFixtureB().GetBody())}}if(a.EndContact){b.EndContact=function(d){a.EndContact(d.GetFixtureA().GetBody(),d.GetFixtureB().GetBody())}}if(a.PostSolve){b.PostSolve=function(d,e){a.PostSolve(d.GetFixtureA().GetBody(),d.GetFixtureB().GetBody(),e.normalImpulses[0])}}if(a.PreSolve){b.PreSolve=function(d,e){a.PreSolve(d,e)}}this.world.SetContactListener(b)},getBodySpec:function(a){return{x:a.GetPosition().x,y:a.GetPosition().y,a:a.GetAngle(),c:{x:a.GetWorldCenter().x,y:a.GetWorldCenter().y}}}});CG.Class.extend("B2DFizzXLoader",{init:function(d,e,b,a){this.json=JSON.parse(d,function(f,g){if(typeof g==="string"){if(g.match(/^[-+]?\d+$/)){return parseInt(g)}else{if(g.match(/^[-+]?\d+\.\d+$/)){return parseFloat(g)}else{switch(g){case"true":return true;break;case"false":return false;break;case"null":return null;break}}}}return g});this.world=e;this.offsetx=b;this.offsety=a;this.bodiesMap=[];this.jointsMap=[];this.imageMap=[];this.atlasMap=[];this.loadImages();this.loadBodies();this.loadJoints()},loadBodies:function(){console.log("### start bodies");for(var d=0,k=this.json.box2d.bodies.body.length;d<k;d++){var a=this.json.box2d.bodies.body[d];console.log("body:",a.name,"image:",a.image,a);var e=a.fixtures.fixture;console.log("-- fixtures",e.length);for(var j=0,g=e.length;j<g;j++){console.log("--- fixture #"+(j+1),e[j])}}},loadImages:function(){console.log("### start images");for(var b=0,a=this.json.box2d.images.image.length;b<a;b++){var d=this.json.box2d.images.image[b];console.log("-- image #"+(b+1),d)}},loadJoints:function(){console.log("### start joints");for(var a=0,d=this.json.box2d.joints.joint.length;a<d;a++){var b=this.json.box2d.joints.joint[a];console.log("-- joint #"+(a+1),b)}}});