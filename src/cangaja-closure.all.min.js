var CG=CG||{VERSION:1,canvas:{},ctx:{},Const_PI_180:Math.PI/180,Const_180_PI:180/Math.PI,LEFT:1,RIGHT:2,UP:3,DOWN:4,LEFT_HAND:1,RIGHT_HAND:2,mousedown:!1,mouse:{x:0,y:0},start:{x:0,y:0},end:{x:0,y:0}};CG._extend=function(a,b){if(!b)return a;for(var d in b)a[d]=b[d];return a};CG._clone=function(a){return Q._extend({},a)};
(function(){for(var a=0,b=["ms","moz","webkit","o"],d=0;d<b.length&&!window.requestAnimationFrame;++d)window.requestAnimationFrame=window[b[d]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[b[d]+"CancelAnimationFrame"]||window[b[d]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(b,d){var g=(new Date).getTime(),k=Math.max(0,16-(g-a)),m=window.setTimeout(function(){b(g+k)},k);a=g+k;return m});window.cancelAnimationFrame||(window.cancelAnimationFrame=
function(a){clearTimeout(a)})})();
(function(){var a=!1,b=/xyz/.test(function(){})?/\b_super\b/:/.*/;CG.Class=function(){};CG.Class.prototype.isA=function(a){return this.className===a};CG.Class.extend=function(d,e,f){function g(a,b){return function(){var d=this._super;this._super=m[a];var e=b.apply(this,arguments);this._super=d;return e}}function k(){!a&&this.init&&this.init.apply(this,arguments)}"string"===!typeof d&&(f=e,e=d,d=null);var m=this.prototype;a=!0;var n=new this;a=!1;for(var q in e)n[q]="function"===typeof e[q]&&"function"===
typeof m[q]&&b.test(e[q])?g(q,e[q]):e[q];k.prototype=n;k.prototype.constructor=k;k.extend=CG.Class.extend;f&&CG._extend(k,f);d&&(CG[d]=k,k.prototype.className=d,k.className=d);return k}})();
CG.Class.extend("Game",{init:function(a,b){switch(typeof a){case "object":this.canvas=a;break;case "string":this.canvas=document.getElementById(a);break;default:throw"no canvas element defined";}b&&CG._extend(this,b);this.ctx=this.canvas.getContext("2d");this.fps=60;this.width=this.canvas.width;this.height=this.canvas.height;this.width2=this.width/2;this.height2=this.height/2;this.b_canvas=document.createElement("canvas");this.b_canvas.width=this.width;this.b_canvas.height=this.height;this.b_ctx=
this.b_canvas.getContext("2d");this.asset=new CG.MediaAsset(this);this.director=new CG.Director;this.renderer=new CG.CanvasRenderer;this.delta=new CG.Delta(this.fps);this.bound=new CG.Bound({x:0,y:0,width:this.width,height:this.height});this.preload()},preload:function(){},create:function(){this.loop()},loop:function(){requestAnimationFrame(this.loop.bind(this));this.beforeUpdate();this.update();this.beforeDraw();this.draw();this.afterDraw()},beforeUpdate:function(){this.director.update()},update:function(){},
beforeDraw:function(){this.director.draw()},draw:function(){},afterDraw:function(){this.ctx.clearRect(0,0,this.bound.width,this.bound.height);this.ctx.drawImage(this.b_canvas,0,0);this.b_ctx.clearRect(0,0,this.bound.width,this.bound.height)}});function Transform(){this.reset()}Transform.prototype.reset=function(){this.m=[1,0,0,1,0,0]};
Transform.prototype.multiply=function(a){var b=this.m[1]*a.m[0]+this.m[3]*a.m[1],d=this.m[0]*a.m[2]+this.m[2]*a.m[3],e=this.m[1]*a.m[2]+this.m[3]*a.m[3],f=this.m[0]*a.m[4]+this.m[2]*a.m[5]+this.m[4],g=this.m[1]*a.m[4]+this.m[3]*a.m[5]+this.m[5];this.m[0]=this.m[0]*a.m[0]+this.m[2]*a.m[1];this.m[1]=b;this.m[2]=d;this.m[3]=e;this.m[4]=f;this.m[5]=g};
Transform.prototype.invert=function(){var a=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),b=-this.m[1]*a,d=-this.m[2]*a,e=this.m[0]*a,f=a*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),g=a*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);this.m[0]=this.m[3]*a;this.m[1]=b;this.m[2]=d;this.m[3]=e;this.m[4]=f;this.m[5]=g};
Transform.prototype.rotate=function(a){var b=Math.cos(a);a=Math.sin(a);var d=this.m[1]*b+this.m[3]*a,e=this.m[0]*-a+this.m[2]*b,f=this.m[1]*-a+this.m[3]*b;this.m[0]=this.m[0]*b+this.m[2]*a;this.m[1]=d;this.m[2]=e;this.m[3]=f};Transform.prototype.translate=function(a,b){this.m[4]+=this.m[0]*a+this.m[2]*b;this.m[5]+=this.m[1]*a+this.m[3]*b};Transform.prototype.scale=function(a,b){this.m[0]*=a;this.m[1]*=a;this.m[2]*=b;this.m[3]*=b};
Transform.prototype.transformPoint=function(a,b){var d=a,e=b;a=d*this.m[0]+e*this.m[2]+this.m[4];b=d*this.m[1]+e*this.m[3]+this.m[5];return[a,b]};
(function(a){function b(a,b){for(var d=a.length;d--;)if(a[d]===b)return d;return-1}function d(a){var d,g,k,m,t,v;d=a.keyCode;-1==b(y,d)&&y.push(d);if(93==d||224==d)d=91;if(d in s)for(k in s[d]=!0,u)u[k]==d&&(e[k]=!0);else{for(n in s)s[n]=a[z[n]];if(e.filter.call(this,a)&&d in q)for(v=f(),m=0;m<q[d].length;m++)if(g=q[d][m],g.scope==v||"all"==g.scope){t=0<g.mods.length;for(k in s)if(!s[k]&&-1<b(g.mods,+k)||s[k]&&-1==b(g.mods,+k))t=!1;(0!=g.mods.length||s[16]||s[18]||s[17]||s[91])&&!t||!1!==g.method(a,
g)||(a.preventDefault?a.preventDefault():a.returnValue=!1,a.stopPropagation&&a.stopPropagation(),a.cancelBubble&&(a.cancelBubble=!0))}}}function e(a,b,d){var e,f;e=g(a);void 0===d&&(d=b,b="all");for(var m=0;m<e.length;m++)f=[],a=e[m].split("+"),1<a.length&&(f=k(a),a=[a[a.length-1]]),a=a[0],a=v[a]||a.toUpperCase().charCodeAt(0),a in q||(q[a]=[]),q[a].push({shortcut:e[m],scope:b,method:d,key:e[m],mods:f})}function f(){return t||"all"}function g(a){a=a.replace(/\s/g,"");a=a.split(",");""==a[a.length-
1]&&(a[a.length-2]+=",");return a}function k(a){a=a.slice(0,a.length-1);for(var b=0;b<a.length;b++)a[b]=u[a[b]];return a}function m(a,b,d){a.addEventListener?a.addEventListener(b,d,!1):a.attachEvent&&a.attachEvent("on"+b,function(){d(window.event)})}var n,q={},s={16:!1,18:!1,17:!1,91:!1},t="all",u={"\u21e7":16,shift:16,"\u2325":18,alt:18,option:18,"\u2303":17,ctrl:17,control:17,"\u2318":91,command:91},v={backspace:8,tab:9,clear:12,enter:13,"return":13,esc:27,escape:27,space:32,left:37,up:38,right:39,
down:40,del:46,"delete":46,home:36,end:35,pageup:33,pagedown:34,",":188,".":190,"/":191,"`":192,"-":189,"=":187,";":186,"'":222,"[":219,"]":221,"\\":220},y=[];for(n=1;20>n;n++)v["f"+n]=111+n;var z={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey"};for(n in u)e[n]=!1;m(document,"keydown",function(a){d(a)});m(document,"keyup",function(a){a=a.keyCode;var d,f=b(y,a);0<=f&&y.splice(f,1);if(93==a||224==a)a=91;if(a in s)for(d in s[a]=!1,u)u[d]==a&&(e[d]=!1)});m(window,"focus",function(){for(n in s)s[n]=
!1;for(n in u)e[n]=!1});var A=a.key;a.key=e;a.key.setScope=function(a){t=a||"all"};a.key.getScope=f;a.key.deleteScope=function(a){var b,d,e;for(b in q)for(d=q[b],e=0;e<d.length;)d[e].scope===a?d.splice(e,1):e++};a.key.filter=function(a){a=(a.target||a.srcElement).tagName;return!("INPUT"==a||"SELECT"==a||"TEXTAREA"==a)};a.key.isPressed=function(a){"string"==typeof a&&(a=v[a]||a.toUpperCase().charCodeAt(0));return-1!=b(y,a)};a.key.getPressedKeyCodes=function(){return y.slice(0)};a.key.noConflict=function(){var b=
a.key;a.key=A;return b};a.key.unbind=function(a,b){var d,e,m=[],n,s;d=g(a);for(s=0;s<d.length;s++){e=d[s].split("+");1<e.length&&(m=k(e),a=e[e.length-1]);a=v[a]||a.toUpperCase().charCodeAt(0);void 0===b&&(b=f());if(!q[a])break;for(n in q[a]){e=q[a][n];var t;if(t=e.scope===b)a:if(e=e.mods,e.length!=m.length)t=!1;else{for(t=0;t<e.length;t++)if(e[t]!==m[t]){t=!1;break a}t=!0}t&&(q[a][n]={})}}};"undefined"!==typeof module&&(module.exports=key)})(this);
!function(a){if("object"==typeof exports)module.exports=a();else if("function"==typeof define&&define.amd)define(a);else{var b;"undefined"!=typeof window?b=window:"undefined"!=typeof global?b=global:"undefined"!=typeof self&&(b=self);b.poly2tri=a()}}(function(){return function b(d,e,f){function g(m,q){if(!e[m]){if(!d[m]){var s="function"==typeof require&&require;if(!q&&s)return s(m,!0);if(k)return k(m,!0);throw Error("Cannot find module '"+m+"'");}s=e[m]={exports:{}};d[m][0].call(s.exports,function(b){var e=
d[m][1][b];return g(e?e:b)},s,s.exports,b,d,e,f)}return e[m].exports}for(var k="function"==typeof require&&require,m=0;m<f.length;m++)g(f[m]);return g}({1:[function(b,d,e){d.exports={version:"1.3.5"}},{}],2:[function(b,d,e){b=function(b,d){this.head_=b;this.tail_=d;this.search_node_=b};b.prototype.head=function(){return this.head_};b.prototype.setHead=function(b){this.head_=b};b.prototype.tail=function(){return this.tail_};b.prototype.setTail=function(b){this.tail_=b};b.prototype.search=function(){return this.search_node_};
b.prototype.setSearch=function(b){this.search_node_=b};b.prototype.findSearchNode=function(){return this.search_node_};b.prototype.locateNode=function(b){var d=this.search_node_;if(b<d.value)for(;d=d.prev;){if(b>=d.value)return this.search_node_=d}else for(;d=d.next;)if(b<d.value)return this.search_node_=d.prev;return null};b.prototype.locatePoint=function(b){var d=b.x,e=this.findSearchNode(d),m=e.point.x;if(d===m){if(b!==e.point)if(b===e.prev.point)e=e.prev;else if(b===e.next.point)e=e.next;else throw Error("poly2tri Invalid AdvancingFront.locatePoint() call");
}else if(d<m)for(;(e=e.prev)&&b!==e.point;);else for(;(e=e.next)&&b!==e.point;);e&&(this.search_node_=e);return e};d.exports=b;d.exports.Node=function(b,d){this.point=b;this.triangle=d||null;this.prev=this.next=null;this.value=b.x}},{}],3:[function(b,d,e){d.exports=function(b,d){if(!b)throw Error(d||"Assert Failed");}},{}],4:[function(b,d,e){var f=b("./xy"),g=function(b,d){this.x=+b||0;this.y=+d||0;this._p2t_edge_list=null};g.prototype.toString=function(){return f.toStringBase(this)};g.prototype.toJSON=
function(){return{x:this.x,y:this.y}};g.prototype.clone=function(){return new g(this.x,this.y)};g.prototype.set_zero=function(){this.y=this.x=0;return this};g.prototype.set=function(b,d){this.x=+b||0;this.y=+d||0;return this};g.prototype.negate=function(){this.x=-this.x;this.y=-this.y;return this};g.prototype.add=function(b){this.x+=b.x;this.y+=b.y;return this};g.prototype.sub=function(b){this.x-=b.x;this.y-=b.y;return this};g.prototype.mul=function(b){this.x*=b;this.y*=b;return this};g.prototype.length=
function(){return Math.sqrt(this.x*this.x+this.y*this.y)};g.prototype.normalize=function(){var b=this.length();this.x/=b;this.y/=b;return b};g.prototype.equals=function(b){return this.x===b.x&&this.y===b.y};g.negate=function(b){return new g(-b.x,-b.y)};g.add=function(b,d){return new g(b.x+d.x,b.y+d.y)};g.sub=function(b,d){return new g(b.x-d.x,b.y-d.y)};g.mul=function(b,d){return new g(b*d.x,b*d.y)};g.cross=function(b,d){return"number"===typeof b?"number"===typeof d?b*d:new g(-b*d.y,b*d.x):"number"===
typeof d?new g(d*b.y,-d*b.x):b.x*d.y-b.y*d.x};g.toString=f.toString;g.compare=f.compare;g.cmp=f.compare;g.equals=f.equals;g.dot=function(b,d){return b.x*d.x+b.y*d.y};d.exports=g},{"./xy":11}],5:[function(b,d,e){var f=b("./xy");b=function(b,d){this.name="PointError";this.points=d=d||[];this.message=b||"Invalid Points!";for(var e=0;e<d.length;e++)this.message+=" "+f.toString(d[e])};b.prototype=Error();b.prototype.constructor=b;d.exports=b},{"./xy":11}],6:[function(b,d,e){(function(d){var g=d.poly2tri;
e.noConflict=function(){d.poly2tri=g;return e};e.VERSION=b("../dist/version.json").version;e.PointError=b("./pointerror");e.Point=b("./point");e.Triangle=b("./triangle");e.SweepContext=b("./sweepcontext");var k=b("./sweep");e.triangulate=k.triangulate;e.sweep={Triangulate:k.triangulate}}).call(this,"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"../dist/version.json":1,"./point":4,"./pointerror":5,"./sweep":7,"./sweepcontext":8,"./triangle":9}],7:[function(b,d,e){function f(b,
d,e,k,E){if(!g(k,d,e)){var I=k.pointCCW(E),m=K(e,I,d);if(m===G.COLLINEAR)throw new B("poly2tri EdgeEvent: Collinear not supported!",[e,I,d]);var I=k.pointCW(E),n=K(e,I,d);if(n===G.COLLINEAR)throw new B("poly2tri EdgeEvent: Collinear not supported!",[e,I,d]);m===n?(k=m===G.CW?k.neighborCCW(E):k.neighborCW(E),f(b,d,e,k,E)):A(b,d,e,k,E)}}function g(b,d,e){var f=b.edgeIndex(d,e);return-1!==f?(b.markConstrainedEdgeByIndex(f),(b=b.getNeighbor(f))&&b.markConstrainedEdgeByPoints(d,e),!0):!1}function k(b,
d){var e=new F(d.prev.point,d.point,d.next.point);e.markNeighbor(d.prev.triangle);e.markNeighbor(d.triangle);b.addToMap(e);d.prev.next=d.next;d.next.prev=d.prev;m(b,e)||b.mapTriangleToNodes(e)}function m(b,d){for(var e=0;3>e;++e)if(!d.delaunay_edge[e]){var f=d.getNeighbor(e);if(f){var E=d.getPoint(e),g=f.oppositePoint(d,E),k=f.index(g);if(f.constrained_edge[k]||f.delaunay_edge[k])d.constrained_edge[e]=f.constrained_edge[k];else{var N;var q=d.pointCCW(E),r=d.pointCW(E);N=E.x-g.x;var s=E.y-g.y,t=q.x-
g.x,q=q.y-g.y,v=N*q-t*s;if(0>=v)N=!1;else{var u=r.x-g.x,r=r.y-g.y,y=u*s-N*r;N=0>=y?!1:0<(N*N+s*s)*(t*r-u*q)+(t*t+q*q)*y+(u*u+r*r)*v}if(N)return d.delaunay_edge[e]=!0,f.delaunay_edge[k]=!0,n(d,E,f,g),(E=!m(b,d))&&b.mapTriangleToNodes(d),(E=!m(b,f))&&b.mapTriangleToNodes(f),d.delaunay_edge[e]=!1,f.delaunay_edge[k]=!1,!0}}}return!1}function n(b,d,e,f){var E,g,k,m;E=b.neighborCCW(d);g=b.neighborCW(d);k=e.neighborCCW(f);m=e.neighborCW(f);var n,q,r,s;n=b.getConstrainedEdgeCCW(d);q=b.getConstrainedEdgeCW(d);
r=e.getConstrainedEdgeCCW(f);s=e.getConstrainedEdgeCW(f);var t,v,u,y;t=b.getDelaunayEdgeCCW(d);v=b.getDelaunayEdgeCW(d);u=e.getDelaunayEdgeCCW(f);y=e.getDelaunayEdgeCW(f);b.legalize(d,f);e.legalize(f,d);e.setDelaunayEdgeCCW(d,t);b.setDelaunayEdgeCW(d,v);b.setDelaunayEdgeCCW(f,u);e.setDelaunayEdgeCW(f,y);e.setConstrainedEdgeCCW(d,n);b.setConstrainedEdgeCW(d,q);b.setConstrainedEdgeCCW(f,r);e.setConstrainedEdgeCW(f,s);b.clearNeighbors();e.clearNeighbors();E&&e.markNeighbor(E);g&&b.markNeighbor(g);k&&
b.markNeighbor(k);m&&e.markNeighbor(m);b.markNeighbor(e)}function q(b,d){var e;e=b.basin.width>(b.basin.left_highest?b.basin.left_node.point.y-d.point.y:b.basin.right_node.point.y-d.point.y)?!0:!1;if(!e&&(k(b,d),d.prev!==b.basin.left_node||d.next!==b.basin.right_node)){if(d.prev===b.basin.left_node){e=K(d.point,d.next.point,d.next.next.point);if(e===G.CW)return;d=d.next}else if(d.next===b.basin.right_node){e=K(d.point,d.prev.point,d.prev.prev.point);if(e===G.CCW)return;d=d.prev}else d=d.prev.point.y<
d.next.point.y?d.prev:d.next;q(b,d)}}function s(b,d,e){e.point.x<d.p.x&&(K(e.point,e.next.point,e.next.next.point)===G.CCW?t(b,d,e):(u(b,d,e),s(b,d,e)))}function t(b,d,e){k(b,e.next);e.next.point!==d.p&&K(d.q,e.next.point,d.p)===G.CCW&&K(e.point,e.next.point,e.next.next.point)===G.CCW&&t(b,d,e)}function u(b,d,e){K(e.next.point,e.next.next.point,e.next.next.next.point)===G.CCW?t(b,d,e.next):K(d.q,e.next.next.point,d.p)===G.CCW&&u(b,d,e.next)}function v(b,d,e){e.point.x>d.p.x&&(K(e.point,e.prev.point,
e.prev.prev.point)===G.CW?z(b,d,e):(y(b,d,e),v(b,d,e)))}function y(b,d,e){K(e.prev.point,e.prev.prev.point,e.prev.prev.prev.point)===G.CW?z(b,d,e.prev):K(d.q,e.prev.prev.point,d.p)===G.CW&&y(b,d,e.prev)}function z(b,d,e){k(b,e.prev);e.prev.point!==d.p&&K(d.q,e.prev.point,d.p)===G.CW&&K(e.point,e.prev.point,e.prev.prev.point)===G.CW&&z(b,d,e)}function A(b,d,e,g,E){var I=g.neighborAcross(E);C(I,"FLIP failed due to missing triangle!");var k=I.oppositePoint(g,E);if(g.getConstrainedEdgeAcross(E))throw b=
g.index(E),new B("poly2tri Intersecting Constraints",[E,k,g.getPoint((b+1)%3),g.getPoint((b+2)%3)]);if(P(E,g.pointCCW(E),g.pointCW(E),k))if(n(g,E,I,k),b.mapTriangleToNodes(g),b.mapTriangleToNodes(I),E===e&&k===d)e===b.edge_event.constrained_edge.q&&d===b.edge_event.constrained_edge.p&&(g.markConstrainedEdgeByPoints(d,e),I.markConstrainedEdgeByPoints(d,e),m(b,g),m(b,I));else{var N=K(e,k,d);N===G.CCW?(k=I.edgeIndex(E,k),I.delaunay_edge[k]=!0,m(b,I),I.clearDelaunayEdges()):(k=g.edgeIndex(E,k),g.delaunay_edge[k]=
!0,m(b,g),g.clearDelaunayEdges(),g=I);A(b,d,e,g,E)}else k=r(d,e,I,k),D(b,d,e,g,I,k),f(b,d,e,g,E)}function r(b,d,e,f){var E=K(d,f,b);if(E===G.CW)return e.pointCCW(f);if(E===G.CCW)return e.pointCW(f);throw new B("poly2tri [Unsupported] nextFlipPoint: opposing point on constrained edge!",[d,f,b]);}function D(b,d,e,f,E,g){var k=E.neighborAcross(g);C(k,"FLIP failed due to missing triangle");E=k.oppositePoint(E,g);P(e,f.pointCCW(e),f.pointCW(e),E)?A(b,e,E,k,E):(E=r(d,e,k,E),D(b,d,e,f,k,E))}var C=b("./assert"),
B=b("./pointerror"),F=b("./triangle"),J=b("./advancingfront").Node;b=b("./utils");var L=b.EPSILON,G=b.Orientation,K=b.orient2d,P=b.inScanArea,R=b.isAngleObtuse;e.triangulate=function(b){b.initTriangulation();b.createAdvancingFront();var d,e=b.pointCount();for(d=1;d<e;++d){var n=b.getPoint(d),E,I=b,M=n,N=I.locateNode(M);E=I;var r=M,t=N,u=new F(r,t.point,t.next.point);u.markNeighbor(t.triangle);E.addToMap(u);r=new J(r);r.next=t.next;r.prev=t;t.next.prev=r;t.next=r;m(E,u)||E.mapTriangleToNodes(u);E=
r;M.x<=N.point.x+L&&k(I,N);M=I;I=E;for(N=I.next;N.next&&!R(N.point,N.next.point,N.prev.point);)k(M,N),N=N.next;for(N=I.prev;N.prev&&!R(N.point,N.next.point,N.prev.point);)k(M,N),N=N.prev;if(I.next&&I.next.next&&(N=I.point.x-I.next.next.point.x,t=I.point.y-I.next.next.point.y,C(0<=t,"unordered y"),0<=N||Math.abs(N)<t)){K(I.point,I.next.point,I.next.next.point)===G.CCW?M.basin.left_node=I.next.next:M.basin.left_node=I.next;for(M.basin.bottom_node=M.basin.left_node;M.basin.bottom_node.next&&M.basin.bottom_node.point.y>=
M.basin.bottom_node.next.point.y;)M.basin.bottom_node=M.basin.bottom_node.next;if(M.basin.bottom_node!==M.basin.left_node){for(M.basin.right_node=M.basin.bottom_node;M.basin.right_node.next&&M.basin.right_node.point.y<M.basin.right_node.next.point.y;)M.basin.right_node=M.basin.right_node.next;M.basin.right_node!==M.basin.bottom_node&&(M.basin.width=M.basin.right_node.point.x-M.basin.left_node.point.x,M.basin.left_highest=M.basin.left_node.point.y>M.basin.right_node.point.y,q(M,M.basin.bottom_node))}}n=
n._p2t_edge_list;for(I=0;n&&I<n.length;++I)if(M=b,N=n[I],t=E,M.edge_event.constrained_edge=N,M.edge_event.right=N.p.x>N.q.x,!g(t.triangle,N.p,N.q)){var u=M,r=N,y=t;if(u.edge_event.right)for(;y.next.point.x<r.p.x;)K(r.q,y.next.point,r.p)===G.CCW?s(u,r,y):y=y.next;else for(;y.prev.point.x>r.p.x;)K(r.q,y.prev.point,r.p)===G.CW?v(u,r,y):y=y.prev;f(M,N.p,N.q,t.triangle,N.q)}}d=b.front().head().next.triangle;for(e=b.front().head().next.point;!d.getConstrainedEdgeCW(e);)d=d.neighborCCW(e);b.meshClean(d)}},
{"./advancingfront":2,"./assert":3,"./pointerror":5,"./triangle":9,"./utils":10}],8:[function(b,d,e){var f=b("./pointerror"),g=b("./point"),k=b("./triangle"),m=b("./sweep"),n=b("./advancingfront"),q=n.Node,s=function(b,d){this.p=b;this.q=d;if(b.y>d.y)this.q=b,this.p=d;else if(b.y===d.y)if(b.x>d.x)this.q=b,this.p=d;else if(b.x===d.x)throw new f("poly2tri Invalid Edge constructor: repeated points!",[b]);this.q._p2t_edge_list||(this.q._p2t_edge_list=[]);this.q._p2t_edge_list.push(this)},t=function(){this.right_node=
this.bottom_node=this.left_node=null;this.width=0;this.left_highest=!1};t.prototype.clear=function(){this.right_node=this.bottom_node=this.left_node=null;this.width=0;this.left_highest=!1};var u=function(){this.constrained_edge=null;this.right=!1};b=function(b,d){d=d||{};this.triangles_=[];this.map_=[];this.points_=d.cloneArrays?b.slice(0):b;this.edge_list=[];this.af_tail_=this.af_middle_=this.af_head_=this.tail_=this.head_=this.front_=this.pmin_=this.pmax_=null;this.basin=new t;this.edge_event=new u;
this.initEdges(this.points_)};b.prototype.addHole=function(b){this.initEdges(b);var d,e=b.length;for(d=0;d<e;d++)this.points_.push(b[d]);return this};b.prototype.AddHole=b.prototype.addHole;b.prototype.addHoles=function(b){var d,e=b.length;for(d=0;d<e;d++)this.initEdges(b[d]);this.points_=this.points_.concat.apply(this.points_,b);return this};b.prototype.addPoint=function(b){this.points_.push(b);return this};b.prototype.AddPoint=b.prototype.addPoint;b.prototype.addPoints=function(b){this.points_=
this.points_.concat(b);return this};b.prototype.triangulate=function(){m.triangulate(this);return this};b.prototype.getBoundingBox=function(){return{min:this.pmin_,max:this.pmax_}};b.prototype.getTriangles=function(){return this.triangles_};b.prototype.GetTriangles=b.prototype.getTriangles;b.prototype.front=function(){return this.front_};b.prototype.pointCount=function(){return this.points_.length};b.prototype.head=function(){return this.head_};b.prototype.setHead=function(b){this.head_=b};b.prototype.tail=
function(){return this.tail_};b.prototype.setTail=function(b){this.tail_=b};b.prototype.getMap=function(){return this.map_};b.prototype.initTriangulation=function(){var b=this.points_[0].x,d=this.points_[0].x,e=this.points_[0].y,f=this.points_[0].y,k,m=this.points_.length;for(k=1;k<m;k++){var n=this.points_[k];n.x>b&&(b=n.x);n.x<d&&(d=n.x);n.y>e&&(e=n.y);n.y<f&&(f=n.y)}this.pmin_=new g(d,f);this.pmax_=new g(b,e);k=.3*(b-d);e=.3*(e-f);this.head_=new g(b+k,f-e);this.tail_=new g(d-k,f-e);this.points_.sort(g.compare)};
b.prototype.initEdges=function(b){var d,e=b.length;for(d=0;d<e;++d)this.edge_list.push(new s(b[d],b[(d+1)%e]))};b.prototype.getPoint=function(b){return this.points_[b]};b.prototype.addToMap=function(b){this.map_.push(b)};b.prototype.locateNode=function(b){return this.front_.locateNode(b.x)};b.prototype.createAdvancingFront=function(){var b,d,e;e=new k(this.points_[0],this.tail_,this.head_);this.map_.push(e);b=new q(e.getPoint(1),e);d=new q(e.getPoint(0),e);e=new q(e.getPoint(2));this.front_=new n(b,
e);b.next=d;d.next=e;d.prev=b;e.prev=d};b.prototype.removeNode=function(b){};b.prototype.mapTriangleToNodes=function(b){for(var d=0;3>d;++d)if(!b.getNeighbor(d)){var e=this.front_.locatePoint(b.pointCW(b.getPoint(d)));e&&(e.triangle=b)}};b.prototype.removeFromMap=function(b){var d,e=this.map_,f=e.length;for(d=0;d<f;d++)if(e[d]===b){e.splice(d,1);break}};b.prototype.meshClean=function(b){b=[b];for(var d,e;d=b.pop();)if(!d.isInterior())for(d.setInterior(!0),this.triangles_.push(d),e=0;3>e;e++)d.constrained_edge[e]||
b.push(d.getNeighbor(e))};d.exports=b},{"./advancingfront":2,"./point":4,"./pointerror":5,"./sweep":7,"./triangle":9}],9:[function(b,d,e){e=function(b,d,e){this.points_=[b,d,e];this.neighbors_=[null,null,null];this.interior_=!1;this.constrained_edge=[!1,!1,!1];this.delaunay_edge=[!1,!1,!1]};var f=b("./xy").toString;e.prototype.toString=function(){return"["+f(this.points_[0])+f(this.points_[1])+f(this.points_[2])+"]"};e.prototype.getPoint=function(b){return this.points_[b]};e.prototype.GetPoint=e.prototype.getPoint;
e.prototype.getPoints=function(){return this.points_};e.prototype.getNeighbor=function(b){return this.neighbors_[b]};e.prototype.containsPoint=function(b){var d=this.points_;return b===d[0]||b===d[1]||b===d[2]};e.prototype.containsEdge=function(b){return this.containsPoint(b.p)&&this.containsPoint(b.q)};e.prototype.containsPoints=function(b,d){return this.containsPoint(b)&&this.containsPoint(d)};e.prototype.isInterior=function(){return this.interior_};e.prototype.setInterior=function(b){this.interior_=
b;return this};e.prototype.markNeighborPointers=function(b,d,e){var f=this.points_;if(b===f[2]&&d===f[1]||b===f[1]&&d===f[2])this.neighbors_[0]=e;else if(b===f[0]&&d===f[2]||b===f[2]&&d===f[0])this.neighbors_[1]=e;else if(b===f[0]&&d===f[1]||b===f[1]&&d===f[0])this.neighbors_[2]=e;else throw Error("poly2tri Invalid Triangle.markNeighborPointers() call");};e.prototype.markNeighbor=function(b){var d=this.points_;b.containsPoints(d[1],d[2])?(this.neighbors_[0]=b,b.markNeighborPointers(d[1],d[2],this)):
b.containsPoints(d[0],d[2])?(this.neighbors_[1]=b,b.markNeighborPointers(d[0],d[2],this)):b.containsPoints(d[0],d[1])&&(this.neighbors_[2]=b,b.markNeighborPointers(d[0],d[1],this))};e.prototype.clearNeighbors=function(){this.neighbors_[0]=null;this.neighbors_[1]=null;this.neighbors_[2]=null};e.prototype.clearDelaunayEdges=function(){this.delaunay_edge[0]=!1;this.delaunay_edge[1]=!1;this.delaunay_edge[2]=!1};e.prototype.pointCW=function(b){var d=this.points_;return b===d[0]?d[2]:b===d[1]?d[0]:b===
d[2]?d[1]:null};e.prototype.pointCCW=function(b){var d=this.points_;return b===d[0]?d[1]:b===d[1]?d[2]:b===d[2]?d[0]:null};e.prototype.neighborCW=function(b){return b===this.points_[0]?this.neighbors_[1]:b===this.points_[1]?this.neighbors_[2]:this.neighbors_[0]};e.prototype.neighborCCW=function(b){return b===this.points_[0]?this.neighbors_[2]:b===this.points_[1]?this.neighbors_[0]:this.neighbors_[1]};e.prototype.getConstrainedEdgeCW=function(b){return b===this.points_[0]?this.constrained_edge[1]:
b===this.points_[1]?this.constrained_edge[2]:this.constrained_edge[0]};e.prototype.getConstrainedEdgeCCW=function(b){return b===this.points_[0]?this.constrained_edge[2]:b===this.points_[1]?this.constrained_edge[0]:this.constrained_edge[1]};e.prototype.getConstrainedEdgeAcross=function(b){return b===this.points_[0]?this.constrained_edge[0]:b===this.points_[1]?this.constrained_edge[1]:this.constrained_edge[2]};e.prototype.setConstrainedEdgeCW=function(b,d){b===this.points_[0]?this.constrained_edge[1]=
d:b===this.points_[1]?this.constrained_edge[2]=d:this.constrained_edge[0]=d};e.prototype.setConstrainedEdgeCCW=function(b,d){b===this.points_[0]?this.constrained_edge[2]=d:b===this.points_[1]?this.constrained_edge[0]=d:this.constrained_edge[1]=d};e.prototype.getDelaunayEdgeCW=function(b){return b===this.points_[0]?this.delaunay_edge[1]:b===this.points_[1]?this.delaunay_edge[2]:this.delaunay_edge[0]};e.prototype.getDelaunayEdgeCCW=function(b){return b===this.points_[0]?this.delaunay_edge[2]:b===this.points_[1]?
this.delaunay_edge[0]:this.delaunay_edge[1]};e.prototype.setDelaunayEdgeCW=function(b,d){b===this.points_[0]?this.delaunay_edge[1]=d:b===this.points_[1]?this.delaunay_edge[2]=d:this.delaunay_edge[0]=d};e.prototype.setDelaunayEdgeCCW=function(b,d){b===this.points_[0]?this.delaunay_edge[2]=d:b===this.points_[1]?this.delaunay_edge[0]=d:this.delaunay_edge[1]=d};e.prototype.neighborAcross=function(b){return b===this.points_[0]?this.neighbors_[0]:b===this.points_[1]?this.neighbors_[1]:this.neighbors_[2]};
e.prototype.oppositePoint=function(b,d){var e=b.pointCW(d);return this.pointCW(e)};e.prototype.legalize=function(b,d){var e=this.points_;if(b===e[0])e[1]=e[0],e[0]=e[2],e[2]=d;else if(b===e[1])e[2]=e[1],e[1]=e[0],e[0]=d;else if(b===e[2])e[0]=e[2],e[2]=e[1],e[1]=d;else throw Error("poly2tri Invalid Triangle.legalize() call");};e.prototype.index=function(b){var d=this.points_;if(b===d[0])return 0;if(b===d[1])return 1;if(b===d[2])return 2;throw Error("poly2tri Invalid Triangle.index() call");};e.prototype.edgeIndex=
function(b,d){var e=this.points_;if(b===e[0]){if(d===e[1])return 2;if(d===e[2])return 1}else if(b===e[1]){if(d===e[2])return 0;if(d===e[0])return 2}else if(b===e[2]){if(d===e[0])return 1;if(d===e[1])return 0}return-1};e.prototype.markConstrainedEdgeByIndex=function(b){this.constrained_edge[b]=!0};e.prototype.markConstrainedEdgeByEdge=function(b){this.markConstrainedEdgeByPoints(b.p,b.q)};e.prototype.markConstrainedEdgeByPoints=function(b,d){var e=this.points_;if(d===e[0]&&b===e[1]||d===e[1]&&b===
e[0])this.constrained_edge[2]=!0;else if(d===e[0]&&b===e[2]||d===e[2]&&b===e[0])this.constrained_edge[1]=!0;else if(d===e[1]&&b===e[2]||d===e[2]&&b===e[1])this.constrained_edge[0]=!0};d.exports=e},{"./xy":11}],10:[function(b,d,e){e.EPSILON=1E-12;var f={CW:1,CCW:-1,COLLINEAR:0};e.Orientation=f;e.orient2d=function(b,d,e){b=(b.x-e.x)*(d.y-e.y)-(b.y-e.y)*(d.x-e.x);return-1E-12<b&&1E-12>b?f.COLLINEAR:0<b?f.CCW:f.CW};e.inScanArea=function(b,d,e,f){return-1E-12<=(b.x-d.x)*(f.y-d.y)-(f.x-d.x)*(b.y-d.y)||
1E-12>=(b.x-e.x)*(f.y-e.y)-(f.x-e.x)*(b.y-e.y)?!1:!0};e.isAngleObtuse=function(b,d,e){return 0>(d.x-b.x)*(e.x-b.x)+(d.y-b.y)*(e.y-b.y)}},{}],11:[function(b,d,e){function f(b){return"("+b.x+";"+b.y+")"}d.exports={toString:function(b){var d=b.toString();return"[object Object]"===d?f(b):d},toStringBase:f,compare:function(b,d){return b.y===d.y?b.x-d.x:b.y-d.y},equals:function(b,d){return b.x===d.x&&b.y===d.y}}},{}]},{},[6])(6)});
(function(){function a(a,b,d){r.biginteger_used=1;null!=a&&("number"==typeof a&&"undefined"==typeof b?this.fromInt(a):"number"==typeof a?this.fromNumber(a,b,d):null==b&&"string"!=typeof a?this.fromString(a,256):this.fromString(a,b))}function b(){return new a(null)}function d(a,b,d,e,f,g){for(;0<=--g;){var k=b*this[a++]+d[e]+f;f=Math.floor(k/67108864);d[e++]=k&67108863}return f}function e(a,b,d,e,f,g){var k=b&32767;for(b>>=15;0<=--g;){var m=this[a]&32767,n=this[a++]>>15,q=b*m+n*k,m=k*m+((q&32767)<<
15)+d[e]+(f&1073741823);f=(m>>>30)+(q>>>15)+b*n+(f>>>30);d[e++]=m&1073741823}return f}function f(a,b,d,e,f,g){var k=b&16383;for(b>>=14;0<=--g;){var m=this[a]&16383,n=this[a++]>>14,q=b*m+n*k,m=k*m+((q&16383)<<14)+d[e]+f;f=(m>>28)+(q>>14)+b*n;d[e++]=m&268435455}return f}function g(a,b){var d=O[a.charCodeAt(b)];return null==d?-1:d}function k(a){var d=b();d.fromInt(a);return d}function m(a){var b=1,d;0!=(d=a>>>16)&&(a=d,b+=16);0!=(d=a>>8)&&(a=d,b+=8);0!=(d=a>>4)&&(a=d,b+=4);0!=(d=a>>2)&&(a=d,b+=2);0!=
a>>1&&(b+=1);return b}function n(a){this.m=a}function q(a){this.m=a;this.mp=a.invDigit();this.mpl=this.mp&32767;this.mph=this.mp>>15;this.um=(1<<a.DB-15)-1;this.mt2=2*a.t}function s(a,b){return a&b}function t(a,b){return a|b}function u(a,b){return a^b}function v(a,b){return a&~b}function y(){}function z(a){return a}function A(d){this.r2=b();this.q3=b();a.ONE.dlShiftTo(2*d.t,this.r2);this.mu=this.r2.divide(d);this.m=d}var r={},D=!1;"undefined"!==typeof module&&module.exports?(module.exports=r,D=!0):
"undefined"!==typeof document?window.ClipperLib=r:self.ClipperLib=r;var C;if(D)B="chrome",C="Netscape";else{var B=navigator.userAgent.toString().toLowerCase();C=navigator.appName}var F,J,L,G,K,P,R;F=-1!=B.indexOf("chrome")&&-1==B.indexOf("chromium")?1:0;D=-1!=B.indexOf("chromium")?1:0;J=-1!=B.indexOf("safari")&&-1==B.indexOf("chrome")&&-1==B.indexOf("chromium")?1:0;L=-1!=B.indexOf("firefox")?1:0;B.indexOf("firefox/17");B.indexOf("firefox/15");B.indexOf("firefox/3");G=-1!=B.indexOf("opera")?1:0;B.indexOf("msie 10");
B.indexOf("msie 9");K=-1!=B.indexOf("msie 8")?1:0;P=-1!=B.indexOf("msie 7")?1:0;R=-1!=B.indexOf("msie ")?1:0;J=-1!=B.indexOf("ejecta")?1:0;r.biginteger_used=null;"Microsoft Internet Explorer"==C?(a.prototype.am=e,C=30):"Netscape"!=C?(a.prototype.am=d,C=26):(a.prototype.am=f,C=28);a.prototype.DB=C;a.prototype.DM=(1<<C)-1;a.prototype.DV=1<<C;a.prototype.FV=Math.pow(2,52);a.prototype.F1=52-C;a.prototype.F2=2*C-52;var O=[];C=48;for(B=0;9>=B;++B)O[C++]=B;C=97;for(B=10;36>B;++B)O[C++]=B;C=65;for(B=10;36>
B;++B)O[C++]=B;n.prototype.convert=function(a){return 0>a.s||0<=a.compareTo(this.m)?a.mod(this.m):a};n.prototype.revert=function(a){return a};n.prototype.reduce=function(a){a.divRemTo(this.m,null,a)};n.prototype.mulTo=function(a,b,d){a.multiplyTo(b,d);this.reduce(d)};n.prototype.sqrTo=function(a,b){a.squareTo(b);this.reduce(b)};q.prototype.convert=function(d){var e=b();d.abs().dlShiftTo(this.m.t,e);e.divRemTo(this.m,null,e);0>d.s&&0<e.compareTo(a.ZERO)&&this.m.subTo(e,e);return e};q.prototype.revert=
function(a){var d=b();a.copyTo(d);this.reduce(d);return d};q.prototype.reduce=function(a){for(;a.t<=this.mt2;)a[a.t++]=0;for(var b=0;b<this.m.t;++b){var d=a[b]&32767,e=d*this.mpl+((d*this.mph+(a[b]>>15)*this.mpl&this.um)<<15)&a.DM,d=b+this.m.t;for(a[d]+=this.m.am(0,e,a,b,0,this.m.t);a[d]>=a.DV;)a[d]-=a.DV,a[++d]++}a.clamp();a.drShiftTo(this.m.t,a);0<=a.compareTo(this.m)&&a.subTo(this.m,a)};q.prototype.mulTo=function(a,b,d){a.multiplyTo(b,d);this.reduce(d)};q.prototype.sqrTo=function(a,b){a.squareTo(b);
this.reduce(b)};a.prototype.copyTo=function(a){for(var b=this.t-1;0<=b;--b)a[b]=this[b];a.t=this.t;a.s=this.s};a.prototype.fromInt=function(a){this.t=1;this.s=0>a?-1:0;0<a?this[0]=a:-1>a?this[0]=a+this.DV:this.t=0};a.prototype.fromString=function(b,d){var e;if(16==d)e=4;else if(8==d)e=3;else if(256==d)e=8;else if(2==d)e=1;else if(32==d)e=5;else if(4==d)e=2;else{this.fromRadix(b,d);return}this.s=this.t=0;for(var f=b.length,k=!1,m=0;0<=--f;){var n=8==e?b[f]&255:g(b,f);0>n?"-"==b.charAt(f)&&(k=!0):(k=
!1,0==m?this[this.t++]=n:m+e>this.DB?(this[this.t-1]|=(n&(1<<this.DB-m)-1)<<m,this[this.t++]=n>>this.DB-m):this[this.t-1]|=n<<m,m+=e,m>=this.DB&&(m-=this.DB))}8==e&&0!=(b[0]&128)&&(this.s=-1,0<m&&(this[this.t-1]|=(1<<this.DB-m)-1<<m));this.clamp();k&&a.ZERO.subTo(this,this)};a.prototype.clamp=function(){for(var a=this.s&this.DM;0<this.t&&this[this.t-1]==a;)--this.t};a.prototype.dlShiftTo=function(a,b){var d;for(d=this.t-1;0<=d;--d)b[d+a]=this[d];for(d=a-1;0<=d;--d)b[d]=0;b.t=this.t+a;b.s=this.s};
a.prototype.drShiftTo=function(a,b){for(var d=a;d<this.t;++d)b[d-a]=this[d];b.t=Math.max(this.t-a,0);b.s=this.s};a.prototype.lShiftTo=function(a,b){var d=a%this.DB,e=this.DB-d,f=(1<<e)-1,g=Math.floor(a/this.DB),m=this.s<<d&this.DM,k;for(k=this.t-1;0<=k;--k)b[k+g+1]=this[k]>>e|m,m=(this[k]&f)<<d;for(k=g-1;0<=k;--k)b[k]=0;b[g]=m;b.t=this.t+g+1;b.s=this.s;b.clamp()};a.prototype.rShiftTo=function(a,b){b.s=this.s;var d=Math.floor(a/this.DB);if(d>=this.t)b.t=0;else{var e=a%this.DB,f=this.DB-e,g=(1<<e)-
1;b[0]=this[d]>>e;for(var k=d+1;k<this.t;++k)b[k-d-1]|=(this[k]&g)<<f,b[k-d]=this[k]>>e;0<e&&(b[this.t-d-1]|=(this.s&g)<<f);b.t=this.t-d;b.clamp()}};a.prototype.subTo=function(a,b){for(var d=0,e=0,f=Math.min(a.t,this.t);d<f;)e+=this[d]-a[d],b[d++]=e&this.DM,e>>=this.DB;if(a.t<this.t){for(e-=a.s;d<this.t;)e+=this[d],b[d++]=e&this.DM,e>>=this.DB;e+=this.s}else{for(e+=this.s;d<a.t;)e-=a[d],b[d++]=e&this.DM,e>>=this.DB;e-=a.s}b.s=0>e?-1:0;-1>e?b[d++]=this.DV+e:0<e&&(b[d++]=e);b.t=d;b.clamp()};a.prototype.multiplyTo=
function(b,d){var e=this.abs(),f=b.abs(),g=e.t;for(d.t=g+f.t;0<=--g;)d[g]=0;for(g=0;g<f.t;++g)d[g+e.t]=e.am(0,f[g],d,g,0,e.t);d.s=0;d.clamp();this.s!=b.s&&a.ZERO.subTo(d,d)};a.prototype.squareTo=function(a){for(var b=this.abs(),d=a.t=2*b.t;0<=--d;)a[d]=0;for(d=0;d<b.t-1;++d){var e=b.am(d,b[d],a,2*d,0,1);(a[d+b.t]+=b.am(d+1,2*b[d],a,2*d+1,e,b.t-d-1))>=b.DV&&(a[d+b.t]-=b.DV,a[d+b.t+1]=1)}0<a.t&&(a[a.t-1]+=b.am(d,b[d],a,2*d,0,1));a.s=0;a.clamp()};a.prototype.divRemTo=function(d,e,f){var g=d.abs();if(!(0>=
g.t)){var k=this.abs();if(k.t<g.t)null!=e&&e.fromInt(0),null!=f&&this.copyTo(f);else{null==f&&(f=b());var n=b(),q=this.s;d=d.s;var r=this.DB-m(g[g.t-1]);0<r?(g.lShiftTo(r,n),k.lShiftTo(r,f)):(g.copyTo(n),k.copyTo(f));g=n.t;k=n[g-1];if(0!=k){var s=k*(1<<this.F1)+(1<g?n[g-2]>>this.F2:0),t=this.FV/s,s=(1<<this.F1)/s,v=1<<this.F2,u=f.t,y=u-g,z=null==e?b():e;n.dlShiftTo(y,z);0<=f.compareTo(z)&&(f[f.t++]=1,f.subTo(z,f));a.ONE.dlShiftTo(g,z);for(z.subTo(n,n);n.t<g;)n[n.t++]=0;for(;0<=--y;){var A=f[--u]==
k?this.DM:Math.floor(f[u]*t+(f[u-1]+v)*s);if((f[u]+=n.am(0,A,f,y,0,g))<A)for(n.dlShiftTo(y,z),f.subTo(z,f);f[u]<--A;)f.subTo(z,f)}null!=e&&(f.drShiftTo(g,e),q!=d&&a.ZERO.subTo(e,e));f.t=g;f.clamp();0<r&&f.rShiftTo(r,f);0>q&&a.ZERO.subTo(f,f)}}}};a.prototype.invDigit=function(){if(1>this.t)return 0;var a=this[0];if(0==(a&1))return 0;var b=a&3,b=b*(2-(a&15)*b)&15,b=b*(2-(a&255)*b)&255,b=b*(2-((a&65535)*b&65535))&65535,b=b*(2-a*b%this.DV)%this.DV;return 0<b?this.DV-b:-b};a.prototype.isEven=function(){return 0==
(0<this.t?this[0]&1:this.s)};a.prototype.exp=function(d,e){if(4294967295<d||1>d)return a.ONE;var f=b(),g=b(),k=e.convert(this),n=m(d)-1;for(k.copyTo(f);0<=--n;)if(e.sqrTo(f,g),0<(d&1<<n))e.mulTo(g,k,f);else var q=f,f=g,g=q;return e.revert(f)};a.prototype.toString=function(a){if(0>this.s)return"-"+this.negate().toString(a);if(16==a)a=4;else if(8==a)a=3;else if(2==a)a=1;else if(32==a)a=5;else if(4==a)a=2;else return this.toRadix(a);var b=(1<<a)-1,d,e=!1,f="",g=this.t,k=this.DB-g*this.DB%a;if(0<g--)for(k<
this.DB&&0<(d=this[g]>>k)&&(e=!0,f="0123456789abcdefghijklmnopqrstuvwxyz".charAt(d));0<=g;)k<a?(d=(this[g]&(1<<k)-1)<<a-k,d|=this[--g]>>(k+=this.DB-a)):(d=this[g]>>(k-=a)&b,0>=k&&(k+=this.DB,--g)),0<d&&(e=!0),e&&(f+="0123456789abcdefghijklmnopqrstuvwxyz".charAt(d));return e?f:"0"};a.prototype.negate=function(){var d=b();a.ZERO.subTo(this,d);return d};a.prototype.abs=function(){return 0>this.s?this.negate():this};a.prototype.compareTo=function(a){var b=this.s-a.s;if(0!=b)return b;var d=this.t,b=d-
a.t;if(0!=b)return 0>this.s?-b:b;for(;0<=--d;)if(0!=(b=this[d]-a[d]))return b;return 0};a.prototype.bitLength=function(){return 0>=this.t?0:this.DB*(this.t-1)+m(this[this.t-1]^this.s&this.DM)};a.prototype.mod=function(d){var e=b();this.abs().divRemTo(d,null,e);0>this.s&&0<e.compareTo(a.ZERO)&&d.subTo(e,e);return e};a.prototype.modPowInt=function(a,b){var d;d=256>a||b.isEven()?new n(b):new q(b);return this.exp(a,d)};a.ZERO=k(0);a.ONE=k(1);y.prototype.convert=z;y.prototype.revert=z;y.prototype.mulTo=
function(a,b,d){a.multiplyTo(b,d)};y.prototype.sqrTo=function(a,b){a.squareTo(b)};A.prototype.convert=function(a){if(0>a.s||a.t>2*this.m.t)return a.mod(this.m);if(0>a.compareTo(this.m))return a;var d=b();a.copyTo(d);this.reduce(d);return d};A.prototype.revert=function(a){return a};A.prototype.reduce=function(a){a.drShiftTo(this.m.t-1,this.r2);a.t>this.m.t+1&&(a.t=this.m.t+1,a.clamp());this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3);for(this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);0>a.compareTo(this.r2);)a.dAddOffset(1,
this.m.t+1);for(a.subTo(this.r2,a);0<=a.compareTo(this.m);)a.subTo(this.m,a)};A.prototype.mulTo=function(a,b,d){a.multiplyTo(b,d);this.reduce(d)};A.prototype.sqrTo=function(a,b){a.squareTo(b);this.reduce(b)};var H=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,
409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],T=67108864/H[H.length-1];a.prototype.chunkSize=function(a){return Math.floor(Math.LN2*this.DB/Math.log(a))};a.prototype.toRadix=function(a){null==
a&&(a=10);if(0==this.signum()||2>a||36<a)return"0";var d=this.chunkSize(a),d=Math.pow(a,d),e=k(d),f=b(),g=b(),m="";for(this.divRemTo(e,f,g);0<f.signum();)m=(d+g.intValue()).toString(a).substr(1)+m,f.divRemTo(e,f,g);return g.intValue().toString(a)+m};a.prototype.fromRadix=function(b,d){this.fromInt(0);null==d&&(d=10);for(var e=this.chunkSize(d),f=Math.pow(d,e),k=!1,m=0,n=0,q=0;q<b.length;++q){var r=g(b,q);0>r?"-"==b.charAt(q)&&0==this.signum()&&(k=!0):(n=d*n+r,++m>=e&&(this.dMultiply(f),this.dAddOffset(n,
0),n=m=0))}0<m&&(this.dMultiply(Math.pow(d,m)),this.dAddOffset(n,0));k&&a.ZERO.subTo(this,this)};a.prototype.fromNumber=function(b,d,e){if("number"==typeof d)if(2>b)this.fromInt(1);else for(this.fromNumber(b,e),this.testBit(b-1)||this.bitwiseTo(a.ONE.shiftLeft(b-1),t,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(d);)this.dAddOffset(2,0),this.bitLength()>b&&this.subTo(a.ONE.shiftLeft(b-1),this);else{e=[];var f=b&7;e.length=(b>>3)+1;d.nextBytes(e);e[0]=0<f?e[0]&(1<<f)-1:0;this.fromString(e,
256)}};a.prototype.bitwiseTo=function(a,b,d){var e,f,g=Math.min(a.t,this.t);for(e=0;e<g;++e)d[e]=b(this[e],a[e]);if(a.t<this.t){f=a.s&this.DM;for(e=g;e<this.t;++e)d[e]=b(this[e],f);d.t=this.t}else{f=this.s&this.DM;for(e=g;e<a.t;++e)d[e]=b(f,a[e]);d.t=a.t}d.s=b(this.s,a.s);d.clamp()};a.prototype.changeBit=function(b,d){var e=a.ONE.shiftLeft(b);this.bitwiseTo(e,d,e);return e};a.prototype.addTo=function(a,b){for(var d=0,e=0,f=Math.min(a.t,this.t);d<f;)e+=this[d]+a[d],b[d++]=e&this.DM,e>>=this.DB;if(a.t<
this.t){for(e+=a.s;d<this.t;)e+=this[d],b[d++]=e&this.DM,e>>=this.DB;e+=this.s}else{for(e+=this.s;d<a.t;)e+=a[d],b[d++]=e&this.DM,e>>=this.DB;e+=a.s}b.s=0>e?-1:0;0<e?b[d++]=e:-1>e&&(b[d++]=this.DV+e);b.t=d;b.clamp()};a.prototype.dMultiply=function(a){this[this.t]=this.am(0,a-1,this,0,0,this.t);++this.t;this.clamp()};a.prototype.dAddOffset=function(a,b){if(0!=a){for(;this.t<=b;)this[this.t++]=0;for(this[b]+=a;this[b]>=this.DV;)this[b]-=this.DV,++b>=this.t&&(this[this.t++]=0),++this[b]}};a.prototype.multiplyLowerTo=
function(a,b,d){var e=Math.min(this.t+a.t,b);d.s=0;for(d.t=e;0<e;)d[--e]=0;var f;for(f=d.t-this.t;e<f;++e)d[e+this.t]=this.am(0,a[e],d,e,0,this.t);for(f=Math.min(a.t,b);e<f;++e)this.am(0,a[e],d,e,0,b-e);d.clamp()};a.prototype.multiplyUpperTo=function(a,b,d){--b;var e=d.t=this.t+a.t-b;for(d.s=0;0<=--e;)d[e]=0;for(e=Math.max(b-this.t,0);e<a.t;++e)d[this.t+e-b]=this.am(b-e,a[e],d,0,0,this.t+e-b);d.clamp();d.drShiftTo(1,d)};a.prototype.modInt=function(a){if(0>=a)return 0;var b=this.DV%a,d=0>this.s?a-
1:0;if(0<this.t)if(0==b)d=this[0]%a;else for(var e=this.t-1;0<=e;--e)d=(b*d+this[e])%a;return d};a.prototype.millerRabin=function(d){var e=this.subtract(a.ONE),f=e.getLowestSetBit();if(0>=f)return!1;var g=e.shiftRight(f);d=d+1>>1;d>H.length&&(d=H.length);for(var k=b(),m=0;m<d;++m){k.fromInt(H[Math.floor(Math.random()*H.length)]);var n=k.modPow(g,this);if(0!=n.compareTo(a.ONE)&&0!=n.compareTo(e)){for(var q=1;q++<f&&0!=n.compareTo(e);)if(n=n.modPowInt(2,this),0==n.compareTo(a.ONE))return!1;if(0!=n.compareTo(e))return!1}}return!0};
a.prototype.clone=function(){var a=b();this.copyTo(a);return a};a.prototype.intValue=function(){if(0>this.s){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]};a.prototype.byteValue=function(){return 0==this.t?this.s:this[0]<<24>>24};a.prototype.shortValue=function(){return 0==this.t?this.s:this[0]<<16>>16};a.prototype.signum=function(){return 0>this.s?-1:0>=this.t||1==this.t&&0>=this[0]?
0:1};a.prototype.toByteArray=function(){var a=this.t,b=[];b[0]=this.s;var d=this.DB-a*this.DB%8,e,f=0;if(0<a--)for(d<this.DB&&(e=this[a]>>d)!=(this.s&this.DM)>>d&&(b[f++]=e|this.s<<this.DB-d);0<=a;)if(8>d?(e=(this[a]&(1<<d)-1)<<8-d,e|=this[--a]>>(d+=this.DB-8)):(e=this[a]>>(d-=8)&255,0>=d&&(d+=this.DB,--a)),0!=(e&128)&&(e|=-256),0==f&&(this.s&128)!=(e&128)&&++f,0<f||e!=this.s)b[f++]=e;return b};a.prototype.equals=function(a){return 0==this.compareTo(a)};a.prototype.min=function(a){return 0>this.compareTo(a)?
this:a};a.prototype.max=function(a){return 0<this.compareTo(a)?this:a};a.prototype.and=function(a){var d=b();this.bitwiseTo(a,s,d);return d};a.prototype.or=function(a){var d=b();this.bitwiseTo(a,t,d);return d};a.prototype.xor=function(a){var d=b();this.bitwiseTo(a,u,d);return d};a.prototype.andNot=function(a){var d=b();this.bitwiseTo(a,v,d);return d};a.prototype.not=function(){for(var a=b(),d=0;d<this.t;++d)a[d]=this.DM&~this[d];a.t=this.t;a.s=~this.s;return a};a.prototype.shiftLeft=function(a){var d=
b();0>a?this.rShiftTo(-a,d):this.lShiftTo(a,d);return d};a.prototype.shiftRight=function(a){var d=b();0>a?this.lShiftTo(-a,d):this.rShiftTo(a,d);return d};a.prototype.getLowestSetBit=function(){for(var a=0;a<this.t;++a)if(0!=this[a]){var b=a*this.DB;a=this[a];if(0==a)a=-1;else{var d=0;0==(a&65535)&&(a>>=16,d+=16);0==(a&255)&&(a>>=8,d+=8);0==(a&15)&&(a>>=4,d+=4);0==(a&3)&&(a>>=2,d+=2);0==(a&1)&&++d;a=d}return b+a}return 0>this.s?this.t*this.DB:-1};a.prototype.bitCount=function(){for(var a=0,b=this.s&
this.DM,d=0;d<this.t;++d){for(var e=this[d]^b,f=0;0!=e;)e&=e-1,++f;a+=f}return a};a.prototype.testBit=function(a){var b=Math.floor(a/this.DB);return b>=this.t?0!=this.s:0!=(this[b]&1<<a%this.DB)};a.prototype.setBit=function(a){return this.changeBit(a,t)};a.prototype.clearBit=function(a){return this.changeBit(a,v)};a.prototype.flipBit=function(a){return this.changeBit(a,u)};a.prototype.add=function(a){var d=b();this.addTo(a,d);return d};a.prototype.subtract=function(a){var d=b();this.subTo(a,d);return d};
a.prototype.multiply=function(a){var d=b();this.multiplyTo(a,d);return d};a.prototype.divide=function(a){var d=b();this.divRemTo(a,d,null);return d};a.prototype.remainder=function(a){var d=b();this.divRemTo(a,null,d);return d};a.prototype.divideAndRemainder=function(a){var d=b(),e=b();this.divRemTo(a,d,e);return[d,e]};a.prototype.modPow=function(a,d){var e=a.bitLength(),f,g=k(1),r;if(0>=e)return g;f=18>e?1:48>e?3:144>e?4:768>e?5:6;r=8>e?new n(d):d.isEven()?new A(d):new q(d);var s=[],t=3,v=f-1,u=(1<<
f)-1;s[1]=r.convert(this);if(1<f)for(e=b(),r.sqrTo(s[1],e);t<=u;)s[t]=b(),r.mulTo(e,s[t-2],s[t]),t+=2;for(var y=a.t-1,z,C=!0,B=b(),e=m(a[y])-1;0<=y;){e>=v?z=a[y]>>e-v&u:(z=(a[y]&(1<<e+1)-1)<<v-e,0<y&&(z|=a[y-1]>>this.DB+e-v));for(t=f;0==(z&1);)z>>=1,--t;0>(e-=t)&&(e+=this.DB,--y);if(C)s[z].copyTo(g),C=!1;else{for(;1<t;)r.sqrTo(g,B),r.sqrTo(B,g),t-=2;0<t?r.sqrTo(g,B):(t=g,g=B,B=t);r.mulTo(B,s[z],g)}for(;0<=y&&0==(a[y]&1<<e);)r.sqrTo(g,B),t=g,g=B,B=t,0>--e&&(e=this.DB-1,--y)}return r.revert(g)};a.prototype.modInverse=
function(b){var d=b.isEven();if(this.isEven()&&d||0==b.signum())return a.ZERO;for(var e=b.clone(),f=this.clone(),g=k(1),m=k(0),n=k(0),q=k(1);0!=e.signum();){for(;e.isEven();)e.rShiftTo(1,e),d?(g.isEven()&&m.isEven()||(g.addTo(this,g),m.subTo(b,m)),g.rShiftTo(1,g)):m.isEven()||m.subTo(b,m),m.rShiftTo(1,m);for(;f.isEven();)f.rShiftTo(1,f),d?(n.isEven()&&q.isEven()||(n.addTo(this,n),q.subTo(b,q)),n.rShiftTo(1,n)):q.isEven()||q.subTo(b,q),q.rShiftTo(1,q);0<=e.compareTo(f)?(e.subTo(f,e),d&&g.subTo(n,g),
m.subTo(q,m)):(f.subTo(e,f),d&&n.subTo(g,n),q.subTo(m,q))}if(0!=f.compareTo(a.ONE))return a.ZERO;if(0<=q.compareTo(b))return q.subtract(b);if(0>q.signum())q.addTo(b,q);else return q;return 0>q.signum()?q.add(b):q};a.prototype.pow=function(a){return this.exp(a,new y)};a.prototype.gcd=function(a){var b=0>this.s?this.negate():this.clone();a=0>a.s?a.negate():a.clone();if(0>b.compareTo(a)){var d=b,b=a;a=d}var d=b.getLowestSetBit(),e=a.getLowestSetBit();if(0>e)return b;d<e&&(e=d);0<e&&(b.rShiftTo(e,b),
a.rShiftTo(e,a));for(;0<b.signum();)0<(d=b.getLowestSetBit())&&b.rShiftTo(d,b),0<(d=a.getLowestSetBit())&&a.rShiftTo(d,a),0<=b.compareTo(a)?(b.subTo(a,b),b.rShiftTo(1,b)):(a.subTo(b,a),a.rShiftTo(1,a));0<e&&a.lShiftTo(e,a);return a};a.prototype.isProbablePrime=function(a){var b,d=this.abs();if(1==d.t&&d[0]<=H[H.length-1]){for(b=0;b<H.length;++b)if(d[0]==H[b])return!0;return!1}if(d.isEven())return!1;for(b=1;b<H.length;){for(var e=H[b],f=b+1;f<H.length&&e<T;)e*=H[f++];for(e=d.modInt(e);b<f;)if(0==e%
H[b++])return!1}return d.millerRabin(a)};a.prototype.square=function(){var a=b();this.squareTo(a);return a};a.prototype.IsNegative=function(){return-1==this.compareTo(a.ZERO)?!0:!1};a.op_Equality=function(a,b){return 0==a.compareTo(b)?!0:!1};a.op_Inequality=function(a,b){return 0!=a.compareTo(b)?!0:!1};a.op_GreaterThan=function(a,b){return 0<a.compareTo(b)?!0:!1};a.op_LessThan=function(a,b){return 0>a.compareTo(b)?!0:!1};a.op_Addition=function(b,d){return(new a(b)).add(new a(d))};a.op_Subtraction=
function(b,d){return(new a(b)).subtract(new a(d))};a.Int128Mul=function(b,d){return(new a(b)).multiply(new a(d))};a.op_Division=function(a,b){return a.divide(b)};a.prototype.ToDouble=function(){return parseFloat(this.toString())};if("undefined"==typeof S)var S=function(a,b){var d;if("undefined"==typeof Object.getOwnPropertyNames)for(d in b.prototype){if("undefined"==typeof a.prototype[d]||a.prototype[d]==Object.prototype[d])a.prototype[d]=b.prototype[d]}else for(var e=Object.getOwnPropertyNames(b.prototype),
f=0;f<e.length;f++)"undefined"==typeof Object.getOwnPropertyDescriptor(a.prototype,e[f])&&Object.defineProperty(a.prototype,e[f],Object.getOwnPropertyDescriptor(b.prototype,e[f]));for(d in b)"undefined"==typeof a[d]&&(a[d]=b[d]);a.$baseCtor=b};r.Path=function(){return[]};r.Paths=function(){return[]};r.DoublePoint=function(){var a=arguments;this.y=this.x=0;1==a.length?(this.x=a[0].x,this.y=a[0].y):2==a.length&&(this.x=a[0],this.y=a[1])};r.DoublePoint0=function(){this.y=this.x=0};r.DoublePoint1=function(a){this.x=
a.x;this.y=a.y};r.DoublePoint2=function(a,b){this.x=a;this.y=b};r.PolyNode=function(){this.m_Parent=null;this.m_polygon=new r.Path;this.m_endtype=this.m_jointype=this.m_Index=0;this.m_Childs=[];this.IsOpen=!1};r.PolyNode.prototype.IsHoleNode=function(){for(var a=!0,b=this.m_Parent;null!==b;)a=!a,b=b.m_Parent;return a};r.PolyNode.prototype.ChildCount=function(){return this.m_Childs.length};r.PolyNode.prototype.Contour=function(){return this.m_polygon};r.PolyNode.prototype.AddChild=function(a){var b=
this.m_Childs.length;this.m_Childs.push(a);a.m_Parent=this;a.m_Index=b};r.PolyNode.prototype.GetNext=function(){return 0<this.m_Childs.length?this.m_Childs[0]:this.GetNextSiblingUp()};r.PolyNode.prototype.GetNextSiblingUp=function(){return null===this.m_Parent?null:this.m_Index==this.m_Parent.m_Childs.length-1?this.m_Parent.GetNextSiblingUp():this.m_Parent.m_Childs[this.m_Index+1]};r.PolyNode.prototype.Childs=function(){return this.m_Childs};r.PolyNode.prototype.Parent=function(){return this.m_Parent};
r.PolyNode.prototype.IsHole=function(){return this.IsHoleNode()};r.PolyTree=function(){this.m_AllPolys=[];r.PolyNode.call(this)};r.PolyTree.prototype.Clear=function(){for(var a=0,b=this.m_AllPolys.length;a<b;a++)this.m_AllPolys[a]=null;this.m_AllPolys.length=0;this.m_Childs.length=0};r.PolyTree.prototype.GetFirst=function(){return 0<this.m_Childs.length?this.m_Childs[0]:null};r.PolyTree.prototype.Total=function(){return this.m_AllPolys.length};S(r.PolyTree,r.PolyNode);r.Math_Abs_Int64=r.Math_Abs_Int32=
r.Math_Abs_Double=function(a){return Math.abs(a)};r.Math_Max_Int32_Int32=function(a,b){return Math.max(a,b)};r.Cast_Int32=R||G||J?function(a){return a|0}:function(a){return~~a};r.Cast_Int64=F?function(a){return-2147483648>a||2147483647<a?0>a?Math.ceil(a):Math.floor(a):~~a}:L&&"function"==typeof Number.toInteger?function(a){return Number.toInteger(a)}:P||K?function(a){return parseInt(a,10)}:R?function(a){return-2147483648>a||2147483647<a?0>a?Math.ceil(a):Math.floor(a):a|0}:function(a){return 0>a?Math.ceil(a):
Math.floor(a)};r.Clear=function(a){a.length=0};r.PI=3.141592653589793;r.PI2=6.283185307179586;r.IntPoint=function(){var a;a=arguments;var b=a.length;this.y=this.x=0;2==b?(this.x=a[0],this.y=a[1]):1==b?a[0]instanceof r.DoublePoint?(a=a[0],this.x=r.Clipper.Round(a.x),this.y=r.Clipper.Round(a.y)):(a=a[0],this.x=a.x,this.y=a.y):this.y=this.x=0};r.IntPoint.op_Equality=function(a,b){return a.x==b.x&&a.y==b.y};r.IntPoint.op_Inequality=function(a,b){return a.x!=b.x||a.y!=b.y};r.IntPoint0=function(){this.y=
this.x=0};r.IntPoint1=function(a){this.x=a.x;this.y=a.y};r.IntPoint1dp=function(a){this.x=r.Clipper.Round(a.x);this.y=r.Clipper.Round(a.y)};r.IntPoint2=function(a,b){this.x=a;this.y=b};r.IntRect=function(){var a=arguments,b=a.length;4==b?(this.left=a[0],this.top=a[1],this.right=a[2],this.bottom=a[3]):1==b?(this.left=ir.left,this.top=ir.top,this.right=ir.right,this.bottom=ir.bottom):this.bottom=this.right=this.top=this.left=0};r.IntRect0=function(){this.bottom=this.right=this.top=this.left=0};r.IntRect1=
function(a){this.left=a.left;this.top=a.top;this.right=a.right;this.bottom=a.bottom};r.IntRect4=function(a,b,d,e){this.left=a;this.top=b;this.right=d;this.bottom=e};r.ClipType={ctIntersection:0,ctUnion:1,ctDifference:2,ctXor:3};r.PolyType={ptSubject:0,ptClip:1};r.PolyFillType={pftEvenOdd:0,pftNonZero:1,pftPositive:2,pftNegative:3};r.JoinType={jtSquare:0,jtRound:1,jtMiter:2};r.EndType={etOpenSquare:0,etOpenRound:1,etOpenButt:2,etClosedLine:3,etClosedPolygon:4};r.EdgeSide={esLeft:0,esRight:1};r.Direction=
{dRightToLeft:0,dLeftToRight:1};r.TEdge=function(){this.Bot=new r.IntPoint;this.Curr=new r.IntPoint;this.Top=new r.IntPoint;this.Delta=new r.IntPoint;this.Dx=0;this.PolyTyp=r.PolyType.ptSubject;this.Side=r.EdgeSide.esLeft;this.OutIdx=this.WindCnt2=this.WindCnt=this.WindDelta=0;this.PrevInSEL=this.NextInSEL=this.PrevInAEL=this.NextInAEL=this.NextInLML=this.Prev=this.Next=null};r.IntersectNode=function(){this.Edge2=this.Edge1=null;this.Pt=new r.IntPoint};r.MyIntersectNodeSort=function(){};r.MyIntersectNodeSort.Compare=
function(a,b){return b.Pt.y-a.Pt.y};r.LocalMinima=function(){this.y=0;this.Next=this.RightBound=this.LeftBound=null};r.Scanbeam=function(){this.y=0;this.Next=null};r.OutRec=function(){this.Idx=0;this.IsOpen=this.IsHole=!1;this.PolyNode=this.BottomPt=this.Pts=this.FirstLeft=null};r.OutPt=function(){this.Idx=0;this.Pt=new r.IntPoint;this.Prev=this.Next=null};r.Join=function(){this.OutPt2=this.OutPt1=null;this.OffPt=new r.IntPoint};r.ClipperBase=function(){this.m_CurrentLM=this.m_MinimaList=null;this.m_edges=
[];this.PreserveCollinear=this.m_HasOpenPaths=this.m_UseFullRange=!1;this.m_CurrentLM=this.m_MinimaList=null;this.m_HasOpenPaths=this.m_UseFullRange=!1};r.ClipperBase.horizontal=-9007199254740992;r.ClipperBase.Skip=-2;r.ClipperBase.Unassigned=-1;r.ClipperBase.tolerance=1E-20;r.ClipperBase.loRange=47453132;r.ClipperBase.hiRange=0xfffffffffffff;r.ClipperBase.near_zero=function(a){return a>-r.ClipperBase.tolerance&&a<r.ClipperBase.tolerance};r.ClipperBase.IsHorizontal=function(a){return 0===a.Delta.y};
r.ClipperBase.prototype.PointIsVertex=function(a,b){var d=b;do{if(r.IntPoint.op_Equality(d.Pt,a))return!0;d=d.Next}while(d!=b);return!1};r.ClipperBase.prototype.PointOnLineSegment=function(b,d,e,f){return f?b.x==d.x&&b.y==d.y||b.x==e.x&&b.y==e.y||b.x>d.x==b.x<e.x&&b.y>d.y==b.y<e.y&&a.op_Equality(a.Int128Mul(b.x-d.x,e.y-d.y),a.Int128Mul(e.x-d.x,b.y-d.y)):b.x==d.x&&b.y==d.y||b.x==e.x&&b.y==e.y||b.x>d.x==b.x<e.x&&b.y>d.y==b.y<e.y&&(b.x-d.x)*(e.y-d.y)==(e.x-d.x)*(b.y-d.y)};r.ClipperBase.prototype.PointOnPolygon=
function(a,b,d){for(var e=b;;){if(this.PointOnLineSegment(a,e.Pt,e.Next.Pt,d))return!0;e=e.Next;if(e==b)break}return!1};r.ClipperBase.prototype.SlopesEqual=r.ClipperBase.SlopesEqual=function(){var b=arguments,d=b.length,e,f,g;if(3==d)return d=b[0],e=b[1],(b=b[2])?a.op_Equality(a.Int128Mul(d.Delta.y,e.Delta.x),a.Int128Mul(d.Delta.x,e.Delta.y)):r.Cast_Int64(d.Delta.y*e.Delta.x)==r.Cast_Int64(d.Delta.x*e.Delta.y);if(4==d)return d=b[0],e=b[1],f=b[2],(b=b[3])?a.op_Equality(a.Int128Mul(d.y-e.y,e.x-f.x),
a.Int128Mul(d.x-e.x,e.y-f.y)):0===r.Cast_Int64((d.y-e.y)*(e.x-f.x))-r.Cast_Int64((d.x-e.x)*(e.y-f.y));d=b[0];e=b[1];f=b[2];g=b[3];return(b=b[4])?a.op_Equality(a.Int128Mul(d.y-e.y,f.x-g.x),a.Int128Mul(d.x-e.x,f.y-g.y)):0===r.Cast_Int64((d.y-e.y)*(f.x-g.x))-r.Cast_Int64((d.x-e.x)*(f.y-g.y))};r.ClipperBase.SlopesEqual3=function(b,d,e){return e?a.op_Equality(a.Int128Mul(b.Delta.y,d.Delta.x),a.Int128Mul(b.Delta.x,d.Delta.y)):r.Cast_Int64(b.Delta.y*d.Delta.x)==r.Cast_Int64(b.Delta.x*d.Delta.y)};r.ClipperBase.SlopesEqual4=
function(b,d,e,f){return f?a.op_Equality(a.Int128Mul(b.y-d.y,d.x-e.x),a.Int128Mul(b.x-d.x,d.y-e.y)):0===r.Cast_Int64((b.y-d.y)*(d.x-e.x))-r.Cast_Int64((b.x-d.x)*(d.y-e.y))};r.ClipperBase.SlopesEqual5=function(b,d,e,f,g){return g?a.op_Equality(a.Int128Mul(b.y-d.y,e.x-f.x),a.Int128Mul(b.x-d.x,e.y-f.y)):0===r.Cast_Int64((b.y-d.y)*(e.x-f.x))-r.Cast_Int64((b.x-d.x)*(e.y-f.y))};r.ClipperBase.prototype.Clear=function(){this.DisposeLocalMinimaList();for(var a=0,b=this.m_edges.length;a<b;++a){for(var d=0,
e=this.m_edges[a].length;d<e;++d)this.m_edges[a][d]=null;r.Clear(this.m_edges[a])}r.Clear(this.m_edges);this.m_HasOpenPaths=this.m_UseFullRange=!1};r.ClipperBase.prototype.DisposeLocalMinimaList=function(){for(;null!==this.m_MinimaList;){var a=this.m_MinimaList.Next;this.m_MinimaList=null;this.m_MinimaList=a}this.m_CurrentLM=null};r.ClipperBase.prototype.RangeTest=function(a,b){if(b.Value)(a.x>r.ClipperBase.hiRange||a.y>r.ClipperBase.hiRange||-a.x>r.ClipperBase.hiRange||-a.y>r.ClipperBase.hiRange)&&
r.Error("Coordinate outside allowed range in RangeTest().");else if(a.x>r.ClipperBase.loRange||a.y>r.ClipperBase.loRange||-a.x>r.ClipperBase.loRange||-a.y>r.ClipperBase.loRange)b.Value=!0,this.RangeTest(a,b)};r.ClipperBase.prototype.InitEdge=function(a,b,d,e){a.Next=b;a.Prev=d;a.Curr.x=e.x;a.Curr.y=e.y;a.OutIdx=-1};r.ClipperBase.prototype.InitEdge2=function(a,b){a.Curr.y>=a.Next.Curr.y?(a.Bot.x=a.Curr.x,a.Bot.y=a.Curr.y,a.Top.x=a.Next.Curr.x,a.Top.y=a.Next.Curr.y):(a.Top.x=a.Curr.x,a.Top.y=a.Curr.y,
a.Bot.x=a.Next.Curr.x,a.Bot.y=a.Next.Curr.y);this.SetDx(a);a.PolyTyp=b};r.ClipperBase.prototype.FindNextLocMin=function(a){for(var b;;){for(;r.IntPoint.op_Inequality(a.Bot,a.Prev.Bot)||r.IntPoint.op_Equality(a.Curr,a.Top);)a=a.Next;if(a.Dx!=r.ClipperBase.horizontal&&a.Prev.Dx!=r.ClipperBase.horizontal)break;for(;a.Prev.Dx==r.ClipperBase.horizontal;)a=a.Prev;for(b=a;a.Dx==r.ClipperBase.horizontal;)a=a.Next;if(a.Top.y!=a.Prev.Bot.y){b.Prev.Bot.x<a.Bot.x&&(a=b);break}}return a};r.ClipperBase.prototype.ProcessBound=
function(a,b){var d=a,e=a,f;a.Dx==r.ClipperBase.horizontal&&(f=b?a.Prev.Bot.x:a.Next.Bot.x,a.Bot.x!=f&&this.ReverseHorizontal(a));if(e.OutIdx!=r.ClipperBase.Skip)if(b){for(;e.Top.y==e.Next.Bot.y&&e.Next.OutIdx!=r.ClipperBase.Skip;)e=e.Next;if(e.Dx==r.ClipperBase.horizontal&&e.Next.OutIdx!=r.ClipperBase.Skip){for(f=e;f.Prev.Dx==r.ClipperBase.horizontal;)f=f.Prev;f.Prev.Top.x==e.Next.Top.x?b||(e=f.Prev):f.Prev.Top.x>e.Next.Top.x&&(e=f.Prev)}for(;a!=e;)a.NextInLML=a.Next,a.Dx==r.ClipperBase.horizontal&&
a!=d&&a.Bot.x!=a.Prev.Top.x&&this.ReverseHorizontal(a),a=a.Next;a.Dx==r.ClipperBase.horizontal&&a!=d&&a.Bot.x!=a.Prev.Top.x&&this.ReverseHorizontal(a);e=e.Next}else{for(;e.Top.y==e.Prev.Bot.y&&e.Prev.OutIdx!=r.ClipperBase.Skip;)e=e.Prev;if(e.Dx==r.ClipperBase.horizontal&&e.Prev.OutIdx!=r.ClipperBase.Skip){for(f=e;f.Next.Dx==r.ClipperBase.horizontal;)f=f.Next;f.Next.Top.x==e.Prev.Top.x?b||(e=f.Next):f.Next.Top.x>e.Prev.Top.x&&(e=f.Next)}for(;a!=e;)a.NextInLML=a.Prev,a.Dx==r.ClipperBase.horizontal&&
a!=d&&a.Bot.x!=a.Next.Top.x&&this.ReverseHorizontal(a),a=a.Prev;a.Dx==r.ClipperBase.horizontal&&a!=d&&a.Bot.x!=a.Next.Top.x&&this.ReverseHorizontal(a);e=e.Prev}if(e.OutIdx==r.ClipperBase.Skip){a=e;if(b){for(;a.Top.y==a.Next.Bot.y;)a=a.Next;for(;a!=e&&a.Dx==r.ClipperBase.horizontal;)a=a.Prev}else{for(;a.Top.y==a.Prev.Bot.y;)a=a.Prev;for(;a!=e&&a.Dx==r.ClipperBase.horizontal;)a=a.Next}a==e?e=b?a.Next:a.Prev:(a=b?e.Next:e.Prev,d=new r.LocalMinima,d.Next=null,d.y=a.Bot.y,d.LeftBound=null,d.RightBound=
a,d.RightBound.WindDelta=0,e=this.ProcessBound(d.RightBound,b),this.InsertLocalMinima(d))}return e};r.ClipperBase.prototype.AddPath=function(a,b,d){d||b!=r.PolyType.ptClip||r.Error("AddPath: Open paths must be subject.");var e=a.length-1;if(d)for(;0<e&&r.IntPoint.op_Equality(a[e],a[0]);)--e;for(;0<e&&r.IntPoint.op_Equality(a[e],a[e-1]);)--e;if(d&&2>e||!d&&1>e)return!1;for(var f=[],g=0;g<=e;g++)f.push(new r.TEdge);var k=!0;f[1].Curr.x=a[1].x;f[1].Curr.y=a[1].y;var m={Value:this.m_UseFullRange};this.RangeTest(a[0],
m);this.m_UseFullRange=m.Value;m.Value=this.m_UseFullRange;this.RangeTest(a[e],m);this.m_UseFullRange=m.Value;this.InitEdge(f[0],f[1],f[e],a[0]);this.InitEdge(f[e],f[0],f[e-1],a[e]);for(g=e-1;1<=g;--g)m.Value=this.m_UseFullRange,this.RangeTest(a[g],m),this.m_UseFullRange=m.Value,this.InitEdge(f[g],f[g+1],f[g-1],a[g]);for(g=a=e=f[0];;)if(r.IntPoint.op_Equality(a.Curr,a.Next.Curr)){if(a==a.Next)break;a==e&&(e=a.Next);g=a=this.RemoveEdge(a)}else{if(a.Prev==a.Next)break;else if(d&&r.ClipperBase.SlopesEqual(a.Prev.Curr,
a.Curr,a.Next.Curr,this.m_UseFullRange)&&(!this.PreserveCollinear||!this.Pt2IsBetweenPt1AndPt3(a.Prev.Curr,a.Curr,a.Next.Curr))){a==e&&(e=a.Next);a=this.RemoveEdge(a);g=a=a.Prev;continue}a=a.Next;if(a==g)break}if(!d&&a==a.Next||d&&a.Prev==a.Next)return!1;d||(this.m_HasOpenPaths=!0,e.Prev.OutIdx=r.ClipperBase.Skip);a=e;do this.InitEdge2(a,b),a=a.Next,k&&a.Curr.y!=e.Curr.y&&(k=!1);while(a!=e);if(k){if(d)return!1;a.Prev.OutIdx=r.ClipperBase.Skip;a.Prev.Bot.x<a.Prev.Top.x&&this.ReverseHorizontal(a.Prev);
b=new r.LocalMinima;b.Next=null;b.y=a.Bot.y;b.LeftBound=null;b.RightBound=a;b.RightBound.Side=r.EdgeSide.esRight;for(b.RightBound.WindDelta=0;a.Next.OutIdx!=r.ClipperBase.Skip;)a.NextInLML=a.Next,a.Bot.x!=a.Prev.Top.x&&this.ReverseHorizontal(a),a=a.Next;this.InsertLocalMinima(b);this.m_edges.push(f);return!0}this.m_edges.push(f);for(k=null;;){a=this.FindNextLocMin(a);if(a==k)break;else null==k&&(k=a);b=new r.LocalMinima;b.Next=null;b.y=a.Bot.y;a.Dx<a.Prev.Dx?(b.LeftBound=a.Prev,b.RightBound=a,f=!1):
(b.LeftBound=a,b.RightBound=a.Prev,f=!0);b.LeftBound.Side=r.EdgeSide.esLeft;b.RightBound.Side=r.EdgeSide.esRight;b.LeftBound.WindDelta=d?b.LeftBound.Next==b.RightBound?-1:1:0;b.RightBound.WindDelta=-b.LeftBound.WindDelta;a=this.ProcessBound(b.LeftBound,f);e=this.ProcessBound(b.RightBound,!f);b.LeftBound.OutIdx==r.ClipperBase.Skip?b.LeftBound=null:b.RightBound.OutIdx==r.ClipperBase.Skip&&(b.RightBound=null);this.InsertLocalMinima(b);f||(a=e)}return!0};r.ClipperBase.prototype.AddPaths=function(a,b,
d){for(var e=!1,f=0,g=a.length;f<g;++f)this.AddPath(a[f],b,d)&&(e=!0);return e};r.ClipperBase.prototype.Pt2IsBetweenPt1AndPt3=function(a,b,d){return r.IntPoint.op_Equality(a,d)||r.IntPoint.op_Equality(a,b)||r.IntPoint.op_Equality(d,b)?!1:a.x!=d.x?b.x>a.x==b.x<d.x:b.y>a.y==b.y<d.y};r.ClipperBase.prototype.RemoveEdge=function(a){a.Prev.Next=a.Next;a.Next.Prev=a.Prev;var b=a.Next;a.Prev=null;return b};r.ClipperBase.prototype.SetDx=function(a){a.Delta.x=a.Top.x-a.Bot.x;a.Delta.y=a.Top.y-a.Bot.y;a.Dx=
0===a.Delta.y?r.ClipperBase.horizontal:a.Delta.x/a.Delta.y};r.ClipperBase.prototype.InsertLocalMinima=function(a){if(null===this.m_MinimaList)this.m_MinimaList=a;else if(a.y>=this.m_MinimaList.y)a.Next=this.m_MinimaList,this.m_MinimaList=a;else{for(var b=this.m_MinimaList;null!==b.Next&&a.y<b.Next.y;)b=b.Next;a.Next=b.Next;b.Next=a}};r.ClipperBase.prototype.PopLocalMinima=function(){null!==this.m_CurrentLM&&(this.m_CurrentLM=this.m_CurrentLM.Next)};r.ClipperBase.prototype.ReverseHorizontal=function(a){var b=
a.Top.x;a.Top.x=a.Bot.x;a.Bot.x=b};r.ClipperBase.prototype.Reset=function(){this.m_CurrentLM=this.m_MinimaList;if(null!=this.m_CurrentLM)for(var a=this.m_MinimaList;null!=a;){var b=a.LeftBound;null!=b&&(b.Curr.x=b.Bot.x,b.Curr.y=b.Bot.y,b.Side=r.EdgeSide.esLeft,b.OutIdx=r.ClipperBase.Unassigned);b=a.RightBound;null!=b&&(b.Curr.x=b.Bot.x,b.Curr.y=b.Bot.y,b.Side=r.EdgeSide.esRight,b.OutIdx=r.ClipperBase.Unassigned);a=a.Next}};r.Clipper=function(a){"undefined"==typeof a&&(a=0);this.m_PolyOuts=null;this.m_ClipType=
r.ClipType.ctIntersection;this.m_IntersectNodeComparer=this.m_IntersectList=this.m_SortedEdges=this.m_ActiveEdges=this.m_Scanbeam=null;this.m_ExecuteLocked=!1;this.m_SubjFillType=this.m_ClipFillType=r.PolyFillType.pftEvenOdd;this.m_GhostJoins=this.m_Joins=null;this.StrictlySimple=this.ReverseSolution=this.m_UsingPolyTree=!1;r.ClipperBase.call(this);this.m_SortedEdges=this.m_ActiveEdges=this.m_Scanbeam=null;this.m_IntersectList=[];this.m_IntersectNodeComparer=r.MyIntersectNodeSort.Compare;this.m_UsingPolyTree=
this.m_ExecuteLocked=!1;this.m_PolyOuts=[];this.m_Joins=[];this.m_GhostJoins=[];this.ReverseSolution=0!==(1&a);this.StrictlySimple=0!==(2&a);this.PreserveCollinear=0!==(4&a)};r.Clipper.ioReverseSolution=1;r.Clipper.ioStrictlySimple=2;r.Clipper.ioPreserveCollinear=4;r.Clipper.prototype.Clear=function(){0!==this.m_edges.length&&(this.DisposeAllPolyPts(),r.ClipperBase.prototype.Clear.call(this))};r.Clipper.prototype.DisposeScanbeamList=function(){for(;null!==this.m_Scanbeam;){var a=this.m_Scanbeam.Next;
this.m_Scanbeam=null;this.m_Scanbeam=a}};r.Clipper.prototype.Reset=function(){r.ClipperBase.prototype.Reset.call(this);this.m_SortedEdges=this.m_ActiveEdges=this.m_Scanbeam=null;for(var a=this.m_MinimaList;null!==a;)this.InsertScanbeam(a.y),a=a.Next};r.Clipper.prototype.InsertScanbeam=function(a){if(null===this.m_Scanbeam)this.m_Scanbeam=new r.Scanbeam,this.m_Scanbeam.Next=null,this.m_Scanbeam.y=a;else if(a>this.m_Scanbeam.y){var b=new r.Scanbeam;b.y=a;b.Next=this.m_Scanbeam;this.m_Scanbeam=b}else{for(var d=
this.m_Scanbeam;null!==d.Next&&a<=d.Next.y;)d=d.Next;a!=d.y&&(b=new r.Scanbeam,b.y=a,b.Next=d.Next,d.Next=b)}};r.Clipper.prototype.Execute=function(){var a=arguments,b=a.length,d=a[1]instanceof r.PolyTree;if(4!=b||d){if(4==b&&d){var b=a[0],e=a[1],d=a[2],a=a[3];if(this.m_ExecuteLocked)return!1;this.m_ExecuteLocked=!0;this.m_SubjFillType=d;this.m_ClipFillType=a;this.m_ClipType=b;this.m_UsingPolyTree=!0;try{(f=this.ExecuteInternal())&&this.BuildResult2(e)}finally{this.DisposeAllPolyPts(),this.m_ExecuteLocked=
!1}return f}if(2==b&&!d||2==b&&d)return b=a[0],e=a[1],this.Execute(b,e,r.PolyFillType.pftEvenOdd,r.PolyFillType.pftEvenOdd)}else{b=a[0];e=a[1];d=a[2];a=a[3];if(this.m_ExecuteLocked)return!1;this.m_HasOpenPaths&&r.Error("Error: PolyTree struct is need for open path clipping.");this.m_ExecuteLocked=!0;r.Clear(e);this.m_SubjFillType=d;this.m_ClipFillType=a;this.m_ClipType=b;this.m_UsingPolyTree=!1;try{var f=this.ExecuteInternal();f&&this.BuildResult(e)}finally{this.DisposeAllPolyPts(),this.m_ExecuteLocked=
!1}return f}};r.Clipper.prototype.FixHoleLinkage=function(a){if(null!==a.FirstLeft&&(a.IsHole==a.FirstLeft.IsHole||null===a.FirstLeft.Pts)){for(var b=a.FirstLeft;null!==b&&(b.IsHole==a.IsHole||null===b.Pts);)b=b.FirstLeft;a.FirstLeft=b}};r.Clipper.prototype.ExecuteInternal=function(){try{this.Reset();if(null===this.m_CurrentLM)return!1;var a=this.PopScanbeam();do{this.InsertLocalMinimaIntoAEL(a);r.Clear(this.m_GhostJoins);this.ProcessHorizontals(!1);if(null===this.m_Scanbeam)break;var b=this.PopScanbeam();
if(!this.ProcessIntersections(a,b))return!1;this.ProcessEdgesAtTopOfScanbeam(b);a=b}while(null!==this.m_Scanbeam||null!==this.m_CurrentLM);for(var a=0,d=this.m_PolyOuts.length;a<d;a++){var e=this.m_PolyOuts[a];null===e.Pts||e.IsOpen||(e.IsHole^this.ReverseSolution)==0<this.Area(e)&&this.ReversePolyPtLinks(e.Pts)}this.JoinCommonEdges();a=0;for(d=this.m_PolyOuts.length;a<d;a++)e=this.m_PolyOuts[a],null===e.Pts||e.IsOpen||this.FixupOutPolygon(e);this.StrictlySimple&&this.DoSimplePolygons();return!0}finally{r.Clear(this.m_Joins),
r.Clear(this.m_GhostJoins)}};r.Clipper.prototype.PopScanbeam=function(){var a=this.m_Scanbeam.y;this.m_Scanbeam=this.m_Scanbeam.Next;return a};r.Clipper.prototype.DisposeAllPolyPts=function(){for(var a=0,b=this.m_PolyOuts.length;a<b;++a)this.DisposeOutRec(a);r.Clear(this.m_PolyOuts)};r.Clipper.prototype.DisposeOutRec=function(a){var b=this.m_PolyOuts[a];null!==b.Pts&&this.DisposeOutPts(b.Pts);this.m_PolyOuts[a]=null};r.Clipper.prototype.DisposeOutPts=function(a){if(null!==a)for(a.Prev.Next=null;null!==
a;)a=a.Next};r.Clipper.prototype.AddJoin=function(a,b,d){var e=new r.Join;e.OutPt1=a;e.OutPt2=b;e.OffPt.x=d.x;e.OffPt.y=d.y;this.m_Joins.push(e)};r.Clipper.prototype.AddGhostJoin=function(a,b){var d=new r.Join;d.OutPt1=a;d.OffPt.x=b.x;d.OffPt.y=b.y;this.m_GhostJoins.push(d)};r.Clipper.prototype.InsertLocalMinimaIntoAEL=function(a){for(;null!==this.m_CurrentLM&&this.m_CurrentLM.y==a;){var b=this.m_CurrentLM.LeftBound,d=this.m_CurrentLM.RightBound;this.PopLocalMinima();var e=null;null===b?(this.InsertEdgeIntoAEL(d,
null),this.SetWindingCount(d),this.IsContributing(d)&&(e=this.AddOutPt(d,d.Bot))):(null==d?(this.InsertEdgeIntoAEL(b,null),this.SetWindingCount(b),this.IsContributing(b)&&(e=this.AddOutPt(b,b.Bot))):(this.InsertEdgeIntoAEL(b,null),this.InsertEdgeIntoAEL(d,b),this.SetWindingCount(b),d.WindCnt=b.WindCnt,d.WindCnt2=b.WindCnt2,this.IsContributing(b)&&(e=this.AddLocalMinPoly(b,d,b.Bot))),this.InsertScanbeam(b.Top.y));null!=d&&(r.ClipperBase.IsHorizontal(d)?this.AddEdgeToSEL(d):this.InsertScanbeam(d.Top.y));
if(null!=b&&null!=d){if(null!==e&&r.ClipperBase.IsHorizontal(d)&&0<this.m_GhostJoins.length&&0!==d.WindDelta)for(var f=0,g=this.m_GhostJoins.length;f<g;f++){var k=this.m_GhostJoins[f];this.HorzSegmentsOverlap(k.OutPt1.Pt,k.OffPt,d.Bot,d.Top)&&this.AddJoin(k.OutPt1,e,k.OffPt)}0<=b.OutIdx&&null!==b.PrevInAEL&&b.PrevInAEL.Curr.x==b.Bot.x&&0<=b.PrevInAEL.OutIdx&&r.ClipperBase.SlopesEqual(b.PrevInAEL,b,this.m_UseFullRange)&&0!==b.WindDelta&&0!==b.PrevInAEL.WindDelta&&(f=this.AddOutPt(b.PrevInAEL,b.Bot),
this.AddJoin(e,f,b.Top));if(b.NextInAEL!=d&&(0<=d.OutIdx&&0<=d.PrevInAEL.OutIdx&&r.ClipperBase.SlopesEqual(d.PrevInAEL,d,this.m_UseFullRange)&&0!==d.WindDelta&&0!==d.PrevInAEL.WindDelta&&(f=this.AddOutPt(d.PrevInAEL,d.Bot),this.AddJoin(e,f,d.Top)),e=b.NextInAEL,null!==e))for(;e!=d;)this.IntersectEdges(d,e,b.Curr,!1),e=e.NextInAEL}}};r.Clipper.prototype.InsertEdgeIntoAEL=function(a,b){if(null===this.m_ActiveEdges)a.PrevInAEL=null,a.NextInAEL=null,this.m_ActiveEdges=a;else if(null===b&&this.E2InsertsBeforeE1(this.m_ActiveEdges,
a))a.PrevInAEL=null,a.NextInAEL=this.m_ActiveEdges,this.m_ActiveEdges=this.m_ActiveEdges.PrevInAEL=a;else{null===b&&(b=this.m_ActiveEdges);for(;null!==b.NextInAEL&&!this.E2InsertsBeforeE1(b.NextInAEL,a);)b=b.NextInAEL;a.NextInAEL=b.NextInAEL;null!==b.NextInAEL&&(b.NextInAEL.PrevInAEL=a);a.PrevInAEL=b;b.NextInAEL=a}};r.Clipper.prototype.E2InsertsBeforeE1=function(a,b){return b.Curr.x==a.Curr.x?b.Top.y>a.Top.y?b.Top.x<r.Clipper.TopX(a,b.Top.y):a.Top.x>r.Clipper.TopX(b,a.Top.y):b.Curr.x<a.Curr.x};r.Clipper.prototype.IsEvenOddFillType=
function(a){return a.PolyTyp==r.PolyType.ptSubject?this.m_SubjFillType==r.PolyFillType.pftEvenOdd:this.m_ClipFillType==r.PolyFillType.pftEvenOdd};r.Clipper.prototype.IsEvenOddAltFillType=function(a){return a.PolyTyp==r.PolyType.ptSubject?this.m_ClipFillType==r.PolyFillType.pftEvenOdd:this.m_SubjFillType==r.PolyFillType.pftEvenOdd};r.Clipper.prototype.IsContributing=function(a){var b,d;a.PolyTyp==r.PolyType.ptSubject?(b=this.m_SubjFillType,d=this.m_ClipFillType):(b=this.m_ClipFillType,d=this.m_SubjFillType);
switch(b){case r.PolyFillType.pftEvenOdd:if(0===a.WindDelta&&1!=a.WindCnt)return!1;break;case r.PolyFillType.pftNonZero:if(1!=Math.abs(a.WindCnt))return!1;break;case r.PolyFillType.pftPositive:if(1!=a.WindCnt)return!1;break;default:if(-1!=a.WindCnt)return!1}switch(this.m_ClipType){case r.ClipType.ctIntersection:switch(d){case r.PolyFillType.pftEvenOdd:case r.PolyFillType.pftNonZero:return 0!==a.WindCnt2;case r.PolyFillType.pftPositive:return 0<a.WindCnt2;default:return 0>a.WindCnt2}case r.ClipType.ctUnion:switch(d){case r.PolyFillType.pftEvenOdd:case r.PolyFillType.pftNonZero:return 0===
a.WindCnt2;case r.PolyFillType.pftPositive:return 0>=a.WindCnt2;default:return 0<=a.WindCnt2}case r.ClipType.ctDifference:if(a.PolyTyp==r.PolyType.ptSubject)switch(d){case r.PolyFillType.pftEvenOdd:case r.PolyFillType.pftNonZero:return 0===a.WindCnt2;case r.PolyFillType.pftPositive:return 0>=a.WindCnt2;default:return 0<=a.WindCnt2}else switch(d){case r.PolyFillType.pftEvenOdd:case r.PolyFillType.pftNonZero:return 0!==a.WindCnt2;case r.PolyFillType.pftPositive:return 0<a.WindCnt2;default:return 0>
a.WindCnt2}case r.ClipType.ctXor:if(0===a.WindDelta)switch(d){case r.PolyFillType.pftEvenOdd:case r.PolyFillType.pftNonZero:return 0===a.WindCnt2;case r.PolyFillType.pftPositive:return 0>=a.WindCnt2;default:return 0<=a.WindCnt2}}return!0};r.Clipper.prototype.SetWindingCount=function(a){for(var b=a.PrevInAEL;null!==b&&(b.PolyTyp!=a.PolyTyp||0===b.WindDelta);)b=b.PrevInAEL;if(null===b)a.WindCnt=0===a.WindDelta?1:a.WindDelta,a.WindCnt2=0,b=this.m_ActiveEdges;else{if(0===a.WindDelta&&this.m_ClipType!=
r.ClipType.ctUnion)a.WindCnt=1;else if(this.IsEvenOddFillType(a))if(0===a.WindDelta){for(var d=!0,e=b.PrevInAEL;null!==e;)e.PolyTyp==b.PolyTyp&&0!==e.WindDelta&&(d=!d),e=e.PrevInAEL;a.WindCnt=d?0:1}else a.WindCnt=a.WindDelta;else 0>b.WindCnt*b.WindDelta?1<Math.abs(b.WindCnt)?a.WindCnt=0>b.WindDelta*a.WindDelta?b.WindCnt:b.WindCnt+a.WindDelta:a.WindCnt=0===a.WindDelta?1:a.WindDelta:a.WindCnt=0===a.WindDelta?0>b.WindCnt?b.WindCnt-1:b.WindCnt+1:0>b.WindDelta*a.WindDelta?b.WindCnt:b.WindCnt+a.WindDelta;
a.WindCnt2=b.WindCnt2;b=b.NextInAEL}if(this.IsEvenOddAltFillType(a))for(;b!=a;)0!==b.WindDelta&&(a.WindCnt2=0===a.WindCnt2?1:0),b=b.NextInAEL;else for(;b!=a;)a.WindCnt2+=b.WindDelta,b=b.NextInAEL};r.Clipper.prototype.AddEdgeToSEL=function(a){null===this.m_SortedEdges?(this.m_SortedEdges=a,a.PrevInSEL=null,a.NextInSEL=null):(a.NextInSEL=this.m_SortedEdges,a.PrevInSEL=null,this.m_SortedEdges=this.m_SortedEdges.PrevInSEL=a)};r.Clipper.prototype.CopyAELToSEL=function(){var a=this.m_ActiveEdges;for(this.m_SortedEdges=
a;null!==a;)a.PrevInSEL=a.PrevInAEL,a=a.NextInSEL=a.NextInAEL};r.Clipper.prototype.SwapPositionsInAEL=function(a,b){if(a.NextInAEL!=a.PrevInAEL&&b.NextInAEL!=b.PrevInAEL){if(a.NextInAEL==b){var d=b.NextInAEL;null!==d&&(d.PrevInAEL=a);var e=a.PrevInAEL;null!==e&&(e.NextInAEL=b);b.PrevInAEL=e;b.NextInAEL=a;a.PrevInAEL=b;a.NextInAEL=d}else b.NextInAEL==a?(d=a.NextInAEL,null!==d&&(d.PrevInAEL=b),e=b.PrevInAEL,null!==e&&(e.NextInAEL=a),a.PrevInAEL=e,a.NextInAEL=b,b.PrevInAEL=a,b.NextInAEL=d):(d=a.NextInAEL,
e=a.PrevInAEL,a.NextInAEL=b.NextInAEL,null!==a.NextInAEL&&(a.NextInAEL.PrevInAEL=a),a.PrevInAEL=b.PrevInAEL,null!==a.PrevInAEL&&(a.PrevInAEL.NextInAEL=a),b.NextInAEL=d,null!==b.NextInAEL&&(b.NextInAEL.PrevInAEL=b),b.PrevInAEL=e,null!==b.PrevInAEL&&(b.PrevInAEL.NextInAEL=b));null===a.PrevInAEL?this.m_ActiveEdges=a:null===b.PrevInAEL&&(this.m_ActiveEdges=b)}};r.Clipper.prototype.SwapPositionsInSEL=function(a,b){if(null!==a.NextInSEL||null!==a.PrevInSEL)if(null!==b.NextInSEL||null!==b.PrevInSEL){if(a.NextInSEL==
b){var d=b.NextInSEL;null!==d&&(d.PrevInSEL=a);var e=a.PrevInSEL;null!==e&&(e.NextInSEL=b);b.PrevInSEL=e;b.NextInSEL=a;a.PrevInSEL=b;a.NextInSEL=d}else b.NextInSEL==a?(d=a.NextInSEL,null!==d&&(d.PrevInSEL=b),e=b.PrevInSEL,null!==e&&(e.NextInSEL=a),a.PrevInSEL=e,a.NextInSEL=b,b.PrevInSEL=a,b.NextInSEL=d):(d=a.NextInSEL,e=a.PrevInSEL,a.NextInSEL=b.NextInSEL,null!==a.NextInSEL&&(a.NextInSEL.PrevInSEL=a),a.PrevInSEL=b.PrevInSEL,null!==a.PrevInSEL&&(a.PrevInSEL.NextInSEL=a),b.NextInSEL=d,null!==b.NextInSEL&&
(b.NextInSEL.PrevInSEL=b),b.PrevInSEL=e,null!==b.PrevInSEL&&(b.PrevInSEL.NextInSEL=b));null===a.PrevInSEL?this.m_SortedEdges=a:null===b.PrevInSEL&&(this.m_SortedEdges=b)}};r.Clipper.prototype.AddLocalMaxPoly=function(a,b,d){this.AddOutPt(a,d);0==b.WindDelta&&this.AddOutPt(b,d);a.OutIdx==b.OutIdx?(a.OutIdx=-1,b.OutIdx=-1):a.OutIdx<b.OutIdx?this.AppendPolygon(a,b):this.AppendPolygon(b,a)};r.Clipper.prototype.AddLocalMinPoly=function(a,b,d){var e,f;r.ClipperBase.IsHorizontal(b)||a.Dx>b.Dx?(e=this.AddOutPt(a,
d),b.OutIdx=a.OutIdx,a.Side=r.EdgeSide.esLeft,b.Side=r.EdgeSide.esRight,f=a,a=f.PrevInAEL==b?b.PrevInAEL:f.PrevInAEL):(e=this.AddOutPt(b,d),a.OutIdx=b.OutIdx,a.Side=r.EdgeSide.esRight,b.Side=r.EdgeSide.esLeft,f=b,a=f.PrevInAEL==a?a.PrevInAEL:f.PrevInAEL);null!==a&&0<=a.OutIdx&&r.Clipper.TopX(a,d.y)==r.Clipper.TopX(f,d.y)&&r.ClipperBase.SlopesEqual(f,a,this.m_UseFullRange)&&0!==f.WindDelta&&0!==a.WindDelta&&(d=this.AddOutPt(a,d),this.AddJoin(e,d,f.Top));return e};r.Clipper.prototype.CreateOutRec=function(){var a=
new r.OutRec;a.Idx=-1;a.IsHole=!1;a.IsOpen=!1;a.FirstLeft=null;a.Pts=null;a.BottomPt=null;a.PolyNode=null;this.m_PolyOuts.push(a);a.Idx=this.m_PolyOuts.length-1;return a};r.Clipper.prototype.AddOutPt=function(a,b){var d=a.Side==r.EdgeSide.esLeft;if(0>a.OutIdx){var e=this.CreateOutRec();e.IsOpen=0===a.WindDelta;var f=new r.OutPt;e.Pts=f;f.Idx=e.Idx;f.Pt.x=b.x;f.Pt.y=b.y;f.Next=f;f.Prev=f;e.IsOpen||this.SetHoleState(a,e);a.OutIdx=e.Idx}else{var e=this.m_PolyOuts[a.OutIdx],g=e.Pts;if(d&&r.IntPoint.op_Equality(b,
g.Pt))return g;if(!d&&r.IntPoint.op_Equality(b,g.Prev.Pt))return g.Prev;f=new r.OutPt;f.Idx=e.Idx;f.Pt.x=b.x;f.Pt.y=b.y;f.Next=g;f.Prev=g.Prev;f.Prev.Next=f;g.Prev=f;d&&(e.Pts=f)}return f};r.Clipper.prototype.SwapPoints=function(a,b){var d=new r.IntPoint(a.Value);a.Value.x=b.Value.x;a.Value.y=b.Value.y;b.Value.x=d.x;b.Value.y=d.y};r.Clipper.prototype.HorzSegmentsOverlap=function(a,b,d,e){return a.x>d.x==a.x<e.x?!0:b.x>d.x==b.x<e.x?!0:d.x>a.x==d.x<b.x?!0:e.x>a.x==e.x<b.x?!0:a.x==d.x&&b.x==e.x?!0:a.x==
e.x&&b.x==d.x?!0:!1};r.Clipper.prototype.InsertPolyPtBetween=function(a,b,d){var e=new r.OutPt;e.Pt.x=d.x;e.Pt.y=d.y;b==a.Next?(a.Next=e,b.Prev=e,e.Next=b,e.Prev=a):(b.Next=e,a.Prev=e,e.Next=a,e.Prev=b);return e};r.Clipper.prototype.SetHoleState=function(a,b){for(var d=!1,e=a.PrevInAEL;null!==e;)0<=e.OutIdx&&0!=e.WindDelta&&(d=!d,null===b.FirstLeft&&(b.FirstLeft=this.m_PolyOuts[e.OutIdx])),e=e.PrevInAEL;d&&(b.IsHole=!0)};r.Clipper.prototype.GetDx=function(a,b){return a.y==b.y?r.ClipperBase.horizontal:
(b.x-a.x)/(b.y-a.y)};r.Clipper.prototype.FirstIsBottomPt=function(a,b){for(var d=a.Prev;r.IntPoint.op_Equality(d.Pt,a.Pt)&&d!=a;)d=d.Prev;for(var e=Math.abs(this.GetDx(a.Pt,d.Pt)),d=a.Next;r.IntPoint.op_Equality(d.Pt,a.Pt)&&d!=a;)d=d.Next;for(var f=Math.abs(this.GetDx(a.Pt,d.Pt)),d=b.Prev;r.IntPoint.op_Equality(d.Pt,b.Pt)&&d!=b;)d=d.Prev;for(var g=Math.abs(this.GetDx(b.Pt,d.Pt)),d=b.Next;r.IntPoint.op_Equality(d.Pt,b.Pt)&&d!=b;)d=d.Next;d=Math.abs(this.GetDx(b.Pt,d.Pt));return e>=g&&e>=d||f>=g&&f>=
d};r.Clipper.prototype.GetBottomPt=function(a){for(var b=null,d=a.Next;d!=a;)d.Pt.y>a.Pt.y?(a=d,b=null):d.Pt.y==a.Pt.y&&d.Pt.x<=a.Pt.x&&(d.Pt.x<a.Pt.x?(b=null,a=d):d.Next!=a&&d.Prev!=a&&(b=d)),d=d.Next;if(null!==b)for(;b!=d;)for(this.FirstIsBottomPt(d,b)||(a=b),b=b.Next;r.IntPoint.op_Inequality(b.Pt,a.Pt);)b=b.Next;return a};r.Clipper.prototype.GetLowermostRec=function(a,b){null===a.BottomPt&&(a.BottomPt=this.GetBottomPt(a.Pts));null===b.BottomPt&&(b.BottomPt=this.GetBottomPt(b.Pts));var d=a.BottomPt,
e=b.BottomPt;return d.Pt.y>e.Pt.y?a:d.Pt.y<e.Pt.y?b:d.Pt.x<e.Pt.x?a:d.Pt.x>e.Pt.x?b:d.Next==d?b:e.Next==e?a:this.FirstIsBottomPt(d,e)?a:b};r.Clipper.prototype.Param1RightOfParam2=function(a,b){do if(a=a.FirstLeft,a==b)return!0;while(null!==a);return!1};r.Clipper.prototype.GetOutRec=function(a){for(a=this.m_PolyOuts[a];a!=this.m_PolyOuts[a.Idx];)a=this.m_PolyOuts[a.Idx];return a};r.Clipper.prototype.AppendPolygon=function(a,b){var d=this.m_PolyOuts[a.OutIdx],e=this.m_PolyOuts[b.OutIdx],f;f=this.Param1RightOfParam2(d,
e)?e:this.Param1RightOfParam2(e,d)?d:this.GetLowermostRec(d,e);var g=d.Pts,k=g.Prev,m=e.Pts,n=m.Prev;a.Side==r.EdgeSide.esLeft?(b.Side==r.EdgeSide.esLeft?(this.ReversePolyPtLinks(m),m.Next=g,g.Prev=m,k.Next=n,n.Prev=k,d.Pts=n):(n.Next=g,g.Prev=n,m.Prev=k,k.Next=m,d.Pts=m),g=r.EdgeSide.esLeft):(b.Side==r.EdgeSide.esRight?(this.ReversePolyPtLinks(m),k.Next=n,n.Prev=k,m.Next=g,g.Prev=m):(k.Next=m,m.Prev=k,g.Prev=n,n.Next=g),g=r.EdgeSide.esRight);d.BottomPt=null;f==e&&(e.FirstLeft!=d&&(d.FirstLeft=e.FirstLeft),
d.IsHole=e.IsHole);e.Pts=null;e.BottomPt=null;e.FirstLeft=d;f=a.OutIdx;k=b.OutIdx;a.OutIdx=-1;b.OutIdx=-1;for(m=this.m_ActiveEdges;null!==m;){if(m.OutIdx==k){m.OutIdx=f;m.Side=g;break}m=m.NextInAEL}e.Idx=d.Idx};r.Clipper.prototype.ReversePolyPtLinks=function(a){if(null!==a){var b,d;b=a;do d=b.Next,b.Next=b.Prev,b=b.Prev=d;while(b!=a)}};r.Clipper.SwapSides=function(a,b){var d=a.Side;a.Side=b.Side;b.Side=d};r.Clipper.SwapPolyIndexes=function(a,b){var d=a.OutIdx;a.OutIdx=b.OutIdx;b.OutIdx=d};r.Clipper.prototype.IntersectEdges=
function(a,b,d,e){var f=!e&&null===a.NextInLML&&a.Top.x==d.x&&a.Top.y==d.y;e=!e&&null===b.NextInLML&&b.Top.x==d.x&&b.Top.y==d.y;var g=0<=a.OutIdx,k=0<=b.OutIdx;if(0===a.WindDelta||0===b.WindDelta)0===a.WindDelta&&0===b.WindDelta?(f||e)&&g&&k&&this.AddLocalMaxPoly(a,b,d):a.PolyTyp==b.PolyTyp&&a.WindDelta!=b.WindDelta&&this.m_ClipType==r.ClipType.ctUnion?0===a.WindDelta?k&&(this.AddOutPt(a,d),g&&(a.OutIdx=-1)):g&&(this.AddOutPt(b,d),k&&(b.OutIdx=-1)):a.PolyTyp!=b.PolyTyp&&(0!==a.WindDelta||1!=Math.abs(b.WindCnt)||
this.m_ClipType==r.ClipType.ctUnion&&0!==b.WindCnt2?0!==b.WindDelta||1!=Math.abs(a.WindCnt)||this.m_ClipType==r.ClipType.ctUnion&&0!==a.WindCnt2||(this.AddOutPt(b,d),k&&(b.OutIdx=-1)):(this.AddOutPt(a,d),g&&(a.OutIdx=-1))),f&&(0>a.OutIdx?this.DeleteFromAEL(a):r.Error("Error intersecting polylines")),e&&(0>b.OutIdx?this.DeleteFromAEL(b):r.Error("Error intersecting polylines"));else{if(a.PolyTyp==b.PolyTyp)if(this.IsEvenOddFillType(a)){var m=a.WindCnt;a.WindCnt=b.WindCnt;b.WindCnt=m}else a.WindCnt=
0===a.WindCnt+b.WindDelta?-a.WindCnt:a.WindCnt+b.WindDelta,b.WindCnt=0===b.WindCnt-a.WindDelta?-b.WindCnt:b.WindCnt-a.WindDelta;else this.IsEvenOddFillType(b)?a.WindCnt2=0===a.WindCnt2?1:0:a.WindCnt2+=b.WindDelta,this.IsEvenOddFillType(a)?b.WindCnt2=0===b.WindCnt2?1:0:b.WindCnt2-=a.WindDelta;var n,q,s;a.PolyTyp==r.PolyType.ptSubject?(n=this.m_SubjFillType,s=this.m_ClipFillType):(n=this.m_ClipFillType,s=this.m_SubjFillType);b.PolyTyp==r.PolyType.ptSubject?(q=this.m_SubjFillType,m=this.m_ClipFillType):
(q=this.m_ClipFillType,m=this.m_SubjFillType);switch(n){case r.PolyFillType.pftPositive:n=a.WindCnt;break;case r.PolyFillType.pftNegative:n=-a.WindCnt;break;default:n=Math.abs(a.WindCnt)}switch(q){case r.PolyFillType.pftPositive:q=b.WindCnt;break;case r.PolyFillType.pftNegative:q=-b.WindCnt;break;default:q=Math.abs(b.WindCnt)}if(g&&k)f||e||0!==n&&1!=n||0!==q&&1!=q||a.PolyTyp!=b.PolyTyp&&this.m_ClipType!=r.ClipType.ctXor?this.AddLocalMaxPoly(a,b,d):(this.AddOutPt(a,d),this.AddOutPt(b,d),r.Clipper.SwapSides(a,
b),r.Clipper.SwapPolyIndexes(a,b));else if(g){if(0===q||1==q)this.AddOutPt(a,d),r.Clipper.SwapSides(a,b),r.Clipper.SwapPolyIndexes(a,b)}else if(k){if(0===n||1==n)this.AddOutPt(b,d),r.Clipper.SwapSides(a,b),r.Clipper.SwapPolyIndexes(a,b)}else if(!(0!==n&&1!=n||0!==q&&1!=q||f||e)){switch(s){case r.PolyFillType.pftPositive:g=a.WindCnt2;break;case r.PolyFillType.pftNegative:g=-a.WindCnt2;break;default:g=Math.abs(a.WindCnt2)}switch(m){case r.PolyFillType.pftPositive:k=b.WindCnt2;break;case r.PolyFillType.pftNegative:k=
-b.WindCnt2;break;default:k=Math.abs(b.WindCnt2)}if(a.PolyTyp!=b.PolyTyp)this.AddLocalMinPoly(a,b,d);else if(1==n&&1==q)switch(this.m_ClipType){case r.ClipType.ctIntersection:0<g&&0<k&&this.AddLocalMinPoly(a,b,d);break;case r.ClipType.ctUnion:0>=g&&0>=k&&this.AddLocalMinPoly(a,b,d);break;case r.ClipType.ctDifference:(a.PolyTyp==r.PolyType.ptClip&&0<g&&0<k||a.PolyTyp==r.PolyType.ptSubject&&0>=g&&0>=k)&&this.AddLocalMinPoly(a,b,d);break;case r.ClipType.ctXor:this.AddLocalMinPoly(a,b,d)}else r.Clipper.SwapSides(a,
b)}f!=e&&(f&&0<=a.OutIdx||e&&0<=b.OutIdx)&&(r.Clipper.SwapSides(a,b),r.Clipper.SwapPolyIndexes(a,b));f&&this.DeleteFromAEL(a);e&&this.DeleteFromAEL(b)}};r.Clipper.prototype.DeleteFromAEL=function(a){var b=a.PrevInAEL,d=a.NextInAEL;if(null!==b||null!==d||a==this.m_ActiveEdges)null!==b?b.NextInAEL=d:this.m_ActiveEdges=d,null!==d&&(d.PrevInAEL=b),a.NextInAEL=null,a.PrevInAEL=null};r.Clipper.prototype.DeleteFromSEL=function(a){var b=a.PrevInSEL,d=a.NextInSEL;if(null!==b||null!==d||a==this.m_SortedEdges)null!==
b?b.NextInSEL=d:this.m_SortedEdges=d,null!==d&&(d.PrevInSEL=b),a.NextInSEL=null,a.PrevInSEL=null};r.Clipper.prototype.UpdateEdgeIntoAEL=function(a){null===a.NextInLML&&r.Error("UpdateEdgeIntoAEL: invalid call");var b=a.PrevInAEL,d=a.NextInAEL;a.NextInLML.OutIdx=a.OutIdx;null!==b?b.NextInAEL=a.NextInLML:this.m_ActiveEdges=a.NextInLML;null!==d&&(d.PrevInAEL=a.NextInLML);a.NextInLML.Side=a.Side;a.NextInLML.WindDelta=a.WindDelta;a.NextInLML.WindCnt=a.WindCnt;a.NextInLML.WindCnt2=a.WindCnt2;a=a.NextInLML;
a.Curr.x=a.Bot.x;a.Curr.y=a.Bot.y;a.PrevInAEL=b;a.NextInAEL=d;r.ClipperBase.IsHorizontal(a)||this.InsertScanbeam(a.Top.y);return a};r.Clipper.prototype.ProcessHorizontals=function(a){for(var b=this.m_SortedEdges;null!==b;)this.DeleteFromSEL(b),this.ProcessHorizontal(b,a),b=this.m_SortedEdges};r.Clipper.prototype.GetHorzDirection=function(a,b){a.Bot.x<a.Top.x?(b.Left=a.Bot.x,b.Right=a.Top.x,b.Dir=r.Direction.dLeftToRight):(b.Left=a.Top.x,b.Right=a.Bot.x,b.Dir=r.Direction.dRightToLeft)};r.Clipper.prototype.PrepareHorzJoins=
function(a,b){var d=this.m_PolyOuts[a.OutIdx].Pts;a.Side!=r.EdgeSide.esLeft&&(d=d.Prev);b&&(r.IntPoint.op_Equality(d.Pt,a.Top)?this.AddGhostJoin(d,a.Bot):this.AddGhostJoin(d,a.Top))};r.Clipper.prototype.ProcessHorizontal=function(a,b){var d={Dir:null,Left:null,Right:null};this.GetHorzDirection(a,d);for(var e=d.Dir,f=d.Left,g=d.Right,k=a,m=null;null!==k.NextInLML&&r.ClipperBase.IsHorizontal(k.NextInLML);)k=k.NextInLML;for(null===k.NextInLML&&(m=this.GetMaximaPair(k));;){for(var n=a==k,q=this.GetNextInAEL(a,
e);null!==q&&!(q.Curr.x==a.Top.x&&null!==a.NextInLML&&q.Dx<a.NextInLML.Dx);){d=this.GetNextInAEL(q,e);if(e==r.Direction.dLeftToRight&&q.Curr.x<=g||e==r.Direction.dRightToLeft&&q.Curr.x>=f){0<=a.OutIdx&&0!=a.WindDelta&&this.PrepareHorzJoins(a,b);if(q==m&&n){e==r.Direction.dLeftToRight?this.IntersectEdges(a,q,q.Top,!1):this.IntersectEdges(q,a,q.Top,!1);0<=m.OutIdx&&r.Error("ProcessHorizontal error");return}if(e==r.Direction.dLeftToRight){var s=new r.IntPoint(q.Curr.x,a.Curr.y);this.IntersectEdges(a,
q,s,!0)}else s=new r.IntPoint(q.Curr.x,a.Curr.y),this.IntersectEdges(q,a,s,!0);this.SwapPositionsInAEL(a,q)}else if(e==r.Direction.dLeftToRight&&q.Curr.x>=g||e==r.Direction.dRightToLeft&&q.Curr.x<=f)break;q=d}0<=a.OutIdx&&0!==a.WindDelta&&this.PrepareHorzJoins(a,b);if(null!==a.NextInLML&&r.ClipperBase.IsHorizontal(a.NextInLML))a=this.UpdateEdgeIntoAEL(a),0<=a.OutIdx&&this.AddOutPt(a,a.Bot),d={Dir:e,Left:f,Right:g},this.GetHorzDirection(a,d),e=d.Dir,f=d.Left,g=d.Right;else break}null!==a.NextInLML?
0<=a.OutIdx?(e=this.AddOutPt(a,a.Top),a=this.UpdateEdgeIntoAEL(a),0!==a.WindDelta&&(f=a.PrevInAEL,d=a.NextInAEL,null!==f&&f.Curr.x==a.Bot.x&&f.Curr.y==a.Bot.y&&0!==f.WindDelta&&0<=f.OutIdx&&f.Curr.y>f.Top.y&&r.ClipperBase.SlopesEqual(a,f,this.m_UseFullRange)?(d=this.AddOutPt(f,a.Bot),this.AddJoin(e,d,a.Top)):null!==d&&d.Curr.x==a.Bot.x&&d.Curr.y==a.Bot.y&&0!==d.WindDelta&&0<=d.OutIdx&&d.Curr.y>d.Top.y&&r.ClipperBase.SlopesEqual(a,d,this.m_UseFullRange)&&(d=this.AddOutPt(d,a.Bot),this.AddJoin(e,d,
a.Top)))):this.UpdateEdgeIntoAEL(a):null!==m?0<=m.OutIdx?(e==r.Direction.dLeftToRight?this.IntersectEdges(a,m,a.Top,!1):this.IntersectEdges(m,a,a.Top,!1),0<=m.OutIdx&&r.Error("ProcessHorizontal error")):(this.DeleteFromAEL(a),this.DeleteFromAEL(m)):(0<=a.OutIdx&&this.AddOutPt(a,a.Top),this.DeleteFromAEL(a))};r.Clipper.prototype.GetNextInAEL=function(a,b){return b==r.Direction.dLeftToRight?a.NextInAEL:a.PrevInAEL};r.Clipper.prototype.IsMinima=function(a){return null!==a&&a.Prev.NextInLML!=a&&a.Next.NextInLML!=
a};r.Clipper.prototype.IsMaxima=function(a,b){return null!==a&&a.Top.y==b&&null===a.NextInLML};r.Clipper.prototype.IsIntermediate=function(a,b){return a.Top.y==b&&null!==a.NextInLML};r.Clipper.prototype.GetMaximaPair=function(a){var b=null;r.IntPoint.op_Equality(a.Next.Top,a.Top)&&null===a.Next.NextInLML?b=a.Next:r.IntPoint.op_Equality(a.Prev.Top,a.Top)&&null===a.Prev.NextInLML&&(b=a.Prev);return null===b||-2!=b.OutIdx&&(b.NextInAEL!=b.PrevInAEL||r.ClipperBase.IsHorizontal(b))?b:null};r.Clipper.prototype.ProcessIntersections=
function(a,b){if(null==this.m_ActiveEdges)return!0;try{this.BuildIntersectList(a,b);if(0==this.m_IntersectList.length)return!0;if(1==this.m_IntersectList.length||this.FixupIntersectionOrder())this.ProcessIntersectList();else return!1}catch(d){this.m_SortedEdges=null,this.m_IntersectList.length=0,r.Error("ProcessIntersections error")}this.m_SortedEdges=null;return!0};r.Clipper.prototype.BuildIntersectList=function(a,b){if(null!==this.m_ActiveEdges){var d=this.m_ActiveEdges;for(this.m_SortedEdges=d;null!==
d;)d.PrevInSEL=d.PrevInAEL,d.NextInSEL=d.NextInAEL,d.Curr.x=r.Clipper.TopX(d,b),d=d.NextInAEL;for(var e=!0;e&&null!==this.m_SortedEdges;){e=!1;for(d=this.m_SortedEdges;null!==d.NextInSEL;){var f=d.NextInSEL,g=new r.IntPoint;d.Curr.x>f.Curr.x?(!this.IntersectPoint(d,f,g)&&d.Curr.x>f.Curr.x+1&&r.Error("Intersection error"),g.y>a&&(g.y=a,Math.abs(d.Dx)>Math.abs(f.Dx)?g.x=r.Clipper.TopX(f,a):g.x=r.Clipper.TopX(d,a)),e=new r.IntersectNode,e.Edge1=d,e.Edge2=f,e.Pt.x=g.x,e.Pt.y=g.y,this.m_IntersectList.push(e),
this.SwapPositionsInSEL(d,f),e=!0):d=f}if(null!==d.PrevInSEL)d.PrevInSEL.NextInSEL=null;else break}this.m_SortedEdges=null}};r.Clipper.prototype.EdgesAdjacent=function(a){return a.Edge1.NextInSEL==a.Edge2||a.Edge1.PrevInSEL==a.Edge2};r.Clipper.IntersectNodeSort=function(a,b){return b.Pt.y-a.Pt.y};r.Clipper.prototype.FixupIntersectionOrder=function(){this.m_IntersectList.sort(this.m_IntersectNodeComparer);this.CopyAELToSEL();for(var a=this.m_IntersectList.length,b=0;b<a;b++){if(!this.EdgesAdjacent(this.m_IntersectList[b])){for(var d=
b+1;d<a&&!this.EdgesAdjacent(this.m_IntersectList[d]);)d++;if(d==a)return!1;var e=this.m_IntersectList[b];this.m_IntersectList[b]=this.m_IntersectList[d];this.m_IntersectList[d]=e}this.SwapPositionsInSEL(this.m_IntersectList[b].Edge1,this.m_IntersectList[b].Edge2)}return!0};r.Clipper.prototype.ProcessIntersectList=function(){for(var a=0,b=this.m_IntersectList.length;a<b;a++){var d=this.m_IntersectList[a];this.IntersectEdges(d.Edge1,d.Edge2,d.Pt,!0);this.SwapPositionsInAEL(d.Edge1,d.Edge2)}this.m_IntersectList.length=
0};F=function(a){return 0>a?Math.ceil(a-.5):Math.round(a)};L=function(a){return 0>a?Math.ceil(a-.5):Math.floor(a+.5)};G=function(a){return 0>a?-Math.round(Math.abs(a)):Math.round(a)};K=function(a){if(0>a)return a-=.5,-2147483648>a?Math.ceil(a):a|0;a+=.5;return 2147483647<a?Math.floor(a):a|0};r.Clipper.Round=R?F:D?G:J?K:L;r.Clipper.TopX=function(a,b){return b==a.Top.y?a.Top.x:a.Bot.x+r.Clipper.Round(a.Dx*(b-a.Bot.y))};r.Clipper.prototype.IntersectPoint=function(a,b,d){d.x=0;d.y=0;var e,f;if(r.ClipperBase.SlopesEqual(a,
b,this.m_UseFullRange)||a.Dx==b.Dx)return b.Bot.y>a.Bot.y?(d.x=b.Bot.x,d.y=b.Bot.y):(d.x=a.Bot.x,d.y=a.Bot.y),!1;if(0===a.Delta.x)d.x=a.Bot.x,r.ClipperBase.IsHorizontal(b)?d.y=b.Bot.y:(f=b.Bot.y-b.Bot.x/b.Dx,d.y=r.Clipper.Round(d.x/b.Dx+f));else if(0===b.Delta.x)d.x=b.Bot.x,r.ClipperBase.IsHorizontal(a)?d.y=a.Bot.y:(e=a.Bot.y-a.Bot.x/a.Dx,d.y=r.Clipper.Round(d.x/a.Dx+e));else{e=a.Bot.x-a.Bot.y*a.Dx;f=b.Bot.x-b.Bot.y*b.Dx;var g=(f-e)/(a.Dx-b.Dx);d.y=r.Clipper.Round(g);Math.abs(a.Dx)<Math.abs(b.Dx)?
d.x=r.Clipper.Round(a.Dx*g+e):d.x=r.Clipper.Round(b.Dx*g+f)}if(d.y<a.Top.y||d.y<b.Top.y){if(a.Top.y>b.Top.y)return d.y=a.Top.y,d.x=r.Clipper.TopX(b,a.Top.y),d.x<a.Top.x;d.y=b.Top.y;Math.abs(a.Dx)<Math.abs(b.Dx)?d.x=r.Clipper.TopX(a,d.y):d.x=r.Clipper.TopX(b,d.y)}return!0};r.Clipper.prototype.ProcessEdgesAtTopOfScanbeam=function(a){for(var b=this.m_ActiveEdges;null!==b;){var d=this.IsMaxima(b,a);d&&(d=this.GetMaximaPair(b),d=null===d||!r.ClipperBase.IsHorizontal(d));if(d){var e=b.PrevInAEL;this.DoMaxima(b);
b=null===e?this.m_ActiveEdges:e.NextInAEL}else this.IsIntermediate(b,a)&&r.ClipperBase.IsHorizontal(b.NextInLML)?(b=this.UpdateEdgeIntoAEL(b),0<=b.OutIdx&&this.AddOutPt(b,b.Bot),this.AddEdgeToSEL(b)):(b.Curr.x=r.Clipper.TopX(b,a),b.Curr.y=a),this.StrictlySimple&&(e=b.PrevInAEL,0<=b.OutIdx&&0!==b.WindDelta&&null!==e&&0<=e.OutIdx&&e.Curr.x==b.Curr.x&&0!==e.WindDelta&&(d=this.AddOutPt(e,b.Curr),e=this.AddOutPt(b,b.Curr),this.AddJoin(d,e,b.Curr))),b=b.NextInAEL}this.ProcessHorizontals(!0);for(b=this.m_ActiveEdges;null!==
b;){if(this.IsIntermediate(b,a)){d=null;0<=b.OutIdx&&(d=this.AddOutPt(b,b.Top));var b=this.UpdateEdgeIntoAEL(b),e=b.PrevInAEL,f=b.NextInAEL;null!==e&&e.Curr.x==b.Bot.x&&e.Curr.y==b.Bot.y&&null!==d&&0<=e.OutIdx&&e.Curr.y>e.Top.y&&r.ClipperBase.SlopesEqual(b,e,this.m_UseFullRange)&&0!==b.WindDelta&&0!==e.WindDelta?(e=this.AddOutPt(e,b.Bot),this.AddJoin(d,e,b.Top)):null!==f&&f.Curr.x==b.Bot.x&&f.Curr.y==b.Bot.y&&null!==d&&0<=f.OutIdx&&f.Curr.y>f.Top.y&&r.ClipperBase.SlopesEqual(b,f,this.m_UseFullRange)&&
0!==b.WindDelta&&0!==f.WindDelta&&(e=this.AddOutPt(f,b.Bot),this.AddJoin(d,e,b.Top))}b=b.NextInAEL}};r.Clipper.prototype.DoMaxima=function(a){var b=this.GetMaximaPair(a);if(null===b)0<=a.OutIdx&&this.AddOutPt(a,a.Top),this.DeleteFromAEL(a);else{for(var d=a.NextInAEL;null!==d&&d!=b;)this.IntersectEdges(a,d,a.Top,!0),this.SwapPositionsInAEL(a,d),d=a.NextInAEL;-1==a.OutIdx&&-1==b.OutIdx?(this.DeleteFromAEL(a),this.DeleteFromAEL(b)):0<=a.OutIdx&&0<=b.OutIdx?this.IntersectEdges(a,b,a.Top,!1):0===a.WindDelta?
(0<=a.OutIdx&&(this.AddOutPt(a,a.Top),a.OutIdx=-1),this.DeleteFromAEL(a),0<=b.OutIdx&&(this.AddOutPt(b,a.Top),b.OutIdx=-1),this.DeleteFromAEL(b)):r.Error("DoMaxima error")}};r.Clipper.ReversePaths=function(a){for(var b=0,d=a.length;b<d;b++)a[b].reverse()};r.Clipper.Orientation=function(a){return 0<=r.Clipper.Area(a)};r.Clipper.prototype.PointCount=function(a){if(null===a)return 0;var b=0,d=a;do b++,d=d.Next;while(d!=a);return b};r.Clipper.prototype.BuildResult=function(a){r.Clear(a);for(var b=0,d=
this.m_PolyOuts.length;b<d;b++){var e=this.m_PolyOuts[b];if(null!==e.Pts){var e=e.Pts.Prev,f=this.PointCount(e);if(!(2>f)){for(var g=Array(f),k=0;k<f;k++)g[k]=e.Pt,e=e.Prev;a.push(g)}}}};r.Clipper.prototype.BuildResult2=function(a){a.Clear();for(var b=0,d=this.m_PolyOuts.length;b<d;b++){var e=this.m_PolyOuts[b],f=this.PointCount(e.Pts);if(!(e.IsOpen&&2>f||!e.IsOpen&&3>f)){this.FixHoleLinkage(e);var g=new r.PolyNode;a.m_AllPolys.push(g);e.PolyNode=g;g.m_polygon.length=f;for(var e=e.Pts.Prev,k=0;k<
f;k++)g.m_polygon[k]=e.Pt,e=e.Prev}}b=0;for(d=this.m_PolyOuts.length;b<d;b++)e=this.m_PolyOuts[b],null!==e.PolyNode&&(e.IsOpen?(e.PolyNode.IsOpen=!0,a.AddChild(e.PolyNode)):null!==e.FirstLeft&&null!=e.FirstLeft.PolyNode?e.FirstLeft.PolyNode.AddChild(e.PolyNode):a.AddChild(e.PolyNode))};r.Clipper.prototype.FixupOutPolygon=function(a){var b=null;a.BottomPt=null;for(var d=a.Pts;;){if(d.Prev==d||d.Prev==d.Next){this.DisposeOutPts(d);a.Pts=null;return}if(r.IntPoint.op_Equality(d.Pt,d.Next.Pt)||r.IntPoint.op_Equality(d.Pt,
d.Prev.Pt)||r.ClipperBase.SlopesEqual(d.Prev.Pt,d.Pt,d.Next.Pt,this.m_UseFullRange)&&(!this.PreserveCollinear||!this.Pt2IsBetweenPt1AndPt3(d.Prev.Pt,d.Pt,d.Next.Pt)))b=null,d.Prev.Next=d.Next,d=d.Next.Prev=d.Prev;else if(d==b)break;else null===b&&(b=d),d=d.Next}a.Pts=d};r.Clipper.prototype.DupOutPt=function(a,b){var d=new r.OutPt;d.Pt.x=a.Pt.x;d.Pt.y=a.Pt.y;d.Idx=a.Idx;b?(d.Next=a.Next,d.Prev=a,a.Next.Prev=d,a.Next=d):(d.Prev=a.Prev,d.Next=a,a.Prev.Next=d,a.Prev=d);return d};r.Clipper.prototype.GetOverlap=
function(a,b,d,e,f){a<b?d<e?(f.Left=Math.max(a,d),f.Right=Math.min(b,e)):(f.Left=Math.max(a,e),f.Right=Math.min(b,d)):d<e?(f.Left=Math.max(b,d),f.Right=Math.min(a,e)):(f.Left=Math.max(b,e),f.Right=Math.min(a,d));return f.Left<f.Right};r.Clipper.prototype.JoinHorz=function(a,b,d,e,f,g){var k=a.Pt.x>b.Pt.x?r.Direction.dRightToLeft:r.Direction.dLeftToRight;e=d.Pt.x>e.Pt.x?r.Direction.dRightToLeft:r.Direction.dLeftToRight;if(k==e)return!1;if(k==r.Direction.dLeftToRight){for(;a.Next.Pt.x<=f.x&&a.Next.Pt.x>=
a.Pt.x&&a.Next.Pt.y==f.y;)a=a.Next;g&&a.Pt.x!=f.x&&(a=a.Next);b=this.DupOutPt(a,!g);r.IntPoint.op_Inequality(b.Pt,f)&&(a=b,a.Pt.x=f.x,a.Pt.y=f.y,b=this.DupOutPt(a,!g))}else{for(;a.Next.Pt.x>=f.x&&a.Next.Pt.x<=a.Pt.x&&a.Next.Pt.y==f.y;)a=a.Next;g||a.Pt.x==f.x||(a=a.Next);b=this.DupOutPt(a,g);r.IntPoint.op_Inequality(b.Pt,f)&&(a=b,a.Pt.x=f.x,a.Pt.y=f.y,b=this.DupOutPt(a,g))}if(e==r.Direction.dLeftToRight){for(;d.Next.Pt.x<=f.x&&d.Next.Pt.x>=d.Pt.x&&d.Next.Pt.y==f.y;)d=d.Next;g&&d.Pt.x!=f.x&&(d=d.Next);
e=this.DupOutPt(d,!g);r.IntPoint.op_Inequality(e.Pt,f)&&(d=e,d.Pt.x=f.x,d.Pt.y=f.y,e=this.DupOutPt(d,!g))}else{for(;d.Next.Pt.x>=f.x&&d.Next.Pt.x<=d.Pt.x&&d.Next.Pt.y==f.y;)d=d.Next;g||d.Pt.x==f.x||(d=d.Next);e=this.DupOutPt(d,g);r.IntPoint.op_Inequality(e.Pt,f)&&(d=e,d.Pt.x=f.x,d.Pt.y=f.y,e=this.DupOutPt(d,g))}k==r.Direction.dLeftToRight==g?(a.Prev=d,d.Next=a,b.Next=e,e.Prev=b):(a.Next=d,d.Prev=a,b.Prev=e,e.Next=b);return!0};r.Clipper.prototype.JoinPoints=function(a,b,d){var e=a.OutPt1,f=new r.OutPt,
g=a.OutPt2,k=new r.OutPt;if((k=a.OutPt1.Pt.y==a.OffPt.y)&&r.IntPoint.op_Equality(a.OffPt,a.OutPt1.Pt)&&r.IntPoint.op_Equality(a.OffPt,a.OutPt2.Pt)){for(f=a.OutPt1.Next;f!=e&&r.IntPoint.op_Equality(f.Pt,a.OffPt);)f=f.Next;f=f.Pt.y>a.OffPt.y;for(k=a.OutPt2.Next;k!=g&&r.IntPoint.op_Equality(k.Pt,a.OffPt);)k=k.Next;if(f==k.Pt.y>a.OffPt.y)return!1;f?(f=this.DupOutPt(e,!1),k=this.DupOutPt(g,!0),e.Prev=g,g.Next=e,f.Next=k,k.Prev=f):(f=this.DupOutPt(e,!0),k=this.DupOutPt(g,!1),e.Next=g,g.Prev=e,f.Prev=k,
k.Next=f);a.OutPt1=e;a.OutPt2=f;return!0}if(k){for(f=e;e.Prev.Pt.y==e.Pt.y&&e.Prev!=f&&e.Prev!=g;)e=e.Prev;for(;f.Next.Pt.y==f.Pt.y&&f.Next!=e&&f.Next!=g;)f=f.Next;if(f.Next==e||f.Next==g)return!1;for(k=g;g.Prev.Pt.y==g.Pt.y&&g.Prev!=k&&g.Prev!=f;)g=g.Prev;for(;k.Next.Pt.y==k.Pt.y&&k.Next!=g&&k.Next!=e;)k=k.Next;if(k.Next==g||k.Next==e)return!1;d={Left:null,Right:null};if(!this.GetOverlap(e.Pt.x,f.Pt.x,g.Pt.x,k.Pt.x,d))return!1;b=d.Left;var m=d.Right;d=new r.IntPoint;e.Pt.x>=b&&e.Pt.x<=m?(d.x=e.Pt.x,
d.y=e.Pt.y,b=e.Pt.x>f.Pt.x):g.Pt.x>=b&&g.Pt.x<=m?(d.x=g.Pt.x,d.y=g.Pt.y,b=g.Pt.x>k.Pt.x):f.Pt.x>=b&&f.Pt.x<=m?(d.x=f.Pt.x,d.y=f.Pt.y,b=f.Pt.x>e.Pt.x):(d.x=k.Pt.x,d.y=k.Pt.y,b=k.Pt.x>g.Pt.x);a.OutPt1=e;a.OutPt2=g;return this.JoinHorz(e,f,g,k,d,b)}for(f=e.Next;r.IntPoint.op_Equality(f.Pt,e.Pt)&&f!=e;)f=f.Next;if(m=f.Pt.y>e.Pt.y||!r.ClipperBase.SlopesEqual(e.Pt,f.Pt,a.OffPt,this.m_UseFullRange)){for(f=e.Prev;r.IntPoint.op_Equality(f.Pt,e.Pt)&&f!=e;)f=f.Prev;if(f.Pt.y>e.Pt.y||!r.ClipperBase.SlopesEqual(e.Pt,
f.Pt,a.OffPt,this.m_UseFullRange))return!1}for(k=g.Next;r.IntPoint.op_Equality(k.Pt,g.Pt)&&k!=g;)k=k.Next;var n=k.Pt.y>g.Pt.y||!r.ClipperBase.SlopesEqual(g.Pt,k.Pt,a.OffPt,this.m_UseFullRange);if(n){for(k=g.Prev;r.IntPoint.op_Equality(k.Pt,g.Pt)&&k!=g;)k=k.Prev;if(k.Pt.y>g.Pt.y||!r.ClipperBase.SlopesEqual(g.Pt,k.Pt,a.OffPt,this.m_UseFullRange))return!1}if(f==e||k==g||f==k||b==d&&m==n)return!1;m?(f=this.DupOutPt(e,!1),k=this.DupOutPt(g,!0),e.Prev=g,g.Next=e,f.Next=k,k.Prev=f):(f=this.DupOutPt(e,!0),
k=this.DupOutPt(g,!1),e.Next=g,g.Prev=e,f.Prev=k,k.Next=f);a.OutPt1=e;a.OutPt2=f;return!0};r.Clipper.GetBounds=function(a){for(var b=0,d=a.length;b<d&&0==a[b].length;)b++;if(b==d)return new r.IntRect(0,0,0,0);var e=new r.IntRect;e.left=a[b][0].x;e.right=e.left;e.top=a[b][0].y;for(e.bottom=e.top;b<d;b++)for(var f=0,g=a[b].length;f<g;f++)a[b][f].x<e.left?e.left=a[b][f].x:a[b][f].x>e.right&&(e.right=a[b][f].x),a[b][f].y<e.top?e.top=a[b][f].y:a[b][f].y>e.bottom&&(e.bottom=a[b][f].y);return e};r.Clipper.prototype.GetBounds2=
function(a){var b=a,d=new r.IntRect;d.left=a.Pt.x;d.right=a.Pt.x;d.top=a.Pt.y;d.bottom=a.Pt.y;for(a=a.Next;a!=b;)a.Pt.x<d.left&&(d.left=a.Pt.x),a.Pt.x>d.right&&(d.right=a.Pt.x),a.Pt.y<d.top&&(d.top=a.Pt.y),a.Pt.y>d.bottom&&(d.bottom=a.Pt.y),a=a.Next;return d};r.Clipper.PointInPolygon=function(a,b){var d=0,e=b.length;if(3>e)return 0;for(var f=b[0],g=1;g<=e;++g){var k=g==e?b[0]:b[g];if(k.y==a.y&&(k.x==a.x||f.y==a.y&&k.x>a.x==f.x<a.x))return-1;if(f.y<a.y!=k.y<a.y)if(f.x>=a.x)if(k.x>a.x)d=1-d;else{var m=
(f.x-a.x)*(k.y-a.y)-(k.x-a.x)*(f.y-a.y);if(0==m)return-1;0<m==k.y>f.y&&(d=1-d)}else if(k.x>a.x){m=(f.x-a.x)*(k.y-a.y)-(k.x-a.x)*(f.y-a.y);if(0==m)return-1;0<m==k.y>f.y&&(d=1-d)}f=k}return d};r.Clipper.prototype.PointInPolygon=function(a,b){for(var d=0,e=b;;){var f=b.Pt.x,g=b.Pt.y,k=b.Next.Pt.x,m=b.Next.Pt.y;if(m==a.y&&(k==a.x||g==a.y&&k>a.x==f<a.x))return-1;if(g<a.y!=m<a.y)if(f>=a.x)if(k>a.x)d=1-d;else{f=(f-a.x)*(m-a.y)-(k-a.x)*(g-a.y);if(0==f)return-1;0<f==m>g&&(d=1-d)}else if(k>a.x){f=(f-a.x)*(m-
a.y)-(k-a.x)*(g-a.y);if(0==f)return-1;0<f==m>g&&(d=1-d)}b=b.Next;if(e==b)break}return d};r.Clipper.prototype.Poly2ContainsPoly1=function(a,b){var d=a;do{var e=this.PointInPolygon(d.Pt,b);if(0<=e)return 0!=e;d=d.Next}while(d!=a);return!0};r.Clipper.prototype.FixupFirstLefts1=function(a,b){for(var d=0,e=this.m_PolyOuts.length;d<e;d++){var f=this.m_PolyOuts[d];null!==f.Pts&&f.FirstLeft==a&&this.Poly2ContainsPoly1(f.Pts,b.Pts)&&(f.FirstLeft=b)}};r.Clipper.prototype.FixupFirstLefts2=function(a,b){for(var d=
0,e=this.m_PolyOuts,f=e.length,g=e[d];d<f;d++,g=e[d])g.FirstLeft==a&&(g.FirstLeft=b)};r.Clipper.ParseFirstLeft=function(a){for(;null!=a&&null==a.Pts;)a=a.FirstLeft;return a};r.Clipper.prototype.JoinCommonEdges=function(){for(var a=0,b=this.m_Joins.length;a<b;a++){var d=this.m_Joins[a],e=this.GetOutRec(d.OutPt1.Idx),f=this.GetOutRec(d.OutPt2.Idx);if(null!=e.Pts&&null!=f.Pts){var g;g=e==f?e:this.Param1RightOfParam2(e,f)?f:this.Param1RightOfParam2(f,e)?e:this.GetLowermostRec(e,f);if(this.JoinPoints(d,
e,f))if(e==f){e.Pts=d.OutPt1;e.BottomPt=null;f=this.CreateOutRec();f.Pts=d.OutPt2;this.UpdateOutPtIdxs(f);if(this.m_UsingPolyTree){g=0;for(var k=this.m_PolyOuts.length;g<k-1;g++){var m=this.m_PolyOuts[g];null!=m.Pts&&r.Clipper.ParseFirstLeft(m.FirstLeft)==e&&m.IsHole!=e.IsHole&&this.Poly2ContainsPoly1(m.Pts,d.OutPt2)&&(m.FirstLeft=f)}}this.Poly2ContainsPoly1(f.Pts,e.Pts)?(f.IsHole=!e.IsHole,f.FirstLeft=e,this.m_UsingPolyTree&&this.FixupFirstLefts2(f,e),(f.IsHole^this.ReverseSolution)==0<this.Area(f)&&
this.ReversePolyPtLinks(f.Pts)):this.Poly2ContainsPoly1(e.Pts,f.Pts)?(f.IsHole=e.IsHole,e.IsHole=!f.IsHole,f.FirstLeft=e.FirstLeft,e.FirstLeft=f,this.m_UsingPolyTree&&this.FixupFirstLefts2(e,f),(e.IsHole^this.ReverseSolution)==0<this.Area(e)&&this.ReversePolyPtLinks(e.Pts)):(f.IsHole=e.IsHole,f.FirstLeft=e.FirstLeft,this.m_UsingPolyTree&&this.FixupFirstLefts1(e,f))}else f.Pts=null,f.BottomPt=null,f.Idx=e.Idx,e.IsHole=g.IsHole,g==f&&(e.FirstLeft=f.FirstLeft),f.FirstLeft=e,this.m_UsingPolyTree&&this.FixupFirstLefts2(f,
e)}}};r.Clipper.prototype.UpdateOutPtIdxs=function(a){var b=a.Pts;do b.Idx=a.Idx,b=b.Prev;while(b!=a.Pts)};r.Clipper.prototype.DoSimplePolygons=function(){for(var a=0;a<this.m_PolyOuts.length;){var b=this.m_PolyOuts[a++],d=b.Pts;if(null!==d){do{for(var e=d.Next;e!=b.Pts;){if(r.IntPoint.op_Equality(d.Pt,e.Pt)&&e.Next!=d&&e.Prev!=d){var f=d.Prev,g=e.Prev;d.Prev=g;g.Next=d;e.Prev=f;f.Next=e;b.Pts=d;f=this.CreateOutRec();f.Pts=e;this.UpdateOutPtIdxs(f);this.Poly2ContainsPoly1(f.Pts,b.Pts)?(f.IsHole=!b.IsHole,
f.FirstLeft=b):this.Poly2ContainsPoly1(b.Pts,f.Pts)?(f.IsHole=b.IsHole,b.IsHole=!f.IsHole,f.FirstLeft=b.FirstLeft,b.FirstLeft=f):(f.IsHole=b.IsHole,f.FirstLeft=b.FirstLeft);e=d}e=e.Next}d=d.Next}while(d!=b.Pts)}}};r.Clipper.Area=function(a){var b=a.length;if(3>b)return 0;for(var d=0,e=0,f=b-1;e<b;++e)d+=(a[f].x+a[e].x)*(a[f].y-a[e].y),f=e;return.5*-d};r.Clipper.prototype.Area=function(a){var b=a.Pts;if(null==b)return 0;var d=0;do d+=(b.Prev.Pt.x+b.Pt.x)*(b.Prev.Pt.y-b.Pt.y),b=b.Next;while(b!=a.Pts);
return.5*d};r.Clipper.SimplifyPolygon=function(a,b){var d=[],e=new r.Clipper(0);e.StrictlySimple=!0;e.AddPath(a,r.PolyType.ptSubject,!0);e.Execute(r.ClipType.ctUnion,d,b,b);return d};r.Clipper.SimplifyPolygons=function(a,b){"undefined"==typeof b&&(b=r.PolyFillType.pftEvenOdd);var d=[],e=new r.Clipper(0);e.StrictlySimple=!0;e.AddPaths(a,r.PolyType.ptSubject,!0);e.Execute(r.ClipType.ctUnion,d,b,b);return d};r.Clipper.DistanceSqrd=function(a,b){var d=a.x-b.x,e=a.y-b.y;return d*d+e*e};r.Clipper.DistanceFromLineSqrd=
function(a,b,d){var e=b.y-d.y;d=d.x-b.x;b=e*b.x+d*b.y;b=e*a.x+d*a.y-b;return b*b/(e*e+d*d)};r.Clipper.SlopesNearCollinear=function(a,b,d,e){return r.Clipper.DistanceFromLineSqrd(b,a,d)<e};r.Clipper.PointsAreClose=function(a,b,d){var e=a.x-b.x;a=a.y-b.y;return e*e+a*a<=d};r.Clipper.ExcludeOp=function(a){var b=a.Prev;b.Next=a.Next;a.Next.Prev=b;b.Idx=0;return b};r.Clipper.CleanPolygon=function(a,b){"undefined"==typeof b&&(b=1.415);var d=a.length;if(0==d)return[];for(var e=Array(d),f=0;f<d;++f)e[f]=
new r.OutPt;for(f=0;f<d;++f)e[f].Pt=a[f],e[f].Next=e[(f+1)%d],e[f].Next.Prev=e[f],e[f].Idx=0;f=b*b;for(e=e[0];0==e.Idx&&e.Next!=e.Prev;)r.Clipper.PointsAreClose(e.Pt,e.Prev.Pt,f)?(e=r.Clipper.ExcludeOp(e),d--):r.Clipper.PointsAreClose(e.Prev.Pt,e.Next.Pt,f)?(r.Clipper.ExcludeOp(e.Next),e=r.Clipper.ExcludeOp(e),d-=2):r.Clipper.SlopesNearCollinear(e.Prev.Pt,e.Pt,e.Next.Pt,f)?(e=r.Clipper.ExcludeOp(e),d--):(e.Idx=1,e=e.Next);3>d&&(d=0);for(var g=Array(d),f=0;f<d;++f)g[f]=new r.IntPoint(e.Pt),e=e.Next;
return g};r.Clipper.CleanPolygons=function(a,b){for(var d=Array(a.length),e=0,f=a.length;e<f;e++)d[e]=r.Clipper.CleanPolygon(a[e],b);return d};r.Clipper.Minkowski=function(a,b,d,e){var f=e?1:0,g=a.length,k=b.length;e=[];if(d)for(d=0;d<k;d++){for(var m=Array(g),n=0,q=a.length,s=a[n];n<q;n++,s=a[n])m[n]=new r.IntPoint(b[d].x+s.x,b[d].y+s.y);e.push(m)}else for(d=0;d<k;d++){m=Array(g);n=0;q=a.length;for(s=a[n];n<q;n++,s=a[n])m[n]=new r.IntPoint(b[d].x-s.x,b[d].y-s.y);e.push(m)}a=[];for(d=0;d<k-1+f;d++)for(n=
0;n<g;n++)b=[],b.push(e[d%k][n%g]),b.push(e[(d+1)%k][n%g]),b.push(e[(d+1)%k][(n+1)%g]),b.push(e[d%k][(n+1)%g]),r.Clipper.Orientation(b)||b.reverse(),a.push(b);f=new r.Clipper(0);f.AddPaths(a,r.PolyType.ptSubject,!0);f.Execute(r.ClipType.ctUnion,e,r.PolyFillType.pftNonZero,r.PolyFillType.pftNonZero);return e};r.Clipper.MinkowskiSum=function(){var a=arguments,b=a.length;if(3==b){var d=a[0],e=a[2];return r.Clipper.Minkowski(d,a[1],!0,e)}if(4==b){for(var d=a[0],f=a[1],b=a[2],e=a[3],a=new r.Clipper,g,
k=0,m=f.length;k<m;++k)g=r.Clipper.Minkowski(d,f[k],!0,e),a.AddPaths(g,r.PolyType.ptSubject,!0);e&&a.AddPaths(f,r.PolyType.ptClip,!0);d=new r.Paths;a.Execute(r.ClipType.ctUnion,d,b,b);return d}};r.Clipper.MinkowskiDiff=function(a,b,d){return r.Clipper.Minkowski(a,b,!1,d)};r.Clipper.PolyTreeToPaths=function(a){var b=[];r.Clipper.AddPolyNodeToPaths(a,r.Clipper.NodeType.ntAny,b);return b};r.Clipper.AddPolyNodeToPaths=function(a,b,d){var e=!0;switch(b){case r.Clipper.NodeType.ntOpen:return;case r.Clipper.NodeType.ntClosed:e=
!a.IsOpen}0<a.m_polygon.length&&e&&d.push(a.m_polygon);e=0;a=a.Childs();for(var f=a.length,g=a[e];e<f;e++,g=a[e])r.Clipper.AddPolyNodeToPaths(g,b,d)};r.Clipper.OpenPathsFromPolyTree=function(a){for(var b=new r.Paths,d=0,e=a.ChildCount();d<e;d++)a.Childs()[d].IsOpen&&b.push(a.Childs()[d].m_polygon);return b};r.Clipper.ClosedPathsFromPolyTree=function(a){var b=new r.Paths;r.Clipper.AddPolyNodeToPaths(a,r.Clipper.NodeType.ntClosed,b);return b};S(r.Clipper,r.ClipperBase);r.Clipper.NodeType={ntAny:0,ntOpen:1,
ntClosed:2};r.ClipperOffset=function(a,b){"undefined"==typeof a&&(a=2);"undefined"==typeof b&&(b=r.ClipperOffset.def_arc_tolerance);this.m_destPolys=new r.Paths;this.m_srcPoly=new r.Path;this.m_destPoly=new r.Path;this.m_normals=[];this.m_StepsPerRad=this.m_miterLim=this.m_cos=this.m_sin=this.m_sinA=this.m_delta=0;this.m_lowest=new r.IntPoint;this.m_polyNodes=new r.PolyNode;this.MiterLimit=a;this.ArcTolerance=b;this.m_lowest.x=-1};r.ClipperOffset.two_pi=6.28318530717959;r.ClipperOffset.def_arc_tolerance=
.25;r.ClipperOffset.prototype.Clear=function(){r.Clear(this.m_polyNodes.Childs());this.m_lowest.x=-1};r.ClipperOffset.Round=r.Clipper.Round;r.ClipperOffset.prototype.AddPath=function(a,b,d){var e=a.length-1;if(!(0>e)){var f=new r.PolyNode;f.m_jointype=b;f.m_endtype=d;if(d==r.EndType.etClosedLine||d==r.EndType.etClosedPolygon)for(;0<e&&r.IntPoint.op_Equality(a[0],a[e]);)e--;f.m_polygon.push(a[0]);var g=0;b=0;for(var k=1;k<=e;k++)r.IntPoint.op_Inequality(f.m_polygon[g],a[k])&&(g++,f.m_polygon.push(a[k]),
a[k].y>f.m_polygon[b].y||a[k].y==f.m_polygon[b].y&&a[k].x<f.m_polygon[b].x)&&(b=g);if(!(d==r.EndType.etClosedPolygon&&2>g||d!=r.EndType.etClosedPolygon&&0>g)&&(this.m_polyNodes.AddChild(f),d==r.EndType.etClosedPolygon))if(0>this.m_lowest.x)this.m_lowest=new r.IntPoint(0,b);else if(a=this.m_polyNodes.Childs()[this.m_lowest.x].m_polygon[this.m_lowest.y],f.m_polygon[b].y>a.y||f.m_polygon[b].y==a.y&&f.m_polygon[b].x<a.x)this.m_lowest=new r.IntPoint(this.m_polyNodes.ChildCount()-1,b)}};r.ClipperOffset.prototype.AddPaths=
function(a,b,d){for(var e=0,f=a.length;e<f;e++)this.AddPath(a[e],b,d)};r.ClipperOffset.prototype.FixOrientations=function(){if(0<=this.m_lowest.x&&!r.Clipper.Orientation(this.m_polyNodes.Childs()[this.m_lowest.x].m_polygon))for(var a=0;a<this.m_polyNodes.ChildCount();a++){var b=this.m_polyNodes.Childs()[a];(b.m_endtype==r.EndType.etClosedPolygon||b.m_endtype==r.EndType.etClosedLine&&r.Clipper.Orientation(b.m_polygon))&&b.m_polygon.reverse()}else for(a=0;a<this.m_polyNodes.ChildCount();a++)b=this.m_polyNodes.Childs()[a],
b.m_endtype!=r.EndType.etClosedLine||r.Clipper.Orientation(b.m_polygon)||b.m_polygon.reverse()};r.ClipperOffset.GetUnitNormal=function(a,b){var d=b.x-a.x,e=b.y-a.y;if(0==d&&0==e)return new r.DoublePoint(0,0);var f=1/Math.sqrt(d*d+e*e);return new r.DoublePoint(e*f,-(d*f))};r.ClipperOffset.prototype.DoOffset=function(a){this.m_destPolys=[];this.m_delta=a;if(r.ClipperBase.near_zero(a))for(var b=0;b<this.m_polyNodes.ChildCount();b++){var d=this.m_polyNodes.Childs()[b];d.m_endtype==r.EndType.etClosedPolygon&&
this.m_destPolys.push(d.m_polygon)}else{this.m_miterLim=2<this.MiterLimit?2/(this.MiterLimit*this.MiterLimit):.5;var b=0>=this.ArcTolerance?r.ClipperOffset.def_arc_tolerance:this.ArcTolerance>Math.abs(a)*r.ClipperOffset.def_arc_tolerance?Math.abs(a)*r.ClipperOffset.def_arc_tolerance:this.ArcTolerance,e=3.14159265358979/Math.acos(1-b/Math.abs(a));this.m_sin=Math.sin(r.ClipperOffset.two_pi/e);this.m_cos=Math.cos(r.ClipperOffset.two_pi/e);this.m_StepsPerRad=e/r.ClipperOffset.two_pi;0>a&&(this.m_sin=
-this.m_sin);for(b=0;b<this.m_polyNodes.ChildCount();b++){d=this.m_polyNodes.Childs()[b];this.m_srcPoly=d.m_polygon;var f=this.m_srcPoly.length;if(!(0==f||0>=a&&(3>f||d.m_endtype!=r.EndType.etClosedPolygon))){this.m_destPoly=[];if(1==f)if(d.m_jointype==r.JoinType.jtRound)for(var d=1,f=0,g=1;g<=e;g++){this.m_destPoly.push(new r.IntPoint(r.ClipperOffset.Round(this.m_srcPoly[0].x+d*a),r.ClipperOffset.Round(this.m_srcPoly[0].y+f*a)));var k=d,d=d*this.m_cos-this.m_sin*f,f=k*this.m_sin+f*this.m_cos}else for(f=
d=-1,g=0;4>g;++g)this.m_destPoly.push(new r.IntPoint(r.ClipperOffset.Round(this.m_srcPoly[0].x+d*a),r.ClipperOffset.Round(this.m_srcPoly[0].y+f*a))),0>d?d=1:0>f?f=1:d=-1;else{for(g=this.m_normals.length=0;g<f-1;g++)this.m_normals.push(r.ClipperOffset.GetUnitNormal(this.m_srcPoly[g],this.m_srcPoly[g+1]));d.m_endtype==r.EndType.etClosedLine||d.m_endtype==r.EndType.etClosedPolygon?this.m_normals.push(r.ClipperOffset.GetUnitNormal(this.m_srcPoly[f-1],this.m_srcPoly[0])):this.m_normals.push(new r.DoublePoint(this.m_normals[f-
2]));if(d.m_endtype==r.EndType.etClosedPolygon)for(k=f-1,g=0;g<f;g++)k=this.OffsetPoint(g,k,d.m_jointype);else if(d.m_endtype==r.EndType.etClosedLine){k=f-1;for(g=0;g<f;g++)k=this.OffsetPoint(g,k,d.m_jointype);this.m_destPolys.push(this.m_destPoly);this.m_destPoly=[];k=this.m_normals[f-1];for(g=f-1;0<g;g--)this.m_normals[g]=new r.DoublePoint(-this.m_normals[g-1].x,-this.m_normals[g-1].y);this.m_normals[0]=new r.DoublePoint(-k.x,-k.y);k=0;for(g=f-1;0<=g;g--)k=this.OffsetPoint(g,k,d.m_jointype)}else{k=
0;for(g=1;g<f-1;++g)k=this.OffsetPoint(g,k,d.m_jointype);d.m_endtype==r.EndType.etOpenButt?(g=f-1,k=new r.IntPoint(r.ClipperOffset.Round(this.m_srcPoly[g].x+this.m_normals[g].x*a),r.ClipperOffset.Round(this.m_srcPoly[g].y+this.m_normals[g].y*a)),this.m_destPoly.push(k),k=new r.IntPoint(r.ClipperOffset.Round(this.m_srcPoly[g].x-this.m_normals[g].x*a),r.ClipperOffset.Round(this.m_srcPoly[g].y-this.m_normals[g].y*a)),this.m_destPoly.push(k)):(g=f-1,k=f-2,this.m_sinA=0,this.m_normals[g]=new r.DoublePoint(-this.m_normals[g].x,
-this.m_normals[g].y),d.m_endtype==r.EndType.etOpenSquare?this.DoSquare(g,k):this.DoRound(g,k));for(g=f-1;0<g;g--)this.m_normals[g]=new r.DoublePoint(-this.m_normals[g-1].x,-this.m_normals[g-1].y);this.m_normals[0]=new r.DoublePoint(-this.m_normals[1].x,-this.m_normals[1].y);k=f-1;for(g=k-1;0<g;--g)k=this.OffsetPoint(g,k,d.m_jointype);d.m_endtype==r.EndType.etOpenButt?(k=new r.IntPoint(r.ClipperOffset.Round(this.m_srcPoly[0].x-this.m_normals[0].x*a),r.ClipperOffset.Round(this.m_srcPoly[0].y-this.m_normals[0].y*
a)),this.m_destPoly.push(k),k=new r.IntPoint(r.ClipperOffset.Round(this.m_srcPoly[0].x+this.m_normals[0].x*a),r.ClipperOffset.Round(this.m_srcPoly[0].y+this.m_normals[0].y*a)),this.m_destPoly.push(k)):(this.m_sinA=0,d.m_endtype==r.EndType.etOpenSquare?this.DoSquare(0,1):this.DoRound(0,1))}}this.m_destPolys.push(this.m_destPoly)}}}};r.ClipperOffset.prototype.Execute=function(){var a=arguments;if(a[0]instanceof r.PolyTree)if(b=a[0],d=a[1],b.Clear(),this.FixOrientations(),this.DoOffset(d),a=new r.Clipper(0),
a.AddPaths(this.m_destPolys,r.PolyType.ptSubject,!0),0<d)a.Execute(r.ClipType.ctUnion,b,r.PolyFillType.pftPositive,r.PolyFillType.pftPositive);else if(d=r.Clipper.GetBounds(this.m_destPolys),e=new r.Path,e.push(new r.IntPoint(d.left-10,d.bottom+10)),e.push(new r.IntPoint(d.right+10,d.bottom+10)),e.push(new r.IntPoint(d.right+10,d.top-10)),e.push(new r.IntPoint(d.left-10,d.top-10)),a.AddPath(e,r.PolyType.ptSubject,!0),a.ReverseSolution=!0,a.Execute(r.ClipType.ctUnion,b,r.PolyFillType.pftNegative,r.PolyFillType.pftNegative),
1==b.ChildCount()&&0<b.Childs()[0].ChildCount())for(a=b.Childs()[0],b.Childs()[0]=a.Childs()[0],d=1;d<a.ChildCount();d++)b.AddChild(a.Childs()[d]);else b.Clear();else{var b=a[0],d=a[1];r.Clear(b);this.FixOrientations();this.DoOffset(d);a=new r.Clipper(0);a.AddPaths(this.m_destPolys,r.PolyType.ptSubject,!0);if(0<d)a.Execute(r.ClipType.ctUnion,b,r.PolyFillType.pftPositive,r.PolyFillType.pftPositive);else{var d=r.Clipper.GetBounds(this.m_destPolys),e=new r.Path;e.push(new r.IntPoint(d.left-10,d.bottom+
10));e.push(new r.IntPoint(d.right+10,d.bottom+10));e.push(new r.IntPoint(d.right+10,d.top-10));e.push(new r.IntPoint(d.left-10,d.top-10));a.AddPath(e,r.PolyType.ptSubject,!0);a.ReverseSolution=!0;a.Execute(r.ClipType.ctUnion,b,r.PolyFillType.pftNegative,r.PolyFillType.pftNegative);0<b.length&&b.splice(0,1)}}};r.ClipperOffset.prototype.OffsetPoint=function(a,b,d){this.m_sinA=this.m_normals[b].x*this.m_normals[a].y-this.m_normals[a].x*this.m_normals[b].y;if(5E-5>this.m_sinA&&-5E-5<this.m_sinA)return b;
1<this.m_sinA?this.m_sinA=1:-1>this.m_sinA&&(this.m_sinA=-1);if(0>this.m_sinA*this.m_delta)this.m_destPoly.push(new r.IntPoint(r.ClipperOffset.Round(this.m_srcPoly[a].x+this.m_normals[b].x*this.m_delta),r.ClipperOffset.Round(this.m_srcPoly[a].y+this.m_normals[b].y*this.m_delta))),this.m_destPoly.push(new r.IntPoint(this.m_srcPoly[a])),this.m_destPoly.push(new r.IntPoint(r.ClipperOffset.Round(this.m_srcPoly[a].x+this.m_normals[a].x*this.m_delta),r.ClipperOffset.Round(this.m_srcPoly[a].y+this.m_normals[a].y*
this.m_delta)));else switch(d){case r.JoinType.jtMiter:d=1+(this.m_normals[a].x*this.m_normals[b].x+this.m_normals[a].y*this.m_normals[b].y);d>=this.m_miterLim?this.DoMiter(a,b,d):this.DoSquare(a,b);break;case r.JoinType.jtSquare:this.DoSquare(a,b);break;case r.JoinType.jtRound:this.DoRound(a,b)}return a};r.ClipperOffset.prototype.DoSquare=function(a,b){var d=Math.tan(Math.atan2(this.m_sinA,this.m_normals[b].x*this.m_normals[a].x+this.m_normals[b].y*this.m_normals[a].y)/4);this.m_destPoly.push(new r.IntPoint(r.ClipperOffset.Round(this.m_srcPoly[a].x+
this.m_delta*(this.m_normals[b].x-this.m_normals[b].y*d)),r.ClipperOffset.Round(this.m_srcPoly[a].y+this.m_delta*(this.m_normals[b].y+this.m_normals[b].x*d))));this.m_destPoly.push(new r.IntPoint(r.ClipperOffset.Round(this.m_srcPoly[a].x+this.m_delta*(this.m_normals[a].x+this.m_normals[a].y*d)),r.ClipperOffset.Round(this.m_srcPoly[a].y+this.m_delta*(this.m_normals[a].y-this.m_normals[a].x*d))))};r.ClipperOffset.prototype.DoMiter=function(a,b,d){d=this.m_delta/d;this.m_destPoly.push(new r.IntPoint(r.ClipperOffset.Round(this.m_srcPoly[a].x+
(this.m_normals[b].x+this.m_normals[a].x)*d),r.ClipperOffset.Round(this.m_srcPoly[a].y+(this.m_normals[b].y+this.m_normals[a].y)*d)))};r.ClipperOffset.prototype.DoRound=function(a,b){for(var d=Math.atan2(this.m_sinA,this.m_normals[b].x*this.m_normals[a].x+this.m_normals[b].y*this.m_normals[a].y),d=r.Cast_Int32(r.ClipperOffset.Round(this.m_StepsPerRad*Math.abs(d))),e=this.m_normals[b].x,f=this.m_normals[b].y,g,k=0;k<d;++k)this.m_destPoly.push(new r.IntPoint(r.ClipperOffset.Round(this.m_srcPoly[a].x+
e*this.m_delta),r.ClipperOffset.Round(this.m_srcPoly[a].y+f*this.m_delta))),g=e,e=e*this.m_cos-this.m_sin*f,f=g*this.m_sin+f*this.m_cos;this.m_destPoly.push(new r.IntPoint(r.ClipperOffset.Round(this.m_srcPoly[a].x+this.m_normals[a].x*this.m_delta),r.ClipperOffset.Round(this.m_srcPoly[a].y+this.m_normals[a].y*this.m_delta)))};r.Error=function(a){try{throw Error(a);}catch(b){alert(b.message)}};r.JS={};r.JS.AreaOfPolygon=function(a,b){b||(b=1);return r.Clipper.Area(a)/(b*b)};r.JS.AreaOfPolygons=function(a,
b){b||(b=1);for(var d=0,e=0;e<a.length;e++)d+=r.Clipper.Area(a[e]);return d/(b*b)};r.JS.BoundsOfPath=function(a,b){return r.JS.BoundsOfPaths([a],b)};r.JS.BoundsOfPaths=function(a,b){b||(b=1);var d=r.Clipper.GetBounds(a);d.left/=b;d.bottom/=b;d.right/=b;d.top/=b;return d};r.JS.Clean=function(a,b){if(!(a instanceof Array))return[];var d=a[0]instanceof Array;a=r.JS.Clone(a);if("number"!=typeof b||null===b)return r.Error("Delta is not a number in Clean()."),a;if(0===a.length||1==a.length&&0===a[0].length||
0>b)return a;d||(a=[a]);for(var e=a.length,f,g,k,m,n,q,s,t=[],v=0;v<e;v++)if(g=a[v],f=g.length,0!==f)if(3>f)k=g,t.push(k);else{k=g;m=b*b;n=g[0];for(s=q=1;s<f;s++)(g[s].x-n.x)*(g[s].x-n.x)+(g[s].y-n.y)*(g[s].y-n.y)<=m||(k[q]=g[s],n=g[s],q++);n=g[q-1];(g[0].x-n.x)*(g[0].x-n.x)+(g[0].y-n.y)*(g[0].y-n.y)<=m&&q--;q<f&&k.splice(q,f-q);k.length&&t.push(k)}!d&&t.length?t=t[0]:d||0!==t.length?d&&0===t.length&&(t=[[]]):t=[];return t};r.JS.Clone=function(a){if(!(a instanceof Array)||0===a.length)return[];if(1==
a.length&&0===a[0].length)return[[]];var b=a[0]instanceof Array;b||(a=[a]);var d=a.length,e,f,g,k,m=Array(d);for(f=0;f<d;f++){e=a[f].length;k=Array(e);for(g=0;g<e;g++)k[g]={x:a[f][g].x,y:a[f][g].y};m[f]=k}b||(m=m[0]);return m};r.JS.Lighten=function(a,b){if(!(a instanceof Array))return[];if("number"!=typeof b||null===b)return r.Error("Tolerance is not a number in Lighten()."),r.JS.Clone(a);if(0===a.length||1==a.length&&0===a[0].length||0>b)return r.JS.Clone(a);a[0]instanceof Array||(a=[a]);var d,e,
f,g,k,m,n,q,s,t,v,u,y,z,A,C=a.length,B=b*b,D=[];for(d=0;d<C;d++)if(f=a[d],m=f.length,0!=m){for(g=0;1E6>g;g++){k=[];m=f.length;f[m-1].x!=f[0].x||f[m-1].y!=f[0].y?(v=1,f.push({x:f[0].x,y:f[0].y}),m=f.length):v=0;t=[];for(e=0;e<m-2;e++){n=f[e];s=f[e+1];q=f[e+2];z=n.x;A=n.y;n=q.x-z;u=q.y-A;if(0!==n||0!==u)y=((s.x-z)*n+(s.y-A)*u)/(n*n+u*u),1<y?(z=q.x,A=q.y):0<y&&(z+=n*y,A+=u*y);n=s.x-z;u=s.y-A;q=n*n+u*u;q<=B&&(t[e+1]=1,e++)}k.push({x:f[0].x,y:f[0].y});for(e=1;e<m-1;e++)t[e]||k.push({x:f[e].x,y:f[e].y});
k.push({x:f[m-1].x,y:f[m-1].y});v&&f.pop();if(t.length)f=k;else break}m=k.length;k[m-1].x==k[0].x&&k[m-1].y==k[0].y&&k.pop();2<k.length&&D.push(k)}!a[0]instanceof Array&&(D=D[0]);"undefined"==typeof D&&(D=[[]]);return D};r.JS.PerimeterOfPath=function(a,b,d){if("undefined"==typeof a)return 0;var e=Math.sqrt,f=0,g,k,m=0,n=g=0;k=0;var q=a.length;if(2>q)return 0;b&&(a[q]=a[0],q++);for(;--q;)g=a[q],m=g.x,g=g.y,k=a[q-1],n=k.x,k=k.y,f+=e((m-n)*(m-n)+(g-k)*(g-k));b&&a.pop();return f/d};r.JS.PerimeterOfPaths=
function(a,b,d){d||(d=1);for(var e=0,f=0;f<a.length;f++)e+=r.JS.PerimeterOfPath(a[f],b,d);return e};r.JS.ScaleDownPath=function(a,b){var d,e;b||(b=1);for(d=a.length;d--;)e=a[d],e.x/=b,e.y/=b};r.JS.ScaleDownPaths=function(a,b){var d,e,f;b||(b=1);for(d=a.length;d--;)for(e=a[d].length;e--;)f=a[d][e],f.x/=b,f.y/=b};r.JS.ScaleUpPath=function(a,b){var d,e,f=Math.round;b||(b=1);for(d=a.length;d--;)e=a[d],e.x=f(e.x*b),e.y=f(e.y*b)};r.JS.ScaleUpPaths=function(a,b){var d,e,f,g=Math.round;b||(b=1);for(d=a.length;d--;)for(e=
a[d].length;e--;)f=a[d][e],f.x=g(f.x*b),f.y=g(f.y*b)};r.ExPolygons=function(){return[]};r.ExPolygon=function(){this.holes=this.outer=null};r.JS.AddOuterPolyNodeToExPolygons=function(a,b){var d=new r.ExPolygon;d.outer=a.Contour();var e=a.Childs(),f=e.length;d.holes=Array(f);var g,k,m,n,q;for(k=0;k<f;k++)for(g=e[k],d.holes[k]=g.Contour(),m=0,n=g.Childs(),q=n.length;m<q;m++)g=n[m],r.JS.AddOuterPolyNodeToExPolygons(g,b);b.push(d)};r.JS.ExPolygonsToPaths=function(a){var b,d,e,f,g=new r.Paths;b=0;for(e=
a.length;b<e;b++)for(g.push(a[b].outer),d=0,f=a[b].holes.length;d<f;d++)g.push(a[b].holes[d]);return g};r.JS.PolyTreeToExPolygons=function(a){var b=new r.ExPolygons,d,e,f;d=0;e=a.Childs();for(f=e.length;d<f;d++)a=e[d],r.JS.AddOuterPolyNodeToExPolygons(a,b);return b}})();
var spine={radDeg:180/Math.PI,degRad:Math.PI/180,temp:[],Float32Array:"undefined"===typeof Float32Array?Array:Float32Array,Uint16Array:"undefined"===typeof Uint16Array?Array:Uint16Array,BoneData:function(a,b){this.name=a;this.parent=b}};spine.BoneData.prototype={length:0,x:0,y:0,rotation:0,scaleX:1,scaleY:1,inheritScale:!0,inheritRotation:!0,flipX:!1,flipY:!1};spine.BlendMode={normal:0,additive:1,multiply:2,screen:3};spine.SlotData=function(a,b){this.name=a;this.boneData=b};
spine.SlotData.prototype={r:1,g:1,b:1,a:1,attachmentName:null,blendMode:spine.BlendMode.normal};spine.IkConstraintData=function(a){this.name=a;this.bones=[]};spine.IkConstraintData.prototype={target:null,bendDirection:1,mix:1};spine.Bone=function(a,b,d){this.data=a;this.skeleton=b;this.parent=d;this.setToSetupPose()};spine.Bone.yDown=!1;
spine.Bone.prototype={x:0,y:0,rotation:0,rotationIK:0,scaleX:1,scaleY:1,flipX:!1,flipY:!1,m00:0,m01:0,worldX:0,m10:0,m11:0,worldY:0,worldRotation:0,worldScaleX:1,worldScaleY:1,worldFlipX:!1,worldFlipY:!1,updateWorldTransform:function(){var a=this.parent;if(a)this.worldX=this.x*a.m00+this.y*a.m01+a.worldX,this.worldY=this.x*a.m10+this.y*a.m11+a.worldY,this.data.inheritScale?(this.worldScaleX=a.worldScaleX*this.scaleX,this.worldScaleY=a.worldScaleY*this.scaleY):(this.worldScaleX=this.scaleX,this.worldScaleY=
this.scaleY),this.worldRotation=this.data.inheritRotation?a.worldRotation+this.rotationIK:this.rotationIK,this.worldFlipX=a.worldFlipX!=this.flipX,this.worldFlipY=a.worldFlipY!=this.flipY;else{var a=this.skeleton.flipX,b=this.skeleton.flipY;this.worldX=a?-this.x:this.x;this.worldY=b!=spine.Bone.yDown?-this.y:this.y;this.worldScaleX=this.scaleX;this.worldScaleY=this.scaleY;this.worldRotation=this.rotationIK;this.worldFlipX=a!=this.flipX;this.worldFlipY=b!=this.flipY}b=this.worldRotation*spine.degRad;
a=Math.cos(b);b=Math.sin(b);this.worldFlipX?(this.m00=-a*this.worldScaleX,this.m01=b*this.worldScaleY):(this.m00=a*this.worldScaleX,this.m01=-b*this.worldScaleY);this.worldFlipY!=spine.Bone.yDown?(this.m10=-b*this.worldScaleX,this.m11=-a*this.worldScaleY):(this.m10=b*this.worldScaleX,this.m11=a*this.worldScaleY)},setToSetupPose:function(){var a=this.data;this.x=a.x;this.y=a.y;this.rotationIK=this.rotation=a.rotation;this.scaleX=a.scaleX;this.scaleY=a.scaleY;this.flipX=a.flipX;this.flipY=a.flipY},
worldToLocal:function(a){var b=a[0]-this.worldX,d=a[1]-this.worldY,e=this.m00,f=this.m10,g=this.m01,k=this.m11;this.worldFlipX!=(this.worldFlipY!=spine.Bone.yDown)&&(e=-e,k=-k);var m=1/(e*k-g*f);a[0]=b*e*m-d*g*m;a[1]=d*k*m-b*f*m},localToWorld:function(a){var b=a[0],d=a[1];a[0]=b*this.m00+d*this.m01+this.worldX;a[1]=b*this.m10+d*this.m11+this.worldY}};spine.Slot=function(a,b){this.data=a;this.bone=b;this.setToSetupPose()};
spine.Slot.prototype={r:1,g:1,b:1,a:1,_attachmentTime:0,attachment:null,attachmentVertices:[],setAttachment:function(a){this.attachment=a;this._attachmentTime=this.bone.skeleton.time;this.attachmentVertices.length=0},setAttachmentTime:function(a){this._attachmentTime=this.bone.skeleton.time-a},getAttachmentTime:function(){return this.bone.skeleton.time-this._attachmentTime},setToSetupPose:function(){var a=this.data;this.r=a.r;this.g=a.g;this.b=a.b;this.a=a.a;for(var b=this.bone.skeleton.data.slots,
d=0,e=b.length;d<e;d++)if(b[d]==a){this.setAttachment(a.attachmentName?this.bone.skeleton.getAttachmentBySlotIndex(d,a.attachmentName):null);break}}};spine.IkConstraint=function(a,b){this.data=a;this.mix=a.mix;this.bendDirection=a.bendDirection;this.bones=[];for(var d=0,e=a.bones.length;d<e;d++)this.bones.push(b.findBone(a.bones[d].name));this.target=b.findBone(a.target.name)};
spine.IkConstraint.prototype={apply:function(){var a=this.target,b=this.bones;switch(b.length){case 1:spine.IkConstraint.apply1(b[0],a.worldX,a.worldY,this.mix);break;case 2:spine.IkConstraint.apply2(b[0],b[1],a.worldX,a.worldY,this.bendDirection,this.mix)}}};
spine.IkConstraint.apply1=function(a,b,d,e){var f=a.data.inheritRotation&&a.parent?a.parent.worldRotation:0,g=a.rotation;b=Math.atan2(d-a.worldY,b-a.worldX)*spine.radDeg;a.worldFlipX!=(a.worldFlipY!=spine.Bone.yDown)&&(b=-b);a.rotationIK=g+(b-f-g)*e};
spine.IkConstraint.apply2=function(a,b,d,e,f,g){var k=b.rotation,m=a.rotation;if(g){var n,q,s=spine.temp;(n=a.parent)?(s[0]=d,s[1]=e,n.worldToLocal(s),d=(s[0]-a.x)*n.worldScaleX,e=(s[1]-a.y)*n.worldScaleY):(d-=a.x,e-=a.y);b.parent==a?(n=b.x,q=b.y):(s[0]=b.x,s[1]=b.y,b.parent.localToWorld(s),a.worldToLocal(s),n=s[0],q=s[1]);s=n*a.worldScaleX;q*=a.worldScaleY;n=Math.atan2(q,s);q=Math.sqrt(s*s+q*q);var s=b.data.length*b.worldScaleX,t=2*q*s;1E-4>t?b.rotationIK=k+(Math.atan2(e,d)*spine.radDeg-m-k)*g:(t=
(d*d+e*e-q*q-s*s)/t,-1>t?t=-1:1<t&&(t=1),f*=Math.acos(t),q+=s*t,s*=Math.sin(f),d=(Math.atan2(e*q-d*s,d*q+e*s)-n)*spine.radDeg-m,180<d?d-=360:-180>d&&(d+=360),a.rotationIK=m+d*g,d=(f+n)*spine.radDeg-k,180<d?d-=360:-180>d&&(d+=360),b.rotationIK=k+(d+a.worldRotation-b.parent.worldRotation)*g)}else b.rotationIK=k,a.rotationIK=m};spine.Skin=function(a){this.name=a;this.attachments={}};
spine.Skin.prototype={addAttachment:function(a,b,d){this.attachments[a+":"+b]=d},getAttachment:function(a,b){return this.attachments[a+":"+b]},_attachAll:function(a,b){for(var d in b.attachments){var e=d.indexOf(":"),f=parseInt(d.substring(0,e)),g=d.substring(e+1),e=a.slots[f];e.attachment&&e.attachment.name==g&&(f=this.getAttachment(f,g))&&e.setAttachment(f)}}};spine.Animation=function(a,b,d){this.name=a;this.timelines=b;this.duration=d};
spine.Animation.prototype={apply:function(a,b,d,e,f){e&&0!=this.duration&&(d%=this.duration,b%=this.duration);e=this.timelines;for(var g=0,k=e.length;g<k;g++)e[g].apply(a,b,d,f,1)},mix:function(a,b,d,e,f,g){e&&0!=this.duration&&(d%=this.duration,b%=this.duration);e=this.timelines;for(var k=0,m=e.length;k<m;k++)e[k].apply(a,b,d,f,g)}};
spine.Animation.binarySearch=function(a,b,d){var e=0,f=Math.floor(a.length/d)-2;if(!f)return d;for(var g=f>>>1;;){a[(g+1)*d]<=b?e=g+1:f=g;if(e==f)return(e+1)*d;g=e+f>>>1}};spine.Animation.binarySearch1=function(a,b){var d=0,e=a.length-2;if(!e)return 1;for(var f=e>>>1;;){a[f+1]<=b?d=f+1:e=f;if(d==e)return d+1;f=d+e>>>1}};spine.Animation.linearSearch=function(a,b,d){for(var e=0,f=a.length-d;e<=f;e+=d)if(a[e]>b)return e;return-1};spine.Curves=function(a){this.curves=[]};
spine.Curves.prototype={setLinear:function(a){this.curves[19*a]=0},setStepped:function(a){this.curves[19*a]=1},setCurve:function(a,b,d,e,f){var g=.1*.1,k=.1*g,m=3*.1,n=3*g,q=6*g,g=6*k,s=2*-b+e,t=2*-d+f;e=3*(b-e)+1;f=3*(d-f)+1;b=b*m+s*n+e*k;d=d*m+t*n+f*k;k=s*q+e*g;q=t*q+f*g;t=e*g;g*=f;a*=19;e=this.curves;e[a++]=2;f=b;m=d;for(n=a+19-1;a<n;a+=2)e[a]=f,e[a+1]=m,b+=k,d+=q,k+=t,q+=g,f+=b,m+=d},getCurvePercent:function(a,b){b=0>b?0:1<b?1:b;var d=this.curves,e=19*a,f=d[e];if(0===f)return b;if(1==f)return 0;
e++;for(var f=0,g=e,k=e+19-1;e<k;e+=2)if(f=d[e],f>=b)return e==g?k=g=0:(g=d[e-2],k=d[e-1]),k+(d[e+1]-k)*(b-g)/(f-g);d=d[e-1];return d+(1-d)*(b-f)/(1-f)}};spine.RotateTimeline=function(a){this.curves=new spine.Curves(a);this.frames=[];this.frames.length=2*a};
spine.RotateTimeline.prototype={boneIndex:0,getFrameCount:function(){return this.frames.length/2},setFrame:function(a,b,d){a*=2;this.frames[a]=b;this.frames[a+1]=d},apply:function(a,b,d,e,f){b=this.frames;if(!(d<b[0])){a=a.bones[this.boneIndex];if(d>=b[b.length-2])b=a.data.rotation+b[b.length-1]-a.rotation;else{var g=spine.Animation.binarySearch(b,d,2);e=b[g-1];var k=b[g];d=1-(d-k)/(b[g-2]-k);d=this.curves.getCurvePercent(g/2-1,d);for(b=b[g+1]-e;180<b;)b-=360;for(;-180>b;)b+=360;b=a.data.rotation+
(e+b*d)-a.rotation}for(;180<b;)b-=360;for(;-180>b;)b+=360;a.rotation+=b*f}}};spine.TranslateTimeline=function(a){this.curves=new spine.Curves(a);this.frames=[];this.frames.length=3*a};
spine.TranslateTimeline.prototype={boneIndex:0,getFrameCount:function(){return this.frames.length/3},setFrame:function(a,b,d,e){a*=3;this.frames[a]=b;this.frames[a+1]=d;this.frames[a+2]=e},apply:function(a,b,d,e,f){b=this.frames;if(!(d<b[0]))if(a=a.bones[this.boneIndex],d>=b[b.length-3])a.x+=(a.data.x+b[b.length-2]-a.x)*f,a.y+=(a.data.y+b[b.length-1]-a.y)*f;else{e=spine.Animation.binarySearch(b,d,3);var g=b[e-2],k=b[e-1],m=b[e];d=1-(d-m)/(b[e+-3]-m);d=this.curves.getCurvePercent(e/3-1,d);a.x+=(a.data.x+
g+(b[e+1]-g)*d-a.x)*f;a.y+=(a.data.y+k+(b[e+2]-k)*d-a.y)*f}}};spine.ScaleTimeline=function(a){this.curves=new spine.Curves(a);this.frames=[];this.frames.length=3*a};
spine.ScaleTimeline.prototype={boneIndex:0,getFrameCount:function(){return this.frames.length/3},setFrame:function(a,b,d,e){a*=3;this.frames[a]=b;this.frames[a+1]=d;this.frames[a+2]=e},apply:function(a,b,d,e,f){b=this.frames;if(!(d<b[0]))if(a=a.bones[this.boneIndex],d>=b[b.length-3])a.scaleX+=(a.data.scaleX*b[b.length-2]-a.scaleX)*f,a.scaleY+=(a.data.scaleY*b[b.length-1]-a.scaleY)*f;else{e=spine.Animation.binarySearch(b,d,3);var g=b[e-2],k=b[e-1],m=b[e];d=1-(d-m)/(b[e+-3]-m);d=this.curves.getCurvePercent(e/
3-1,d);a.scaleX+=(a.data.scaleX*(g+(b[e+1]-g)*d)-a.scaleX)*f;a.scaleY+=(a.data.scaleY*(k+(b[e+2]-k)*d)-a.scaleY)*f}}};spine.ColorTimeline=function(a){this.curves=new spine.Curves(a);this.frames=[];this.frames.length=5*a};
spine.ColorTimeline.prototype={slotIndex:0,getFrameCount:function(){return this.frames.length/5},setFrame:function(a,b,d,e,f,g){a*=5;this.frames[a]=b;this.frames[a+1]=d;this.frames[a+2]=e;this.frames[a+3]=f;this.frames[a+4]=g},apply:function(a,b,d,e,f){b=this.frames;if(!(d<b[0])){var g,k;if(d>=b[b.length-5])e=b.length-1,d=b[e-3],g=b[e-2],k=b[e-1],b=b[e];else{e=spine.Animation.binarySearch(b,d,5);var m=b[e-4];g=b[e-3];k=b[e-2];var n=b[e-1],q=b[e],q=1-(d-q)/(b[e-5]-q),q=this.curves.getCurvePercent(e/
5-1,q);d=m+(b[e+1]-m)*q;g+=(b[e+2]-g)*q;k+=(b[e+3]-k)*q;b=n+(b[e+4]-n)*q}a=a.slots[this.slotIndex];1>f?(a.r+=(d-a.r)*f,a.g+=(g-a.g)*f,a.b+=(k-a.b)*f,a.a+=(b-a.a)*f):(a.r=d,a.g=g,a.b=k,a.a=b)}}};spine.AttachmentTimeline=function(a){this.curves=new spine.Curves(a);this.frames=[];this.frames.length=a;this.attachmentNames=[];this.attachmentNames.length=a};
spine.AttachmentTimeline.prototype={slotIndex:0,getFrameCount:function(){return this.frames.length},setFrame:function(a,b,d){this.frames[a]=b;this.attachmentNames[a]=d},apply:function(a,b,d,e,f){e=this.frames;d<e[0]?b>d&&this.apply(a,b,Number.MAX_VALUE,null,0):(b>d&&(b=-1),d=d>=e[e.length-1]?e.length-1:spine.Animation.binarySearch1(e,d)-1,e[d]<b||(b=this.attachmentNames[d],a.slots[this.slotIndex].setAttachment(b?a.getAttachmentBySlotIndex(this.slotIndex,b):null)))}};
spine.EventTimeline=function(a){this.frames=[];this.frames.length=a;this.events=[];this.events.length=a};
spine.EventTimeline.prototype={getFrameCount:function(){return this.frames.length},setFrame:function(a,b,d){this.frames[a]=b;this.events[a]=d},apply:function(a,b,d,e,f){if(e){var g=this.frames,k=g.length;if(b>d)this.apply(a,b,Number.MAX_VALUE,e,f),b=-1;else if(b>=g[k-1])return;if(!(d<g[0])){if(b<g[0])a=0;else for(a=spine.Animation.binarySearch1(g,b),b=g[a];0<a&&g[a-1]==b;)a--;for(b=this.events;a<k&&d>=g[a];a++)e.push(b[a])}}}};
spine.DrawOrderTimeline=function(a){this.frames=[];this.frames.length=a;this.drawOrders=[];this.drawOrders.length=a};
spine.DrawOrderTimeline.prototype={getFrameCount:function(){return this.frames.length},setFrame:function(a,b,d){this.frames[a]=b;this.drawOrders[a]=d},apply:function(a,b,d,e,f){b=this.frames;if(!(d<b[0]))if(e=d>=b[b.length-1]?b.length-1:spine.Animation.binarySearch1(b,d)-1,d=a.drawOrder,b=a.slots,e=this.drawOrders[e])for(f=0,g=e.length;f<g;f++)d[f]=a.slots[e[f]];else{f=0;for(var g=b.length;f<g;f++)d[f]=b[f]}}};
spine.FfdTimeline=function(a){this.curves=new spine.Curves(a);this.frames=[];this.frames.length=a;this.frameVertices=[];this.frameVertices.length=a};
spine.FfdTimeline.prototype={slotIndex:0,attachment:0,getFrameCount:function(){return this.frames.length},setFrame:function(a,b,d){this.frames[a]=b;this.frameVertices[a]=d},apply:function(a,b,d,e,f){b=a.slots[this.slotIndex];if(b.attachment==this.attachment){var g=this.frames;if(!(d<g[0]))if(e=this.frameVertices,a=e[0].length,b=b.attachmentVertices,b.length!=a&&(f=1),b.length=a,d>=g[g.length-1])if(d=e[g.length-1],1>f)for(e=0;e<a;e++)b[e]+=(d[e]-b[e])*f;else for(e=0;e<a;e++)b[e]=d[e];else{var k=spine.Animation.binarySearch1(g,
d),m=g[k];d=1-(d-m)/(g[k-1]-m);d=this.curves.getCurvePercent(k-1,0>d?0:1<d?1:d);g=e[k-1];k=e[k];if(1>f)for(e=0;e<a;e++)m=g[e],b[e]+=(m+(k[e]-m)*d-b[e])*f;else for(e=0;e<a;e++)m=g[e],b[e]=m+(k[e]-m)*d}}}};spine.IkConstraintTimeline=function(a){this.curves=new spine.Curves(a);this.frames=[];this.frames.length=3*a};
spine.IkConstraintTimeline.prototype={ikConstraintIndex:0,getFrameCount:function(){return this.frames.length/3},setFrame:function(a,b,d,e){a*=3;this.frames[a]=b;this.frames[a+1]=d;this.frames[a+2]=e},apply:function(a,b,d,e,f){b=this.frames;if(!(d<b[0]))if(a=a.ikConstraints[this.ikConstraintIndex],d>=b[b.length-3])a.mix+=(b[b.length-2]-a.mix)*f,a.bendDirection=b[b.length-1];else{e=spine.Animation.binarySearch(b,d,3);var g=b[e+-2],k=b[e];d=1-(d-k)/(b[e+-3]-k);d=this.curves.getCurvePercent(e/3-1,d);
a.mix+=(g+(b[e+1]-g)*d-a.mix)*f;a.bendDirection=b[e+-1]}}};spine.FlipXTimeline=function(a){this.curves=new spine.Curves(a);this.frames=[];this.frames.length=2*a};
spine.FlipXTimeline.prototype={boneIndex:0,getFrameCount:function(){return this.frames.length/2},setFrame:function(a,b,d){a*=2;this.frames[a]=b;this.frames[a+1]=d?1:0},apply:function(a,b,d,e,f){e=this.frames;d<e[0]?b>d&&this.apply(a,b,Number.MAX_VALUE,null,0):(b>d&&(b=-1),d=(d>=e[e.length-2]?e.length:spine.Animation.binarySearch(e,d,2))-2,e[d]<b||(a.bones[this.boneIndex].flipX=0!=e[d+1]))}};spine.FlipYTimeline=function(a){this.curves=new spine.Curves(a);this.frames=[];this.frames.length=2*a};
spine.FlipYTimeline.prototype={boneIndex:0,getFrameCount:function(){return this.frames.length/2},setFrame:function(a,b,d){a*=2;this.frames[a]=b;this.frames[a+1]=d?1:0},apply:function(a,b,d,e,f){e=this.frames;d<e[0]?b>d&&this.apply(a,b,Number.MAX_VALUE,null,0):(b>d&&(b=-1),d=(d>=e[e.length-2]?e.length:spine.Animation.binarySearch(e,d,2))-2,e[d]<b||(a.bones[this.boneIndex].flipY=0!=e[d+1]))}};
spine.SkeletonData=function(){this.bones=[];this.slots=[];this.skins=[];this.events=[];this.animations=[];this.ikConstraints=[]};
spine.SkeletonData.prototype={name:null,defaultSkin:null,width:0,height:0,version:null,hash:null,findBone:function(a){for(var b=this.bones,d=0,e=b.length;d<e;d++)if(b[d].name==a)return b[d];return null},findBoneIndex:function(a){for(var b=this.bones,d=0,e=b.length;d<e;d++)if(b[d].name==a)return d;return-1},findSlot:function(a){for(var b=this.slots,d=0,e=b.length;d<e;d++)if(b[d].name==a)return slot[d];return null},findSlotIndex:function(a){for(var b=this.slots,d=0,e=b.length;d<e;d++)if(b[d].name==
a)return d;return-1},findSkin:function(a){for(var b=this.skins,d=0,e=b.length;d<e;d++)if(b[d].name==a)return b[d];return null},findEvent:function(a){for(var b=this.events,d=0,e=b.length;d<e;d++)if(b[d].name==a)return b[d];return null},findAnimation:function(a){for(var b=this.animations,d=0,e=b.length;d<e;d++)if(b[d].name==a)return b[d];return null},findIkConstraint:function(a){for(var b=this.ikConstraints,d=0,e=b.length;d<e;d++)if(b[d].name==a)return b[d];return null}};
spine.Skeleton=function(a){this.data=a;this.bones=[];for(var b=0,d=a.bones.length;b<d;b++){var e=a.bones[b],f=e.parent?this.bones[a.bones.indexOf(e.parent)]:null;this.bones.push(new spine.Bone(e,this,f))}this.slots=[];this.drawOrder=[];b=0;for(d=a.slots.length;b<d;b++)e=a.slots[b],f=this.bones[a.bones.indexOf(e.boneData)],e=new spine.Slot(e,f),this.slots.push(e),this.drawOrder.push(e);this.ikConstraints=[];b=0;for(d=a.ikConstraints.length;b<d;b++)this.ikConstraints.push(new spine.IkConstraint(a.ikConstraints[b],
this));this.boneCache=[];this.updateCache()};
spine.Skeleton.prototype={x:0,y:0,skin:null,r:1,g:1,b:1,a:1,time:0,flipX:!1,flipY:!1,updateCache:function(){var a=this.ikConstraints,b=a.length,d=b+1,e=this.boneCache;e.length>d&&(e.length=d);for(var f=0,g=e.length;f<g;f++)e[f].length=0;for(;e.length<d;)e[e.length]=[];var d=e[0],k=this.bones,f=0,g=k.length;a:for(;f<g;f++){var m=k[f],n=m;do{for(var q=0;q<b;q++)for(var s=a[q],t=s.bones[0],s=s.bones[s.bones.length-1];;){if(n==s){e[q].push(m);e[q+1].push(m);continue a}if(s==t)break;s=s.parent}n=n.parent}while(n);
d[d.length]=m}},updateWorldTransform:function(){for(var a=this.bones,b=0,d=a.length;b<d;b++){var e=a[b];e.rotationIK=e.rotation}b=0;for(a=this.boneCache.length-1;;){for(var d=this.boneCache[b],e=0,f=d.length;e<f;e++)d[e].updateWorldTransform();if(b==a)break;this.ikConstraints[b].apply();b++}},setToSetupPose:function(){this.setBonesToSetupPose();this.setSlotsToSetupPose()},setBonesToSetupPose:function(){for(var a=this.bones,b=0,d=a.length;b<d;b++)a[b].setToSetupPose();a=this.ikConstraints;b=0;for(d=
a.length;b<d;b++){var e=a[b];e.bendDirection=e.data.bendDirection;e.mix=e.data.mix}},setSlotsToSetupPose:function(){for(var a=this.slots,b=this.drawOrder,d=0,e=a.length;d<e;d++)b[d]=a[d],a[d].setToSetupPose(d)},getRootBone:function(){return this.bones.length?this.bones[0]:null},findBone:function(a){for(var b=this.bones,d=0,e=b.length;d<e;d++)if(b[d].data.name==a)return b[d];return null},findBoneIndex:function(a){for(var b=this.bones,d=0,e=b.length;d<e;d++)if(b[d].data.name==a)return d;return-1},findSlot:function(a){for(var b=
this.slots,d=0,e=b.length;d<e;d++)if(b[d].data.name==a)return b[d];return null},findSlotIndex:function(a){for(var b=this.slots,d=0,e=b.length;d<e;d++)if(b[d].data.name==a)return d;return-1},setSkinByName:function(a){var b=this.data.findSkin(a);if(!b)throw"Skin not found: "+a;this.setSkin(b)},setSkin:function(a){if(a)if(this.skin)a._attachAll(this,this.skin);else for(var b=this.slots,d=0,e=b.length;d<e;d++){var f=b[d],g=f.data.attachmentName;g&&(g=a.getAttachment(d,g))&&f.setAttachment(g)}this.skin=
a},getAttachmentBySlotName:function(a,b){return this.getAttachmentBySlotIndex(this.data.findSlotIndex(a),b)},getAttachmentBySlotIndex:function(a,b){if(this.skin){var d=this.skin.getAttachment(a,b);if(d)return d}return this.data.defaultSkin?this.data.defaultSkin.getAttachment(a,b):null},setAttachment:function(a,b){for(var d=this.slots,e=0,f=d.length;e<f;e++){var g=d[e];if(g.data.name==a){d=null;if(b&&(d=this.getAttachmentBySlotIndex(e,b),!d))throw"Attachment not found: "+b+", for slot: "+a;g.setAttachment(d);
return}}throw"Slot not found: "+a;},findIkConstraint:function(a){for(var b=this.ikConstraints,d=0,e=b.length;d<e;d++)if(b[d].data.name==a)return b[d];return null},update:function(a){this.time+=a}};spine.EventData=function(a){this.name=a};spine.EventData.prototype={intValue:0,floatValue:0,stringValue:null};spine.Event=function(a){this.data=a};spine.Event.prototype={intValue:0,floatValue:0,stringValue:null};spine.AttachmentType={region:0,boundingbox:1,mesh:2,skinnedmesh:3};
spine.RegionAttachment=function(a){this.name=a;this.offset=[];this.offset.length=8;this.uvs=[];this.uvs.length=8};
spine.RegionAttachment.prototype={type:spine.AttachmentType.region,x:0,y:0,rotation:0,scaleX:1,scaleY:1,width:0,height:0,r:1,g:1,b:1,a:1,path:null,rendererObject:null,regionOffsetX:0,regionOffsetY:0,regionWidth:0,regionHeight:0,regionOriginalWidth:0,regionOriginalHeight:0,setUVs:function(a,b,d,e,f){var g=this.uvs;f?(g[2]=a,g[3]=e,g[4]=a,g[5]=b,g[6]=d,g[7]=b,g[0]=d,g[1]=e):(g[0]=a,g[1]=e,g[2]=a,g[3]=b,g[4]=d,g[5]=b,g[6]=d,g[7]=e)},updateOffset:function(){var a=this.width/this.regionOriginalWidth*this.scaleX,
b=this.height/this.regionOriginalHeight*this.scaleY,d=-this.width/2*this.scaleX+this.regionOffsetX*a,e=-this.height/2*this.scaleY+this.regionOffsetY*b,f=d+this.regionWidth*a,a=e+this.regionHeight*b,b=this.rotation*spine.degRad,g=Math.cos(b),k=Math.sin(b),b=d*g+this.x,d=d*k,m=e*g+this.y,e=e*k,n=f*g+this.x,f=f*k,g=a*g+this.y,a=a*k,k=this.offset;k[0]=b-e;k[1]=m+d;k[2]=b-a;k[3]=g+d;k[4]=n-a;k[5]=g+f;k[6]=n-e;k[7]=m+f},computeVertices:function(a,b,d,e){a+=d.worldX;b+=d.worldY;var f=d.m00,g=d.m01,k=d.m10;
d=d.m11;var m=this.offset;e[0]=m[0]*f+m[1]*g+a;e[1]=m[0]*k+m[1]*d+b;e[2]=m[2]*f+m[3]*g+a;e[3]=m[2]*k+m[3]*d+b;e[4]=m[4]*f+m[5]*g+a;e[5]=m[4]*k+m[5]*d+b;e[6]=m[6]*f+m[7]*g+a;e[7]=m[6]*k+m[7]*d+b}};spine.MeshAttachment=function(a){this.name=a};
spine.MeshAttachment.prototype={type:spine.AttachmentType.mesh,vertices:null,uvs:null,regionUVs:null,triangles:null,hullLength:0,r:1,g:1,b:1,a:1,path:null,rendererObject:null,regionU:0,regionV:0,regionU2:0,regionV2:0,regionRotate:!1,regionOffsetX:0,regionOffsetY:0,regionWidth:0,regionHeight:0,regionOriginalWidth:0,regionOriginalHeight:0,edges:null,width:0,height:0,updateUVs:function(){var a=this.regionU2-this.regionU,b=this.regionV2-this.regionV,d=this.regionUVs.length;this.uvs&&this.uvs.length==
d||(this.uvs=new spine.Float32Array(d));if(this.regionRotate)for(var e=0;e<d;e+=2)this.uvs[e]=this.regionU+this.regionUVs[e+1]*a,this.uvs[e+1]=this.regionV+b-this.regionUVs[e]*b;else for(e=0;e<d;e+=2)this.uvs[e]=this.regionU+this.regionUVs[e]*a,this.uvs[e+1]=this.regionV+this.regionUVs[e+1]*b},computeWorldVertices:function(a,b,d,e){var f=d.bone;a+=f.worldX;b+=f.worldY;var g=f.m00,k=f.m01,m=f.m10,f=f.m11,n=this.vertices,q=n.length;d.attachmentVertices.length==q&&(n=d.attachmentVertices);for(d=0;d<
q;d+=2){var s=n[d],t=n[d+1];e[d]=s*g+t*k+a;e[d+1]=s*m+t*f+b}}};spine.SkinnedMeshAttachment=function(a){this.name=a};
spine.SkinnedMeshAttachment.prototype={type:spine.AttachmentType.skinnedmesh,bones:null,weights:null,uvs:null,regionUVs:null,triangles:null,hullLength:0,r:1,g:1,b:1,a:1,path:null,rendererObject:null,regionU:0,regionV:0,regionU2:0,regionV2:0,regionRotate:!1,regionOffsetX:0,regionOffsetY:0,regionWidth:0,regionHeight:0,regionOriginalWidth:0,regionOriginalHeight:0,edges:null,width:0,height:0,updateUVs:function(a,b,d,e,f){a=this.regionU2-this.regionU;b=this.regionV2-this.regionV;d=this.regionUVs.length;
this.uvs&&this.uvs.length==d||(this.uvs=new spine.Float32Array(d));if(this.regionRotate)for(e=0;e<d;e+=2)this.uvs[e]=this.regionU+this.regionUVs[e+1]*a,this.uvs[e+1]=this.regionV+b-this.regionUVs[e]*b;else for(e=0;e<d;e+=2)this.uvs[e]=this.regionU+this.regionUVs[e]*a,this.uvs[e+1]=this.regionV+this.regionUVs[e+1]*b},computeWorldVertices:function(a,b,d,e){var f=d.bone.skeleton.bones,g=this.weights,k=this.bones,m=0,n=0,q=0,s=0,t=k.length,u,v,y,z,A,r;if(d.attachmentVertices.length)for(var D=d.attachmentVertices;n<
t;m+=2){v=u=0;for(d=k[n++]+n;n<d;n++,q+=3,s+=2)y=f[k[n]],z=g[q]+D[s],A=g[q+1]+D[s+1],r=g[q+2],u+=(z*y.m00+A*y.m01+y.worldX)*r,v+=(z*y.m10+A*y.m11+y.worldY)*r;e[m]=u+a;e[m+1]=v+b}else for(;n<t;m+=2){v=u=0;for(d=k[n++]+n;n<d;n++,q+=3)y=f[k[n]],z=g[q],A=g[q+1],r=g[q+2],u+=(z*y.m00+A*y.m01+y.worldX)*r,v+=(z*y.m10+A*y.m11+y.worldY)*r;e[m]=u+a;e[m+1]=v+b}}};spine.BoundingBoxAttachment=function(a){this.name=a;this.vertices=[]};
spine.BoundingBoxAttachment.prototype={type:spine.AttachmentType.boundingbox,computeWorldVertices:function(a,b,d,e){a+=d.worldX;b+=d.worldY;var f=d.m00,g=d.m01,k=d.m10;d=d.m11;for(var m=this.vertices,n=0,q=m.length;n<q;n+=2){var s=m[n],t=m[n+1];e[n]=s*f+t*g+a;e[n+1]=s*k+t*d+b}}};spine.AnimationStateData=function(a){this.skeletonData=a;this.animationToMixTime={}};
spine.AnimationStateData.prototype={defaultMix:0,setMixByName:function(a,b,d){var e=this.skeletonData.findAnimation(a);if(!e)throw"Animation not found: "+a;a=this.skeletonData.findAnimation(b);if(!a)throw"Animation not found: "+b;this.setMix(e,a,d)},setMix:function(a,b,d){this.animationToMixTime[a.name+":"+b.name]=d},getMix:function(a,b){var d=a.name+":"+b.name;return this.animationToMixTime.hasOwnProperty(d)?this.animationToMixTime[d]:this.defaultMix}};spine.TrackEntry=function(){};
spine.TrackEntry.prototype={next:null,previous:null,animation:null,loop:!1,delay:0,time:0,lastTime:-1,endTime:0,timeScale:1,mixTime:0,mixDuration:0,mix:1,onStart:null,onEnd:null,onComplete:null,onEvent:null};spine.AnimationState=function(a){this.data=a;this.tracks=[];this.events=[]};
spine.AnimationState.prototype={onStart:null,onEnd:null,onComplete:null,onEvent:null,timeScale:1,update:function(a){a*=this.timeScale;for(var b=0;b<this.tracks.length;b++){var d=this.tracks[b];if(d){d.time+=a*d.timeScale;if(d.previous){var e=a*d.previous.timeScale;d.previous.time+=e;d.mixTime+=e}(e=d.next)?(e.time=d.lastTime-e.delay,0<=e.time&&this.setCurrent(b,e)):!d.loop&&d.lastTime>=d.endTime&&this.clearTrack(b)}}},apply:function(a){for(var b=0;b<this.tracks.length;b++){var d=this.tracks[b];if(d){this.events.length=
0;var e=d.time,f=d.lastTime,g=d.endTime,k=d.loop;!k&&e>g&&(e=g);var m=d.previous;if(m){var n=m.time;!m.loop&&n>m.endTime&&(n=m.endTime);m.animation.apply(a,n,n,m.loop,null);m=d.mixTime/d.mixDuration*d.mix;1<=m&&(m=1,d.previous=null);d.animation.mix(a,d.lastTime,e,k,this.events,m)}else 1==d.mix?d.animation.apply(a,d.lastTime,e,k,this.events):d.animation.mix(a,d.lastTime,e,k,this.events,d.mix);m=0;for(n=this.events.length;m<n;m++){var q=this.events[m];if(d.onEvent)d.onEvent(b,q);if(this.onEvent)this.onEvent(b,
q)}if(k?f%g>e%g:f<g&&e>=g){e=Math.floor(e/g);if(d.onComplete)d.onComplete(b,e);if(this.onComplete)this.onComplete(b,e)}d.lastTime=d.time}}},clearTracks:function(){for(var a=0,b=this.tracks.length;a<b;a++)this.clearTrack(a);this.tracks.length=0},clearTrack:function(a){if(!(a>=this.tracks.length)){var b=this.tracks[a];if(b){if(b.onEnd)b.onEnd(a);if(this.onEnd)this.onEnd(a);this.tracks[a]=null}}},_expandToIndex:function(a){if(a<this.tracks.length)return this.tracks[a];for(;a>=this.tracks.length;)this.tracks.push(null);
return null},setCurrent:function(a,b){var d=this._expandToIndex(a);if(d){var e=d.previous;d.previous=null;if(d.onEnd)d.onEnd(a);if(this.onEnd)this.onEnd(a);b.mixDuration=this.data.getMix(d.animation,b.animation);0<b.mixDuration&&(b.mixTime=0,b.previous=e&&.5>d.mixTime/d.mixDuration?e:d)}this.tracks[a]=b;if(b.onStart)b.onStart(a);if(this.onStart)this.onStart(a)},setAnimationByName:function(a,b,d){var e=this.data.skeletonData.findAnimation(b);if(!e)throw"Animation not found: "+b;return this.setAnimation(a,
e,d)},setAnimation:function(a,b,d){var e=new spine.TrackEntry;e.animation=b;e.loop=d;e.endTime=b.duration;this.setCurrent(a,e);return e},addAnimationByName:function(a,b,d,e){var f=this.data.skeletonData.findAnimation(b);if(!f)throw"Animation not found: "+b;return this.addAnimation(a,f,d,e)},addAnimation:function(a,b,d,e){var f=new spine.TrackEntry;f.animation=b;f.loop=d;f.endTime=b.duration;if(d=this._expandToIndex(a)){for(;d.next;)d=d.next;d.next=f}else this.tracks[a]=f;0>=e&&(e=d?e+(d.endTime-this.data.getMix(d.animation,
b)):0);f.delay=e;return f},getCurrent:function(a){return a>=this.tracks.length?null:this.tracks[a]}};spine.SkeletonJson=function(a){this.attachmentLoader=a};
spine.SkeletonJson.prototype={scale:1,readSkeletonData:function(a,b){var d=new spine.SkeletonData;d.name=b;var e=a.skeleton;e&&(d.hash=e.hash,d.version=e.spine,d.width=e.width||0,d.height=e.height||0);for(var f=a.bones,e=0,g=f.length;e<g;e++){var k=f[e],m=null;if(k.parent&&(m=d.findBone(k.parent),!m))throw"Parent bone not found: "+k.parent;m=new spine.BoneData(k.name,m);m.length=(k.length||0)*this.scale;m.x=(k.x||0)*this.scale;m.y=(k.y||0)*this.scale;m.rotation=k.rotation||0;m.scaleX=k.hasOwnProperty("scaleX")?
k.scaleX:1;m.scaleY=k.hasOwnProperty("scaleY")?k.scaleY:1;m.inheritScale=k.hasOwnProperty("inheritScale")?k.inheritScale:!0;m.inheritRotation=k.hasOwnProperty("inheritRotation")?k.inheritRotation:!0;d.bones.push(m)}if(m=a.ik)for(e=0,g=m.length;e<g;e++){for(var k=m[e],n=new spine.IkConstraintData(k.name),f=k.bones,q=0,s=f.length;q<s;q++){var t=d.findBone(f[q]);if(!t)throw"IK bone not found: "+f[q];n.bones.push(t)}n.target=d.findBone(k.target);if(!n.target)throw"Target bone not found: "+k.target;n.bendDirection=
!k.hasOwnProperty("bendPositive")||k.bendPositive?1:-1;n.mix=k.hasOwnProperty("mix")?k.mix:1;d.ikConstraints.push(n)}f=a.slots;e=0;for(g=f.length;e<g;e++){k=f[e];m=d.findBone(k.bone);if(!m)throw"Slot bone not found: "+k.bone;m=new spine.SlotData(k.name,m);if(n=k.color)m.r=this.toColor(n,0),m.g=this.toColor(n,1),m.b=this.toColor(n,2),m.a=this.toColor(n,3);m.attachmentName=k.attachment;m.blendMode=spine.BlendMode[k.blend||"normal"];d.slots.push(m)}var e=a.skins,u;for(u in e)if(e.hasOwnProperty(u)){var g=
e[u],f=new spine.Skin(u),v;for(v in g)if(g.hasOwnProperty(v)){var m=d.findSlotIndex(v),k=g[v],y;for(y in k)k.hasOwnProperty(y)&&(n=this.readAttachment(f,y,k[y]))&&f.addAttachment(m,y,n)}d.skins.push(f);"default"==f.name&&(d.defaultSkin=f)}u=a.events;for(var z in u)u.hasOwnProperty(z)&&(v=u[z],y=new spine.EventData(z),y.intValue=v["int"]||0,y.floatValue=v["float"]||0,y.stringValue=v.string||null,d.events.push(y));z=a.animations;for(var A in z)z.hasOwnProperty(A)&&this.readAnimation(A,z[A],d);return d},
readAttachment:function(a,b,d){b=d.name||b;var e=spine.AttachmentType[d.type||"region"],f=d.path||b,g=this.scale;if(e==spine.AttachmentType.region){a=this.attachmentLoader.newRegionAttachment(a,b,f);if(!a)return null;a.path=f;a.x=(d.x||0)*g;a.y=(d.y||0)*g;a.scaleX=d.hasOwnProperty("scaleX")?d.scaleX:1;a.scaleY=d.hasOwnProperty("scaleY")?d.scaleY:1;a.rotation=d.rotation||0;a.width=(d.width||0)*g;a.height=(d.height||0)*g;if(f=d.color)a.r=this.toColor(f,0),a.g=this.toColor(f,1),a.b=this.toColor(f,2),
a.a=this.toColor(f,3);a.updateOffset();return a}if(e==spine.AttachmentType.mesh){a=this.attachmentLoader.newMeshAttachment(a,b,f);if(!a)return null;a.path=f;a.vertices=this.getFloatArray(d,"vertices",g);a.triangles=this.getIntArray(d,"triangles");a.regionUVs=this.getFloatArray(d,"uvs",1);a.updateUVs();if(f=d.color)a.r=this.toColor(f,0),a.g=this.toColor(f,1),a.b=this.toColor(f,2),a.a=this.toColor(f,3);a.hullLength=2*(d.hull||0);d.edges&&(a.edges=this.getIntArray(d,"edges"));a.width=(d.width||0)*g;
a.height=(d.height||0)*g;return a}if(e==spine.AttachmentType.skinnedmesh){a=this.attachmentLoader.newSkinnedMeshAttachment(a,b,f);if(!a)return null;a.path=f;var k=this.getFloatArray(d,"uvs",1),f=this.getFloatArray(d,"vertices",1),m=[],n=[];b=0;for(e=f.length;b<e;){var q=f[b++]|0;n[n.length]=q;for(q=b+4*q;b<q;)n[n.length]=f[b],m[m.length]=f[b+1]*g,m[m.length]=f[b+2]*g,m[m.length]=f[b+3],b+=4}a.bones=n;a.weights=m;a.triangles=this.getIntArray(d,"triangles");a.regionUVs=k;a.updateUVs();if(f=d.color)a.r=
this.toColor(f,0),a.g=this.toColor(f,1),a.b=this.toColor(f,2),a.a=this.toColor(f,3);a.hullLength=2*(d.hull||0);d.edges&&(a.edges=this.getIntArray(d,"edges"));a.width=(d.width||0)*g;a.height=(d.height||0)*g;return a}if(e==spine.AttachmentType.boundingbox){a=this.attachmentLoader.newBoundingBoxAttachment(a,b);f=d.vertices;b=0;for(e=f.length;b<e;b++)a.vertices.push(f[b]*g);return a}throw"Unknown attachment type: "+e;},readAnimation:function(a,b,d){var e=[],f=0,g=b.slots,k;for(k in g)if(g.hasOwnProperty(k)){var m=
g[k],n=d.findSlotIndex(k),q;for(q in m)if(m.hasOwnProperty(q)){var s=m[q];if("color"==q){var t=new spine.ColorTimeline(s.length);t.slotIndex=n;for(var u=0,v=0,y=s.length;v<y;v++){var z=s[v],A=z.color,r=this.toColor(A,0),D=this.toColor(A,1),C=this.toColor(A,2),A=this.toColor(A,3);t.setFrame(u,z.time,r,D,C,A);this.readCurve(t,u,z);u++}e.push(t);f=Math.max(f,t.frames[5*t.getFrameCount()-5])}else if("attachment"==q){t=new spine.AttachmentTimeline(s.length);t.slotIndex=n;v=u=0;for(y=s.length;v<y;v++)z=
s[v],t.setFrame(u++,z.time,z.name);e.push(t);f=Math.max(f,t.frames[t.getFrameCount()-1])}else throw"Invalid timeline type for a slot: "+q+" ("+k+")";}}var n=b.bones,B;for(B in n)if(n.hasOwnProperty(B)){m=d.findBoneIndex(B);if(-1==m)throw"Bone not found: "+B;g=n[B];for(q in g)if(g.hasOwnProperty(q))if(s=g[q],"rotate"==q){t=new spine.RotateTimeline(s.length);t.boneIndex=m;v=u=0;for(y=s.length;v<y;v++)z=s[v],t.setFrame(u,z.time,z.angle),this.readCurve(t,u,z),u++;e.push(t);f=Math.max(f,t.frames[2*t.getFrameCount()-
2])}else if("translate"==q||"scale"==q){r=1;"scale"==q?t=new spine.ScaleTimeline(s.length):(t=new spine.TranslateTimeline(s.length),r=this.scale);t.boneIndex=m;v=u=0;for(y=s.length;v<y;v++)z=s[v],D=(z.x||0)*r,t.setFrame(u,z.time,D,(z.y||0)*r),this.readCurve(t,u,z),u++;e.push(t);f=Math.max(f,t.frames[3*t.getFrameCount()-3])}else if("flipX"==q||"flipY"==q){t=(D="flipX"==q)?new spine.FlipXTimeline(s.length):new spine.FlipYTimeline(s.length);t.boneIndex=m;r=D?"x":"y";v=u=0;for(y=s.length;v<y;v++)z=s[v],
t.setFrame(u,z.time,z[r]||!1),u++;e.push(t);f=Math.max(f,t.frames[2*t.getFrameCount()-2])}else throw"Invalid timeline type for a bone: "+q+" ("+B+")";}var n=b.ik,F;for(F in n)if(n.hasOwnProperty(F)){u=d.findIkConstraint(F);s=n[F];t=new spine.IkConstraintTimeline(s.length);t.ikConstraintIndex=d.ikConstraints.indexOf(u);v=u=0;for(y=s.length;v<y;v++)z=s[v],m=z.hasOwnProperty("mix")?z.mix:1,q=!z.hasOwnProperty("bendPositive")||z.bendPositive?1:-1,t.setFrame(u,z.time,m,q),this.readCurve(t,u,z),u++;e.push(t);
f=Math.max(f,t.frames[3*t.frameCount-3])}B=b.ffd;for(var J in B)for(k in g=d.findSkin(J),m=B[J],m){var n=d.findSlotIndex(k),r=m[k],L;for(L in r){s=r[L];t=new spine.FfdTimeline(s.length);D=g.getAttachment(n,L);if(!D)throw"FFD attachment not found: "+L;t.slotIndex=n;t.attachment=D;A=(C=D.type==spine.AttachmentType.mesh)?D.vertices.length:D.weights.length/3*2;v=u=0;for(y=s.length;v<y;v++){var z=s[v],G;if(z.vertices){var K=z.vertices;G=[];G.length=A;var P=z.offset||0;F=K.length;if(1==this.scale)for(q=
0;q<F;q++)G[q+P]=K[q];else for(q=0;q<F;q++)G[q+P]=K[q]*this.scale;if(C)for(K=D.vertices,q=0,F=G.length;q<F;q++)G[q]+=K[q]}else C?G=D.vertices:(G=[],G.length=A);t.setFrame(u,z.time,G);this.readCurve(t,u,z);u++}e[e.length]=t;f=Math.max(f,t.frames[t.frameCount-1])}}(k=b.drawOrder)||(k=b.draworder);if(k){t=new spine.DrawOrderTimeline(k.length);s=d.slots.length;v=u=0;for(y=k.length;v<y;v++){J=k[v];L=null;if(J.offsets){L=[];L.length=s;for(q=s-1;0<=q;q--)L[q]=-1;z=J.offsets;m=[];m.length=s-z.length;q=g=
B=0;for(F=z.length;q<F;q++){r=z[q];n=d.findSlotIndex(r.slot);if(-1==n)throw"Slot not found: "+r.slot;for(;B!=n;)m[g++]=B++;L[B+r.offset]=B++}for(;B<s;)m[g++]=B++;for(q=s-1;0<=q;q--)-1==L[q]&&(L[q]=m[--g])}t.setFrame(u++,J.time,L)}e.push(t);f=Math.max(f,t.frames[t.getFrameCount()-1])}if(b=b.events){t=new spine.EventTimeline(b.length);v=u=0;for(y=b.length;v<y;v++){k=b[v];s=d.findEvent(k.name);if(!s)throw"Event not found: "+k.name;J=new spine.Event(s);J.intValue=k.hasOwnProperty("int")?k["int"]:s.intValue;
J.floatValue=k.hasOwnProperty("float")?k["float"]:s.floatValue;J.stringValue=k.hasOwnProperty("string")?k.string:s.stringValue;t.setFrame(u++,k.time,J)}e.push(t);f=Math.max(f,t.frames[t.getFrameCount()-1])}d.animations.push(new spine.Animation(a,e,f))},readCurve:function(a,b,d){(d=d.curve)?"stepped"==d?a.curves.setStepped(b):d instanceof Array&&a.curves.setCurve(b,d[0],d[1],d[2],d[3]):a.curves.setLinear(b)},toColor:function(a,b){if(8!=a.length)throw"Color hexidecimal length must be 8, recieved: "+
a;return parseInt(a.substring(2*b,2*b+2),16)/255},getFloatArray:function(a,b,d){a=a[b];b=new spine.Float32Array(a.length);var e=0,f=a.length;if(1==d)for(;e<f;e++)b[e]=a[e];else for(;e<f;e++)b[e]=a[e]*d;return b},getIntArray:function(a,b){for(var d=a[b],e=new spine.Uint16Array(d.length),f=0,g=d.length;f<g;f++)e[f]=d[f]|0;return e}};
spine.Atlas=function(a,b){this.textureLoader=b;this.pages=[];this.regions=[];var d=new spine.AtlasReader(a),e=[];e.length=4;for(var f=null;;){var g=d.readLine();if(null===g)break;g=d.trim(g);if(g.length)if(f){var k=new spine.AtlasRegion;k.name=g;k.page=f;k.rotate="true"==d.readValue();d.readTuple(e);var g=parseInt(e[0]),m=parseInt(e[1]);d.readTuple(e);var n=parseInt(e[0]),q=parseInt(e[1]);k.u=g/f.width;k.v=m/f.height;k.rotate?(k.u2=(g+q)/f.width,k.v2=(m+n)/f.height):(k.u2=(g+n)/f.width,k.v2=(m+q)/
f.height);k.x=g;k.y=m;k.width=Math.abs(n);k.height=Math.abs(q);4==d.readTuple(e)&&(k.splits=[parseInt(e[0]),parseInt(e[1]),parseInt(e[2]),parseInt(e[3])],4==d.readTuple(e)&&(k.pads=[parseInt(e[0]),parseInt(e[1]),parseInt(e[2]),parseInt(e[3])],d.readTuple(e)));k.originalWidth=parseInt(e[0]);k.originalHeight=parseInt(e[1]);d.readTuple(e);k.offsetX=parseInt(e[0]);k.offsetY=parseInt(e[1]);k.index=parseInt(d.readValue());this.regions.push(k)}else f=new spine.AtlasPage,f.name=g,2==d.readTuple(e)&&(f.width=
parseInt(e[0]),f.height=parseInt(e[1]),d.readTuple(e)),f.format=spine.Atlas.Format[e[0]],d.readTuple(e),f.minFilter=spine.Atlas.TextureFilter[e[0]],f.magFilter=spine.Atlas.TextureFilter[e[1]],k=d.readValue(),f.uWrap=spine.Atlas.TextureWrap.clampToEdge,f.vWrap=spine.Atlas.TextureWrap.clampToEdge,"x"==k?f.uWrap=spine.Atlas.TextureWrap.repeat:"y"==k?f.vWrap=spine.Atlas.TextureWrap.repeat:"xy"==k&&(f.uWrap=f.vWrap=spine.Atlas.TextureWrap.repeat),b.load(f,g,this),this.pages.push(f);else f=null}};
spine.Atlas.prototype={findRegion:function(a){for(var b=this.regions,d=0,e=b.length;d<e;d++)if(b[d].name==a)return b[d];return null},dispose:function(){for(var a=this.pages,b=0,d=a.length;b<d;b++)this.textureLoader.unload(a[b].rendererObject)},updateUVs:function(a){for(var b=this.regions,d=0,e=b.length;d<e;d++){var f=b[d];f.page==a&&(f.u=f.x/a.width,f.v=f.y/a.height,f.rotate?(f.u2=(f.x+f.height)/a.width,f.v2=(f.y+f.width)/a.height):(f.u2=(f.x+f.width)/a.width,f.v2=(f.y+f.height)/a.height))}}};
spine.Atlas.Format={alpha:0,intensity:1,luminanceAlpha:2,rgb565:3,rgba4444:4,rgb888:5,rgba8888:6};spine.Atlas.TextureFilter={nearest:0,linear:1,mipMap:2,mipMapNearestNearest:3,mipMapLinearNearest:4,mipMapNearestLinear:5,mipMapLinearLinear:6};spine.Atlas.TextureWrap={mirroredRepeat:0,clampToEdge:1,repeat:2};spine.AtlasPage=function(){};spine.AtlasPage.prototype={name:null,format:null,minFilter:null,magFilter:null,uWrap:null,vWrap:null,rendererObject:null,width:0,height:0};spine.AtlasRegion=function(){};
spine.AtlasRegion.prototype={page:null,name:null,x:0,y:0,width:0,height:0,u:0,v:0,u2:0,v2:0,offsetX:0,offsetY:0,originalWidth:0,originalHeight:0,index:0,rotate:!1,splits:null,pads:null};spine.AtlasReader=function(a){this.lines=a.split(/\r\n|\r|\n/)};
spine.AtlasReader.prototype={index:0,trim:function(a){return a.replace(/^\s+|\s+$/g,"")},readLine:function(){return this.index>=this.lines.length?null:this.lines[this.index++]},readValue:function(){var a=this.readLine(),b=a.indexOf(":");if(-1==b)throw"Invalid line: "+a;return this.trim(a.substring(b+1))},readTuple:function(a){var b=this.readLine(),d=b.indexOf(":");if(-1==d)throw"Invalid line: "+b;for(var e=0,d=d+1;3>e;e++){var f=b.indexOf(",",d);if(-1==f)break;a[e]=this.trim(b.substr(d,f-d));d=f+
1}a[e]=this.trim(b.substring(d));return e+1}};spine.AtlasAttachmentLoader=function(a){this.atlas=a};
spine.AtlasAttachmentLoader.prototype={newRegionAttachment:function(a,b,d){a=this.atlas.findRegion(d);if(!a)throw"Region not found in atlas: "+d+" (region attachment: "+b+")";b=new spine.RegionAttachment(b);b.rendererObject=a;b.setUVs(a.u,a.v,a.u2,a.v2,a.rotate);b.regionOffsetX=a.offsetX;b.regionOffsetY=a.offsetY;b.regionWidth=a.width;b.regionHeight=a.height;b.regionOriginalWidth=a.originalWidth;b.regionOriginalHeight=a.originalHeight;return b},newMeshAttachment:function(a,b,d){a=this.atlas.findRegion(d);
if(!a)throw"Region not found in atlas: "+d+" (mesh attachment: "+b+")";b=new spine.MeshAttachment(b);b.rendererObject=a;b.regionU=a.u;b.regionV=a.v;b.regionU2=a.u2;b.regionV2=a.v2;b.regionRotate=a.rotate;b.regionOffsetX=a.offsetX;b.regionOffsetY=a.offsetY;b.regionWidth=a.width;b.regionHeight=a.height;b.regionOriginalWidth=a.originalWidth;b.regionOriginalHeight=a.originalHeight;return b},newSkinnedMeshAttachment:function(a,b,d){a=this.atlas.findRegion(d);if(!a)throw"Region not found in atlas: "+d+
" (skinned mesh attachment: "+b+")";b=new spine.SkinnedMeshAttachment(b);b.rendererObject=a;b.regionU=a.u;b.regionV=a.v;b.regionU2=a.u2;b.regionV2=a.v2;b.regionRotate=a.rotate;b.regionOffsetX=a.offsetX;b.regionOffsetY=a.offsetY;b.regionWidth=a.width;b.regionHeight=a.height;b.regionOriginalWidth=a.originalWidth;b.regionOriginalHeight=a.originalHeight;return b},newBoundingBoxAttachment:function(a,b){return new spine.BoundingBoxAttachment(b)}};
spine.SkeletonBounds=function(){this.polygonPool=[];this.polygons=[];this.boundingBoxes=[]};
spine.SkeletonBounds.prototype={minX:0,minY:0,maxX:0,maxY:0,update:function(a,b){for(var d=a.slots,e=d.length,f=a.x,g=a.y,k=this.boundingBoxes,m=this.polygonPool,n=this.polygons,q=k.length=0,s=n.length;q<s;q++)m.push(n[q]);for(q=n.length=0;q<e;q++){var s=d[q],t=s.attachment;if(t.type==spine.AttachmentType.boundingbox){k.push(t);var u=m.length,v;0<u?(v=m[u-1],m.splice(u-1,1)):v=[];n.push(v);v.length=t.vertices.length;t.computeWorldVertices(f,g,s.bone,v)}}b&&this.aabbCompute()},aabbCompute:function(){for(var a=
this.polygons,b=Number.MAX_VALUE,d=Number.MAX_VALUE,e=Number.MIN_VALUE,f=Number.MIN_VALUE,g=0,k=a.length;g<k;g++)for(var m=a[g],n=0,q=m.length;n<q;n+=2)var s=m[n],t=m[n+1],b=Math.min(b,s),d=Math.min(d,t),e=Math.max(e,s),f=Math.max(f,t);this.minX=b;this.minY=d;this.maxX=e;this.maxY=f},aabbContainsPoint:function(a,b){return a>=this.minX&&a<=this.maxX&&b>=this.minY&&b<=this.maxY},aabbIntersectsSegment:function(a,b,d,e){var f=this.minX,g=this.minY,k=this.maxX,m=this.maxY;if(a<=f&&d<=f||b<=g&&e<=g||a>=
k&&d>=k||b>=m&&e>=m)return!1;d=(e-b)/(d-a);e=d*(f-a)+b;if(e>g&&e<m)return!0;e=d*(k-a)+b;if(e>g&&e<m)return!0;g=(g-b)/d+a;if(g>f&&g<k)return!0;g=(m-b)/d+a;return g>f&&g<k?!0:!1},aabbIntersectsSkeleton:function(a){return this.minX<a.maxX&&this.maxX>a.minX&&this.minY<a.maxY&&this.maxY>a.minY},containsPoint:function(a,b){for(var d=this.polygons,e=0,f=d.length;e<f;e++)if(this.polygonContainsPoint(d[e],a,b))return this.boundingBoxes[e];return null},intersectsSegment:function(a,b,d,e){for(var f=this.polygons,
g=0,k=f.length;g<k;g++)if(f[g].intersectsSegment(a,b,d,e))return this.boundingBoxes[g];return null},polygonContainsPoint:function(a,b,d){for(var e=a.length,f=e-2,g=!1,k=0;k<e;k+=2){var m=a[k+1],n=a[f+1];if(m<d&&n>=d||n<d&&m>=d){var q=a[k];q+(d-m)/(n-m)*(a[f]-q)<b&&(g=!g)}f=k}return g},polygonIntersectsSegment:function(a,b,d,e,f){for(var g=a.length,k=b-e,m=d-f,n=b*f-d*e,q=a[g-2],s=a[g-1],t=0;t<g;t+=2){var u=a[t],v=a[t+1],y=q*v-s*u,z=q-u,A=s-v,r=k*A-m*z,z=(n*z-k*y)/r;if((z>=q&&z<=u||z>=u&&z<=q)&&(z>=
b&&z<=e||z>=e&&z<=b)&&(q=(n*A-m*y)/r,(q>=s&&q<=v||q>=v&&q<=s)&&(q>=d&&q<=f||q>=f&&q<=d)))return!0;q=u;s=v}return!1},getPolygon:function(a){a=this.boundingBoxes.indexOf(a);return-1==a?null:this.polygons[a]},getWidth:function(){return this.maxX-this.minX},getHeight:function(){return this.maxY-this.minY}};
var Clock=function(a){this.targetfps=a||60;this.last=this.ms=this.startTime=Date.now();this.frameCount=this.fps=this.delta=this.dt=this.time=0;this.frameCounter=!0;var b=0,d=0;this.tick=function(){this.frameCounter&&this.frameCount++;this.ms=Date.now();this.dt=this.ms-this.last;this.last=this.ms;this.delta=this.dt/(1E3/this.targetfps);this.time+=.001*this.dt;this.frameCounter&&(b+=this.dt,d++,1E3<b&&(this.fps=Math.round(1E3*d/b),b=d=0))}};
function loadString(a){var b=new XMLHttpRequest;b.open("GET",a,!1);b.send(null);return 200==b.status||0==b.status?b.responseText:""}String.prototype.ltrim=function(a){return a?this.replace(new RegExp("^["+a+"]+"),""):this.replace(/^\s+/,"")};String.prototype.rtrim=function(a){return a?this.replace(new RegExp("["+a+"]+$"),""):this.replace(/\s+$/,"")};String.prototype.trim=function(a){return a?this.ltrim(a).rtrim(a):this.ltrim().rtrim()};String.prototype.startsWith=function(a){return!this.indexOf(a)};
CG.Class.extend("CanvasRenderer",{init:function(a){return this},draw:function(a){Game.b_ctx.save();switch(a.instanceOf){case "Sprite":case "Button":case "Particle":Game.b_ctx.globalAlpha=a.alpha;Game.b_ctx.transform(1,0,0,1,a.position.x,a.position.y);a.atlasimage?(Game.b_ctx.rotate((a.rotation-a.imagerotation)*CG.Const_PI_180),Game.b_ctx.drawImage(a.image,a.xoffset,a.yoffset,a.cutwidth,a.cutheight,0-a.xhandle,0-a.yhandle,a.cutwidth*a.xscale,a.cutheight*a.yscale)):(Game.b_ctx.rotate(a.rotation*CG.Const_PI_180),
Game.b_ctx.drawImage(a.image,0-a.xhandle,0-a.yhandle,a.image.width*a.xscale,a.image.height*a.yscale));break;case "SpineAnimation":Game.b_ctx.globalAlpha=a.alpha;Game.b_ctx.transform(a.transform.m[0],a.transform.m[1],a.transform.m[2],a.transform.m[3],a.transform.m[4],a.transform.m[5]);Game.b_ctx.drawImage(a.image,a.xoffset,a.yoffset,a.cutwidth,a.cutheight,a.xpos,a.ypos,a.cutwidth*a.xscale,a.cutheight*a.yscale);break;case "Animation":Game.b_ctx.globalAlpha=a.alpha;Game.b_ctx.transform(1,0,0,1,a.position.x,
a.position.y);1==a.frames?Game.b_ctx.drawImage(a.image,a.position.x,a.position.y,a.image.width*a.xscale,a.image.height*a.yscale):(a.fx=a.currentFrame*a.width,0<a.fx/a.image.width&&(a.fx%=a.image.width),a.fy=Math.floor(a.width*a.currentFrame/a.image.width)*a.height,Game.b_ctx.rotate(a.rotation*CG.Const_PI_180),Game.b_ctx.drawImage(a.image,a.fx,a.fy,a.width,a.height,0-a.xhandle,0-a.yhandle,a.width*a.xscale,a.height*a.yscale));break;case "Font":for(var b=0,d=a.text.length;b<d;b++){var e=a.text.charCodeAt(b);
Game.b_ctx.drawImage(a.atlas,a.x[e],a.y[e],a.width[e],a.height[e],a.currentX,a.currentY+a.yoff[e],a.width[e],a.height[e]);a.currentX+=a.xadv[e]}break;case "Bitmap":Game.b_ctx.drawImage(a.bitmap_canvas,a.x,a.y);break;case "Map":Game.b_ctx.globalAlpha=a.layers[a.layer].opacity;Game.b_ctx.transform(1,0,0,1,a.rx,a.ry);"orthogonal"==a.orientation?Game.b_ctx.drawImage(a.atlas,a.cx,a.cy,a.tilewidth,a.tileheight,a.sx,a.sy,a.tilewidth*a.xscale,a.tileheight*a.yscale):"isometric"==a.orientation&&Game.b_ctx.drawImage(a.atlas,
a.cx,a.cy,a.tilewidth,a.tileset.tileheight,a.sx,a.sy,a.tilewidth*a.xscale,a.tileset.tileheight*a.yscale);break;case "B2DEntity":case "B2DCircle":case "B2DRectangle":case "B2DPolygon":case "B2DBridge":case "B2DRope":Game.b_ctx.globalAlpha=a.alpha,Game.b_ctx.transform(1,0,0,1,a.body.GetPosition().x*a.scale,a.body.GetPosition().y*a.scale),a.atlasimage?(Game.b_ctx.rotate(a.body.GetAngle()-a.imagerotation),Game.b_ctx.drawImage(a.image,a.xoffset,a.yoffset,a.cutwidth,a.cutheight,0-a.xhandle,0-a.yhandle,
a.cutwidth,a.cutheight)):(Game.b_ctx.rotate(a.body.GetAngle()),Game.b_ctx.drawImage(a.image,0-a.xhandle,0-a.yhandle,a.image.width,a.image.height))}Game.b_ctx.restore()}});CG.Class.extend("Delta",{init:function(a){this.targetfps=a;this.currenttime=0;this.lasttime=Date.now();this.fps=this.delta=this.frametime=this.elapsedtime=0},update:function(){this.fps=1/((Date.now()-this.lasttime)/1E3);this.lasttime=Date.now()},getDelta:function(){return this.delta},getFPS:function(){return this.fps}});
CG.Class.extend("Entity",{init:function(a){CG._extend(this,{name:"",position:new CG.Point(0,0),visible:!0,transform:new Transform,width:0,height:0,dragable:!0,rotation:0,xscale:1,xhandle:0,yscale:1,yhandle:0,clicked:!1,hover:!1,boundingradius:0,mapcollision:!1});a&&CG._extend(this,a);return this},update:function(){},updateMatrix:function(){this.transform.reset();this.transform.translate(this.position.x,this.position.y);this.transform.rotate(this.rotation*CG.Const_PI_180);this.transform.scale(this.xscale,
this.yscale)},draw:function(){throw{name:"Entity Error",message:"Subclass has no draw method."};},setImage:function(a){this.atlasimage=!1;a&&(a instanceof CG.AtlasImage?(this.image=Game.asset.getImageByName(a.atlasname),this.imagerotation=a.rotation,this.xoffset=a.xoffset,this.yoffset=a.yoffset,this.width=a.width,this.height=a.height,this.atlasimage=!0,0!==this.imagerotation?(this.cutwidth=a.height,this.cutheight=a.width,this.xhandle=this.height/2,this.yhandle=this.width/2):(this.cutwidth=a.width,
this.cutheight=a.height,this.xhandle=this.width/2,this.yhandle=this.height/2)):"string"==typeof a&&""!=a?(this.image=new Image,this.image.src=a,this.image.onload=function(){this.width=this.image.width;this.height=this.image.height;this.xhandle=this.width/2;this.yhandle=this.height/2}):(this.image=a,this.width=this.image.width,this.height=this.image.height,this.xhandle=this.width/2,this.yhandle=this.height/2))},AABB:function(){var a=this.rotation*CG.Const_PI_180,b=Math.sin(a),a=Math.cos(a);0>b&&(b=
-b);0>a&&(a=-a);return{bw:this.height*this.xscale*b+this.width*this.yscale*a,bh:this.height*this.xscale*a+this.width*this.yscale*b}},ifClicked:function(){if(CG.mousedown&&this.clickable){var a=CG.mouse.x-this.position.x,b=CG.mouse.y-this.position.y,d=Math.sqrt(a*a+b*b),b=Math.atan2(b,a)-this.rotation*CG.Const_PI_180,a=Math.cos(b)*d,d=Math.sin(b)*d;a>-.5*this.width*this.xscale&&a<.5*this.width*this.xscale&&d>-.5*this.height*this.yscale&&d<.5*this.height*this.yscale?(this.clicked=!0,CG.mousedown=!1):
this.clicked=!1}},ifMouseOver:function(){var a=CG.mouse.x-this.position.x,b=CG.mouse.y-this.position.y,d=Math.sqrt(a*a+b*b),b=Math.atan2(b,a)-this.rotation*CG.Const_PI_180,a=Math.cos(b)*d,d=Math.sin(b)*d;this.hover=a>-.5*this.width*this.xscale&&a<.5*this.width*this.xscale&&d>-.5*this.height*this.yscale&&d<.5*this.height*this.yscale?!0:!1},checkCollision:function(a,b){a.forEach(function(a,e){"MapArea"==a.className?this.position.y+this.AABB().bh/2>=a.bound.y&&this.position.y-this.AABB().bh/2<=a.bound.y+
a.bound.height&&this.position.x+this.AABB().bw/2>=a.bound.x&&this.position.x-this.AABB().bw/2<=a.bound.x+a.bound.width&&"outer"===a.type&&(w=.5*(this.width+a.bound.width),h=.5*(this.height+a.bound.height),dx=this.position.x-(a.bound.width/2+a.bound.x),dy=this.position.y-(a.bound.height/2+a.bound.y),Math.abs(dx)<=w&&Math.abs(dy)<=h&&(wy=w*dy,hx=h*dx,wy>hx?wy>-hx?(direction="bottom",overlap=this.position.y-this.AABB().bh/2-(a.bound.y+a.bound.height)>>0):(direction="left",overlap=this.position.x+this.AABB().bw/
2-a.bound.x>>0):wy>-hx?(direction="right",overlap=this.position.x-this.AABB().bw/2-(a.bound.x+a.bound.width)>>0):(direction="top",overlap=this.position.y+this.AABB().bh/2-a.bound.y>>0)),collision={overlap:overlap,direction:direction},b(this,a,collision)):0<this.boundingradius&&0<a.boundingradius?(distx=this.position.x-a.position.x,disty=this.position.y-a.position.y,dist=Math.sqrt(distx*distx+disty*disty),dist<=this.boundingradius/2*this.xscale+a.boundingradius/2*a.yscale&&(collision=!1,b(this,a,collision))):
this.position.y+this.AABB().bh/2>=a.position.y-a.AABB().bh/2&&this.position.y-this.AABB().bh/2<=a.position.y+a.AABB().bh/2&&this.position.x+this.AABB().bw/2>=a.position.x-a.AABB().bw/2&&this.position.x-this.AABB().bw/2<=a.position.x+a.AABB().bw/2&&(w=.5*(this.width+a.width),h=.5*(this.height+a.height),dx=this.position.x-a.position.x,dy=this.position.y-a.position.y,Math.abs(dx)<=w&&Math.abs(dy)<=h&&(wy=w*dy,hx=h*dx,wy>hx?wy>-hx?(direction="bottom",overlap=this.position.y-this.AABB().bh/2-(a.position.y-
a.AABB().bh/2)>>0):(direction="left",overlap=this.position.x+this.AABB().bw/2-(a.position.x+a.AABB().bw/2)>>0):wy>-hx?(direction="right",overlap=this.position.x-this.AABB().bw/2-(a.position.x-a.AABB().bw/2)>>0):(direction="top",overlap=this.position.y+this.AABB().bh/2-(a.position.y+a.AABB().bh/2)>>0)),collision={overlap:overlap,direction:direction},b(this,a,collision))},this);return this}});function EntityException(a){this.msg=a;console.log(this.msg)}
CG.Class.extend("Point",{init:function(a,b){this.x=a||0;this.y=b||0}});CG.Point.extend("Vector",{init:function(a,b,d){this._super(this,a,b);this.z=d||0}});CG.Class.extend("Bound",{init:function(a){CG._extend(this,{x:0,y:0,width:0,height:0});a&&CG._extend(this,a);return this},setName:function(a){this.name=a;return this}});
CG.Class.extend("Buffer",{init:function(a,b){this.b_canvas=document.createElement("canvas");this.b_canvas.width=a;this.b_canvas.height=b;this.b_ctx=this.b_canvas.getContext("2d");return this}});
CG.Class.extend("Stick",{init:function(a){CG._extend(this,{active:!1,identifier:-1,handle:CG.LEFT_HAND,atLimit:!1,length:1,maxLength:0,limit:{x:0,Y:0},input:{x:0,Y:0},normal:{x:0,Y:0}});a&&CG._extend(this,a);return this},draw:function(){this.active&&(Game.b_ctx.save(),Game.b_ctx.globalAlpha=.6,Game.b_ctx.beginPath(),Game.b_ctx.strokeStyle="rgb(100,100,100)",Game.b_ctx.lineWidth=1,Game.b_ctx.arc(this.limit.x,this.limit.y,this.maxLength,0,2*Math.PI,!0),Game.b_ctx.stroke(),Game.b_ctx.beginPath(),Game.b_ctx.arc(this.limit.x,
this.limit.y,this.maxLength,0,2*Math.PI,!0),Game.b_ctx.stroke(),Game.b_ctx.beginPath(),Game.b_ctx.arc(this.input.x,this.input.y,this.maxLength/1.5,0,2*Math.PI,!0),Game.b_ctx.fillStyle="rgb(200, 200, 200)",Game.b_ctx.fill(),Game.b_ctx.restore())},update:function(){if(this.active){var a=this.subtractVectors(this.input,this.limit),b=this.getVectorLength(a);if(Math.round(b)>=this.maxLength){var b=this.maxLength,d=this.getRadians(a.x,a.y);this.atLimit=!0;this.input=this.getVectorFromRadians(d,b);this.input.x+=
this.limit.x;this.input.y+=this.limit.y}else this.atLimit=!1;this.length=b;this.normal=this.getVectorNormal(a)}},getRadians:function(a,b){return Math.atan2(a,-b)},getVectorFromRadians:function(a,b){b=Number(b)||1;return{x:Math.sin(a)*b,y:-Math.cos(a)*b}},getVectorLength:function(a){return Math.sqrt(a.x*a.x+a.y*a.y)},getVectorNormal:function(a){var b=this.getVectorLength(a);return 0===b?a:{x:1/b*a.x,y:1/b*a.y}},setLimitXY:function(a,b){this.limit={x:a,y:b}},setInputXY:function(a,b){this.input={x:a,
y:b}},subtractVectors:function(a,b){return{x:a.x-b.x,y:a.y-b.y}}});
CG.Stick.extend("GameController",{init:function(a){this._super(a);CG._extend(this,{buttons:[],visible:!0});a&&CG._extend(this,a);this.addEventListener();return this},addEventListener:function(){Game.canvas.addEventListener("touchstart",function(a){a.preventDefault();var b=a.touches[0];-1===this.identifier&&(this.handle===CG.LEFT_HAND&&b.pageX<Game.width2?(this.setLimitXY(b.pageX,b.pageY),this.setInputXY(b.pageX,b.pageY),this.active=!0,this.identifier=b.identifier):this.handle===CG.RIGHT_HAND&&b.pageX>
Game.width2&&(this.setLimitXY(b.pageX,b.pageY),this.setInputXY(b.pageX,b.pageY),this.active=!0,this.identifier=b.identifier));1<a.touches.length&&this.active&&(b=a.touches[1],CG.mousedown=!0,CG.mouse={x:b.pageX,y:b.pageY})}.bind(this));Game.canvas.addEventListener("touchmove",function(a){a.preventDefault();for(var b=0;b<a.touches.length;++b){var d=a.touches[b];d.identifier===this.identifier&&this.setInputXY(d.pageX,d.pageY)}}.bind(this));Game.canvas.addEventListener("touchend",function(a){for(var b=
0;b<a.changedTouches.length;++b)a.changedTouches[b].identifier===this.identifier&&(this.active=!1,this.identifier=-1)}.bind(this))},draw:function(){if(this.active){this._super();for(var a=0,b=this.buttons.length;a<b;a++)this.buttons[a].draw()}},update:function(){if(this.active){this._super();for(var a=0,b=this.buttons.length;a<b;a++)this.buttons[a].update()}}});
CG.Entity.extend("Sprite",{init:function(a){this._super();this.instanceOf="Sprite";CG._extend(this,{bound:Game.bound,xspeed:0,yspeed:0,boundsMode:!1,rotationspeed:0,alpha:1,followobject:!1,followspeed:!1,followsteps:!1,attachedobject:!1,offsetx:0,offsety:0});CG._extend(this,a);this.setImage(this.image);this.diffpoint=new CG.Point(this.bound.x,this.bound.y);return this},update:function(){this.ifClicked();this.ifMouseOver();this.ifAttached();this.followobject&&this.follow();this.position.x+=this.xspeed;
this.position.y+=this.yspeed;this.rotation+=this.rotationspeed;this.xhandle=this.width*this.xscale/2;this.yhandle=this.height*this.yscale/2;this.boundsMode&&this.checkBound();this.updateDiff();this.updateMatrix()},draw:function(){Game.renderer.draw(this)},checkBound:function(){switch(this.boundsMode){case "bounce":this.position.x>this.bound.width-this.xhandle+this.bound.x?(this.position.x=this.bound.width-this.xhandle+this.bound.x,this.xspeed*=-1):this.position.x<this.bound.x+this.xhandle&&(this.position.x=
this.bound.x+this.xhandle,this.xspeed*=-1);this.position.y>this.bound.height-this.yhandle+this.bound.y?(this.position.y=this.bound.height-this.yhandle+this.bound.y,this.yspeed*=-1):this.position.y<this.bound.y+this.yhandle&&(this.position.y=this.bound.y+this.yhandle,this.yspeed*=-1);break;case "slide":this.position.x>this.bound.width+this.xhandle+this.bound.x?this.position.x=this.bound.x-this.xhandle:this.position.x<this.bound.x-this.xhandle&&(this.position.x=this.bound.x+this.bound.width+this.xhandle),
this.position.y>this.bound.height+this.yhandle+this.bound.y?this.position.y=this.bound.y-this.yhandle:this.position.y<this.bound.y-this.yhandle&&(this.position.y=this.bound.height+this.yhandle+this.bound.y)}},updateDiff:function(){this.diffpoint.x!==this.bound.x&&(this.position.x+=this.bound.x-this.diffpoint.x);this.diffpoint.y!==this.bound.y&&(this.position.y+=this.bound.y-this.diffpoint.y);this.diffpoint.x=this.bound.x;this.diffpoint.y=this.bound.y},follow:function(){this.followspeed?(angl=Math.atan2(this.followobject.position.x-
this.position.x,this.followobject.position.y-this.position.y)*CG.Const_180_PI,xs=this.followspeed*Math.sin(angl*CG.Const_PI_180),ys=this.followspeed*Math.cos(angl*CG.Const_PI_180),this.xspeed=xs,this.yspeed=ys,this.rotation=-1*angl):this.followsteps&&(angl=Math.atan2(this.followobject.position.x-this.position.x,this.followobject.position.y-this.position.y)*CG.Const_180_PI,this.rotation=-1*angl,this.followobject.position.x!=this.position.x?(distx=this.followobject.position.x-this.position.x,this.xspeed=
distx/this.followsteps):this.xspeed=0,this.followobject.position.y!=this.position.y?(disty=this.followobject.position.y-this.position.y,this.yspeed=disty/this.followsteps):this.yspeed=0)},setBound:function(a){this.bound=a;return this},ifAttached:function(){0!=this.attachedobject&&(this.attachedobject.position._x=this.attachedobject.position.x=this.position.x+this.offsetx,this.attachedobject.position._y=this.attachedobject.position.y=this.position.y+this.offsety)},attachObject:function(a){this.attachedobject=
a;return this},removeAttachedObject:function(){this.attachedobject=null;return this},setAttachedOffsetX:function(a){this.offsetx=a;return this},setAttachedOffsetY:function(a){this.offsety=a;return this}});
CG.Entity.extend("SpineAnimation",{init:function(a){this._super();this.instanceOf="SpineAnimation";var b=this;a&&CG._extend(this,a);this.lastTime=Date.now();this.skeletonposition=this.position||new CG.Point(0,0);this.yscale=this.xscale=1;this.scale=this.scale||1;this.vertices=[];this.textureCount=0;if("text"==this.spineatlas.type)this.spineAtlasData=this.spineatlas.data,console.log("spine atlas: text (libGDX) used");else{if("json"==this.spineatlas.type)throw this.spineAtlasData=this.spineatlas.src,
console.log("spine atlas: json"),"json format is not supported by spine-js runtime?";throw"check your atlas file format?";}this.spineJsonData=this.spinejson.data;this.initCustom=this.callback;this.spineAtlas=new spine.Atlas(this.spineAtlasData,{load:function(a,e){this.textureCount++;var f=new Image;f.onload=function(){a.rendererObject=f;a.width=f.width;a.height=f.height;b.spineAtlas.updateUVs(a);this.textureCount--};f.onerror=function(){throw"error: atlas image not loaded! "+e;};f.src="media/spine/"+
e},unload:function(a){}});this.waitForTextures()},waitForTextures:function(){this.textureCount?setTimeout(this.waitForTextures,100):this.initSkeleton()},initSkeleton:function(){this.skeletonJson=new spine.SkeletonJson(new spine.AtlasAttachmentLoader(self.spineAtlas));this.skeletonJson.scale=this.scale;this.skeletonData="object"===typeof this.spineJsonData?this.skeletonJson.readSkeletonData(this.spineJsonData):this.skeletonJson.readSkeletonData(JSON.parse(this.spineJsonData));spine.Bone.yDown=!0;this.skeleton=
new spine.Skeleton(this.skeletonData);this.skeleton.getRootBone().x=this.skeletonposition.x||0;this.skeleton.getRootBone().y=this.skeletonposition.y||0;this.skeleton.updateWorldTransform();this.stateData=new spine.AnimationStateData(this.skeletonData);this.state=new spine.AnimationState(this.stateData);this.initCustom(this);this.state.onEvent=function(a,b){}},update:function(){var a=(Date.now()-this.lastTime)/1E3;this.lastTime=Date.now();this.state.update(a);this.state.apply(this.skeleton);this.skeleton.updateWorldTransform()},
draw:function(){for(var a=this.skeleton.drawOrder,b=0,d=a.length;b<d;b++){var e=a[b],f=e.attachment,g=e.bone;if(f instanceof spine.RegionAttachment){f.computeVertices(this.skeleton.x,this.skeleton.y,e.bone,this.vertices);try{this.alpha=e.a,this.position=new CG.Point(this.vertices[2],this.vertices[3]),this.xscale=g.worldScaleX,this.yscale=g.worldScaleY,this.rotation=-(g.worldRotation+f.rotation),this.updateDiff(),this.updateMatrix.call(this),this.xoffset=f.rendererObject.x,this.yoffset=f.rendererObject.y,
this.cutwidth=f.width,this.cutheight=f.height,this.xhandle=this.cutwidth/2*this.xscale,this.yhandle=this.cutheight/2*this.yscale,this.ypos=this.xpos=0,this.skeleton.flipX&&(this.xscale*=-1,this.xpos=this.cutwidth,this.rotation*=-1),this.skeleton.flipY&&(this.yscale*=-1,this.ypos=this.cutheight,this.rotation*=-1),this.imagerotation=0,this.image=f.rendererObject.page.rendererObject,this.width=f.rendererObject.page.rendererObject.width,this.height=f.rendererObject.page.rendererObject.height,Game.renderer.draw(this)}catch(k){}}}},
updateDiff:function(){}});CG.Class.extend("AtlasImage",{init:function(a){CG._extend(this,{source:"",atlasimage:"",atlasname:"",image:"",xoffset:0,yoffset:0,width:0,height:0,rotation:0});a&&(CG._extend(this,a),this.name=this.image.split(/(\\|\/)/g).pop().split(".")[0])}});
CG.Class.extend("AtlasTexturePacker",{init:function(){"undefined"!==typeof ejecta||navigator.isCocoonJS||(this.xmlDoc=this.xml="",this.parser=new DOMParser||{});this.imagename="";this.height=this.width=0;this.atlasimages=[];return this},loadXml:function(a){this.xml="string"==typeof a?loadString(a):a.data;this.xmlDoc=this.parser.parseFromString(this.xml,"text/xml");this.imagename=this.xmlDoc.getElementsByTagName("TextureAtlas")[0].getAttribute("imagePath");this.width=parseInt(this.xmlDoc.getElementsByTagName("TextureAtlas")[0].getAttribute("width"));
this.height=parseInt(this.xmlDoc.getElementsByTagName("TextureAtlas")[0].getAttribute("height"));a=this.xmlDoc.getElementsByTagName("sprite");for(var b=0,d=a.length;b<d;b++){var e=new CG.atlasimage({image:a[b].getAttribute("n"),xoffset:parseInt(a[b].getAttribute("x")),yoffset:parseInt(a[b].getAttribute("y")),width:parseInt(a[b].getAttribute("w")),height:parseInt(a[b].getAttribute("h"))});"y"==a[b].getAttribute("r")&&(e.rotation=90,console.log("!!! support for rotated images in atlas files would be dropped in future versions !!!"));
e.atlasimage=this.imagename;e.source="xml";e.atlasname=this.imagename.split(/(\\|\/)/g).pop().split(".")[0];this.atlasimages.push(e)}return this},loadJson:function(a){this.json="string"==typeof a?JSON.parse(loadString(a)):a.data;this.imagename=this.json.meta.image;this.width=this.json.meta.size.w;this.height=this.json.meta.size.h;a=0;for(var b=this.json.frames.length;a<b;a++){var d=this.json.frames[a],e=new CG.AtlasImage({image:d.filename,xoffset:d.frame.x,yoffset:d.frame.y,width:d.frame.w,height:d.frame.h});
!0===d.rotated&&(e.rotation=90,console.log("!!! support for rotated images in atlas files would be dropped in future versions !!!"));e.atlasimage=this.imagename;e.source="json";e.atlasname=this.imagename.split(/(\\|\/)/g).pop().split(".")[0];this.atlasimages.push(e)}return this},getAtlasImages:function(){return this.atlasimages}});
CG.Sprite.extend("Animation",{init:function(a){this._super(a);this.instanceOf="Animation";CG._extend(this,{loop:!0,status:0,currentFrame:0,frames:0,startFrame:1,endFrame:1,fx:0,fy:0,delay:0,tempdelay:0});a&&CG._extend(this,a);this.startFrame-=1;this.endFrame-=1;void 0===this.startFrame&&void 0===this.endFrame?(this.frames=1,this.endFrame=this.startFrame=0):(this.currentFrame=this.startFrame-1,this.frames=this.endFrame-this.startFrame+1);return this},update:function(){0==this.status&&(this.tempdelay+=
1,this.tempdelay>=this.delay&&(this.tempdelay=0,1<this.frames&&(this.currentFrame+=1,this.currentFrame-this.startFrame>=this.frames&&(!1===this.loop?this.status=1:this.currentFrame=this.startFrame))));this._super()},draw:function(){Game.renderer.draw(this)}});
CG.Entity.extend("Bitmap",{init:function(a){this.instanceOf="Bitmap";CG._extend(this,{x:0,y:0,tolerance:128});a&&CG._extend(this,a);this.bitmap_canvas=document.createElement("canvas");this.bitmap_ctx=this.bitmap_canvas.getContext("2d");this.bitmap_ctx.fillStyle="#000000";this.bitmap_canvas.width=this.width;this.bitmap_canvas.height=this.height;return this},loadImage:function(a){this.setImage(a);this.drawImageToBuffer();return this},update:function(){},draw:function(){Game.renderer.draw(this)},clearBuffer:function(){this.bitmap_ctx.clearRect(0,
0,this.bitmap_canvas.width,this.bitmap_canvas.height);return this},drawImageToBuffer:function(){this.image&&this.bitmap_ctx.drawImage(this.image,0,0);return this},clearRect:function(a,b,d,e){this.bitmap_ctx.save();this.bitmap_ctx.globalCompositeOperation="destination-out";this.bitmap_ctx.clearRect(a,b,d,e);this.bitmap_ctx.restore()},clearCircle:function(a,b,d){this.bitmap_ctx.save();this.bitmap_ctx.globalCompositeOperation="destination-out";this.bitmap_ctx.beginPath();this.bitmap_ctx.arc(a,b,d,0,
2*Math.PI,!1);this.bitmap_ctx.closePath();this.bitmap_ctx.fill();this.bitmap_ctx.restore()},getPixel:function(a,b){return this.bitmap_ctx.getImageData(a,b,1,1)},getPixels:function(a,b,d,e){return this.bitmap_ctx.getImageData(a,b,d,e)},getPixelAlpha:function(a,b){return this.bitmap_ctx.getImageData(a,b,1,1).data[3]},traceContour:function(){var a=this.getStartingPixel(),b=[];if(a)for(var d=a.x,e=a.y,f,g,k,m,n=!1;!n;){switch(this.getSquareValue(d,e)){case 1:case 5:case 13:f=0;g=-1;break;case 8:case 10:case 11:f=
0;g=1;break;case 4:case 12:case 14:f=-1;g=0;break;case 2:case 3:case 7:f=1;g=0;break;case 6:f=0==k&&-1==m?-1:1;g=0;break;case 9:1==k&&0==m?(f=0,g=-1):(f=0,g=1)}d+=f;e+=g;b.push({x:d,y:e});k=f;m=g;d==a.x&&e==a.y&&(n=!0)}return b},drawContour:function(a){this.bitmap_ctx.save();for(var b=0;b<a.length;b++)this.bitmap_ctx.fillStyle="#f00",this.bitmap_ctx.fillRect(a[b].x,a[b].y,1,1);this.bitmap_ctx.restore()},lightenCountur:function(a,b){return ClipperLib.JS.Lighten(a,b||1)[0]},triangulateContour:function(a){a=
new poly2tri.SweepContext(a,{cloneArrays:!0});a.triangulate();return a.getTriangles()||[]},getStartingPixel:function(){for(var a=0;a<this.height;a++)for(var b=0;b<this.width;b++)if(this.getPixelAlpha(b,a)>=this.tolerance)return{x:b,y:a};return!1},getSquareValue:function(a,b){var d=0;this.getPixelAlpha(a-1,b-1)>=this.tolerance&&(d+=1);this.getPixelAlpha(a,b-1)>=this.tolerance&&(d+=2);this.getPixelAlpha(a-1,b)>=this.tolerance&&(d+=4);this.getPixelAlpha(a,b)>=this.tolerance&&(d+=8);return d}});
CG.Sprite.extend("Button",{init:function(a){this._super();this.instanceOf="Button";a&&(CG._extend(this,a),this.setImage(this.image));this.clickable=!0;this.clicked=!1;return this},update:function(){this.ifClicked();this.ifMouseOver();this.xhandle=this.width*this.xscale/2;this.yhandle=this.height*this.yscale/2;this.clicked&&this.callbacks.clicked&&(this.clicked=!1,this.callbacks.clicked.apply(this));this.hover&&this.callbacks.hover&&(this.hover=!1,this.callbacks.hover.apply(this));this.updateDiff();
this.updateMatrix()},draw:function(){1==this.visible&&(Game.renderer.draw(this),this.text&&this.font.drawText(this.text,this.position.x-(this.font.getTextWidth(this.text)/2>>0),this.position.y-(this.font.getFontSize()/2>>0)))}});
CG.Class.extend("Menu",{init:function(a){CG._extend(this,{x:0,y:0,margin:0,step:0,buttons:[]});a&&(CG._extend(this,a),this.step=this.y);return this},addButton:function(a){this.buttons.push(a)},update:function(){this.buttons.forEach(function(a){a.update()})},draw:function(){this.buttons.forEach(function(a){a.position.x=this.x;a.position.y=this.step;a.draw();this.step+=a.height;this.step+=this.margin},this);this.step=this.y}});
CG.Class.extend("MediaAsset",{init:function(a){this.obj=a;this.ready=!1;this.progress=0;this.images=[];this.currimage=0;this.xmls=[];this.currxml=0;this.jsons=[];this.currjson=0;this.texts=[];this.currtext=0;this.fonts=[];this.assetcurrent=this.assetcount=this.currfont=0;this.width=300;this.height=20;this.radius=10;this.linewidth=8;this.bordercolor="white";this.progresscolor="red";this.shadowcolor="#222";this.shadowblur=6;this.shadowoffsety=this.shadowoffsetx=2},addImage:function(a,b){this.assetcount+=
1;this.images.push({name:b||"",path:a,img:new Image,type:"image"});return this},addFont:function(a,b){this.assetcount+=1;this.fonts.push({name:b||"",path:a,data:"",type:"font"});return this},addXml:function(a,b){this.assetcount+=1;this.xmls.push({name:b||"",path:a,data:"",type:"xml"});return this},addJson:function(a,b){this.assetcount+=1;this.jsons.push({name:b||"",path:a,data:"",src:"",type:"json"});return this},addText:function(a,b){this.assetcount+=1;this.texts.push({name:b||"",path:a,data:"",
type:"text"});return this},getImageByName:function(a){for(var b=0,d=this.images.length;b<d;b++)if(this.images[b].name==a)return this.images[b]instanceof CG.AtlasImage?this.images[b]:this.images[b].img;throw new MediaAssetException("No image with this name in asset.");},getImagesByName:function(a){for(var b=[],d=0,e=this.images.length;d<e;d++)this.images[d].name==a&&(this.images[d]instanceof CG.AtlasImage?b.push(this.images[d]):b.push(this.images[d].img));if(0===b.length)throw new MediaAssetException("No image with this name in asset: "+
a);return b},getFontByName:function(a){for(var b=0,d=this.fonts.length;b<d;b++)if(this.fonts[b].name==a)return this.fonts[b];throw new MediaAssetException("No font with this name in asset: "+a);},getXmlByName:function(a){for(var b=0,d=this.xmls.length;b<d;b++)if(this.xmls[b].name==a)return this.xmls[b];throw new MediaAssetException("No XML with this name in asset: "+a);},getJsonByName:function(a){for(var b=0,d=this.jsons.length;b<d;b++)if(this.jsons[b].name==a)return this.jsons[b];throw new MediaAssetException("No JSON with this name in asset: "+
a);},getTextByName:function(a){for(var b=0,d=this.jsons.length;b<d;b++)if(this.texts[b].name==a)return this.texts[b];throw new MediaAssetException("No Text with this name in asset: "+a);},startPreLoad:function(){this.progress=100/this.assetcount*this.assetcurrent;this.progressScreen();if(this.currimage<this.images.length)this.images[this.currimage].img.onload=function(){console.log("image loaded: "+this.images[this.currimage].path);this.currimage+=1;this.assetcurrent+=1;this.startPreLoad()}.bind(this),
this.images[this.currimage].img.onerror=function(){throw new MediaAssetException("error, cant load image: "+this.images[this.currimage].path);}.bind(this),this.images[this.currimage].img.src=this.images[this.currimage].path;else if(this.currfont<this.fonts.length)this.fonts[this.currfont].data=loadString(this.fonts[this.currfont].path),console.log("font loaded: "+this.fonts[this.currfont].path),this.currfont+=1,this.assetcurrent+=1,this.startPreLoad();else if(this.currxml<this.xmls.length)this.xmls[this.currxml].data=
loadString(this.xmls[this.currxml].path),console.log("xml loaded: "+this.xmls[this.currxml].path),this.currxml+=1,this.assetcurrent+=1,this.startPreLoad();else if(this.currjson<this.jsons.length){var a=loadString(this.jsons[this.currjson].path);this.jsons[this.currjson].data=JSON.parse(a);this.jsons[this.currjson].src=a;console.log("json loaded: "+this.jsons[this.currjson].path);this.currjson+=1;this.assetcurrent+=1;this.startPreLoad()}else this.currtext<this.texts.length?(this.texts[this.currtext].data=
loadString(this.texts[this.currtext].path),console.log("text loaded: "+this.texts[this.currtext].path),this.currtext+=1,this.assetcurrent+=1,this.startPreLoad()):this.currimage==this.images.length&&this.assetcount==this.assetcurrent&&(this.ready=!0,this.obj.create())},progressScreen:function(){var a=(this.obj.bound.width-this.width)/2,b=(this.obj.bound.height-this.height)/2;this.obj.ctx.save();this.obj.ctx.fillStyle=this.progresscolor;this.obj.ctx.fillRect((this.obj.bound.width-this.width)/2,(this.obj.bound.height-
this.height)/2,this.width/100*this.progress,this.height);this.obj.ctx.strokeStyle=this.bordercolor;this.obj.ctx.shadowColor=this.shadowcolor;this.obj.ctx.shadowBlur=this.shadowblur;this.obj.ctx.shadowOffsetX=this.shadowoffsetx;this.obj.ctx.shadowOffsetY=this.shadowoffsety;this.obj.ctx.beginPath();this.obj.ctx.moveTo(a+this.radius,b);this.obj.ctx.lineTo(a+this.width-1*this.radius,b);this.obj.ctx.arcTo(a+this.width,b,a+this.width,b+this.radius,this.radius);this.obj.ctx.arcTo(a+this.width,2*this.radius+
b,a+this.width-1*this.radius,2*this.radius+b,this.radius);this.obj.ctx.lineTo(a+this.radius,2*this.radius+b);this.obj.ctx.arcTo(a,2*this.radius+b,a,b,this.radius);this.obj.ctx.arcTo(a,b,2*this.radius+a,b,this.radius);this.obj.ctx.lineWidth=this.linewidth;this.obj.ctx.stroke();this.obj.ctx.restore()}});function MediaAssetException(a){this.msg=a;console.log(this.msg)}
CG.Entity.extend("Font",{init:function(a){this.instanceOf="Font";CG._extend(this,{atlas:new Image,fontFile:"",chars:Array(256),x:Array(256),y:Array(256),width:Array(256),height:Array(256),xoff:Array(256),yoff:Array(256),xadv:Array(256),lineHeight:0,face:"",size:0,bold:0,italic:0,base:0,scaleW:0,scaleH:0,text:"",currentX:0,currentY:0});a&&CG._extend(this,a);return this},update:function(){throw{name:"Font Error",message:"TODO, not defined yet."};},draw:function(){throw{name:"Font Error",message:"TODO, not defined yet."};
},drawText:function(a,b,d){this.text=a;this.currentX=b;this.currentY=d;Game.renderer.draw(this)},getLineHeight:function(){return this.lineHeight},getFontSize:function(){return this.size},getTextWidth:function(a){for(var b=0,d=0,e=a.length;d<e;d++)b+=this.xadv[a.charCodeAt(d)];return b},loadFont:function(a){idnum=0;a&&CG._extend(this,a);this.fontFile="string"==typeof this.font?loadString(this.font):this.font.data;a=this.fontFile.split("\n");for(l in a){line=a[l].trim();if(line.startsWith("info")||
""==line){var b=line.split(/([a-zA-Z]*=[" ,.\-_()0-9a-zA-Z]*(?= |\n))/);for(i in b){var d=b[i];d.startsWith("face=")&&(this.face=d.split("=")[1].split('"').join(""));if(d.startsWith("size=")){var e=d.split("=");this.size=parseInt(e[1])}d.startsWith("bold=")&&(e=d.split("="),this.bold=parseInt(e[1]));d.startsWith("italic=")&&(d=d.split("="),this.italic=parseInt(d[1]))}}if(!line.startsWith("padding")){if(line.startsWith("common"))for(c in b=line.split(" "),b)d=b[c],d.startsWith("lineHeight=")&&(e=d.split("="),
this.lineHeight=parseInt(e[1])),d.startsWith("base=")&&(e=d.split("="),this.base=parseInt(e[1])),d.startsWith("scaleW=")&&(e=d.split("="),this.scaleW=parseInt(e[1])),d.startsWith("scaleH=")&&(d=d.split("="),this.scaleH=parseInt(d[1]));if(line.startsWith("page"))for(p in b=line.split(" "),b)data=b[p],data.startsWith("file=")&&(d=data.split("="),this.atlas.src="media/font/"+d[1].split('"').join(""));if(!line.startsWith("chars")&&line.startsWith("char"))for(l in b=line.split(" "),b)ld=b[l],ld.startsWith("id=")&&
(d=ld.split("="),idnum=parseInt(d[1])),ld.startsWith("x=")&&(d=ld.split("="),this.x[idnum]=parseInt(d[1])),ld.startsWith("y=")&&(d=ld.split("="),this.y[idnum]=parseInt(d[1])),ld.startsWith("width=")&&(d=ld.split("="),this.width[idnum]=parseInt(d[1])),ld.startsWith("height=")&&(d=ld.split("="),this.height[idnum]=parseInt(d[1])),ld.startsWith("xoffset=")&&(d=ld.split("="),this.xoff[idnum]=parseInt(d[1])),ld.startsWith("yoffset=")&&(d=ld.split("="),this.yoff[idnum]=parseInt(d[1])),ld.startsWith("xadvance=")&&
(d=ld.split("="),this.xadv[idnum]=parseInt(d[1]))}}return this}});CG.Entity.extend("Text",{init:function(a){this.instanceOf="Text";CG._extend(this,{text:"",textcurrent:"",x:0,y:0,width:0,height:0,textAlign:"left"});a&&CG._extend(this,a);return this},initAsTextblock:function(a){return this},initAsScroller:function(){},initAsTicker:function(){},setText:function(a){this.text=a;return this},update:function(){},draw:function(){}});
CG.Class.extend("Director",{init:function(){CG._extend(this,{screens:[],activescreen:0,nextscreen:0,duration:20,stepx:40,stepy:30,alpha:0,mode:"fade",direction:CG.RIGHT,color:"rgb(0,0,0)"});return this},update:function(){switch(this.mode){case "scale":this.nextscreen!=this.activescreen?(this.screens[this.activescreen].xscale-=.4/this.duration,this.screens[this.activescreen].yscale-=.4/this.duration):this.nextscreen==this.activescreen&&(this.screens[this.activescreen].xscale+=.4/this.duration,this.screens[this.activescreen].yscale+=
.4/this.duration);1<=this.screens[this.activescreen].xscale&&(this.screens[this.activescreen].xscale=this.screens[this.activescreen].yscale=1,this.screens[this.nextscreen].xscale=this.screens[this.nextscreen].yscale=1);0>=this.screens[this.activescreen].xscale&&(this.screens[this.activescreen].xscale=this.screens[this.activescreen].yscale=1,this.screens[this.nextscreen].xscale=this.screens[this.nextscreen].yscale=0,this.activescreen=this.nextscreen);break;case "fade":this.nextscreen!=this.activescreen&&
1>this.alpha?this.alpha+=1/this.duration:this.nextscreen==this.activescreen&&0!=this.alpha&&(this.alpha-=1/this.duration);1<=this.alpha&&(this.activescreen=this.nextscreen,this.alpha=1);0>this.alpha&&(this.alpha=0);break;case "slide":if(this.nextscreen!=this.activescreen)switch(this.direction){case CG.UP:this.screens[this.activescreen].position.y-=this.stepy;this.screens[this.nextscreen].position.y-=this.stepy;0>this.screens[this.nextscreen].position.y&&(this.resetScreens(),this.activescreen=this.nextscreen);
break;case CG.DOWN:this.screens[this.activescreen].position.y+=this.stepy;this.screens[this.nextscreen].position.y+=this.stepy;0<this.screens[this.nextscreen].position.y&&(this.resetScreens(),this.activescreen=this.nextscreen);break;case CG.LEFT:this.screens[this.activescreen].position.x-=this.stepx;this.screens[this.nextscreen].position.x-=this.stepx;0>this.screens[this.nextscreen].position.x&&(this.resetScreens(),this.activescreen=this.nextscreen);break;case CG.RIGHT:this.screens[this.activescreen].position.x+=
this.stepx,this.screens[this.nextscreen].position.x+=this.stepx,0<this.screens[this.nextscreen].position.x&&(this.resetScreens(),this.activescreen=this.nextscreen)}}this.screens[this.activescreen].update()},draw:function(){this.screens[this.activescreen].draw();this.nextscreen!=this.activescreen&&(0==this.screens[this.nextscreen].position.x&&0==this.screens[this.nextscreen].position.y||this.screens[this.nextscreen].draw());0<this.alpha&&(Game.b_ctx.save(),Game.b_ctx.globalAlpha=this.alpha,Game.b_ctx.fillStyle=
this.color,Game.b_ctx.fillRect(0,0,Game.bound.width,Game.bound.height),Game.b_ctx.restore())},nextScreen:function(a,b,d){a=this.getIndexOfScreen(a);if(a!=this.activescreen)if(this.resetScreens(),this.mode=b,this.duration=d,this.stepx=Game.canvas.width/this.duration>>0,this.stepy=Game.canvas.height/this.duration>>0,this.nextscreen=a,"scale"===this.mode)this.alpha=0;else if("fade"!==this.mode&&"slide"===this.mode)switch(this.direction){case CG.UP:this.screens[this.nextscreen].position.y+=CG.canvas.height;
break;case CG.DOWN:this.screens[this.nextscreen].position.y-=CG.canvas.height;break;case CG.LEFT:this.screens[this.nextscreen].position.x+=CG.canvas.width;break;default:this.screens[this.nextscreen].position.x-=CG.canvas.width}return this},resetScreens:function(){this.screens[this.activescreen].position=new CG.Point(0,0);this.screens[this.nextscreen].position=new CG.Point(0,0);return this},addScreen:function(a){this.screens.push(a);return this},getScreenByName:function(a){for(var b=0,d=this.screens.length;b<
d;b++)if(this.screens[b].name==a)return this.screens[b];return!1},getIndexOfScreen:function(a){for(var b=0,d=this.screens.length;b<d;b++)if(this.screens[b].name==a)return b;return!1},getActiveScreenName:function(){return this.screens[this.activescreen].name},setDirection:function(a){this.direction=a;return this}});
CG.Class.extend("Screen",{init:function(a){CG._extend(this,{name:"",position:new CG.Point(0,0),xscale:1,yscale:1,layers:[]});a&&CG._extend(this,a);return this},create:function(){},update:function(){for(var a=0,b=this.layers.length;a<b;a++)this.layers[a].update()},draw:function(){Game.b_ctx.save();for(var a=0,b=this.layers.length;a<b;a++)1!==this.xscale||1!==this.yscale?(Game.b_ctx.translate((Game.width-Game.width*this.xscale)/2,(Game.height-Game.height*this.yscale)/2),Game.b_ctx.scale(this.xscale,
this.yscale),this.layers[a].draw()):(Game.b_ctx.save(),this.layers[a].fixedPosition?Game.b_ctx.translate(0,0):Game.b_ctx.translate(this.position.x,this.position.y),this.layers[a].draw(),Game.b_ctx.restore());Game.b_ctx.restore()},addLayer:function(a){this.layers.push(a);return this},getLayerByName:function(a){for(var b=0,d=this.layers.length;b<d;b++)if(this.layers[b].name==a)return this.layers[b];return!1}});
CG.Class.extend("Layer",{init:function(a){CG._extend(this,{name:"",visible:!0,fixedPosition:!1,elements:[],elementsToDelete:[]});a&&CG._extend(this,a);return this},update:function(){if(1==this.visible){for(var a=0,b=this.elements.length;a<b;a++)this.elements[a].update(),1==this.elements[a].status&&this.elementsToDelete.push(this.elements[a]);0<this.elementsToDelete.length&&this._deleteElements()}},draw:function(){if(1==this.visible)for(var a=0,b=this.elements.length;a<b;a++)this.elements[a].draw()},
_deleteElements:function(){this.elementsToDelete.reverse();this.elementsToDelete.forEach(this._deleteElement,this);this.elementsToDelete=[]},_deleteElement:function(a){this.elements.splice(a,1)},addElement:function(a){this.elements.push(a);return this},getElementByName:function(a){for(var b=0,d=this.elements.length;b<d;b++)if(this.elements[b].name==a)return this.elements[b];return!1},getElementsByName:function(a){elements=[];for(var b=0,d=this.elements.length;b<d;b++)this.elements[b].name==a&&elements.push(this.elements[b]);
return elements}});CG.Class.extend("MapTileLayer",{init:function(){this.height=this.width=0;this.visible=!0;this.opacity=1;this.tiles=[];return this}});CG.Class.extend("MapTileProperties",{init:function(){this.delayTimer=this.animNext=this.animDirection=this.animDelay=0;return this}});
CG.Class.extend("MapPoint",{init:function(a){CG._extend(this,{gid:0,name:"",initPosition:new CG.Point(0,0),position:new CG.Point(0,0)});CG._extend(this,a);this.initPosition=this.position;return this},update:function(a){this.position.x=this.initPosition.x-a.x;this.position.y=this.initPosition.y-a.y}});
CG.Class.extend("MapArea",{init:function(a){CG._extend(this,{initBound:new CG.Bound({x:0,y:0,width:0,height:0}),name:"",type:!1,bound:new CG.Bound({x:0,y:0,width:0,height:0})});CG._extend(this,a);this.initBound=this.bound;return this},update:function(a){this.bound.x=this.initBound.x-a.x;this.bound.y=this.initBound.y-a.y}});
CG.Entity.extend("Map",{init:function(a){this._super();this.instanceOf="Map";this.elements=[];this.points=[];this.areas=[];this.position=new CG.Point(0,0);this.mapOffset=new CG.Point(0,0);this.animDelayFactor=20;this.atlas=new Image;this.atlasheight=this.atlaswidth=0;this.atlastranscol="";"undefined"!==typeof ejecta||navigator.isCocoonJS||(this.xml="",this.parser=new DOMParser,this.xmlDoc="");this.json={};this.layers=[];this.renderlayer="all";this.tileproperties=[];this.orientation="";this.tileheight=
this.tilewidth=this.mapRows=this.mapColumns=this.height=this.width=0;this.tileset={tilewidth:0,tileheight:0,offsetx:0,offsety:0,spacing:0,margin:0};this.yspeed=this.xspeed=0;this.alpha=this.yscale=this.xscale=1;this.wrapY=this.wrapX=!1;this.layertocheck=0;CG._extend(this,a);return this},loadMapXml:function(a){this.layers=[];this.xml="string"==typeof a?loadString(a):a.data;this.removeJsonData();this.xmlDoc=this.parser.parseFromString(this.xml,"text/xml");a=map.xmlDoc.getElementsByTagName("map")[0];
this.orientation=a.getAttribute("orientation");this.mapColumns=parseInt(a.getAttribute("width"));this.mapRows=parseInt(a.getAttribute("height"));this.tilewidth=parseInt(a.getAttribute("tilewidth"));this.tileheight=parseInt(a.getAttribute("tileheight"));var b=a.childElementCount,d=a.firstElementChild;for(a=0;a<b;a++){console.log(">"+d.nodeName);switch(d.nodeName){case "tileset":this.tileset.tilewidth=parseInt(d.getAttribute("tilewidth"));this.tileset.tileheight=parseInt(d.getAttribute("tileheight"));
d.getAttribute("spacing")&&(this.tileset.spacing=parseInt(d.getAttribute("spacing")));d.getAttribute("margin")&&(this.tileset.margin=parseInt(d.getAttribute("margin")));d.getElementsByTagName("tileoffset")[0]&&(this.tileset.offsetx=parseInt(d.getElementsByTagName("tileoffset")[0].getAttribute("x")),this.tileset.offsety=parseInt(d.getElementsByTagName("tileoffset")[0].getAttribute("y")));var e=d.getElementsByTagName("image")[0];this.atlas.src="media/map/"+e.getAttribute("source");this.atlaswidth=parseInt(e.getAttribute("width"));
this.atlasheight=parseInt(e.getAttribute("height"));this.atlastranscol=e.getAttribute("trans");break;case "layer":e=new CG.MapTileLayer;data=d.getElementsByTagName("data")[0];if("csv"==data.getAttribute("encoding"))e.tiles=data.textContent.replace(/(\r\n|\n|\r)/gm,"").split(","),console.log("map encoding csv [layer "+a+"]");else{if("base64"==data.getAttribute("encoding")&&"gzip"==data.getAttribute("compression"))throw"base64 gzip compressed map format not supported at the moment";if("base64"==data.getAttribute("encoding")&&
"zlib"==data.getAttribute("compression"))throw"base64 zlib compressed map format not supported at the moment";if("base64"==data.getAttribute("encoding"))throw"base64 map format not supported at the moment";console.log("map encoding xml [layer "+a+"]");var f=d.getElementsByTagName("tile");for(x in f)x<f.length&&(e.tiles[x]=parseInt(f[x].getAttribute("gid")))}e.name=d.getAttribute("name");e.width=parseInt(d.getAttribute("width"));e.height=parseInt(d.getAttribute("height"));d.getAttribute("opacity")&&
(e.opacity=parseFloat(d.getAttribute("opacity")));"0"===d.getAttribute("visible")&&(e.visible=!1);this.layers.push(e);break;case "objectgroup":for(o in console.log("grouplayer found"),f=d.getElementsByTagName("object"),f)if(o<f.length){var g=f[o],k=g.getAttribute("name");if(g.getAttribute("gid"))this.points.push(new CG.MapPoint({position:new CG.Point(parseInt(g.getAttribute("x")),parseInt(g.getAttribute("y"))),mapOffset:this.position,name:g.getAttribute("name"),gid:parseInt(g.getAttribute("gid"))})),
console.log("tile as oject found: "+k),console.log(g);else if(g.getAttribute("width")){type=!1;e=g.getElementsByTagName("property");console.log(e.length);for(var m=0,n=e.length;m<n;m++)"type"==e[m].getAttribute("name")&&(type=e[m].getAttribute("value"));this.areas.push(new CG.MapArea({bound:new CG.Bound({x:parseInt(g.getAttribute("x")),y:parseInt(g.getAttribute("y")),width:parseInt(g.getAttribute("width")),height:parseInt(g.getAttribute("height"))}),mapOffset:this.position,name:g.getAttribute("name"),
type:type}));console.log("group object found: "+k);console.log(g)}else 0<g.getElementsByTagName("polygon").length?console.log("polygon found: "+k):0<g.getElementsByTagName("polyline").length&&console.log("polyline found: "+k)}}d=d.nextElementSibling}this.tileproperties=Array(parseInt(this.atlaswidth/this.tilewidth)*parseInt(this.atlasheight/this.tileheight));f=map.xmlDoc.getElementsByTagName("tileset")[0].getElementsByTagName("tile");b=(new Date).getTime();for(a in f)if(d=new CG.MapTileProperties,
e=f[a],a<this.tileproperties.length){g=e.getAttribute("id");e=e.getElementsByTagName("properties")[0].getElementsByTagName("property");for(m in e)m<e.length&&(n=e[m],k=n.getAttribute("name"),n=n.getAttribute("value"),"name"==k?d.name=n:"anim_delay"==k?(d.animDelay=parseInt(n),d.delayTimer=b):"anim_direction"==k?d.animDirection=parseInt(n):"anim_next"==k&&(d.animNext=parseInt(n)));this.tileproperties[g]=d}return this},loadMapJson:function(a){this.layers=[];this.json="string"==typeof a?JSON.parse(loadString(a)):
a.data;this.removeXmlData();this.orientation=this.json.orientation;this.mapColumns=this.json.width;this.mapRows=this.json.height;this.tilewidth=this.json.tilewidth;this.tileheight=this.json.tileheight;i=0;for(l=this.json.layers.length;i<l;i++)switch(this.json.layers[i].type){case "tilelayer":a=new CG.MapTileLayer;a.tiles=this.json.layers[i].data;a.name=this.json.layers[i].name;a.width=this.json.layers[i].width;a.height=this.json.layers[i].height;a.opacity=this.json.layers[i].opacity;a.visible=this.json.layers[i].visible;
this.layers.push(a);break;case "objectgroup":for(o in console.log("grouplayer found"),a=this.json.layers[i].objects,a)if(o<a.length){var b=a[o],d=b.name;b.gid?(this.points.push(new CG.MapPoint({position:new CG.Point(parseInt(b.x),parseInt(b.y)),mapOffset:this.position,name:b.name,gid:parseInt(b.gid)})),console.log("tile as oject found: "+d),console.log(b)):b.width?(this.areas.push(new CG.MapArea({bound:new CG.Bound({x:parseInt(b.x),y:parseInt(b.y),width:parseInt(b.width),height:parseInt(b.height)}),
mapOffset:this.position,name:b.name,type:b.properties.type})),console.log("group object found: "+d),console.log(b)):b.polygon?console.log("polygon found: "+d):b.polyline&&console.log("polyline found: "+d)}}this.atlas.src="media/map/"+this.json.tilesets[0].image;this.atlaswidth=this.json.tilesets[0].imagewidth;this.atlasheight=this.json.tilesets[0].imageheight;this.atlastranscol=this.json.tilesets[0].transparentcolor;this.tileproperties=Array(parseInt(this.atlaswidth/this.tilewidth)*parseInt(this.atlasheight/
this.tileheight));a=this.json.tilesets[0].tileproperties;b=(new Date).getTime();for(id in a){var d=new CG.MapTileProperties,e=a[id];d.name=e.name;d.animDelay=parseInt(e.anim_delay);d.delayTimer=0<d.animDelay?b:0;d.animNext=parseInt(e.anim_next);d.animDirection=parseInt(e.anim_direction);this.tileproperties[id]=d}return this},drawMap:function(a,b,d,e,f,g,k){this.bx=d;this.by=e;this.bw=f;this.bh=g;this.sx=a;this.sy=b;this.callback=k||!1;this.layer=this.ypos=this.xpos=this.cy=this.cx=this.ry=this.rx=
0;this.updatePointsAndAreas();if(this.visible&&(this.updateAnimation(),0<this.layers.length))for(a=0,b=this.layers.length;a<b;a++)if(k=this.layers[a],this.renderlayer===k.name||this.renderlayer===a||"all"===this.renderlayer)if("orthogonal"==this.orientation&&1==k.visible)for(var m=this.bx*this.xscale%this.tilewidth,n=this.by*this.yscale%this.tileheight,q=this.by,s=Math.floor(this.by/this.tileheight),t=this.by+this.bh+this.tileheight;q<t;){for(var u=this.bx,v=Math.floor(this.bx/this.tilewidth),y=this.bx+
this.bw+this.tilewidth;u<y;){if((this.wrapX||0<=v&&v<this.mapColumns)&&(this.wrapY||0<=s&&s<this.mapRows)){for(var z=v,A=s;0>z;)z+=this.width;for(;z>=this.width;)z-=this.width;for(;0>A;)A+=this.height;for(;A>=this.height;)A-=this.height;z=k.tiles[z+A*k.width]-1;if(0<=z){0>m&&(m+=this.tilewidth);0>n&&(n+=this.tileheight);this.rx=u-m-this.bx;this.ry=q-n-this.by;if(0<this.elements.length&&this.layertocheck==b)for(A=0,b=this.elements.length;A<b;A++)this.checkMapCollision(this.elements[0],this.rx,this.ry)&&
this.callback(this.elements[A],this.tileproperties[z]);this.cx=z%(this.atlaswidth/this.tilewidth)*this.tilewidth;this.cy=Math.floor(this.tilewidth*z/this.atlaswidth)*this.tileheight;Game.renderer.draw(this)}}u+=this.tilewidth;v+=1}q+=this.tileheight;s+=1}else if("isometric"==this.orientation)for(m=k.width+k.height,q=0;q<m;q++){n=q;for(s=0;n>=k.height;)n-=1,s+=1;for(;0<=n&&s<k.width;)z=k.tiles[s+n*k.width],this.rx=(s-n-1)*this.tilewidth/2-d,this.ry=(s+n+1)*this.tileheight/2-e,this.rx>-this.tileset.tilewidth&&
this.rx<f&&this.ry>-this.tileset.tileheight&&this.ry<g&&0<z&&(this.cx=(z-1)%(this.atlaswidth/this.tilewidth)*this.tilewidth,this.cy=Math.floor(this.tilewidth*(z-1)/this.atlaswidth)*this.tileset.tileheight,Game.renderer.draw(this)),n-=1,s+=1}},updatePointsAndAreas:function(){this.points.forEach(function(a,b){a.update(this.mapOffset)},this);this.areas.forEach(function(a,b){a.update(this.mapOffset)},this)},getPointsByName:function(a){points=[];for(var b=0,d=this.points.length;b<d;b++)this.points[b].name===
a&&points.push(this.points[b]);return 0<points.length?points:!1},getAreasByName:function(a){areas=[];for(var b=0,d=this.areas.length;b<d;b++)this.areas[b].name===a&&areas.push(this.areas[b]);return 0<areas.length?areas:!1},setLayerToRender:function(a){this.renderlayer=a;return this},update:function(){},draw:function(){this.drawMap(this.position.x,this.position.y,this.mapOffset.x,this.mapOffset.y,this.width,this.height,this.callback);return this},getBounds:function(){return{width:this.width*this.tilewidth,
height:this.height*this.tileheight}},updateAnimation:function(){if(0<this.layers.length)for(var a=0,b=this.layers.length;a<b;a++)for(var d=(new Date).getTime(),e=0,f=this.layers[a].tiles.length;e<f;e++){var g=this.layers[a].tiles[e];if(0<g){var k=this.tileproperties[g-1];if(k&&d>k.delayTimer+k.animDelay/this.animDelayFactor)switch(k.animDirection){case 1:this.layers[a].tiles[e]+=k.animNext;this.tileproperties[g-1+k.animNext].delayTimer=d;break;case -1:this.layers[a].tiles[e]-=k.animNext,this.tileproperties[g-
1-k.animNext].delayTimer=d}}}},addElement:function(a){this.elements.push(a);return this},checkMapCollision:function(a,b,d){if(0<a.boundingradius)var e=a.boundingradius/2*a.xscale,f=a.boundingradius/2*a.yscale;else e=a.width/2*a.xscale,f=a.height/2*a.yscale;return a.position.x+e>=b&&a.position.x-e<=b+this.tilewidth&&a.position.y+f>=d&&a.position.y-f<=d+this.tileheight?!0:!1},checkElementsToAreasCollision:function(a,b){for(var d=0,e=a.length;d<e;d++)obj=a[d].checkCollision(this.areas,b);return this},
removeJsonData:function(){this.json={};return this},removeXmlData:function(){this.xmlDoc=this.xml="";return this}});
CG.Class.extend("Sequence",{init:function(a){CG._extend(this,{current:0,loop:!1,translations:[]});a&&CG._extend(this,a);return this},addTranslation:function(a){this.translations.push(a);return this},update:function(a){this.current<this.translations.length?!1===this.translations[this.current].finished?this.translations[this.current].update():this.current+=1:this.loop&&this.reset()},draw:function(){},reset:function(){for(var a=0,b=this.translations.length;a<b;a++)this.translations[a].reset();this.current=
0;return this}});
CG.Class.extend("Translate",{init:function(a){CG._extend(this,{type:"",tx:0,ty:0,x1:0,y1:0,x2:0,y2:0,bx:0,by:0,object:{},r1:0,r2:0,startangle:0,angle:0,speed:0,steps:0,step:0,positions:[],finished:!1});a&&CG._extend(this,a);return this},initTween:function(a){this.type="tween";a&&CG._extend(this,a);this.x1=this.startPoint.x;this.y1=this.startPoint.y;this.x2=this.endPoint.x;this.y2=this.endPoint.y;a=(this.x2-this.x1)/this.steps;for(var b=(this.y2-this.y1)/this.steps,d=this.x1>>0,e=this.y1>>0,f=0;f<=
this.steps;f++)this.positions.push(new CG.Point(d,e)),d+=a,e+=b;return this},initOval:function(a){this.type="oval";a&&CG._extend(this,a);this.x1=this.centerPoint.x;this.y1=this.centerPoint.y;this.r1=this.radius1;this.r2=this.radius2;this.speed=this.rotation;return this},initBezier:function(a){this.type="bezier";a&&CG._extend(this,a);this.start=this.endPoint;this.end=this.startPoint;this.control2="undefined"==this.control2&&"undefined"==this.control1?new CG.Point(this.start.x+3*(this.end.x-this.start.x)/
4,this.start.y+3*(this.end.y-this.start.y)/4):this.control2||this.control1;this.control1=this.control1||new CG.Point(this.start.x+(this.end.x-this.start.x)/4,this.start.y+(this.end.y-this.start.y)/4);b1=function(a){return a*a*a};b2=function(a){return 3*a*a*(1-a)};b3=function(a){return 3*a*(1-a)*(1-a)};b4=function(a){return(1-a)*(1-a)*(1-a)};for(a=0;a<=this.steps;a++){percent=1/this.steps*a;var b=new CG.Point;b.x=this.start.x*b1(percent)+this.control1.x*b2(percent)+this.control2.x*b3(percent)+this.end.x*
b4(percent);b.y=this.start.y*b1(percent)+this.control1.y*b2(percent)+this.control2.y*b3(percent)+this.end.y*b4(percent);this.positions.push(b)}return this},update:function(){var a=this.object;switch(this.type){case "bezier":case "tween":this.step<this.steps?(a.position.x=a.position._x=this.positions[this.step].x,a.position.y=a.position._y=this.positions[this.step].y,this.step+=1):this.finished=!0;break;case "oval":var b=this.startangle*CG.Const_PI_180;this.tx=this.x1-this.r1*Math.cos(b);this.ty=this.y1-
this.r2*Math.sin(b);this.startangle+=this.speed;360<this.startangle&&(this.startangle=0+(this.startangle-360));a.position.x=a.position._x=this.tx>>0;a.position.y=a.position._y=this.ty>>0}},draw:function(){},reset:function(){this.step=0;this.finished=!1}});
CG.Class.extend("Morph",{init:function(a){CG._extend(this,{mode:"",min:0,max:0,speed:0,angle:0,rad:0,_val:0});a&&(CG._extend(this,a),this.rad=this.max-this.min);return this},update:function(){switch(this.mode){case "sinus":this._val=this.rad*Math.sin(this.angle*CG.Const_PI_180),0>this._val&&(this._val*=-1),this.angle+=this.speed,360<this.angle&&(this.angle=0+(this.angle-360))}return this},draw:function(){},getVal:function(){return this._val}});
CG.Sprite.extend("Particle",{init:function(a){this._super();this.instanceOf="Particle";CG._extend(this,{position:new CG.Point(0,0),lifetime:100,currtime:this.lifetime,aging:1,fadeout:!1,gravity:0});a&&(CG._extend(this,a),this.setImage(this.image))},update:function(){this.visible&&(this.fadeout&&(this.alpha=this.currtime/this.lifetime,0>=this.alpha&&(this.visible=!1)),this.currtime-=this.aging,0>this.currtime&&(this.visible=!1),this.position.x+=this.xspeed,this.position.y+=this.yspeed,this.yspeed+=
this.gravity,this.rotation+=this.rotationspeed,this.xhandle=this.width*this.xscale/2,this.yhandle=this.height*this.yscale/2,this.updateDiff(),this.updateMatrix())},draw:function(){this.visible&&Game.renderer.draw(this)}});
CG.Entity.extend("Emitter",{init:function(a){this._super();CG._extend(this,{particles:[],maxparticles:50,creationtime:100,currenttime:0,creationspeed:50,gravity:.05,image:null,type:"",position:{x:0,y:0,_x:0,_y:0},rotation:0,width:200,height:200,radius:0,pspeed:10,protation:0,pdirection:0,plifetime:100,paging:1,pfadeout:!1});a&&(CG._extend(this,a),this.position._x=this.position.x,this.position._y=this.position.y);return this},initAsPoint:function(a){this.image=a;this.type="point";return this},initAsExplosion:function(a,
b,d){this.image=a;this.type="explosion";this.min=b;this.max=d;return this},initAsCorona:function(a,b){this.image=a;this.type="corona";this.radius=b||0;return this},initAsLine:function(a,b,d){this.image=a;this.width=b||200;this.pdirection=d||CG.UP;this.type="line";return this},initAsRectangle:function(a,b,d){this.image=a;this.width=b||200;this.height=d||200;this.type="rectangle";return this},createParticle:function(){return particle=new CG.Particle({image:this.image})},initParticle:function(a){this.pfadeout&&
(a.fadeout=!0);a.gravity=this.gravity;a.alpha=1;a.visible=!0;a.lifetime=this.plifetime;a.currtime=this.plifetime;a.rotationspeed=this.protation;switch(this.type){case "corona":var b=this.getRandom(0,359)*CG.Const_PI_180;a.position.x=this.getX()-this.radius*Math.cos(b);a.position.y=this.getY()-this.radius*Math.sin(b);angl=Math.atan2(a.position.x-this.getX(),a.position.y-this.getY())*CG.Const_180_PI;a.xspeed=this.pspeed*Math.sin(angl*CG.Const_PI_180);a.yspeed=this.pspeed*Math.cos(angl*CG.Const_PI_180);
break;case "rectangle":rndx=this.getRandom(this.width/2*-1,this.width/2);rndy=this.getRandom(this.height/2*-1,this.height/2);a.position.x=this.position._x-rndx;a.position.y=this.position._y-rndy;a.xspeed=0;a.yspeed=0;break;case "line":rnd=this.getRandom(this.width/2*-1,this.width/2);switch(this.pdirection){default:case CG.UP:a.xspeed=0;a.yspeed=-1*this.pspeed;a.position.x=rnd+this.getX();a.position.y=this.position._y;break;case CG.DOWN:a.xspeed=0;a.yspeed=this.pspeed;a.position.x=rnd+this.getX();
a.position.y=this.position._y;break;case CG.LEFT:a.xspeed=-1*this.pspeed;a.yspeed=0;a.position.x=this.position._x;a.position.y=rnd+this.getY();break;case CG.RIGHT:a.xspeed=this.pspeed,a.yspeed=0,a.position.x=this.position._x,a.position.y=rnd+this.getY()}break;case "explosion":a.position.x=this.position._x;a.position.y=this.position._y;a.xspeed=this.getRandom(this.min,this.max);a.yspeed=this.getRandom(this.min,this.max);break;default:a.xspeed=0,a.yspeed=0,a.position.x=this.position._x,a.position.y=
this.position._y}return a},update:function(){if(this.visible){this.currenttime+=this.creationspeed;this.currenttime>=this.creationtime&&(this.currenttime=0,this.particles.length<this.maxparticles?this.particles.push(this.initParticle(this.createParticle())):(particle=this.searchInvisibleParticle(),this.initParticle(particle),this.particles.sort(function(a,b){return a.currtime-b.currtime})));for(var a=0,b=this.particles.length;a<b;a++)this.particles[a].update();return this}},draw:function(){if(this.visible){for(var a=
0,b=this.particles.length;a<b;a++)this.particles[a].draw();return this}},searchInvisibleParticle:function(){for(var a=0,b=this.particles.length;a<b;a++)if(0==this.particles[a].visible)return this.particles[a];return this},setEmitterPosition:function(a){this.position=a;return this},setName:function(a){this.name=a;return this},setCreationTime:function(a){this.creationtime=a;return this},setMaxParticles:function(a){this.maxparticles=a;return this},setGravity:function(a){this.gravity=a;return this},setParticleSpeed:function(a){this.pspeed=
a;return this},setProtation:function(a){this.protation=a;return this},setPLifetime:function(a){this.plifetime=a;return this},activateFadeout:function(){this.pfadeout=!0;return this},deactivateFadeout:function(){this.pfadeout=!1;return this},getRandom:function(a,b){return Math.random()*(b-a+1)+a>>0},getX:function(){return this.position._x},getY:function(){return this.position._y}});var COMPILED=!0,goog=goog||{};goog.global=this;goog.isDef=function(a){return void 0!==a};
goog.exportPath_=function(a,b,d){a=a.split(".");d=d||goog.global;a[0]in d||!d.execScript||d.execScript("var "+a[0]);for(var e;a.length&&(e=a.shift());)!a.length&&goog.isDef(b)?d[e]=b:d=d[e]?d[e]:d[e]={}};
goog.define=function(a,b){var d=b;COMPILED||(goog.global.CLOSURE_UNCOMPILED_DEFINES&&Object.prototype.hasOwnProperty.call(goog.global.CLOSURE_UNCOMPILED_DEFINES,a)?d=goog.global.CLOSURE_UNCOMPILED_DEFINES[a]:goog.global.CLOSURE_DEFINES&&Object.prototype.hasOwnProperty.call(goog.global.CLOSURE_DEFINES,a)&&(d=goog.global.CLOSURE_DEFINES[a]));goog.exportPath_(a,d)};goog.DEBUG=!1;goog.LOCALE="en";goog.TRUSTED_SITE=!0;goog.STRICT_MODE_COMPATIBLE=!1;goog.DISALLOW_TEST_ONLY_CODE=COMPILED&&!goog.DEBUG;
goog.ENABLE_CHROME_APP_SAFE_SCRIPT_LOADING=!1;goog.provide=function(a){if(!COMPILED&&goog.isProvided_(a))throw Error('Namespace "'+a+'" already declared.');goog.constructNamespace_(a)};goog.constructNamespace_=function(a,b){if(!COMPILED){delete goog.implicitNamespaces_[a];for(var d=a;(d=d.substring(0,d.lastIndexOf(".")))&&!goog.getObjectByName(d);)goog.implicitNamespaces_[d]=!0}goog.exportPath_(a,b)};goog.VALID_MODULE_RE_=/^[a-zA-Z_$][a-zA-Z0-9._$]*$/;
goog.module=function(a){if(!goog.isString(a)||!a||-1==a.search(goog.VALID_MODULE_RE_))throw Error("Invalid module identifier");if(!goog.isInModuleLoader_())throw Error("Module "+a+" has been loaded incorrectly.");if(goog.moduleLoaderState_.moduleName)throw Error("goog.module may only be called once per module.");goog.moduleLoaderState_.moduleName=a;if(!COMPILED){if(goog.isProvided_(a))throw Error('Namespace "'+a+'" already declared.');delete goog.implicitNamespaces_[a]}};goog.module.get=function(a){return goog.module.getInternal_(a)};
goog.module.getInternal_=function(a){if(!COMPILED)return goog.isProvided_(a)?a in goog.loadedModules_?goog.loadedModules_[a]:goog.getObjectByName(a):null};goog.moduleLoaderState_=null;goog.isInModuleLoader_=function(){return null!=goog.moduleLoaderState_};
goog.module.declareLegacyNamespace=function(){if(!COMPILED&&!goog.isInModuleLoader_())throw Error("goog.module.declareLegacyNamespace must be called from within a goog.module");if(!COMPILED&&!goog.moduleLoaderState_.moduleName)throw Error("goog.module must be called prior to goog.module.declareLegacyNamespace.");goog.moduleLoaderState_.declareLegacyNamespace=!0};
goog.setTestOnly=function(a){if(goog.DISALLOW_TEST_ONLY_CODE)throw a=a||"",Error("Importing test-only code into non-debug environment"+(a?": "+a:"."));};goog.forwardDeclare=function(a){};COMPILED||(goog.isProvided_=function(a){return a in goog.loadedModules_||!goog.implicitNamespaces_[a]&&goog.isDefAndNotNull(goog.getObjectByName(a))},goog.implicitNamespaces_={"goog.module":!0});
goog.getObjectByName=function(a,b){for(var d=a.split("."),e=b||goog.global,f;f=d.shift();)if(goog.isDefAndNotNull(e[f]))e=e[f];else return null;return e};goog.globalize=function(a,b){var d=b||goog.global,e;for(e in a)d[e]=a[e]};goog.addDependency=function(a,b,d,e){if(goog.DEPENDENCIES_ENABLED){var f;a=a.replace(/\\/g,"/");for(var g=goog.dependencies_,k=0;f=b[k];k++)g.nameToPath[f]=a,g.pathIsModule[a]=!!e;for(e=0;b=d[e];e++)a in g.requires||(g.requires[a]={}),g.requires[a][b]=!0}};
goog.ENABLE_DEBUG_LOADER=!0;goog.logToConsole_=function(a){goog.global.console&&goog.global.console.error(a)};
goog.require=function(a){if(!COMPILED){goog.ENABLE_DEBUG_LOADER&&goog.IS_OLD_IE_&&goog.maybeProcessDeferredDep_(a);if(goog.isProvided_(a))return goog.isInModuleLoader_()?goog.module.getInternal_(a):null;if(goog.ENABLE_DEBUG_LOADER){var b=goog.getPathFromDeps_(a);if(b)return goog.included_[b]=!0,goog.writeScripts_(),null}a="goog.require could not find: "+a;goog.logToConsole_(a);throw Error(a);}};goog.basePath="";goog.nullFunction=function(){};
goog.abstractMethod=function(){throw Error("unimplemented abstract method");};goog.addSingletonGetter=function(a){a.getInstance=function(){if(a.instance_)return a.instance_;goog.DEBUG&&(goog.instantiatedSingletons_[goog.instantiatedSingletons_.length]=a);return a.instance_=new a}};goog.instantiatedSingletons_=[];goog.LOAD_MODULE_USING_EVAL=!0;goog.SEAL_MODULE_EXPORTS=goog.DEBUG;goog.loadedModules_={};goog.DEPENDENCIES_ENABLED=!COMPILED&&goog.ENABLE_DEBUG_LOADER;
goog.DEPENDENCIES_ENABLED&&(goog.included_={},goog.dependencies_={pathIsModule:{},nameToPath:{},requires:{},visited:{},written:{},deferred:{}},goog.inHtmlDocument_=function(){var a=goog.global.document;return"undefined"!=typeof a&&"write"in a},goog.findBasePath_=function(){if(goog.isDef(goog.global.CLOSURE_BASE_PATH))goog.basePath=goog.global.CLOSURE_BASE_PATH;else if(goog.inHtmlDocument_())for(var a=goog.global.document.getElementsByTagName("SCRIPT"),b=a.length-1;0<=b;--b){var d=a[b].src,e=d.lastIndexOf("?"),
e=-1==e?d.length:e;if("base.js"==d.substr(e-7,7)){goog.basePath=d.substr(0,e-7);break}}},goog.importScript_=function(a,b){(goog.global.CLOSURE_IMPORT_SCRIPT||goog.writeScriptTag_)(a,b)&&(goog.dependencies_.written[a]=!0)},goog.IS_OLD_IE_=!(goog.global.atob||!goog.global.document||!goog.global.document.all),goog.importModule_=function(a){goog.importScript_("",'goog.retrieveAndExecModule_("'+a+'");')&&(goog.dependencies_.written[a]=!0)},goog.queuedModules_=[],goog.wrapModule_=function(a,b){return goog.LOAD_MODULE_USING_EVAL&&
goog.isDef(goog.global.JSON)?"goog.loadModule("+goog.global.JSON.stringify(b+"\n//# sourceURL="+a+"\n")+");":'goog.loadModule(function(exports) {"use strict";'+b+"\n;return exports});\n//# sourceURL="+a+"\n"},goog.loadQueuedModules_=function(){var a=goog.queuedModules_.length;if(0<a){var b=goog.queuedModules_;goog.queuedModules_=[];for(var d=0;d<a;d++)goog.maybeProcessDeferredPath_(b[d])}},goog.maybeProcessDeferredDep_=function(a){goog.isDeferredModule_(a)&&goog.allDepsAreAvailable_(a)&&(a=goog.getPathFromDeps_(a),
goog.maybeProcessDeferredPath_(goog.basePath+a))},goog.isDeferredModule_=function(a){return(a=goog.getPathFromDeps_(a))&&goog.dependencies_.pathIsModule[a]?goog.basePath+a in goog.dependencies_.deferred:!1},goog.allDepsAreAvailable_=function(a){if((a=goog.getPathFromDeps_(a))&&a in goog.dependencies_.requires)for(var b in goog.dependencies_.requires[a])if(!goog.isProvided_(b)&&!goog.isDeferredModule_(b))return!1;return!0},goog.maybeProcessDeferredPath_=function(a){if(a in goog.dependencies_.deferred){var b=
goog.dependencies_.deferred[a];delete goog.dependencies_.deferred[a];goog.globalEval(b)}},goog.loadModule=function(a){var b=goog.moduleLoaderState_;try{goog.moduleLoaderState_={moduleName:void 0};var d;if(goog.isFunction(a))d=a.call(goog.global,{});else if(goog.isString(a))d=goog.loadModuleFromSource_.call(goog.global,a);else throw Error("Invalid module definition");var e=goog.moduleLoaderState_.moduleName;if(!goog.isString(e)||!e)throw Error('Invalid module name "'+e+'"');goog.moduleLoaderState_.declareLegacyNamespace?
goog.constructNamespace_(e,d):goog.SEAL_MODULE_EXPORTS&&Object.seal&&Object.seal(d);goog.loadedModules_[e]=d}finally{goog.moduleLoaderState_=b}},goog.loadModuleFromSource_=function(a){eval(a);return{}},goog.writeScriptSrcNode_=function(a){goog.global.document.write('<script type="text/javascript" src="'+a+'">\x3c/script>')},goog.appendScriptSrcNode_=function(a){var b=goog.global.document,d=b.createElement("script");d.type="text/javascript";d.src=a;d.defer=!1;d.async=!1;b.head.appendChild(d)},goog.writeScriptTag_=
function(a,b){if(goog.inHtmlDocument_()){var d=goog.global.document;if(!goog.ENABLE_CHROME_APP_SAFE_SCRIPT_LOADING&&"complete"==d.readyState){if(/\bdeps.js$/.test(a))return!1;throw Error('Cannot write "'+a+'" after document load');}var e=goog.IS_OLD_IE_;void 0===b?e?(e=" onreadystatechange='goog.onScriptLoad_(this, "+ ++goog.lastNonModuleScriptIndex_+")' ",d.write('<script type="text/javascript" src="'+a+'"'+e+">\x3c/script>")):goog.ENABLE_CHROME_APP_SAFE_SCRIPT_LOADING?goog.appendScriptSrcNode_(a):
goog.writeScriptSrcNode_(a):d.write('<script type="text/javascript">'+b+"\x3c/script>");return!0}return!1},goog.lastNonModuleScriptIndex_=0,goog.onScriptLoad_=function(a,b){"complete"==a.readyState&&goog.lastNonModuleScriptIndex_==b&&goog.loadQueuedModules_();return!0},goog.writeScripts_=function(){function a(f){if(!(f in e.written)){if(!(f in e.visited)&&(e.visited[f]=!0,f in e.requires))for(var g in e.requires[f])if(!goog.isProvided_(g))if(g in e.nameToPath)a(e.nameToPath[g]);else throw Error("Undefined nameToPath for "+
g);f in d||(d[f]=!0,b.push(f))}}var b=[],d={},e=goog.dependencies_,f;for(f in goog.included_)e.written[f]||a(f);for(var g=0;g<b.length;g++)f=b[g],goog.dependencies_.written[f]=!0;var k=goog.moduleLoaderState_;goog.moduleLoaderState_=null;for(g=0;g<b.length;g++)if(f=b[g])e.pathIsModule[f]?goog.importModule_(goog.basePath+f):goog.importScript_(goog.basePath+f);else throw goog.moduleLoaderState_=k,Error("Undefined script input");goog.moduleLoaderState_=k},goog.getPathFromDeps_=function(a){return a in
goog.dependencies_.nameToPath?goog.dependencies_.nameToPath[a]:null},goog.findBasePath_(),goog.global.CLOSURE_NO_DEPS||goog.importScript_(goog.basePath+"deps.js"));goog.normalizePath_=function(a){a=a.split("/");for(var b=0;b<a.length;)"."==a[b]?a.splice(b,1):b&&".."==a[b]&&a[b-1]&&".."!=a[b-1]?a.splice(--b,2):b++;return a.join("/")};
goog.loadFileSync_=function(a){if(goog.global.CLOSURE_LOAD_FILE_SYNC)return goog.global.CLOSURE_LOAD_FILE_SYNC(a);var b=new goog.global.XMLHttpRequest;b.open("get",a,!1);b.send();return b.responseText};
goog.retrieveAndExecModule_=function(a){if(!COMPILED){var b=a;a=goog.normalizePath_(a);var d=goog.global.CLOSURE_IMPORT_SCRIPT||goog.writeScriptTag_,e=goog.loadFileSync_(a);if(null!=e)e=goog.wrapModule_(a,e),goog.IS_OLD_IE_?(goog.dependencies_.deferred[b]=e,goog.queuedModules_.push(b)):d(a,e);else throw Error("load of "+a+"failed");}};
goog.typeOf=function(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var d=Object.prototype.toString.call(a);if("[object Window]"==d)return"object";if("[object Array]"==d||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==d||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==b&&"undefined"==typeof a.call)return"object";return b};goog.isNull=function(a){return null===a};goog.isDefAndNotNull=function(a){return null!=a};goog.isArray=function(a){return"array"==goog.typeOf(a)};goog.isArrayLike=function(a){var b=goog.typeOf(a);return"array"==b||"object"==b&&"number"==typeof a.length};goog.isDateLike=function(a){return goog.isObject(a)&&"function"==typeof a.getFullYear};goog.isString=function(a){return"string"==typeof a};
goog.isBoolean=function(a){return"boolean"==typeof a};goog.isNumber=function(a){return"number"==typeof a};goog.isFunction=function(a){return"function"==goog.typeOf(a)};goog.isObject=function(a){var b=typeof a;return"object"==b&&null!=a||"function"==b};goog.getUid=function(a){return a[goog.UID_PROPERTY_]||(a[goog.UID_PROPERTY_]=++goog.uidCounter_)};goog.hasUid=function(a){return!!a[goog.UID_PROPERTY_]};goog.removeUid=function(a){"removeAttribute"in a&&a.removeAttribute(goog.UID_PROPERTY_);try{delete a[goog.UID_PROPERTY_]}catch(b){}};
goog.UID_PROPERTY_="closure_uid_"+(1E9*Math.random()>>>0);goog.uidCounter_=0;goog.getHashCode=goog.getUid;goog.removeHashCode=goog.removeUid;goog.cloneObject=function(a){var b=goog.typeOf(a);if("object"==b||"array"==b){if(a.clone)return a.clone();var b="array"==b?[]:{},d;for(d in a)b[d]=goog.cloneObject(a[d]);return b}return a};goog.bindNative_=function(a,b,d){return a.call.apply(a.bind,arguments)};
goog.bindJs_=function(a,b,d){if(!a)throw Error();if(2<arguments.length){var e=Array.prototype.slice.call(arguments,2);return function(){var d=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(d,e);return a.apply(b,d)}}return function(){return a.apply(b,arguments)}};goog.bind=function(a,b,d){Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?goog.bind=goog.bindNative_:goog.bind=goog.bindJs_;return goog.bind.apply(null,arguments)};
goog.partial=function(a,b){var d=Array.prototype.slice.call(arguments,1);return function(){var b=d.slice();b.push.apply(b,arguments);return a.apply(this,b)}};goog.mixin=function(a,b){for(var d in b)a[d]=b[d]};goog.now=goog.TRUSTED_SITE&&Date.now||function(){return+new Date};
goog.globalEval=function(a){if(goog.global.execScript)goog.global.execScript(a,"JavaScript");else if(goog.global.eval){if(null==goog.evalWorksForGlobals_)if(goog.global.eval("var _evalTest_ = 1;"),"undefined"!=typeof goog.global._evalTest_){try{delete goog.global._evalTest_}catch(b){}goog.evalWorksForGlobals_=!0}else goog.evalWorksForGlobals_=!1;if(goog.evalWorksForGlobals_)goog.global.eval(a);else{var d=goog.global.document,e=d.createElement("SCRIPT");e.type="text/javascript";e.defer=!1;e.appendChild(d.createTextNode(a));
d.body.appendChild(e);d.body.removeChild(e)}}else throw Error("goog.globalEval not available");};goog.evalWorksForGlobals_=null;goog.getCssName=function(a,b){var d=function(a){return goog.cssNameMapping_[a]||a},e=function(a){a=a.split("-");for(var b=[],e=0;e<a.length;e++)b.push(d(a[e]));return b.join("-")},e=goog.cssNameMapping_?"BY_WHOLE"==goog.cssNameMappingStyle_?d:e:function(a){return a};return b?a+"-"+e(b):e(a)};
goog.setCssNameMapping=function(a,b){goog.cssNameMapping_=a;goog.cssNameMappingStyle_=b};!COMPILED&&goog.global.CLOSURE_CSS_NAME_MAPPING&&(goog.cssNameMapping_=goog.global.CLOSURE_CSS_NAME_MAPPING);goog.getMsg=function(a,b){b&&(a=a.replace(/\{\$([^}]+)}/g,function(a,e){return e in b?b[e]:a}));return a};goog.getMsgWithFallback=function(a,b){return a};goog.exportSymbol=function(a,b,d){goog.exportPath_(a,b,d)};goog.exportProperty=function(a,b,d){a[b]=d};
goog.inherits=function(a,b){function d(){}d.prototype=b.prototype;a.superClass_=b.prototype;a.prototype=new d;a.prototype.constructor=a;a.base=function(a,d,g){for(var k=Array(arguments.length-2),m=2;m<arguments.length;m++)k[m-2]=arguments[m];return b.prototype[d].apply(a,k)}};
goog.base=function(a,b,d){var e=arguments.callee.caller;if(goog.STRICT_MODE_COMPATIBLE||goog.DEBUG&&!e)throw Error("arguments.caller not defined.  goog.base() cannot be used with strict mode code. See http://www.ecma-international.org/ecma-262/5.1/#sec-C");if(e.superClass_){for(var f=Array(arguments.length-1),g=1;g<arguments.length;g++)f[g-1]=arguments[g];return e.superClass_.constructor.apply(a,f)}f=Array(arguments.length-2);for(g=2;g<arguments.length;g++)f[g-2]=arguments[g];for(var g=!1,k=a.constructor;k;k=
k.superClass_&&k.superClass_.constructor)if(k.prototype[b]===e)g=!0;else if(g)return k.prototype[b].apply(a,f);if(a[b]===e)return a.constructor.prototype[b].apply(a,f);throw Error("goog.base called from a method of one name to a method of a different name");};goog.scope=function(a){a.call(goog.global)};COMPILED||(goog.global.COMPILED=COMPILED);
goog.defineClass=function(a,b){var d=b.constructor,e=b.statics;d&&d!=Object.prototype.constructor||(d=function(){throw Error("cannot instantiate an interface (no constructor defined).");});d=goog.defineClass.createSealingConstructor_(d,a);a&&goog.inherits(d,a);delete b.constructor;delete b.statics;goog.defineClass.applyProperties_(d.prototype,b);null!=e&&(e instanceof Function?e(d):goog.defineClass.applyProperties_(d,e));return d};goog.defineClass.SEAL_CLASS_INSTANCES=goog.DEBUG;
goog.defineClass.createSealingConstructor_=function(a,b){if(goog.defineClass.SEAL_CLASS_INSTANCES&&Object.seal instanceof Function){if(b&&b.prototype&&b.prototype[goog.UNSEALABLE_CONSTRUCTOR_PROPERTY_])return a;var d=function(){var b=a.apply(this,arguments)||this;b[goog.UID_PROPERTY_]=b[goog.UID_PROPERTY_];this.constructor===d&&Object.seal(b);return b};return d}return a};goog.defineClass.OBJECT_PROTOTYPE_FIELDS_="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");
goog.defineClass.applyProperties_=function(a,b){for(var d in b)Object.prototype.hasOwnProperty.call(b,d)&&(a[d]=b[d]);for(var e=0;e<goog.defineClass.OBJECT_PROTOTYPE_FIELDS_.length;e++)d=goog.defineClass.OBJECT_PROTOTYPE_FIELDS_[e],Object.prototype.hasOwnProperty.call(b,d)&&(a[d]=b[d])};goog.tagUnsealableClass=function(a){!COMPILED&&goog.defineClass.SEAL_CLASS_INSTANCES&&(a.prototype[goog.UNSEALABLE_CONSTRUCTOR_PROPERTY_]=!0)};goog.UNSEALABLE_CONSTRUCTOR_PROPERTY_="goog_defineClass_legacy_unsealable";
var box2d={b2Settings:{}};Object.defineProperty||(Object.defineProperty=function(a,b,d){Object.__defineGetter__&&("get"in d?a.__defineGetter__(b,d.get):"value"in d&&a.__defineGetter__(b,d.value));Object.__defineSetter__&&("set"in d?a.__defineSetter__(b,d.set):"value"in d&&a.__defineSetter__(b,d.value))});box2d.DEBUG=!0;goog.exportSymbol("box2d.DEBUG",box2d.DEBUG);box2d.ENABLE_ASSERTS=box2d.DEBUG;goog.exportSymbol("box2d.ENABLE_ASSERTS",box2d.ENABLE_ASSERTS);
box2d.b2Assert=function(a,b,d){if(box2d.DEBUG&&!a)debugger};goog.exportSymbol("box2d.b2Assert",box2d.b2Assert);box2d.b2_maxFloat=1E37;goog.exportSymbol("box2d.b2_maxFloat",box2d.b2_maxFloat);box2d.b2_epsilon=1E-5;goog.exportSymbol("box2d.b2_epsilon",box2d.b2_epsilon);box2d.b2_epsilon_sq=box2d.b2_epsilon*box2d.b2_epsilon;goog.exportSymbol("box2d.b2_epsilon_sq",box2d.b2_epsilon_sq);box2d.b2_pi=Math.PI;goog.exportSymbol("box2d.b2_pi",box2d.b2_pi);box2d.b2_maxManifoldPoints=2;
goog.exportSymbol("box2d.b2_maxManifoldPoints",box2d.b2_maxManifoldPoints);box2d.b2_maxPolygonVertices=8;goog.exportSymbol("box2d.b2_maxPolygonVertices",box2d.b2_maxPolygonVertices);box2d.b2_aabbExtension=.1;goog.exportSymbol("box2d.b2_aabbExtension",box2d.b2_aabbExtension);box2d.b2_aabbMultiplier=2;goog.exportSymbol("box2d.b2_aabbMultiplier",box2d.b2_aabbMultiplier);box2d.b2_linearSlop=.008;goog.exportSymbol("box2d.b2_linearSlop",box2d.b2_linearSlop);box2d.b2_angularSlop=2/180*box2d.b2_pi;
goog.exportSymbol("box2d.b2_angularSlop",box2d.b2_angularSlop);box2d.b2_polygonRadius=2*box2d.b2_linearSlop;goog.exportSymbol("box2d.b2_polygonRadius",box2d.b2_polygonRadius);box2d.b2_maxSubSteps=8;goog.exportSymbol("box2d.b2_maxSubSteps",box2d.b2_maxSubSteps);box2d.b2_maxTOIContacts=32;goog.exportSymbol("box2d.b2_maxTOIContacts",box2d.b2_maxTOIContacts);box2d.b2_velocityThreshold=1;goog.exportSymbol("box2d.b2_velocityThreshold",box2d.b2_velocityThreshold);box2d.b2_maxLinearCorrection=.2;
goog.exportSymbol("box2d.b2_maxLinearCorrection",box2d.b2_maxLinearCorrection);box2d.b2_maxAngularCorrection=8/180*box2d.b2_pi;goog.exportSymbol("box2d.b2_maxAngularCorrection",box2d.b2_maxAngularCorrection);box2d.b2_maxTranslation=2;goog.exportSymbol("box2d.b2_maxTranslation",box2d.b2_maxTranslation);box2d.b2_maxTranslationSquared=box2d.b2_maxTranslation*box2d.b2_maxTranslation;goog.exportSymbol("box2d.b2_maxTranslationSquared",box2d.b2_maxTranslationSquared);box2d.b2_maxRotation=.5*box2d.b2_pi;
goog.exportSymbol("box2d.b2_maxRotation",box2d.b2_maxRotation);box2d.b2_maxRotationSquared=box2d.b2_maxRotation*box2d.b2_maxRotation;goog.exportSymbol("box2d.b2_maxRotationSquared",box2d.b2_maxRotationSquared);box2d.b2_baumgarte=.2;goog.exportSymbol("box2d.b2_baumgarte",box2d.b2_baumgarte);box2d.b2_toiBaumgarte=.75;goog.exportSymbol("box2d.b2_toiBaumgarte",box2d.b2_toiBaumgarte);box2d.b2_invalidParticleIndex=-1;goog.exportSymbol("box2d.b2_invalidParticleIndex",box2d.b2_invalidParticleIndex);
box2d.b2_maxParticleIndex=2147483647;goog.exportSymbol("box2d.b2_maxParticleIndex",box2d.b2_maxParticleIndex);box2d.b2_particleStride=.75;goog.exportSymbol("box2d.b2_particleStride",box2d.b2_particleStride);box2d.b2_minParticleWeight=1;goog.exportSymbol("box2d.b2_minParticleWeight",box2d.b2_minParticleWeight);box2d.b2_maxParticlePressure=.25;goog.exportSymbol("box2d.b2_maxParticlePressure",box2d.b2_maxParticlePressure);box2d.b2_maxParticleForce=.5;goog.exportSymbol("box2d.b2_maxParticleForce",box2d.b2_maxParticleForce);
box2d.b2_maxTriadDistance=2;goog.exportSymbol("box2d.b2_maxTriadDistance",box2d.b2_maxTriadDistance);box2d.b2_maxTriadDistanceSquared=box2d.b2_maxTriadDistance*box2d.b2_maxTriadDistance;goog.exportSymbol("box2d.b2_maxTriadDistanceSquared",box2d.b2_maxTriadDistanceSquared);box2d.b2_minParticleSystemBufferCapacity=256;goog.exportSymbol("box2d.b2_minParticleSystemBufferCapacity",box2d.b2_minParticleSystemBufferCapacity);box2d.b2_barrierCollisionTime=2.5;
goog.exportSymbol("box2d.b2_barrierCollisionTime",box2d.b2_barrierCollisionTime);box2d.b2_timeToSleep=.5;goog.exportSymbol("box2d.b2_timeToSleep",box2d.b2_timeToSleep);box2d.b2_linearSleepTolerance=.01;goog.exportSymbol("box2d.b2_linearSleepTolerance",box2d.b2_linearSleepTolerance);box2d.b2_angularSleepTolerance=2/180*box2d.b2_pi;goog.exportSymbol("box2d.b2_angularSleepTolerance",box2d.b2_angularSleepTolerance);box2d.b2Alloc=function(a){return null};goog.exportSymbol("box2d.b2Alloc",box2d.b2Alloc);
box2d.b2Free=function(a){};goog.exportSymbol("box2d.b2Free",box2d.b2Free);box2d.b2Log=function(a){goog.global.console.log.apply(null,arguments)};goog.exportSymbol("box2d.b2Log",box2d.b2Log);box2d.b2Version=function(a,b,d){this.major=a||0;this.minor=b||0;this.revision=d||0};goog.exportSymbol("box2d.b2Version",box2d.b2Version);box2d.b2Version.prototype.major=0;goog.exportProperty(box2d.b2Version.prototype,"major",box2d.b2Version.prototype.major);box2d.b2Version.prototype.minor=0;
goog.exportProperty(box2d.b2Version.prototype,"minor",box2d.b2Version.prototype.minor);box2d.b2Version.prototype.revision=0;goog.exportProperty(box2d.b2Version.prototype,"revision",box2d.b2Version.prototype.revision);box2d.b2Version.prototype.toString=function(){return this.major+"."+this.minor+"."+this.revision};goog.exportProperty(box2d.b2Version.prototype,"toString",box2d.b2Version.prototype.toString);box2d.b2_version=new box2d.b2Version(2,3,2);goog.exportSymbol("box2d.b2_version",box2d.b2_version);
box2d.b2_changelist=313;goog.exportSymbol("box2d.b2_changelist",box2d.b2_changelist);box2d.b2ParseInt=function(a){return parseInt(a,10)};goog.exportSymbol("box2d.b2ParseInt",box2d.b2ParseInt);box2d.b2ParseUInt=function(a){return box2d.b2Abs(parseInt(a,10))};goog.exportSymbol("box2d.b2ParseUInt",box2d.b2ParseUInt);box2d.b2MakeArray=function(a,b){a="number"===typeof a?a:0;var d=[];if("function"===typeof b)for(var e=0;e<a;++e)d.push(b(e));else for(e=0;e<a;++e)d.push(null);return d};
goog.exportSymbol("box2d.b2MakeArray",box2d.b2MakeArray);box2d.b2MakeNumberArray=function(a){return box2d.b2MakeArray(a,function(a){return 0})};goog.exportSymbol("box2d.b2MakeNumberArray",box2d.b2MakeNumberArray);box2d.b2Color=function(a,b,d,e){this.r=a;this.g=b;this.b=d;this.a="number"===typeof e?e:1};goog.exportSymbol("box2d.b2Color",box2d.b2Color);box2d.b2Color.prototype.r=.5;goog.exportProperty(box2d.b2Color.prototype,"r",box2d.b2Color.prototype.r);box2d.b2Color.prototype.g=.5;
goog.exportProperty(box2d.b2Color.prototype,"g",box2d.b2Color.prototype.g);box2d.b2Color.prototype.b=.5;goog.exportProperty(box2d.b2Color.prototype,"b",box2d.b2Color.prototype.b);box2d.b2Color.prototype.a=1;goog.exportProperty(box2d.b2Color.prototype,"a",box2d.b2Color.prototype.a);box2d.b2Color.prototype.SetRGB=function(a,b,d){this.r=a;this.g=b;this.b=d;return this};goog.exportProperty(box2d.b2Color.prototype,"SetRGB",box2d.b2Color.prototype.SetRGB);
box2d.b2Color.prototype.MakeStyleString=function(a){var b=Math.round(Math.max(0,Math.min(255,255*this.r))),d=Math.round(Math.max(0,Math.min(255,255*this.g))),e=Math.round(Math.max(0,Math.min(255,255*this.b)));a="undefined"===typeof a?this.a:Math.max(0,Math.min(1,a));return box2d.b2Color.MakeStyleString(b,d,e,a)};goog.exportProperty(box2d.b2Color.prototype,"MakeStyleString",box2d.b2Color.prototype.MakeStyleString);
box2d.b2Color.MakeStyleString=function(a,b,d,e){return 1>e?"rgba("+a+","+b+","+d+","+e+")":"rgb("+a+","+b+","+d+")"};goog.exportProperty(box2d.b2Color,"MakeStyleString",box2d.b2Color.MakeStyleString);box2d.b2Color.RED=new box2d.b2Color(1,0,0);goog.exportProperty(box2d.b2Color,"RED",box2d.b2Color.RED);box2d.b2Color.GREEN=new box2d.b2Color(0,1,0);goog.exportProperty(box2d.b2Color,"GREEN",box2d.b2Color.GREEN);box2d.b2Color.BLUE=new box2d.b2Color(0,0,1);goog.exportProperty(box2d.b2Color,"BLUE",box2d.b2Color.BLUE);
box2d.b2DrawFlags={e_none:0,e_shapeBit:1,e_jointBit:2,e_aabbBit:4,e_pairBit:8,e_centerOfMassBit:16,e_controllerBit:32,e_particleBit:64,e_all:65535};goog.exportSymbol("box2d.b2DrawFlags",box2d.b2DrawFlags);goog.exportProperty(box2d.b2DrawFlags,"e_none",box2d.b2DrawFlags.e_none);goog.exportProperty(box2d.b2DrawFlags,"e_shapeBit",box2d.b2DrawFlags.e_shapeBit);goog.exportProperty(box2d.b2DrawFlags,"e_jointBit",box2d.b2DrawFlags.e_jointBit);goog.exportProperty(box2d.b2DrawFlags,"e_aabbBit",box2d.b2DrawFlags.e_aabbBit);
goog.exportProperty(box2d.b2DrawFlags,"e_pairBit",box2d.b2DrawFlags.e_pairBit);goog.exportProperty(box2d.b2DrawFlags,"e_centerOfMassBit",box2d.b2DrawFlags.e_centerOfMassBit);goog.exportProperty(box2d.b2DrawFlags,"e_controllerBit",box2d.b2DrawFlags.e_controllerBit);goog.exportProperty(box2d.b2DrawFlags,"e_particleBit",box2d.b2DrawFlags.e_particleBit);goog.exportProperty(box2d.b2DrawFlags,"e_all",box2d.b2DrawFlags.e_all);box2d.b2Draw=function(){};goog.exportSymbol("box2d.b2Draw",box2d.b2Draw);
box2d.b2Draw.prototype.m_drawFlags=box2d.b2DrawFlags.e_none;goog.exportProperty(box2d.b2Draw.prototype,"m_drawFlags",box2d.b2Draw.prototype.m_drawFlags);box2d.b2Draw.prototype.SetFlags=function(a){this.m_drawFlags=a};goog.exportProperty(box2d.b2Draw.prototype,"SetFlags",box2d.b2Draw.prototype.SetFlags);box2d.b2Draw.prototype.GetFlags=function(){return this.m_drawFlags};goog.exportProperty(box2d.b2Draw.prototype,"GetFlags",box2d.b2Draw.prototype.GetFlags);
box2d.b2Draw.prototype.AppendFlags=function(a){this.m_drawFlags|=a};goog.exportProperty(box2d.b2Draw.prototype,"AppendFlags",box2d.b2Draw.prototype.AppendFlags);box2d.b2Draw.prototype.ClearFlags=function(a){this.m_drawFlags&=~a};goog.exportProperty(box2d.b2Draw.prototype,"ClearFlags",box2d.b2Draw.prototype.ClearFlags);box2d.b2Draw.prototype.PushTransform=function(a){};goog.exportProperty(box2d.b2Draw.prototype,"PushTransform",box2d.b2Draw.prototype.PushTransform);
box2d.b2Draw.prototype.PopTransform=function(a){};goog.exportProperty(box2d.b2Draw.prototype,"PopTransform",box2d.b2Draw.prototype.PopTransform);box2d.b2Draw.prototype.DrawPolygon=function(a,b,d){};goog.exportProperty(box2d.b2Draw.prototype,"DrawPolygon",box2d.b2Draw.prototype.DrawPolygon);box2d.b2Draw.prototype.DrawSolidPolygon=function(a,b,d){};goog.exportProperty(box2d.b2Draw.prototype,"DrawSolidPolygon",box2d.b2Draw.prototype.DrawSolidPolygon);box2d.b2Draw.prototype.DrawCircle=function(a,b,d){};
goog.exportProperty(box2d.b2Draw.prototype,"DrawCircle",box2d.b2Draw.prototype.DrawCircle);box2d.b2Draw.prototype.DrawSolidCircle=function(a,b,d,e){};goog.exportProperty(box2d.b2Draw.prototype,"DrawSolidCircle",box2d.b2Draw.prototype.DrawSolidCircle);box2d.b2Draw.prototype.DrawParticles=function(a,b,d,e){};goog.exportProperty(box2d.b2Draw.prototype,"DrawParticles",box2d.b2Draw.prototype.DrawParticles);box2d.b2Draw.prototype.DrawSegment=function(a,b,d){};
goog.exportProperty(box2d.b2Draw.prototype,"DrawSegment",box2d.b2Draw.prototype.DrawSegment);box2d.b2Draw.prototype.DrawTransform=function(a){};goog.exportProperty(box2d.b2Draw.prototype,"DrawTransform",box2d.b2Draw.prototype.DrawTransform);box2d.b2GrowableStack=function(a){this.m_stack=Array(a)};goog.exportSymbol("box2d.b2GrowableStack",box2d.b2GrowableStack);box2d.b2GrowableStack.prototype.m_stack=null;goog.exportProperty(box2d.b2GrowableStack.prototype,"m_stack",box2d.b2GrowableStack.prototype.m_stack);
box2d.b2GrowableStack.prototype.m_count=0;goog.exportProperty(box2d.b2GrowableStack.prototype,"m_count",box2d.b2GrowableStack.prototype.m_count);box2d.b2GrowableStack.prototype.Reset=function(){this.m_count=0;return this};goog.exportProperty(box2d.b2GrowableStack.prototype,"Reset",box2d.b2GrowableStack.prototype.Reset);box2d.b2GrowableStack.prototype.Push=function(a){this.m_stack[this.m_count]=a;++this.m_count};goog.exportProperty(box2d.b2GrowableStack.prototype,"Push",box2d.b2GrowableStack.prototype.Push);
box2d.b2GrowableStack.prototype.Pop=function(){box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<this.m_count);--this.m_count;var a=this.m_stack[this.m_count];this.m_stack[this.m_count]=null;return a};goog.exportProperty(box2d.b2GrowableStack.prototype,"Pop",box2d.b2GrowableStack.prototype.Pop);box2d.b2GrowableStack.prototype.GetCount=function(){return this.m_count};goog.exportProperty(box2d.b2GrowableStack.prototype,"GetCount",box2d.b2GrowableStack.prototype.GetCount);box2d.b2Math={};
box2d.b2_pi_over_180=box2d.b2_pi/180;goog.exportSymbol("box2d.b2_pi_over_180",box2d.b2_pi_over_180);box2d.b2_180_over_pi=180/box2d.b2_pi;goog.exportSymbol("box2d.b2_180_over_pi",box2d.b2_180_over_pi);box2d.b2_two_pi=2*box2d.b2_pi;goog.exportSymbol("box2d.b2_two_pi",box2d.b2_two_pi);box2d.b2Abs=Math.abs;goog.exportSymbol("box2d.b2Abs",box2d.b2Abs);box2d.b2Min=Math.min;goog.exportSymbol("box2d.b2Min",box2d.b2Min);box2d.b2Max=Math.max;goog.exportSymbol("box2d.b2Max",box2d.b2Max);
box2d.b2Clamp=function(a,b,d){return Math.min(Math.max(a,b),d)};goog.exportSymbol("box2d.b2Clamp",box2d.b2Clamp);box2d.b2Wrap=function(a,b,d){return b<d?a<b?d-(b-a)%(d-b):b+(a-b)%(d-b):b===d?b:a};goog.exportSymbol("box2d.b2Wrap",box2d.b2Wrap);box2d.b2WrapAngle=function(a){return 0>a?(a-box2d.b2_pi)%box2d.b2_two_pi+box2d.b2_pi:(a+box2d.b2_pi)%box2d.b2_two_pi-box2d.b2_pi};goog.exportSymbol("box2d.b2WrapAngle",box2d.b2WrapAngle);
box2d.b2Swap=function(a,b){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1);var d=a[0];a[0]=b[0];b[0]=d};goog.exportSymbol("box2d.b2Swap",box2d.b2Swap);box2d.b2IsValid=function(a){return isFinite(a)};goog.exportSymbol("box2d.b2IsValid",box2d.b2IsValid);box2d.b2Sq=function(a){return a*a};goog.exportSymbol("box2d.b2Sq",box2d.b2Sq);box2d.b2InvSqrt=function(a){return 1/Math.sqrt(a)};goog.exportSymbol("box2d.b2InvSqrt",box2d.b2InvSqrt);box2d.b2Sqrt=function(a){return Math.sqrt(a)};
goog.exportSymbol("box2d.b2Sqrt",box2d.b2Sqrt);box2d.b2Pow=function(a,b){return Math.pow(a,b)};goog.exportSymbol("box2d.b2Pow",box2d.b2Pow);box2d.b2DegToRad=function(a){return a*box2d.b2_pi_over_180};goog.exportSymbol("box2d.b2DegToRad",box2d.b2DegToRad);box2d.b2RadToDeg=function(a){return a*box2d.b2_180_over_pi};goog.exportSymbol("box2d.b2RadToDeg",box2d.b2RadToDeg);box2d.b2Cos=function(a){return Math.cos(a)};goog.exportSymbol("box2d.b2Cos",box2d.b2Cos);box2d.b2Sin=function(a){return Math.sin(a)};
goog.exportSymbol("box2d.b2Sin",box2d.b2Sin);box2d.b2Acos=function(a){return Math.acos(a)};goog.exportSymbol("box2d.b2Acos",box2d.b2Acos);box2d.b2Asin=function(a){return Math.asin(a)};goog.exportSymbol("box2d.b2Asin",box2d.b2Asin);box2d.b2Atan2=function(a,b){return Math.atan2(a,b)};goog.exportSymbol("box2d.b2Atan2",box2d.b2Atan2);box2d.b2NextPowerOfTwo=function(a){a|=a>>1&2147483647;a|=a>>2&1073741823;a|=a>>4&268435455;a|=a>>8&16777215;return(a|a>>16&65535)+1};
goog.exportSymbol("box2d.b2NextPowerOfTwo",box2d.b2NextPowerOfTwo);box2d.b2IsPowerOfTwo=function(a){return 0<a&&0===(a&a-1)};goog.exportSymbol("box2d.b2IsPowerOfTwo",box2d.b2IsPowerOfTwo);box2d.b2Random=function(){return 2*Math.random()-1};goog.exportSymbol("box2d.b2Random",box2d.b2Random);box2d.b2RandomRange=function(a,b){return(b-a)*Math.random()+a};goog.exportSymbol("box2d.b2RandomRange",box2d.b2RandomRange);box2d.b2Vec2=function(a,b){this.x=a||0;this.y=b||0};goog.exportSymbol("box2d.b2Vec2",box2d.b2Vec2);
box2d.b2Vec2.prototype.x=0;goog.exportProperty(box2d.b2Vec2.prototype,"x",box2d.b2Vec2.prototype.x);box2d.b2Vec2.prototype.y=0;goog.exportProperty(box2d.b2Vec2.prototype,"y",box2d.b2Vec2.prototype.y);box2d.b2Vec2_zero=new box2d.b2Vec2;goog.exportSymbol("box2d.b2Vec2_zero",box2d.b2Vec2_zero);box2d.b2Vec2.ZERO=new box2d.b2Vec2;goog.exportProperty(box2d.b2Vec2,"ZERO",box2d.b2Vec2.ZERO);box2d.b2Vec2.UNITX=new box2d.b2Vec2(1,0);goog.exportProperty(box2d.b2Vec2,"UNITX",box2d.b2Vec2.UNITX);
box2d.b2Vec2.UNITY=new box2d.b2Vec2(0,1);goog.exportProperty(box2d.b2Vec2,"UNITY",box2d.b2Vec2.UNITY);box2d.b2Vec2.s_t0=new box2d.b2Vec2;goog.exportProperty(box2d.b2Vec2,"s_t0",box2d.b2Vec2.s_t0);box2d.b2Vec2.s_t1=new box2d.b2Vec2;goog.exportProperty(box2d.b2Vec2,"s_t1",box2d.b2Vec2.s_t1);box2d.b2Vec2.s_t2=new box2d.b2Vec2;goog.exportProperty(box2d.b2Vec2,"s_t2",box2d.b2Vec2.s_t2);box2d.b2Vec2.s_t3=new box2d.b2Vec2;goog.exportProperty(box2d.b2Vec2,"s_t3",box2d.b2Vec2.s_t3);
box2d.b2Vec2.MakeArray=function(a){return box2d.b2MakeArray(a,function(a){return new box2d.b2Vec2})};goog.exportProperty(box2d.b2Vec2,"MakeArray",box2d.b2Vec2.MakeArray);box2d.b2Vec2.prototype.Clone=function(){return new box2d.b2Vec2(this.x,this.y)};goog.exportProperty(box2d.b2Vec2.prototype,"Clone",box2d.b2Vec2.prototype.Clone);box2d.b2Vec2.prototype.SetZero=function(){this.y=this.x=0;return this};goog.exportProperty(box2d.b2Vec2.prototype,"SetZero",box2d.b2Vec2.prototype.SetZero);
box2d.b2Vec2.prototype.Set=function(a,b){this.x=a;this.y=b;return this};goog.exportProperty(box2d.b2Vec2.prototype,"Set",box2d.b2Vec2.prototype.Set);box2d.b2Vec2.prototype.Copy=function(a){this.x=a.x;this.y=a.y;return this};goog.exportProperty(box2d.b2Vec2.prototype,"Copy",box2d.b2Vec2.prototype.Copy);box2d.b2Vec2.prototype.SelfAdd=function(a){this.x+=a.x;this.y+=a.y;return this};goog.exportProperty(box2d.b2Vec2.prototype,"SelfAdd",box2d.b2Vec2.prototype.SelfAdd);
box2d.b2Vec2.prototype.SelfAddXY=function(a,b){this.x+=a;this.y+=b;return this};goog.exportProperty(box2d.b2Vec2.prototype,"SelfAddXY",box2d.b2Vec2.prototype.SelfAddXY);box2d.b2Vec2.prototype.SelfSub=function(a){this.x-=a.x;this.y-=a.y;return this};goog.exportProperty(box2d.b2Vec2.prototype,"SelfSub",box2d.b2Vec2.prototype.SelfSub);box2d.b2Vec2.prototype.SelfSubXY=function(a,b){this.x-=a;this.y-=b;return this};goog.exportProperty(box2d.b2Vec2.prototype,"SelfSubXY",box2d.b2Vec2.prototype.SelfSubXY);
box2d.b2Vec2.prototype.SelfMul=function(a){this.x*=a;this.y*=a;return this};goog.exportProperty(box2d.b2Vec2.prototype,"SelfMul",box2d.b2Vec2.prototype.SelfMul);box2d.b2Vec2.prototype.SelfMulAdd=function(a,b){this.x+=a*b.x;this.y+=a*b.y;return this};goog.exportProperty(box2d.b2Vec2.prototype,"SelfMulAdd",box2d.b2Vec2.prototype.SelfMulAdd);box2d.b2Vec2.prototype.SelfMulSub=function(a,b){this.x-=a*b.x;this.y-=a*b.y;return this};goog.exportProperty(box2d.b2Vec2.prototype,"SelfMulSub",box2d.b2Vec2.prototype.SelfMulSub);
box2d.b2Vec2.prototype.Dot=function(a){return this.x*a.x+this.y*a.y};goog.exportProperty(box2d.b2Vec2.prototype,"Dot",box2d.b2Vec2.prototype.Dot);box2d.b2Vec2.prototype.Cross=function(a){return this.x*a.y-this.y*a.x};goog.exportProperty(box2d.b2Vec2.prototype,"Cross",box2d.b2Vec2.prototype.Cross);box2d.b2Vec2.prototype.Length=function(){var a=this.x,b=this.y;return Math.sqrt(a*a+b*b)};goog.exportProperty(box2d.b2Vec2.prototype,"Length",box2d.b2Vec2.prototype.Length);
box2d.b2Vec2.prototype.LengthSquared=function(){var a=this.x,b=this.y;return a*a+b*b};goog.exportProperty(box2d.b2Vec2.prototype,"LengthSquared",box2d.b2Vec2.prototype.LengthSquared);box2d.b2Vec2.prototype.Normalize=function(){var a=this.Length();if(a>=box2d.b2_epsilon){var b=1/a;this.x*=b;this.y*=b}return a};goog.exportProperty(box2d.b2Vec2.prototype,"Normalize",box2d.b2Vec2.prototype.Normalize);box2d.b2Vec2.prototype.SelfNormalize=function(){this.Normalize();return this};
goog.exportProperty(box2d.b2Vec2.prototype,"SelfNormalize",box2d.b2Vec2.prototype.SelfNormalize);box2d.b2Vec2.prototype.SelfRotate=function(a,b){var d=this.x,e=this.y;this.x=a*d-b*e;this.y=b*d+a*e;return this};goog.exportProperty(box2d.b2Vec2.prototype,"SelfRotate",box2d.b2Vec2.prototype.SelfRotate);box2d.b2Vec2.prototype.SelfRotateAngle=function(a){return this.SelfRotate(Math.cos(a),Math.sin(a))};goog.exportProperty(box2d.b2Vec2.prototype,"SelfRotateAngle",box2d.b2Vec2.prototype.SelfRotateAngle);
box2d.b2Vec2.prototype.IsValid=function(){return isFinite(this.x)&&isFinite(this.y)};goog.exportProperty(box2d.b2Vec2.prototype,"IsValid",box2d.b2Vec2.prototype.IsValid);box2d.b2Vec2.prototype.SelfMin=function(a){this.x=Math.min(this.x,a.x);this.y=Math.min(this.y,a.y);return this};goog.exportProperty(box2d.b2Vec2.prototype,"SelfMin",box2d.b2Vec2.prototype.SelfMin);box2d.b2Vec2.prototype.SelfMax=function(a){this.x=Math.max(this.x,a.x);this.y=Math.max(this.y,a.y);return this};
goog.exportProperty(box2d.b2Vec2.prototype,"SelfMax",box2d.b2Vec2.prototype.SelfMax);box2d.b2Vec2.prototype.SelfAbs=function(){this.x=Math.abs(this.x);this.y=Math.abs(this.y);return this};goog.exportProperty(box2d.b2Vec2.prototype,"SelfAbs",box2d.b2Vec2.prototype.SelfAbs);box2d.b2Vec2.prototype.SelfNeg=function(){this.x=-this.x;this.y=-this.y;return this};goog.exportProperty(box2d.b2Vec2.prototype,"SelfNeg",box2d.b2Vec2.prototype.SelfNeg);
box2d.b2Vec2.prototype.SelfSkew=function(){var a=this.x;this.x=-this.y;this.y=a;return this};goog.exportProperty(box2d.b2Vec2.prototype,"SelfSkew",box2d.b2Vec2.prototype.SelfSkew);box2d.b2Abs_V2=function(a,b){b.x=Math.abs(a.x);b.y=Math.abs(a.y);return b};goog.exportSymbol("box2d.b2Abs_V2",box2d.b2Abs_V2);box2d.b2Min_V2_V2=function(a,b,d){d.x=Math.min(a.x,b.x);d.y=Math.min(a.y,b.y);return d};goog.exportSymbol("box2d.b2Min_V2_V2",box2d.b2Min_V2_V2);
box2d.b2Max_V2_V2=function(a,b,d){d.x=Math.max(a.x,b.x);d.y=Math.max(a.y,b.y);return d};goog.exportSymbol("box2d.b2Max_V2_V2",box2d.b2Max_V2_V2);box2d.b2Clamp_V2_V2_V2=function(a,b,d,e){e.x=Math.min(Math.max(a.x,b.x),d.x);e.y=Math.min(Math.max(a.y,b.y),d.y);return e};goog.exportSymbol("box2d.b2Clamp_V2_V2_V2",box2d.b2Clamp_V2_V2_V2);box2d.b2Dot_V2_V2=function(a,b){return a.x*b.x+a.y*b.y};goog.exportSymbol("box2d.b2Dot_V2_V2",box2d.b2Dot_V2_V2);
box2d.b2Cross_V2_V2=function(a,b){return a.x*b.y-a.y*b.x};goog.exportSymbol("box2d.b2Cross_V2_V2",box2d.b2Cross_V2_V2);box2d.b2Cross_V2_S=function(a,b,d){var e=a.x;d.x=b*a.y;d.y=-b*e;return d};goog.exportSymbol("box2d.b2Cross_V2_S",box2d.b2Cross_V2_S);box2d.b2Cross_S_V2=function(a,b,d){var e=b.x;d.x=-a*b.y;d.y=a*e;return d};goog.exportSymbol("box2d.b2Cross_S_V2",box2d.b2Cross_S_V2);box2d.b2Add_V2_V2=function(a,b,d){d.x=a.x+b.x;d.y=a.y+b.y;return d};goog.exportSymbol("box2d.b2Add_V2_V2",box2d.b2Add_V2_V2);
box2d.b2Sub_V2_V2=function(a,b,d){d.x=a.x-b.x;d.y=a.y-b.y;return d};goog.exportSymbol("box2d.b2Sub_V2_V2",box2d.b2Sub_V2_V2);box2d.b2Add_V2_S=function(a,b,d){d.x=a.x+b;d.y=a.y+b;return d};goog.exportSymbol("box2d.b2Add_V2_S",box2d.b2Add_V2_S);box2d.b2Sub_V2_S=function(a,b,d){d.x=a.x-b;d.y=a.y-b;return d};goog.exportSymbol("box2d.b2Sub_V2_S",box2d.b2Sub_V2_S);box2d.b2Mul_S_V2=function(a,b,d){d.x=b.x*a;d.y=b.y*a;return d};goog.exportSymbol("box2d.b2Mul_S_V2",box2d.b2Mul_S_V2);
box2d.b2Mul_V2_S=function(a,b,d){d.x=a.x*b;d.y=a.y*b;return d};goog.exportSymbol("box2d.b2Mul_V2_S",box2d.b2Mul_V2_S);box2d.b2Div_V2_S=function(a,b,d){d.x=a.x/b;d.y=a.y/b;return d};goog.exportSymbol("box2d.b2Div_V2_S",box2d.b2Div_V2_S);box2d.b2AddMul_V2_S_V2=function(a,b,d,e){e.x=a.x+b*d.x;e.y=a.y+b*d.y;return e};goog.exportSymbol("box2d.b2AddMul_V2_S_V2",box2d.b2AddMul_V2_S_V2);box2d.b2SubMul_V2_S_V2=function(a,b,d,e){e.x=a.x-b*d.x;e.y=a.y-b*d.y;return e};
goog.exportSymbol("box2d.b2SubMul_V2_S_V2",box2d.b2SubMul_V2_S_V2);box2d.b2AddCross_V2_S_V2=function(a,b,d,e){var f=d.x;e.x=a.x-b*d.y;e.y=a.y+b*f;return e};goog.exportSymbol("box2d.b2AddCross_V2_S_V2",box2d.b2AddCross_V2_S_V2);box2d.b2Mid_V2_V2=function(a,b,d){d.x=.5*(a.x+b.x);d.y=.5*(a.y+b.y);return d};goog.exportSymbol("box2d.b2Mid_V2_V2",box2d.b2Mid_V2_V2);box2d.b2Ext_V2_V2=function(a,b,d){d.x=.5*(b.x-a.x);d.y=.5*(b.y-a.y);return d};goog.exportSymbol("box2d.b2Ext_V2_V2",box2d.b2Ext_V2_V2);
box2d.b2Distance=function(a,b){var d=a.x-b.x,e=a.y-b.y;return Math.sqrt(d*d+e*e)};goog.exportSymbol("box2d.b2Distance",box2d.b2Distance);box2d.b2DistanceSquared=function(a,b){var d=a.x-b.x,e=a.y-b.y;return d*d+e*e};goog.exportSymbol("box2d.b2DistanceSquared",box2d.b2DistanceSquared);box2d.b2Vec3=function(a,b,d){this.x=a||0;this.y=b||0;this.z=d||0};goog.exportSymbol("box2d.b2Vec3",box2d.b2Vec3);box2d.b2Vec3.prototype.x=0;goog.exportProperty(box2d.b2Vec3.prototype,"x",box2d.b2Vec3.prototype.x);
box2d.b2Vec3.prototype.y=0;goog.exportProperty(box2d.b2Vec3.prototype,"y",box2d.b2Vec3.prototype.y);box2d.b2Vec3.prototype.z=0;goog.exportProperty(box2d.b2Vec3.prototype,"z",box2d.b2Vec3.prototype.z);box2d.b2Vec3.ZERO=new box2d.b2Vec3;goog.exportProperty(box2d.b2Vec3,"ZERO",box2d.b2Vec3.ZERO);box2d.b2Vec3.s_t0=new box2d.b2Vec3;goog.exportProperty(box2d.b2Vec3,"s_t0",box2d.b2Vec3.s_t0);box2d.b2Vec3.prototype.Clone=function(){return new box2d.b2Vec3(this.x,this.y,this.z)};
goog.exportProperty(box2d.b2Vec3.prototype,"Clone",box2d.b2Vec3.prototype.Clone);box2d.b2Vec3.prototype.SetZero=function(){this.z=this.y=this.x=0;return this};goog.exportProperty(box2d.b2Vec3.prototype,"SetZero",box2d.b2Vec3.prototype.SetZero);box2d.b2Vec3.prototype.Set=function(a,b,d){this.x=a;this.y=b;this.z=d;return this};goog.exportProperty(box2d.b2Vec3.prototype,"Set",box2d.b2Vec3.prototype.Set);box2d.b2Vec3.prototype.Copy=function(a){this.x=a.x;this.y=a.y;this.z=a.z;return this};
goog.exportProperty(box2d.b2Vec3.prototype,"Copy",box2d.b2Vec3.prototype.Copy);box2d.b2Vec3.prototype.SelfNeg=function(){this.x=-this.x;this.y=-this.y;this.z=-this.z;return this};goog.exportProperty(box2d.b2Vec3.prototype,"SelfNeg",box2d.b2Vec3.prototype.SelfNeg);box2d.b2Vec3.prototype.SelfAdd=function(a){this.x+=a.x;this.y+=a.y;this.z+=a.z;return this};goog.exportProperty(box2d.b2Vec3.prototype,"SelfAdd",box2d.b2Vec3.prototype.SelfAdd);
box2d.b2Vec3.prototype.SelfAddV2=function(a,b){this.x+=a.x;this.y+=a.y;this.z+=b;return this};goog.exportProperty(box2d.b2Vec3.prototype,"SelfAddV2",box2d.b2Vec3.prototype.SelfAddV2);box2d.b2Vec3.prototype.SelfAddXYZ=function(a,b,d){this.x+=a;this.y+=b;this.z+=d;return this};goog.exportProperty(box2d.b2Vec3.prototype,"SelfAddXYZ",box2d.b2Vec3.prototype.SelfAddXYZ);box2d.b2Vec3.prototype.SelfSub=function(a){this.x-=a.x;this.y-=a.y;this.z-=a.z;return this};
goog.exportProperty(box2d.b2Vec3.prototype,"SelfSub",box2d.b2Vec3.prototype.SelfSub);box2d.b2Vec3.prototype.SelfSubV2=function(a,b){this.x-=a.x;this.y-=a.y;this.z-=b;return this};goog.exportProperty(box2d.b2Vec3.prototype,"SelfSubV2",box2d.b2Vec3.prototype.SelfSubV2);box2d.b2Vec3.prototype.SelfSubXYZ=function(a,b,d){this.x-=a;this.y-=b;this.z-=d;return this};goog.exportProperty(box2d.b2Vec3.prototype,"SelfSubXYZ",box2d.b2Vec3.prototype.SelfSubXYZ);
box2d.b2Vec3.prototype.SelfMul=function(a){this.x*=a.x;this.y*=a.y;this.z*=a.z;return this};goog.exportProperty(box2d.b2Vec3.prototype,"SelfMul",box2d.b2Vec3.prototype.SelfMul);box2d.b2Vec3.prototype.SelfMulV2=function(a,b){this.x*=a.x;this.y*=a.y;this.z*=b;return this};goog.exportProperty(box2d.b2Vec3.prototype,"SelfMulV2",box2d.b2Vec3.prototype.SelfMulV2);box2d.b2Vec3.prototype.SelfMulXYZ=function(a,b,d){this.x*=a;this.y*=b;this.z*=d;return this};
goog.exportProperty(box2d.b2Vec3.prototype,"SelfMulXYZ",box2d.b2Vec3.prototype.SelfMulXYZ);box2d.b2Vec3.prototype.SelfMulScalar=function(a){this.x*=a;this.y*=a;this.z*=a;return this};goog.exportProperty(box2d.b2Vec3.prototype,"SelfMulScalar",box2d.b2Vec3.prototype.SelfMulScalar);box2d.b2Vec3.prototype.Length=function(){var a=this.x,b=this.y,d=this.z;return Math.sqrt(a*a+b*b+d*d)};goog.exportProperty(box2d.b2Vec3.prototype,"Length",box2d.b2Vec3.prototype.Length);
box2d.b2Vec3.prototype.LengthSquared=function(){var a=this.x,b=this.y,d=this.z;return a*a+b*b+d*d};goog.exportProperty(box2d.b2Vec3.prototype,"LengthSquared",box2d.b2Vec3.prototype.LengthSquared);box2d.b2Vec3.prototype.Normalize=function(){var a=this.Length();if(a>=box2d.b2_epsilon){var b=1/a;this.x*=b;this.y*=b;this.z*=b}return a};goog.exportProperty(box2d.b2Vec3.prototype,"Normalize",box2d.b2Vec3.prototype.Normalize);box2d.b2Vec3.prototype.SelfNormalize=function(){this.Normalize();return this};
goog.exportProperty(box2d.b2Vec3.prototype,"SelfNormalize",box2d.b2Vec3.prototype.SelfNormalize);box2d.b2Add_V3_V3=function(a,b,d){d.x=a.x+b.x;d.y=a.y+b.y;d.z=a.z+b.z;return d};goog.exportSymbol("box2d.b2Add_V3_V3",box2d.b2Add_V3_V3);box2d.b2Sub_V3_V3=function(a,b,d){d.x=a.x+b.x;d.y=a.y+b.y;d.z=a.z+b.z;return d};goog.exportSymbol("box2d.b2Sub_V3_V3",box2d.b2Sub_V3_V3);box2d.b2Dot_V3_V3=function(a,b){return a.x*b.x+a.y*b.y+a.z*b.z};goog.exportSymbol("box2d.b2Dot_V3_V3",box2d.b2Dot_V3_V3);
box2d.b2Cross_V3_V3=function(a,b,d){var e=a.x,f=a.y;a=a.z;var g=b.x,k=b.y;b=b.z;d.x=f*b-a*k;d.y=a*g-e*b;d.z=e*k-f*g;return d};goog.exportSymbol("box2d.b2Cross_V3_V3",box2d.b2Cross_V3_V3);box2d.b2Vec4=function(a,b,d,e){this.x=a||0;this.y=b||0;this.z=d||0;this.w=e||0};goog.exportSymbol("box2d.b2Vec4",box2d.b2Vec4);box2d.b2Vec4.prototype.x=0;goog.exportProperty(box2d.b2Vec4.prototype,"x",box2d.b2Vec4.prototype.x);box2d.b2Vec4.prototype.y=0;goog.exportProperty(box2d.b2Vec4.prototype,"y",box2d.b2Vec4.prototype.y);
box2d.b2Vec4.prototype.z=0;goog.exportProperty(box2d.b2Vec4.prototype,"z",box2d.b2Vec4.prototype.z);box2d.b2Vec4.prototype.w=0;goog.exportProperty(box2d.b2Vec4.prototype,"w",box2d.b2Vec4.prototype.w);box2d.b2Vec4.ZERO=new box2d.b2Vec4(0,0,0,0);goog.exportProperty(box2d.b2Vec4,"ZERO",box2d.b2Vec4.ZERO);box2d.b2Vec4.s_t0=new box2d.b2Vec4;goog.exportProperty(box2d.b2Vec4,"s_t0",box2d.b2Vec4.s_t0);box2d.b2Vec4.prototype.Clone=function(){return new box2d.b2Vec4(this.x,this.y,this.z,this.w)};
goog.exportProperty(box2d.b2Vec4.prototype,"Clone",box2d.b2Vec4.prototype.Clone);box2d.b2Vec4.prototype.SetZero=function(){this.w=this.z=this.y=this.x=0;return this};goog.exportProperty(box2d.b2Vec4.prototype,"SetZero",box2d.b2Vec4.prototype.SetZero);box2d.b2Vec4.prototype.Set=function(a,b,d,e){this.x=a;this.y=b;this.z=d;this.w=e;return this};goog.exportProperty(box2d.b2Vec4.prototype,"Set",box2d.b2Vec4.prototype.Set);
box2d.b2Vec4.prototype.Copy=function(a){this.x=a.x;this.y=a.y;this.z=a.z;this.w=a.w;return this};goog.exportProperty(box2d.b2Vec4.prototype,"Copy",box2d.b2Vec4.prototype.Copy);box2d.b2Mat22=function(){this.ex=new box2d.b2Vec2(1,0);this.ey=new box2d.b2Vec2(0,1)};goog.exportSymbol("box2d.b2Mat22",box2d.b2Mat22);box2d.b2Mat22.prototype.ex=null;goog.exportProperty(box2d.b2Mat22.prototype,"ex",box2d.b2Mat22.prototype.ex);box2d.b2Mat22.prototype.ey=null;
goog.exportProperty(box2d.b2Mat22.prototype,"ey",box2d.b2Mat22.prototype.ey);box2d.b2Mat22.IDENTITY=new box2d.b2Mat22;goog.exportProperty(box2d.b2Mat22,"IDENTITY",box2d.b2Mat22.IDENTITY);box2d.b2Mat22.prototype.Clone=function(){return(new box2d.b2Mat22).Copy(this)};goog.exportProperty(box2d.b2Mat22.prototype,"Clone",box2d.b2Mat22.prototype.Clone);box2d.b2Mat22.prototype.SetAngle=function(a){var b=Math.cos(a);a=Math.sin(a);this.ex.Set(b,a);this.ey.Set(-a,b);return this};
goog.exportProperty(box2d.b2Mat22.prototype,"SetAngle",box2d.b2Mat22.prototype.SetAngle);box2d.b2Mat22.prototype.Copy=function(a){this.ex.Copy(a.ex);this.ey.Copy(a.ey);return this};goog.exportProperty(box2d.b2Mat22.prototype,"Copy",box2d.b2Mat22.prototype.Copy);box2d.b2Mat22.prototype.SetIdentity=function(){this.ex.Set(1,0);this.ey.Set(0,1);return this};goog.exportProperty(box2d.b2Mat22.prototype,"SetIdentity",box2d.b2Mat22.prototype.SetIdentity);
box2d.b2Mat22.prototype.SetZero=function(){this.ex.SetZero();this.ey.SetZero();return this};goog.exportProperty(box2d.b2Mat22.prototype,"SetZero",box2d.b2Mat22.prototype.SetZero);box2d.b2Mat22.prototype.GetAngle=function(){return Math.atan2(this.ex.y,this.ex.x)};goog.exportProperty(box2d.b2Mat22.prototype,"GetAngle",box2d.b2Mat22.prototype.GetAngle);
box2d.b2Mat22.prototype.GetInverse=function(a){var b=this.ex.x,d=this.ey.x,e=this.ex.y,f=this.ey.y,g=b*f-d*e;0!==g&&(g=1/g);a.ex.x=g*f;a.ey.x=-g*d;a.ex.y=-g*e;a.ey.y=g*b;return a};goog.exportProperty(box2d.b2Mat22.prototype,"GetInverse",box2d.b2Mat22.prototype.GetInverse);box2d.b2Mat22.prototype.Solve=function(a,b,d){var e=this.ex.x,f=this.ey.x,g=this.ex.y,k=this.ey.y,m=e*k-f*g;0!==m&&(m=1/m);d.x=m*(k*a-f*b);d.y=m*(e*b-g*a);return d};goog.exportProperty(box2d.b2Mat22.prototype,"Solve",box2d.b2Mat22.prototype.Solve);
box2d.b2Mat22.prototype.SelfAbs=function(){this.ex.SelfAbs();this.ey.SelfAbs();return this};goog.exportProperty(box2d.b2Mat22.prototype,"SelfAbs",box2d.b2Mat22.prototype.SelfAbs);box2d.b2Mat22.prototype.SelfInv=function(){return this.GetInverse(this)};goog.exportProperty(box2d.b2Mat22.prototype,"SelfInv",box2d.b2Mat22.prototype.SelfInv);box2d.b2Mat22.prototype.SelfAdd=function(a){this.ex.SelfAdd(a.ex);this.ey.SelfAdd(a.ey);return this};goog.exportProperty(box2d.b2Mat22.prototype,"SelfAdd",box2d.b2Mat22.prototype.SelfAdd);
box2d.b2Mat22.prototype.SelfSub=function(a){this.ex.SelfSub(a.ex);this.ey.SelfSub(a.ey);return this};goog.exportProperty(box2d.b2Mat22.prototype,"SelfSub",box2d.b2Mat22.prototype.SelfSub);box2d.b2Abs_M22=function(a,b){var d=a.ex,e=a.ey;b.ex.x=box2d.b2Abs(d.x);b.ex.y=box2d.b2Abs(d.y);b.ey.x=box2d.b2Abs(e.x);b.ey.y=box2d.b2Abs(e.y);return b};goog.exportSymbol("box2d.b2Abs_M22",box2d.b2Abs_M22);box2d.b2Mul_M22_V2=function(a,b,d){var e=a.ex;a=a.ey;var f=b.x;b=b.y;d.x=e.x*f+a.x*b;d.y=e.y*f+a.y*b;return d};
goog.exportSymbol("box2d.b2Mul_M22_V2",box2d.b2Mul_M22_V2);box2d.b2MulT_M22_V2=function(a,b,d){var e=a.ex;a=a.ey;var f=b.x;b=b.y;d.x=e.x*f+e.y*b;d.y=a.x*f+a.y*b;return d};goog.exportSymbol("box2d.b2MulT_M22_V2",box2d.b2MulT_M22_V2);box2d.b2Add_M22_M22=function(a,b,d){var e=a.ex;a=a.ey;var f=b.ex;b=b.ey;d.ex.x=e.x+f.x;d.ex.y=e.y+f.y;d.ey.x=a.x+b.x;d.ey.y=a.y+b.y;return d};goog.exportSymbol("box2d.b2Add_M22_M22",box2d.b2Add_M22_M22);
box2d.b2Mul_M22_M22=function(a,b,d){var e=a.ex.x,f=a.ex.y,g=a.ey.x;a=a.ey.y;var k=b.ex.x,m=b.ex.y,n=b.ey.x;b=b.ey.y;d.ex.x=e*k+g*m;d.ex.y=f*k+a*m;d.ey.x=e*n+g*b;d.ey.y=f*n+a*b;return d};goog.exportSymbol("box2d.b2Mul_M22_M22",box2d.b2Mul_M22_M22);box2d.b2MulT_M22_M22=function(a,b,d){var e=a.ex.x,f=a.ex.y,g=a.ey.x;a=a.ey.y;var k=b.ex.x,m=b.ex.y,n=b.ey.x;b=b.ey.y;d.ex.x=e*k+f*m;d.ex.y=g*k+a*m;d.ey.x=e*n+f*b;d.ey.y=g*n+a*b;return d};goog.exportSymbol("box2d.b2MulT_M22_M22",box2d.b2MulT_M22_M22);
box2d.b2Mat33=function(){this.ex=new box2d.b2Vec3(1,0,0);this.ey=new box2d.b2Vec3(0,1,0);this.ez=new box2d.b2Vec3(0,0,1)};goog.exportSymbol("box2d.b2Mat33",box2d.b2Mat33);box2d.b2Mat33.prototype.ex=null;goog.exportProperty(box2d.b2Mat33.prototype,"ex",box2d.b2Mat33.prototype.ex);box2d.b2Mat33.prototype.ey=null;goog.exportProperty(box2d.b2Mat33.prototype,"ey",box2d.b2Mat33.prototype.ey);box2d.b2Mat33.prototype.ez=null;goog.exportProperty(box2d.b2Mat33.prototype,"ez",box2d.b2Mat33.prototype.ez);
box2d.b2Mat33.IDENTITY=new box2d.b2Mat33;goog.exportProperty(box2d.b2Mat33,"IDENTITY",box2d.b2Mat33.IDENTITY);box2d.b2Mat33.prototype.Clone=function(){return(new box2d.b2Mat33).Copy(this)};goog.exportProperty(box2d.b2Mat33.prototype,"Clone",box2d.b2Mat33.prototype.Clone);box2d.b2Mat33.prototype.Copy=function(a){this.ex.Copy(a.ex);this.ey.Copy(a.ey);this.ez.Copy(a.ez);return this};goog.exportProperty(box2d.b2Mat33.prototype,"Copy",box2d.b2Mat33.prototype.Copy);
box2d.b2Mat33.prototype.SetIdentity=function(){this.ex.Set(1,0,0);this.ey.Set(0,1,0);this.ez.Set(0,0,1);return this};goog.exportProperty(box2d.b2Mat33.prototype,"SetIdentity",box2d.b2Mat33.prototype.SetIdentity);box2d.b2Mat33.prototype.SetZero=function(){this.ex.SetZero();this.ey.SetZero();this.ez.SetZero();return this};goog.exportProperty(box2d.b2Mat33.prototype,"SetZero",box2d.b2Mat33.prototype.SetZero);
box2d.b2Mat33.prototype.SelfAdd=function(a){this.ex.SelfAdd(a.ex);this.ey.SelfAdd(a.ey);this.ez.SelfAdd(a.ez);return this};goog.exportProperty(box2d.b2Mat33.prototype,"SelfAdd",box2d.b2Mat33.prototype.SelfAdd);
box2d.b2Mat33.prototype.Solve33=function(a,b,d,e){var f=this.ex.x,g=this.ex.y,k=this.ex.z,m=this.ey.x,n=this.ey.y,q=this.ey.z,s=this.ez.x,t=this.ez.y,u=this.ez.z,v=f*(n*u-q*t)+g*(q*s-m*u)+k*(m*t-n*s);0!==v&&(v=1/v);e.x=v*(a*(n*u-q*t)+b*(q*s-m*u)+d*(m*t-n*s));e.y=v*(f*(b*u-d*t)+g*(d*s-a*u)+k*(a*t-b*s));e.z=v*(f*(n*d-q*b)+g*(q*a-m*d)+k*(m*b-n*a));return e};goog.exportProperty(box2d.b2Mat33.prototype,"Solve33",box2d.b2Mat33.prototype.Solve33);
box2d.b2Mat33.prototype.Solve22=function(a,b,d){var e=this.ex.x,f=this.ey.x,g=this.ex.y,k=this.ey.y,m=e*k-f*g;0!==m&&(m=1/m);d.x=m*(k*a-f*b);d.y=m*(e*b-g*a);return d};goog.exportProperty(box2d.b2Mat33.prototype,"Solve22",box2d.b2Mat33.prototype.Solve22);box2d.b2Mat33.prototype.GetInverse22=function(a){var b=this.ex.x,d=this.ey.x,e=this.ex.y,f=this.ey.y,g=b*f-d*e;0!==g&&(g=1/g);a.ex.x=g*f;a.ey.x=-g*d;a.ex.z=0;a.ex.y=-g*e;a.ey.y=g*b;a.ey.z=0;a.ez.x=0;a.ez.y=0;a.ez.z=0};
goog.exportProperty(box2d.b2Mat33.prototype,"GetInverse22",box2d.b2Mat33.prototype.GetInverse22);box2d.b2Mat33.prototype.GetSymInverse33=function(a){var b=box2d.b2Dot_V3_V3(this.ex,box2d.b2Cross_V3_V3(this.ey,this.ez,box2d.b2Vec3.s_t0));0!==b&&(b=1/b);var d=this.ex.x,e=this.ey.x,f=this.ez.x,g=this.ey.y,k=this.ez.y,m=this.ez.z;a.ex.x=b*(g*m-k*k);a.ex.y=b*(f*k-e*m);a.ex.z=b*(e*k-f*g);a.ey.x=a.ex.y;a.ey.y=b*(d*m-f*f);a.ey.z=b*(f*e-d*k);a.ez.x=a.ex.z;a.ez.y=a.ey.z;a.ez.z=b*(d*g-e*e)};
goog.exportProperty(box2d.b2Mat33.prototype,"GetSymInverse33",box2d.b2Mat33.prototype.GetSymInverse33);box2d.b2Mul_M33_V3=function(a,b,d){var e=b.x,f=b.y;b=b.z;d.x=a.ex.x*e+a.ey.x*f+a.ez.x*b;d.y=a.ex.y*e+a.ey.y*f+a.ez.y*b;d.z=a.ex.z*e+a.ey.z*f+a.ez.z*b;return d};goog.exportSymbol("box2d.b2Mul_M33_V3",box2d.b2Mul_M33_V3);box2d.b2Mul_M33_X_Y_Z=function(a,b,d,e,f){f.x=a.ex.x*b+a.ey.x*d+a.ez.x*e;f.y=a.ex.y*b+a.ey.y*d+a.ez.y*e;f.z=a.ex.z*b+a.ey.z*d+a.ez.z*e;return f};
goog.exportSymbol("box2d.b2Mul_M33_X_Y_Z",box2d.b2Mul_M33_X_Y_Z);box2d.b2Mul22_M33_V2=function(a,b,d){var e=b.x;b=b.y;d.x=a.ex.x*e+a.ey.x*b;d.y=a.ex.y*e+a.ey.y*b;return d};goog.exportSymbol("box2d.b2Mul22_M33_V2",box2d.b2Mul22_M33_V2);box2d.b2Mul_M33_X_Y=function(a,b,d,e){e.x=a.ex.x*b+a.ey.x*d;e.y=a.ex.y*b+a.ey.y*d;return e};goog.exportSymbol("box2d.b2Mul_M33_X_Y",box2d.b2Mul_M33_X_Y);box2d.b2Rot=function(a){a&&(this.angle=a,this.s=Math.sin(a),this.c=Math.cos(a))};
goog.exportSymbol("box2d.b2Rot",box2d.b2Rot);box2d.b2Rot.prototype.angle=0;goog.exportProperty(box2d.b2Rot.prototype,"angle",box2d.b2Rot.prototype.angle);box2d.b2Rot.prototype.s=0;goog.exportProperty(box2d.b2Rot.prototype,"s",box2d.b2Rot.prototype.s);box2d.b2Rot.prototype.c=1;goog.exportProperty(box2d.b2Rot.prototype,"c",box2d.b2Rot.prototype.c);box2d.b2Rot.IDENTITY=new box2d.b2Rot;goog.exportProperty(box2d.b2Rot,"IDENTITY",box2d.b2Rot.IDENTITY);box2d.b2Rot.prototype.Clone=function(){return(new box2d.b2Rot).Copy(this)};
goog.exportProperty(box2d.b2Rot.prototype,"Clone",box2d.b2Rot.prototype.Clone);box2d.b2Rot.prototype.Copy=function(a){this.angle=a.angle;this.s=a.s;this.c=a.c;return this};goog.exportProperty(box2d.b2Rot.prototype,"Copy",box2d.b2Rot.prototype.Copy);box2d.b2Rot.prototype.Set=function(a){Math.abs(this.angle-a)>=box2d.b2_epsilon&&(this.angle=a,this.s=Math.sin(a),this.c=Math.cos(a));return this};goog.exportProperty(box2d.b2Rot.prototype,"Set",box2d.b2Rot.prototype.Set);
box2d.b2Rot.prototype.SetAngle=box2d.b2Rot.prototype.Set;goog.exportProperty(box2d.b2Rot.prototype,"SetAngle",box2d.b2Rot.prototype.SetAngle);box2d.b2Rot.prototype.SetIdentity=function(){this.s=this.angle=0;this.c=1;return this};goog.exportProperty(box2d.b2Rot.prototype,"SetIdentity",box2d.b2Rot.prototype.SetIdentity);box2d.b2Rot.prototype.GetAngle=function(){return this.angle};goog.exportProperty(box2d.b2Rot.prototype,"GetAngle",box2d.b2Rot.prototype.GetAngle);
box2d.b2Rot.prototype.GetXAxis=function(a){a.x=this.c;a.y=this.s;return a};goog.exportProperty(box2d.b2Rot.prototype,"GetXAxis",box2d.b2Rot.prototype.GetXAxis);box2d.b2Rot.prototype.GetYAxis=function(a){a.x=-this.s;a.y=this.c;return a};goog.exportProperty(box2d.b2Rot.prototype,"GetYAxis",box2d.b2Rot.prototype.GetYAxis);box2d.b2Mul_R_R=function(a,b,d){var e=a.c,f=a.s,g=b.c,k=b.s;d.s=f*g+e*k;d.c=e*g-f*k;d.angle=box2d.b2WrapAngle(a.angle+b.angle);return d};goog.exportSymbol("box2d.b2Mul_R_R",box2d.b2Mul_R_R);
box2d.b2MulT_R_R=function(a,b,d){var e=a.c,f=a.s,g=b.c,k=b.s;d.s=e*k-f*g;d.c=e*g+f*k;d.angle=box2d.b2WrapAngle(a.angle-b.angle);return d};goog.exportSymbol("box2d.b2MulT_R_R",box2d.b2MulT_R_R);box2d.b2Mul_R_V2=function(a,b,d){var e=a.c;a=a.s;var f=b.x;b=b.y;d.x=e*f-a*b;d.y=a*f+e*b;return d};goog.exportSymbol("box2d.b2Mul_R_V2",box2d.b2Mul_R_V2);box2d.b2MulT_R_V2=function(a,b,d){var e=a.c;a=a.s;var f=b.x;b=b.y;d.x=e*f+a*b;d.y=-a*f+e*b;return d};goog.exportSymbol("box2d.b2MulT_R_V2",box2d.b2MulT_R_V2);
box2d.b2Transform=function(){this.p=new box2d.b2Vec2;this.q=new box2d.b2Rot};goog.exportSymbol("box2d.b2Transform",box2d.b2Transform);box2d.b2Transform.prototype.p=null;goog.exportProperty(box2d.b2Transform.prototype,"p",box2d.b2Transform.prototype.p);box2d.b2Transform.prototype.q=null;goog.exportProperty(box2d.b2Transform.prototype,"q",box2d.b2Transform.prototype.q);box2d.b2Transform.IDENTITY=new box2d.b2Transform;goog.exportProperty(box2d.b2Transform,"IDENTITY",box2d.b2Transform.IDENTITY);
box2d.b2Transform.prototype.Clone=function(){return(new box2d.b2Transform).Copy(this)};goog.exportProperty(box2d.b2Transform.prototype,"Clone",box2d.b2Transform.prototype.Clone);box2d.b2Transform.prototype.Copy=function(a){this.p.Copy(a.p);this.q.Copy(a.q);return this};goog.exportProperty(box2d.b2Transform.prototype,"Copy",box2d.b2Transform.prototype.Copy);box2d.b2Transform.prototype.SetIdentity=function(){this.p.SetZero();this.q.SetIdentity();return this};
goog.exportProperty(box2d.b2Transform.prototype,"SetIdentity",box2d.b2Transform.prototype.SetIdentity);box2d.b2Transform.prototype.Set=function(a,b){return this.SetPositionRotationAngle(a,b)};box2d.b2Transform.prototype.SetPositionRotation=function(a,b){this.p.Copy(a);this.q.Copy(b);return this};goog.exportProperty(box2d.b2Transform.prototype,"SetPositionRotation",box2d.b2Transform.prototype.SetPositionRotation);
box2d.b2Transform.prototype.SetPositionRotationAngle=function(a,b){this.p.Copy(a);this.q.SetAngle(b);return this};goog.exportProperty(box2d.b2Transform.prototype,"SetPositionRotationAngle",box2d.b2Transform.prototype.SetPositionRotationAngle);box2d.b2Transform.prototype.SetPosition=function(a){this.p.Copy(a);return this};goog.exportProperty(box2d.b2Transform.prototype,"SetPosition",box2d.b2Transform.prototype.SetPosition);box2d.b2Transform.prototype.SetPositionXY=function(a,b){this.p.Set(a,b);return this};
goog.exportProperty(box2d.b2Transform.prototype,"SetPositionXY",box2d.b2Transform.prototype.SetPositionXY);box2d.b2Transform.prototype.SetRotation=function(a){this.q.Copy(a);return this};goog.exportProperty(box2d.b2Transform.prototype,"SetRotation",box2d.b2Transform.prototype.SetRotation);box2d.b2Transform.prototype.SetRotationAngle=function(a){this.q.SetAngle(a);return this};goog.exportProperty(box2d.b2Transform.prototype,"SetRotationAngle",box2d.b2Transform.prototype.SetRotationAngle);
box2d.b2Transform.prototype.GetPosition=function(){return this.p};goog.exportProperty(box2d.b2Transform.prototype,"GetPosition",box2d.b2Transform.prototype.GetPosition);box2d.b2Transform.prototype.GetRotation=function(){return this.q};goog.exportProperty(box2d.b2Transform.prototype,"GetRotation",box2d.b2Transform.prototype.GetRotation);box2d.b2Transform.prototype.GetRotationAngle=function(){return this.q.GetAngle()};goog.exportProperty(box2d.b2Transform.prototype,"GetRotationAngle",box2d.b2Transform.prototype.GetRotationAngle);
box2d.b2Transform.prototype.GetAngle=function(){return this.q.GetAngle()};goog.exportProperty(box2d.b2Transform.prototype,"GetAngle",box2d.b2Transform.prototype.GetAngle);box2d.b2Mul_X_V2=function(a,b,d){var e=a.q.c,f=a.q.s,g=b.x;b=b.y;d.x=e*g-f*b+a.p.x;d.y=f*g+e*b+a.p.y;return d};goog.exportSymbol("box2d.b2Mul_X_V2",box2d.b2Mul_X_V2);box2d.b2MulT_X_V2=function(a,b,d){var e=a.q.c,f=a.q.s,g=b.x-a.p.x;a=b.y-a.p.y;d.x=e*g+f*a;d.y=-f*g+e*a;return d};goog.exportSymbol("box2d.b2MulT_X_V2",box2d.b2MulT_X_V2);
box2d.b2Mul_X_X=function(a,b,d){box2d.b2Mul_R_R(a.q,b.q,d.q);box2d.b2Add_V2_V2(box2d.b2Mul_R_V2(a.q,b.p,d.p),a.p,d.p);return d};goog.exportSymbol("box2d.b2Mul_X_X",box2d.b2Mul_X_X);box2d.b2MulT_X_X=function(a,b,d){box2d.b2MulT_R_R(a.q,b.q,d.q);box2d.b2MulT_R_V2(a.q,box2d.b2Sub_V2_V2(b.p,a.p,d.p),d.p);return d};goog.exportSymbol("box2d.b2MulT_X_X",box2d.b2MulT_X_X);box2d.b2Sweep=function(){this.localCenter=new box2d.b2Vec2;this.c0=new box2d.b2Vec2;this.c=new box2d.b2Vec2};
goog.exportSymbol("box2d.b2Sweep",box2d.b2Sweep);box2d.b2Sweep.prototype.localCenter=null;goog.exportProperty(box2d.b2Sweep.prototype,"localCenter",box2d.b2Sweep.prototype.localCenter);box2d.b2Sweep.prototype.c0=null;goog.exportProperty(box2d.b2Sweep.prototype,"c0",box2d.b2Sweep.prototype.c0);box2d.b2Sweep.prototype.c=null;goog.exportProperty(box2d.b2Sweep.prototype,"c",box2d.b2Sweep.prototype.c);box2d.b2Sweep.prototype.a0=0;goog.exportProperty(box2d.b2Sweep.prototype,"a0",box2d.b2Sweep.prototype.a0);
box2d.b2Sweep.prototype.a=0;goog.exportProperty(box2d.b2Sweep.prototype,"a",box2d.b2Sweep.prototype.a);box2d.b2Sweep.prototype.alpha0=0;goog.exportProperty(box2d.b2Sweep.prototype,"alpha0",box2d.b2Sweep.prototype.alpha0);box2d.b2Sweep.prototype.Clone=function(){return(new box2d.b2Sweep).Copy(this)};goog.exportProperty(box2d.b2Sweep.prototype,"Clone",box2d.b2Sweep.prototype.Clone);
box2d.b2Sweep.prototype.Copy=function(a){this.localCenter.Copy(a.localCenter);this.c0.Copy(a.c0);this.c.Copy(a.c);this.a0=a.a0;this.a=a.a;this.alpha0=a.alpha0;return this};goog.exportProperty(box2d.b2Sweep.prototype,"Copy",box2d.b2Sweep.prototype.Copy);box2d.b2Sweep.prototype.GetTransform=function(a,b){var d=1-b;a.p.x=d*this.c0.x+b*this.c.x;a.p.y=d*this.c0.y+b*this.c.y;a.q.SetAngle(d*this.a0+b*this.a);a.p.SelfSub(box2d.b2Mul_R_V2(a.q,this.localCenter,box2d.b2Vec2.s_t0));return a};
goog.exportProperty(box2d.b2Sweep.prototype,"GetTransform",box2d.b2Sweep.prototype.GetTransform);box2d.b2Sweep.prototype.Advance=function(a){box2d.ENABLE_ASSERTS&&box2d.b2Assert(1>this.alpha0);var b=(a-this.alpha0)/(1-this.alpha0);this.c0.x+=b*(this.c.x-this.c0.x);this.c0.y+=b*(this.c.y-this.c0.y);this.a0+=b*(this.a-this.a0);this.alpha0=a};goog.exportProperty(box2d.b2Sweep.prototype,"Advance",box2d.b2Sweep.prototype.Advance);
box2d.b2Sweep.prototype.Normalize=function(){this.a0=box2d.b2WrapAngle(this.a0);this.a=box2d.b2WrapAngle(this.a)};goog.exportProperty(box2d.b2Sweep.prototype,"Normalize",box2d.b2Sweep.prototype.Normalize);box2d.b2Dot=function(a,b){if(a instanceof box2d.b2Vec2&&b instanceof box2d.b2Vec2)return box2d.b2Dot_V2_V2(a,b);if(a instanceof box2d.b2Vec3&&b instanceof box2d.b2Vec3)return box2d.b2Dot_V3_V3(a,b);throw Error();};goog.exportSymbol("box2d.b2Dot",box2d.b2Dot);
box2d.b2Cross=function(a,b,d){if(a instanceof box2d.b2Vec2&&b instanceof box2d.b2Vec2)return box2d.b2Cross_V2_V2(a,b);if(a instanceof box2d.b2Vec2&&"number"===typeof b&&d instanceof box2d.b2Vec2)return box2d.b2Cross_V2_S(a,b,d);if("number"===typeof a&&b instanceof box2d.b2Vec2&&d instanceof box2d.b2Vec2)return box2d.b2Cross_S_V2(a,b,d);if(a instanceof box2d.b2Vec3&&b instanceof box2d.b2Vec3&&d instanceof box2d.b2Vec3)return box2d.b2Cross_V3_V3(a,b,d);throw Error();};
goog.exportSymbol("box2d.b2Cross",box2d.b2Cross);box2d.b2Add=function(a,b,d){if(a instanceof box2d.b2Vec2&&b instanceof box2d.b2Vec2&&d instanceof box2d.b2Vec2)return box2d.b2Add_V2_V2(a,b,d);if(a instanceof box2d.b2Vec3&&b instanceof box2d.b2Vec3&&d instanceof box2d.b2Vec3)return box2d.b2Add_V3_V3(a,b,d);throw Error();};goog.exportSymbol("box2d.b2Add",box2d.b2Add);
box2d.b2Sub=function(a,b,d){if(a instanceof box2d.b2Vec2&&b instanceof box2d.b2Vec2&&d instanceof box2d.b2Vec2)return box2d.b2Sub_V2_V2(a,b,d);if(a instanceof box2d.b2Vec3&&b instanceof box2d.b2Vec3&&d instanceof box2d.b2Vec3)return box2d.b2Sub_V3_V3(a,b,d);throw Error();};goog.exportSymbol("box2d.b2Sub",box2d.b2Sub);
box2d.b2Mul=function(a,b,d){if(a instanceof box2d.b2Mat22&&b instanceof box2d.b2Vec2&&d instanceof box2d.b2Vec2)return box2d.b2Mul_M22_V2(a,b,d);if(a instanceof box2d.b2Mat22&&b instanceof box2d.b2Mat22&&d instanceof box2d.b2Mat22)return box2d.b2Mul_M22_M22(a,b,d);if(a instanceof box2d.b2Mat33&&b instanceof box2d.b2Vec3&&d instanceof box2d.b2Vec3)return box2d.b2Mul_M33_V3(a,b,d);if(a instanceof box2d.b2Rot&&b instanceof box2d.b2Rot&&d instanceof box2d.b2Rot)return box2d.b2Mul_R_R(a,b,d);if(a instanceof
box2d.b2Rot&&b instanceof box2d.b2Vec2&&d instanceof box2d.b2Vec2)return box2d.b2Mul_R_V2(a,b,d);if(a instanceof box2d.b2Transform&&b instanceof box2d.b2Vec2&&d instanceof box2d.b2Vec2)return box2d.b2Mul_X_V2(a,b,d);if(a instanceof box2d.b2Transform&&b instanceof box2d.b2Transform&&d instanceof box2d.b2Transform)return box2d.b2Mul_X_X(a,b,d);throw Error();};goog.exportSymbol("box2d.b2Mul",box2d.b2Mul);
box2d.b2Mul22=function(a,b,d){if(a instanceof box2d.b2Mat33&&b instanceof box2d.b2Vec2)return box2d.b2Mul22_M33_V2(a,b,d);throw Error();};goog.exportSymbol("box2d.b2Mul22",box2d.b2Mul22);
box2d.b2MulT=function(a,b,d){if(a instanceof box2d.b2Mat22&&b instanceof box2d.b2Vec2&&d instanceof box2d.b2Vec2)return box2d.b2MulT_M22_V2(a,b,d);if(a instanceof box2d.b2Mat22&&b instanceof box2d.b2Mat22&&d instanceof box2d.b2Mat22)return box2d.b2MulT_M22_M22(a,b,d);if(a instanceof box2d.b2Rot&&b instanceof box2d.b2Rot&&d instanceof box2d.b2Rot)return box2d.b2MulT_R_R(a,b,d);if(a instanceof box2d.b2Rot&&b instanceof box2d.b2Vec2&&d instanceof box2d.b2Vec2)return box2d.b2MulT_R_V2(a,b,d);if(a instanceof
box2d.b2Transform&&b instanceof box2d.b2Vec2&&d instanceof box2d.b2Vec2)return box2d.b2MulT_X_V2(a,b,d);if(a instanceof box2d.b2Transform&&b instanceof box2d.b2Transform&&d instanceof box2d.b2Transform)return box2d.b2MulT_X_X(a,b,d);throw Error();};goog.exportSymbol("box2d.b2MulT",box2d.b2MulT);box2d.b2DistanceProxy=function(){this.m_buffer=box2d.b2Vec2.MakeArray(2)};goog.exportSymbol("box2d.b2DistanceProxy",box2d.b2DistanceProxy);box2d.b2DistanceProxy.prototype.m_buffer=null;
goog.exportProperty(box2d.b2DistanceProxy.prototype,"m_buffer",box2d.b2DistanceProxy.prototype.m_buffer);box2d.b2DistanceProxy.prototype.m_vertices=null;goog.exportProperty(box2d.b2DistanceProxy.prototype,"m_vertices",box2d.b2DistanceProxy.prototype.m_vertices);box2d.b2DistanceProxy.prototype.m_count=0;goog.exportProperty(box2d.b2DistanceProxy.prototype,"m_count",box2d.b2DistanceProxy.prototype.m_count);box2d.b2DistanceProxy.prototype.m_radius=0;
goog.exportProperty(box2d.b2DistanceProxy.prototype,"m_radius",box2d.b2DistanceProxy.prototype.m_radius);box2d.b2DistanceProxy.prototype.Reset=function(){this.m_vertices=null;this.m_radius=this.m_count=0;return this};goog.exportProperty(box2d.b2DistanceProxy.prototype,"Reset",box2d.b2DistanceProxy.prototype.Reset);box2d.b2DistanceProxy.prototype.SetShape=function(a,b){a.SetupDistanceProxy(this,b)};goog.exportProperty(box2d.b2DistanceProxy.prototype,"SetShape",box2d.b2DistanceProxy.prototype.SetShape);
box2d.b2DistanceProxy.prototype.GetSupport=function(a){for(var b=0,d=box2d.b2Dot_V2_V2(this.m_vertices[0],a),e=1;e<this.m_count;++e){var f=box2d.b2Dot_V2_V2(this.m_vertices[e],a);f>d&&(b=e,d=f)}return b};goog.exportProperty(box2d.b2DistanceProxy.prototype,"GetSupport",box2d.b2DistanceProxy.prototype.GetSupport);
box2d.b2DistanceProxy.prototype.GetSupportVertex=function(a,b){for(var d=0,e=box2d.b2Dot_V2_V2(this.m_vertices[0],a),f=1;f<this.m_count;++f){var g=box2d.b2Dot_V2_V2(this.m_vertices[f],a);g>e&&(d=f,e=g)}return b.Copy(this.m_vertices[d])};goog.exportProperty(box2d.b2DistanceProxy.prototype,"GetSupportVertex",box2d.b2DistanceProxy.prototype.GetSupportVertex);box2d.b2DistanceProxy.prototype.GetVertexCount=function(){return this.m_count};
goog.exportProperty(box2d.b2DistanceProxy.prototype,"GetVertexCount",box2d.b2DistanceProxy.prototype.GetVertexCount);box2d.b2DistanceProxy.prototype.GetVertex=function(a){box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<=a&&a<this.m_count);return this.m_vertices[a]};goog.exportProperty(box2d.b2DistanceProxy.prototype,"GetVertex",box2d.b2DistanceProxy.prototype.GetVertex);box2d.b2SimplexCache=function(){this.indexA=box2d.b2MakeNumberArray(3);this.indexB=box2d.b2MakeNumberArray(3)};
goog.exportSymbol("box2d.b2SimplexCache",box2d.b2SimplexCache);box2d.b2SimplexCache.prototype.metric=0;goog.exportProperty(box2d.b2SimplexCache.prototype,"metric",box2d.b2SimplexCache.prototype.metric);box2d.b2SimplexCache.prototype.count=0;goog.exportProperty(box2d.b2SimplexCache.prototype,"count",box2d.b2SimplexCache.prototype.count);box2d.b2SimplexCache.prototype.indexA=null;goog.exportProperty(box2d.b2SimplexCache.prototype,"indexA",box2d.b2SimplexCache.prototype.indexA);
box2d.b2SimplexCache.prototype.indexB=null;goog.exportProperty(box2d.b2SimplexCache.prototype,"indexB",box2d.b2SimplexCache.prototype.indexB);box2d.b2SimplexCache.prototype.Reset=function(){this.count=this.metric=0;return this};goog.exportProperty(box2d.b2SimplexCache.prototype,"Reset",box2d.b2SimplexCache.prototype.Reset);box2d.b2DistanceInput=function(){this.proxyA=new box2d.b2DistanceProxy;this.proxyB=new box2d.b2DistanceProxy;this.transformA=new box2d.b2Transform;this.transformB=new box2d.b2Transform};
goog.exportSymbol("box2d.b2DistanceInput",box2d.b2DistanceInput);box2d.b2DistanceInput.prototype.proxyA=null;goog.exportProperty(box2d.b2DistanceInput.prototype,"proxyA",box2d.b2DistanceInput.prototype.proxyA);box2d.b2DistanceInput.prototype.proxyB=null;goog.exportProperty(box2d.b2DistanceInput.prototype,"proxyB",box2d.b2DistanceInput.prototype.proxyB);box2d.b2DistanceInput.prototype.transformA=null;goog.exportProperty(box2d.b2DistanceInput.prototype,"transformA",box2d.b2DistanceInput.prototype.transformA);
box2d.b2DistanceInput.prototype.transformB=null;goog.exportProperty(box2d.b2DistanceInput.prototype,"transformB",box2d.b2DistanceInput.prototype.transformB);box2d.b2DistanceInput.prototype.useRadii=!1;goog.exportProperty(box2d.b2DistanceInput.prototype,"useRadii",box2d.b2DistanceInput.prototype.useRadii);box2d.b2DistanceInput.prototype.Reset=function(){this.proxyA.Reset();this.proxyB.Reset();this.transformA.SetIdentity();this.transformB.SetIdentity();this.useRadii=!1;return this};
goog.exportProperty(box2d.b2DistanceInput.prototype,"Reset",box2d.b2DistanceInput.prototype.Reset);box2d.b2DistanceOutput=function(){this.pointA=new box2d.b2Vec2;this.pointB=new box2d.b2Vec2};goog.exportSymbol("box2d.b2DistanceOutput",box2d.b2DistanceOutput);box2d.b2DistanceOutput.prototype.pointA=null;goog.exportProperty(box2d.b2DistanceOutput.prototype,"pointA",box2d.b2DistanceOutput.prototype.pointA);box2d.b2DistanceOutput.prototype.pointB=null;
goog.exportProperty(box2d.b2DistanceOutput.prototype,"pointB",box2d.b2DistanceOutput.prototype.pointB);box2d.b2DistanceOutput.prototype.distance=0;goog.exportProperty(box2d.b2DistanceOutput.prototype,"distance",box2d.b2DistanceOutput.prototype.distance);box2d.b2DistanceOutput.prototype.iterations=0;goog.exportProperty(box2d.b2DistanceOutput.prototype,"iterations",box2d.b2DistanceOutput.prototype.iterations);
box2d.b2DistanceOutput.prototype.Reset=function(){this.pointA.SetZero();this.pointB.SetZero();this.iterations=this.distance=0;return this};goog.exportProperty(box2d.b2DistanceOutput.prototype,"Reset",box2d.b2DistanceOutput.prototype.Reset);box2d.b2_gjkCalls=0;goog.exportSymbol("box2d.b2_gjkCalls",box2d.b2_gjkCalls);box2d.b2_gjkIters=0;goog.exportSymbol("box2d.b2_gjkIters",box2d.b2_gjkIters);box2d.b2_gjkMaxIters=0;goog.exportSymbol("box2d.b2_gjkMaxIters",box2d.b2_gjkMaxIters);
box2d.b2SimplexVertex=function(){this.wA=new box2d.b2Vec2;this.wB=new box2d.b2Vec2;this.w=new box2d.b2Vec2};goog.exportSymbol("box2d.b2SimplexVertex",box2d.b2SimplexVertex);box2d.b2SimplexVertex.prototype.wA=null;goog.exportProperty(box2d.b2SimplexVertex.prototype,"wA",box2d.b2SimplexVertex.prototype.wA);box2d.b2SimplexVertex.prototype.wB=null;goog.exportProperty(box2d.b2SimplexVertex.prototype,"wB",box2d.b2SimplexVertex.prototype.wB);box2d.b2SimplexVertex.prototype.w=null;
goog.exportProperty(box2d.b2SimplexVertex.prototype,"w",box2d.b2SimplexVertex.prototype.w);box2d.b2SimplexVertex.prototype.a=0;goog.exportProperty(box2d.b2SimplexVertex.prototype,"a",box2d.b2SimplexVertex.prototype.a);box2d.b2SimplexVertex.prototype.indexA=0;goog.exportProperty(box2d.b2SimplexVertex.prototype,"indexA",box2d.b2SimplexVertex.prototype.indexA);box2d.b2SimplexVertex.prototype.indexB=0;goog.exportProperty(box2d.b2SimplexVertex.prototype,"indexB",box2d.b2SimplexVertex.prototype.indexB);
box2d.b2SimplexVertex.prototype.Copy=function(a){this.wA.Copy(a.wA);this.wB.Copy(a.wB);this.w.Copy(a.w);this.a=a.a;this.indexA=a.indexA;this.indexB=a.indexB;return this};goog.exportProperty(box2d.b2SimplexVertex.prototype,"Copy",box2d.b2SimplexVertex.prototype.Copy);
box2d.b2Simplex=function(){this.m_v1=new box2d.b2SimplexVertex;this.m_v2=new box2d.b2SimplexVertex;this.m_v3=new box2d.b2SimplexVertex;this.m_vertices=Array(3);this.m_vertices[0]=this.m_v1;this.m_vertices[1]=this.m_v2;this.m_vertices[2]=this.m_v3};goog.exportSymbol("box2d.b2Simplex",box2d.b2Simplex);box2d.b2Simplex.prototype.m_v1=null;goog.exportProperty(box2d.b2Simplex.prototype,"m_v1",box2d.b2Simplex.prototype.m_v1);box2d.b2Simplex.prototype.m_v2=null;
goog.exportProperty(box2d.b2Simplex.prototype,"m_v2",box2d.b2Simplex.prototype.m_v2);box2d.b2Simplex.prototype.m_v3=null;goog.exportProperty(box2d.b2Simplex.prototype,"m_v3",box2d.b2Simplex.prototype.m_v3);box2d.b2Simplex.prototype.m_vertices=null;goog.exportProperty(box2d.b2Simplex.prototype,"m_vertices",box2d.b2Simplex.prototype.m_vertices);box2d.b2Simplex.prototype.m_count=0;goog.exportProperty(box2d.b2Simplex.prototype,"m_count",box2d.b2Simplex.prototype.m_count);
box2d.b2Simplex.prototype.ReadCache=function(a,b,d,e,f){box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<=a.count&&3>=a.count);this.m_count=a.count;for(var g=this.m_vertices,k=0;k<this.m_count;++k){var m=g[k];m.indexA=a.indexA[k];m.indexB=a.indexB[k];var n=b.GetVertex(m.indexA),q=e.GetVertex(m.indexB);box2d.b2Mul_X_V2(d,n,m.wA);box2d.b2Mul_X_V2(f,q,m.wB);box2d.b2Sub_V2_V2(m.wB,m.wA,m.w);m.a=0}1<this.m_count&&(a=a.metric,k=this.GetMetric(),k<.5*a||2*a<k||k<box2d.b2_epsilon)&&(this.m_count=0);0===this.m_count&&
(m=g[0],m.indexA=0,m.indexB=0,n=b.GetVertex(0),q=e.GetVertex(0),box2d.b2Mul_X_V2(d,n,m.wA),box2d.b2Mul_X_V2(f,q,m.wB),box2d.b2Sub_V2_V2(m.wB,m.wA,m.w),this.m_count=m.a=1)};goog.exportProperty(box2d.b2Simplex.prototype,"ReadCache",box2d.b2Simplex.prototype.ReadCache);box2d.b2Simplex.prototype.WriteCache=function(a){a.metric=this.GetMetric();a.count=this.m_count;for(var b=this.m_vertices,d=0;d<this.m_count;++d)a.indexA[d]=b[d].indexA,a.indexB[d]=b[d].indexB};
goog.exportProperty(box2d.b2Simplex.prototype,"WriteCache",box2d.b2Simplex.prototype.WriteCache);box2d.b2Simplex.prototype.GetSearchDirection=function(a){switch(this.m_count){case 1:return a.Copy(this.m_v1.w).SelfNeg();case 2:var b=box2d.b2Sub_V2_V2(this.m_v2.w,this.m_v1.w,a);return 0<box2d.b2Cross_V2_V2(b,box2d.b2Vec2.s_t0.Copy(this.m_v1.w).SelfNeg())?box2d.b2Cross_S_V2(1,b,a):box2d.b2Cross_V2_S(b,1,a);default:return box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1),a.SetZero()}};
goog.exportProperty(box2d.b2Simplex.prototype,"GetSearchDirection",box2d.b2Simplex.prototype.GetSearchDirection);box2d.b2Simplex.prototype.GetClosestPoint=function(a){switch(this.m_count){case 0:return box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1),a.SetZero();case 1:return a.Copy(this.m_v1.w);case 2:return a.Set(this.m_v1.a*this.m_v1.w.x+this.m_v2.a*this.m_v2.w.x,this.m_v1.a*this.m_v1.w.y+this.m_v2.a*this.m_v2.w.y);case 3:return a.SetZero();default:return box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1),a.SetZero()}};
goog.exportProperty(box2d.b2Simplex.prototype,"GetClosestPoint",box2d.b2Simplex.prototype.GetClosestPoint);
box2d.b2Simplex.prototype.GetWitnessPoints=function(a,b){switch(this.m_count){case 0:box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1);break;case 1:a.Copy(this.m_v1.wA);b.Copy(this.m_v1.wB);break;case 2:a.x=this.m_v1.a*this.m_v1.wA.x+this.m_v2.a*this.m_v2.wA.x;a.y=this.m_v1.a*this.m_v1.wA.y+this.m_v2.a*this.m_v2.wA.y;b.x=this.m_v1.a*this.m_v1.wB.x+this.m_v2.a*this.m_v2.wB.x;b.y=this.m_v1.a*this.m_v1.wB.y+this.m_v2.a*this.m_v2.wB.y;break;case 3:b.x=a.x=this.m_v1.a*this.m_v1.wA.x+this.m_v2.a*this.m_v2.wA.x+
this.m_v3.a*this.m_v3.wA.x;b.y=a.y=this.m_v1.a*this.m_v1.wA.y+this.m_v2.a*this.m_v2.wA.y+this.m_v3.a*this.m_v3.wA.y;break;default:box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1)}};goog.exportProperty(box2d.b2Simplex.prototype,"GetWitnessPoints",box2d.b2Simplex.prototype.GetWitnessPoints);
box2d.b2Simplex.prototype.GetMetric=function(){switch(this.m_count){case 0:return box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1),0;case 1:return 0;case 2:return box2d.b2Distance(this.m_v1.w,this.m_v2.w);case 3:return box2d.b2Cross_V2_V2(box2d.b2Sub_V2_V2(this.m_v2.w,this.m_v1.w,box2d.b2Vec2.s_t0),box2d.b2Sub_V2_V2(this.m_v3.w,this.m_v1.w,box2d.b2Vec2.s_t1));default:return box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1),0}};goog.exportProperty(box2d.b2Simplex.prototype,"GetMetric",box2d.b2Simplex.prototype.GetMetric);
box2d.b2Simplex.prototype.Solve2=function(){var a=this.m_v1.w,b=this.m_v2.w,d=box2d.b2Sub_V2_V2(b,a,box2d.b2Simplex.s_e12),a=-box2d.b2Dot_V2_V2(a,d);0>=a?this.m_count=this.m_v1.a=1:(b=box2d.b2Dot_V2_V2(b,d),0>=b?(this.m_count=this.m_v2.a=1,this.m_v1.Copy(this.m_v2)):(d=1/(b+a),this.m_v1.a=b*d,this.m_v2.a=a*d,this.m_count=2))};goog.exportProperty(box2d.b2Simplex.prototype,"Solve2",box2d.b2Simplex.prototype.Solve2);
box2d.b2Simplex.prototype.Solve3=function(){var a=this.m_v1.w,b=this.m_v2.w,d=this.m_v3.w,e=box2d.b2Sub_V2_V2(b,a,box2d.b2Simplex.s_e12),f=box2d.b2Dot_V2_V2(a,e),g=box2d.b2Dot_V2_V2(b,e),f=-f,k=box2d.b2Sub_V2_V2(d,a,box2d.b2Simplex.s_e13),m=box2d.b2Dot_V2_V2(a,k),n=box2d.b2Dot_V2_V2(d,k),m=-m,q=box2d.b2Sub_V2_V2(d,b,box2d.b2Simplex.s_e23),s=box2d.b2Dot_V2_V2(b,q),q=box2d.b2Dot_V2_V2(d,q),s=-s,k=box2d.b2Cross_V2_V2(e,k),e=k*box2d.b2Cross_V2_V2(b,d),d=k*box2d.b2Cross_V2_V2(d,a),a=k*box2d.b2Cross_V2_V2(a,
b);0>=f&&0>=m?this.m_count=this.m_v1.a=1:0<g&&0<f&&0>=a?(n=1/(g+f),this.m_v1.a=g*n,this.m_v2.a=f*n,this.m_count=2):0<n&&0<m&&0>=d?(g=1/(n+m),this.m_v1.a=n*g,this.m_v3.a=m*g,this.m_count=2,this.m_v2.Copy(this.m_v3)):0>=g&&0>=s?(this.m_count=this.m_v2.a=1,this.m_v1.Copy(this.m_v2)):0>=n&&0>=q?(this.m_count=this.m_v3.a=1,this.m_v1.Copy(this.m_v3)):0<q&&0<s&&0>=e?(g=1/(q+s),this.m_v2.a=q*g,this.m_v3.a=s*g,this.m_count=2,this.m_v1.Copy(this.m_v3)):(g=1/(e+d+a),this.m_v1.a=e*g,this.m_v2.a=d*g,this.m_v3.a=
a*g,this.m_count=3)};goog.exportProperty(box2d.b2Simplex.prototype,"Solve3",box2d.b2Simplex.prototype.Solve3);box2d.b2Simplex.s_e12=new box2d.b2Vec2;box2d.b2Simplex.s_e13=new box2d.b2Vec2;box2d.b2Simplex.s_e23=new box2d.b2Vec2;
box2d.b2ShapeDistance=function(a,b,d){++box2d.b2_gjkCalls;var e=d.proxyA,f=d.proxyB,g=d.transformA,k=d.transformB,m=box2d.b2Distance.s_simplex;m.ReadCache(b,e,g,f,k);for(var n=m.m_vertices,q=box2d.b2Distance.s_saveA,s=box2d.b2Distance.s_saveB,t=0,u=0;20>u;){for(var t=m.m_count,v=0;v<t;++v)q[v]=n[v].indexA,s[v]=n[v].indexB;switch(m.m_count){case 1:break;case 2:m.Solve2();break;case 3:m.Solve3();break;default:box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1)}if(3===m.m_count)break;var y=m.GetClosestPoint(box2d.b2Distance.s_p);
y.LengthSquared();v=m.GetSearchDirection(box2d.b2Distance.s_d);if(v.LengthSquared()<box2d.b2_epsilon_sq)break;y=n[m.m_count];y.indexA=e.GetSupport(box2d.b2MulT_R_V2(g.q,box2d.b2Vec2.s_t0.Copy(v).SelfNeg(),box2d.b2Distance.s_supportA));box2d.b2Mul_X_V2(g,e.GetVertex(y.indexA),y.wA);y.indexB=f.GetSupport(box2d.b2MulT_R_V2(k.q,v,box2d.b2Distance.s_supportB));box2d.b2Mul_X_V2(k,f.GetVertex(y.indexB),y.wB);box2d.b2Sub_V2_V2(y.wB,y.wA,y.w);++u;++box2d.b2_gjkIters;for(var z=!1,v=0;v<t;++v)if(y.indexA===
q[v]&&y.indexB===s[v]){z=!0;break}if(z)break;++m.m_count}box2d.b2_gjkMaxIters=box2d.b2Max(box2d.b2_gjkMaxIters,u);m.GetWitnessPoints(a.pointA,a.pointB);a.distance=box2d.b2Distance(a.pointA,a.pointB);a.iterations=u;m.WriteCache(b);d.useRadii&&(b=e.m_radius,f=f.m_radius,a.distance>b+f&&a.distance>box2d.b2_epsilon?(a.distance-=b+f,d=box2d.b2Sub_V2_V2(a.pointB,a.pointA,box2d.b2Distance.s_normal),d.Normalize(),a.pointA.SelfMulAdd(b,d),a.pointB.SelfMulSub(f,d)):(y=box2d.b2Mid_V2_V2(a.pointA,a.pointB,box2d.b2Distance.s_p),
a.pointA.Copy(y),a.pointB.Copy(y),a.distance=0))};goog.exportSymbol("box2d.b2ShapeDistance",box2d.b2ShapeDistance);box2d.b2Distance.s_simplex=new box2d.b2Simplex;box2d.b2Distance.s_saveA=box2d.b2MakeNumberArray(3);box2d.b2Distance.s_saveB=box2d.b2MakeNumberArray(3);box2d.b2Distance.s_p=new box2d.b2Vec2;box2d.b2Distance.s_d=new box2d.b2Vec2;box2d.b2Distance.s_normal=new box2d.b2Vec2;box2d.b2Distance.s_supportA=new box2d.b2Vec2;box2d.b2Distance.s_supportB=new box2d.b2Vec2;box2d.b2Collision={};
box2d.b2ContactFeatureType={e_vertex:0,e_face:1};goog.exportSymbol("box2d.b2ContactFeatureType",box2d.b2ContactFeatureType);goog.exportProperty(box2d.b2ContactFeatureType,"e_vertex",box2d.b2ContactFeatureType.e_vertex);goog.exportProperty(box2d.b2ContactFeatureType,"e_face",box2d.b2ContactFeatureType.e_face);box2d.b2ContactFeature=function(){};goog.exportSymbol("box2d.b2ContactFeature",box2d.b2ContactFeature);box2d.b2ContactFeature.prototype._key=0;
goog.exportProperty(box2d.b2ContactFeature.prototype,"_key",box2d.b2ContactFeature.prototype._key);box2d.b2ContactFeature.prototype._key_invalid=!1;goog.exportProperty(box2d.b2ContactFeature.prototype,"_key_invalid",box2d.b2ContactFeature.prototype._key_invalid);box2d.b2ContactFeature.prototype._indexA=0;goog.exportProperty(box2d.b2ContactFeature.prototype,"_indexA",box2d.b2ContactFeature.prototype._indexA);box2d.b2ContactFeature.prototype._indexB=0;
goog.exportProperty(box2d.b2ContactFeature.prototype,"_indexB",box2d.b2ContactFeature.prototype._indexB);box2d.b2ContactFeature.prototype._typeA=0;goog.exportProperty(box2d.b2ContactFeature.prototype,"_typeA",box2d.b2ContactFeature.prototype._typeA);box2d.b2ContactFeature.prototype._typeB=0;goog.exportProperty(box2d.b2ContactFeature.prototype,"_typeB",box2d.b2ContactFeature.prototype._typeB);
Object.defineProperty(box2d.b2ContactFeature.prototype,"key",{enumerable:!1,configurable:!0,get:function(){this._key_invalid&&(this._key_invalid=!1,this._key=this._indexA|this._indexB<<8|this._typeA<<16|this._typeB<<24);return this._key},set:function(a){this._key=a;this._indexA=this._key&255;this._indexB=this._key>>8&255;this._typeA=this._key>>16&255;this._typeB=this._key>>24&255}});
Object.defineProperty(box2d.b2ContactFeature.prototype,"indexA",{enumerable:!1,configurable:!0,get:function(){return this._indexA},set:function(a){this._indexA=a;this._key_invalid=!0}});Object.defineProperty(box2d.b2ContactFeature.prototype,"indexB",{enumerable:!1,configurable:!0,get:function(){return this._indexB},set:function(a){this._indexB=a;this._key_invalid=!0}});
Object.defineProperty(box2d.b2ContactFeature.prototype,"typeA",{enumerable:!1,configurable:!0,get:function(){return this._typeA},set:function(a){this._typeA=a;this._key_invalid=!0}});Object.defineProperty(box2d.b2ContactFeature.prototype,"typeB",{enumerable:!1,configurable:!0,get:function(){return this._typeB},set:function(a){this._typeB=a;this._key_invalid=!0}});box2d.b2ContactID=function(){this.cf=new box2d.b2ContactFeature};goog.exportSymbol("box2d.b2ContactID",box2d.b2ContactID);
box2d.b2ContactID.prototype.cf=null;goog.exportProperty(box2d.b2ContactID.prototype,"cf",box2d.b2ContactID.prototype.cf);box2d.b2ContactID.prototype.key=0;goog.exportProperty(box2d.b2ContactID.prototype,"key",box2d.b2ContactID.prototype.key);Object.defineProperty(box2d.b2ContactID.prototype,"key",{enumerable:!1,configurable:!0,get:function(){return this.cf.key},set:function(a){this.cf.key=a}});box2d.b2ContactID.prototype.Copy=function(a){this.key=a.key;return this};
goog.exportProperty(box2d.b2ContactID.prototype,"Copy",box2d.b2ContactID.prototype.Copy);box2d.b2ContactID.prototype.Clone=function(){return(new box2d.b2ContactID).Copy(this)};goog.exportProperty(box2d.b2ContactID.prototype,"Clone",box2d.b2ContactID.prototype.Clone);box2d.b2ManifoldPoint=function(){this.localPoint=new box2d.b2Vec2;this.id=new box2d.b2ContactID};goog.exportSymbol("box2d.b2ManifoldPoint",box2d.b2ManifoldPoint);box2d.b2ManifoldPoint.prototype.localPoint=null;
goog.exportProperty(box2d.b2ManifoldPoint.prototype,"localPoint",box2d.b2ManifoldPoint.prototype.localPoint);box2d.b2ManifoldPoint.prototype.normalImpulse=0;goog.exportProperty(box2d.b2ManifoldPoint.prototype,"normalImpulse",box2d.b2ManifoldPoint.prototype.normalImpulse);box2d.b2ManifoldPoint.prototype.tangentImpulse=0;goog.exportProperty(box2d.b2ManifoldPoint.prototype,"tangentImpulse",box2d.b2ManifoldPoint.prototype.tangentImpulse);box2d.b2ManifoldPoint.prototype.id=null;
goog.exportProperty(box2d.b2ManifoldPoint.prototype,"id",box2d.b2ManifoldPoint.prototype.id);box2d.b2ManifoldPoint.MakeArray=function(a){return box2d.b2MakeArray(a,function(a){return new box2d.b2ManifoldPoint})};goog.exportProperty(box2d.b2ManifoldPoint,"MakeArray",box2d.b2ManifoldPoint.MakeArray);box2d.b2ManifoldPoint.prototype.Reset=function(){this.localPoint.SetZero();this.tangentImpulse=this.normalImpulse=0;this.id.key=0};goog.exportProperty(box2d.b2ManifoldPoint.prototype,"Reset",box2d.b2ManifoldPoint.prototype.Reset);
box2d.b2ManifoldPoint.prototype.Copy=function(a){this.localPoint.Copy(a.localPoint);this.normalImpulse=a.normalImpulse;this.tangentImpulse=a.tangentImpulse;this.id.Copy(a.id);return this};goog.exportProperty(box2d.b2ManifoldPoint.prototype,"Copy",box2d.b2ManifoldPoint.prototype.Copy);box2d.b2ManifoldType={e_unknown:-1,e_circles:0,e_faceA:1,e_faceB:2};goog.exportSymbol("box2d.b2ManifoldType",box2d.b2ManifoldType);goog.exportProperty(box2d.b2ManifoldType,"e_unknown",box2d.b2ManifoldType.e_unknown);
goog.exportProperty(box2d.b2ManifoldType,"e_circles",box2d.b2ManifoldType.e_circles);goog.exportProperty(box2d.b2ManifoldType,"e_faceA",box2d.b2ManifoldType.e_faceA);goog.exportProperty(box2d.b2ManifoldType,"e_faceB",box2d.b2ManifoldType.e_faceB);box2d.b2Manifold=function(){this.points=box2d.b2ManifoldPoint.MakeArray(box2d.b2_maxManifoldPoints);this.localNormal=new box2d.b2Vec2;this.localPoint=new box2d.b2Vec2;this.type=box2d.b2ManifoldType.e_unknown;this.pointCount=0};
goog.exportSymbol("box2d.b2Manifold",box2d.b2Manifold);box2d.b2Manifold.prototype.points=null;goog.exportProperty(box2d.b2Manifold.prototype,"points",box2d.b2Manifold.prototype.points);box2d.b2Manifold.prototype.localNormal=null;goog.exportProperty(box2d.b2Manifold.prototype,"localNormal",box2d.b2Manifold.prototype.localNormal);box2d.b2Manifold.prototype.localPoint=null;goog.exportProperty(box2d.b2Manifold.prototype,"localPoint",box2d.b2Manifold.prototype.localPoint);
box2d.b2Manifold.prototype.type=box2d.b2ManifoldType.e_unknown;goog.exportProperty(box2d.b2Manifold.prototype,"type",box2d.b2Manifold.prototype.type);box2d.b2Manifold.prototype.pointCount=0;goog.exportProperty(box2d.b2Manifold.prototype,"pointCount",box2d.b2Manifold.prototype.pointCount);
box2d.b2Manifold.prototype.Reset=function(){for(var a=0,b=box2d.b2_maxManifoldPoints;a<b;++a)this.points[a].Reset();this.localNormal.SetZero();this.localPoint.SetZero();this.type=box2d.b2ManifoldType.e_unknown;this.pointCount=0};goog.exportProperty(box2d.b2Manifold.prototype,"Reset",box2d.b2Manifold.prototype.Reset);
box2d.b2Manifold.prototype.Copy=function(a){this.pointCount=a.pointCount;for(var b=0,d=box2d.b2_maxManifoldPoints;b<d;++b)this.points[b].Copy(a.points[b]);this.localNormal.Copy(a.localNormal);this.localPoint.Copy(a.localPoint);this.type=a.type;return this};goog.exportProperty(box2d.b2Manifold.prototype,"Copy",box2d.b2Manifold.prototype.Copy);box2d.b2Manifold.prototype.Clone=function(){return(new box2d.b2Manifold).Copy(this)};goog.exportProperty(box2d.b2Manifold.prototype,"Clone",box2d.b2Manifold.prototype.Clone);
box2d.b2WorldManifold=function(){this.normal=new box2d.b2Vec2;this.points=box2d.b2Vec2.MakeArray(box2d.b2_maxManifoldPoints);this.separations=box2d.b2MakeNumberArray(box2d.b2_maxManifoldPoints)};goog.exportSymbol("box2d.b2WorldManifold",box2d.b2WorldManifold);box2d.b2WorldManifold.prototype.normal=null;goog.exportProperty(box2d.b2WorldManifold.prototype,"normal",box2d.b2WorldManifold.prototype.normal);box2d.b2WorldManifold.prototype.points=null;
goog.exportProperty(box2d.b2WorldManifold.prototype,"points",box2d.b2WorldManifold.prototype.points);box2d.b2WorldManifold.prototype.separations=null;goog.exportProperty(box2d.b2WorldManifold.prototype,"separations",box2d.b2WorldManifold.prototype.separations);
box2d.b2WorldManifold.prototype.Initialize=function(a,b,d,e,f){if(0!==a.pointCount)switch(a.type){case box2d.b2ManifoldType.e_circles:this.normal.Set(1,0);b=box2d.b2Mul_X_V2(b,a.localPoint,box2d.b2WorldManifold.prototype.Initialize.s_pointA);a=box2d.b2Mul_X_V2(e,a.points[0].localPoint,box2d.b2WorldManifold.prototype.Initialize.s_pointB);box2d.b2DistanceSquared(b,a)>box2d.b2_epsilon_sq&&box2d.b2Sub_V2_V2(a,b,this.normal).SelfNormalize();var g=box2d.b2AddMul_V2_S_V2(b,d,this.normal,box2d.b2WorldManifold.prototype.Initialize.s_cA),
k=box2d.b2SubMul_V2_S_V2(a,f,this.normal,box2d.b2WorldManifold.prototype.Initialize.s_cB);box2d.b2Mid_V2_V2(g,k,this.points[0]);this.separations[0]=box2d.b2Dot_V2_V2(box2d.b2Sub_V2_V2(k,g,box2d.b2Vec2.s_t0),this.normal);break;case box2d.b2ManifoldType.e_faceA:box2d.b2Mul_R_V2(b.q,a.localNormal,this.normal);for(var m=box2d.b2Mul_X_V2(b,a.localPoint,box2d.b2WorldManifold.prototype.Initialize.s_planePoint),n=0,q=a.pointCount;n<q;++n){var s=box2d.b2Mul_X_V2(e,a.points[n].localPoint,box2d.b2WorldManifold.prototype.Initialize.s_clipPoint),
g=d-box2d.b2Dot_V2_V2(box2d.b2Sub_V2_V2(s,m,box2d.b2Vec2.s_t0),this.normal),g=box2d.b2AddMul_V2_S_V2(s,g,this.normal,box2d.b2WorldManifold.prototype.Initialize.s_cA),k=box2d.b2SubMul_V2_S_V2(s,f,this.normal,box2d.b2WorldManifold.prototype.Initialize.s_cB);box2d.b2Mid_V2_V2(g,k,this.points[n]);this.separations[n]=box2d.b2Dot_V2_V2(box2d.b2Sub_V2_V2(k,g,box2d.b2Vec2.s_t0),this.normal)}break;case box2d.b2ManifoldType.e_faceB:box2d.b2Mul_R_V2(e.q,a.localNormal,this.normal);m=box2d.b2Mul_X_V2(e,a.localPoint,
box2d.b2WorldManifold.prototype.Initialize.s_planePoint);n=0;for(q=a.pointCount;n<q;++n)s=box2d.b2Mul_X_V2(b,a.points[n].localPoint,box2d.b2WorldManifold.prototype.Initialize.s_clipPoint),g=f-box2d.b2Dot_V2_V2(box2d.b2Sub_V2_V2(s,m,box2d.b2Vec2.s_t0),this.normal),k=box2d.b2AddMul_V2_S_V2(s,g,this.normal,box2d.b2WorldManifold.prototype.Initialize.s_cB),g=box2d.b2SubMul_V2_S_V2(s,d,this.normal,box2d.b2WorldManifold.prototype.Initialize.s_cA),box2d.b2Mid_V2_V2(g,k,this.points[n]),this.separations[n]=
box2d.b2Dot_V2_V2(box2d.b2Sub_V2_V2(g,k,box2d.b2Vec2.s_t0),this.normal);this.normal.SelfNeg()}};goog.exportProperty(box2d.b2WorldManifold.prototype,"Initialize",box2d.b2WorldManifold.prototype.Initialize);box2d.b2WorldManifold.prototype.Initialize.s_pointA=new box2d.b2Vec2;box2d.b2WorldManifold.prototype.Initialize.s_pointB=new box2d.b2Vec2;box2d.b2WorldManifold.prototype.Initialize.s_cA=new box2d.b2Vec2;box2d.b2WorldManifold.prototype.Initialize.s_cB=new box2d.b2Vec2;
box2d.b2WorldManifold.prototype.Initialize.s_planePoint=new box2d.b2Vec2;box2d.b2WorldManifold.prototype.Initialize.s_clipPoint=new box2d.b2Vec2;box2d.b2PointState={b2_nullState:0,b2_addState:1,b2_persistState:2,b2_removeState:3};goog.exportSymbol("box2d.b2PointState",box2d.b2PointState);goog.exportProperty(box2d.b2PointState,"b2_nullState   ",box2d.b2PointState.b2_nullState);goog.exportProperty(box2d.b2PointState,"b2_addState    ",box2d.b2PointState.b2_addState);
goog.exportProperty(box2d.b2PointState,"b2_persistState",box2d.b2PointState.b2_persistState);goog.exportProperty(box2d.b2PointState,"b2_removeState ",box2d.b2PointState.b2_removeState);
box2d.b2GetPointStates=function(a,b,d,e){for(var f=0,g=d.pointCount;f<g;++f){var k=d.points[f].id,k=k.key;a[f]=box2d.b2PointState.b2_removeState;for(var m=0,n=e.pointCount;m<n;++m)if(e.points[m].id.key===k){a[f]=box2d.b2PointState.b2_persistState;break}}for(g=box2d.b2_maxManifoldPoints;f<g;++f)a[f]=box2d.b2PointState.b2_nullState;f=0;for(g=e.pointCount;f<g;++f)for(k=e.points[f].id,k=k.key,b[f]=box2d.b2PointState.b2_addState,m=0,n=d.pointCount;m<n;++m)if(d.points[m].id.key===k){b[f]=box2d.b2PointState.b2_persistState;
break}for(g=box2d.b2_maxManifoldPoints;f<g;++f)b[f]=box2d.b2PointState.b2_nullState};goog.exportSymbol("box2d.b2GetPointStates",box2d.b2GetPointStates);box2d.b2ClipVertex=function(){this.v=new box2d.b2Vec2;this.id=new box2d.b2ContactID};goog.exportSymbol("box2d.b2ClipVertex",box2d.b2ClipVertex);box2d.b2ClipVertex.prototype.v=null;goog.exportProperty(box2d.b2ClipVertex.prototype,"v",box2d.b2ClipVertex.prototype.v);box2d.b2ClipVertex.prototype.id=null;
goog.exportProperty(box2d.b2ClipVertex.prototype,"id",box2d.b2ClipVertex.prototype.id);box2d.b2ClipVertex.MakeArray=function(a){return box2d.b2MakeArray(a,function(a){return new box2d.b2ClipVertex})};goog.exportProperty(box2d.b2ClipVertex,"MakeArray",box2d.b2ClipVertex.MakeArray);box2d.b2ClipVertex.prototype.Copy=function(a){this.v.Copy(a.v);this.id.Copy(a.id);return this};goog.exportProperty(box2d.b2ClipVertex.prototype,"Copy",box2d.b2ClipVertex.prototype.Copy);
box2d.b2RayCastInput=function(){this.p1=new box2d.b2Vec2;this.p2=new box2d.b2Vec2;this.maxFraction=1};goog.exportSymbol("box2d.b2RayCastInput",box2d.b2RayCastInput);box2d.b2RayCastInput.prototype.p1=null;goog.exportProperty(box2d.b2RayCastInput.prototype,"p1",box2d.b2RayCastInput.prototype.p1);box2d.b2RayCastInput.prototype.p2=null;goog.exportProperty(box2d.b2RayCastInput.prototype,"p2",box2d.b2RayCastInput.prototype.p2);box2d.b2RayCastInput.prototype.maxFraction=1;
goog.exportProperty(box2d.b2RayCastInput.prototype,"maxFraction",box2d.b2RayCastInput.prototype.maxFraction);box2d.b2RayCastInput.prototype.Copy=function(a){this.p1.Copy(a.p1);this.p2.Copy(a.p2);this.maxFraction=a.maxFraction;return this};goog.exportProperty(box2d.b2RayCastInput.prototype,"Copy",box2d.b2RayCastInput.prototype.Copy);box2d.b2RayCastOutput=function(){this.normal=new box2d.b2Vec2;this.fraction=0};goog.exportSymbol("box2d.b2RayCastOutput",box2d.b2RayCastOutput);
box2d.b2RayCastOutput.prototype.normal=null;goog.exportProperty(box2d.b2RayCastOutput.prototype,"normal",box2d.b2RayCastOutput.prototype.normal);box2d.b2RayCastOutput.prototype.fraction=0;goog.exportProperty(box2d.b2RayCastOutput.prototype,"fraction",box2d.b2RayCastOutput.prototype.fraction);box2d.b2RayCastOutput.prototype.Copy=function(a){this.normal.Copy(a.normal);this.fraction=a.fraction;return this};goog.exportProperty(box2d.b2RayCastOutput.prototype,"Copy",box2d.b2RayCastOutput.prototype.Copy);
box2d.b2AABB=function(){this.lowerBound=new box2d.b2Vec2;this.upperBound=new box2d.b2Vec2;this.m_out_center=new box2d.b2Vec2;this.m_out_extent=new box2d.b2Vec2};goog.exportSymbol("box2d.b2AABB",box2d.b2AABB);box2d.b2AABB.prototype.lowerBound=null;goog.exportProperty(box2d.b2AABB.prototype,"lowerBound",box2d.b2AABB.prototype.lowerBound);box2d.b2AABB.prototype.upperBound=null;goog.exportProperty(box2d.b2AABB.prototype,"upperBound",box2d.b2AABB.prototype.upperBound);
box2d.b2AABB.prototype.m_out_center=null;goog.exportProperty(box2d.b2AABB.prototype,"m_out_center",box2d.b2AABB.prototype.m_out_center);box2d.b2AABB.prototype.m_out_extent=null;goog.exportProperty(box2d.b2AABB.prototype,"m_out_extent",box2d.b2AABB.prototype.m_out_extent);box2d.b2AABB.prototype.Clone=function(){return(new box2d.b2AABB).Copy(this)};goog.exportProperty(box2d.b2AABB.prototype,"Clone",box2d.b2AABB.prototype.Clone);
box2d.b2AABB.prototype.Copy=function(a){this.lowerBound.Copy(a.lowerBound);this.upperBound.Copy(a.upperBound);return this};goog.exportProperty(box2d.b2AABB.prototype,"Copy",box2d.b2AABB.prototype.Copy);box2d.b2AABB.prototype.IsValid=function(){var a=this.upperBound.y-this.lowerBound.y;return 0<=this.upperBound.x-this.lowerBound.x&&0<=a&&this.lowerBound.IsValid()&&this.upperBound.IsValid()};goog.exportProperty(box2d.b2AABB.prototype,"IsValid",box2d.b2AABB.prototype.IsValid);
box2d.b2AABB.prototype.GetCenter=function(){return box2d.b2Mid_V2_V2(this.lowerBound,this.upperBound,this.m_out_center)};goog.exportProperty(box2d.b2AABB.prototype,"GetCenter",box2d.b2AABB.prototype.GetCenter);box2d.b2AABB.prototype.GetExtents=function(){return box2d.b2Ext_V2_V2(this.lowerBound,this.upperBound,this.m_out_extent)};goog.exportProperty(box2d.b2AABB.prototype,"GetExtents",box2d.b2AABB.prototype.GetExtents);
box2d.b2AABB.prototype.GetPerimeter=function(){return 2*(this.upperBound.x-this.lowerBound.x+(this.upperBound.y-this.lowerBound.y))};goog.exportProperty(box2d.b2AABB.prototype,"GetPerimeter",box2d.b2AABB.prototype.GetPerimeter);box2d.b2AABB.prototype.Combine=function(a,b){switch(arguments.length){case 1:return this.Combine1(a);case 2:return this.Combine2(a,b||new box2d.b2AABB);default:throw Error();}};
box2d.b2AABB.prototype.Combine1=function(a){this.lowerBound.x=box2d.b2Min(this.lowerBound.x,a.lowerBound.x);this.lowerBound.y=box2d.b2Min(this.lowerBound.y,a.lowerBound.y);this.upperBound.x=box2d.b2Max(this.upperBound.x,a.upperBound.x);this.upperBound.y=box2d.b2Max(this.upperBound.y,a.upperBound.y);return this};goog.exportProperty(box2d.b2AABB.prototype,"Combine1",box2d.b2AABB.prototype.Combine1);
box2d.b2AABB.prototype.Combine2=function(a,b){this.lowerBound.x=box2d.b2Min(a.lowerBound.x,b.lowerBound.x);this.lowerBound.y=box2d.b2Min(a.lowerBound.y,b.lowerBound.y);this.upperBound.x=box2d.b2Max(a.upperBound.x,b.upperBound.x);this.upperBound.y=box2d.b2Max(a.upperBound.y,b.upperBound.y);return this};goog.exportProperty(box2d.b2AABB.prototype,"Combine2",box2d.b2AABB.prototype.Combine2);box2d.b2AABB.Combine=function(a,b,d){d.Combine2(a,b);return d};goog.exportProperty(box2d.b2AABB,"Combine",box2d.b2AABB.Combine);
box2d.b2AABB.prototype.Contains=function(a){return this.lowerBound.x<=a.lowerBound.x&&this.lowerBound.y<=a.lowerBound.y&&a.upperBound.x<=this.upperBound.x&&a.upperBound.y<=this.upperBound.y};goog.exportProperty(box2d.b2AABB.prototype,"Contains",box2d.b2AABB.prototype.Contains);
box2d.b2AABB.prototype.RayCast=function(a,b){var d=-box2d.b2_maxFloat,e=box2d.b2_maxFloat,f=b.p1.x,g=b.p1.y,k=b.p2.x-b.p1.x,m=b.p2.y-b.p1.y,n=box2d.b2Abs(k),q=box2d.b2Abs(m),s=a.normal;if(n<box2d.b2_epsilon){if(f<this.lowerBound.x||this.upperBound.x<f)return!1}else if(n=1/k,k=(this.lowerBound.x-f)*n,f=(this.upperBound.x-f)*n,n=-1,k>f&&(n=k,k=f,f=n,n=1),k>d&&(s.x=n,s.y=0,d=k),e=box2d.b2Min(e,f),d>e)return!1;if(q<box2d.b2_epsilon){if(g<this.lowerBound.y||this.upperBound.y<g)return!1}else if(n=1/m,k=
(this.lowerBound.y-g)*n,f=(this.upperBound.y-g)*n,n=-1,k>f&&(n=k,k=f,f=n,n=1),k>d&&(s.x=0,s.y=n,d=k),e=box2d.b2Min(e,f),d>e)return!1;if(0>d||b.maxFraction<d)return!1;a.fraction=d;return!0};goog.exportProperty(box2d.b2AABB.prototype,"RayCast",box2d.b2AABB.prototype.RayCast);box2d.b2AABB.prototype.TestOverlap=function(a){var b=a.lowerBound.y-this.upperBound.y,d=this.lowerBound.y-a.upperBound.y;return 0<a.lowerBound.x-this.upperBound.x||0<b||0<this.lowerBound.x-a.upperBound.x||0<d?!1:!0};
goog.exportProperty(box2d.b2AABB.prototype,"TestOverlap",box2d.b2AABB.prototype.TestOverlap);box2d.b2TestOverlap_AABB=function(a,b){var d=b.lowerBound.y-a.upperBound.y,e=a.lowerBound.y-b.upperBound.y;return 0<b.lowerBound.x-a.upperBound.x||0<d||0<a.lowerBound.x-b.upperBound.x||0<e?!1:!0};goog.exportSymbol("box2d.b2TestOverlap_AABB",box2d.b2TestOverlap_AABB);
box2d.b2ClipSegmentToLine=function(a,b,d,e,f){var g=0,k=b[0];b=b[1];var m=box2d.b2Dot_V2_V2(d,k.v)-e;d=box2d.b2Dot_V2_V2(d,b.v)-e;0>=m&&a[g++].Copy(k);0>=d&&a[g++].Copy(b);0>m*d&&(d=m/(m-d),e=a[g].v,e.x=k.v.x+d*(b.v.x-k.v.x),e.y=k.v.y+d*(b.v.y-k.v.y),a=a[g].id,a.cf.indexA=f,a.cf.indexB=k.id.cf.indexB,a.cf.typeA=box2d.b2ContactFeatureType.e_vertex,a.cf.typeB=box2d.b2ContactFeatureType.e_face,++g);return g};goog.exportSymbol("box2d.b2ClipSegmentToLine",box2d.b2ClipSegmentToLine);
box2d.b2TestOverlap_Shape=function(a,b,d,e,f,g){var k=box2d.b2TestOverlap_Shape.s_input.Reset();k.proxyA.SetShape(a,b);k.proxyB.SetShape(d,e);k.transformA.Copy(f);k.transformB.Copy(g);k.useRadii=!0;a=box2d.b2TestOverlap_Shape.s_simplexCache.Reset();a.count=0;b=box2d.b2TestOverlap_Shape.s_output.Reset();box2d.b2ShapeDistance(b,a,k);return b.distance<10*box2d.b2_epsilon};goog.exportSymbol("box2d.b2TestOverlap_Shape",box2d.b2TestOverlap_Shape);box2d.b2TestOverlap_Shape.s_input=new box2d.b2DistanceInput;
box2d.b2TestOverlap_Shape.s_simplexCache=new box2d.b2SimplexCache;box2d.b2TestOverlap_Shape.s_output=new box2d.b2DistanceOutput;box2d.b2TestOverlap=function(a,b,d,e,f,g){if(a instanceof box2d.b2AABB&&b instanceof box2d.b2AABB)return box2d.b2TestOverlap_AABB(a,b);if(a instanceof box2d.b2Shape&&"number"===typeof b&&d instanceof box2d.b2Shape&&"number"===typeof e&&f instanceof box2d.b2Transform&&g instanceof box2d.b2Transform)return box2d.b2TestOverlap_Shape(a,b,d,e,f,g);throw Error();};
goog.exportSymbol("box2d.b2TestOverlap",box2d.b2TestOverlap);box2d.b2CollideCircle={};box2d.b2CollideCircles=function(a,b,d,e,f){a.pointCount=0;d=box2d.b2Mul_X_V2(d,b.m_p,box2d.b2CollideCircles.s_pA);f=box2d.b2Mul_X_V2(f,e.m_p,box2d.b2CollideCircles.s_pB);f=box2d.b2DistanceSquared(d,f);d=b.m_radius+e.m_radius;f>d*d||(a.type=box2d.b2ManifoldType.e_circles,a.localPoint.Copy(b.m_p),a.localNormal.SetZero(),a.pointCount=1,a.points[0].localPoint.Copy(e.m_p),a.points[0].id.key=0)};
goog.exportSymbol("box2d.b2CollideCircles",box2d.b2CollideCircles);box2d.b2CollideCircles.s_pA=new box2d.b2Vec2;box2d.b2CollideCircles.s_pB=new box2d.b2Vec2;
box2d.b2CollidePolygonAndCircle=function(a,b,d,e,f){a.pointCount=0;f=box2d.b2Mul_X_V2(f,e.m_p,box2d.b2CollidePolygonAndCircle.s_c);d=box2d.b2MulT_X_V2(d,f,box2d.b2CollidePolygonAndCircle.s_cLocal);var g=0,k=-box2d.b2_maxFloat;f=b.m_radius+e.m_radius;var m=b.m_count,n=b.m_vertices;b=b.m_normals;for(var q=0;q<m;++q){var s=box2d.b2Dot_V2_V2(b[q],box2d.b2Sub_V2_V2(d,n[q],box2d.b2Vec2.s_t0));if(s>f)return;s>k&&(k=s,g=q)}q=g;s=n[q];m=n[(q+1)%m];k<box2d.b2_epsilon?(a.pointCount=1,a.type=box2d.b2ManifoldType.e_faceA,
a.localNormal.Copy(b[g]),box2d.b2Mid_V2_V2(s,m,a.localPoint),a.points[0].localPoint.Copy(e.m_p),a.points[0].id.key=0):(k=box2d.b2Dot_V2_V2(box2d.b2Sub_V2_V2(d,s,box2d.b2Vec2.s_t0),box2d.b2Sub_V2_V2(m,s,box2d.b2Vec2.s_t1)),g=box2d.b2Dot_V2_V2(box2d.b2Sub_V2_V2(d,m,box2d.b2Vec2.s_t0),box2d.b2Sub_V2_V2(s,m,box2d.b2Vec2.s_t1)),0>=k?box2d.b2DistanceSquared(d,s)>f*f||(a.pointCount=1,a.type=box2d.b2ManifoldType.e_faceA,box2d.b2Sub_V2_V2(d,s,a.localNormal).SelfNormalize(),a.localPoint.Copy(s),a.points[0].localPoint.Copy(e.m_p),
a.points[0].id.key=0):0>=g?box2d.b2DistanceSquared(d,m)>f*f||(a.pointCount=1,a.type=box2d.b2ManifoldType.e_faceA,box2d.b2Sub_V2_V2(d,m,a.localNormal).SelfNormalize(),a.localPoint.Copy(m),a.points[0].localPoint.Copy(e.m_p),a.points[0].id.key=0):(g=box2d.b2Mid_V2_V2(s,m,box2d.b2CollidePolygonAndCircle.s_faceCenter),k=box2d.b2Dot_V2_V2(box2d.b2Sub_V2_V2(d,g,box2d.b2Vec2.s_t1),b[q]),k>f||(a.pointCount=1,a.type=box2d.b2ManifoldType.e_faceA,a.localNormal.Copy(b[q]).SelfNormalize(),a.localPoint.Copy(g),
a.points[0].localPoint.Copy(e.m_p),a.points[0].id.key=0)))};goog.exportSymbol("box2d.b2CollidePolygonAndCircle",box2d.b2CollidePolygonAndCircle);box2d.b2CollidePolygonAndCircle.s_c=new box2d.b2Vec2;box2d.b2CollidePolygonAndCircle.s_cLocal=new box2d.b2Vec2;box2d.b2CollidePolygonAndCircle.s_faceCenter=new box2d.b2Vec2;box2d.b2CollideEdge={};
box2d.b2CollideEdgeAndCircle=function(a,b,d,e,f){a.pointCount=0;d=box2d.b2MulT_X_V2(d,box2d.b2Mul_X_V2(f,e.m_p,box2d.b2Vec2.s_t0),box2d.b2CollideEdgeAndCircle.s_Q);var g=b.m_vertex1,k=b.m_vertex2,m=box2d.b2Sub_V2_V2(k,g,box2d.b2CollideEdgeAndCircle.s_e),n=box2d.b2Dot_V2_V2(m,box2d.b2Sub_V2_V2(k,d,box2d.b2Vec2.s_t0)),q=box2d.b2Dot_V2_V2(m,box2d.b2Sub_V2_V2(d,g,box2d.b2Vec2.s_t0)),s=b.m_radius+e.m_radius;f=box2d.b2CollideEdgeAndCircle.s_id;f.cf.indexB=0;f.cf.typeB=box2d.b2ContactFeatureType.e_vertex;
if(0>=q){var t=g,n=box2d.b2Sub_V2_V2(d,t,box2d.b2CollideEdgeAndCircle.s_d),n=box2d.b2Dot_V2_V2(n,n);n>s*s||b.m_hasVertex0&&(b=box2d.b2Sub_V2_V2(g,b.m_vertex0,box2d.b2CollideEdgeAndCircle.s_e1),0<box2d.b2Dot_V2_V2(b,box2d.b2Sub_V2_V2(g,d,box2d.b2Vec2.s_t0)))||(f.cf.indexA=0,f.cf.typeA=box2d.b2ContactFeatureType.e_vertex,a.pointCount=1,a.type=box2d.b2ManifoldType.e_circles,a.localNormal.SetZero(),a.localPoint.Copy(t),a.points[0].id.Copy(f),a.points[0].localPoint.Copy(e.m_p))}else 0>=n?(t=k,n=box2d.b2Sub_V2_V2(d,
t,box2d.b2CollideEdgeAndCircle.s_d),n=box2d.b2Dot_V2_V2(n,n),n>s*s)||b.m_hasVertex3&&(g=box2d.b2Sub_V2_V2(b.m_vertex3,k,box2d.b2CollideEdgeAndCircle.s_e2),0<box2d.b2Dot_V2_V2(g,box2d.b2Sub_V2_V2(d,k,box2d.b2Vec2.s_t0)))||(f.cf.indexA=1,f.cf.typeA=box2d.b2ContactFeatureType.e_vertex,a.pointCount=1,a.type=box2d.b2ManifoldType.e_circles,a.localNormal.SetZero(),a.localPoint.Copy(t),a.points[0].id.Copy(f),a.points[0].localPoint.Copy(e.m_p)):(b=box2d.b2Dot_V2_V2(m,m),box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<
b),t=box2d.b2CollideEdgeAndCircle.s_P,t.x=1/b*(n*g.x+q*k.x),t.y=1/b*(n*g.y+q*k.y),n=box2d.b2Sub_V2_V2(d,t,box2d.b2CollideEdgeAndCircle.s_d),n=box2d.b2Dot_V2_V2(n,n),n>s*s||(t=box2d.b2CollideEdgeAndCircle.s_n.Set(-m.y,m.x),0>box2d.b2Dot_V2_V2(t,box2d.b2Sub_V2_V2(d,g,box2d.b2Vec2.s_t0))&&t.Set(-t.x,-t.y),t.Normalize(),f.cf.indexA=0,f.cf.typeA=box2d.b2ContactFeatureType.e_face,a.pointCount=1,a.type=box2d.b2ManifoldType.e_faceA,a.localNormal.Copy(t),a.localPoint.Copy(g),a.points[0].id.Copy(f),a.points[0].localPoint.Copy(e.m_p)))};
goog.exportSymbol("box2d.b2CollideEdgeAndCircle",box2d.b2CollideEdgeAndCircle);box2d.b2CollideEdgeAndCircle.s_Q=new box2d.b2Vec2;box2d.b2CollideEdgeAndCircle.s_e=new box2d.b2Vec2;box2d.b2CollideEdgeAndCircle.s_d=new box2d.b2Vec2;box2d.b2CollideEdgeAndCircle.s_e1=new box2d.b2Vec2;box2d.b2CollideEdgeAndCircle.s_e2=new box2d.b2Vec2;box2d.b2CollideEdgeAndCircle.s_P=new box2d.b2Vec2;box2d.b2CollideEdgeAndCircle.s_n=new box2d.b2Vec2;box2d.b2CollideEdgeAndCircle.s_id=new box2d.b2ContactID;
box2d.b2EPAxisType={e_unknown:0,e_edgeA:1,e_edgeB:2};goog.exportSymbol("box2d.b2EPAxisType",box2d.b2EPAxisType);goog.exportProperty(box2d.b2EPAxisType,"e_unknown",box2d.b2EPAxisType.e_unknown);goog.exportProperty(box2d.b2EPAxisType,"e_edgeA",box2d.b2EPAxisType.e_edgeA);goog.exportProperty(box2d.b2EPAxisType,"e_edgeB",box2d.b2EPAxisType.e_edgeB);box2d.b2EPAxis=function(){};goog.exportSymbol("box2d.b2EPAxis",box2d.b2EPAxis);box2d.b2EPAxis.prototype.type=box2d.b2EPAxisType.e_unknown;
goog.exportProperty(box2d.b2EPAxis.prototype,"type",box2d.b2EPAxis.prototype.type);box2d.b2EPAxis.prototype.index=0;goog.exportProperty(box2d.b2EPAxis.prototype,"index",box2d.b2EPAxis.prototype.index);box2d.b2EPAxis.prototype.separation=0;goog.exportProperty(box2d.b2EPAxis.prototype,"separation",box2d.b2EPAxis.prototype.separation);
box2d.b2TempPolygon=function(){this.vertices=box2d.b2Vec2.MakeArray(box2d.b2_maxPolygonVertices);this.normals=box2d.b2Vec2.MakeArray(box2d.b2_maxPolygonVertices);this.count=0};goog.exportSymbol("box2d.b2TempPolygon",box2d.b2TempPolygon);box2d.b2TempPolygon.prototype.vertices=null;goog.exportProperty(box2d.b2TempPolygon.prototype,"vertices",box2d.b2TempPolygon.prototype.vertices);box2d.b2TempPolygon.prototype.normals=null;goog.exportProperty(box2d.b2TempPolygon.prototype,"normals",box2d.b2TempPolygon.prototype.normals);
box2d.b2TempPolygon.prototype.count=0;goog.exportProperty(box2d.b2TempPolygon.prototype,"count",box2d.b2TempPolygon.prototype.count);box2d.b2ReferenceFace=function(){this.i2=this.i1=0;this.v1=new box2d.b2Vec2;this.v2=new box2d.b2Vec2;this.normal=new box2d.b2Vec2;this.sideNormal1=new box2d.b2Vec2;this.sideOffset1=0;this.sideNormal2=new box2d.b2Vec2;this.sideOffset2=0};goog.exportSymbol("box2d.b2ReferenceFace",box2d.b2ReferenceFace);box2d.b2ReferenceFace.prototype.i1=0;
goog.exportProperty(box2d.b2ReferenceFace.prototype,"i1",box2d.b2ReferenceFace.prototype.i1);box2d.b2ReferenceFace.prototype.i2=0;goog.exportProperty(box2d.b2ReferenceFace.prototype,"i2",box2d.b2ReferenceFace.prototype.i2);box2d.b2ReferenceFace.prototype.v1=null;goog.exportProperty(box2d.b2ReferenceFace.prototype,"v1",box2d.b2ReferenceFace.prototype.v1);box2d.b2ReferenceFace.prototype.v2=null;goog.exportProperty(box2d.b2ReferenceFace.prototype,"v2",box2d.b2ReferenceFace.prototype.v2);
box2d.b2ReferenceFace.prototype.normal=null;goog.exportProperty(box2d.b2ReferenceFace.prototype,"normal",box2d.b2ReferenceFace.prototype.normal);box2d.b2ReferenceFace.prototype.sideNormal1=null;goog.exportProperty(box2d.b2ReferenceFace.prototype,"sideNormal1",box2d.b2ReferenceFace.prototype.sideNormal1);box2d.b2ReferenceFace.prototype.sideOffset1=0;goog.exportProperty(box2d.b2ReferenceFace.prototype,"sideOffset1",box2d.b2ReferenceFace.prototype.sideOffset1);
box2d.b2ReferenceFace.prototype.sideNormal2=null;goog.exportProperty(box2d.b2ReferenceFace.prototype,"sideNormal2",box2d.b2ReferenceFace.prototype.sideNormal2);box2d.b2ReferenceFace.prototype.sideOffset2=0;goog.exportProperty(box2d.b2ReferenceFace.prototype,"sideOffset2",box2d.b2ReferenceFace.prototype.sideOffset2);box2d.b2EPColliderVertexType={e_isolated:0,e_concave:1,e_convex:2};goog.exportSymbol("box2d.b2EPColliderVertexType",box2d.b2EPColliderVertexType);
goog.exportProperty(box2d.b2EPColliderVertexType,"e_isolated",box2d.b2EPColliderVertexType.e_isolated);goog.exportProperty(box2d.b2EPColliderVertexType,"e_concave",box2d.b2EPColliderVertexType.e_concave);goog.exportProperty(box2d.b2EPColliderVertexType,"e_convex",box2d.b2EPColliderVertexType.e_convex);
box2d.b2EPCollider=function(){this.m_polygonB=new box2d.b2TempPolygon;this.m_xf=new box2d.b2Transform;this.m_centroidB=new box2d.b2Vec2;this.m_v0=new box2d.b2Vec2;this.m_v1=new box2d.b2Vec2;this.m_v2=new box2d.b2Vec2;this.m_v3=new box2d.b2Vec2;this.m_normal0=new box2d.b2Vec2;this.m_normal1=new box2d.b2Vec2;this.m_normal2=new box2d.b2Vec2;this.m_normal=new box2d.b2Vec2;this.m_type2=this.m_type1=box2d.b2EPColliderVertexType.e_isolated;this.m_lowerLimit=new box2d.b2Vec2;this.m_upperLimit=new box2d.b2Vec2;
this.m_radius=0;this.m_front=!1};goog.exportSymbol("box2d.b2EPCollider",box2d.b2EPCollider);box2d.b2EPCollider.prototype.m_polygonB=null;goog.exportProperty(box2d.b2EPCollider.prototype,"m_polygonB",box2d.b2EPCollider.prototype.m_polygonB);box2d.b2EPCollider.prototype.m_xf=null;goog.exportProperty(box2d.b2EPCollider.prototype,"m_xf",box2d.b2EPCollider.prototype.m_xf);box2d.b2EPCollider.prototype.m_centroidB=null;goog.exportProperty(box2d.b2EPCollider.prototype,"m_centroidB",box2d.b2EPCollider.prototype.m_centroidB);
box2d.b2EPCollider.prototype.m_v0=null;goog.exportProperty(box2d.b2EPCollider.prototype,"m_v0",box2d.b2EPCollider.prototype.m_v0);box2d.b2EPCollider.prototype.m_v1=null;goog.exportProperty(box2d.b2EPCollider.prototype,"m_v1",box2d.b2EPCollider.prototype.m_v1);box2d.b2EPCollider.prototype.m_v2=null;goog.exportProperty(box2d.b2EPCollider.prototype,"m_v2",box2d.b2EPCollider.prototype.m_v2);box2d.b2EPCollider.prototype.m_v3=null;goog.exportProperty(box2d.b2EPCollider.prototype,"m_v3",box2d.b2EPCollider.prototype.m_v3);
box2d.b2EPCollider.prototype.m_normal0=null;goog.exportProperty(box2d.b2EPCollider.prototype,"m_normal0",box2d.b2EPCollider.prototype.m_normal0);box2d.b2EPCollider.prototype.m_normal1=null;goog.exportProperty(box2d.b2EPCollider.prototype,"m_normal1",box2d.b2EPCollider.prototype.m_normal1);box2d.b2EPCollider.prototype.m_normal2=null;goog.exportProperty(box2d.b2EPCollider.prototype,"m_normal2",box2d.b2EPCollider.prototype.m_normal2);box2d.b2EPCollider.prototype.m_normal=null;
goog.exportProperty(box2d.b2EPCollider.prototype,"m_normal",box2d.b2EPCollider.prototype.m_normal);box2d.b2EPCollider.prototype.m_type1=box2d.b2EPColliderVertexType.e_isolated;goog.exportProperty(box2d.b2EPCollider.prototype,"m_type1",box2d.b2EPCollider.prototype.m_type1);box2d.b2EPCollider.prototype.m_type2=box2d.b2EPColliderVertexType.e_isolated;goog.exportProperty(box2d.b2EPCollider.prototype,"m_type2",box2d.b2EPCollider.prototype.m_type2);box2d.b2EPCollider.prototype.m_lowerLimit=null;
goog.exportProperty(box2d.b2EPCollider.prototype,"m_lowerLimit",box2d.b2EPCollider.prototype.m_lowerLimit);box2d.b2EPCollider.prototype.m_upperLimit=null;goog.exportProperty(box2d.b2EPCollider.prototype,"m_upperLimit",box2d.b2EPCollider.prototype.m_upperLimit);box2d.b2EPCollider.prototype.m_radius=0;goog.exportProperty(box2d.b2EPCollider.prototype,"m_radius",box2d.b2EPCollider.prototype.m_radius);box2d.b2EPCollider.prototype.m_front=!1;goog.exportProperty(box2d.b2EPCollider.prototype,"m_front",box2d.b2EPCollider.prototype.m_front);
box2d.b2EPCollider.prototype.Collide=function(a,b,d,e,f){box2d.b2MulT_X_X(d,f,this.m_xf);box2d.b2Mul_X_V2(this.m_xf,e.m_centroid,this.m_centroidB);this.m_v0.Copy(b.m_vertex0);this.m_v1.Copy(b.m_vertex1);this.m_v2.Copy(b.m_vertex2);this.m_v3.Copy(b.m_vertex3);d=b.m_hasVertex0;b=b.m_hasVertex3;f=box2d.b2Sub_V2_V2(this.m_v2,this.m_v1,box2d.b2EPCollider.s_edge1);f.Normalize();this.m_normal1.Set(f.y,-f.x);var g=box2d.b2Dot_V2_V2(this.m_normal1,box2d.b2Sub_V2_V2(this.m_centroidB,this.m_v1,box2d.b2Vec2.s_t0)),
k=0,m=0,n=!1,q=!1;d&&(k=box2d.b2Sub_V2_V2(this.m_v1,this.m_v0,box2d.b2EPCollider.s_edge0),k.Normalize(),this.m_normal0.Set(k.y,-k.x),n=0<=box2d.b2Cross_V2_V2(k,f),k=box2d.b2Dot_V2_V2(this.m_normal0,box2d.b2Sub_V2_V2(this.m_centroidB,this.m_v0,box2d.b2Vec2.s_t0)));b&&(m=box2d.b2Sub_V2_V2(this.m_v3,this.m_v2,box2d.b2EPCollider.s_edge2),m.Normalize(),this.m_normal2.Set(m.y,-m.x),q=0<box2d.b2Cross_V2_V2(f,m),m=box2d.b2Dot_V2_V2(this.m_normal2,box2d.b2Sub_V2_V2(this.m_centroidB,this.m_v2,box2d.b2Vec2.s_t0)));
d&&b?n&&q?(this.m_front=0<=k||0<=g||0<=m)?(this.m_normal.Copy(this.m_normal1),this.m_lowerLimit.Copy(this.m_normal0),this.m_upperLimit.Copy(this.m_normal2)):(this.m_normal.Copy(this.m_normal1).SelfNeg(),this.m_lowerLimit.Copy(this.m_normal1).SelfNeg(),this.m_upperLimit.Copy(this.m_normal1).SelfNeg()):n?(this.m_front=0<=k||0<=g&&0<=m)?(this.m_normal.Copy(this.m_normal1),this.m_lowerLimit.Copy(this.m_normal0),this.m_upperLimit.Copy(this.m_normal1)):(this.m_normal.Copy(this.m_normal1).SelfNeg(),this.m_lowerLimit.Copy(this.m_normal2).SelfNeg(),
this.m_upperLimit.Copy(this.m_normal1).SelfNeg()):q?(this.m_front=0<=m||0<=k&&0<=g)?(this.m_normal.Copy(this.m_normal1),this.m_lowerLimit.Copy(this.m_normal1),this.m_upperLimit.Copy(this.m_normal2)):(this.m_normal.Copy(this.m_normal1).SelfNeg(),this.m_lowerLimit.Copy(this.m_normal1).SelfNeg(),this.m_upperLimit.Copy(this.m_normal0).SelfNeg()):(this.m_front=0<=k&&0<=g&&0<=m)?(this.m_normal.Copy(this.m_normal1),this.m_lowerLimit.Copy(this.m_normal1),this.m_upperLimit.Copy(this.m_normal1)):(this.m_normal.Copy(this.m_normal1).SelfNeg(),
this.m_lowerLimit.Copy(this.m_normal2).SelfNeg(),this.m_upperLimit.Copy(this.m_normal0).SelfNeg()):d?n?((this.m_front=0<=k||0<=g)?(this.m_normal.Copy(this.m_normal1),this.m_lowerLimit.Copy(this.m_normal0)):(this.m_normal.Copy(this.m_normal1).SelfNeg(),this.m_lowerLimit.Copy(this.m_normal1)),this.m_upperLimit.Copy(this.m_normal1).SelfNeg()):(this.m_front=0<=k&&0<=g)?(this.m_normal.Copy(this.m_normal1),this.m_lowerLimit.Copy(this.m_normal1),this.m_upperLimit.Copy(this.m_normal1).SelfNeg()):(this.m_normal.Copy(this.m_normal1).SelfNeg(),
this.m_lowerLimit.Copy(this.m_normal1),this.m_upperLimit.Copy(this.m_normal0).SelfNeg()):b?q?(this.m_front=0<=g||0<=m)?(this.m_normal.Copy(this.m_normal1),this.m_lowerLimit.Copy(this.m_normal1).SelfNeg(),this.m_upperLimit.Copy(this.m_normal2)):(this.m_normal.Copy(this.m_normal1).SelfNeg(),this.m_lowerLimit.Copy(this.m_normal1).SelfNeg(),this.m_upperLimit.Copy(this.m_normal1)):((this.m_front=0<=g&&0<=m)?(this.m_normal.Copy(this.m_normal1),this.m_lowerLimit.Copy(this.m_normal1).SelfNeg()):(this.m_normal.Copy(this.m_normal1).SelfNeg(),
this.m_lowerLimit.Copy(this.m_normal2).SelfNeg()),this.m_upperLimit.Copy(this.m_normal1)):(this.m_front=0<=g)?(this.m_normal.Copy(this.m_normal1),this.m_lowerLimit.Copy(this.m_normal1).SelfNeg(),this.m_upperLimit.Copy(this.m_normal1).SelfNeg()):(this.m_normal.Copy(this.m_normal1).SelfNeg(),this.m_lowerLimit.Copy(this.m_normal1),this.m_upperLimit.Copy(this.m_normal1));this.m_polygonB.count=e.m_count;g=0;for(k=e.m_count;g<k;++g)box2d.b2Mul_X_V2(this.m_xf,e.m_vertices[g],this.m_polygonB.vertices[g]),
box2d.b2Mul_R_V2(this.m_xf.q,e.m_normals[g],this.m_polygonB.normals[g]);this.m_radius=2*box2d.b2_polygonRadius;a.pointCount=0;d=this.ComputeEdgeSeparation(box2d.b2EPCollider.s_edgeAxis);if(!(d.type===box2d.b2EPAxisType.e_unknown||d.separation>this.m_radius||(b=this.ComputePolygonSeparation(box2d.b2EPCollider.s_polygonAxis),b.type!==box2d.b2EPAxisType.e_unknown&&b.separation>this.m_radius))){d=b.type===box2d.b2EPAxisType.e_unknown?d:b.separation>.98*d.separation+.001?b:d;f=box2d.b2EPCollider.s_ie;
b=box2d.b2EPCollider.s_rf;if(d.type===box2d.b2EPAxisType.e_edgeA){a.type=box2d.b2ManifoldType.e_faceA;m=0;n=box2d.b2Dot_V2_V2(this.m_normal,this.m_polygonB.normals[0]);g=1;for(k=this.m_polygonB.count;g<k;++g)q=box2d.b2Dot_V2_V2(this.m_normal,this.m_polygonB.normals[g]),q<n&&(n=q,m=g);k=m;g=(k+1)%this.m_polygonB.count;m=f[0];m.v.Copy(this.m_polygonB.vertices[k]);m.id.cf.indexA=0;m.id.cf.indexB=k;m.id.cf.typeA=box2d.b2ContactFeatureType.e_face;m.id.cf.typeB=box2d.b2ContactFeatureType.e_vertex;k=f[1];
k.v.Copy(this.m_polygonB.vertices[g]);k.id.cf.indexA=0;k.id.cf.indexB=g;k.id.cf.typeA=box2d.b2ContactFeatureType.e_face;k.id.cf.typeB=box2d.b2ContactFeatureType.e_vertex;this.m_front?(b.i1=0,b.i2=1,b.v1.Copy(this.m_v1),b.v2.Copy(this.m_v2),b.normal.Copy(this.m_normal1)):(b.i1=1,b.i2=0,b.v1.Copy(this.m_v2),b.v2.Copy(this.m_v1),b.normal.Copy(this.m_normal1).SelfNeg())}else a.type=box2d.b2ManifoldType.e_faceB,m=f[0],m.v.Copy(this.m_v1),m.id.cf.indexA=0,m.id.cf.indexB=d.index,m.id.cf.typeA=box2d.b2ContactFeatureType.e_vertex,
m.id.cf.typeB=box2d.b2ContactFeatureType.e_face,k=f[1],k.v.Copy(this.m_v2),k.id.cf.indexA=0,k.id.cf.indexB=d.index,k.id.cf.typeA=box2d.b2ContactFeatureType.e_vertex,k.id.cf.typeB=box2d.b2ContactFeatureType.e_face,b.i1=d.index,b.i2=(b.i1+1)%this.m_polygonB.count,b.v1.Copy(this.m_polygonB.vertices[b.i1]),b.v2.Copy(this.m_polygonB.vertices[b.i2]),b.normal.Copy(this.m_polygonB.normals[b.i1]);b.sideNormal1.Set(b.normal.y,-b.normal.x);b.sideNormal2.Copy(b.sideNormal1).SelfNeg();b.sideOffset1=box2d.b2Dot_V2_V2(b.sideNormal1,
b.v1);b.sideOffset2=box2d.b2Dot_V2_V2(b.sideNormal2,b.v2);g=box2d.b2EPCollider.s_clipPoints1;m=box2d.b2EPCollider.s_clipPoints2;k=box2d.b2ClipSegmentToLine(g,f,b.sideNormal1,b.sideOffset1,b.i1);if(!(k<box2d.b2_maxManifoldPoints||(k=box2d.b2ClipSegmentToLine(m,g,b.sideNormal2,b.sideOffset2,b.i2),k<box2d.b2_maxManifoldPoints))){d.type===box2d.b2EPAxisType.e_edgeA?(a.localNormal.Copy(b.normal),a.localPoint.Copy(b.v1)):(a.localNormal.Copy(e.m_normals[b.i1]),a.localPoint.Copy(e.m_vertices[b.i1]));g=e=
0;for(k=box2d.b2_maxManifoldPoints;g<k;++g)box2d.b2Dot_V2_V2(b.normal,box2d.b2Sub_V2_V2(m[g].v,b.v1,box2d.b2Vec2.s_t0))<=this.m_radius&&(f=a.points[e],d.type===box2d.b2EPAxisType.e_edgeA?(box2d.b2MulT_X_V2(this.m_xf,m[g].v,f.localPoint),f.id=m[g].id):(f.localPoint.Copy(m[g].v),f.id.cf.typeA=m[g].id.cf.typeB,f.id.cf.typeB=m[g].id.cf.typeA,f.id.cf.indexA=m[g].id.cf.indexB,f.id.cf.indexB=m[g].id.cf.indexA),++e);a.pointCount=e}}};goog.exportProperty(box2d.b2EPCollider.prototype,"Collide",box2d.b2EPCollider.prototype.Collide);
box2d.b2EPCollider.s_edge1=new box2d.b2Vec2;box2d.b2EPCollider.s_edge0=new box2d.b2Vec2;box2d.b2EPCollider.s_edge2=new box2d.b2Vec2;box2d.b2EPCollider.s_ie=box2d.b2ClipVertex.MakeArray(2);box2d.b2EPCollider.s_rf=new box2d.b2ReferenceFace;box2d.b2EPCollider.s_clipPoints1=box2d.b2ClipVertex.MakeArray(2);box2d.b2EPCollider.s_clipPoints2=box2d.b2ClipVertex.MakeArray(2);box2d.b2EPCollider.s_edgeAxis=new box2d.b2EPAxis;box2d.b2EPCollider.s_polygonAxis=new box2d.b2EPAxis;
box2d.b2EPCollider.prototype.ComputeEdgeSeparation=function(a){a.type=box2d.b2EPAxisType.e_edgeA;a.index=this.m_front?0:1;a.separation=box2d.b2_maxFloat;for(var b=0,d=this.m_polygonB.count;b<d;++b){var e=box2d.b2Dot_V2_V2(this.m_normal,box2d.b2Sub_V2_V2(this.m_polygonB.vertices[b],this.m_v1,box2d.b2Vec2.s_t0));e<a.separation&&(a.separation=e)}return a};goog.exportProperty(box2d.b2EPCollider.prototype,"ComputeEdgeSeparation",box2d.b2EPCollider.prototype.ComputeEdgeSeparation);
box2d.b2EPCollider.prototype.ComputePolygonSeparation=function(a){a.type=box2d.b2EPAxisType.e_unknown;a.index=-1;a.separation=-box2d.b2_maxFloat;for(var b=box2d.b2EPCollider.s_perp.Set(-this.m_normal.y,this.m_normal.x),d=0,e=this.m_polygonB.count;d<e;++d){var f=box2d.b2EPCollider.s_n.Copy(this.m_polygonB.normals[d]).SelfNeg(),g=box2d.b2Dot_V2_V2(f,box2d.b2Sub_V2_V2(this.m_polygonB.vertices[d],this.m_v1,box2d.b2Vec2.s_t0)),k=box2d.b2Dot_V2_V2(f,box2d.b2Sub_V2_V2(this.m_polygonB.vertices[d],this.m_v2,
box2d.b2Vec2.s_t0)),g=box2d.b2Min(g,k);if(g>this.m_radius){a.type=box2d.b2EPAxisType.e_edgeB;a.index=d;a.separation=g;break}if(0<=box2d.b2Dot_V2_V2(f,b)){if(box2d.b2Dot_V2_V2(box2d.b2Sub_V2_V2(f,this.m_upperLimit,box2d.b2Vec2.s_t0),this.m_normal)<-box2d.b2_angularSlop)continue}else if(box2d.b2Dot_V2_V2(box2d.b2Sub_V2_V2(f,this.m_lowerLimit,box2d.b2Vec2.s_t0),this.m_normal)<-box2d.b2_angularSlop)continue;g>a.separation&&(a.type=box2d.b2EPAxisType.e_edgeB,a.index=d,a.separation=g)}return a};
goog.exportProperty(box2d.b2EPCollider.prototype,"ComputePolygonSeparation",box2d.b2EPCollider.prototype.ComputePolygonSeparation);box2d.b2EPCollider.s_n=new box2d.b2Vec2;box2d.b2EPCollider.s_perp=new box2d.b2Vec2;box2d.b2CollideEdgeAndPolygon=function(a,b,d,e,f){box2d.b2CollideEdgeAndPolygon.s_collider.Collide(a,b,d,e,f)};goog.exportSymbol("box2d.b2CollideEdgeAndPolygon",box2d.b2CollideEdgeAndPolygon);box2d.b2CollideEdgeAndPolygon.s_collider=new box2d.b2EPCollider;box2d.b2CollidePolygon={};
box2d.b2FindMaxSeparation=function(a,b,d,e,f){var g=b.m_count,k=e.m_count,m=b.m_normals;b=b.m_vertices;e=e.m_vertices;d=box2d.b2MulT_X_X(f,d,box2d.b2FindMaxSeparation.s_xf);f=0;for(var n=-box2d.b2_maxFloat,q=0;q<g;++q){for(var s=box2d.b2Mul_R_V2(d.q,m[q],box2d.b2FindMaxSeparation.s_n),t=box2d.b2Mul_X_V2(d,b[q],box2d.b2FindMaxSeparation.s_v1),u=box2d.b2_maxFloat,v=0;v<k;++v){var y=box2d.b2Dot_V2_V2(s,box2d.b2Sub_V2_V2(e[v],t,box2d.b2Vec2.s_t0));y<u&&(u=y)}u>n&&(n=u,f=q)}a[0]=f;return n};
goog.exportSymbol("box2d.b2FindMaxSeparation",box2d.b2FindMaxSeparation);box2d.b2FindMaxSeparation.s_xf=new box2d.b2Transform;box2d.b2FindMaxSeparation.s_n=new box2d.b2Vec2;box2d.b2FindMaxSeparation.s_v1=new box2d.b2Vec2;
box2d.b2FindIncidentEdge=function(a,b,d,e,f,g){var k=b.m_count,m=b.m_normals,n=f.m_count;b=f.m_vertices;f=f.m_normals;box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<=e&&e<k);d=box2d.b2MulT_R_V2(g.q,box2d.b2Mul_R_V2(d.q,m[e],box2d.b2Vec2.s_t0),box2d.b2FindIncidentEdge.s_normal1);for(var k=0,m=box2d.b2_maxFloat,q=0;q<n;++q){var s=box2d.b2Dot_V2_V2(d,f[q]);s<m&&(m=s,k=q)}f=k;n=(f+1)%n;d=a[0];box2d.b2Mul_X_V2(g,b[f],d.v);d=d.id.cf;d.indexA=e;d.indexB=f;d.typeA=box2d.b2ContactFeatureType.e_face;d.typeB=box2d.b2ContactFeatureType.e_vertex;
a=a[1];box2d.b2Mul_X_V2(g,b[n],a.v);g=a.id.cf;g.indexA=e;g.indexB=n;g.typeA=box2d.b2ContactFeatureType.e_face;g.typeB=box2d.b2ContactFeatureType.e_vertex};goog.exportSymbol("box2d.b2FindIncidentEdge",box2d.b2FindIncidentEdge);box2d.b2FindIncidentEdge.s_normal1=new box2d.b2Vec2;
box2d.b2CollidePolygons=function(a,b,d,e,f){a.pointCount=0;var g=b.m_radius+e.m_radius,k=box2d.b2CollidePolygons.s_edgeA;k[0]=0;var m=box2d.b2FindMaxSeparation(k,b,d,e,f);if(!(m>g)){var n=box2d.b2CollidePolygons.s_edgeB;n[0]=0;var q=box2d.b2FindMaxSeparation(n,e,f,b,d);if(!(q>g)){var s=0,t=0;q>.98*m+.001?(m=e,e=b,b=f,s=n[0],a.type=box2d.b2ManifoldType.e_faceB,t=1):(m=b,b=d,d=f,s=k[0],a.type=box2d.b2ManifoldType.e_faceA,t=0);k=box2d.b2CollidePolygons.s_incidentEdge;box2d.b2FindIncidentEdge(k,m,b,s,
e,d);f=m.m_vertices;var n=s,m=(s+1)%m.m_count,u=f[n],v=f[m],s=box2d.b2Sub_V2_V2(v,u,box2d.b2CollidePolygons.s_localTangent);s.Normalize();f=box2d.b2Cross_V2_S(s,1,box2d.b2CollidePolygons.s_localNormal);e=box2d.b2Mid_V2_V2(u,v,box2d.b2CollidePolygons.s_planePoint);var q=box2d.b2Mul_R_V2(b.q,s,box2d.b2CollidePolygons.s_tangent),s=box2d.b2Cross_V2_S(q,1,box2d.b2CollidePolygons.s_normal),u=box2d.b2Mul_X_V2(b,u,box2d.b2CollidePolygons.s_v11),y=box2d.b2Mul_X_V2(b,v,box2d.b2CollidePolygons.s_v12);b=box2d.b2Dot_V2_V2(s,
u);var v=-box2d.b2Dot_V2_V2(q,u)+g,y=box2d.b2Dot_V2_V2(q,y)+g,z=box2d.b2CollidePolygons.s_clipPoints1,u=box2d.b2CollidePolygons.s_clipPoints2,A=box2d.b2CollidePolygons.s_ntangent.Copy(q).SelfNeg(),k=box2d.b2ClipSegmentToLine(z,k,A,v,n);if(!(2>k||(k=box2d.b2ClipSegmentToLine(u,z,q,y,m),2>k))){a.localNormal.Copy(f);a.localPoint.Copy(e);for(n=k=0;n<box2d.b2_maxManifoldPoints;++n)f=u[n],box2d.b2Dot_V2_V2(s,f.v)-b<=g&&(m=a.points[k],box2d.b2MulT_X_V2(d,f.v,m.localPoint),m.id.Copy(f.id),t&&(f=m.id.cf,m.id.cf.indexA=
f.indexB,m.id.cf.indexB=f.indexA,m.id.cf.typeA=f.typeB,m.id.cf.typeB=f.typeA),++k);a.pointCount=k}}}};goog.exportSymbol("box2d.b2CollidePolygons",box2d.b2CollidePolygons);box2d.b2CollidePolygons.s_incidentEdge=box2d.b2ClipVertex.MakeArray(2);box2d.b2CollidePolygons.s_clipPoints1=box2d.b2ClipVertex.MakeArray(2);box2d.b2CollidePolygons.s_clipPoints2=box2d.b2ClipVertex.MakeArray(2);box2d.b2CollidePolygons.s_edgeA=box2d.b2MakeNumberArray(1);box2d.b2CollidePolygons.s_edgeB=box2d.b2MakeNumberArray(1);
box2d.b2CollidePolygons.s_localTangent=new box2d.b2Vec2;box2d.b2CollidePolygons.s_localNormal=new box2d.b2Vec2;box2d.b2CollidePolygons.s_planePoint=new box2d.b2Vec2;box2d.b2CollidePolygons.s_normal=new box2d.b2Vec2;box2d.b2CollidePolygons.s_tangent=new box2d.b2Vec2;box2d.b2CollidePolygons.s_ntangent=new box2d.b2Vec2;box2d.b2CollidePolygons.s_v11=new box2d.b2Vec2;box2d.b2CollidePolygons.s_v12=new box2d.b2Vec2;box2d.b2TreeNode=function(a){this.m_id=a||0;this.aabb=new box2d.b2AABB};
goog.exportSymbol("box2d.b2TreeNode",box2d.b2TreeNode);box2d.b2TreeNode.prototype.m_id=0;goog.exportProperty(box2d.b2TreeNode.prototype,"m_id",box2d.b2TreeNode.prototype.m_id);box2d.b2TreeNode.prototype.aabb=null;goog.exportProperty(box2d.b2TreeNode.prototype,"aabb",box2d.b2TreeNode.prototype.aabb);box2d.b2TreeNode.prototype.userData=null;goog.exportProperty(box2d.b2TreeNode.prototype,"userData",box2d.b2TreeNode.prototype.userData);box2d.b2TreeNode.prototype.parent=null;
goog.exportProperty(box2d.b2TreeNode.prototype,"parent",box2d.b2TreeNode.prototype.parent);box2d.b2TreeNode.prototype.child1=null;goog.exportProperty(box2d.b2TreeNode.prototype,"child1",box2d.b2TreeNode.prototype.child1);box2d.b2TreeNode.prototype.child2=null;goog.exportProperty(box2d.b2TreeNode.prototype,"child2",box2d.b2TreeNode.prototype.child2);box2d.b2TreeNode.prototype.height=0;goog.exportProperty(box2d.b2TreeNode.prototype,"height",box2d.b2TreeNode.prototype.height);
box2d.b2TreeNode.prototype.IsLeaf=function(){return null===this.child1};goog.exportProperty(box2d.b2TreeNode.prototype,"IsLeaf",box2d.b2TreeNode.prototype.IsLeaf);box2d.b2DynamicTree=function(){};goog.exportSymbol("box2d.b2DynamicTree",box2d.b2DynamicTree);box2d.b2DynamicTree.prototype.m_root=null;goog.exportProperty(box2d.b2DynamicTree.prototype,"m_root",box2d.b2DynamicTree.prototype.m_root);box2d.b2DynamicTree.prototype.m_freeList=null;
goog.exportProperty(box2d.b2DynamicTree.prototype,"m_freeList",box2d.b2DynamicTree.prototype.m_freeList);box2d.b2DynamicTree.prototype.m_path=0;goog.exportProperty(box2d.b2DynamicTree.prototype,"m_path",box2d.b2DynamicTree.prototype.m_path);box2d.b2DynamicTree.prototype.m_insertionCount=0;goog.exportProperty(box2d.b2DynamicTree.prototype,"m_insertionCount",box2d.b2DynamicTree.prototype.m_insertionCount);box2d.b2DynamicTree.s_stack=new box2d.b2GrowableStack(256);box2d.b2DynamicTree.s_r=new box2d.b2Vec2;
box2d.b2DynamicTree.s_v=new box2d.b2Vec2;box2d.b2DynamicTree.s_abs_v=new box2d.b2Vec2;box2d.b2DynamicTree.s_segmentAABB=new box2d.b2AABB;box2d.b2DynamicTree.s_subInput=new box2d.b2RayCastInput;box2d.b2DynamicTree.s_combinedAABB=new box2d.b2AABB;box2d.b2DynamicTree.s_aabb=new box2d.b2AABB;box2d.b2DynamicTree.prototype.GetUserData=function(a){box2d.ENABLE_ASSERTS&&box2d.b2Assert(null!==a);return a.userData};goog.exportProperty(box2d.b2DynamicTree.prototype,"GetUserData",box2d.b2DynamicTree.prototype.GetUserData);
box2d.b2DynamicTree.prototype.GetFatAABB=function(a){box2d.ENABLE_ASSERTS&&box2d.b2Assert(null!==a);return a.aabb};goog.exportProperty(box2d.b2DynamicTree.prototype,"GetFatAABB",box2d.b2DynamicTree.prototype.GetFatAABB);box2d.b2DynamicTree.prototype.Query=function(a,b){if(null!==this.m_root){var d=box2d.b2DynamicTree.s_stack.Reset();for(d.Push(this.m_root);0<d.GetCount();){var e=d.Pop();if(null!==e&&e.aabb.TestOverlap(b))if(e.IsLeaf()){if(!a(e))break}else d.Push(e.child1),d.Push(e.child2)}}};
goog.exportProperty(box2d.b2DynamicTree.prototype,"Query",box2d.b2DynamicTree.prototype.Query);
box2d.b2DynamicTree.prototype.RayCast=function(a,b){if(null!==this.m_root){var d=b.p1,e=b.p2,f=box2d.b2Sub_V2_V2(e,d,box2d.b2DynamicTree.s_r);box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<f.LengthSquared());f.Normalize();var f=box2d.b2Cross_S_V2(1,f,box2d.b2DynamicTree.s_v),g=box2d.b2Abs_V2(f,box2d.b2DynamicTree.s_abs_v),k=b.maxFraction,m=box2d.b2DynamicTree.s_segmentAABB,n=d.x+k*(e.x-d.x),q=d.y+k*(e.y-d.y);m.lowerBound.x=box2d.b2Min(d.x,n);m.lowerBound.y=box2d.b2Min(d.y,q);m.upperBound.x=box2d.b2Max(d.x,
n);m.upperBound.y=box2d.b2Max(d.y,q);var s=box2d.b2DynamicTree.s_stack.Reset();for(s.Push(this.m_root);0<s.GetCount();)if(n=s.Pop(),null!==n&&box2d.b2TestOverlap_AABB(n.aabb,m)){var q=n.aabb.GetCenter(),t=n.aabb.GetExtents();if(!(0<box2d.b2Abs(box2d.b2Dot_V2_V2(f,box2d.b2Sub_V2_V2(d,q,box2d.b2Vec2.s_t0)))-box2d.b2Dot_V2_V2(g,t)))if(n.IsLeaf()){q=box2d.b2DynamicTree.s_subInput;q.p1.Copy(b.p1);q.p2.Copy(b.p2);q.maxFraction=k;n=a(q,n);if(0===n)break;0<n&&(k=n,n=d.x+k*(e.x-d.x),q=d.y+k*(e.y-d.y),m.lowerBound.x=
box2d.b2Min(d.x,n),m.lowerBound.y=box2d.b2Min(d.y,q),m.upperBound.x=box2d.b2Max(d.x,n),m.upperBound.y=box2d.b2Max(d.y,q))}else s.Push(n.child1),s.Push(n.child2)}}};goog.exportProperty(box2d.b2DynamicTree.prototype,"RayCast",box2d.b2DynamicTree.prototype.RayCast);box2d.b2DynamicTree.prototype.AllocateNode=function(){if(this.m_freeList){var a=this.m_freeList;this.m_freeList=a.parent;a.parent=null;a.child1=null;a.child2=null;a.height=0;a.userData=null;return a}return new box2d.b2TreeNode(box2d.b2DynamicTree.prototype.s_node_id++)};
goog.exportProperty(box2d.b2DynamicTree.prototype,"AllocateNode",box2d.b2DynamicTree.prototype.AllocateNode);box2d.b2DynamicTree.prototype.s_node_id=0;box2d.b2DynamicTree.prototype.FreeNode=function(a){a.parent=this.m_freeList;a.height=-1;this.m_freeList=a};goog.exportProperty(box2d.b2DynamicTree.prototype,"FreeNode",box2d.b2DynamicTree.prototype.FreeNode);
box2d.b2DynamicTree.prototype.CreateProxy=function(a,b){var d=this.AllocateNode(),e=box2d.b2_aabbExtension,f=box2d.b2_aabbExtension;d.aabb.lowerBound.x=a.lowerBound.x-e;d.aabb.lowerBound.y=a.lowerBound.y-f;d.aabb.upperBound.x=a.upperBound.x+e;d.aabb.upperBound.y=a.upperBound.y+f;d.userData=b;d.height=0;this.InsertLeaf(d);return d};goog.exportProperty(box2d.b2DynamicTree.prototype,"CreateProxy",box2d.b2DynamicTree.prototype.CreateProxy);
box2d.b2DynamicTree.prototype.DestroyProxy=function(a){box2d.ENABLE_ASSERTS&&box2d.b2Assert(a.IsLeaf());this.RemoveLeaf(a);this.FreeNode(a)};goog.exportProperty(box2d.b2DynamicTree.prototype,"DestroyProxy",box2d.b2DynamicTree.prototype.DestroyProxy);
box2d.b2DynamicTree.prototype.MoveProxy=function(a,b,d){box2d.ENABLE_ASSERTS&&box2d.b2Assert(a.IsLeaf());if(a.aabb.Contains(b))return!1;this.RemoveLeaf(a);var e=box2d.b2_aabbExtension+box2d.b2_aabbMultiplier*(0<d.x?d.x:-d.x);d=box2d.b2_aabbExtension+box2d.b2_aabbMultiplier*(0<d.y?d.y:-d.y);a.aabb.lowerBound.x=b.lowerBound.x-e;a.aabb.lowerBound.y=b.lowerBound.y-d;a.aabb.upperBound.x=b.upperBound.x+e;a.aabb.upperBound.y=b.upperBound.y+d;this.InsertLeaf(a);return!0};
goog.exportProperty(box2d.b2DynamicTree.prototype,"MoveProxy",box2d.b2DynamicTree.prototype.MoveProxy);
box2d.b2DynamicTree.prototype.InsertLeaf=function(a){++this.m_insertionCount;if(null===this.m_root)this.m_root=a,this.m_root.parent=null;else{var b=a.aabb;b.GetCenter();for(var d=this.m_root,e,f;!d.IsLeaf();){e=d.child1;f=d.child2;var g=d.aabb.GetPerimeter(),k=box2d.b2DynamicTree.s_combinedAABB;k.Combine2(d.aabb,b);var m=k.GetPerimeter(),k=2*m,m=2*(m-g),n=box2d.b2DynamicTree.s_aabb,q,s;e.IsLeaf()?(n.Combine2(b,e.aabb),g=n.GetPerimeter()+m):(n.Combine2(b,e.aabb),q=e.aabb.GetPerimeter(),s=n.GetPerimeter(),
g=s-q+m);f.IsLeaf()?(n.Combine2(b,f.aabb),m=n.GetPerimeter()+m):(n.Combine2(b,f.aabb),q=f.aabb.GetPerimeter(),s=n.GetPerimeter(),m=s-q+m);if(k<g&&k<m)break;d=g<m?e:f}e=d.parent;f=this.AllocateNode();f.parent=e;f.userData=null;f.aabb.Combine2(b,d.aabb);f.height=d.height+1;e?(e.child1===d?e.child1=f:e.child2=f,f.child1=d,f.child2=a,d.parent=f,a.parent=f):(f.child1=d,f.child2=a,d.parent=f,this.m_root=a.parent=f);for(d=a.parent;null!==d;)d=this.Balance(d),e=d.child1,f=d.child2,box2d.ENABLE_ASSERTS&&box2d.b2Assert(null!==
e),box2d.ENABLE_ASSERTS&&box2d.b2Assert(null!==f),d.height=1+box2d.b2Max(e.height,f.height),d.aabb.Combine2(e.aabb,f.aabb),d=d.parent}};goog.exportProperty(box2d.b2DynamicTree.prototype,"InsertLeaf",box2d.b2DynamicTree.prototype.InsertLeaf);
box2d.b2DynamicTree.prototype.RemoveLeaf=function(a){if(a===this.m_root)this.m_root=null;else{var b=a.parent,d=b.parent;a=b.child1===a?b.child2:b.child1;if(d)for(d.child1===b?d.child1=a:d.child2=a,a.parent=d,this.FreeNode(b),b=d;b;)b=this.Balance(b),d=b.child1,a=b.child2,b.aabb.Combine2(d.aabb,a.aabb),b.height=1+box2d.b2Max(d.height,a.height),b=b.parent;else this.m_root=a,a.parent=null,this.FreeNode(b)}};goog.exportProperty(box2d.b2DynamicTree.prototype,"RemoveLeaf",box2d.b2DynamicTree.prototype.RemoveLeaf);
box2d.b2DynamicTree.prototype.Balance=function(a){box2d.ENABLE_ASSERTS&&box2d.b2Assert(null!==a);if(a.IsLeaf()||2>a.height)return a;var b=a.child1,d=a.child2,e=d.height-b.height;if(1<e){var e=d.child1,f=d.child2;d.child1=a;d.parent=a.parent;a.parent=d;null!==d.parent?d.parent.child1===a?d.parent.child1=d:(box2d.ENABLE_ASSERTS&&box2d.b2Assert(d.parent.child2===a),d.parent.child2=d):this.m_root=d;e.height>f.height?(d.child2=e,a.child2=f,f.parent=a,a.aabb.Combine2(b.aabb,f.aabb),d.aabb.Combine2(a.aabb,
e.aabb),a.height=1+box2d.b2Max(b.height,f.height),d.height=1+box2d.b2Max(a.height,e.height)):(d.child2=f,a.child2=e,e.parent=a,a.aabb.Combine2(b.aabb,e.aabb),d.aabb.Combine2(a.aabb,f.aabb),a.height=1+box2d.b2Max(b.height,e.height),d.height=1+box2d.b2Max(a.height,f.height));return d}return-1>e?(e=b.child1,f=b.child2,b.child1=a,b.parent=a.parent,a.parent=b,null!==b.parent?b.parent.child1===a?b.parent.child1=b:(box2d.ENABLE_ASSERTS&&box2d.b2Assert(b.parent.child2===a),b.parent.child2=b):this.m_root=
b,e.height>f.height?(b.child2=e,a.child1=f,f.parent=a,a.aabb.Combine2(d.aabb,f.aabb),b.aabb.Combine2(a.aabb,e.aabb),a.height=1+box2d.b2Max(d.height,f.height),b.height=1+box2d.b2Max(a.height,e.height)):(b.child2=f,a.child1=e,e.parent=a,a.aabb.Combine2(d.aabb,e.aabb),b.aabb.Combine2(a.aabb,f.aabb),a.height=1+box2d.b2Max(d.height,e.height),b.height=1+box2d.b2Max(a.height,f.height)),b):a};goog.exportProperty(box2d.b2DynamicTree.prototype,"Balance",box2d.b2DynamicTree.prototype.Balance);
box2d.b2DynamicTree.prototype.GetHeight=function(){return null===this.m_root?0:this.m_root.height};goog.exportProperty(box2d.b2DynamicTree.prototype,"GetHeight",box2d.b2DynamicTree.prototype.GetHeight);box2d.b2DynamicTree.prototype.GetAreaRatio=function(){if(null===this.m_root)return 0;var a=this.m_root.aabb.GetPerimeter(),b=function(a){if(null===a||a.IsLeaf())return 0;var e=a.aabb.GetPerimeter(),e=e+b(a.child1);return e+b(a.child2)};return b(this.m_root)/a};
goog.exportProperty(box2d.b2DynamicTree.prototype,"GetAreaRatio",box2d.b2DynamicTree.prototype.GetAreaRatio);box2d.b2DynamicTree.prototype.ComputeHeightNode=function(a){if(a.IsLeaf())return 0;var b=this.ComputeHeightNode(a.child1);a=this.ComputeHeightNode(a.child2);return 1+box2d.b2Max(b,a)};goog.exportProperty(box2d.b2DynamicTree.prototype,"ComputeHeightNode",box2d.b2DynamicTree.prototype.ComputeHeightNode);box2d.b2DynamicTree.prototype.ComputeHeight=function(){return this.ComputeHeightNode(this.m_root)};
goog.exportProperty(box2d.b2DynamicTree.prototype,"ComputeHeight",box2d.b2DynamicTree.prototype.ComputeHeight);
box2d.b2DynamicTree.prototype.ValidateStructure=function(a){if(null!==a){a===this.m_root&&box2d.ENABLE_ASSERTS&&box2d.b2Assert(null===a.parent);var b=a.child1,d=a.child2;a.IsLeaf()?(box2d.ENABLE_ASSERTS&&box2d.b2Assert(null===b),box2d.ENABLE_ASSERTS&&box2d.b2Assert(null===d),box2d.ENABLE_ASSERTS&&box2d.b2Assert(0===a.height)):(box2d.ENABLE_ASSERTS&&box2d.b2Assert(b.parent===a),box2d.ENABLE_ASSERTS&&box2d.b2Assert(d.parent===a),this.ValidateStructure(b),this.ValidateStructure(d))}};
goog.exportProperty(box2d.b2DynamicTree.prototype,"ValidateStructure",box2d.b2DynamicTree.prototype.ValidateStructure);
box2d.b2DynamicTree.prototype.ValidateMetrics=function(a){if(null!==a){var b=a.child1,d=a.child2;if(a.IsLeaf())box2d.ENABLE_ASSERTS&&box2d.b2Assert(null===b),box2d.ENABLE_ASSERTS&&box2d.b2Assert(null===d),box2d.ENABLE_ASSERTS&&box2d.b2Assert(0===a.height);else{var e;e=1+box2d.b2Max(b.height,d.height);box2d.ENABLE_ASSERTS&&box2d.b2Assert(a.height===e);e=box2d.b2DynamicTree.s_aabb;e.Combine2(b.aabb,d.aabb);box2d.ENABLE_ASSERTS&&box2d.b2Assert(e.lowerBound===a.aabb.lowerBound);box2d.ENABLE_ASSERTS&&
box2d.b2Assert(e.upperBound===a.aabb.upperBound);this.ValidateMetrics(b);this.ValidateMetrics(d)}}};goog.exportProperty(box2d.b2DynamicTree.prototype,"ValidateMetrics",box2d.b2DynamicTree.prototype.ValidateMetrics);box2d.b2DynamicTree.prototype.Validate=function(){this.ValidateStructure(this.m_root);this.ValidateMetrics(this.m_root);for(var a=0,b=this.m_freeList;null!==b;)b=b.parent,++a;box2d.ENABLE_ASSERTS&&box2d.b2Assert(this.GetHeight()===this.ComputeHeight())};
goog.exportProperty(box2d.b2DynamicTree.prototype,"Validate",box2d.b2DynamicTree.prototype.Validate);box2d.b2DynamicTree.prototype.GetMaxBalance=function(){var a;a=this.m_root;null===a?a=0:1>=a.height?a=0:(box2d.ENABLE_ASSERTS&&box2d.b2Assert(!a.IsLeaf()),a=box2d.b2Abs(a.child2.height-a.child1.height),a=box2d.b2Max(0,a));return a};goog.exportProperty(box2d.b2DynamicTree.prototype,"GetMaxBalance",box2d.b2DynamicTree.prototype.GetMaxBalance);box2d.b2DynamicTree.prototype.RebuildBottomUp=function(){this.Validate()};
goog.exportProperty(box2d.b2DynamicTree.prototype,"RebuildBottomUp",box2d.b2DynamicTree.prototype.RebuildBottomUp);box2d.b2DynamicTree.prototype.ShiftOrigin=function(a){var b=function(a,e){if(null!==a&&!(1>=a.height)){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!a.IsLeaf());var f=a.child2;b(a.child1,e);b(f,e);a.aabb.lowerBound.SelfSub(e);a.aabb.upperBound.SelfSub(e)}};b(this.m_root,a)};goog.exportProperty(box2d.b2DynamicTree.prototype,"ShiftOrigin",box2d.b2DynamicTree.prototype.ShiftOrigin);
box2d.b2Pair=function(){};goog.exportSymbol("box2d.b2Pair",box2d.b2Pair);box2d.b2Pair.prototype.proxyA=null;goog.exportProperty(box2d.b2Pair.prototype,"proxyA",box2d.b2Pair.prototype.proxyA);box2d.b2Pair.prototype.proxyB=null;goog.exportProperty(box2d.b2Pair.prototype,"proxyB",box2d.b2Pair.prototype.proxyB);box2d.b2BroadPhase=function(){this.m_tree=new box2d.b2DynamicTree;this.m_moveBuffer=[];this.m_pairBuffer=[]};goog.exportSymbol("box2d.b2BroadPhase",box2d.b2BroadPhase);
box2d.b2BroadPhase.prototype.m_tree=null;goog.exportProperty(box2d.b2BroadPhase.prototype,"m_tree",box2d.b2BroadPhase.prototype.m_tree);box2d.b2BroadPhase.prototype.m_proxyCount=0;goog.exportProperty(box2d.b2BroadPhase.prototype,"m_proxyCount",box2d.b2BroadPhase.prototype.m_proxyCount);box2d.b2BroadPhase.prototype.m_moveCount=0;goog.exportProperty(box2d.b2BroadPhase.prototype,"m_moveCount",box2d.b2BroadPhase.prototype.m_moveCount);box2d.b2BroadPhase.prototype.m_moveBuffer=null;
goog.exportProperty(box2d.b2BroadPhase.prototype,"m_moveBuffer",box2d.b2BroadPhase.prototype.m_moveBuffer);box2d.b2BroadPhase.prototype.m_pairCount=0;goog.exportProperty(box2d.b2BroadPhase.prototype,"m_pairCount",box2d.b2BroadPhase.prototype.m_pairCount);box2d.b2BroadPhase.prototype.m_pairBuffer=null;goog.exportProperty(box2d.b2BroadPhase.prototype,"m_pairBuffer",box2d.b2BroadPhase.prototype.m_pairBuffer);
box2d.b2BroadPhase.prototype.CreateProxy=function(a,b){var d=this.m_tree.CreateProxy(a,b);++this.m_proxyCount;this.BufferMove(d);return d};goog.exportProperty(box2d.b2BroadPhase.prototype,"CreateProxy",box2d.b2BroadPhase.prototype.CreateProxy);box2d.b2BroadPhase.prototype.DestroyProxy=function(a){this.UnBufferMove(a);--this.m_proxyCount;this.m_tree.DestroyProxy(a)};goog.exportProperty(box2d.b2BroadPhase.prototype,"DestroyProxy",box2d.b2BroadPhase.prototype.DestroyProxy);
box2d.b2BroadPhase.prototype.MoveProxy=function(a,b,d){this.m_tree.MoveProxy(a,b,d)&&this.BufferMove(a)};goog.exportProperty(box2d.b2BroadPhase.prototype,"MoveProxy",box2d.b2BroadPhase.prototype.MoveProxy);box2d.b2BroadPhase.prototype.TouchProxy=function(a){this.BufferMove(a)};goog.exportProperty(box2d.b2BroadPhase.prototype,"TouchProxy",box2d.b2BroadPhase.prototype.TouchProxy);box2d.b2BroadPhase.prototype.GetFatAABB=function(a){return this.m_tree.GetFatAABB(a)};
goog.exportProperty(box2d.b2BroadPhase.prototype,"GetFatAABB",box2d.b2BroadPhase.prototype.GetFatAABB);box2d.b2BroadPhase.prototype.GetUserData=function(a){return this.m_tree.GetUserData(a)};goog.exportProperty(box2d.b2BroadPhase.prototype,"GetUserData",box2d.b2BroadPhase.prototype.GetUserData);box2d.b2BroadPhase.prototype.TestOverlap=function(a,b){var d=this.m_tree.GetFatAABB(a),e=this.m_tree.GetFatAABB(b);return box2d.b2TestOverlap_AABB(d,e)};
goog.exportProperty(box2d.b2BroadPhase.prototype,"TestOverlap",box2d.b2BroadPhase.prototype.TestOverlap);box2d.b2BroadPhase.prototype.GetProxyCount=function(){return this.m_proxyCount};goog.exportProperty(box2d.b2BroadPhase.prototype,"GetProxyCount",box2d.b2BroadPhase.prototype.GetProxyCount);box2d.b2BroadPhase.prototype.GetTreeHeight=function(){return this.m_tree.GetHeight()};goog.exportProperty(box2d.b2BroadPhase.prototype,"GetTreeHeight",box2d.b2BroadPhase.prototype.GetTreeHeight);
box2d.b2BroadPhase.prototype.GetTreeBalance=function(){return this.m_tree.GetMaxBalance()};goog.exportProperty(box2d.b2BroadPhase.prototype,"GetTreeBalance",box2d.b2BroadPhase.prototype.GetTreeBalance);box2d.b2BroadPhase.prototype.GetTreeQuality=function(){return this.m_tree.GetAreaRatio()};goog.exportProperty(box2d.b2BroadPhase.prototype,"GetTreeQuality",box2d.b2BroadPhase.prototype.GetTreeQuality);box2d.b2BroadPhase.prototype.ShiftOrigin=function(a){this.m_tree.ShiftOrigin(a)};
goog.exportProperty(box2d.b2BroadPhase.prototype,"ShiftOrigin",box2d.b2BroadPhase.prototype.ShiftOrigin);
box2d.b2BroadPhase.prototype.UpdatePairs=function(a){for(var b=this.m_pairCount=0;b<this.m_moveCount;++b){var d=this.m_moveBuffer[b];if(null!==d){var e=this,f=this.m_tree.GetFatAABB(d);this.m_tree.Query(function(a){if(a.m_id===d.m_id)return!0;e.m_pairCount===e.m_pairBuffer.length&&(e.m_pairBuffer[e.m_pairCount]=new box2d.b2Pair);var b=e.m_pairBuffer[e.m_pairCount];a.m_id<d.m_id?(b.proxyA=a,b.proxyB=d):(b.proxyA=d,b.proxyB=a);++e.m_pairCount;return!0},f)}}this.m_moveCount=0;this.m_pairBuffer.length=
this.m_pairCount;this.m_pairBuffer.sort(box2d.b2PairLessThan);for(b=0;b<this.m_pairCount;){var f=this.m_pairBuffer[b],g=this.m_tree.GetUserData(f.proxyA),k=this.m_tree.GetUserData(f.proxyB);a.AddPair(g,k);for(++b;b<this.m_pairCount;){g=this.m_pairBuffer[b];if(g.proxyA.m_id!==f.proxyA.m_id||g.proxyB.m_id!==f.proxyB.m_id)break;++b}}};goog.exportProperty(box2d.b2BroadPhase.prototype,"UpdatePairs",box2d.b2BroadPhase.prototype.UpdatePairs);
box2d.b2BroadPhase.prototype.Query=function(a,b){this.m_tree.Query(a,b)};goog.exportProperty(box2d.b2BroadPhase.prototype,"Query",box2d.b2BroadPhase.prototype.Query);box2d.b2BroadPhase.prototype.RayCast=function(a,b){this.m_tree.RayCast(a,b)};goog.exportProperty(box2d.b2BroadPhase.prototype,"RayCast",box2d.b2BroadPhase.prototype.RayCast);box2d.b2BroadPhase.prototype.BufferMove=function(a){this.m_moveBuffer[this.m_moveCount]=a;++this.m_moveCount};
goog.exportProperty(box2d.b2BroadPhase.prototype,"BufferMove",box2d.b2BroadPhase.prototype.BufferMove);box2d.b2BroadPhase.prototype.UnBufferMove=function(a){a=this.m_moveBuffer.indexOf(a);this.m_moveBuffer[a]=null};goog.exportProperty(box2d.b2BroadPhase.prototype,"UnBufferMove",box2d.b2BroadPhase.prototype.UnBufferMove);box2d.b2PairLessThan=function(a,b){return a.proxyA.m_id===b.proxyA.m_id?a.proxyB.m_id-b.proxyB.m_id:a.proxyA.m_id-b.proxyA.m_id};
box2d.b2MassData=function(){this.center=new box2d.b2Vec2(0,0)};goog.exportSymbol("box2d.b2MassData",box2d.b2MassData);box2d.b2MassData.prototype.mass=0;goog.exportProperty(box2d.b2MassData.prototype,"mass",box2d.b2MassData.prototype.mass);box2d.b2MassData.prototype.center=null;goog.exportProperty(box2d.b2MassData.prototype,"center",box2d.b2MassData.prototype.center);box2d.b2MassData.prototype.I=0;goog.exportProperty(box2d.b2MassData.prototype,"I",box2d.b2MassData.prototype.I);
box2d.b2ShapeType={e_unknown:-1,e_circleShape:0,e_edgeShape:1,e_polygonShape:2,e_chainShape:3,e_shapeTypeCount:4};goog.exportSymbol("box2d.b2ShapeType",box2d.b2ShapeType);goog.exportProperty(box2d.b2ShapeType,"e_unknown",box2d.b2ShapeType.e_unknown);goog.exportProperty(box2d.b2ShapeType,"e_circleShape",box2d.b2ShapeType.e_circleShape);goog.exportProperty(box2d.b2ShapeType,"e_edgeShape",box2d.b2ShapeType.e_edgeShape);goog.exportProperty(box2d.b2ShapeType,"e_polygonShape",box2d.b2ShapeType.e_polygonShape);
goog.exportProperty(box2d.b2ShapeType,"e_chainShape",box2d.b2ShapeType.e_chainShape);goog.exportProperty(box2d.b2ShapeType,"e_shapeTypeCount",box2d.b2ShapeType.e_shapeTypeCount);box2d.b2Shape=function(a,b){this.m_type=a;this.m_radius=b};goog.exportSymbol("box2d.b2Shape",box2d.b2Shape);box2d.b2Shape.prototype.m_type=box2d.b2ShapeType.e_unknown;goog.exportProperty(box2d.b2Shape.prototype,"m_type",box2d.b2Shape.prototype.m_type);box2d.b2Shape.prototype.m_radius=0;
goog.exportProperty(box2d.b2Shape.prototype,"m_radius",box2d.b2Shape.prototype.m_radius);box2d.b2Shape.prototype.Clone=function(){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1);return null};goog.exportProperty(box2d.b2Shape.prototype,"Clone",box2d.b2Shape.prototype.Clone);box2d.b2Shape.prototype.Copy=function(a){box2d.ENABLE_ASSERTS&&box2d.b2Assert(this.m_type===a.m_type);this.m_radius=a.m_radius;return this};goog.exportProperty(box2d.b2Shape.prototype,"Copy",box2d.b2Shape.prototype.Copy);
box2d.b2Shape.prototype.GetType=function(){return this.m_type};goog.exportProperty(box2d.b2Shape.prototype,"GetType",box2d.b2Shape.prototype.GetType);box2d.b2Shape.prototype.GetChildCount=function(){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1,"pure virtual");return 0};goog.exportProperty(box2d.b2Shape.prototype,"GetChildCount",box2d.b2Shape.prototype.GetChildCount);box2d.b2Shape.prototype.TestPoint=function(a,b){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1,"pure virtual");return!1};
goog.exportProperty(box2d.b2Shape.prototype,"TestPoint",box2d.b2Shape.prototype.TestPoint);box2d.b2Shape.prototype.ComputeDistance=function(a,b,d,e){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1,"pure virtual");return 0};goog.exportProperty(box2d.b2Shape.prototype,"ComputeDistance",box2d.b2Shape.prototype.ComputeDistance);box2d.b2Shape.prototype.RayCast=function(a,b,d,e){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1,"pure virtual");return!1};goog.exportProperty(box2d.b2Shape.prototype,"RayCast",box2d.b2Shape.prototype.RayCast);
box2d.b2Shape.prototype.ComputeAABB=function(a,b,d){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1,"pure virtual")};goog.exportProperty(box2d.b2Shape.prototype,"ComputeAABB",box2d.b2Shape.prototype.ComputeAABB);box2d.b2Shape.prototype.ComputeMass=function(a,b){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1,"pure virtual")};goog.exportProperty(box2d.b2Shape.prototype,"ComputeMass",box2d.b2Shape.prototype.ComputeMass);
box2d.b2Shape.prototype.SetupDistanceProxy=function(a,b){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1,"pure virtual")};box2d.b2Shape.prototype.ComputeSubmergedArea=function(a,b,d,e){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1,"pure virtual");return 0};goog.exportProperty(box2d.b2Shape.prototype,"ComputeSubmergedArea",box2d.b2Shape.prototype.ComputeSubmergedArea);box2d.b2Shape.prototype.Dump=function(){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1,"pure virtual")};
goog.exportProperty(box2d.b2Shape.prototype,"Dump",box2d.b2Shape.prototype.Dump);box2d.b2CircleShape=function(a){box2d.b2Shape.call(this,box2d.b2ShapeType.e_circleShape,a||0);this.m_p=new box2d.b2Vec2};goog.inherits(box2d.b2CircleShape,box2d.b2Shape);goog.exportSymbol("box2d.b2CircleShape",box2d.b2CircleShape);box2d.b2CircleShape.prototype.m_p=null;goog.exportProperty(box2d.b2CircleShape.prototype,"m_p",box2d.b2CircleShape.prototype.m_p);box2d.b2CircleShape.prototype.Clone=function(){return(new box2d.b2CircleShape).Copy(this)};
goog.exportProperty(box2d.b2CircleShape.prototype,"Clone",box2d.b2CircleShape.prototype.Clone);box2d.b2CircleShape.prototype.Copy=function(a){box2d.b2Shape.prototype.Copy.call(this,a);box2d.ENABLE_ASSERTS&&box2d.b2Assert(a instanceof box2d.b2CircleShape);this.m_p.Copy(a.m_p);return this};goog.exportProperty(box2d.b2CircleShape.prototype,"Copy",box2d.b2CircleShape.prototype.Copy);box2d.b2CircleShape.prototype.GetChildCount=function(){return 1};
goog.exportProperty(box2d.b2CircleShape.prototype,"GetChildCount",box2d.b2CircleShape.prototype.GetChildCount);box2d.b2CircleShape.prototype.TestPoint=function(a,b){var d=box2d.b2Mul_X_V2(a,this.m_p,box2d.b2CircleShape.prototype.TestPoint.s_center),d=box2d.b2Sub_V2_V2(b,d,box2d.b2CircleShape.prototype.TestPoint.s_d);return box2d.b2Dot_V2_V2(d,d)<=box2d.b2Sq(this.m_radius)};goog.exportProperty(box2d.b2CircleShape.prototype,"TestPoint",box2d.b2CircleShape.prototype.TestPoint);
box2d.b2CircleShape.prototype.TestPoint.s_center=new box2d.b2Vec2;box2d.b2CircleShape.prototype.TestPoint.s_d=new box2d.b2Vec2;box2d.b2CircleShape.prototype.ComputeDistance=function(a,b,d,e){a=box2d.b2Mul_X_V2(a,this.m_p,box2d.b2CircleShape.prototype.ComputeDistance.s_center);box2d.b2Sub_V2_V2(b,a,d);return d.Normalize()-this.m_radius};goog.exportProperty(box2d.b2CircleShape.prototype,"ComputeDistance",box2d.b2CircleShape.prototype.ComputeDistance);
box2d.b2CircleShape.prototype.ComputeDistance.s_center=new box2d.b2Vec2;
box2d.b2CircleShape.prototype.RayCast=function(a,b,d,e){d=box2d.b2Mul_X_V2(d,this.m_p,box2d.b2CircleShape.prototype.RayCast.s_position);d=box2d.b2Sub_V2_V2(b.p1,d,box2d.b2CircleShape.prototype.RayCast.s_s);var f=box2d.b2Dot_V2_V2(d,d)-box2d.b2Sq(this.m_radius);e=box2d.b2Sub_V2_V2(b.p2,b.p1,box2d.b2CircleShape.prototype.RayCast.s_r);var g=box2d.b2Dot_V2_V2(d,e),k=box2d.b2Dot_V2_V2(e,e),f=g*g-k*f;if(0>f||k<box2d.b2_epsilon)return!1;g=-(g+box2d.b2Sqrt(f));return 0<=g&&g<=b.maxFraction*k?(g/=k,a.fraction=
g,box2d.b2AddMul_V2_S_V2(d,g,e,a.normal).SelfNormalize(),!0):!1};goog.exportProperty(box2d.b2CircleShape.prototype,"RayCast",box2d.b2CircleShape.prototype.RayCast);box2d.b2CircleShape.prototype.RayCast.s_position=new box2d.b2Vec2;box2d.b2CircleShape.prototype.RayCast.s_s=new box2d.b2Vec2;box2d.b2CircleShape.prototype.RayCast.s_r=new box2d.b2Vec2;
box2d.b2CircleShape.prototype.ComputeAABB=function(a,b,d){b=box2d.b2Mul_X_V2(b,this.m_p,box2d.b2CircleShape.prototype.ComputeAABB.s_p);a.lowerBound.Set(b.x-this.m_radius,b.y-this.m_radius);a.upperBound.Set(b.x+this.m_radius,b.y+this.m_radius)};goog.exportProperty(box2d.b2CircleShape.prototype,"ComputeAABB",box2d.b2CircleShape.prototype.ComputeAABB);box2d.b2CircleShape.prototype.ComputeAABB.s_p=new box2d.b2Vec2;
box2d.b2CircleShape.prototype.ComputeMass=function(a,b){var d=box2d.b2Sq(this.m_radius);a.mass=b*box2d.b2_pi*d;a.center.Copy(this.m_p);a.I=a.mass*(.5*d+box2d.b2Dot_V2_V2(this.m_p,this.m_p))};goog.exportProperty(box2d.b2CircleShape.prototype,"ComputeMass",box2d.b2CircleShape.prototype.ComputeMass);box2d.b2CircleShape.prototype.SetupDistanceProxy=function(a,b){a.m_vertices=a.m_buffer;a.m_vertices[0].Copy(this.m_p);a.m_count=1;a.m_radius=this.m_radius};
box2d.b2CircleShape.prototype.ComputeSubmergedArea=function(a,b,d,e){d=box2d.b2Mul_X_V2(d,this.m_p,new box2d.b2Vec2);var f=-(box2d.b2Dot_V2_V2(a,d)-b);if(f<-this.m_radius+box2d.b2_epsilon)return 0;if(f>this.m_radius)return e.Copy(d),box2d.b2_pi*this.m_radius*this.m_radius;b=this.m_radius*this.m_radius;var g=f*f,f=b*(box2d.b2Asin(f/this.m_radius)+box2d.b2_pi/2)+f*box2d.b2Sqrt(b-g);b=-2/3*box2d.b2Pow(b-g,1.5)/f;e.x=d.x+a.x*b;e.y=d.y+a.y*b;return f};
goog.exportProperty(box2d.b2CircleShape.prototype,"ComputeSubmergedArea",box2d.b2CircleShape.prototype.ComputeSubmergedArea);box2d.b2CircleShape.prototype.Dump=function(){box2d.b2Log("    /*box2d.b2CircleShape*/ var shape = new box2d.b2CircleShape();\n");box2d.b2Log("    shape.m_radius = %.15f;\n",this.m_radius);box2d.b2Log("    shape.m_p.Set(%.15f, %.15f);\n",this.m_p.x,this.m_p.y)};goog.exportProperty(box2d.b2CircleShape.prototype,"Dump",box2d.b2CircleShape.prototype.Dump);
box2d.b2EdgeShape=function(){box2d.b2Shape.call(this,box2d.b2ShapeType.e_edgeShape,box2d.b2_polygonRadius);this.m_vertex1=new box2d.b2Vec2;this.m_vertex2=new box2d.b2Vec2;this.m_vertex0=new box2d.b2Vec2;this.m_vertex3=new box2d.b2Vec2};goog.inherits(box2d.b2EdgeShape,box2d.b2Shape);goog.exportSymbol("box2d.b2EdgeShape",box2d.b2EdgeShape);box2d.b2EdgeShape.prototype.m_vertex1=null;goog.exportProperty(box2d.b2EdgeShape.prototype,"m_vertex1",box2d.b2EdgeShape.prototype.m_vertex1);
box2d.b2EdgeShape.prototype.m_vertex2=null;goog.exportProperty(box2d.b2EdgeShape.prototype,"m_vertex2",box2d.b2EdgeShape.prototype.m_vertex2);box2d.b2EdgeShape.prototype.m_vertex0=null;goog.exportProperty(box2d.b2EdgeShape.prototype,"m_vertex0",box2d.b2EdgeShape.prototype.m_vertex0);box2d.b2EdgeShape.prototype.m_vertex3=null;goog.exportProperty(box2d.b2EdgeShape.prototype,"m_vertex3",box2d.b2EdgeShape.prototype.m_vertex3);box2d.b2EdgeShape.prototype.m_hasVertex0=!1;
goog.exportProperty(box2d.b2EdgeShape.prototype,"m_hasVertex0",box2d.b2EdgeShape.prototype.m_hasVertex0);box2d.b2EdgeShape.prototype.m_hasVertex3=!1;goog.exportProperty(box2d.b2EdgeShape.prototype,"m_hasVertex3",box2d.b2EdgeShape.prototype.m_hasVertex3);box2d.b2EdgeShape.prototype.Set=function(a,b){this.m_vertex1.Copy(a);this.m_vertex2.Copy(b);this.m_hasVertex3=this.m_hasVertex0=!1;return this};goog.exportProperty(box2d.b2EdgeShape.prototype,"Set",box2d.b2EdgeShape.prototype.Set);
box2d.b2EdgeShape.prototype.SetAsEdge=box2d.b2EdgeShape.prototype.Set;box2d.b2EdgeShape.prototype.Clone=function(){return(new box2d.b2EdgeShape).Copy(this)};goog.exportProperty(box2d.b2EdgeShape.prototype,"Clone",box2d.b2EdgeShape.prototype.Clone);
box2d.b2EdgeShape.prototype.Copy=function(a){box2d.b2Shape.prototype.Copy.call(this,a);box2d.ENABLE_ASSERTS&&box2d.b2Assert(a instanceof box2d.b2EdgeShape);this.m_vertex1.Copy(a.m_vertex1);this.m_vertex2.Copy(a.m_vertex2);this.m_vertex0.Copy(a.m_vertex0);this.m_vertex3.Copy(a.m_vertex3);this.m_hasVertex0=a.m_hasVertex0;this.m_hasVertex3=a.m_hasVertex3;return this};goog.exportProperty(box2d.b2EdgeShape.prototype,"Copy",box2d.b2EdgeShape.prototype.Copy);box2d.b2EdgeShape.prototype.GetChildCount=function(){return 1};
goog.exportProperty(box2d.b2EdgeShape.prototype,"GetChildCount",box2d.b2EdgeShape.prototype.GetChildCount);box2d.b2EdgeShape.prototype.TestPoint=function(a,b){return!1};goog.exportProperty(box2d.b2EdgeShape.prototype,"TestPoint",box2d.b2EdgeShape.prototype.TestPoint);
box2d.b2EdgeShape.prototype.ComputeDistance=function(a,b,d,e){var f=box2d.b2Mul_X_V2(a,this.m_vertex1,box2d.b2EdgeShape.prototype.ComputeDistance.s_v1);a=box2d.b2Mul_X_V2(a,this.m_vertex2,box2d.b2EdgeShape.prototype.ComputeDistance.s_v2);e=box2d.b2Sub_V2_V2(b,f,box2d.b2EdgeShape.prototype.ComputeDistance.s_d);var f=box2d.b2Sub_V2_V2(a,f,box2d.b2EdgeShape.prototype.ComputeDistance.s_s),g=box2d.b2Dot_V2_V2(e,f);if(0<g){var k=box2d.b2Dot_V2_V2(f,f);g>k?box2d.b2Sub_V2_V2(b,a,e):e.SelfMulSub(g/k,f)}d.Copy(e);
return d.Normalize()};goog.exportProperty(box2d.b2EdgeShape.prototype,"ComputeDistance",box2d.b2EdgeShape.prototype.ComputeDistance);box2d.b2EdgeShape.prototype.ComputeDistance.s_v1=new box2d.b2Vec2;box2d.b2EdgeShape.prototype.ComputeDistance.s_v2=new box2d.b2Vec2;box2d.b2EdgeShape.prototype.ComputeDistance.s_d=new box2d.b2Vec2;box2d.b2EdgeShape.prototype.ComputeDistance.s_s=new box2d.b2Vec2;
box2d.b2EdgeShape.prototype.RayCast=function(a,b,d,e){var f=box2d.b2MulT_X_V2(d,b.p1,box2d.b2EdgeShape.prototype.RayCast.s_p1);e=box2d.b2MulT_X_V2(d,b.p2,box2d.b2EdgeShape.prototype.RayCast.s_p2);var g=box2d.b2Sub_V2_V2(e,f,box2d.b2EdgeShape.prototype.RayCast.s_d);e=this.m_vertex1;var k=this.m_vertex2,m=box2d.b2Sub_V2_V2(k,e,box2d.b2EdgeShape.prototype.RayCast.s_e),n=a.normal.Set(m.y,-m.x).SelfNormalize(),m=box2d.b2Dot_V2_V2(n,box2d.b2Sub_V2_V2(e,f,box2d.b2Vec2.s_t0)),n=box2d.b2Dot_V2_V2(n,g);if(0===
n)return!1;n=m/n;if(0>n||b.maxFraction<n)return!1;b=box2d.b2AddMul_V2_S_V2(f,n,g,box2d.b2EdgeShape.prototype.RayCast.s_q);f=box2d.b2Sub_V2_V2(k,e,box2d.b2EdgeShape.prototype.RayCast.s_r);k=box2d.b2Dot_V2_V2(f,f);if(0===k)return!1;e=box2d.b2Dot_V2_V2(box2d.b2Sub_V2_V2(b,e,box2d.b2Vec2.s_t0),f)/k;if(0>e||1<e)return!1;a.fraction=n;box2d.b2Mul_R_V2(d.q,a.normal,a.normal);0<m&&a.normal.SelfNeg();return!0};goog.exportProperty(box2d.b2EdgeShape.prototype,"RayCast",box2d.b2EdgeShape.prototype.RayCast);
box2d.b2EdgeShape.prototype.RayCast.s_p1=new box2d.b2Vec2;box2d.b2EdgeShape.prototype.RayCast.s_p2=new box2d.b2Vec2;box2d.b2EdgeShape.prototype.RayCast.s_d=new box2d.b2Vec2;box2d.b2EdgeShape.prototype.RayCast.s_e=new box2d.b2Vec2;box2d.b2EdgeShape.prototype.RayCast.s_q=new box2d.b2Vec2;box2d.b2EdgeShape.prototype.RayCast.s_r=new box2d.b2Vec2;
box2d.b2EdgeShape.prototype.ComputeAABB=function(a,b,d){d=box2d.b2Mul_X_V2(b,this.m_vertex1,box2d.b2EdgeShape.prototype.ComputeAABB.s_v1);b=box2d.b2Mul_X_V2(b,this.m_vertex2,box2d.b2EdgeShape.prototype.ComputeAABB.s_v2);box2d.b2Min_V2_V2(d,b,a.lowerBound);box2d.b2Max_V2_V2(d,b,a.upperBound);b=this.m_radius;a.lowerBound.SelfSubXY(b,b);a.upperBound.SelfAddXY(b,b)};goog.exportProperty(box2d.b2EdgeShape.prototype,"ComputeAABB",box2d.b2EdgeShape.prototype.ComputeAABB);
box2d.b2EdgeShape.prototype.ComputeAABB.s_v1=new box2d.b2Vec2;box2d.b2EdgeShape.prototype.ComputeAABB.s_v2=new box2d.b2Vec2;box2d.b2EdgeShape.prototype.ComputeMass=function(a,b){a.mass=0;box2d.b2Mid_V2_V2(this.m_vertex1,this.m_vertex2,a.center);a.I=0};goog.exportProperty(box2d.b2EdgeShape.prototype,"ComputeMass",box2d.b2EdgeShape.prototype.ComputeMass);
box2d.b2EdgeShape.prototype.SetupDistanceProxy=function(a,b){a.m_vertices=a.m_buffer;a.m_vertices[0].Copy(this.m_vertex1);a.m_vertices[1].Copy(this.m_vertex2);a.m_count=2;a.m_radius=this.m_radius};box2d.b2EdgeShape.prototype.ComputeSubmergedArea=function(a,b,d,e){e.SetZero();return 0};goog.exportProperty(box2d.b2EdgeShape.prototype,"ComputeSubmergedArea",box2d.b2EdgeShape.prototype.ComputeSubmergedArea);
box2d.b2EdgeShape.prototype.Dump=function(){box2d.b2Log("    /*box2d.b2EdgeShape*/ var shape = new box2d.b2EdgeShape();\n");box2d.b2Log("    shape.m_radius = %.15f;\n",this.m_radius);box2d.b2Log("    shape.m_vertex0.Set(%.15f, %.15f);\n",this.m_vertex0.x,this.m_vertex0.y);box2d.b2Log("    shape.m_vertex1.Set(%.15f, %.15f);\n",this.m_vertex1.x,this.m_vertex1.y);box2d.b2Log("    shape.m_vertex2.Set(%.15f, %.15f);\n",this.m_vertex2.x,this.m_vertex2.y);box2d.b2Log("    shape.m_vertex3.Set(%.15f, %.15f);\n",
this.m_vertex3.x,this.m_vertex3.y);box2d.b2Log("    shape.m_hasVertex0 = %s;\n",this.m_hasVertex0);box2d.b2Log("    shape.m_hasVertex3 = %s;\n",this.m_hasVertex3)};goog.exportProperty(box2d.b2EdgeShape.prototype,"Dump",box2d.b2EdgeShape.prototype.Dump);box2d.b2ChainShape=function(){box2d.b2Shape.call(this,box2d.b2ShapeType.e_chainShape,box2d.b2_polygonRadius);this.m_prevVertex=new box2d.b2Vec2;this.m_nextVertex=new box2d.b2Vec2};goog.inherits(box2d.b2ChainShape,box2d.b2Shape);
goog.exportSymbol("box2d.b2ChainShape",box2d.b2ChainShape);box2d.b2ChainShape.prototype.m_vertices=null;goog.exportProperty(box2d.b2ChainShape.prototype,"m_vertices",box2d.b2ChainShape.prototype.m_vertices);box2d.b2ChainShape.prototype.m_count=0;goog.exportProperty(box2d.b2ChainShape.prototype,"m_count",box2d.b2ChainShape.prototype.m_count);box2d.b2ChainShape.prototype.m_prevVertex=null;goog.exportProperty(box2d.b2ChainShape.prototype,"m_prevVertex",box2d.b2ChainShape.prototype.m_prevVertex);
box2d.b2ChainShape.prototype.m_nextVertex=null;goog.exportProperty(box2d.b2ChainShape.prototype,"m_nextVertex",box2d.b2ChainShape.prototype.m_nextVertex);box2d.b2ChainShape.prototype.m_hasPrevVertex=!1;goog.exportProperty(box2d.b2ChainShape.prototype,"m_hasPrevVertex",box2d.b2ChainShape.prototype.m_hasPrevVertex);box2d.b2ChainShape.prototype.m_hasNextVertex=!1;goog.exportProperty(box2d.b2ChainShape.prototype,"m_hasNextVertex",box2d.b2ChainShape.prototype.m_hasNextVertex);
box2d.b2ChainShape.prototype.Clear=function(){this.m_vertices=null;this.m_count=0};goog.exportProperty(box2d.b2ChainShape.prototype,"Clear",box2d.b2ChainShape.prototype.Clear);
box2d.b2ChainShape.prototype.CreateLoop=function(a,b){b=b||a.length;box2d.ENABLE_ASSERTS&&box2d.b2Assert(null===this.m_vertices&&0===this.m_count);box2d.ENABLE_ASSERTS&&box2d.b2Assert(3<=b);if(box2d.ENABLE_ASSERTS)for(var d=1;d<b;++d)box2d.b2Assert(box2d.b2DistanceSquared(a[d-1],a[d])>box2d.b2_linearSlop*box2d.b2_linearSlop);this.m_count=b+1;this.m_vertices=box2d.b2Vec2.MakeArray(this.m_count);for(d=0;d<b;++d)this.m_vertices[d].Copy(a[d]);this.m_vertices[b].Copy(this.m_vertices[0]);this.m_prevVertex.Copy(this.m_vertices[this.m_count-
2]);this.m_nextVertex.Copy(this.m_vertices[1]);this.m_hasNextVertex=this.m_hasPrevVertex=!0;return this};goog.exportProperty(box2d.b2ChainShape.prototype,"CreateLoop",box2d.b2ChainShape.prototype.CreateLoop);
box2d.b2ChainShape.prototype.CreateChain=function(a,b){b=b||a.length;box2d.ENABLE_ASSERTS&&box2d.b2Assert(null===this.m_vertices&&0===this.m_count);box2d.ENABLE_ASSERTS&&box2d.b2Assert(2<=b);if(box2d.ENABLE_ASSERTS)for(var d=1;d<b;++d)box2d.b2Assert(box2d.b2DistanceSquared(a[d-1],a[d])>box2d.b2_linearSlop*box2d.b2_linearSlop);this.m_count=b;this.m_vertices=box2d.b2Vec2.MakeArray(b);for(d=0;d<b;++d)this.m_vertices[d].Copy(a[d]);this.m_hasNextVertex=this.m_hasPrevVertex=!1;this.m_prevVertex.SetZero();
this.m_nextVertex.SetZero();return this};goog.exportProperty(box2d.b2ChainShape.prototype,"CreateChain",box2d.b2ChainShape.prototype.CreateChain);box2d.b2ChainShape.prototype.SetPrevVertex=function(a){this.m_prevVertex.Copy(a);this.m_hasPrevVertex=!0;return this};goog.exportProperty(box2d.b2ChainShape.prototype,"SetPrevVertex",box2d.b2ChainShape.prototype.SetPrevVertex);box2d.b2ChainShape.prototype.SetNextVertex=function(a){this.m_nextVertex.Copy(a);this.m_hasNextVertex=!0;return this};
goog.exportProperty(box2d.b2ChainShape.prototype,"SetNextVertex",box2d.b2ChainShape.prototype.SetNextVertex);box2d.b2ChainShape.prototype.Clone=function(){return(new box2d.b2ChainShape).Copy(this)};goog.exportProperty(box2d.b2ChainShape.prototype,"Clone",box2d.b2ChainShape.prototype.Clone);
box2d.b2ChainShape.prototype.Copy=function(a){box2d.b2Shape.prototype.Copy.call(this,a);box2d.ENABLE_ASSERTS&&box2d.b2Assert(a instanceof box2d.b2ChainShape);this.CreateChain(a.m_vertices,a.m_count);this.m_prevVertex.Copy(a.m_prevVertex);this.m_nextVertex.Copy(a.m_nextVertex);this.m_hasPrevVertex=a.m_hasPrevVertex;this.m_hasNextVertex=a.m_hasNextVertex;return this};goog.exportProperty(box2d.b2ChainShape.prototype,"Copy",box2d.b2ChainShape.prototype.Copy);
box2d.b2ChainShape.prototype.GetChildCount=function(){return this.m_count-1};goog.exportProperty(box2d.b2ChainShape.prototype,"GetChildCount",box2d.b2ChainShape.prototype.GetChildCount);
box2d.b2ChainShape.prototype.GetChildEdge=function(a,b){box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<=b&&b<this.m_count-1);a.m_type=box2d.b2ShapeType.e_edgeShape;a.m_radius=this.m_radius;a.m_vertex1.Copy(this.m_vertices[b]);a.m_vertex2.Copy(this.m_vertices[b+1]);0<b?(a.m_vertex0.Copy(this.m_vertices[b-1]),a.m_hasVertex0=!0):(a.m_vertex0.Copy(this.m_prevVertex),a.m_hasVertex0=this.m_hasPrevVertex);b<this.m_count-2?(a.m_vertex3.Copy(this.m_vertices[b+2]),a.m_hasVertex3=!0):(a.m_vertex3.Copy(this.m_nextVertex),
a.m_hasVertex3=this.m_hasNextVertex)};goog.exportProperty(box2d.b2ChainShape.prototype,"GetChildEdge",box2d.b2ChainShape.prototype.GetChildEdge);box2d.b2ChainShape.prototype.TestPoint=function(a,b){return!1};goog.exportProperty(box2d.b2ChainShape.prototype,"TestPoint",box2d.b2ChainShape.prototype.TestPoint);box2d.b2ChainShape.prototype.ComputeDistance=function(a,b,d,e){var f=box2d.b2ChainShape.prototype.ComputeDistance.s_edgeShape;this.GetChildEdge(f,e);return f.ComputeDistance(a,b,d,0)};
goog.exportProperty(box2d.b2ChainShape.prototype,"ComputeDistance",box2d.b2ChainShape.prototype.ComputeDistance);box2d.b2ChainShape.prototype.ComputeDistance.s_edgeShape=new box2d.b2EdgeShape;box2d.b2ChainShape.prototype.RayCast=function(a,b,d,e){box2d.ENABLE_ASSERTS&&box2d.b2Assert(e<this.m_count);var f=box2d.b2ChainShape.prototype.RayCast.s_edgeShape;f.m_vertex1.Copy(this.m_vertices[e]);f.m_vertex2.Copy(this.m_vertices[(e+1)%this.m_count]);return f.RayCast(a,b,d,0)};
goog.exportProperty(box2d.b2ChainShape.prototype,"RayCast",box2d.b2ChainShape.prototype.RayCast);box2d.b2ChainShape.prototype.RayCast.s_edgeShape=new box2d.b2EdgeShape;
box2d.b2ChainShape.prototype.ComputeAABB=function(a,b,d){box2d.ENABLE_ASSERTS&&box2d.b2Assert(d<this.m_count);var e=this.m_vertices[(d+1)%this.m_count];d=box2d.b2Mul_X_V2(b,this.m_vertices[d],box2d.b2ChainShape.prototype.ComputeAABB.s_v1);b=box2d.b2Mul_X_V2(b,e,box2d.b2ChainShape.prototype.ComputeAABB.s_v2);box2d.b2Min_V2_V2(d,b,a.lowerBound);box2d.b2Max_V2_V2(d,b,a.upperBound)};goog.exportProperty(box2d.b2ChainShape.prototype,"ComputeAABB",box2d.b2ChainShape.prototype.ComputeAABB);
box2d.b2ChainShape.prototype.ComputeAABB.s_v1=new box2d.b2Vec2;goog.exportProperty(box2d.b2ChainShape.prototype.ComputeAABB,"s_v1",box2d.b2ChainShape.prototype.ComputeAABB.s_v1);box2d.b2ChainShape.prototype.ComputeAABB.s_v2=new box2d.b2Vec2;goog.exportProperty(box2d.b2ChainShape.prototype.ComputeAABB,"s_v2",box2d.b2ChainShape.prototype.ComputeAABB.s_v2);box2d.b2ChainShape.prototype.ComputeMass=function(a,b){a.mass=0;a.center.SetZero();a.I=0};
goog.exportProperty(box2d.b2ChainShape.prototype,"ComputeMass",box2d.b2ChainShape.prototype.ComputeMass);box2d.b2ChainShape.prototype.SetupDistanceProxy=function(a,b){box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<=b&&b<this.m_count);a.m_buffer[0].Copy(this.m_vertices[b]);b+1<this.m_count?a.m_buffer[1].Copy(this.m_vertices[b+1]):a.m_buffer[1].Copy(this.m_vertices[0]);a.m_vertices=a.m_buffer;a.m_count=2;a.m_radius=this.m_radius};
box2d.b2ChainShape.prototype.ComputeSubmergedArea=function(a,b,d,e){e.SetZero();return 0};goog.exportProperty(box2d.b2ChainShape.prototype,"ComputeSubmergedArea",box2d.b2ChainShape.prototype.ComputeSubmergedArea);
box2d.b2ChainShape.prototype.Dump=function(){box2d.b2Log("    /*box2d.b2ChainShape*/ var shape = new box2d.b2ChainShape();\n");box2d.b2Log("    /*box2d.b2Vec2[]*/ var vs = box2d.b2Vec2.MakeArray(%d);\n",box2d.b2_maxPolygonVertices);for(var a=0;a<this.m_count;++a)box2d.b2Log("    vs[%d].Set(%.15f, %.15f);\n",a,this.m_vertices[a].x,this.m_vertices[a].y);box2d.b2Log("    shape.CreateChain(vs, %d);\n",this.m_count);box2d.b2Log("    shape.m_prevVertex.Set(%.15f, %.15f);\n",this.m_prevVertex.x,this.m_prevVertex.y);
box2d.b2Log("    shape.m_nextVertex.Set(%.15f, %.15f);\n",this.m_nextVertex.x,this.m_nextVertex.y);box2d.b2Log("    shape.m_hasPrevVertex = %s;\n",this.m_hasPrevVertex?"true":"false");box2d.b2Log("    shape.m_hasNextVertex = %s;\n",this.m_hasNextVertex?"true":"false")};goog.exportProperty(box2d.b2ChainShape.prototype,"Dump",box2d.b2ChainShape.prototype.Dump);
box2d.b2PolygonShape=function(){box2d.b2Shape.call(this,box2d.b2ShapeType.e_polygonShape,box2d.b2_polygonRadius);this.m_centroid=new box2d.b2Vec2(0,0);this.m_vertices=box2d.b2Vec2.MakeArray(box2d.b2_maxPolygonVertices);this.m_normals=box2d.b2Vec2.MakeArray(box2d.b2_maxPolygonVertices)};goog.inherits(box2d.b2PolygonShape,box2d.b2Shape);goog.exportSymbol("box2d.b2PolygonShape",box2d.b2PolygonShape);box2d.b2PolygonShape.prototype.m_centroid=null;
goog.exportProperty(box2d.b2PolygonShape.prototype,"m_centroid",box2d.b2PolygonShape.prototype.m_centroid);box2d.b2PolygonShape.prototype.m_vertices=null;goog.exportProperty(box2d.b2PolygonShape.prototype,"m_vertices",box2d.b2PolygonShape.prototype.m_vertices);box2d.b2PolygonShape.prototype.m_normals=null;goog.exportProperty(box2d.b2PolygonShape.prototype,"m_normals",box2d.b2PolygonShape.prototype.m_normals);box2d.b2PolygonShape.prototype.m_count=0;
goog.exportProperty(box2d.b2PolygonShape.prototype,"m_count",box2d.b2PolygonShape.prototype.m_count);box2d.b2PolygonShape.prototype.Clone=function(){return(new box2d.b2PolygonShape).Copy(this)};goog.exportProperty(box2d.b2PolygonShape.prototype,"Clone",box2d.b2PolygonShape.prototype.Clone);
box2d.b2PolygonShape.prototype.Copy=function(a){box2d.b2Shape.prototype.Copy.call(this,a);box2d.ENABLE_ASSERTS&&box2d.b2Assert(a instanceof box2d.b2PolygonShape);this.m_centroid.Copy(a.m_centroid);this.m_count=a.m_count;for(var b=0,d=this.m_count;b<d;++b)this.m_vertices[b].Copy(a.m_vertices[b]),this.m_normals[b].Copy(a.m_normals[b]);return this};goog.exportProperty(box2d.b2PolygonShape.prototype,"Copy",box2d.b2PolygonShape.prototype.Copy);
box2d.b2PolygonShape.prototype.SetAsBox=function(a,b,d,e){this.m_count=4;this.m_vertices[0].Set(-a,-b);this.m_vertices[1].Set(a,-b);this.m_vertices[2].Set(a,b);this.m_vertices[3].Set(-a,b);this.m_normals[0].Set(0,-1);this.m_normals[1].Set(1,0);this.m_normals[2].Set(0,1);this.m_normals[3].Set(-1,0);this.m_centroid.SetZero();if(d instanceof box2d.b2Vec2)for(e="number"===typeof e?e:0,this.m_centroid.Copy(d),a=new box2d.b2Transform,a.SetPosition(d),a.SetRotationAngle(e),d=0,e=this.m_count;d<e;++d)box2d.b2Mul_X_V2(a,
this.m_vertices[d],this.m_vertices[d]),box2d.b2Mul_R_V2(a.q,this.m_normals[d],this.m_normals[d]);return this};goog.exportProperty(box2d.b2PolygonShape.prototype,"SetAsBox",box2d.b2PolygonShape.prototype.SetAsBox);
box2d.b2PolygonShape.prototype.Set=function(a,b,d){b="number"===typeof b?b:a.length;d="number"===typeof d?d:0;box2d.ENABLE_ASSERTS&&box2d.b2Assert(3<=b&&b<=box2d.b2_maxPolygonVertices);if(3>b)return this.SetAsBox(1,1);b=box2d.b2Min(b,box2d.b2_maxPolygonVertices);for(var e=box2d.b2PolygonShape.prototype.Set.s_ps,f=0,g=0;g<b;++g){for(var k=a[d+g],m=!0,n=0;n<f;++n)if(box2d.b2DistanceSquared(k,e[n])<.25*box2d.b2_linearSlop*box2d.b2_linearSlop){m=!1;break}m&&e[f++].Copy(k)}b=f;if(3>b)return box2d.ENABLE_ASSERTS&&
box2d.b2Assert(!1),this.SetAsBox(1,1);a=0;k=e[0].x;for(g=1;g<b;++g)if(n=e[g].x,n>k||n===k&&e[g].y<e[a].y)a=g,k=n;f=box2d.b2PolygonShape.prototype.Set.s_hull;d=0;for(g=a;;){f[d]=g;m=0;for(n=1;n<b;++n)if(m===g)m=n;else{var q=box2d.b2Sub_V2_V2(e[m],e[f[d]],box2d.b2PolygonShape.prototype.Set.s_r),k=box2d.b2Sub_V2_V2(e[n],e[f[d]],box2d.b2PolygonShape.prototype.Set.s_v),s=box2d.b2Cross_V2_V2(q,k);0>s&&(m=n);0===s&&k.LengthSquared()>q.LengthSquared()&&(m=n)}++d;g=m;if(m===a)break}if(3>d)return box2d.ENABLE_ASSERTS&&
box2d.b2Assert(!1),this.SetAsBox(1,1);this.m_count=d;for(g=0;g<d;++g)this.m_vertices[g].Copy(e[f[g]]);g=0;for(b=d;g<b;++g)e=box2d.b2Sub_V2_V2(this.m_vertices[(g+1)%b],this.m_vertices[g],box2d.b2Vec2.s_t0),box2d.ENABLE_ASSERTS&&box2d.b2Assert(e.LengthSquared()>box2d.b2_epsilon_sq),box2d.b2Cross_V2_S(e,1,this.m_normals[g]).SelfNormalize();box2d.b2PolygonShape.ComputeCentroid(this.m_vertices,d,this.m_centroid);return this};goog.exportProperty(box2d.b2PolygonShape.prototype,"Set",box2d.b2PolygonShape.prototype.Set);
box2d.b2PolygonShape.prototype.Set.s_ps=box2d.b2Vec2.MakeArray(box2d.b2_maxPolygonVertices);box2d.b2PolygonShape.prototype.Set.s_hull=box2d.b2MakeNumberArray(box2d.b2_maxPolygonVertices);box2d.b2PolygonShape.prototype.Set.s_r=new box2d.b2Vec2;box2d.b2PolygonShape.prototype.Set.s_v=new box2d.b2Vec2;box2d.b2PolygonShape.prototype.GetChildCount=function(){return 1};goog.exportProperty(box2d.b2PolygonShape.prototype,"GetChildCount",box2d.b2PolygonShape.prototype.GetChildCount);
box2d.b2PolygonShape.prototype.TestPoint=function(a,b){for(var d=box2d.b2MulT_X_V2(a,b,box2d.b2PolygonShape.prototype.TestPoint.s_pLocal),e=0,f=this.m_count;e<f;++e)if(0<box2d.b2Dot_V2_V2(this.m_normals[e],box2d.b2Sub_V2_V2(d,this.m_vertices[e],box2d.b2Vec2.s_t0)))return!1;return!0};goog.exportProperty(box2d.b2PolygonShape.prototype,"TestPoint",box2d.b2PolygonShape.prototype.TestPoint);box2d.b2PolygonShape.prototype.TestPoint.s_pLocal=new box2d.b2Vec2;
box2d.b2PolygonShape.prototype.ComputeDistance=function(a,b,d,e){b=box2d.b2MulT_X_V2(a,b,box2d.b2PolygonShape.prototype.ComputeDistance.s_pLocal);var f=-box2d.b2_maxFloat,g=box2d.b2PolygonShape.prototype.ComputeDistance.s_normalForMaxDistance.Copy(b);for(e=0;e<this.m_count;++e){var k=box2d.b2Dot_V2_V2(this.m_normals[e],box2d.b2Sub_V2_V2(b,this.m_vertices[e],box2d.b2Vec2.s_t0));k>f&&(f=k,g.Copy(this.m_normals[e]))}if(0<f){g=box2d.b2PolygonShape.prototype.ComputeDistance.s_minDistance.Copy(g);f*=f;
for(e=0;e<this.m_count;++e){var k=box2d.b2Sub_V2_V2(b,this.m_vertices[e],box2d.b2PolygonShape.prototype.ComputeDistance.s_distance),m=k.LengthSquared();f>m&&(g.Copy(k),f=m)}box2d.b2Mul_R_V2(a.q,g,d);d.Normalize();return Math.sqrt(f)}box2d.b2Mul_R_V2(a.q,g,d);return f};goog.exportProperty(box2d.b2PolygonShape.prototype,"ComputeDistance",box2d.b2PolygonShape.prototype.ComputeDistance);box2d.b2PolygonShape.prototype.ComputeDistance.s_pLocal=new box2d.b2Vec2;
box2d.b2PolygonShape.prototype.ComputeDistance.s_normalForMaxDistance=new box2d.b2Vec2;box2d.b2PolygonShape.prototype.ComputeDistance.s_minDistance=new box2d.b2Vec2;box2d.b2PolygonShape.prototype.ComputeDistance.s_distance=new box2d.b2Vec2;
box2d.b2PolygonShape.prototype.RayCast=function(a,b,d,e){e=box2d.b2MulT_X_V2(d,b.p1,box2d.b2PolygonShape.prototype.RayCast.s_p1);for(var f=box2d.b2MulT_X_V2(d,b.p2,box2d.b2PolygonShape.prototype.RayCast.s_p2),f=box2d.b2Sub_V2_V2(f,e,box2d.b2PolygonShape.prototype.RayCast.s_d),g=0,k=b.maxFraction,m=-1,n=0,q=this.m_count;n<q;++n){var s=box2d.b2Dot_V2_V2(this.m_normals[n],box2d.b2Sub_V2_V2(this.m_vertices[n],e,box2d.b2Vec2.s_t0)),t=box2d.b2Dot_V2_V2(this.m_normals[n],f);if(0===t){if(0>s)return!1}else 0>
t&&s<g*t?(g=s/t,m=n):0<t&&s<k*t&&(k=s/t);if(k<g)return!1}box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<=g&&g<=b.maxFraction);return 0<=m?(a.fraction=g,box2d.b2Mul_R_V2(d.q,this.m_normals[m],a.normal),!0):!1};goog.exportProperty(box2d.b2PolygonShape.prototype,"RayCast",box2d.b2PolygonShape.prototype.RayCast);box2d.b2PolygonShape.prototype.RayCast.s_p1=new box2d.b2Vec2;box2d.b2PolygonShape.prototype.RayCast.s_p2=new box2d.b2Vec2;box2d.b2PolygonShape.prototype.RayCast.s_d=new box2d.b2Vec2;
box2d.b2PolygonShape.prototype.ComputeAABB=function(a,b,d){d=box2d.b2Mul_X_V2(b,this.m_vertices[0],a.lowerBound);a=a.upperBound.Copy(d);for(var e=0,f=this.m_count;e<f;++e){var g=box2d.b2Mul_X_V2(b,this.m_vertices[e],box2d.b2PolygonShape.prototype.ComputeAABB.s_v);box2d.b2Min_V2_V2(g,d,d);box2d.b2Max_V2_V2(g,a,a)}b=this.m_radius;d.SelfSubXY(b,b);a.SelfAddXY(b,b)};goog.exportProperty(box2d.b2PolygonShape.prototype,"ComputeAABB",box2d.b2PolygonShape.prototype.ComputeAABB);
box2d.b2PolygonShape.prototype.ComputeAABB.s_v=new box2d.b2Vec2;
box2d.b2PolygonShape.prototype.ComputeMass=function(a,b){box2d.ENABLE_ASSERTS&&box2d.b2Assert(3<=this.m_count);for(var d=box2d.b2PolygonShape.prototype.ComputeMass.s_center.SetZero(),e=0,f=0,g=box2d.b2PolygonShape.prototype.ComputeMass.s_s.SetZero(),k=0,m=this.m_count;k<m;++k)g.SelfAdd(this.m_vertices[k]);g.SelfMul(1/this.m_count);for(var n=1/3,k=0,m=this.m_count;k<m;++k){var q=box2d.b2Sub_V2_V2(this.m_vertices[k],g,box2d.b2PolygonShape.prototype.ComputeMass.s_e1),s=box2d.b2Sub_V2_V2(this.m_vertices[(k+
1)%m],g,box2d.b2PolygonShape.prototype.ComputeMass.s_e2),t=box2d.b2Cross_V2_V2(q,s),u=.5*t,e=e+u;d.SelfAdd(box2d.b2Mul_S_V2(u*n,box2d.b2Add_V2_V2(q,s,box2d.b2Vec2.s_t0),box2d.b2Vec2.s_t1));var u=q.x,q=q.y,v=s.x,s=s.y,f=f+.25*n*t*(u*u+v*u+v*v+(q*q+s*q+s*s))}a.mass=b*e;box2d.ENABLE_ASSERTS&&box2d.b2Assert(e>box2d.b2_epsilon);d.SelfMul(1/e);box2d.b2Add_V2_V2(d,g,a.center);a.I=b*f;a.I+=a.mass*(box2d.b2Dot_V2_V2(a.center,a.center)-box2d.b2Dot_V2_V2(d,d))};
goog.exportProperty(box2d.b2PolygonShape.prototype,"ComputeMass",box2d.b2PolygonShape.prototype.ComputeMass);box2d.b2PolygonShape.prototype.ComputeMass.s_center=new box2d.b2Vec2;box2d.b2PolygonShape.prototype.ComputeMass.s_s=new box2d.b2Vec2;box2d.b2PolygonShape.prototype.ComputeMass.s_e1=new box2d.b2Vec2;box2d.b2PolygonShape.prototype.ComputeMass.s_e2=new box2d.b2Vec2;
box2d.b2PolygonShape.prototype.Validate=function(){for(var a=0;a<this.m_count;++a)for(var b=a,d=(a+1)%this.m_count,e=this.m_vertices[b],f=box2d.b2Sub_V2_V2(this.m_vertices[d],e,box2d.b2PolygonShape.prototype.Validate.s_e),g=0;g<this.m_count;++g)if(g!==b&&g!==d){var k=box2d.b2Sub_V2_V2(this.m_vertices[g],e,box2d.b2PolygonShape.prototype.Validate.s_v);if(0>box2d.b2Cross_V2_V2(f,k))return!1}return!0};goog.exportProperty(box2d.b2PolygonShape.prototype,"Validate",box2d.b2PolygonShape.prototype.Validate);
box2d.b2PolygonShape.prototype.Validate.s_e=new box2d.b2Vec2;box2d.b2PolygonShape.prototype.Validate.s_v=new box2d.b2Vec2;box2d.b2PolygonShape.prototype.SetupDistanceProxy=function(a,b){a.m_vertices=this.m_vertices;a.m_count=this.m_count;a.m_radius=this.m_radius};
box2d.b2PolygonShape.prototype.ComputeSubmergedArea=function(a,b,d,e){var f=box2d.b2MulT_R_V2(d.q,a,box2d.b2PolygonShape.prototype.ComputeSubmergedArea.s_normalL),g=b-box2d.b2Dot_V2_V2(a,d.p),k=box2d.b2PolygonShape.prototype.ComputeSubmergedArea.s_depths,m=0,n=-1;b=-1;var q=!1;a=0;for(var s=this.m_count;a<s;++a){k[a]=box2d.b2Dot_V2_V2(f,this.m_vertices[a])-g;var t=k[a]<-box2d.b2_epsilon;0<a&&(t?q||(n=a-1,m++):q&&(b=a-1,m++));q=t}switch(m){case 0:return q?(a=box2d.b2PolygonShape.prototype.ComputeSubmergedArea.s_md,
this.ComputeMass(a,1),box2d.b2Mul_X_V2(d,a.center,e),a.mass):0;case 1:-1===n?n=this.m_count-1:b=this.m_count-1}a=(n+1)%this.m_count;f=(b+1)%this.m_count;g=(0-k[n])/(k[a]-k[n]);k=(0-k[b])/(k[f]-k[b]);n=box2d.b2PolygonShape.prototype.ComputeSubmergedArea.s_intoVec.Set(this.m_vertices[n].x*(1-g)+this.m_vertices[a].x*g,this.m_vertices[n].y*(1-g)+this.m_vertices[a].y*g);b=box2d.b2PolygonShape.prototype.ComputeSubmergedArea.s_outoVec.Set(this.m_vertices[b].x*(1-k)+this.m_vertices[f].x*k,this.m_vertices[b].y*
(1-k)+this.m_vertices[f].y*k);k=0;g=box2d.b2PolygonShape.prototype.ComputeSubmergedArea.s_center.SetZero();for(m=this.m_vertices[a];a!==f;)a=(a+1)%this.m_count,q=a===f?b:this.m_vertices[a],s=.5*((m.x-n.x)*(q.y-n.y)-(m.y-n.y)*(q.x-n.x)),k+=s,g.x+=s*(n.x+m.x+q.x)/3,g.y+=s*(n.y+m.y+q.y)/3,m=q;g.SelfMul(1/k);box2d.b2Mul_X_V2(d,g,e);return k};goog.exportProperty(box2d.b2PolygonShape.prototype,"ComputeSubmergedArea",box2d.b2PolygonShape.prototype.ComputeSubmergedArea);
box2d.b2PolygonShape.prototype.ComputeSubmergedArea.s_normalL=new box2d.b2Vec2;box2d.b2PolygonShape.prototype.ComputeSubmergedArea.s_depths=box2d.b2MakeNumberArray(box2d.b2_maxPolygonVertices);box2d.b2PolygonShape.prototype.ComputeSubmergedArea.s_md=new box2d.b2MassData;box2d.b2PolygonShape.prototype.ComputeSubmergedArea.s_intoVec=new box2d.b2Vec2;box2d.b2PolygonShape.prototype.ComputeSubmergedArea.s_outoVec=new box2d.b2Vec2;box2d.b2PolygonShape.prototype.ComputeSubmergedArea.s_center=new box2d.b2Vec2;
box2d.b2PolygonShape.prototype.Dump=function(){box2d.b2Log("    /*box2d.b2PolygonShape*/ var shape = new box2d.b2PolygonShape();\n");box2d.b2Log("    /*box2d.b2Vec2[]*/ var vs = box2d.b2Vec2.MakeArray(%d);\n",box2d.b2_maxPolygonVertices);for(var a=0;a<this.m_count;++a)box2d.b2Log("    vs[%d].Set(%.15f, %.15f);\n",a,this.m_vertices[a].x,this.m_vertices[a].y);box2d.b2Log("    shape.Set(vs, %d);\n",this.m_count)};goog.exportProperty(box2d.b2PolygonShape.prototype,"Dump",box2d.b2PolygonShape.prototype.Dump);
box2d.b2PolygonShape.ComputeCentroid=function(a,b,d){box2d.ENABLE_ASSERTS&&box2d.b2Assert(3<=b);d.SetZero();for(var e=0,f=box2d.b2PolygonShape.ComputeCentroid.s_pRef.SetZero(),g=1/3,k=0;k<b;++k){var m=f,n=a[k],q=a[(k+1)%b],s=box2d.b2Sub_V2_V2(n,m,box2d.b2PolygonShape.ComputeCentroid.s_e1),t=box2d.b2Sub_V2_V2(q,m,box2d.b2PolygonShape.ComputeCentroid.s_e2),s=.5*box2d.b2Cross_V2_V2(s,t),e=e+s;d.x+=s*g*(m.x+n.x+q.x);d.y+=s*g*(m.y+n.y+q.y)}box2d.ENABLE_ASSERTS&&box2d.b2Assert(e>box2d.b2_epsilon);d.SelfMul(1/
e);return d};goog.exportProperty(box2d.b2PolygonShape,"ComputeCentroid",box2d.b2PolygonShape.ComputeCentroid);box2d.b2PolygonShape.ComputeCentroid.s_pRef=new box2d.b2Vec2;box2d.b2PolygonShape.ComputeCentroid.s_e1=new box2d.b2Vec2;box2d.b2PolygonShape.ComputeCentroid.s_e2=new box2d.b2Vec2;box2d.b2Timer=function(){this.m_start=(new Date).getTime()};goog.exportSymbol("box2d.b2Timer",box2d.b2Timer);box2d.b2Timer.prototype.m_start=0;goog.exportProperty(box2d.b2Timer.prototype,"m_start",box2d.b2Timer.prototype.m_start);
box2d.b2Timer.prototype.Reset=function(){this.m_start=(new Date).getTime();return this};goog.exportProperty(box2d.b2Timer.prototype,"Reset",box2d.b2Timer.prototype.Reset);box2d.b2Timer.prototype.GetMilliseconds=function(){return(new Date).getTime()-this.m_start};goog.exportProperty(box2d.b2Timer.prototype,"GetMilliseconds",box2d.b2Timer.prototype.GetMilliseconds);box2d.b2Counter=function(){};goog.exportSymbol("box2d.b2Counter",box2d.b2Counter);box2d.b2Counter.prototype.m_count=0;
goog.exportProperty(box2d.b2Counter.prototype,"m_count",box2d.b2Counter.prototype.m_count);box2d.b2Counter.prototype.m_min_count=0;goog.exportProperty(box2d.b2Counter.prototype,"m_min_count",box2d.b2Counter.prototype.m_min_count);box2d.b2Counter.prototype.m_max_count=0;goog.exportProperty(box2d.b2Counter.prototype,"m_max_count",box2d.b2Counter.prototype.m_max_count);box2d.b2Counter.prototype.GetCount=function(){return this.m_count};goog.exportProperty(box2d.b2Counter.prototype,"GetCount",box2d.b2Counter.prototype.GetCount);
box2d.b2Counter.prototype.GetMinCount=function(){return this.m_min_count};goog.exportProperty(box2d.b2Counter.prototype,"GetMinCount",box2d.b2Counter.prototype.GetMinCount);box2d.b2Counter.prototype.GetMaxCount=function(){return this.m_max_count};goog.exportProperty(box2d.b2Counter.prototype,"GetMaxCount",box2d.b2Counter.prototype.GetMaxCount);box2d.b2Counter.prototype.ResetCount=function(){var a=this.m_count;this.m_count=0;return a};goog.exportProperty(box2d.b2Counter.prototype,"ResetCount",box2d.b2Counter.prototype.ResetCount);
box2d.b2Counter.prototype.ResetMinCount=function(){this.m_min_count=0};goog.exportProperty(box2d.b2Counter.prototype,"ResetMinCount",box2d.b2Counter.prototype.ResetMinCount);box2d.b2Counter.prototype.ResetMaxCount=function(){this.m_max_count=0};goog.exportProperty(box2d.b2Counter.prototype,"ResetMaxCount",box2d.b2Counter.prototype.ResetMaxCount);box2d.b2Counter.prototype.Increment=function(){this.m_count++;this.m_max_count<this.m_count&&(this.m_max_count=this.m_count)};
goog.exportProperty(box2d.b2Counter.prototype,"Increment",box2d.b2Counter.prototype.Increment);box2d.b2Counter.prototype.Decrement=function(){this.m_count--;this.m_min_count>this.m_count&&(this.m_min_count=this.m_count)};goog.exportProperty(box2d.b2Counter.prototype,"Decrement",box2d.b2Counter.prototype.Decrement);box2d.b2_toiTime=0;goog.exportSymbol("box2d.b2_toiTime",box2d.b2_toiTime);box2d.b2_toiMaxTime=0;goog.exportSymbol("box2d.b2_toiMaxTime",box2d.b2_toiMaxTime);box2d.b2_toiCalls=0;
goog.exportSymbol("box2d.b2_toiCalls",box2d.b2_toiCalls);box2d.b2_toiIters=0;goog.exportSymbol("box2d.b2_toiIters",box2d.b2_toiIters);box2d.b2_toiMaxIters=0;goog.exportSymbol("box2d.b2_toiMaxIters",box2d.b2_toiMaxIters);box2d.b2_toiRootIters=0;goog.exportSymbol("box2d.b2_toiRootIters",box2d.b2_toiRootIters);box2d.b2_toiMaxRootIters=0;goog.exportSymbol("box2d.b2_toiMaxRootIters",box2d.b2_toiMaxRootIters);
box2d.b2TOIInput=function(){this.proxyA=new box2d.b2DistanceProxy;this.proxyB=new box2d.b2DistanceProxy;this.sweepA=new box2d.b2Sweep;this.sweepB=new box2d.b2Sweep};goog.exportSymbol("box2d.b2TOIInput",box2d.b2TOIInput);box2d.b2TOIInput.prototype.proxyA=null;goog.exportProperty(box2d.b2TOIInput.prototype,"proxyA",box2d.b2TOIInput.prototype.proxyA);box2d.b2TOIInput.prototype.proxyB=null;goog.exportProperty(box2d.b2TOIInput.prototype,"proxyB",box2d.b2TOIInput.prototype.proxyB);
box2d.b2TOIInput.prototype.sweepA=null;goog.exportProperty(box2d.b2TOIInput.prototype,"sweepA",box2d.b2TOIInput.prototype.sweepA);box2d.b2TOIInput.prototype.sweepB=null;goog.exportProperty(box2d.b2TOIInput.prototype,"sweepB",box2d.b2TOIInput.prototype.sweepB);box2d.b2TOIInput.prototype.tMax=0;goog.exportProperty(box2d.b2TOIInput.prototype,"tMax",box2d.b2TOIInput.prototype.tMax);box2d.b2TOIOutputState={e_unknown:0,e_failed:1,e_overlapped:2,e_touching:3,e_separated:4};
goog.exportSymbol("box2d.b2TOIOutputState",box2d.b2TOIOutputState);goog.exportProperty(box2d.b2TOIOutputState,"e_unknown",box2d.b2TOIOutputState.e_unknown);goog.exportProperty(box2d.b2TOIOutputState,"e_failed",box2d.b2TOIOutputState.e_failed);goog.exportProperty(box2d.b2TOIOutputState,"e_overlapped",box2d.b2TOIOutputState.e_overlapped);goog.exportProperty(box2d.b2TOIOutputState,"e_touching",box2d.b2TOIOutputState.e_touching);goog.exportProperty(box2d.b2TOIOutputState,"e_separated",box2d.b2TOIOutputState.e_separated);
box2d.b2TOIOutput=function(){};goog.exportSymbol("box2d.b2TOIOutput",box2d.b2TOIOutput);box2d.b2TOIOutput.prototype.state=box2d.b2TOIOutputState.e_unknown;goog.exportProperty(box2d.b2TOIOutput.prototype,"state",box2d.b2TOIOutput.prototype.state);box2d.b2TOIOutput.prototype.t=0;goog.exportProperty(box2d.b2TOIOutput.prototype,"t",box2d.b2TOIOutput.prototype.t);box2d.b2SeparationFunctionType={e_unknown:-1,e_points:0,e_faceA:1,e_faceB:2};goog.exportSymbol("box2d.b2SeparationFunctionType",box2d.b2SeparationFunctionType);
goog.exportProperty(box2d.b2SeparationFunctionType,"e_unknown",box2d.b2SeparationFunctionType.e_unknown);goog.exportProperty(box2d.b2SeparationFunctionType,"e_points",box2d.b2SeparationFunctionType.e_points);goog.exportProperty(box2d.b2SeparationFunctionType,"e_faceA",box2d.b2SeparationFunctionType.e_faceA);goog.exportProperty(box2d.b2SeparationFunctionType,"e_faceB",box2d.b2SeparationFunctionType.e_faceB);
box2d.b2SeparationFunction=function(){this.m_sweepA=new box2d.b2Sweep;this.m_sweepB=new box2d.b2Sweep;this.m_localPoint=new box2d.b2Vec2;this.m_axis=new box2d.b2Vec2};goog.exportSymbol("box2d.b2SeparationFunction",box2d.b2SeparationFunction);box2d.b2SeparationFunction.prototype.m_proxyA=null;goog.exportProperty(box2d.b2SeparationFunction.prototype,"m_proxyA",box2d.b2SeparationFunction.prototype.m_proxyA);box2d.b2SeparationFunction.prototype.m_proxyB=null;
goog.exportProperty(box2d.b2SeparationFunction.prototype,"m_proxyB",box2d.b2SeparationFunction.prototype.m_proxyB);box2d.b2SeparationFunction.prototype.m_sweepA=null;goog.exportProperty(box2d.b2SeparationFunction.prototype,"m_sweepA",box2d.b2SeparationFunction.prototype.m_sweepA);box2d.b2SeparationFunction.prototype.m_sweepB=null;goog.exportProperty(box2d.b2SeparationFunction.prototype,"m_sweepB",box2d.b2SeparationFunction.prototype.m_sweepB);box2d.b2SeparationFunction.prototype.m_type=box2d.b2SeparationFunctionType.e_unknown;
goog.exportProperty(box2d.b2SeparationFunction.prototype,"m_type",box2d.b2SeparationFunction.prototype.m_type);box2d.b2SeparationFunction.prototype.m_localPoint=null;goog.exportProperty(box2d.b2SeparationFunction.prototype,"m_localPoint",box2d.b2SeparationFunction.prototype.m_localPoint);box2d.b2SeparationFunction.prototype.m_axis=null;goog.exportProperty(box2d.b2SeparationFunction.prototype,"m_axis",box2d.b2SeparationFunction.prototype.m_axis);
box2d.b2SeparationFunction.prototype.Initialize=function(a,b,d,e,f,g){this.m_proxyA=b;this.m_proxyB=e;b=a.count;box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<b&&3>b);this.m_sweepA.Copy(d);this.m_sweepB.Copy(f);d=box2d.b2TimeOfImpact.s_xfA;f=box2d.b2TimeOfImpact.s_xfB;this.m_sweepA.GetTransform(d,g);this.m_sweepB.GetTransform(f,g);1===b?(this.m_type=box2d.b2SeparationFunctionType.e_points,b=this.m_proxyA.GetVertex(a.indexA[0]),a=this.m_proxyB.GetVertex(a.indexB[0]),d=box2d.b2Mul_X_V2(d,b,box2d.b2TimeOfImpact.s_pointA),
f=box2d.b2Mul_X_V2(f,a,box2d.b2TimeOfImpact.s_pointB),box2d.b2Sub_V2_V2(f,d,this.m_axis),a=this.m_axis.Normalize(),this.m_localPoint.SetZero()):(a.indexA[0]===a.indexA[1]?(this.m_type=box2d.b2SeparationFunctionType.e_faceB,b=this.m_proxyB.GetVertex(a.indexB[0]),e=this.m_proxyB.GetVertex(a.indexB[1]),box2d.b2Cross_V2_S(box2d.b2Sub_V2_V2(e,b,box2d.b2Vec2.s_t0),1,this.m_axis).SelfNormalize(),g=box2d.b2Mul_R_V2(f.q,this.m_axis,box2d.b2TimeOfImpact.s_normal),box2d.b2Mid_V2_V2(b,e,this.m_localPoint),f=
box2d.b2Mul_X_V2(f,this.m_localPoint,box2d.b2TimeOfImpact.s_pointB),b=this.m_proxyA.GetVertex(a.indexA[0]),d=box2d.b2Mul_X_V2(d,b,box2d.b2TimeOfImpact.s_pointA),a=box2d.b2Dot_V2_V2(box2d.b2Sub_V2_V2(d,f,box2d.b2Vec2.s_t0),g)):(this.m_type=box2d.b2SeparationFunctionType.e_faceA,b=this.m_proxyA.GetVertex(a.indexA[0]),e=this.m_proxyA.GetVertex(a.indexA[1]),box2d.b2Cross_V2_S(box2d.b2Sub_V2_V2(e,b,box2d.b2Vec2.s_t0),1,this.m_axis).SelfNormalize(),g=box2d.b2Mul_R_V2(d.q,this.m_axis,box2d.b2TimeOfImpact.s_normal),
box2d.b2Mid_V2_V2(b,e,this.m_localPoint),d=box2d.b2Mul_X_V2(d,this.m_localPoint,box2d.b2TimeOfImpact.s_pointA),a=this.m_proxyB.GetVertex(a.indexB[0]),f=box2d.b2Mul_X_V2(f,a,box2d.b2TimeOfImpact.s_pointB),a=box2d.b2Dot_V2_V2(box2d.b2Sub_V2_V2(f,d,box2d.b2Vec2.s_t0),g)),0>a&&(this.m_axis.SelfNeg(),a=-a));return a};goog.exportProperty(box2d.b2SeparationFunction.prototype,"Initialize",box2d.b2SeparationFunction.prototype.Initialize);
box2d.b2SeparationFunction.prototype.FindMinSeparation=function(a,b,d){var e=box2d.b2TimeOfImpact.s_xfA,f=box2d.b2TimeOfImpact.s_xfB;this.m_sweepA.GetTransform(e,d);this.m_sweepB.GetTransform(f,d);switch(this.m_type){case box2d.b2SeparationFunctionType.e_points:var g=box2d.b2MulT_R_V2(e.q,this.m_axis,box2d.b2TimeOfImpact.s_axisA),k=box2d.b2MulT_R_V2(f.q,box2d.b2Vec2.s_t0.Copy(this.m_axis).SelfNeg(),box2d.b2TimeOfImpact.s_axisB);a[0]=this.m_proxyA.GetSupport(g);b[0]=this.m_proxyB.GetSupport(k);a=this.m_proxyA.GetVertex(a[0]);
b=this.m_proxyB.GetVertex(b[0]);e=box2d.b2Mul_X_V2(e,a,box2d.b2TimeOfImpact.s_pointA);f=box2d.b2Mul_X_V2(f,b,box2d.b2TimeOfImpact.s_pointB);return box2d.b2Dot_V2_V2(box2d.b2Sub_V2_V2(f,e,box2d.b2Vec2.s_t0),this.m_axis);case box2d.b2SeparationFunctionType.e_faceA:return d=box2d.b2Mul_R_V2(e.q,this.m_axis,box2d.b2TimeOfImpact.s_normal),e=box2d.b2Mul_X_V2(e,this.m_localPoint,box2d.b2TimeOfImpact.s_pointA),k=box2d.b2MulT_R_V2(f.q,box2d.b2Vec2.s_t0.Copy(d).SelfNeg(),box2d.b2TimeOfImpact.s_axisB),a[0]=
-1,b[0]=this.m_proxyB.GetSupport(k),b=this.m_proxyB.GetVertex(b[0]),f=box2d.b2Mul_X_V2(f,b,box2d.b2TimeOfImpact.s_pointB),box2d.b2Dot_V2_V2(box2d.b2Sub_V2_V2(f,e,box2d.b2Vec2.s_t0),d);case box2d.b2SeparationFunctionType.e_faceB:return d=box2d.b2Mul_R_V2(f.q,this.m_axis,box2d.b2TimeOfImpact.s_normal),f=box2d.b2Mul_X_V2(f,this.m_localPoint,box2d.b2TimeOfImpact.s_pointB),g=box2d.b2MulT_R_V2(e.q,box2d.b2Vec2.s_t0.Copy(d).SelfNeg(),box2d.b2TimeOfImpact.s_axisA),b[0]=-1,a[0]=this.m_proxyA.GetSupport(g),
a=this.m_proxyA.GetVertex(a[0]),e=box2d.b2Mul_X_V2(e,a,box2d.b2TimeOfImpact.s_pointA),box2d.b2Dot_V2_V2(box2d.b2Sub_V2_V2(e,f,box2d.b2Vec2.s_t0),d);default:return box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1),a[0]=-1,b[0]=-1,0}};goog.exportProperty(box2d.b2SeparationFunction.prototype,"FindMinSeparation",box2d.b2SeparationFunction.prototype.FindMinSeparation);
box2d.b2SeparationFunction.prototype.Evaluate=function(a,b,d){var e=box2d.b2TimeOfImpact.s_xfA,f=box2d.b2TimeOfImpact.s_xfB;this.m_sweepA.GetTransform(e,d);this.m_sweepB.GetTransform(f,d);switch(this.m_type){case box2d.b2SeparationFunctionType.e_points:return a=this.m_proxyA.GetVertex(a),b=this.m_proxyB.GetVertex(b),e=box2d.b2Mul_X_V2(e,a,box2d.b2TimeOfImpact.s_pointA),f=box2d.b2Mul_X_V2(f,b,box2d.b2TimeOfImpact.s_pointB),box2d.b2Dot_V2_V2(box2d.b2Sub_V2_V2(f,e,box2d.b2Vec2.s_t0),this.m_axis);case box2d.b2SeparationFunctionType.e_faceA:return d=
box2d.b2Mul_R_V2(e.q,this.m_axis,box2d.b2TimeOfImpact.s_normal),e=box2d.b2Mul_X_V2(e,this.m_localPoint,box2d.b2TimeOfImpact.s_pointA),b=this.m_proxyB.GetVertex(b),f=box2d.b2Mul_X_V2(f,b,box2d.b2TimeOfImpact.s_pointB),box2d.b2Dot_V2_V2(box2d.b2Sub_V2_V2(f,e,box2d.b2Vec2.s_t0),d);case box2d.b2SeparationFunctionType.e_faceB:return d=box2d.b2Mul_R_V2(f.q,this.m_axis,box2d.b2TimeOfImpact.s_normal),f=box2d.b2Mul_X_V2(f,this.m_localPoint,box2d.b2TimeOfImpact.s_pointB),a=this.m_proxyA.GetVertex(a),e=box2d.b2Mul_X_V2(e,
a,box2d.b2TimeOfImpact.s_pointA),box2d.b2Dot_V2_V2(box2d.b2Sub_V2_V2(e,f,box2d.b2Vec2.s_t0),d);default:return box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1),0}};goog.exportProperty(box2d.b2SeparationFunction.prototype,"Evaluate",box2d.b2SeparationFunction.prototype.Evaluate);
box2d.b2TimeOfImpact=function(a,b){var d=box2d.b2TimeOfImpact.s_timer.Reset();++box2d.b2_toiCalls;a.state=box2d.b2TOIOutputState.e_unknown;a.t=b.tMax;var e=b.proxyA,f=b.proxyB,g=box2d.b2TimeOfImpact.s_sweepA.Copy(b.sweepA),k=box2d.b2TimeOfImpact.s_sweepB.Copy(b.sweepB);g.Normalize();k.Normalize();var m=b.tMax,n=box2d.b2Max(box2d.b2_linearSlop,e.m_radius+f.m_radius-3*box2d.b2_linearSlop),q=.25*box2d.b2_linearSlop;box2d.ENABLE_ASSERTS&&box2d.b2Assert(n>q);var s=0,t=0,u=box2d.b2TimeOfImpact.s_cache;
u.count=0;var v=box2d.b2TimeOfImpact.s_distanceInput;v.proxyA=b.proxyA;v.proxyB=b.proxyB;for(v.useRadii=!1;;){var y=box2d.b2TimeOfImpact.s_xfA,z=box2d.b2TimeOfImpact.s_xfB;g.GetTransform(y,s);k.GetTransform(z,s);v.transformA.Copy(y);v.transformB.Copy(z);y=box2d.b2TimeOfImpact.s_distanceOutput;box2d.b2ShapeDistance(y,u,v);if(0>=y.distance){a.state=box2d.b2TOIOutputState.e_overlapped;a.t=0;break}if(y.distance<n+q){a.state=box2d.b2TOIOutputState.e_touching;a.t=s;break}y=box2d.b2TimeOfImpact.s_fcn;y.Initialize(u,
e,g,f,k,s);for(var z=!1,A=m,r=0;;){var D=box2d.b2TimeOfImpact.s_indexA,C=box2d.b2TimeOfImpact.s_indexB,B=y.FindMinSeparation(D,C,A);if(B>n+q){a.state=box2d.b2TOIOutputState.e_separated;a.t=m;z=!0;break}if(B>n-q){s=A;break}var F=y.Evaluate(D[0],C[0],s);if(F<n-q){a.state=box2d.b2TOIOutputState.e_failed;a.t=s;z=!0;break}if(F<=n+q){a.state=box2d.b2TOIOutputState.e_touching;a.t=s;z=!0;break}for(var J=0,L=s,G=A;;){var K=0,K=J&1?L+(n-F)*(G-L)/(B-F):.5*(L+G);++J;++box2d.b2_toiRootIters;var P=y.Evaluate(D[0],
C[0],K);if(box2d.b2Abs(P-n)<q){A=K;break}P>n?(L=K,F=P):(G=K,B=P);if(50===J)break}box2d.b2_toiMaxRootIters=box2d.b2Max(box2d.b2_toiMaxRootIters,J);++r;if(r===box2d.b2_maxPolygonVertices)break}++t;++box2d.b2_toiIters;if(z)break;if(20===t){a.state=box2d.b2TOIOutputState.e_failed;a.t=s;break}}box2d.b2_toiMaxIters=box2d.b2Max(box2d.b2_toiMaxIters,t);d=d.GetMilliseconds();box2d.b2_toiMaxTime=box2d.b2Max(box2d.b2_toiMaxTime,d);box2d.b2_toiTime+=d};goog.exportSymbol("box2d.b2TimeOfImpact",box2d.b2TimeOfImpact);
box2d.b2TimeOfImpact.s_timer=new box2d.b2Timer;box2d.b2TimeOfImpact.s_cache=new box2d.b2SimplexCache;box2d.b2TimeOfImpact.s_distanceInput=new box2d.b2DistanceInput;box2d.b2TimeOfImpact.s_distanceOutput=new box2d.b2DistanceOutput;box2d.b2TimeOfImpact.s_xfA=new box2d.b2Transform;box2d.b2TimeOfImpact.s_xfB=new box2d.b2Transform;box2d.b2TimeOfImpact.s_indexA=box2d.b2MakeNumberArray(1);box2d.b2TimeOfImpact.s_indexB=box2d.b2MakeNumberArray(1);box2d.b2TimeOfImpact.s_fcn=new box2d.b2SeparationFunction;
box2d.b2TimeOfImpact.s_sweepA=new box2d.b2Sweep;box2d.b2TimeOfImpact.s_sweepB=new box2d.b2Sweep;box2d.b2TimeOfImpact.s_pointA=new box2d.b2Vec2;box2d.b2TimeOfImpact.s_pointB=new box2d.b2Vec2;box2d.b2TimeOfImpact.s_normal=new box2d.b2Vec2;box2d.b2TimeOfImpact.s_axisA=new box2d.b2Vec2;box2d.b2TimeOfImpact.s_axisB=new box2d.b2Vec2;box2d.b2Filter=function(){};goog.exportSymbol("box2d.b2Filter",box2d.b2Filter);box2d.b2Filter.prototype.categoryBits=1;
goog.exportProperty(box2d.b2Filter.prototype,"categoryBits",box2d.b2Filter.prototype.categoryBits);box2d.b2Filter.prototype.maskBits=65535;goog.exportProperty(box2d.b2Filter.prototype,"maskBits",box2d.b2Filter.prototype.maskBits);box2d.b2Filter.prototype.groupIndex=0;goog.exportProperty(box2d.b2Filter.prototype,"groupIndex",box2d.b2Filter.prototype.groupIndex);box2d.b2Filter.prototype.Clone=function(){return(new box2d.b2Filter).Copy(this)};goog.exportProperty(box2d.b2Filter.prototype,"Clone",box2d.b2Filter.prototype.Clone);
box2d.b2Filter.prototype.Copy=function(a){box2d.ENABLE_ASSERTS&&box2d.b2Assert(this!==a);this.categoryBits=a.categoryBits;this.maskBits=a.maskBits;this.groupIndex=a.groupIndex;return this};goog.exportProperty(box2d.b2Filter.prototype,"Copy",box2d.b2Filter.prototype.Copy);box2d.b2FixtureDef=function(){this.filter=new box2d.b2Filter};goog.exportSymbol("box2d.b2FixtureDef",box2d.b2FixtureDef);box2d.b2FixtureDef.prototype.shape=null;goog.exportProperty(box2d.b2FixtureDef.prototype,"shape",box2d.b2FixtureDef.prototype.shape);
box2d.b2FixtureDef.prototype.userData=null;goog.exportProperty(box2d.b2FixtureDef.prototype,"userData",box2d.b2FixtureDef.prototype.userData);box2d.b2FixtureDef.prototype.friction=.2;goog.exportProperty(box2d.b2FixtureDef.prototype,"friction",box2d.b2FixtureDef.prototype.friction);box2d.b2FixtureDef.prototype.restitution=0;goog.exportProperty(box2d.b2FixtureDef.prototype,"restitution",box2d.b2FixtureDef.prototype.restitution);box2d.b2FixtureDef.prototype.density=0;
goog.exportProperty(box2d.b2FixtureDef.prototype,"density",box2d.b2FixtureDef.prototype.density);box2d.b2FixtureDef.prototype.isSensor=!1;goog.exportProperty(box2d.b2FixtureDef.prototype,"isSensor",box2d.b2FixtureDef.prototype.isSensor);box2d.b2FixtureDef.prototype.filter=null;goog.exportProperty(box2d.b2FixtureDef.prototype,"filter",box2d.b2FixtureDef.prototype.filter);box2d.b2FixtureProxy=function(){this.aabb=new box2d.b2AABB};goog.exportSymbol("box2d.b2FixtureProxy",box2d.b2FixtureProxy);
box2d.b2FixtureProxy.prototype.aabb=null;goog.exportProperty(box2d.b2FixtureProxy.prototype,"aabb",box2d.b2FixtureProxy.prototype.aabb);box2d.b2FixtureProxy.prototype.fixture=null;goog.exportProperty(box2d.b2FixtureProxy.prototype,"fixture",box2d.b2FixtureProxy.prototype.fixture);box2d.b2FixtureProxy.prototype.childIndex=0;goog.exportProperty(box2d.b2FixtureProxy.prototype,"childIndex",box2d.b2FixtureProxy.prototype.childIndex);box2d.b2FixtureProxy.prototype.proxy=null;
goog.exportProperty(box2d.b2FixtureProxy.prototype,"proxy",box2d.b2FixtureProxy.prototype.proxy);box2d.b2FixtureProxy.MakeArray=function(a){return box2d.b2MakeArray(a,function(a){return new box2d.b2FixtureProxy})};goog.exportProperty(box2d.b2FixtureProxy,"MakeArray",box2d.b2FixtureProxy.MakeArray);box2d.b2Fixture=function(){this.m_proxyCount=0;this.m_filter=new box2d.b2Filter};goog.exportSymbol("box2d.b2Fixture",box2d.b2Fixture);box2d.b2Fixture.prototype.m_density=0;
goog.exportProperty(box2d.b2Fixture.prototype,"m_density",box2d.b2Fixture.prototype.m_density);box2d.b2Fixture.prototype.m_next=null;goog.exportProperty(box2d.b2Fixture.prototype,"m_next",box2d.b2Fixture.prototype.m_next);box2d.b2Fixture.prototype.m_body=null;goog.exportProperty(box2d.b2Fixture.prototype,"m_body",box2d.b2Fixture.prototype.m_body);box2d.b2Fixture.prototype.m_shape=null;goog.exportProperty(box2d.b2Fixture.prototype,"m_shape",box2d.b2Fixture.prototype.m_shape);
box2d.b2Fixture.prototype.m_friction=0;goog.exportProperty(box2d.b2Fixture.prototype,"m_friction",box2d.b2Fixture.prototype.m_friction);box2d.b2Fixture.prototype.m_restitution=0;goog.exportProperty(box2d.b2Fixture.prototype,"m_restitution",box2d.b2Fixture.prototype.m_restitution);box2d.b2Fixture.prototype.m_proxies=null;goog.exportProperty(box2d.b2Fixture.prototype,"m_proxies",box2d.b2Fixture.prototype.m_proxies);box2d.b2Fixture.prototype.m_proxyCount=0;
goog.exportProperty(box2d.b2Fixture.prototype,"m_proxyCount",box2d.b2Fixture.prototype.m_proxyCount);box2d.b2Fixture.prototype.m_filter=null;goog.exportProperty(box2d.b2Fixture.prototype,"m_filter",box2d.b2Fixture.prototype.m_filter);box2d.b2Fixture.prototype.m_isSensor=!1;goog.exportProperty(box2d.b2Fixture.prototype,"m_isSensor",box2d.b2Fixture.prototype.m_isSensor);box2d.b2Fixture.prototype.m_userData=null;goog.exportProperty(box2d.b2Fixture.prototype,"m_userData",box2d.b2Fixture.prototype.m_userData);
box2d.b2Fixture.prototype.GetType=function(){return this.m_shape.GetType()};goog.exportProperty(box2d.b2Fixture.prototype,"GetType",box2d.b2Fixture.prototype.GetType);box2d.b2Fixture.prototype.GetShape=function(){return this.m_shape};goog.exportProperty(box2d.b2Fixture.prototype,"GetShape",box2d.b2Fixture.prototype.GetShape);box2d.b2Fixture.prototype.IsSensor=function(){return this.m_isSensor};goog.exportProperty(box2d.b2Fixture.prototype,"IsSensor",box2d.b2Fixture.prototype.IsSensor);
box2d.b2Fixture.prototype.GetFilterData=function(a){a=a||new box2d.b2Filter;return a.Copy(this.m_filter)};goog.exportProperty(box2d.b2Fixture.prototype,"GetFilterData",box2d.b2Fixture.prototype.GetFilterData);box2d.b2Fixture.prototype.GetUserData=function(){return this.m_userData};goog.exportProperty(box2d.b2Fixture.prototype,"GetUserData",box2d.b2Fixture.prototype.GetUserData);box2d.b2Fixture.prototype.SetUserData=function(a){this.m_userData=a};
goog.exportProperty(box2d.b2Fixture.prototype,"SetUserData",box2d.b2Fixture.prototype.SetUserData);box2d.b2Fixture.prototype.GetBody=function(){return this.m_body};goog.exportProperty(box2d.b2Fixture.prototype,"GetBody",box2d.b2Fixture.prototype.GetBody);box2d.b2Fixture.prototype.GetNext=function(){return this.m_next};goog.exportProperty(box2d.b2Fixture.prototype,"GetNext",box2d.b2Fixture.prototype.GetNext);box2d.b2Fixture.prototype.SetDensity=function(a){this.m_density=a};
goog.exportProperty(box2d.b2Fixture.prototype,"SetDensity",box2d.b2Fixture.prototype.SetDensity);box2d.b2Fixture.prototype.GetDensity=function(){return this.m_density};goog.exportProperty(box2d.b2Fixture.prototype,"GetDensity",box2d.b2Fixture.prototype.GetDensity);box2d.b2Fixture.prototype.GetFriction=function(){return this.m_friction};goog.exportProperty(box2d.b2Fixture.prototype,"GetFriction",box2d.b2Fixture.prototype.GetFriction);
box2d.b2Fixture.prototype.SetFriction=function(a){this.m_friction=a};goog.exportProperty(box2d.b2Fixture.prototype,"SetFriction",box2d.b2Fixture.prototype.SetFriction);box2d.b2Fixture.prototype.GetRestitution=function(){return this.m_restitution};goog.exportProperty(box2d.b2Fixture.prototype,"GetRestitution",box2d.b2Fixture.prototype.GetRestitution);box2d.b2Fixture.prototype.SetRestitution=function(a){this.m_restitution=a};goog.exportProperty(box2d.b2Fixture.prototype,"SetRestitution",box2d.b2Fixture.prototype.SetRestitution);
box2d.b2Fixture.prototype.TestPoint=function(a){return this.m_shape.TestPoint(this.m_body.GetTransform(),a)};goog.exportProperty(box2d.b2Fixture.prototype,"TestPoint",box2d.b2Fixture.prototype.TestPoint);box2d.b2Fixture.prototype.ComputeDistance=function(a,b,d){return this.m_shape.ComputeDistance(this.m_body.GetTransform(),a,b,d)};goog.exportProperty(box2d.b2Fixture.prototype,"ComputeDistance",box2d.b2Fixture.prototype.ComputeDistance);
box2d.b2Fixture.prototype.RayCast=function(a,b,d){return this.m_shape.RayCast(a,b,this.m_body.GetTransform(),d)};goog.exportProperty(box2d.b2Fixture.prototype,"RayCast",box2d.b2Fixture.prototype.RayCast);box2d.b2Fixture.prototype.GetMassData=function(a){a=a||new box2d.b2MassData;this.m_shape.ComputeMass(a,this.m_density);return a};goog.exportProperty(box2d.b2Fixture.prototype,"GetMassData",box2d.b2Fixture.prototype.GetMassData);
box2d.b2Fixture.prototype.GetAABB=function(a){box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<=a&&a<this.m_proxyCount);return this.m_proxies[a].aabb};goog.exportProperty(box2d.b2Fixture.prototype,"GetAABB",box2d.b2Fixture.prototype.GetAABB);
box2d.b2Fixture.prototype.Create=function(a,b){this.m_userData=b.userData;this.m_friction=b.friction;this.m_restitution=b.restitution;this.m_body=a;this.m_next=null;this.m_filter.Copy(b.filter);this.m_isSensor=b.isSensor;this.m_shape=b.shape.Clone();this.m_proxies=box2d.b2FixtureProxy.MakeArray(this.m_shape.GetChildCount());this.m_proxyCount=0;this.m_density=b.density};goog.exportProperty(box2d.b2Fixture.prototype,"Create",box2d.b2Fixture.prototype.Create);
box2d.b2Fixture.prototype.Destroy=function(){box2d.ENABLE_ASSERTS&&box2d.b2Assert(0===this.m_proxyCount);this.m_shape=null};goog.exportProperty(box2d.b2Fixture.prototype,"Destroy",box2d.b2Fixture.prototype.Destroy);
box2d.b2Fixture.prototype.CreateProxies=function(a,b){box2d.ENABLE_ASSERTS&&box2d.b2Assert(0===this.m_proxyCount);this.m_proxyCount=this.m_shape.GetChildCount();for(var d=0;d<this.m_proxyCount;++d){var e=this.m_proxies[d];this.m_shape.ComputeAABB(e.aabb,b,d);e.proxy=a.CreateProxy(e.aabb,e);e.fixture=this;e.childIndex=d}};goog.exportProperty(box2d.b2Fixture.prototype,"CreateProxies",box2d.b2Fixture.prototype.CreateProxies);
box2d.b2Fixture.prototype.DestroyProxies=function(a){for(var b=0;b<this.m_proxyCount;++b){var d=this.m_proxies[b];a.DestroyProxy(d.proxy);d.proxy=null}this.m_proxyCount=0};goog.exportProperty(box2d.b2Fixture.prototype,"DestroyProxies",box2d.b2Fixture.prototype.DestroyProxies);
box2d.b2Fixture.prototype.Synchronize=function(a,b,d){if(0!==this.m_proxyCount)for(var e=0;e<this.m_proxyCount;++e){var f=this.m_proxies[e],g=box2d.b2Fixture.prototype.Synchronize.s_aabb1,k=box2d.b2Fixture.prototype.Synchronize.s_aabb2;this.m_shape.ComputeAABB(g,b,e);this.m_shape.ComputeAABB(k,d,e);f.aabb.Combine2(g,k);g=box2d.b2Sub_V2_V2(d.p,b.p,box2d.b2Fixture.prototype.Synchronize.s_displacement);a.MoveProxy(f.proxy,f.aabb,g)}};goog.exportProperty(box2d.b2Fixture.prototype,"Synchronize",box2d.b2Fixture.prototype.Synchronize);
box2d.b2Fixture.prototype.Synchronize.s_aabb1=new box2d.b2AABB;box2d.b2Fixture.prototype.Synchronize.s_aabb2=new box2d.b2AABB;box2d.b2Fixture.prototype.Synchronize.s_displacement=new box2d.b2Vec2;box2d.b2Fixture.prototype.SetFilterData=function(a){this.m_filter.Copy(a);this.Refilter()};goog.exportProperty(box2d.b2Fixture.prototype,"SetFilterData",box2d.b2Fixture.prototype.SetFilterData);
box2d.b2Fixture.prototype.Refilter=function(){if(null!==this.m_body){for(var a=this.m_body.GetContactList();a;){var b=a.contact,d=b.GetFixtureA(),e=b.GetFixtureB();d!==this&&e!==this||b.FlagForFiltering();a=a.next}a=this.m_body.GetWorld();if(null!==a)for(a=a.m_contactManager.m_broadPhase,b=0;b<this.m_proxyCount;++b)a.TouchProxy(this.m_proxies[b].proxy)}};goog.exportProperty(box2d.b2Fixture.prototype,"Refilter",box2d.b2Fixture.prototype.Refilter);
box2d.b2Fixture.prototype.SetSensor=function(a){a!==this.m_isSensor&&(this.m_body.SetAwake(!0),this.m_isSensor=a)};goog.exportProperty(box2d.b2Fixture.prototype,"SetSensor",box2d.b2Fixture.prototype.SetSensor);
box2d.b2Fixture.prototype.Dump=function(a){box2d.DEBUG&&(box2d.b2Log("    /*box2d.b2FixtureDef*/ var fd = new box2d.b2FixtureDef();\n"),box2d.b2Log("    fd.friction = %.15f;\n",this.m_friction),box2d.b2Log("    fd.restitution = %.15f;\n",this.m_restitution),box2d.b2Log("    fd.density = %.15f;\n",this.m_density),box2d.b2Log("    fd.isSensor = %s;\n",this.m_isSensor?"true":"false"),box2d.b2Log("    fd.filter.categoryBits = %d;\n",this.m_filter.categoryBits),box2d.b2Log("    fd.filter.maskBits = %d;\n",
this.m_filter.maskBits),box2d.b2Log("    fd.filter.groupIndex = %d;\n",this.m_filter.groupIndex),this.m_shape.Dump(),box2d.b2Log("\n"),box2d.b2Log("    fd.shape = shape;\n"),box2d.b2Log("\n"),box2d.b2Log("    bodies[%d].CreateFixture(fd);\n",a))};goog.exportProperty(box2d.b2Fixture.prototype,"Dump",box2d.b2Fixture.prototype.Dump);box2d.b2BodyType={b2_unknown:-1,b2_staticBody:0,b2_kinematicBody:1,b2_dynamicBody:2,b2_bulletBody:3};goog.exportSymbol("box2d.b2BodyType",box2d.b2BodyType);
goog.exportProperty(box2d.b2BodyType,"b2_unknown",box2d.b2BodyType.b2_unknown);goog.exportProperty(box2d.b2BodyType,"b2_staticBody",box2d.b2BodyType.b2_staticBody);goog.exportProperty(box2d.b2BodyType,"b2_kinematicBody",box2d.b2BodyType.b2_kinematicBody);goog.exportProperty(box2d.b2BodyType,"b2_dynamicBody",box2d.b2BodyType.b2_dynamicBody);goog.exportProperty(box2d.b2BodyType,"b2_bulletBody",box2d.b2BodyType.b2_bulletBody);
box2d.b2BodyDef=function(){this.position=new box2d.b2Vec2(0,0);this.linearVelocity=new box2d.b2Vec2(0,0)};goog.exportSymbol("box2d.b2BodyDef",box2d.b2BodyDef);box2d.b2BodyDef.prototype.type=box2d.b2BodyType.b2_staticBody;goog.exportProperty(box2d.b2BodyDef.prototype,"type",box2d.b2BodyDef.prototype.type);box2d.b2BodyDef.prototype.position=null;goog.exportProperty(box2d.b2BodyDef.prototype,"position",box2d.b2BodyDef.prototype.position);box2d.b2BodyDef.prototype.angle=0;
goog.exportProperty(box2d.b2BodyDef.prototype,"angle",box2d.b2BodyDef.prototype.angle);box2d.b2BodyDef.prototype.linearVelocity=null;goog.exportProperty(box2d.b2BodyDef.prototype,"linearVelocity",box2d.b2BodyDef.prototype.linearVelocity);box2d.b2BodyDef.prototype.angularVelocity=0;goog.exportProperty(box2d.b2BodyDef.prototype,"angularVelocity",box2d.b2BodyDef.prototype.angularVelocity);box2d.b2BodyDef.prototype.linearDamping=0;goog.exportProperty(box2d.b2BodyDef.prototype,"linearDamping",box2d.b2BodyDef.prototype.linearDamping);
box2d.b2BodyDef.prototype.angularDamping=0;goog.exportProperty(box2d.b2BodyDef.prototype,"angularDamping",box2d.b2BodyDef.prototype.angularDamping);box2d.b2BodyDef.prototype.allowSleep=!0;goog.exportProperty(box2d.b2BodyDef.prototype,"allowSleep",box2d.b2BodyDef.prototype.allowSleep);box2d.b2BodyDef.prototype.awake=!0;goog.exportProperty(box2d.b2BodyDef.prototype,"awake",box2d.b2BodyDef.prototype.awake);box2d.b2BodyDef.prototype.fixedRotation=!1;
goog.exportProperty(box2d.b2BodyDef.prototype,"fixedRotation",box2d.b2BodyDef.prototype.fixedRotation);box2d.b2BodyDef.prototype.bullet=!1;goog.exportProperty(box2d.b2BodyDef.prototype,"bullet",box2d.b2BodyDef.prototype.bullet);box2d.b2BodyDef.prototype.active=!0;goog.exportProperty(box2d.b2BodyDef.prototype,"active",box2d.b2BodyDef.prototype.active);box2d.b2BodyDef.prototype.userData=null;goog.exportProperty(box2d.b2BodyDef.prototype,"userData",box2d.b2BodyDef.prototype.userData);
box2d.b2BodyDef.prototype.gravityScale=1;goog.exportProperty(box2d.b2BodyDef.prototype,"gravityScale",box2d.b2BodyDef.prototype.gravityScale);
box2d.b2Body=function(a,b){this.m_xf=new box2d.b2Transform;this.m_out_xf=new box2d.b2Transform;this.m_xf0=new box2d.b2Transform;this.m_sweep=new box2d.b2Sweep;this.m_out_sweep=new box2d.b2Sweep;this.m_linearVelocity=new box2d.b2Vec2;this.m_out_linearVelocity=new box2d.b2Vec2;this.m_force=new box2d.b2Vec2;box2d.ENABLE_ASSERTS&&box2d.b2Assert(a.position.IsValid());box2d.ENABLE_ASSERTS&&box2d.b2Assert(a.linearVelocity.IsValid());box2d.ENABLE_ASSERTS&&box2d.b2Assert(box2d.b2IsValid(a.angle));box2d.ENABLE_ASSERTS&&
box2d.b2Assert(box2d.b2IsValid(a.angularVelocity));box2d.ENABLE_ASSERTS&&box2d.b2Assert(box2d.b2IsValid(a.gravityScale)&&0<=a.gravityScale);box2d.ENABLE_ASSERTS&&box2d.b2Assert(box2d.b2IsValid(a.angularDamping)&&0<=a.angularDamping);box2d.ENABLE_ASSERTS&&box2d.b2Assert(box2d.b2IsValid(a.linearDamping)&&0<=a.linearDamping);a.bullet&&(this.m_flag_bulletFlag=!0);a.fixedRotation&&(this.m_flag_fixedRotationFlag=!0);a.allowSleep&&(this.m_flag_autoSleepFlag=!0);a.awake&&(this.m_flag_awakeFlag=!0);a.active&&
(this.m_flag_activeFlag=!0);this.m_world=b;this.m_xf.p.Copy(a.position);this.m_xf.q.SetAngle(a.angle);this.m_xf0.Copy(this.m_xf);this.m_sweep.localCenter.SetZero();this.m_sweep.c0.Copy(this.m_xf.p);this.m_sweep.c.Copy(this.m_xf.p);this.m_sweep.a0=a.angle;this.m_sweep.a=a.angle;this.m_sweep.alpha0=0;this.m_linearVelocity.Copy(a.linearVelocity);this.m_angularVelocity=a.angularVelocity;this.m_linearDamping=a.linearDamping;this.m_angularDamping=a.angularDamping;this.m_gravityScale=a.gravityScale;this.m_force.SetZero();
this.m_sleepTime=this.m_torque=0;this.m_type=a.type;this.m_invMass=a.type===box2d.b2BodyType.b2_dynamicBody?this.m_mass=1:this.m_mass=0;this.m_invI=this.m_I=0;this.m_userData=a.userData;this.m_fixtureList=null;this.m_fixtureCount=0;this.m_controllerList=null;this.m_controllerCount=0};goog.exportSymbol("box2d.b2Body",box2d.b2Body);box2d.b2Body.prototype.m_flag_islandFlag=!1;goog.exportProperty(box2d.b2Body.prototype,"m_flag_islandFlag",box2d.b2Body.prototype.m_flag_islandFlag);
box2d.b2Body.prototype.m_flag_awakeFlag=!1;goog.exportProperty(box2d.b2Body.prototype,"m_flag_awakeFlag",box2d.b2Body.prototype.m_flag_awakeFlag);box2d.b2Body.prototype.m_flag_autoSleepFlag=!1;goog.exportProperty(box2d.b2Body.prototype,"m_flag_autoSleepFlag",box2d.b2Body.prototype.m_flag_autoSleepFlag);box2d.b2Body.prototype.m_flag_bulletFlag=!1;goog.exportProperty(box2d.b2Body.prototype,"m_flag_bulletFlag",box2d.b2Body.prototype.m_flag_bulletFlag);
box2d.b2Body.prototype.m_flag_fixedRotationFlag=!1;goog.exportProperty(box2d.b2Body.prototype,"m_flag_fixedRotationFlag",box2d.b2Body.prototype.m_flag_fixedRotationFlag);box2d.b2Body.prototype.m_flag_activeFlag=!1;goog.exportProperty(box2d.b2Body.prototype,"m_flag_activeFlag",box2d.b2Body.prototype.m_flag_activeFlag);box2d.b2Body.prototype.m_flag_toiFlag=!1;goog.exportProperty(box2d.b2Body.prototype,"m_flag_toiFlag",box2d.b2Body.prototype.m_flag_toiFlag);box2d.b2Body.prototype.m_islandIndex=0;
goog.exportProperty(box2d.b2Body.prototype,"m_islandIndex",box2d.b2Body.prototype.m_islandIndex);box2d.b2Body.prototype.m_world=null;goog.exportProperty(box2d.b2Body.prototype,"m_world",box2d.b2Body.prototype.m_world);box2d.b2Body.prototype.m_xf=null;goog.exportProperty(box2d.b2Body.prototype,"m_xf",box2d.b2Body.prototype.m_xf);box2d.b2Body.prototype.m_out_xf=null;goog.exportProperty(box2d.b2Body.prototype,"m_out_xf",box2d.b2Body.prototype.m_out_xf);box2d.b2Body.prototype.m_xf0=null;
goog.exportProperty(box2d.b2Body.prototype,"m_xf0",box2d.b2Body.prototype.m_xf0);box2d.b2Body.prototype.m_sweep=null;goog.exportProperty(box2d.b2Body.prototype,"m_sweep",box2d.b2Body.prototype.m_sweep);box2d.b2Body.prototype.m_out_sweep=null;goog.exportProperty(box2d.b2Body.prototype,"m_out_sweep",box2d.b2Body.prototype.m_out_sweep);box2d.b2Body.prototype.m_jointList=null;goog.exportProperty(box2d.b2Body.prototype,"m_jointList",box2d.b2Body.prototype.m_jointList);
box2d.b2Body.prototype.m_contactList=null;goog.exportProperty(box2d.b2Body.prototype,"m_contactList",box2d.b2Body.prototype.m_contactList);box2d.b2Body.prototype.m_prev=null;goog.exportProperty(box2d.b2Body.prototype,"m_prev",box2d.b2Body.prototype.m_prev);box2d.b2Body.prototype.m_next=null;goog.exportProperty(box2d.b2Body.prototype,"m_next",box2d.b2Body.prototype.m_next);box2d.b2Body.prototype.m_linearVelocity=null;goog.exportProperty(box2d.b2Body.prototype,"m_linearVelocity",box2d.b2Body.prototype.m_linearVelocity);
box2d.b2Body.prototype.m_out_linearVelocity=null;goog.exportProperty(box2d.b2Body.prototype,"m_out_linearVelocity",box2d.b2Body.prototype.m_out_linearVelocity);box2d.b2Body.prototype.m_angularVelocity=0;goog.exportProperty(box2d.b2Body.prototype,"m_angularVelocity",box2d.b2Body.prototype.m_angularVelocity);box2d.b2Body.prototype.m_linearDamping=0;goog.exportProperty(box2d.b2Body.prototype,"m_linearDamping",box2d.b2Body.prototype.m_linearDamping);box2d.b2Body.prototype.m_angularDamping=0;
goog.exportProperty(box2d.b2Body.prototype,"m_angularDamping",box2d.b2Body.prototype.m_angularDamping);box2d.b2Body.prototype.m_gravityScale=1;goog.exportProperty(box2d.b2Body.prototype,"m_gravityScale",box2d.b2Body.prototype.m_gravityScale);box2d.b2Body.prototype.m_force=null;goog.exportProperty(box2d.b2Body.prototype,"m_force",box2d.b2Body.prototype.m_force);box2d.b2Body.prototype.m_torque=0;goog.exportProperty(box2d.b2Body.prototype,"m_torque",box2d.b2Body.prototype.m_torque);
box2d.b2Body.prototype.m_sleepTime=0;goog.exportProperty(box2d.b2Body.prototype,"m_sleepTime",box2d.b2Body.prototype.m_sleepTime);box2d.b2Body.prototype.m_type=box2d.b2BodyType.b2_staticBody;goog.exportProperty(box2d.b2Body.prototype,"m_type",box2d.b2Body.prototype.m_type);box2d.b2Body.prototype.m_mass=1;goog.exportProperty(box2d.b2Body.prototype,"m_mass",box2d.b2Body.prototype.m_mass);box2d.b2Body.prototype.m_invMass=1;goog.exportProperty(box2d.b2Body.prototype,"m_invMass",box2d.b2Body.prototype.m_invMass);
box2d.b2Body.prototype.m_I=0;goog.exportProperty(box2d.b2Body.prototype,"m_I",box2d.b2Body.prototype.m_I);box2d.b2Body.prototype.m_invI=0;goog.exportProperty(box2d.b2Body.prototype,"m_invI",box2d.b2Body.prototype.m_invI);box2d.b2Body.prototype.m_userData=null;goog.exportProperty(box2d.b2Body.prototype,"m_userData",box2d.b2Body.prototype.m_userData);box2d.b2Body.prototype.m_fixtureList=null;goog.exportProperty(box2d.b2Body.prototype,"m_fixtureList",box2d.b2Body.prototype.m_fixtureList);
box2d.b2Body.prototype.m_fixtureCount=0;goog.exportProperty(box2d.b2Body.prototype,"m_fixtureCount",box2d.b2Body.prototype.m_fixtureCount);box2d.b2Body.prototype.m_controllerList=null;goog.exportProperty(box2d.b2Body.prototype,"m_controllerList",box2d.b2Body.prototype.m_controllerList);box2d.b2Body.prototype.m_controllerCount=0;goog.exportProperty(box2d.b2Body.prototype,"m_controllerCount",box2d.b2Body.prototype.m_controllerCount);
box2d.b2Body.prototype.CreateFixture=function(a,b){if(a instanceof box2d.b2FixtureDef)return this.CreateFixture_Def(a);if(a instanceof box2d.b2Shape&&"number"===typeof b)return this.CreateFixture_Shape_Density(a,b);throw Error();};goog.exportProperty(box2d.b2Body.prototype,"CreateFixture",box2d.b2Body.prototype.CreateFixture);
box2d.b2Body.prototype.CreateFixture_Def=function(a){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!this.m_world.IsLocked());if(this.m_world.IsLocked())return null;var b=new box2d.b2Fixture;b.Create(this,a);this.m_flag_activeFlag&&b.CreateProxies(this.m_world.m_contactManager.m_broadPhase,this.m_xf);b.m_next=this.m_fixtureList;this.m_fixtureList=b;++this.m_fixtureCount;b.m_body=this;0<b.m_density&&this.ResetMassData();this.m_world.m_flag_newFixture=!0;return b};
goog.exportProperty(box2d.b2Body.prototype,"CreateFixture_Def",box2d.b2Body.prototype.CreateFixture_Def);box2d.b2Body.prototype.CreateFixture_Shape_Density=function(a,b){var d=box2d.b2Body.prototype.CreateFixture_Shape_Density.s_def;d.shape=a;d.density="number"===typeof b?b:0;return this.CreateFixture_Def(d)};goog.exportProperty(box2d.b2Body.prototype,"CreateFixture_Shape_Density",box2d.b2Body.prototype.CreateFixture_Shape_Density);box2d.b2Body.prototype.CreateFixture_Shape_Density.s_def=new box2d.b2FixtureDef;
box2d.b2Body.prototype.DestroyFixture=function(a){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!this.m_world.IsLocked());if(!this.m_world.IsLocked()){box2d.ENABLE_ASSERTS&&box2d.b2Assert(a.m_body===this);box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<this.m_fixtureCount);for(var b=this.m_fixtureList,d=null,e=!1;null!==b;){if(b===a){d?d.m_next=a.m_next:this.m_fixtureList=a.m_next;e=!0;break}d=b;b=b.m_next}box2d.ENABLE_ASSERTS&&box2d.b2Assert(e);for(b=this.m_contactList;b;){var d=b.contact,b=b.next,e=d.GetFixtureA(),
f=d.GetFixtureB();a!==e&&a!==f||this.m_world.m_contactManager.Destroy(d)}this.m_flag_activeFlag&&a.DestroyProxies(this.m_world.m_contactManager.m_broadPhase);a.Destroy();a.m_body=null;a.m_next=null;--this.m_fixtureCount;this.ResetMassData()}};goog.exportProperty(box2d.b2Body.prototype,"DestroyFixture",box2d.b2Body.prototype.DestroyFixture);
box2d.b2Body.prototype.SetTransform=function(a,b,d){if(a instanceof box2d.b2Vec2&&"number"===typeof b)this.SetTransform_X_Y_A(a.x,a.y,b);else if(a instanceof box2d.b2Transform)this.SetTransform_X_Y_A(a.p.x,a.p.y,a.GetAngle());else if("number"===typeof a&&"number"===typeof b&&"number"===typeof d)this.SetTransform_X_Y_A(a,b,d);else throw Error();};goog.exportProperty(box2d.b2Body.prototype,"SetTransform",box2d.b2Body.prototype.SetTransform);
box2d.b2Body.prototype.SetTransform_V2_A=function(a,b){this.SetTransform_X_Y_A(a.x,a.y,b)};goog.exportProperty(box2d.b2Body.prototype,"SetTransform_V2_A",box2d.b2Body.prototype.SetTransform_V2_A);
box2d.b2Body.prototype.SetTransform_X_Y_A=function(a,b,d){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!this.m_world.IsLocked());if(!this.m_world.IsLocked()&&(this.m_xf.p.x!==a||this.m_xf.p.y!==b||this.m_xf.q.GetAngle()!==d))for(this.m_xf.q.SetAngle(d),this.m_xf.p.Set(a,b),this.m_xf0.Copy(this.m_xf),box2d.b2Mul_X_V2(this.m_xf,this.m_sweep.localCenter,this.m_sweep.c),this.m_sweep.a=d,this.m_sweep.c0.Copy(this.m_sweep.c),this.m_sweep.a0=d,a=this.m_world.m_contactManager.m_broadPhase,b=this.m_fixtureList;b;b=
b.m_next)b.Synchronize(a,this.m_xf,this.m_xf)};goog.exportProperty(box2d.b2Body.prototype,"SetTransform_X_Y_A",box2d.b2Body.prototype.SetTransform_X_Y_A);box2d.b2Body.prototype.SetTransform_X=function(a){this.SetTransform_X_Y_A(a.p.x,a.p.y,a.GetAngle())};goog.exportProperty(box2d.b2Body.prototype,"SetTransform_X",box2d.b2Body.prototype.SetTransform_X);box2d.b2Body.prototype.GetTransform=function(a){a=a||this.m_out_xf;return a.Copy(this.m_xf)};
goog.exportProperty(box2d.b2Body.prototype,"GetTransform",box2d.b2Body.prototype.GetTransform);box2d.b2Body.prototype.GetPosition=function(a){a=a||this.m_out_xf.p;return a.Copy(this.m_xf.p)};goog.exportProperty(box2d.b2Body.prototype,"GetPosition",box2d.b2Body.prototype.GetPosition);box2d.b2Body.prototype.SetPosition=function(a){this.SetTransform_V2_A(a,this.GetAngle())};goog.exportProperty(box2d.b2Body.prototype,"SetPosition",box2d.b2Body.prototype.SetPosition);
box2d.b2Body.prototype.SetPositionXY=function(a,b){this.SetTransform_X_Y_A(a,b,this.GetAngle())};goog.exportProperty(box2d.b2Body.prototype,"SetPositionXY",box2d.b2Body.prototype.SetPositionXY);box2d.b2Body.prototype.GetRotation=function(a){a=a||this.m_out_xf.q;return a.Copy(this.m_xf.q)};goog.exportProperty(box2d.b2Body.prototype,"GetRotation",box2d.b2Body.prototype.GetRotation);box2d.b2Body.prototype.SetRotation=function(a){this.SetTransform_V2_A(this.GetPosition(),a.GetAngle())};
goog.exportProperty(box2d.b2Body.prototype,"SetRotation",box2d.b2Body.prototype.SetRotation);box2d.b2Body.prototype.GetAngle=function(){return this.m_sweep.a};goog.exportProperty(box2d.b2Body.prototype,"GetAngle",box2d.b2Body.prototype.GetAngle);box2d.b2Body.prototype.SetAngle=function(a){this.SetTransform_V2_A(this.GetPosition(),a)};goog.exportProperty(box2d.b2Body.prototype,"SetAngle",box2d.b2Body.prototype.SetAngle);box2d.b2Body.prototype.GetWorldCenter=function(a){a=a||this.m_out_sweep.c;return a.Copy(this.m_sweep.c)};
goog.exportProperty(box2d.b2Body.prototype,"GetWorldCenter",box2d.b2Body.prototype.GetWorldCenter);box2d.b2Body.prototype.GetLocalCenter=function(a){a=a||this.m_out_sweep.localCenter;return a.Copy(this.m_sweep.localCenter)};goog.exportProperty(box2d.b2Body.prototype,"GetLocalCenter",box2d.b2Body.prototype.GetLocalCenter);box2d.b2Body.prototype.SetLinearVelocity=function(a){this.m_type!==box2d.b2BodyType.b2_staticBody&&(0<box2d.b2Dot_V2_V2(a,a)&&this.SetAwake(!0),this.m_linearVelocity.Copy(a))};
goog.exportProperty(box2d.b2Body.prototype,"SetLinearVelocity",box2d.b2Body.prototype.SetLinearVelocity);box2d.b2Body.prototype.GetLinearVelocity=function(a){a=a||this.m_out_linearVelocity;return a.Copy(this.m_linearVelocity)};goog.exportProperty(box2d.b2Body.prototype,"GetLinearVelocity",box2d.b2Body.prototype.GetLinearVelocity);box2d.b2Body.prototype.SetAngularVelocity=function(a){this.m_type!==box2d.b2BodyType.b2_staticBody&&(0<a*a&&this.SetAwake(!0),this.m_angularVelocity=a)};
goog.exportProperty(box2d.b2Body.prototype,"SetAngularVelocity",box2d.b2Body.prototype.SetAngularVelocity);box2d.b2Body.prototype.GetAngularVelocity=function(){return this.m_angularVelocity};goog.exportProperty(box2d.b2Body.prototype,"GetAngularVelocity",box2d.b2Body.prototype.GetAngularVelocity);
box2d.b2Body.prototype.GetDefinition=function(a){a.type=this.GetType();a.allowSleep=this.m_flag_autoSleepFlag;a.angle=this.GetAngle();a.angularDamping=this.m_angularDamping;a.gravityScale=this.m_gravityScale;a.angularVelocity=this.m_angularVelocity;a.fixedRotation=this.m_flag_fixedRotationFlag;a.bullet=this.m_flag_bulletFlag;a.awake=this.m_flag_awakeFlag;a.linearDamping=this.m_linearDamping;a.linearVelocity.Copy(this.GetLinearVelocity());a.position.Copy(this.GetPosition());a.userData=this.GetUserData();
return a};goog.exportProperty(box2d.b2Body.prototype,"GetDefinition",box2d.b2Body.prototype.GetDefinition);box2d.b2Body.prototype.ApplyForce=function(a,b,d){this.m_type===box2d.b2BodyType.b2_dynamicBody&&(!this.m_flag_awakeFlag&&this.SetAwake(!0),this.m_flag_awakeFlag&&(this.m_force.x+=a.x,this.m_force.y+=a.y,this.m_torque+=(b.x-this.m_sweep.c.x)*a.y-(b.y-this.m_sweep.c.y)*a.x))};goog.exportProperty(box2d.b2Body.prototype,"ApplyForce",box2d.b2Body.prototype.ApplyForce);
box2d.b2Body.prototype.ApplyForceToCenter=function(a,b){this.m_type===box2d.b2BodyType.b2_dynamicBody&&(("boolean"===typeof b?b:1)&&!this.m_flag_awakeFlag&&this.SetAwake(!0),this.m_flag_awakeFlag&&(this.m_force.x+=a.x,this.m_force.y+=a.y))};goog.exportProperty(box2d.b2Body.prototype,"ApplyForceToCenter",box2d.b2Body.prototype.ApplyForceToCenter);
box2d.b2Body.prototype.ApplyTorque=function(a,b){this.m_type===box2d.b2BodyType.b2_dynamicBody&&(("boolean"===typeof b?b:1)&&!this.m_flag_awakeFlag&&this.SetAwake(!0),this.m_flag_awakeFlag&&(this.m_torque+=a))};goog.exportProperty(box2d.b2Body.prototype,"ApplyTorque",box2d.b2Body.prototype.ApplyTorque);
box2d.b2Body.prototype.ApplyLinearImpulse=function(a,b,d){this.m_type===box2d.b2BodyType.b2_dynamicBody&&(("boolean"===typeof d?d:1)&&!this.m_flag_awakeFlag&&this.SetAwake(!0),this.m_flag_awakeFlag&&(this.m_linearVelocity.x+=this.m_invMass*a.x,this.m_linearVelocity.y+=this.m_invMass*a.y,this.m_angularVelocity+=this.m_invI*((b.x-this.m_sweep.c.x)*a.y-(b.y-this.m_sweep.c.y)*a.x)))};goog.exportProperty(box2d.b2Body.prototype,"ApplyLinearImpulse",box2d.b2Body.prototype.ApplyLinearImpulse);
box2d.b2Body.prototype.ApplyLinearImpulseToCenter=function(a,b){this.m_type===box2d.b2BodyType.b2_dynamicBody&&(("boolean"===typeof b?b:1)&&!this.m_flag_awakeFlag&&this.SetAwake(!0),this.m_flag_awakeFlag&&(this.m_linearVelocity.x+=this.m_invMass*a.x,this.m_linearVelocity.y+=this.m_invMass*a.y))};goog.exportProperty(box2d.b2Body.prototype,"ApplyLinearImpulseToCenter",box2d.b2Body.prototype.ApplyLinearImpulseToCenter);
box2d.b2Body.prototype.ApplyAngularImpulse=function(a,b){this.m_type===box2d.b2BodyType.b2_dynamicBody&&(("boolean"===typeof b?b:1)&&!this.m_flag_awakeFlag&&this.SetAwake(!0),this.m_flag_awakeFlag&&(this.m_angularVelocity+=this.m_invI*a))};goog.exportProperty(box2d.b2Body.prototype,"ApplyAngularImpulse",box2d.b2Body.prototype.ApplyAngularImpulse);box2d.b2Body.prototype.GetMass=function(){return this.m_mass};goog.exportProperty(box2d.b2Body.prototype,"GetMass",box2d.b2Body.prototype.GetMass);
box2d.b2Body.prototype.GetInertia=function(){return this.m_I+this.m_mass*box2d.b2Dot_V2_V2(this.m_sweep.localCenter,this.m_sweep.localCenter)};goog.exportProperty(box2d.b2Body.prototype,"GetInertia",box2d.b2Body.prototype.GetInertia);box2d.b2Body.prototype.GetMassData=function(a){a.mass=this.m_mass;a.I=this.m_I+this.m_mass*box2d.b2Dot_V2_V2(this.m_sweep.localCenter,this.m_sweep.localCenter);a.center.Copy(this.m_sweep.localCenter);return a};
goog.exportProperty(box2d.b2Body.prototype,"GetMassData",box2d.b2Body.prototype.GetMassData);
box2d.b2Body.prototype.SetMassData=function(a){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!this.m_world.IsLocked());if(!this.m_world.IsLocked()&&this.m_type===box2d.b2BodyType.b2_dynamicBody){this.m_invI=this.m_I=this.m_invMass=0;this.m_mass=a.mass;0>=this.m_mass&&(this.m_mass=1);this.m_invMass=1/this.m_mass;0<a.I&&!this.m_flag_fixedRotationFlag&&(this.m_I=a.I-this.m_mass*box2d.b2Dot_V2_V2(a.center,a.center),box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<this.m_I),this.m_invI=1/this.m_I);var b=box2d.b2Body.prototype.SetMassData.s_oldCenter.Copy(this.m_sweep.c);
this.m_sweep.localCenter.Copy(a.center);box2d.b2Mul_X_V2(this.m_xf,this.m_sweep.localCenter,this.m_sweep.c);this.m_sweep.c0.Copy(this.m_sweep.c);box2d.b2AddCross_V2_S_V2(this.m_linearVelocity,this.m_angularVelocity,box2d.b2Sub_V2_V2(this.m_sweep.c,b,box2d.b2Vec2.s_t0),this.m_linearVelocity)}};goog.exportProperty(box2d.b2Body.prototype,"SetMassData",box2d.b2Body.prototype.SetMassData);box2d.b2Body.prototype.SetMassData.s_oldCenter=new box2d.b2Vec2;
box2d.b2Body.prototype.ResetMassData=function(){this.m_invI=this.m_I=this.m_invMass=this.m_mass=0;this.m_sweep.localCenter.SetZero();if(this.m_type===box2d.b2BodyType.b2_staticBody||this.m_type===box2d.b2BodyType.b2_kinematicBody)this.m_sweep.c0.Copy(this.m_xf.p),this.m_sweep.c.Copy(this.m_xf.p),this.m_sweep.a0=this.m_sweep.a;else{box2d.ENABLE_ASSERTS&&box2d.b2Assert(this.m_type===box2d.b2BodyType.b2_dynamicBody);for(var a=box2d.b2Body.prototype.ResetMassData.s_localCenter.SetZero(),b=this.m_fixtureList;b;b=
b.m_next)if(0!==b.m_density){var d=b.GetMassData(box2d.b2Body.prototype.ResetMassData.s_massData);this.m_mass+=d.mass;a.x+=d.center.x*d.mass;a.y+=d.center.y*d.mass;this.m_I+=d.I}0<this.m_mass?(this.m_invMass=1/this.m_mass,a.x*=this.m_invMass,a.y*=this.m_invMass):this.m_invMass=this.m_mass=1;0<this.m_I&&!this.m_flag_fixedRotationFlag?(this.m_I-=this.m_mass*box2d.b2Dot_V2_V2(a,a),box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<this.m_I),this.m_invI=1/this.m_I):this.m_invI=this.m_I=0;b=box2d.b2Body.prototype.ResetMassData.s_oldCenter.Copy(this.m_sweep.c);
this.m_sweep.localCenter.Copy(a);box2d.b2Mul_X_V2(this.m_xf,this.m_sweep.localCenter,this.m_sweep.c);this.m_sweep.c0.Copy(this.m_sweep.c);box2d.b2AddCross_V2_S_V2(this.m_linearVelocity,this.m_angularVelocity,box2d.b2Sub_V2_V2(this.m_sweep.c,b,box2d.b2Vec2.s_t0),this.m_linearVelocity)}};goog.exportProperty(box2d.b2Body.prototype,"ResetMassData",box2d.b2Body.prototype.ResetMassData);box2d.b2Body.prototype.ResetMassData.s_localCenter=new box2d.b2Vec2;
box2d.b2Body.prototype.ResetMassData.s_oldCenter=new box2d.b2Vec2;box2d.b2Body.prototype.ResetMassData.s_massData=new box2d.b2MassData;box2d.b2Body.prototype.GetWorldPoint=function(a,b){return box2d.b2Mul_X_V2(this.m_xf,a,b)};goog.exportProperty(box2d.b2Body.prototype,"GetWorldPoint",box2d.b2Body.prototype.GetWorldPoint);box2d.b2Body.prototype.GetWorldVector=function(a,b){return box2d.b2Mul_R_V2(this.m_xf.q,a,b)};goog.exportProperty(box2d.b2Body.prototype,"GetWorldVector",box2d.b2Body.prototype.GetWorldVector);
box2d.b2Body.prototype.GetLocalPoint=function(a,b){return box2d.b2MulT_X_V2(this.m_xf,a,b)};goog.exportProperty(box2d.b2Body.prototype,"GetLocalPoint",box2d.b2Body.prototype.GetLocalPoint);box2d.b2Body.prototype.GetLocalVector=function(a,b){return box2d.b2MulT_R_V2(this.m_xf.q,a,b)};goog.exportProperty(box2d.b2Body.prototype,"GetLocalVector",box2d.b2Body.prototype.GetLocalVector);
box2d.b2Body.prototype.GetLinearVelocityFromWorldPoint=function(a,b){return box2d.b2AddCross_V2_S_V2(this.m_linearVelocity,this.m_angularVelocity,box2d.b2Sub_V2_V2(a,this.m_sweep.c,box2d.b2Vec2.s_t0),b)};goog.exportProperty(box2d.b2Body.prototype,"GetLinearVelocityFromWorldPoint",box2d.b2Body.prototype.GetLinearVelocityFromWorldPoint);box2d.b2Body.prototype.GetLinearVelocityFromLocalPoint=function(a,b){return this.GetLinearVelocityFromWorldPoint(this.GetWorldPoint(a,b),b)};
goog.exportProperty(box2d.b2Body.prototype,"GetLinearVelocityFromLocalPoint",box2d.b2Body.prototype.GetLinearVelocityFromLocalPoint);box2d.b2Body.prototype.GetLinearDamping=function(){return this.m_linearDamping};goog.exportProperty(box2d.b2Body.prototype,"GetLinearDamping",box2d.b2Body.prototype.GetLinearDamping);box2d.b2Body.prototype.SetLinearDamping=function(a){this.m_linearDamping=a};goog.exportProperty(box2d.b2Body.prototype,"SetLinearDamping",box2d.b2Body.prototype.SetLinearDamping);
box2d.b2Body.prototype.GetAngularDamping=function(){return this.m_angularDamping};goog.exportProperty(box2d.b2Body.prototype,"GetAngularDamping",box2d.b2Body.prototype.GetAngularDamping);box2d.b2Body.prototype.SetAngularDamping=function(a){this.m_angularDamping=a};goog.exportProperty(box2d.b2Body.prototype,"SetAngularDamping",box2d.b2Body.prototype.SetAngularDamping);box2d.b2Body.prototype.GetGravityScale=function(){return this.m_gravityScale};
goog.exportProperty(box2d.b2Body.prototype,"GetGravityScale",box2d.b2Body.prototype.GetGravityScale);box2d.b2Body.prototype.SetGravityScale=function(a){this.m_gravityScale=a};goog.exportProperty(box2d.b2Body.prototype,"SetGravityScale",box2d.b2Body.prototype.SetGravityScale);
box2d.b2Body.prototype.SetType=function(a){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!this.m_world.IsLocked());if(!this.m_world.IsLocked()&&this.m_type!==a){this.m_type=a;this.ResetMassData();this.m_type===box2d.b2BodyType.b2_staticBody&&(this.m_linearVelocity.SetZero(),this.m_angularVelocity=0,this.m_sweep.a0=this.m_sweep.a,this.m_sweep.c0.Copy(this.m_sweep.c),this.SynchronizeFixtures());this.SetAwake(!0);this.m_force.SetZero();this.m_torque=0;for(a=this.m_contactList;a;){var b=a;a=a.next;this.m_world.m_contactManager.Destroy(b.contact)}this.m_contactList=
null;a=this.m_world.m_contactManager.m_broadPhase;for(b=this.m_fixtureList;b;b=b.m_next)for(var d=b.m_proxyCount,e=0;e<d;++e)a.TouchProxy(b.m_proxies[e].proxy)}};goog.exportProperty(box2d.b2Body.prototype,"SetType",box2d.b2Body.prototype.SetType);box2d.b2Body.prototype.GetType=function(){return this.m_type};goog.exportProperty(box2d.b2Body.prototype,"GetType",box2d.b2Body.prototype.GetType);box2d.b2Body.prototype.SetBullet=function(a){this.m_flag_bulletFlag=a};
goog.exportProperty(box2d.b2Body.prototype,"SetBullet",box2d.b2Body.prototype.SetBullet);box2d.b2Body.prototype.IsBullet=function(){return this.m_flag_bulletFlag};goog.exportProperty(box2d.b2Body.prototype,"IsBullet",box2d.b2Body.prototype.IsBullet);box2d.b2Body.prototype.SetSleepingAllowed=function(a){a?this.m_flag_autoSleepFlag=!0:(this.m_flag_autoSleepFlag=!1,this.SetAwake(!0))};goog.exportProperty(box2d.b2Body.prototype,"SetSleepingAllowed",box2d.b2Body.prototype.SetSleepingAllowed);
box2d.b2Body.prototype.IsSleepingAllowed=function(){return this.m_flag_autoSleepFlag};goog.exportProperty(box2d.b2Body.prototype,"IsSleepingAllowed",box2d.b2Body.prototype.IsSleepingAllowed);box2d.b2Body.prototype.SetAwake=function(a){a?this.m_flag_awakeFlag||(this.m_flag_awakeFlag=!0,this.m_sleepTime=0):(this.m_flag_awakeFlag=!1,this.m_sleepTime=0,this.m_linearVelocity.SetZero(),this.m_angularVelocity=0,this.m_force.SetZero(),this.m_torque=0)};
goog.exportProperty(box2d.b2Body.prototype,"SetAwake",box2d.b2Body.prototype.SetAwake);box2d.b2Body.prototype.IsAwake=function(){return this.m_flag_awakeFlag};goog.exportProperty(box2d.b2Body.prototype,"IsAwake",box2d.b2Body.prototype.IsAwake);
box2d.b2Body.prototype.SetActive=function(a){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!this.m_world.IsLocked());if(a!==this.IsActive())if(a){this.m_flag_activeFlag=!0;a=this.m_world.m_contactManager.m_broadPhase;for(var b=this.m_fixtureList;b;b=b.m_next)b.CreateProxies(a,this.m_xf)}else{this.m_flag_activeFlag=!1;a=this.m_world.m_contactManager.m_broadPhase;for(b=this.m_fixtureList;b;b=b.m_next)b.DestroyProxies(a);for(a=this.m_contactList;a;)b=a,a=a.next,this.m_world.m_contactManager.Destroy(b.contact);
this.m_contactList=null}};goog.exportProperty(box2d.b2Body.prototype,"SetActive",box2d.b2Body.prototype.SetActive);box2d.b2Body.prototype.IsActive=function(){return this.m_flag_activeFlag};goog.exportProperty(box2d.b2Body.prototype,"IsActive",box2d.b2Body.prototype.IsActive);box2d.b2Body.prototype.SetFixedRotation=function(a){this.m_flag_fixedRotationFlag!==a&&(this.m_flag_fixedRotationFlag=a,this.m_angularVelocity=0,this.ResetMassData())};
goog.exportProperty(box2d.b2Body.prototype,"SetFixedRotation",box2d.b2Body.prototype.SetFixedRotation);box2d.b2Body.prototype.IsFixedRotation=function(){return this.m_flag_fixedRotationFlag};goog.exportProperty(box2d.b2Body.prototype,"IsFixedRotation",box2d.b2Body.prototype.IsFixedRotation);box2d.b2Body.prototype.GetFixtureList=function(){return this.m_fixtureList};goog.exportProperty(box2d.b2Body.prototype,"GetFixtureList",box2d.b2Body.prototype.GetFixtureList);
box2d.b2Body.prototype.GetJointList=function(){return this.m_jointList};goog.exportProperty(box2d.b2Body.prototype,"GetJointList",box2d.b2Body.prototype.GetJointList);box2d.b2Body.prototype.GetContactList=function(){return this.m_contactList};goog.exportProperty(box2d.b2Body.prototype,"GetContactList",box2d.b2Body.prototype.GetContactList);box2d.b2Body.prototype.GetNext=function(){return this.m_next};goog.exportProperty(box2d.b2Body.prototype,"GetNext",box2d.b2Body.prototype.GetNext);
box2d.b2Body.prototype.GetUserData=function(){return this.m_userData};goog.exportProperty(box2d.b2Body.prototype,"GetUserData",box2d.b2Body.prototype.GetUserData);box2d.b2Body.prototype.SetUserData=function(a){this.m_userData=a};goog.exportProperty(box2d.b2Body.prototype,"SetUserData",box2d.b2Body.prototype.SetUserData);box2d.b2Body.prototype.GetWorld=function(){return this.m_world};goog.exportProperty(box2d.b2Body.prototype,"GetWorld",box2d.b2Body.prototype.GetWorld);
box2d.b2Body.prototype.SynchronizeFixtures=function(){var a=box2d.b2Body.prototype.SynchronizeFixtures.s_xf1;a.q.SetAngle(this.m_sweep.a0);box2d.b2Mul_R_V2(a.q,this.m_sweep.localCenter,a.p);box2d.b2Sub_V2_V2(this.m_sweep.c0,a.p,a.p);for(var b=this.m_world.m_contactManager.m_broadPhase,d=this.m_fixtureList;d;d=d.m_next)d.Synchronize(b,a,this.m_xf)};goog.exportProperty(box2d.b2Body.prototype,"SynchronizeFixtures",box2d.b2Body.prototype.SynchronizeFixtures);
box2d.b2Body.prototype.SynchronizeFixtures.s_xf1=new box2d.b2Transform;box2d.b2Body.prototype.SynchronizeTransform=function(){this.m_xf.q.SetAngle(this.m_sweep.a);box2d.b2Mul_R_V2(this.m_xf.q,this.m_sweep.localCenter,this.m_xf.p);box2d.b2Sub_V2_V2(this.m_sweep.c,this.m_xf.p,this.m_xf.p)};goog.exportProperty(box2d.b2Body.prototype,"SynchronizeTransform",box2d.b2Body.prototype.SynchronizeTransform);
box2d.b2Body.prototype.ShouldCollide=function(a){return this.m_type===box2d.b2BodyType.b2_staticBody&&a.m_type===box2d.b2BodyType.b2_staticBody?!1:this.ShouldCollideConnected(a)};goog.exportProperty(box2d.b2Body.prototype,"ShouldCollide",box2d.b2Body.prototype.ShouldCollide);box2d.b2Body.prototype.ShouldCollideConnected=function(a){for(var b=this.m_jointList;b;b=b.next)if(b.other===a&&!b.joint.m_collideConnected)return!1;return!0};
goog.exportProperty(box2d.b2Body.prototype,"ShouldCollideConnected",box2d.b2Body.prototype.ShouldCollideConnected);box2d.b2Body.prototype.Advance=function(a){this.m_sweep.Advance(a);this.m_sweep.c.Copy(this.m_sweep.c0);this.m_sweep.a=this.m_sweep.a0;this.m_xf.q.SetAngle(this.m_sweep.a);box2d.b2Mul_R_V2(this.m_xf.q,this.m_sweep.localCenter,this.m_xf.p);box2d.b2Sub_V2_V2(this.m_sweep.c,this.m_xf.p,this.m_xf.p)};goog.exportProperty(box2d.b2Body.prototype,"Advance",box2d.b2Body.prototype.Advance);
box2d.b2Body.prototype.Dump=function(){if(box2d.DEBUG){var a=this.m_islandIndex;box2d.b2Log("{\n");box2d.b2Log("  /*box2d.b2BodyDef*/ var bd = new box2d.b2BodyDef();\n");var b="";switch(this.m_type){case box2d.b2BodyType.b2_staticBody:b="box2d.b2BodyType.b2_staticBody";break;case box2d.b2BodyType.b2_kinematicBody:b="box2d.b2BodyType.b2_kinematicBody";break;case box2d.b2BodyType.b2_dynamicBody:b="box2d.b2BodyType.b2_dynamicBody";break;default:box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1)}box2d.b2Log("  bd.type = %s;\n",
b);box2d.b2Log("  bd.position.Set(%.15f, %.15f);\n",this.m_xf.p.x,this.m_xf.p.y);box2d.b2Log("  bd.angle = %.15f;\n",this.m_sweep.a);box2d.b2Log("  bd.linearVelocity.Set(%.15f, %.15f);\n",this.m_linearVelocity.x,this.m_linearVelocity.y);box2d.b2Log("  bd.angularVelocity = %.15f;\n",this.m_angularVelocity);box2d.b2Log("  bd.linearDamping = %.15f;\n",this.m_linearDamping);box2d.b2Log("  bd.angularDamping = %.15f;\n",this.m_angularDamping);box2d.b2Log("  bd.allowSleep = %s;\n",this.m_flag_autoSleepFlag?
"true":"false");box2d.b2Log("  bd.awake = %s;\n",this.m_flag_awakeFlag?"true":"false");box2d.b2Log("  bd.fixedRotation = %s;\n",this.m_flag_fixedRotationFlag?"true":"false");box2d.b2Log("  bd.bullet = %s;\n",this.m_flag_bulletFlag?"true":"false");box2d.b2Log("  bd.active = %s;\n",this.m_flag_activeFlag?"true":"false");box2d.b2Log("  bd.gravityScale = %.15f;\n",this.m_gravityScale);box2d.b2Log("\n");box2d.b2Log("  bodies[%d] = this.m_world.CreateBody(bd);\n",this.m_islandIndex);box2d.b2Log("\n");for(b=
this.m_fixtureList;b;b=b.m_next)box2d.b2Log("  {\n"),b.Dump(a),box2d.b2Log("  }\n");box2d.b2Log("}\n")}};goog.exportProperty(box2d.b2Body.prototype,"Dump",box2d.b2Body.prototype.Dump);box2d.b2Body.prototype.GetControllerList=function(){return this.m_controllerList};goog.exportProperty(box2d.b2Body.prototype,"GetControllerList",box2d.b2Body.prototype.GetControllerList);box2d.b2Body.prototype.GetControllerCount=function(){return this.m_controllerCount};
goog.exportProperty(box2d.b2Body.prototype,"GetControllerCount",box2d.b2Body.prototype.GetControllerCount);box2d.b2Profile=function(){};goog.exportSymbol("box2d.b2Profile",box2d.b2Profile);box2d.b2Profile.prototype.step=0;goog.exportProperty(box2d.b2Profile.prototype,"step",box2d.b2Profile.prototype.step);box2d.b2Profile.prototype.collide=0;goog.exportProperty(box2d.b2Profile.prototype,"collide",box2d.b2Profile.prototype.collide);box2d.b2Profile.prototype.solve=0;
goog.exportProperty(box2d.b2Profile.prototype,"solve",box2d.b2Profile.prototype.solve);box2d.b2Profile.prototype.solveInit=0;goog.exportProperty(box2d.b2Profile.prototype,"solveInit",box2d.b2Profile.prototype.solveInit);box2d.b2Profile.prototype.solveVelocity=0;goog.exportProperty(box2d.b2Profile.prototype,"solveVelocity",box2d.b2Profile.prototype.solveVelocity);box2d.b2Profile.prototype.solvePosition=0;goog.exportProperty(box2d.b2Profile.prototype,"solvePosition",box2d.b2Profile.prototype.solvePosition);
box2d.b2Profile.prototype.broadphase=0;goog.exportProperty(box2d.b2Profile.prototype,"broadphase",box2d.b2Profile.prototype.broadphase);box2d.b2Profile.prototype.solveTOI=0;goog.exportProperty(box2d.b2Profile.prototype,"solveTOI",box2d.b2Profile.prototype.solveTOI);box2d.b2Profile.prototype.Reset=function(){this.solveTOI=this.broadphase=this.solvePosition=this.solveVelocity=this.solveInit=this.solve=this.collide=this.step=0;return this};goog.exportProperty(box2d.b2Profile.prototype,"Reset",box2d.b2Profile.prototype.Reset);
box2d.b2TimeStep=function(){};goog.exportSymbol("box2d.b2TimeStep",box2d.b2TimeStep);box2d.b2TimeStep.prototype.dt=0;goog.exportProperty(box2d.b2TimeStep.prototype,"dt",box2d.b2TimeStep.prototype.dt);box2d.b2TimeStep.prototype.inv_dt=0;goog.exportProperty(box2d.b2TimeStep.prototype,"inv_dt",box2d.b2TimeStep.prototype.inv_dt);box2d.b2TimeStep.prototype.dtRatio=0;goog.exportProperty(box2d.b2TimeStep.prototype,"dtRatio",box2d.b2TimeStep.prototype.dtRatio);
box2d.b2TimeStep.prototype.velocityIterations=0;goog.exportProperty(box2d.b2TimeStep.prototype,"velocityIterations",box2d.b2TimeStep.prototype.velocityIterations);box2d.b2TimeStep.prototype.positionIterations=0;goog.exportProperty(box2d.b2TimeStep.prototype,"positionIterations",box2d.b2TimeStep.prototype.positionIterations);box2d.b2TimeStep.prototype.particleIterations=0;goog.exportProperty(box2d.b2TimeStep.prototype,"particleIterations",box2d.b2TimeStep.prototype.particleIterations);
box2d.b2TimeStep.prototype.warmStarting=!1;goog.exportProperty(box2d.b2TimeStep.prototype,"warmStarting",box2d.b2TimeStep.prototype.warmStarting);box2d.b2TimeStep.prototype.Copy=function(a){this.dt=a.dt;this.inv_dt=a.inv_dt;this.dtRatio=a.dtRatio;this.positionIterations=a.positionIterations;this.velocityIterations=a.velocityIterations;this.particleIterations=a.particleIterations;this.warmStarting=a.warmStarting;return this};goog.exportProperty(box2d.b2TimeStep.prototype,"Copy",box2d.b2TimeStep.prototype.Copy);
box2d.b2Position=function(){this.c=new box2d.b2Vec2};goog.exportSymbol("box2d.b2Position",box2d.b2Position);box2d.b2Position.prototype.c=null;goog.exportProperty(box2d.b2Position.prototype,"c",box2d.b2Position.prototype.c);box2d.b2Position.prototype.a=0;goog.exportProperty(box2d.b2Position.prototype,"a",box2d.b2Position.prototype.a);box2d.b2Position.MakeArray=function(a){return box2d.b2MakeArray(a,function(a){return new box2d.b2Position})};goog.exportProperty(box2d.b2Position,"MakeArray",box2d.b2Position.MakeArray);
box2d.b2Velocity=function(){this.v=new box2d.b2Vec2};goog.exportSymbol("box2d.b2Velocity",box2d.b2Velocity);box2d.b2Velocity.prototype.v=null;goog.exportProperty(box2d.b2Velocity.prototype,"v",box2d.b2Velocity.prototype.v);box2d.b2Velocity.prototype.w=0;goog.exportProperty(box2d.b2Velocity.prototype,"w",box2d.b2Velocity.prototype.w);box2d.b2Velocity.MakeArray=function(a){return box2d.b2MakeArray(a,function(a){return new box2d.b2Velocity})};goog.exportProperty(box2d.b2Velocity,"MakeArray",box2d.b2Velocity.MakeArray);
box2d.b2SolverData=function(){this.step=new box2d.b2TimeStep};goog.exportSymbol("box2d.b2SolverData",box2d.b2SolverData);box2d.b2SolverData.prototype.step=null;goog.exportProperty(box2d.b2SolverData.prototype,"step",box2d.b2SolverData.prototype.step);box2d.b2SolverData.prototype.positions=null;goog.exportProperty(box2d.b2SolverData.prototype,"positions",box2d.b2SolverData.prototype.positions);box2d.b2SolverData.prototype.velocities=null;
goog.exportProperty(box2d.b2SolverData.prototype,"velocities",box2d.b2SolverData.prototype.velocities);box2d.b2WorldCallbacks={};box2d.b2DestructionListener=function(){};goog.exportSymbol("box2d.b2DestructionListener",box2d.b2DestructionListener);box2d.b2DestructionListener.prototype.SayGoodbyeJoint=function(a){};goog.exportProperty(box2d.b2DestructionListener.prototype,"SayGoodbyeJoint",box2d.b2DestructionListener.prototype.SayGoodbyeJoint);
box2d.b2DestructionListener.prototype.SayGoodbyeFixture=function(a){};goog.exportProperty(box2d.b2DestructionListener.prototype,"SayGoodbyeFixture",box2d.b2DestructionListener.prototype.SayGoodbyeFixture);box2d.b2DestructionListener.prototype.SayGoodbyeParticleGroup=function(a){};box2d.b2DestructionListener.prototype.SayGoodbyeParticle=function(a,b){};box2d.b2ContactFilter=function(){};goog.exportSymbol("box2d.b2ContactFilter",box2d.b2ContactFilter);
box2d.b2ContactFilter.prototype.ShouldCollide=function(a,b){var d=a.GetBody(),e=b.GetBody();if(e.GetType()===box2d.b2BodyType.b2_staticBody&&d.GetType()===box2d.b2BodyType.b2_staticBody||!1===e.ShouldCollideConnected(d))return!1;d=a.GetFilterData();e=b.GetFilterData();return d.groupIndex===e.groupIndex&&0!==d.groupIndex?0<d.groupIndex:0!==(d.maskBits&e.categoryBits)&&0!==(d.categoryBits&e.maskBits)};goog.exportProperty(box2d.b2ContactFilter.prototype,"ShouldCollide",box2d.b2ContactFilter.prototype.ShouldCollide);
box2d.b2ContactFilter.prototype.ShouldCollideFixtureParticle=function(a,b,d){return!0};goog.exportProperty(box2d.b2ContactFilter.prototype,"ShouldCollideFixtureParticle",box2d.b2ContactFilter.prototype.ShouldCollideFixtureParticle);box2d.b2ContactFilter.prototype.ShouldCollideParticleParticle=function(a,b,d){return!0};goog.exportProperty(box2d.b2ContactFilter.prototype,"ShouldCollideParticleParticle",box2d.b2ContactFilter.prototype.ShouldCollideParticleParticle);
box2d.b2ContactFilter.b2_defaultFilter=new box2d.b2ContactFilter;box2d.b2ContactImpulse=function(){this.normalImpulses=box2d.b2MakeNumberArray(box2d.b2_maxManifoldPoints);this.tangentImpulses=box2d.b2MakeNumberArray(box2d.b2_maxManifoldPoints)};goog.exportSymbol("box2d.b2ContactImpulse",box2d.b2ContactImpulse);box2d.b2ContactImpulse.prototype.normalImpulses=null;goog.exportProperty(box2d.b2ContactImpulse.prototype,"normalImpulses",box2d.b2ContactImpulse.prototype.normalImpulses);
box2d.b2ContactImpulse.prototype.tangentImpulses=null;goog.exportProperty(box2d.b2ContactImpulse.prototype,"tangentImpulses",box2d.b2ContactImpulse.prototype.tangentImpulses);box2d.b2ContactImpulse.prototype.count=0;goog.exportProperty(box2d.b2ContactImpulse.prototype,"count",box2d.b2ContactImpulse.prototype.count);box2d.b2ContactListener=function(){};goog.exportSymbol("box2d.b2ContactListener",box2d.b2ContactListener);box2d.b2ContactListener.prototype.BeginContact=function(a){};
goog.exportProperty(box2d.b2ContactListener.prototype,"BeginContact",box2d.b2ContactListener.prototype.BeginContact);box2d.b2ContactListener.prototype.EndContact=function(a){};goog.exportProperty(box2d.b2ContactListener.prototype,"EndContact",box2d.b2ContactListener.prototype.EndContact);box2d.b2ContactListener.prototype.BeginContactFixtureParticle=function(a,b){};goog.exportProperty(box2d.b2ContactListener.prototype,"BeginContactFixtureParticle",box2d.b2ContactListener.prototype.BeginContactFixtureParticle);
box2d.b2ContactListener.prototype.EndContactFixtureParticle=function(a,b,d){};goog.exportProperty(box2d.b2ContactListener.prototype,"EndContactFixtureParticle",box2d.b2ContactListener.prototype.EndContactFixtureParticle);box2d.b2ContactListener.prototype.BeginContactParticleParticle=function(a,b){};goog.exportProperty(box2d.b2ContactListener.prototype,"BeginContactParticleParticle",box2d.b2ContactListener.prototype.BeginContactParticleParticle);
box2d.b2ContactListener.prototype.EndContactParticleParticle=function(a,b,d){};goog.exportProperty(box2d.b2ContactListener.prototype,"EndContactParticleParticle",box2d.b2ContactListener.prototype.EndContactParticleParticle);box2d.b2ContactListener.prototype.PreSolve=function(a,b){};goog.exportProperty(box2d.b2ContactListener.prototype,"PreSolve",box2d.b2ContactListener.prototype.PreSolve);box2d.b2ContactListener.prototype.PostSolve=function(a,b){};
goog.exportProperty(box2d.b2ContactListener.prototype,"PostSolve",box2d.b2ContactListener.prototype.PostSolve);box2d.b2ContactListener.b2_defaultListener=new box2d.b2ContactListener;goog.exportProperty(box2d.b2ContactListener,"b2_defaultListener",box2d.b2ContactListener.b2_defaultListener);box2d.b2QueryCallback=function(){};goog.exportSymbol("box2d.b2QueryCallback",box2d.b2QueryCallback);box2d.b2QueryCallback.prototype.ReportFixture=function(a){return!0};
goog.exportProperty(box2d.b2QueryCallback.prototype,"ReportFixture",box2d.b2QueryCallback.prototype.ReportFixture);box2d.b2QueryCallback.prototype.ReportParticle=function(a,b){return!1};goog.exportProperty(box2d.b2QueryCallback.prototype,"ReportParticle",box2d.b2QueryCallback.prototype.ReportParticle);box2d.b2QueryCallback.prototype.ShouldQueryParticleSystem=function(a){return!0};goog.exportProperty(box2d.b2QueryCallback.prototype,"ShouldQueryParticleSystem",box2d.b2QueryCallback.prototype.ShouldQueryParticleSystem);
box2d.b2RayCastCallback=function(){};goog.exportSymbol("box2d.b2RayCastCallback",box2d.b2RayCastCallback);box2d.b2RayCastCallback.prototype.ReportFixture=function(a,b,d,e){return e};goog.exportProperty(box2d.b2RayCastCallback.prototype,"ReportFixture",box2d.b2RayCastCallback.prototype.ReportFixture);box2d.b2RayCastCallback.prototype.ReportParticle=function(a,b,d,e,f){return 0};goog.exportProperty(box2d.b2RayCastCallback.prototype,"ReportParticle",box2d.b2RayCastCallback.prototype.ReportParticle);
box2d.b2RayCastCallback.prototype.ShouldQueryParticleSystem=function(a){return!0};goog.exportProperty(box2d.b2RayCastCallback.prototype,"ShouldQueryParticleSystem",box2d.b2RayCastCallback.prototype.ShouldQueryParticleSystem);box2d.b2MixFriction=function(a,b){return box2d.b2Sqrt(a*b)};goog.exportSymbol("box2d.b2MixFriction",box2d.b2MixFriction);box2d.b2MixRestitution=function(a,b){return a>b?a:b};goog.exportSymbol("box2d.b2MixRestitution",box2d.b2MixRestitution);box2d.b2ContactEdge=function(){};
goog.exportSymbol("box2d.b2ContactEdge",box2d.b2ContactEdge);box2d.b2ContactEdge.prototype.other=null;goog.exportProperty(box2d.b2ContactEdge.prototype,"other",box2d.b2ContactEdge.prototype.other);box2d.b2ContactEdge.prototype.contact=null;goog.exportProperty(box2d.b2ContactEdge.prototype,"contact",box2d.b2ContactEdge.prototype.contact);box2d.b2ContactEdge.prototype.prev=null;goog.exportProperty(box2d.b2ContactEdge.prototype,"prev",box2d.b2ContactEdge.prototype.prev);
box2d.b2ContactEdge.prototype.next=null;goog.exportProperty(box2d.b2ContactEdge.prototype,"next",box2d.b2ContactEdge.prototype.next);box2d.b2Contact=function(){this.m_nodeA=new box2d.b2ContactEdge;this.m_nodeB=new box2d.b2ContactEdge;this.m_manifold=new box2d.b2Manifold;this.m_oldManifold=new box2d.b2Manifold};goog.exportSymbol("box2d.b2Contact",box2d.b2Contact);box2d.b2Contact.prototype.m_flag_islandFlag=!1;goog.exportProperty(box2d.b2Contact.prototype,"m_flag_islandFlag",box2d.b2Contact.prototype.m_flag_islandFlag);
box2d.b2Contact.prototype.m_flag_touchingFlag=!1;goog.exportProperty(box2d.b2Contact.prototype,"m_flag_touchingFlag",box2d.b2Contact.prototype.m_flag_touchingFlag);box2d.b2Contact.prototype.m_flag_enabledFlag=!1;goog.exportProperty(box2d.b2Contact.prototype,"m_flag_enabledFlag",box2d.b2Contact.prototype.m_flag_enabledFlag);box2d.b2Contact.prototype.m_flag_filterFlag=!1;goog.exportProperty(box2d.b2Contact.prototype,"m_flag_filterFlag",box2d.b2Contact.prototype.m_flag_filterFlag);
box2d.b2Contact.prototype.m_flag_bulletHitFlag=!1;goog.exportProperty(box2d.b2Contact.prototype,"m_flag_bulletHitFlag",box2d.b2Contact.prototype.m_flag_bulletHitFlag);box2d.b2Contact.prototype.m_flag_toiFlag=!1;goog.exportProperty(box2d.b2Contact.prototype,"m_flag_toiFlag",box2d.b2Contact.prototype.m_flag_toiFlag);box2d.b2Contact.prototype.m_prev=null;goog.exportProperty(box2d.b2Contact.prototype,"m_prev",box2d.b2Contact.prototype.m_prev);box2d.b2Contact.prototype.m_next=null;
goog.exportProperty(box2d.b2Contact.prototype,"m_next",box2d.b2Contact.prototype.m_next);box2d.b2Contact.prototype.m_nodeA=null;goog.exportProperty(box2d.b2Contact.prototype,"m_nodeA",box2d.b2Contact.prototype.m_nodeA);box2d.b2Contact.prototype.m_nodeB=null;goog.exportProperty(box2d.b2Contact.prototype,"m_nodeB",box2d.b2Contact.prototype.m_nodeB);box2d.b2Contact.prototype.m_fixtureA=null;goog.exportProperty(box2d.b2Contact.prototype,"m_fixtureA",box2d.b2Contact.prototype.m_fixtureA);
box2d.b2Contact.prototype.m_fixtureB=null;goog.exportProperty(box2d.b2Contact.prototype,"m_fixtureB",box2d.b2Contact.prototype.m_fixtureB);box2d.b2Contact.prototype.m_indexA=0;goog.exportProperty(box2d.b2Contact.prototype,"m_indexA",box2d.b2Contact.prototype.m_indexA);box2d.b2Contact.prototype.m_indexB=0;goog.exportProperty(box2d.b2Contact.prototype,"m_indexB",box2d.b2Contact.prototype.m_indexB);box2d.b2Contact.prototype.m_manifold=null;goog.exportProperty(box2d.b2Contact.prototype,"m_manifold",box2d.b2Contact.prototype.m_manifold);
box2d.b2Contact.prototype.m_toiCount=0;goog.exportProperty(box2d.b2Contact.prototype,"m_toiCount",box2d.b2Contact.prototype.m_toiCount);box2d.b2Contact.prototype.m_toi=0;goog.exportProperty(box2d.b2Contact.prototype,"m_toi",box2d.b2Contact.prototype.m_toi);box2d.b2Contact.prototype.m_friction=0;goog.exportProperty(box2d.b2Contact.prototype,"m_friction",box2d.b2Contact.prototype.m_friction);box2d.b2Contact.prototype.m_restitution=0;goog.exportProperty(box2d.b2Contact.prototype,"m_restitution",box2d.b2Contact.prototype.m_restitution);
box2d.b2Contact.prototype.m_tangentSpeed=0;goog.exportProperty(box2d.b2Contact.prototype,"m_tangentSpeed",box2d.b2Contact.prototype.m_tangentSpeed);box2d.b2Contact.prototype.m_oldManifold=null;goog.exportProperty(box2d.b2Contact.prototype,"m_oldManifold",box2d.b2Contact.prototype.m_oldManifold);box2d.b2Contact.prototype.GetManifold=function(){return this.m_manifold};goog.exportProperty(box2d.b2Contact.prototype,"GetManifold",box2d.b2Contact.prototype.GetManifold);
box2d.b2Contact.prototype.GetWorldManifold=function(a){var b=this.m_fixtureA.GetBody(),d=this.m_fixtureB.GetBody(),e=this.m_fixtureA.GetShape(),f=this.m_fixtureB.GetShape();a.Initialize(this.m_manifold,b.GetTransform(),e.m_radius,d.GetTransform(),f.m_radius)};goog.exportProperty(box2d.b2Contact.prototype,"GetWorldManifold",box2d.b2Contact.prototype.GetWorldManifold);box2d.b2Contact.prototype.IsTouching=function(){return this.m_flag_touchingFlag};
goog.exportProperty(box2d.b2Contact.prototype,"IsTouching",box2d.b2Contact.prototype.IsTouching);box2d.b2Contact.prototype.SetEnabled=function(a){this.m_flag_enabledFlag=a};goog.exportProperty(box2d.b2Contact.prototype,"SetEnabled",box2d.b2Contact.prototype.SetEnabled);box2d.b2Contact.prototype.IsEnabled=function(){return this.m_flag_enabledFlag};goog.exportProperty(box2d.b2Contact.prototype,"IsEnabled",box2d.b2Contact.prototype.IsEnabled);box2d.b2Contact.prototype.GetNext=function(){return this.m_next};
goog.exportProperty(box2d.b2Contact.prototype,"GetNext",box2d.b2Contact.prototype.GetNext);box2d.b2Contact.prototype.GetFixtureA=function(){return this.m_fixtureA};goog.exportProperty(box2d.b2Contact.prototype,"GetFixtureA",box2d.b2Contact.prototype.GetFixtureA);box2d.b2Contact.prototype.GetChildIndexA=function(){return this.m_indexA};goog.exportProperty(box2d.b2Contact.prototype,"GetChildIndexA",box2d.b2Contact.prototype.GetChildIndexA);box2d.b2Contact.prototype.GetFixtureB=function(){return this.m_fixtureB};
goog.exportProperty(box2d.b2Contact.prototype,"GetFixtureB",box2d.b2Contact.prototype.GetFixtureB);box2d.b2Contact.prototype.GetChildIndexB=function(){return this.m_indexB};goog.exportProperty(box2d.b2Contact.prototype,"GetChildIndexB",box2d.b2Contact.prototype.GetChildIndexB);box2d.b2Contact.prototype.Evaluate=function(a,b,d){};goog.exportProperty(box2d.b2Contact.prototype,"Evaluate",box2d.b2Contact.prototype.Evaluate);
box2d.b2Contact.prototype.FlagForFiltering=function(){this.m_flag_filterFlag=!0};goog.exportProperty(box2d.b2Contact.prototype,"FlagForFiltering",box2d.b2Contact.prototype.FlagForFiltering);box2d.b2Contact.prototype.SetFriction=function(a){this.m_friction=a};goog.exportProperty(box2d.b2Contact.prototype,"SetFriction",box2d.b2Contact.prototype.SetFriction);box2d.b2Contact.prototype.GetFriction=function(){return this.m_friction};goog.exportProperty(box2d.b2Contact.prototype,"GetFriction",box2d.b2Contact.prototype.GetFriction);
box2d.b2Contact.prototype.ResetFriction=function(){this.m_friction=box2d.b2MixFriction(this.m_fixtureA.m_friction,this.m_fixtureB.m_friction)};goog.exportProperty(box2d.b2Contact.prototype,"ResetFriction",box2d.b2Contact.prototype.ResetFriction);box2d.b2Contact.prototype.SetRestitution=function(a){this.m_restitution=a};goog.exportProperty(box2d.b2Contact.prototype,"SetRestitution",box2d.b2Contact.prototype.SetRestitution);box2d.b2Contact.prototype.GetRestitution=function(){return this.m_restitution};
goog.exportProperty(box2d.b2Contact.prototype,"GetRestitution",box2d.b2Contact.prototype.GetRestitution);box2d.b2Contact.prototype.ResetRestitution=function(){this.m_restitution=box2d.b2MixRestitution(this.m_fixtureA.m_restitution,this.m_fixtureB.m_restitution)};goog.exportProperty(box2d.b2Contact.prototype,"ResetRestitution",box2d.b2Contact.prototype.ResetRestitution);box2d.b2Contact.prototype.SetTangentSpeed=function(a){this.m_tangentSpeed=a};
goog.exportProperty(box2d.b2Contact.prototype,"SetTangentSpeed",box2d.b2Contact.prototype.SetTangentSpeed);box2d.b2Contact.prototype.GetTangentSpeed=function(){return this.m_tangentSpeed};goog.exportProperty(box2d.b2Contact.prototype,"GetTangentSpeed",box2d.b2Contact.prototype.GetTangentSpeed);
box2d.b2Contact.prototype.Reset=function(a,b,d,e){this.m_flag_touchingFlag=this.m_flag_islandFlag=!1;this.m_flag_enabledFlag=!0;this.m_flag_toiFlag=this.m_flag_bulletHitFlag=this.m_flag_filterFlag=!1;this.m_fixtureA=a;this.m_fixtureB=d;this.m_indexA=b;this.m_indexB=e;this.m_manifold.pointCount=0;this.m_next=this.m_prev=null;this.m_nodeA.contact=null;this.m_nodeA.prev=null;this.m_nodeA.next=null;this.m_nodeA.other=null;this.m_nodeB.contact=null;this.m_nodeB.prev=null;this.m_nodeB.next=null;this.m_nodeB.other=
null;this.m_toiCount=0;this.m_friction=box2d.b2MixFriction(this.m_fixtureA.m_friction,this.m_fixtureB.m_friction);this.m_restitution=box2d.b2MixRestitution(this.m_fixtureA.m_restitution,this.m_fixtureB.m_restitution)};goog.exportProperty(box2d.b2Contact.prototype,"Reset",box2d.b2Contact.prototype.Reset);
box2d.b2Contact.prototype.Update=function(a){var b=this.m_oldManifold;this.m_oldManifold=this.m_manifold;this.m_manifold=b;this.m_flag_enabledFlag=!0;var d=!1,b=this.m_flag_touchingFlag,e=this.m_fixtureA.IsSensor(),f=this.m_fixtureB.IsSensor(),e=e||f,f=this.m_fixtureA.GetBody(),g=this.m_fixtureB.GetBody(),d=f.GetTransform(),k=g.GetTransform();if(e)f=this.m_fixtureA.GetShape(),g=this.m_fixtureB.GetShape(),d=box2d.b2TestOverlap_Shape(f,this.m_indexA,g,this.m_indexB,d,k),this.m_manifold.pointCount=0;
else{this.Evaluate(this.m_manifold,d,k);d=0<this.m_manifold.pointCount;for(k=0;k<this.m_manifold.pointCount;++k){var m=this.m_manifold.points[k];m.normalImpulse=0;m.tangentImpulse=0;for(var n=m.id,q=0;q<this.m_oldManifold.pointCount;++q){var s=this.m_oldManifold.points[q];if(s.id.key===n.key){m.normalImpulse=s.normalImpulse;m.tangentImpulse=s.tangentImpulse;break}}}d!==b&&(f.SetAwake(!0),g.SetAwake(!0))}this.m_flag_touchingFlag=d;!b&&d&&a&&a.BeginContact(this);b&&!d&&a&&a.EndContact(this);!e&&d&&
a&&a.PreSolve(this,this.m_oldManifold)};goog.exportProperty(box2d.b2Contact.prototype,"Update",box2d.b2Contact.prototype.Update);box2d.b2Contact.prototype.ComputeTOI=function(a,b){var d=box2d.b2Contact.prototype.ComputeTOI.s_input;d.proxyA.SetShape(this.m_fixtureA.GetShape(),this.m_indexA);d.proxyB.SetShape(this.m_fixtureB.GetShape(),this.m_indexB);d.sweepA.Copy(a);d.sweepB.Copy(b);d.tMax=box2d.b2_linearSlop;var e=box2d.b2Contact.prototype.ComputeTOI.s_output;box2d.b2TimeOfImpact(e,d);return e.t};
goog.exportProperty(box2d.b2Contact.prototype,"ComputeTOI",box2d.b2Contact.prototype.ComputeTOI);box2d.b2Contact.prototype.ComputeTOI.s_input=new box2d.b2TOIInput;box2d.b2Contact.prototype.ComputeTOI.s_output=new box2d.b2TOIOutput;box2d.b2ChainAndCircleContact=function(){box2d.b2Contact.call(this)};goog.inherits(box2d.b2ChainAndCircleContact,box2d.b2Contact);goog.exportSymbol("box2d.b2ChainAndCircleContact",box2d.b2ChainAndCircleContact);box2d.b2ChainAndCircleContact.Create=function(a){return new box2d.b2ChainAndCircleContact};
goog.exportProperty(box2d.b2ChainAndCircleContact,"Create",box2d.b2ChainAndCircleContact.Create);box2d.b2ChainAndCircleContact.Destroy=function(a,b){};goog.exportProperty(box2d.b2ChainAndCircleContact,"Destroy",box2d.b2ChainAndCircleContact.Destroy);
box2d.b2ChainAndCircleContact.prototype.Evaluate=function(a,b,d){var e=this.m_fixtureA.GetShape(),f=this.m_fixtureB.GetShape();box2d.ENABLE_ASSERTS&&box2d.b2Assert(e instanceof box2d.b2ChainShape);box2d.ENABLE_ASSERTS&&box2d.b2Assert(f instanceof box2d.b2CircleShape);var g=box2d.b2ChainAndCircleContact.prototype.Evaluate.s_edge;(e instanceof box2d.b2ChainShape?e:null).GetChildEdge(g,this.m_indexA);box2d.b2CollideEdgeAndCircle(a,g,b,f instanceof box2d.b2CircleShape?f:null,d)};
goog.exportProperty(box2d.b2ChainAndCircleContact.prototype,"Evaluate",box2d.b2ChainAndCircleContact.prototype.Evaluate);box2d.b2ChainAndCircleContact.prototype.Evaluate.s_edge=new box2d.b2EdgeShape;box2d.b2ChainAndPolygonContact=function(){box2d.b2Contact.call(this)};goog.inherits(box2d.b2ChainAndPolygonContact,box2d.b2Contact);goog.exportSymbol("box2d.b2ChainAndPolygonContact",box2d.b2ChainAndPolygonContact);box2d.b2ChainAndPolygonContact.Create=function(a){return new box2d.b2ChainAndPolygonContact};
goog.exportProperty(box2d.b2ChainAndPolygonContact,"Create",box2d.b2ChainAndPolygonContact.Create);box2d.b2ChainAndPolygonContact.Destroy=function(a,b){};goog.exportProperty(box2d.b2ChainAndPolygonContact,"Destroy",box2d.b2ChainAndPolygonContact.Destroy);
box2d.b2ChainAndPolygonContact.prototype.Evaluate=function(a,b,d){var e=this.m_fixtureA.GetShape(),f=this.m_fixtureB.GetShape();box2d.ENABLE_ASSERTS&&box2d.b2Assert(e instanceof box2d.b2ChainShape);box2d.ENABLE_ASSERTS&&box2d.b2Assert(f instanceof box2d.b2PolygonShape);var g=box2d.b2ChainAndPolygonContact.prototype.Evaluate.s_edge;(e instanceof box2d.b2ChainShape?e:null).GetChildEdge(g,this.m_indexA);box2d.b2CollideEdgeAndPolygon(a,g,b,f instanceof box2d.b2PolygonShape?f:null,d)};
goog.exportProperty(box2d.b2ChainAndPolygonContact.prototype,"Evaluate",box2d.b2ChainAndPolygonContact.prototype.Evaluate);box2d.b2ChainAndPolygonContact.prototype.Evaluate.s_edge=new box2d.b2EdgeShape;box2d.b2CircleContact=function(){box2d.b2Contact.call(this)};goog.inherits(box2d.b2CircleContact,box2d.b2Contact);goog.exportSymbol("box2d.b2CircleContact",box2d.b2CircleContact);box2d.b2CircleContact.Create=function(a){return new box2d.b2CircleContact};
goog.exportProperty(box2d.b2CircleContact,"Create",box2d.b2CircleContact.Create);box2d.b2CircleContact.Destroy=function(a,b){};goog.exportProperty(box2d.b2CircleContact,"Destroy",box2d.b2CircleContact.Destroy);
box2d.b2CircleContact.prototype.Evaluate=function(a,b,d){var e=this.m_fixtureA.GetShape(),f=this.m_fixtureB.GetShape();box2d.ENABLE_ASSERTS&&box2d.b2Assert(e instanceof box2d.b2CircleShape);box2d.ENABLE_ASSERTS&&box2d.b2Assert(f instanceof box2d.b2CircleShape);box2d.b2CollideCircles(a,e instanceof box2d.b2CircleShape?e:null,b,f instanceof box2d.b2CircleShape?f:null,d)};goog.exportProperty(box2d.b2CircleContact.prototype,"Evaluate",box2d.b2CircleContact.prototype.Evaluate);
box2d.b2ContactRegister=function(){};goog.exportSymbol("box2d.b2ContactRegister",box2d.b2ContactRegister);box2d.b2ContactRegister.prototype.createFcn=null;box2d.b2ContactRegister.prototype.destroyFcn=null;box2d.b2ContactRegister.prototype.primary=!1;box2d.b2ContactFactory=function(a){this.m_allocator=a;this.InitializeRegisters()};goog.exportSymbol("box2d.b2ContactFactory",box2d.b2ContactFactory);box2d.b2ContactFactory.prototype.m_allocator=null;
box2d.b2ContactFactory.prototype.AddType=function(a,b,d,e){var f=box2d.b2MakeArray(256,function(b){return a()});b=function(b){return 0<f.length?f.pop():a(b)};var g=function(a,b){f.push(a)};this.m_registers[d][e].pool=f;this.m_registers[d][e].createFcn=b;this.m_registers[d][e].destroyFcn=g;this.m_registers[d][e].primary=!0;d!==e&&(this.m_registers[e][d].pool=f,this.m_registers[e][d].createFcn=b,this.m_registers[e][d].destroyFcn=g,this.m_registers[e][d].primary=!1)};
goog.exportProperty(box2d.b2ContactFactory.prototype,"AddType",box2d.b2ContactFactory.prototype.AddType);
box2d.b2ContactFactory.prototype.InitializeRegisters=function(){this.m_registers=Array(box2d.b2ShapeType.e_shapeTypeCount);for(var a=0;a<box2d.b2ShapeType.e_shapeTypeCount;a++){this.m_registers[a]=Array(box2d.b2ShapeType.e_shapeTypeCount);for(var b=0;b<box2d.b2ShapeType.e_shapeTypeCount;b++)this.m_registers[a][b]=new box2d.b2ContactRegister}this.AddType(box2d.b2CircleContact.Create,box2d.b2CircleContact.Destroy,box2d.b2ShapeType.e_circleShape,box2d.b2ShapeType.e_circleShape);this.AddType(box2d.b2PolygonAndCircleContact.Create,
box2d.b2PolygonAndCircleContact.Destroy,box2d.b2ShapeType.e_polygonShape,box2d.b2ShapeType.e_circleShape);this.AddType(box2d.b2PolygonContact.Create,box2d.b2PolygonContact.Destroy,box2d.b2ShapeType.e_polygonShape,box2d.b2ShapeType.e_polygonShape);this.AddType(box2d.b2EdgeAndCircleContact.Create,box2d.b2EdgeAndCircleContact.Destroy,box2d.b2ShapeType.e_edgeShape,box2d.b2ShapeType.e_circleShape);this.AddType(box2d.b2EdgeAndPolygonContact.Create,box2d.b2EdgeAndPolygonContact.Destroy,box2d.b2ShapeType.e_edgeShape,
box2d.b2ShapeType.e_polygonShape);this.AddType(box2d.b2ChainAndCircleContact.Create,box2d.b2ChainAndCircleContact.Destroy,box2d.b2ShapeType.e_chainShape,box2d.b2ShapeType.e_circleShape);this.AddType(box2d.b2ChainAndPolygonContact.Create,box2d.b2ChainAndPolygonContact.Destroy,box2d.b2ShapeType.e_chainShape,box2d.b2ShapeType.e_polygonShape)};goog.exportProperty(box2d.b2ContactFactory.prototype,"InitializeRegisters",box2d.b2ContactFactory.prototype.InitializeRegisters);
box2d.b2ContactFactory.prototype.Create=function(a,b,d,e){var f=a.GetType(),g=d.GetType();box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<=f&&f<box2d.b2ShapeType.e_shapeTypeCount);box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<=g&&g<box2d.b2ShapeType.e_shapeTypeCount);f=this.m_registers[f][g];g=f.createFcn;return null!==g?(f.primary?(f=g(this.m_allocator),f.Reset(a,b,d,e)):(f=g(this.m_allocator),f.Reset(d,e,a,b)),f):null};goog.exportProperty(box2d.b2ContactFactory.prototype,"Create",box2d.b2ContactFactory.prototype.Create);
box2d.b2ContactFactory.prototype.Destroy=function(a){var b=a.m_fixtureA,d=a.m_fixtureB;0<a.m_manifold.pointCount&&!b.IsSensor()&&!d.IsSensor()&&(b.GetBody().SetAwake(!0),d.GetBody().SetAwake(!0));b=b.GetType();d=d.GetType();box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<=b&&d<box2d.b2ShapeType.e_shapeTypeCount);box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<=b&&d<box2d.b2ShapeType.e_shapeTypeCount);d=this.m_registers[b][d].destroyFcn;d(a,this.m_allocator)};
goog.exportProperty(box2d.b2ContactFactory.prototype,"Destroy",box2d.b2ContactFactory.prototype.Destroy);box2d.b2ContactManager=function(){this.m_broadPhase=new box2d.b2BroadPhase;this.m_contactFactory=new box2d.b2ContactFactory(this.m_allocator)};box2d.b2ContactManager.prototype.m_broadPhase=null;goog.exportProperty(box2d.b2ContactManager.prototype,"m_broadPhase",box2d.b2ContactManager.prototype.m_broadPhase);box2d.b2ContactManager.prototype.m_contactList=null;
goog.exportProperty(box2d.b2ContactManager.prototype,"m_contactList",box2d.b2ContactManager.prototype.m_contactList);box2d.b2ContactManager.prototype.m_contactCount=0;goog.exportProperty(box2d.b2ContactManager.prototype,"m_contactCount",box2d.b2ContactManager.prototype.m_contactCount);box2d.b2ContactManager.prototype.m_contactFilter=box2d.b2ContactFilter.b2_defaultFilter;goog.exportProperty(box2d.b2ContactManager.prototype,"m_contactFilter",box2d.b2ContactManager.prototype.m_contactFilter);
box2d.b2ContactManager.prototype.m_contactListener=box2d.b2ContactListener.b2_defaultListener;goog.exportProperty(box2d.b2ContactManager.prototype,"m_contactListener",box2d.b2ContactManager.prototype.m_contactListener);box2d.b2ContactManager.prototype.m_allocator=null;goog.exportProperty(box2d.b2ContactManager.prototype,"m_allocator",box2d.b2ContactManager.prototype.m_allocator);box2d.b2ContactManager.prototype.m_contactFactory=null;
goog.exportProperty(box2d.b2ContactManager.prototype,"m_contactFactory",box2d.b2ContactManager.prototype.m_contactFactory);
box2d.b2ContactManager.prototype.Destroy=function(a){var b=a.GetFixtureA(),d=a.GetFixtureB(),b=b.GetBody(),d=d.GetBody();this.m_contactListener&&a.IsTouching()&&this.m_contactListener.EndContact(a);a.m_prev&&(a.m_prev.m_next=a.m_next);a.m_next&&(a.m_next.m_prev=a.m_prev);a===this.m_contactList&&(this.m_contactList=a.m_next);a.m_nodeA.prev&&(a.m_nodeA.prev.next=a.m_nodeA.next);a.m_nodeA.next&&(a.m_nodeA.next.prev=a.m_nodeA.prev);a.m_nodeA===b.m_contactList&&(b.m_contactList=a.m_nodeA.next);a.m_nodeB.prev&&
(a.m_nodeB.prev.next=a.m_nodeB.next);a.m_nodeB.next&&(a.m_nodeB.next.prev=a.m_nodeB.prev);a.m_nodeB===d.m_contactList&&(d.m_contactList=a.m_nodeB.next);this.m_contactFactory.Destroy(a);--this.m_contactCount};goog.exportProperty(box2d.b2ContactManager.prototype,"Destroy",box2d.b2ContactManager.prototype.Destroy);
box2d.b2ContactManager.prototype.Collide=function(){for(var a=this.m_contactList;a;){var b=a.GetFixtureA(),d=a.GetFixtureB(),e=a.GetChildIndexA(),f=a.GetChildIndexB(),g=b.GetBody(),k=d.GetBody();if(a.m_flag_filterFlag){if(!k.ShouldCollide(g)){b=a;a=b.m_next;this.Destroy(b);continue}if(this.m_contactFilter&&!this.m_contactFilter.ShouldCollide(b,d)){b=a;a=b.m_next;this.Destroy(b);continue}a.m_flag_filterFlag=!1}g=g.IsAwake()&&g.m_type!==box2d.b2BodyType.b2_staticBody;k=k.IsAwake()&&k.m_type!==box2d.b2BodyType.b2_staticBody;
g||k?this.m_broadPhase.TestOverlap(b.m_proxies[e].proxy,d.m_proxies[f].proxy)?(a.Update(this.m_contactListener),a=a.m_next):(b=a,a=b.m_next,this.Destroy(b)):a=a.m_next}};goog.exportProperty(box2d.b2ContactManager.prototype,"Collide",box2d.b2ContactManager.prototype.Collide);box2d.b2ContactManager.prototype.FindNewContacts=function(){this.m_broadPhase.UpdatePairs(this)};goog.exportProperty(box2d.b2ContactManager.prototype,"FindNewContacts",box2d.b2ContactManager.prototype.FindNewContacts);
box2d.b2ContactManager.prototype.AddPair=function(a,b){box2d.ENABLE_ASSERTS&&box2d.b2Assert(a instanceof box2d.b2FixtureProxy);box2d.ENABLE_ASSERTS&&box2d.b2Assert(b instanceof box2d.b2FixtureProxy);var d=a.fixture,e=b.fixture,f=a.childIndex,g=b.childIndex,k=d.GetBody(),m=e.GetBody();if(k!==m){for(var n=m.GetContactList();n;){if(n.other===k){var q=n.contact.GetFixtureA(),s=n.contact.GetFixtureB(),t=n.contact.GetChildIndexA(),u=n.contact.GetChildIndexB();if(q===d&&s===e&&t===f&&u===g||q===e&&s===d&&
t===g&&u===f)return}n=n.next}!m.ShouldCollide(k)||this.m_contactFilter&&!this.m_contactFilter.ShouldCollide(d,e)||(f=this.m_contactFactory.Create(d,f,e,g),null!==f&&(d=f.GetFixtureA(),e=f.GetFixtureB(),k=d.m_body,m=e.m_body,f.m_prev=null,f.m_next=this.m_contactList,null!==this.m_contactList&&(this.m_contactList.m_prev=f),this.m_contactList=f,f.m_nodeA.contact=f,f.m_nodeA.other=m,f.m_nodeA.prev=null,f.m_nodeA.next=k.m_contactList,null!==k.m_contactList&&(k.m_contactList.prev=f.m_nodeA),k.m_contactList=
f.m_nodeA,f.m_nodeB.contact=f,f.m_nodeB.other=k,f.m_nodeB.prev=null,f.m_nodeB.next=m.m_contactList,null!==m.m_contactList&&(m.m_contactList.prev=f.m_nodeB),m.m_contactList=f.m_nodeB,d.IsSensor()||e.IsSensor()||(k.SetAwake(!0),m.SetAwake(!0)),++this.m_contactCount))}};goog.exportProperty(box2d.b2ContactManager.prototype,"AddPair",box2d.b2ContactManager.prototype.AddPair);box2d.b2EdgeAndCircleContact=function(){box2d.b2Contact.call(this)};goog.inherits(box2d.b2EdgeAndCircleContact,box2d.b2Contact);
goog.exportSymbol("box2d.b2EdgeAndCircleContact",box2d.b2EdgeAndCircleContact);box2d.b2EdgeAndCircleContact.Create=function(a){return new box2d.b2EdgeAndCircleContact};goog.exportProperty(box2d.b2EdgeAndCircleContact,"Create",box2d.b2EdgeAndCircleContact.Create);box2d.b2EdgeAndCircleContact.Destroy=function(a,b){};goog.exportProperty(box2d.b2EdgeAndCircleContact,"Destroy",box2d.b2EdgeAndCircleContact.Destroy);
box2d.b2EdgeAndCircleContact.prototype.Evaluate=function(a,b,d){var e=this.m_fixtureA.GetShape(),f=this.m_fixtureB.GetShape();box2d.ENABLE_ASSERTS&&box2d.b2Assert(e instanceof box2d.b2EdgeShape);box2d.ENABLE_ASSERTS&&box2d.b2Assert(f instanceof box2d.b2CircleShape);box2d.b2CollideEdgeAndCircle(a,e instanceof box2d.b2EdgeShape?e:null,b,f instanceof box2d.b2CircleShape?f:null,d)};goog.exportProperty(box2d.b2EdgeAndCircleContact.prototype,"Evaluate",box2d.b2EdgeAndCircleContact.prototype.Evaluate);
box2d.b2EdgeAndPolygonContact=function(){box2d.b2Contact.call(this)};goog.inherits(box2d.b2EdgeAndPolygonContact,box2d.b2Contact);goog.exportSymbol("box2d.b2EdgeAndPolygonContact",box2d.b2EdgeAndPolygonContact);box2d.b2EdgeAndPolygonContact.Create=function(a){return new box2d.b2EdgeAndPolygonContact};goog.exportProperty(box2d.b2EdgeAndPolygonContact,"Create",box2d.b2EdgeAndPolygonContact.Create);box2d.b2EdgeAndPolygonContact.Destroy=function(a,b){};
goog.exportProperty(box2d.b2EdgeAndPolygonContact,"Destroy",box2d.b2EdgeAndPolygonContact.Destroy);box2d.b2EdgeAndPolygonContact.prototype.Evaluate=function(a,b,d){var e=this.m_fixtureA.GetShape(),f=this.m_fixtureB.GetShape();box2d.ENABLE_ASSERTS&&box2d.b2Assert(e instanceof box2d.b2EdgeShape);box2d.ENABLE_ASSERTS&&box2d.b2Assert(f instanceof box2d.b2PolygonShape);box2d.b2CollideEdgeAndPolygon(a,e instanceof box2d.b2EdgeShape?e:null,b,f instanceof box2d.b2PolygonShape?f:null,d)};
goog.exportProperty(box2d.b2EdgeAndPolygonContact.prototype,"Evaluate",box2d.b2EdgeAndPolygonContact.prototype.Evaluate);box2d.b2PolygonAndCircleContact=function(){box2d.b2Contact.call(this)};goog.inherits(box2d.b2PolygonAndCircleContact,box2d.b2Contact);goog.exportSymbol("box2d.b2PolygonAndCircleContact",box2d.b2PolygonAndCircleContact);box2d.b2PolygonAndCircleContact.Create=function(a){return new box2d.b2PolygonAndCircleContact};goog.exportProperty(box2d.b2PolygonAndCircleContact,"Create",box2d.b2PolygonAndCircleContact.Create);
box2d.b2PolygonAndCircleContact.Destroy=function(a,b){};goog.exportProperty(box2d.b2PolygonAndCircleContact,"Destroy",box2d.b2PolygonAndCircleContact.Destroy);
box2d.b2PolygonAndCircleContact.prototype.Evaluate=function(a,b,d){var e=this.m_fixtureA.GetShape(),f=this.m_fixtureB.GetShape();box2d.ENABLE_ASSERTS&&box2d.b2Assert(e instanceof box2d.b2PolygonShape);box2d.ENABLE_ASSERTS&&box2d.b2Assert(f instanceof box2d.b2CircleShape);box2d.b2CollidePolygonAndCircle(a,e instanceof box2d.b2PolygonShape?e:null,b,f instanceof box2d.b2CircleShape?f:null,d)};goog.exportProperty(box2d.b2PolygonAndCircleContact.prototype,"Evaluate",box2d.b2PolygonAndCircleContact.prototype.Evaluate);
box2d.b2PolygonContact=function(){box2d.b2Contact.call(this)};goog.inherits(box2d.b2PolygonContact,box2d.b2Contact);goog.exportSymbol("box2d.b2PolygonContact",box2d.b2PolygonContact);box2d.b2PolygonContact.Create=function(a){return new box2d.b2PolygonContact};goog.exportProperty(box2d.b2PolygonContact,"Create",box2d.b2PolygonContact.Create);box2d.b2PolygonContact.Destroy=function(a,b){};goog.exportProperty(box2d.b2PolygonContact,"Destroy",box2d.b2PolygonContact.Destroy);
box2d.b2PolygonContact.prototype.Evaluate=function(a,b,d){var e=this.m_fixtureA.GetShape(),f=this.m_fixtureB.GetShape();box2d.ENABLE_ASSERTS&&box2d.b2Assert(e instanceof box2d.b2PolygonShape);box2d.ENABLE_ASSERTS&&box2d.b2Assert(f instanceof box2d.b2PolygonShape);box2d.b2CollidePolygons(a,e instanceof box2d.b2PolygonShape?e:null,b,f instanceof box2d.b2PolygonShape?f:null,d)};goog.exportProperty(box2d.b2PolygonContact.prototype,"Evaluate",box2d.b2PolygonContact.prototype.Evaluate);
box2d.g_blockSolve=!0;box2d.b2VelocityConstraintPoint=function(){this.rA=new box2d.b2Vec2;this.rB=new box2d.b2Vec2};goog.exportSymbol("box2d.b2VelocityConstraintPoint",box2d.b2VelocityConstraintPoint);box2d.b2VelocityConstraintPoint.prototype.rA=null;goog.exportProperty(box2d.b2VelocityConstraintPoint.prototype,"rA",box2d.b2VelocityConstraintPoint.prototype.rA);box2d.b2VelocityConstraintPoint.prototype.rB=null;goog.exportProperty(box2d.b2VelocityConstraintPoint.prototype,"rB",box2d.b2VelocityConstraintPoint.prototype.rB);
box2d.b2VelocityConstraintPoint.prototype.normalImpulse=0;goog.exportProperty(box2d.b2VelocityConstraintPoint.prototype,"normalImpulse",box2d.b2VelocityConstraintPoint.prototype.normalImpulse);box2d.b2VelocityConstraintPoint.prototype.tangentImpulse=0;goog.exportProperty(box2d.b2VelocityConstraintPoint.prototype,"tangentImpulse",box2d.b2VelocityConstraintPoint.prototype.tangentImpulse);box2d.b2VelocityConstraintPoint.prototype.normalMass=0;
goog.exportProperty(box2d.b2VelocityConstraintPoint.prototype,"normalMass",box2d.b2VelocityConstraintPoint.prototype.normalMass);box2d.b2VelocityConstraintPoint.prototype.tangentMass=0;goog.exportProperty(box2d.b2VelocityConstraintPoint.prototype,"tangentMass",box2d.b2VelocityConstraintPoint.prototype.tangentMass);box2d.b2VelocityConstraintPoint.prototype.velocityBias=0;goog.exportProperty(box2d.b2VelocityConstraintPoint.prototype,"velocityBias",box2d.b2VelocityConstraintPoint.prototype.velocityBias);
box2d.b2VelocityConstraintPoint.MakeArray=function(a){return box2d.b2MakeArray(a,function(a){return new box2d.b2VelocityConstraintPoint})};goog.exportProperty(box2d.b2VelocityConstraintPoint,"MakeArray",box2d.b2VelocityConstraintPoint.MakeArray);box2d.b2ContactVelocityConstraint=function(){this.points=box2d.b2VelocityConstraintPoint.MakeArray(box2d.b2_maxManifoldPoints);this.normal=new box2d.b2Vec2;this.tangent=new box2d.b2Vec2;this.normalMass=new box2d.b2Mat22;this.K=new box2d.b2Mat22};
goog.exportSymbol("box2d.b2ContactVelocityConstraint",box2d.b2ContactVelocityConstraint);box2d.b2ContactVelocityConstraint.prototype.points=null;goog.exportProperty(box2d.b2ContactVelocityConstraint.prototype,"points",box2d.b2ContactVelocityConstraint.prototype.points);box2d.b2ContactVelocityConstraint.prototype.normal=null;goog.exportProperty(box2d.b2ContactVelocityConstraint.prototype,"normal",box2d.b2ContactVelocityConstraint.prototype.normal);
box2d.b2ContactVelocityConstraint.prototype.tangent=null;goog.exportProperty(box2d.b2ContactVelocityConstraint.prototype,"tangent",box2d.b2ContactVelocityConstraint.prototype.tangent);box2d.b2ContactVelocityConstraint.prototype.normalMass=null;goog.exportProperty(box2d.b2ContactVelocityConstraint.prototype,"normalMass",box2d.b2ContactVelocityConstraint.prototype.normalMass);box2d.b2ContactVelocityConstraint.prototype.K=null;goog.exportProperty(box2d.b2ContactVelocityConstraint.prototype,"K",box2d.b2ContactVelocityConstraint.prototype.K);
box2d.b2ContactVelocityConstraint.prototype.indexA=0;goog.exportProperty(box2d.b2ContactVelocityConstraint.prototype,"indexA",box2d.b2ContactVelocityConstraint.prototype.indexA);box2d.b2ContactVelocityConstraint.prototype.indexB=0;goog.exportProperty(box2d.b2ContactVelocityConstraint.prototype,"indexB",box2d.b2ContactVelocityConstraint.prototype.indexB);box2d.b2ContactVelocityConstraint.prototype.invMassA=0;goog.exportProperty(box2d.b2ContactVelocityConstraint.prototype,"invMassA",box2d.b2ContactVelocityConstraint.prototype.invMassA);
box2d.b2ContactVelocityConstraint.prototype.invMassB=0;goog.exportProperty(box2d.b2ContactVelocityConstraint.prototype,"invMassB",box2d.b2ContactVelocityConstraint.prototype.invMassB);box2d.b2ContactVelocityConstraint.prototype.invIA=0;goog.exportProperty(box2d.b2ContactVelocityConstraint.prototype,"invIA",box2d.b2ContactVelocityConstraint.prototype.invIA);box2d.b2ContactVelocityConstraint.prototype.invIB=0;goog.exportProperty(box2d.b2ContactVelocityConstraint.prototype,"invIB",box2d.b2ContactVelocityConstraint.prototype.invIB);
box2d.b2ContactVelocityConstraint.prototype.friction=0;goog.exportProperty(box2d.b2ContactVelocityConstraint.prototype,"friction",box2d.b2ContactVelocityConstraint.prototype.friction);box2d.b2ContactVelocityConstraint.prototype.restitution=0;goog.exportProperty(box2d.b2ContactVelocityConstraint.prototype,"restitution",box2d.b2ContactVelocityConstraint.prototype.restitution);box2d.b2ContactVelocityConstraint.prototype.tangentSpeed=0;
goog.exportProperty(box2d.b2ContactVelocityConstraint.prototype,"tangentSpeed",box2d.b2ContactVelocityConstraint.prototype.tangentSpeed);box2d.b2ContactVelocityConstraint.prototype.pointCount=0;goog.exportProperty(box2d.b2ContactVelocityConstraint.prototype,"pointCount",box2d.b2ContactVelocityConstraint.prototype.pointCount);box2d.b2ContactVelocityConstraint.prototype.contactIndex=0;goog.exportProperty(box2d.b2ContactVelocityConstraint.prototype,"contactIndex",box2d.b2ContactVelocityConstraint.prototype.contactIndex);
box2d.b2ContactVelocityConstraint.MakeArray=function(a){return box2d.b2MakeArray(a,function(a){return new box2d.b2ContactVelocityConstraint})};goog.exportProperty(box2d.b2ContactVelocityConstraint,"MakeArray",box2d.b2ContactVelocityConstraint.MakeArray);box2d.b2ContactPositionConstraint=function(){this.localPoints=box2d.b2Vec2.MakeArray(box2d.b2_maxManifoldPoints);this.localNormal=new box2d.b2Vec2;this.localPoint=new box2d.b2Vec2;this.localCenterA=new box2d.b2Vec2;this.localCenterB=new box2d.b2Vec2};
goog.exportSymbol("box2d.b2ContactPositionConstraint",box2d.b2ContactPositionConstraint);box2d.b2ContactPositionConstraint.prototype.localPoints=null;goog.exportProperty(box2d.b2ContactPositionConstraint.prototype,"localPoints",box2d.b2ContactPositionConstraint.prototype.localPoints);box2d.b2ContactPositionConstraint.prototype.localNormal=null;goog.exportProperty(box2d.b2ContactPositionConstraint.prototype,"localNormal",box2d.b2ContactPositionConstraint.prototype.localNormal);
box2d.b2ContactPositionConstraint.prototype.localPoint=null;goog.exportProperty(box2d.b2ContactPositionConstraint.prototype,"localPoint",box2d.b2ContactPositionConstraint.prototype.localPoint);box2d.b2ContactPositionConstraint.prototype.indexA=0;goog.exportProperty(box2d.b2ContactPositionConstraint.prototype,"indexA",box2d.b2ContactPositionConstraint.prototype.indexA);box2d.b2ContactPositionConstraint.prototype.indexB=0;goog.exportProperty(box2d.b2ContactPositionConstraint.prototype,"indexB",box2d.b2ContactPositionConstraint.prototype.indexB);
box2d.b2ContactPositionConstraint.prototype.invMassA=0;goog.exportProperty(box2d.b2ContactPositionConstraint.prototype,"invMassA",box2d.b2ContactPositionConstraint.prototype.invMassA);box2d.b2ContactPositionConstraint.prototype.invMassB=0;goog.exportProperty(box2d.b2ContactPositionConstraint.prototype,"invMassB",box2d.b2ContactPositionConstraint.prototype.invMassB);box2d.b2ContactPositionConstraint.prototype.localCenterA=null;
goog.exportProperty(box2d.b2ContactPositionConstraint.prototype,"localCenterA",box2d.b2ContactPositionConstraint.prototype.localCenterA);box2d.b2ContactPositionConstraint.prototype.localCenterB=null;goog.exportProperty(box2d.b2ContactPositionConstraint.prototype,"localCenterB",box2d.b2ContactPositionConstraint.prototype.localCenterB);box2d.b2ContactPositionConstraint.prototype.invIA=0;goog.exportProperty(box2d.b2ContactPositionConstraint.prototype,"invIA",box2d.b2ContactPositionConstraint.prototype.invIA);
box2d.b2ContactPositionConstraint.prototype.invIB=0;goog.exportProperty(box2d.b2ContactPositionConstraint.prototype,"invIB",box2d.b2ContactPositionConstraint.prototype.invIB);box2d.b2ContactPositionConstraint.prototype.type=box2d.b2ManifoldType.e_unknown;goog.exportProperty(box2d.b2ContactPositionConstraint.prototype,"type",box2d.b2ContactPositionConstraint.prototype.type);box2d.b2ContactPositionConstraint.prototype.radiusA=0;
goog.exportProperty(box2d.b2ContactPositionConstraint.prototype,"radiusA",box2d.b2ContactPositionConstraint.prototype.radiusA);box2d.b2ContactPositionConstraint.prototype.radiusB=0;goog.exportProperty(box2d.b2ContactPositionConstraint.prototype,"radiusB",box2d.b2ContactPositionConstraint.prototype.radiusB);box2d.b2ContactPositionConstraint.prototype.pointCount=0;goog.exportProperty(box2d.b2ContactPositionConstraint.prototype,"pointCount",box2d.b2ContactPositionConstraint.prototype.pointCount);
box2d.b2ContactPositionConstraint.MakeArray=function(a){return box2d.b2MakeArray(a,function(a){return new box2d.b2ContactPositionConstraint})};goog.exportProperty(box2d.b2ContactPositionConstraint,"MakeArray",box2d.b2ContactPositionConstraint.MakeArray);box2d.b2ContactSolverDef=function(){this.step=new box2d.b2TimeStep};goog.exportSymbol("box2d.b2ContactSolverDef",box2d.b2ContactSolverDef);box2d.b2ContactSolverDef.prototype.step=null;goog.exportProperty(box2d.b2ContactSolverDef.prototype,"step",box2d.b2ContactSolverDef.prototype.step);
box2d.b2ContactSolverDef.prototype.contacts=null;goog.exportProperty(box2d.b2ContactSolverDef.prototype,"contacts",box2d.b2ContactSolverDef.prototype.contacts);box2d.b2ContactSolverDef.prototype.count=0;goog.exportProperty(box2d.b2ContactSolverDef.prototype,"count",box2d.b2ContactSolverDef.prototype.count);box2d.b2ContactSolverDef.prototype.positions=null;goog.exportProperty(box2d.b2ContactSolverDef.prototype,"positions",box2d.b2ContactSolverDef.prototype.positions);
box2d.b2ContactSolverDef.prototype.velocities=null;goog.exportProperty(box2d.b2ContactSolverDef.prototype,"velocities",box2d.b2ContactSolverDef.prototype.velocities);box2d.b2ContactSolverDef.prototype.allocator=null;goog.exportProperty(box2d.b2ContactSolverDef.prototype,"allocator",box2d.b2ContactSolverDef.prototype.allocator);box2d.b2ContactSolver=function(){this.m_step=new box2d.b2TimeStep;this.m_positionConstraints=box2d.b2ContactPositionConstraint.MakeArray(1024);this.m_velocityConstraints=box2d.b2ContactVelocityConstraint.MakeArray(1024)};
goog.exportSymbol("box2d.b2ContactSolver",box2d.b2ContactSolver);box2d.b2ContactSolver.prototype.m_step=null;goog.exportProperty(box2d.b2ContactSolver.prototype,"m_step",box2d.b2ContactSolver.prototype.m_step);box2d.b2ContactSolver.prototype.m_positions=null;goog.exportProperty(box2d.b2ContactSolver.prototype,"m_positions",box2d.b2ContactSolver.prototype.m_positions);box2d.b2ContactSolver.prototype.m_velocities=null;goog.exportProperty(box2d.b2ContactSolver.prototype,"m_velocities",box2d.b2ContactSolver.prototype.m_velocities);
box2d.b2ContactSolver.prototype.m_allocator=null;goog.exportProperty(box2d.b2ContactSolver.prototype,"m_allocator",box2d.b2ContactSolver.prototype.m_allocator);box2d.b2ContactSolver.prototype.m_positionConstraints=null;goog.exportProperty(box2d.b2ContactSolver.prototype,"m_positionConstraints",box2d.b2ContactSolver.prototype.m_positionConstraints);box2d.b2ContactSolver.prototype.m_velocityConstraints=null;goog.exportProperty(box2d.b2ContactSolver.prototype,"m_velocityConstraints",box2d.b2ContactSolver.prototype.m_velocityConstraints);
box2d.b2ContactSolver.prototype.m_contacts=null;goog.exportProperty(box2d.b2ContactSolver.prototype,"m_contacts",box2d.b2ContactSolver.prototype.m_contacts);box2d.b2ContactSolver.prototype.m_count=0;goog.exportProperty(box2d.b2ContactSolver.prototype,"m_count",box2d.b2ContactSolver.prototype.m_count);
box2d.b2ContactSolver.prototype.Initialize=function(a){this.m_step.Copy(a.step);this.m_allocator=a.allocator;this.m_count=a.count;if(this.m_positionConstraints.length<this.m_count){var b=box2d.b2Max(2*this.m_positionConstraints.length,this.m_count);for(box2d.DEBUG&&window.console.log("box2d.b2ContactSolver.m_positionConstraints: "+b);this.m_positionConstraints.length<b;)this.m_positionConstraints[this.m_positionConstraints.length]=new box2d.b2ContactPositionConstraint}if(this.m_velocityConstraints.length<
this.m_count)for(b=box2d.b2Max(2*this.m_velocityConstraints.length,this.m_count),box2d.DEBUG&&window.console.log("box2d.b2ContactSolver.m_velocityConstraints: "+b);this.m_velocityConstraints.length<b;)this.m_velocityConstraints[this.m_velocityConstraints.length]=new box2d.b2ContactVelocityConstraint;this.m_positions=a.positions;this.m_velocities=a.velocities;this.m_contacts=a.contacts;var d,e,f,g,k,m,n,q;a=0;for(b=this.m_count;a<b;++a)for(f=this.m_contacts[a],g=f.m_fixtureA,k=f.m_fixtureB,d=g.GetShape(),
e=k.GetShape(),d=d.m_radius,e=e.m_radius,m=g.GetBody(),n=k.GetBody(),k=f.GetManifold(),q=k.pointCount,box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<q),g=this.m_velocityConstraints[a],g.friction=f.m_friction,g.restitution=f.m_restitution,g.tangentSpeed=f.m_tangentSpeed,g.indexA=m.m_islandIndex,g.indexB=n.m_islandIndex,g.invMassA=m.m_invMass,g.invMassB=n.m_invMass,g.invIA=m.m_invI,g.invIB=n.m_invI,g.contactIndex=a,g.pointCount=q,g.K.SetZero(),g.normalMass.SetZero(),f=this.m_positionConstraints[a],f.indexA=
m.m_islandIndex,f.indexB=n.m_islandIndex,f.invMassA=m.m_invMass,f.invMassB=n.m_invMass,f.localCenterA.Copy(m.m_sweep.localCenter),f.localCenterB.Copy(n.m_sweep.localCenter),f.invIA=m.m_invI,f.invIB=n.m_invI,f.localNormal.Copy(k.localNormal),f.localPoint.Copy(k.localPoint),f.pointCount=q,f.radiusA=d,f.radiusB=e,f.type=k.type,d=0,e=q;d<e;++d)m=k.points[d],q=g.points[d],this.m_step.warmStarting?(q.normalImpulse=this.m_step.dtRatio*m.normalImpulse,q.tangentImpulse=this.m_step.dtRatio*m.tangentImpulse):
(q.normalImpulse=0,q.tangentImpulse=0),q.rA.SetZero(),q.rB.SetZero(),q.normalMass=0,q.tangentMass=0,q.velocityBias=0,f.localPoints[d].Copy(m.localPoint);return this};goog.exportProperty(box2d.b2ContactSolver.prototype,"Initialize",box2d.b2ContactSolver.prototype.Initialize);
box2d.b2ContactSolver.prototype.InitializeVelocityConstraints=function(){var a,b,d,e,f,g,k,m,n,q,s,t,u,v,y,z,A,r,D,C,B=box2d.b2ContactSolver.prototype.InitializeVelocityConstraints.s_xfA,F=box2d.b2ContactSolver.prototype.InitializeVelocityConstraints.s_xfB,J=box2d.b2ContactSolver.prototype.InitializeVelocityConstraints.s_worldManifold;a=0;for(b=this.m_count;a<b;++a){f=this.m_velocityConstraints[a];g=this.m_positionConstraints[a];d=g.radiusA;e=g.radiusB;k=this.m_contacts[f.contactIndex].GetManifold();
m=f.indexA;n=f.indexB;q=f.invMassA;s=f.invMassB;t=f.invIA;u=f.invIB;v=g.localCenterA;y=g.localCenterB;g=this.m_positions[m].c;z=this.m_positions[m].a;A=this.m_velocities[m].v;m=this.m_velocities[m].w;r=this.m_positions[n].c;D=this.m_positions[n].a;C=this.m_velocities[n].v;n=this.m_velocities[n].w;box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<k.pointCount);B.q.SetAngle(z);F.q.SetAngle(D);box2d.b2Sub_V2_V2(g,box2d.b2Mul_R_V2(B.q,v,box2d.b2Vec2.s_t0),B.p);box2d.b2Sub_V2_V2(r,box2d.b2Mul_R_V2(F.q,y,box2d.b2Vec2.s_t0),
F.p);J.Initialize(k,B,d,F,e);f.normal.Copy(J.normal);box2d.b2Cross_V2_S(f.normal,1,f.tangent);e=f.pointCount;for(d=0;d<e;++d)k=f.points[d],box2d.b2Sub_V2_V2(J.points[d],g,k.rA),box2d.b2Sub_V2_V2(J.points[d],r,k.rB),v=box2d.b2Cross_V2_V2(k.rA,f.normal),y=box2d.b2Cross_V2_V2(k.rB,f.normal),v=q+s+t*v*v+u*y*y,k.normalMass=0<v?1/v:0,y=f.tangent,v=box2d.b2Cross_V2_V2(k.rA,y),y=box2d.b2Cross_V2_V2(k.rB,y),v=q+s+t*v*v+u*y*y,k.tangentMass=0<v?1/v:0,k.velocityBias=0,v=box2d.b2Dot_V2_V2(f.normal,box2d.b2Sub_V2_V2(box2d.b2AddCross_V2_S_V2(C,
n,k.rB,box2d.b2Vec2.s_t0),box2d.b2AddCross_V2_S_V2(A,m,k.rA,box2d.b2Vec2.s_t1),box2d.b2Vec2.s_t0)),v<-box2d.b2_velocityThreshold&&(k.velocityBias+=-f.restitution*v);2===f.pointCount&&box2d.g_blockSolve&&(A=f.points[0],r=f.points[1],g=box2d.b2Cross_V2_V2(A.rA,f.normal),A=box2d.b2Cross_V2_V2(A.rB,f.normal),m=box2d.b2Cross_V2_V2(r.rA,f.normal),n=box2d.b2Cross_V2_V2(r.rB,f.normal),r=q+s+t*g*g+u*A*A,C=q+s+t*m*m+u*n*n,q=q+s+t*g*m+u*A*n,r*r<1E3*(r*C-q*q)?(f.K.ex.Set(r,q),f.K.ey.Set(q,C),f.K.GetInverse(f.normalMass)):
f.pointCount=1)}};goog.exportProperty(box2d.b2ContactSolver.prototype,"InitializeVelocityConstraints",box2d.b2ContactSolver.prototype.InitializeVelocityConstraints);box2d.b2ContactSolver.prototype.InitializeVelocityConstraints.s_xfA=new box2d.b2Transform;box2d.b2ContactSolver.prototype.InitializeVelocityConstraints.s_xfB=new box2d.b2Transform;box2d.b2ContactSolver.prototype.InitializeVelocityConstraints.s_worldManifold=new box2d.b2WorldManifold;
box2d.b2ContactSolver.prototype.WarmStart=function(){var a,b,d,e,f,g,k,m,n,q,s,t,u,v,y,z,A,r,D=box2d.b2ContactSolver.prototype.WarmStart.s_P;a=0;for(b=this.m_count;a<b;++a){f=this.m_velocityConstraints[a];g=f.indexA;k=f.indexB;m=f.invMassA;n=f.invIA;q=f.invMassB;s=f.invIB;e=f.pointCount;t=this.m_velocities[g].v;u=this.m_velocities[g].w;v=this.m_velocities[k].v;y=this.m_velocities[k].w;z=f.normal;A=f.tangent;for(d=0;d<e;++d)r=f.points[d],box2d.b2Add_V2_V2(box2d.b2Mul_S_V2(r.normalImpulse,z,box2d.b2Vec2.s_t0),
box2d.b2Mul_S_V2(r.tangentImpulse,A,box2d.b2Vec2.s_t1),D),u-=n*box2d.b2Cross_V2_V2(r.rA,D),t.SelfMulSub(m,D),y+=s*box2d.b2Cross_V2_V2(r.rB,D),v.SelfMulAdd(q,D);this.m_velocities[g].w=u;this.m_velocities[k].w=y}};goog.exportProperty(box2d.b2ContactSolver.prototype,"WarmStart",box2d.b2ContactSolver.prototype.WarmStart);box2d.b2ContactSolver.prototype.WarmStart.s_P=new box2d.b2Vec2;
box2d.b2ContactSolver.prototype.SolveVelocityConstraints=function(){var a,b,d,e,f,g,k,m,n,q,s,t,u,v,y,z,A,r,D,C,B=box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_dv,F=box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_dv1,J=box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_dv2,L,G,K=box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_P,P=box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_a,R=box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_b,O=
box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_x,H=box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_d,T=box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_P1,S=box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_P2,E=box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_P1P2;a=0;for(b=this.m_count;a<b;++a){f=this.m_velocityConstraints[a];g=f.indexA;k=f.indexB;m=f.invMassA;n=f.invIA;q=f.invMassB;s=f.invIB;t=f.pointCount;u=this.m_velocities[g].v;v=this.m_velocities[g].w;
y=this.m_velocities[k].v;z=this.m_velocities[k].w;A=f.normal;r=f.tangent;D=f.friction;box2d.ENABLE_ASSERTS&&box2d.b2Assert(1===t||2===t);d=0;for(e=t;d<e;++d)C=f.points[d],box2d.b2Sub_V2_V2(box2d.b2AddCross_V2_S_V2(y,z,C.rB,box2d.b2Vec2.s_t0),box2d.b2AddCross_V2_S_V2(u,v,C.rA,box2d.b2Vec2.s_t1),B),L=box2d.b2Dot_V2_V2(B,r)-f.tangentSpeed,L=C.tangentMass*-L,G=D*C.normalImpulse,G=box2d.b2Clamp(C.tangentImpulse+L,-G,G),L=G-C.tangentImpulse,C.tangentImpulse=G,box2d.b2Mul_S_V2(L,r,K),u.SelfMulSub(m,K),v-=
n*box2d.b2Cross_V2_V2(C.rA,K),y.SelfMulAdd(q,K),z+=s*box2d.b2Cross_V2_V2(C.rB,K);if(1!==f.pointCount&&box2d.g_blockSolve)for(t=f.points[0],C=f.points[1],P.Set(t.normalImpulse,C.normalImpulse),box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<=P.x&&0<=P.y),box2d.b2Sub_V2_V2(box2d.b2AddCross_V2_S_V2(y,z,t.rB,box2d.b2Vec2.s_t0),box2d.b2AddCross_V2_S_V2(u,v,t.rA,box2d.b2Vec2.s_t1),F),box2d.b2Sub_V2_V2(box2d.b2AddCross_V2_S_V2(y,z,C.rB,box2d.b2Vec2.s_t0),box2d.b2AddCross_V2_S_V2(u,v,C.rA,box2d.b2Vec2.s_t1),J),d=
box2d.b2Dot_V2_V2(F,A),e=box2d.b2Dot_V2_V2(J,A),R.x=d-t.velocityBias,R.y=e-C.velocityBias,R.SelfSub(box2d.b2Mul_M22_V2(f.K,P,box2d.b2Vec2.s_t0));;){box2d.b2Mul_M22_V2(f.normalMass,R,O).SelfNeg();if(0<=O.x&&0<=O.y){box2d.b2Sub_V2_V2(O,P,H);box2d.b2Mul_S_V2(H.x,A,T);box2d.b2Mul_S_V2(H.y,A,S);box2d.b2Add_V2_V2(T,S,E);u.SelfMulSub(m,E);v-=n*(box2d.b2Cross_V2_V2(t.rA,T)+box2d.b2Cross_V2_V2(C.rA,S));y.SelfMulAdd(q,E);z+=s*(box2d.b2Cross_V2_V2(t.rB,T)+box2d.b2Cross_V2_V2(C.rB,S));t.normalImpulse=O.x;C.normalImpulse=
O.y;break}O.x=-t.normalMass*R.x;O.y=0;e=f.K.ex.y*O.x+R.y;if(0<=O.x&&0<=e){box2d.b2Sub_V2_V2(O,P,H);box2d.b2Mul_S_V2(H.x,A,T);box2d.b2Mul_S_V2(H.y,A,S);box2d.b2Add_V2_V2(T,S,E);u.SelfMulSub(m,E);v-=n*(box2d.b2Cross_V2_V2(t.rA,T)+box2d.b2Cross_V2_V2(C.rA,S));y.SelfMulAdd(q,E);z+=s*(box2d.b2Cross_V2_V2(t.rB,T)+box2d.b2Cross_V2_V2(C.rB,S));t.normalImpulse=O.x;C.normalImpulse=O.y;break}O.x=0;O.y=-C.normalMass*R.y;d=f.K.ey.x*O.y+R.x;if(0<=O.y&&0<=d){box2d.b2Sub_V2_V2(O,P,H);box2d.b2Mul_S_V2(H.x,A,T);box2d.b2Mul_S_V2(H.y,
A,S);box2d.b2Add_V2_V2(T,S,E);u.SelfMulSub(m,E);v-=n*(box2d.b2Cross_V2_V2(t.rA,T)+box2d.b2Cross_V2_V2(C.rA,S));y.SelfMulAdd(q,E);z+=s*(box2d.b2Cross_V2_V2(t.rB,T)+box2d.b2Cross_V2_V2(C.rB,S));t.normalImpulse=O.x;C.normalImpulse=O.y;break}O.x=0;O.y=0;d=R.x;e=R.y;if(0<=d&&0<=e){box2d.b2Sub_V2_V2(O,P,H);box2d.b2Mul_S_V2(H.x,A,T);box2d.b2Mul_S_V2(H.y,A,S);box2d.b2Add_V2_V2(T,S,E);u.SelfMulSub(m,E);v-=n*(box2d.b2Cross_V2_V2(t.rA,T)+box2d.b2Cross_V2_V2(C.rA,S));y.SelfMulAdd(q,E);z+=s*(box2d.b2Cross_V2_V2(t.rB,
T)+box2d.b2Cross_V2_V2(C.rB,S));t.normalImpulse=O.x;C.normalImpulse=O.y;break}break}else for(d=0;d<t;++d)C=f.points[d],box2d.b2Sub_V2_V2(box2d.b2AddCross_V2_S_V2(y,z,C.rB,box2d.b2Vec2.s_t0),box2d.b2AddCross_V2_S_V2(u,v,C.rA,box2d.b2Vec2.s_t1),B),e=box2d.b2Dot_V2_V2(B,A),L=-C.normalMass*(e-C.velocityBias),G=box2d.b2Max(C.normalImpulse+L,0),L=G-C.normalImpulse,C.normalImpulse=G,box2d.b2Mul_S_V2(L,A,K),u.SelfMulSub(m,K),v-=n*box2d.b2Cross_V2_V2(C.rA,K),y.SelfMulAdd(q,K),z+=s*box2d.b2Cross_V2_V2(C.rB,
K);this.m_velocities[g].w=v;this.m_velocities[k].w=z}};goog.exportProperty(box2d.b2ContactSolver.prototype,"SolveVelocityConstraints",box2d.b2ContactSolver.prototype.SolveVelocityConstraints);box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_dv=new box2d.b2Vec2;box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_dv1=new box2d.b2Vec2;box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_dv2=new box2d.b2Vec2;box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_P=new box2d.b2Vec2;
box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_a=new box2d.b2Vec2;box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_b=new box2d.b2Vec2;box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_x=new box2d.b2Vec2;box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_d=new box2d.b2Vec2;box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_P1=new box2d.b2Vec2;box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_P2=new box2d.b2Vec2;
box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_P1P2=new box2d.b2Vec2;box2d.b2ContactSolver.prototype.StoreImpulses=function(){var a,b,d,e,f,g;a=0;for(b=this.m_count;a<b;++a)for(f=this.m_velocityConstraints[a],g=this.m_contacts[f.contactIndex].GetManifold(),d=0,e=f.pointCount;d<e;++d)g.points[d].normalImpulse=f.points[d].normalImpulse,g.points[d].tangentImpulse=f.points[d].tangentImpulse};goog.exportProperty(box2d.b2ContactSolver.prototype,"StoreImpulses",box2d.b2ContactSolver.prototype.StoreImpulses);
box2d.b2PositionSolverManifold=function(){this.normal=new box2d.b2Vec2;this.point=new box2d.b2Vec2};goog.exportSymbol("box2d.b2PositionSolverManifold",box2d.b2PositionSolverManifold);box2d.b2PositionSolverManifold.prototype.normal=null;goog.exportProperty(box2d.b2PositionSolverManifold.prototype,"normal",box2d.b2PositionSolverManifold.prototype.normal);box2d.b2PositionSolverManifold.prototype.point=null;goog.exportProperty(box2d.b2PositionSolverManifold.prototype,"point",box2d.b2PositionSolverManifold.prototype.point);
box2d.b2PositionSolverManifold.prototype.separation=0;goog.exportProperty(box2d.b2PositionSolverManifold.prototype,"separation",box2d.b2PositionSolverManifold.prototype.separation);
box2d.b2PositionSolverManifold.prototype.Initialize=function(a,b,d,e){var f=box2d.b2PositionSolverManifold.prototype.Initialize.s_pointA,g=box2d.b2PositionSolverManifold.prototype.Initialize.s_pointB,k=box2d.b2PositionSolverManifold.prototype.Initialize.s_planePoint,m=box2d.b2PositionSolverManifold.prototype.Initialize.s_clipPoint;box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<a.pointCount);switch(a.type){case box2d.b2ManifoldType.e_circles:box2d.b2Mul_X_V2(b,a.localPoint,f);box2d.b2Mul_X_V2(d,a.localPoints[0],
g);box2d.b2Sub_V2_V2(g,f,this.normal).SelfNormalize();box2d.b2Mid_V2_V2(f,g,this.point);this.separation=box2d.b2Dot_V2_V2(box2d.b2Sub_V2_V2(g,f,box2d.b2Vec2.s_t0),this.normal)-a.radiusA-a.radiusB;break;case box2d.b2ManifoldType.e_faceA:box2d.b2Mul_R_V2(b.q,a.localNormal,this.normal);box2d.b2Mul_X_V2(b,a.localPoint,k);box2d.b2Mul_X_V2(d,a.localPoints[e],m);this.separation=box2d.b2Dot_V2_V2(box2d.b2Sub_V2_V2(m,k,box2d.b2Vec2.s_t0),this.normal)-a.radiusA-a.radiusB;this.point.Copy(m);break;case box2d.b2ManifoldType.e_faceB:box2d.b2Mul_R_V2(d.q,
a.localNormal,this.normal),box2d.b2Mul_X_V2(d,a.localPoint,k),box2d.b2Mul_X_V2(b,a.localPoints[e],m),this.separation=box2d.b2Dot_V2_V2(box2d.b2Sub_V2_V2(m,k,box2d.b2Vec2.s_t0),this.normal)-a.radiusA-a.radiusB,this.point.Copy(m),this.normal.SelfNeg()}};goog.exportProperty(box2d.b2PositionSolverManifold.prototype,"Initialize",box2d.b2PositionSolverManifold.prototype.Initialize);box2d.b2PositionSolverManifold.prototype.Initialize.s_pointA=new box2d.b2Vec2;
box2d.b2PositionSolverManifold.prototype.Initialize.s_pointB=new box2d.b2Vec2;box2d.b2PositionSolverManifold.prototype.Initialize.s_planePoint=new box2d.b2Vec2;box2d.b2PositionSolverManifold.prototype.Initialize.s_clipPoint=new box2d.b2Vec2;
box2d.b2ContactSolver.prototype.SolvePositionConstraints=function(){var a,b,d,e,f,g,k,m,n,q,s,t,u,v,y,z,A,r=box2d.b2ContactSolver.prototype.SolvePositionConstraints.s_xfA,D=box2d.b2ContactSolver.prototype.SolvePositionConstraints.s_xfB,C=box2d.b2ContactSolver.prototype.SolvePositionConstraints.s_psm,B,F,J,L=box2d.b2ContactSolver.prototype.SolvePositionConstraints.s_rA,G=box2d.b2ContactSolver.prototype.SolvePositionConstraints.s_rB,K,P=box2d.b2ContactSolver.prototype.SolvePositionConstraints.s_P,R=
0;a=0;for(b=this.m_count;a<b;++a){f=this.m_positionConstraints[a];g=f.indexA;k=f.indexB;m=f.localCenterA;n=f.invMassA;q=f.invIA;s=f.localCenterB;t=f.invMassB;u=f.invIB;e=f.pointCount;v=this.m_positions[g].c;y=this.m_positions[g].a;z=this.m_positions[k].c;A=this.m_positions[k].a;for(d=0;d<e;++d)r.q.SetAngle(y),D.q.SetAngle(A),box2d.b2Sub_V2_V2(v,box2d.b2Mul_R_V2(r.q,m,box2d.b2Vec2.s_t0),r.p),box2d.b2Sub_V2_V2(z,box2d.b2Mul_R_V2(D.q,s,box2d.b2Vec2.s_t0),D.p),C.Initialize(f,r,D,d),B=C.normal,F=C.point,
J=C.separation,box2d.b2Sub_V2_V2(F,v,L),box2d.b2Sub_V2_V2(F,z,G),R=box2d.b2Min(R,J),F=box2d.b2Clamp(box2d.b2_baumgarte*(J+box2d.b2_linearSlop),-box2d.b2_maxLinearCorrection,0),J=box2d.b2Cross_V2_V2(L,B),K=box2d.b2Cross_V2_V2(G,B),J=n+t+q*J*J+u*K*K,F=0<J?-F/J:0,box2d.b2Mul_S_V2(F,B,P),v.SelfMulSub(n,P),y-=q*box2d.b2Cross_V2_V2(L,P),z.SelfMulAdd(t,P),A+=u*box2d.b2Cross_V2_V2(G,P);this.m_positions[g].a=y;this.m_positions[k].a=A}return R>-3*box2d.b2_linearSlop};
goog.exportProperty(box2d.b2ContactSolver.prototype,"SolvePositionConstraints",box2d.b2ContactSolver.prototype.SolvePositionConstraints);box2d.b2ContactSolver.prototype.SolvePositionConstraints.s_xfA=new box2d.b2Transform;box2d.b2ContactSolver.prototype.SolvePositionConstraints.s_xfB=new box2d.b2Transform;box2d.b2ContactSolver.prototype.SolvePositionConstraints.s_psm=new box2d.b2PositionSolverManifold;box2d.b2ContactSolver.prototype.SolvePositionConstraints.s_rA=new box2d.b2Vec2;
box2d.b2ContactSolver.prototype.SolvePositionConstraints.s_rB=new box2d.b2Vec2;box2d.b2ContactSolver.prototype.SolvePositionConstraints.s_P=new box2d.b2Vec2;
box2d.b2ContactSolver.prototype.SolveTOIPositionConstraints=function(a,b){var d,e,f,g,k,m,n,q,s,t,u,v,y,z,A,r,D,C=box2d.b2ContactSolver.prototype.SolveTOIPositionConstraints.s_xfA,B=box2d.b2ContactSolver.prototype.SolveTOIPositionConstraints.s_xfB,F=box2d.b2ContactSolver.prototype.SolveTOIPositionConstraints.s_psm,J,L,G,K=box2d.b2ContactSolver.prototype.SolveTOIPositionConstraints.s_rA,P=box2d.b2ContactSolver.prototype.SolveTOIPositionConstraints.s_rB,R,O=box2d.b2ContactSolver.prototype.SolveTOIPositionConstraints.s_P,
H=0;d=0;for(e=this.m_count;d<e;++d){k=this.m_positionConstraints[d];m=k.indexA;n=k.indexB;q=k.localCenterA;s=k.localCenterB;g=k.pointCount;u=t=0;if(m===a||m===b)t=k.invMassA,u=k.invIA;y=v=0;if(n===a||n===b)v=k.invMassB,y=k.invIB;z=this.m_positions[m].c;A=this.m_positions[m].a;r=this.m_positions[n].c;D=this.m_positions[n].a;for(f=0;f<g;++f)C.q.SetAngle(A),B.q.SetAngle(D),box2d.b2Sub_V2_V2(z,box2d.b2Mul_R_V2(C.q,q,box2d.b2Vec2.s_t0),C.p),box2d.b2Sub_V2_V2(r,box2d.b2Mul_R_V2(B.q,s,box2d.b2Vec2.s_t0),
B.p),F.Initialize(k,C,B,f),J=F.normal,L=F.point,G=F.separation,box2d.b2Sub_V2_V2(L,z,K),box2d.b2Sub_V2_V2(L,r,P),H=box2d.b2Min(H,G),L=box2d.b2Clamp(box2d.b2_toiBaumgarte*(G+box2d.b2_linearSlop),-box2d.b2_maxLinearCorrection,0),G=box2d.b2Cross_V2_V2(K,J),R=box2d.b2Cross_V2_V2(P,J),G=t+v+u*G*G+y*R*R,L=0<G?-L/G:0,box2d.b2Mul_S_V2(L,J,O),z.SelfMulSub(t,O),A-=u*box2d.b2Cross_V2_V2(K,O),r.SelfMulAdd(v,O),D+=y*box2d.b2Cross_V2_V2(P,O);this.m_positions[m].a=A;this.m_positions[n].a=D}return H>=-1.5*box2d.b2_linearSlop};
goog.exportProperty(box2d.b2ContactSolver.prototype,"SolveTOIPositionConstraints",box2d.b2ContactSolver.prototype.SolveTOIPositionConstraints);box2d.b2ContactSolver.prototype.SolveTOIPositionConstraints.s_xfA=new box2d.b2Transform;box2d.b2ContactSolver.prototype.SolveTOIPositionConstraints.s_xfB=new box2d.b2Transform;box2d.b2ContactSolver.prototype.SolveTOIPositionConstraints.s_psm=new box2d.b2PositionSolverManifold;box2d.b2ContactSolver.prototype.SolveTOIPositionConstraints.s_rA=new box2d.b2Vec2;
box2d.b2ContactSolver.prototype.SolveTOIPositionConstraints.s_rB=new box2d.b2Vec2;box2d.b2ContactSolver.prototype.SolveTOIPositionConstraints.s_P=new box2d.b2Vec2;box2d.b2Island=function(){this.m_bodies=Array(1024);this.m_contacts=Array(1024);this.m_joints=Array(1024);this.m_positions=box2d.b2Position.MakeArray(1024);this.m_velocities=box2d.b2Velocity.MakeArray(1024)};goog.exportSymbol("box2d.b2Island",box2d.b2Island);box2d.b2Island.prototype.m_allocator=null;
goog.exportProperty(box2d.b2Island.prototype,"m_allocator",box2d.b2Island.prototype.m_allocator);box2d.b2Island.prototype.m_listener=null;goog.exportProperty(box2d.b2Island.prototype,"m_listener",box2d.b2Island.prototype.m_listener);box2d.b2Island.prototype.m_bodies=null;goog.exportProperty(box2d.b2Island.prototype,"m_bodies",box2d.b2Island.prototype.m_bodies);box2d.b2Island.prototype.m_contacts=null;goog.exportProperty(box2d.b2Island.prototype,"m_contacts",box2d.b2Island.prototype.m_contacts);
box2d.b2Island.prototype.m_joints=null;goog.exportProperty(box2d.b2Island.prototype,"m_joints",box2d.b2Island.prototype.m_joints);box2d.b2Island.prototype.m_positions=null;goog.exportProperty(box2d.b2Island.prototype,"m_positions",box2d.b2Island.prototype.m_positions);box2d.b2Island.prototype.m_velocities=null;goog.exportProperty(box2d.b2Island.prototype,"m_velocities",box2d.b2Island.prototype.m_velocities);box2d.b2Island.prototype.m_bodyCount=0;
goog.exportProperty(box2d.b2Island.prototype,"m_bodyCount",box2d.b2Island.prototype.m_bodyCount);box2d.b2Island.prototype.m_jointCount=0;goog.exportProperty(box2d.b2Island.prototype,"m_jointCount",box2d.b2Island.prototype.m_jointCount);box2d.b2Island.prototype.m_contactCount=0;goog.exportProperty(box2d.b2Island.prototype,"m_contactCount",box2d.b2Island.prototype.m_contactCount);box2d.b2Island.prototype.m_bodyCapacity=0;goog.exportProperty(box2d.b2Island.prototype,"m_bodyCapacity",box2d.b2Island.prototype.m_bodyCapacity);
box2d.b2Island.prototype.m_contactCapacity=0;goog.exportProperty(box2d.b2Island.prototype,"m_contactCapacity",box2d.b2Island.prototype.m_contactCapacity);box2d.b2Island.prototype.m_jointCapacity=0;goog.exportProperty(box2d.b2Island.prototype,"m_jointCapacity",box2d.b2Island.prototype.m_jointCapacity);
box2d.b2Island.prototype.Initialize=function(a,b,d,e,f){this.m_bodyCapacity=a;this.m_contactCapacity=b;this.m_jointCapacity=d;this.m_jointCount=this.m_contactCount=this.m_bodyCount=0;this.m_allocator=e;for(this.m_listener=f;this.m_bodies.length<a;)this.m_bodies[this.m_bodies.length]=null;for(;this.m_contacts.length<b;)this.m_contacts[this.m_contacts.length]=null;for(;this.m_joints.length<d;)this.m_joints[this.m_joints.length]=null;if(this.m_positions.length<a)for(b=box2d.b2Max(2*this.m_positions.length,
a),box2d.DEBUG&&window.console.log("box2d.b2Island.m_positions: "+b);this.m_positions.length<b;)this.m_positions[this.m_positions.length]=new box2d.b2Position;if(this.m_velocities.length<a)for(b=box2d.b2Max(2*this.m_velocities.length,a),box2d.DEBUG&&window.console.log("box2d.b2Island.m_velocities: "+b);this.m_velocities.length<b;)this.m_velocities[this.m_velocities.length]=new box2d.b2Velocity};goog.exportProperty(box2d.b2Island.prototype,"Initialize",box2d.b2Island.prototype.Initialize);
box2d.b2Island.prototype.Clear=function(){this.m_jointCount=this.m_contactCount=this.m_bodyCount=0};goog.exportProperty(box2d.b2Island.prototype,"Clear",box2d.b2Island.prototype.Clear);box2d.b2Island.prototype.AddBody=function(a){box2d.ENABLE_ASSERTS&&box2d.b2Assert(this.m_bodyCount<this.m_bodyCapacity);a.m_islandIndex=this.m_bodyCount;this.m_bodies[this.m_bodyCount++]=a};goog.exportProperty(box2d.b2Island.prototype,"AddBody",box2d.b2Island.prototype.AddBody);
box2d.b2Island.prototype.AddContact=function(a){box2d.ENABLE_ASSERTS&&box2d.b2Assert(this.m_contactCount<this.m_contactCapacity);this.m_contacts[this.m_contactCount++]=a};goog.exportProperty(box2d.b2Island.prototype,"AddContact",box2d.b2Island.prototype.AddContact);box2d.b2Island.prototype.AddJoint=function(a){box2d.ENABLE_ASSERTS&&box2d.b2Assert(this.m_jointCount<this.m_jointCapacity);this.m_joints[this.m_jointCount++]=a};goog.exportProperty(box2d.b2Island.prototype,"AddJoint",box2d.b2Island.prototype.AddJoint);
box2d.b2Island.prototype.Solve=function(a,b,d,e){for(var f=box2d.b2Island.s_timer.Reset(),g=b.dt,k=0;k<this.m_bodyCount;++k){var m=this.m_bodies[k],n=this.m_positions[k].c.Copy(m.m_sweep.c),q=m.m_sweep.a,s=this.m_velocities[k].v.Copy(m.m_linearVelocity),t=m.m_angularVelocity;m.m_sweep.c0.Copy(m.m_sweep.c);m.m_sweep.a0=m.m_sweep.a;m.m_type===box2d.b2BodyType.b2_dynamicBody&&(s.x+=g*(m.m_gravityScale*d.x+m.m_invMass*m.m_force.x),s.y+=g*(m.m_gravityScale*d.y+m.m_invMass*m.m_force.y),t+=g*m.m_invI*m.m_torque,
s.SelfMul(1/(1+g*m.m_linearDamping)),t*=1/(1+g*m.m_angularDamping));this.m_positions[k].a=q;this.m_velocities[k].w=t}f.Reset();m=box2d.b2Island.s_solverData;m.step.Copy(b);m.positions=this.m_positions;m.velocities=this.m_velocities;k=box2d.b2Island.s_contactSolverDef;k.step.Copy(b);k.contacts=this.m_contacts;k.count=this.m_contactCount;k.positions=this.m_positions;k.velocities=this.m_velocities;k.allocator=this.m_allocator;d=box2d.b2Island.s_contactSolver.Initialize(k);d.InitializeVelocityConstraints();
b.warmStarting&&d.WarmStart();for(k=0;k<this.m_jointCount;++k)this.m_joints[k].InitVelocityConstraints(m);a.solveInit=f.GetMilliseconds();f.Reset();for(k=0;k<b.velocityIterations;++k){for(q=0;q<this.m_jointCount;++q)this.m_joints[q].SolveVelocityConstraints(m);d.SolveVelocityConstraints()}d.StoreImpulses();a.solveVelocity=f.GetMilliseconds();for(k=0;k<this.m_bodyCount;++k){var n=this.m_positions[k].c,q=this.m_positions[k].a,s=this.m_velocities[k].v,t=this.m_velocities[k].w,u=box2d.b2Mul_S_V2(g,s,
box2d.b2Island.s_translation);box2d.b2Dot_V2_V2(u,u)>box2d.b2_maxTranslationSquared&&(u=box2d.b2_maxTranslation/u.Length(),s.SelfMul(u));u=g*t;u*u>box2d.b2_maxRotationSquared&&(u=box2d.b2_maxRotation/box2d.b2Abs(u),t*=u);n.x+=g*s.x;n.y+=g*s.y;q+=g*t;this.m_positions[k].a=q;this.m_velocities[k].w=t}f.Reset();n=!1;for(k=0;k<b.positionIterations;++k){s=d.SolvePositionConstraints();t=!0;for(q=0;q<this.m_jointCount;++q)u=this.m_joints[q].SolvePositionConstraints(m),t=t&&u;if(s&&t){n=!0;break}}for(k=0;k<
this.m_bodyCount;++k)b=this.m_bodies[k],b.m_sweep.c.Copy(this.m_positions[k].c),b.m_sweep.a=this.m_positions[k].a,b.m_linearVelocity.Copy(this.m_velocities[k].v),b.m_angularVelocity=this.m_velocities[k].w,b.SynchronizeTransform();a.solvePosition=f.GetMilliseconds();this.Report(d.m_velocityConstraints);if(e){a=box2d.b2_maxFloat;e=box2d.b2_linearSleepTolerance*box2d.b2_linearSleepTolerance;f=box2d.b2_angularSleepTolerance*box2d.b2_angularSleepTolerance;for(k=0;k<this.m_bodyCount;++k)m=this.m_bodies[k],
m.GetType()!==box2d.b2BodyType.b2_staticBody&&(!m.m_flag_autoSleepFlag||m.m_angularVelocity*m.m_angularVelocity>f||box2d.b2Dot_V2_V2(m.m_linearVelocity,m.m_linearVelocity)>e?a=m.m_sleepTime=0:(m.m_sleepTime+=g,a=box2d.b2Min(a,m.m_sleepTime)));if(a>=box2d.b2_timeToSleep&&n)for(k=0;k<this.m_bodyCount;++k)m=this.m_bodies[k],m.SetAwake(!1)}};goog.exportProperty(box2d.b2Island.prototype,"Solve",box2d.b2Island.prototype.Solve);
box2d.b2Island.prototype.SolveTOI=function(a,b,d){box2d.ENABLE_ASSERTS&&box2d.b2Assert(b<this.m_bodyCount);box2d.ENABLE_ASSERTS&&box2d.b2Assert(d<this.m_bodyCount);for(var e=0;e<this.m_bodyCount;++e){var f=this.m_bodies[e];this.m_positions[e].c.Copy(f.m_sweep.c);this.m_positions[e].a=f.m_sweep.a;this.m_velocities[e].v.Copy(f.m_linearVelocity);this.m_velocities[e].w=f.m_angularVelocity}e=box2d.b2Island.s_contactSolverDef;e.contacts=this.m_contacts;e.count=this.m_contactCount;e.allocator=this.m_allocator;
e.step.Copy(a);e.positions=this.m_positions;e.velocities=this.m_velocities;f=box2d.b2Island.s_contactSolver.Initialize(e);for(e=0;e<a.positionIterations&&!f.SolveTOIPositionConstraints(b,d);++e);this.m_bodies[b].m_sweep.c0.Copy(this.m_positions[b].c);this.m_bodies[b].m_sweep.a0=this.m_positions[b].a;this.m_bodies[d].m_sweep.c0.Copy(this.m_positions[d].c);this.m_bodies[d].m_sweep.a0=this.m_positions[d].a;f.InitializeVelocityConstraints();for(e=0;e<a.velocityIterations;++e)f.SolveVelocityConstraints();
a=a.dt;for(e=0;e<this.m_bodyCount;++e){b=this.m_positions[e].c;d=this.m_positions[e].a;var g=this.m_velocities[e].v,k=this.m_velocities[e].w,m=box2d.b2Mul_S_V2(a,g,box2d.b2Island.s_translation);box2d.b2Dot_V2_V2(m,m)>box2d.b2_maxTranslationSquared&&(m=box2d.b2_maxTranslation/m.Length(),g.SelfMul(m));m=a*k;m*m>box2d.b2_maxRotationSquared&&(m=box2d.b2_maxRotation/box2d.b2Abs(m),k*=m);b.SelfMulAdd(a,g);d+=a*k;this.m_positions[e].a=d;this.m_velocities[e].w=k;m=this.m_bodies[e];m.m_sweep.c.Copy(b);m.m_sweep.a=
d;m.m_linearVelocity.Copy(g);m.m_angularVelocity=k;m.SynchronizeTransform()}this.Report(f.m_velocityConstraints)};goog.exportProperty(box2d.b2Island.prototype,"SolveTOI",box2d.b2Island.prototype.SolveTOI);
box2d.b2Island.prototype.Report=function(a){if(null!==this.m_listener)for(var b=0;b<this.m_contactCount;++b){var d=this.m_contacts[b];if(d){var e=a[b],f=box2d.b2Island.s_impulse;f.count=e.pointCount;for(var g=0;g<e.pointCount;++g)f.normalImpulses[g]=e.points[g].normalImpulse,f.tangentImpulses[g]=e.points[g].tangentImpulse;this.m_listener.PostSolve(d,f)}}};goog.exportProperty(box2d.b2Island.prototype,"Report",box2d.b2Island.prototype.Report);box2d.b2Island.s_timer=new box2d.b2Timer;
box2d.b2Island.s_solverData=new box2d.b2SolverData;box2d.b2Island.s_contactSolverDef=new box2d.b2ContactSolverDef;box2d.b2Island.s_contactSolver=new box2d.b2ContactSolver;box2d.b2Island.s_translation=new box2d.b2Vec2;box2d.b2Island.s_impulse=new box2d.b2ContactImpulse;box2d.b2JointType={e_unknownJoint:0,e_revoluteJoint:1,e_prismaticJoint:2,e_distanceJoint:3,e_pulleyJoint:4,e_mouseJoint:5,e_gearJoint:6,e_wheelJoint:7,e_weldJoint:8,e_frictionJoint:9,e_ropeJoint:10,e_motorJoint:11,e_areaJoint:12};
goog.exportSymbol("box2d.b2JointType",box2d.b2JointType);goog.exportProperty(box2d.b2JointType,"e_unknownJoint",box2d.b2JointType.e_unknownJoint);goog.exportProperty(box2d.b2JointType,"e_revoluteJoint",box2d.b2JointType.e_revoluteJoint);goog.exportProperty(box2d.b2JointType,"e_prismaticJoint",box2d.b2JointType.e_prismaticJoint);goog.exportProperty(box2d.b2JointType,"e_distanceJoint",box2d.b2JointType.e_distanceJoint);goog.exportProperty(box2d.b2JointType,"e_pulleyJoint",box2d.b2JointType.e_pulleyJoint);
goog.exportProperty(box2d.b2JointType,"e_mouseJoint",box2d.b2JointType.e_mouseJoint);goog.exportProperty(box2d.b2JointType,"e_gearJoint",box2d.b2JointType.e_gearJoint);goog.exportProperty(box2d.b2JointType,"e_wheelJoint",box2d.b2JointType.e_wheelJoint);goog.exportProperty(box2d.b2JointType,"e_weldJoint",box2d.b2JointType.e_weldJoint);goog.exportProperty(box2d.b2JointType,"e_frictionJoint",box2d.b2JointType.e_frictionJoint);goog.exportProperty(box2d.b2JointType,"e_ropeJoint",box2d.b2JointType.e_ropeJoint);
goog.exportProperty(box2d.b2JointType,"e_motorJoint",box2d.b2JointType.e_motorJoint);goog.exportProperty(box2d.b2JointType,"e_areaJoint",box2d.b2JointType.e_areaJoint);box2d.b2LimitState={e_inactiveLimit:0,e_atLowerLimit:1,e_atUpperLimit:2,e_equalLimits:3};goog.exportSymbol("box2d.b2LimitState",box2d.b2LimitState);goog.exportProperty(box2d.b2LimitState,"e_inactiveLimit",box2d.b2LimitState.e_inactiveLimit);goog.exportProperty(box2d.b2LimitState,"e_atLowerLimit",box2d.b2LimitState.e_atLowerLimit);
goog.exportProperty(box2d.b2LimitState,"e_atUpperLimit",box2d.b2LimitState.e_atUpperLimit);goog.exportProperty(box2d.b2LimitState,"e_equalLimits",box2d.b2LimitState.e_equalLimits);box2d.b2Jacobian=function(){this.linear=new box2d.b2Vec2};goog.exportSymbol("box2d.b2Jacobian",box2d.b2Jacobian);box2d.b2Jacobian.prototype.linear=null;goog.exportProperty(box2d.b2Jacobian.prototype,"linear",box2d.b2Jacobian.prototype.linear);box2d.b2Jacobian.prototype.angularA=0;
goog.exportProperty(box2d.b2Jacobian.prototype,"angularA",box2d.b2Jacobian.prototype.angularA);box2d.b2Jacobian.prototype.angularB=0;goog.exportProperty(box2d.b2Jacobian.prototype,"angularB",box2d.b2Jacobian.prototype.angularB);box2d.b2Jacobian.prototype.SetZero=function(){this.linear.SetZero();this.angularB=this.angularA=0;return this};goog.exportProperty(box2d.b2Jacobian.prototype,"SetZero",box2d.b2Jacobian.prototype.SetZero);
box2d.b2Jacobian.prototype.Set=function(a,b,d){this.linear.Copy(a);this.angularA=b;this.angularB=d;return this};goog.exportProperty(box2d.b2Jacobian.prototype,"Set",box2d.b2Jacobian.prototype.Set);box2d.b2JointEdge=function(){};goog.exportSymbol("box2d.b2JointEdge",box2d.b2JointEdge);box2d.b2JointEdge.prototype.other=null;goog.exportProperty(box2d.b2JointEdge.prototype,"other",box2d.b2JointEdge.prototype.other);box2d.b2JointEdge.prototype.joint=null;
goog.exportProperty(box2d.b2JointEdge.prototype,"joint",box2d.b2JointEdge.prototype.joint);box2d.b2JointEdge.prototype.prev=null;goog.exportProperty(box2d.b2JointEdge.prototype,"prev",box2d.b2JointEdge.prototype.prev);box2d.b2JointEdge.prototype.next=null;goog.exportProperty(box2d.b2JointEdge.prototype,"next",box2d.b2JointEdge.prototype.next);box2d.b2JointDef=function(a){this.type=a};goog.exportSymbol("box2d.b2JointDef",box2d.b2JointDef);box2d.b2JointDef.prototype.type=box2d.b2JointType.e_unknownJoint;
goog.exportProperty(box2d.b2JointDef.prototype,"type",box2d.b2JointDef.prototype.type);box2d.b2JointDef.prototype.userData=null;goog.exportProperty(box2d.b2JointDef.prototype,"userData",box2d.b2JointDef.prototype.userData);box2d.b2JointDef.prototype.bodyA=null;goog.exportProperty(box2d.b2JointDef.prototype,"bodyA",box2d.b2JointDef.prototype.bodyA);box2d.b2JointDef.prototype.bodyB=null;goog.exportProperty(box2d.b2JointDef.prototype,"bodyB",box2d.b2JointDef.prototype.bodyB);
box2d.b2JointDef.prototype.collideConnected=!1;goog.exportProperty(box2d.b2JointDef.prototype,"collideConnected",box2d.b2JointDef.prototype.collideConnected);box2d.b2Joint=function(a){box2d.ENABLE_ASSERTS&&box2d.b2Assert(a.bodyA!==a.bodyB);this.m_type=a.type;this.m_edgeA=new box2d.b2JointEdge;this.m_edgeB=new box2d.b2JointEdge;this.m_bodyA=a.bodyA;this.m_bodyB=a.bodyB;this.m_collideConnected=a.collideConnected;this.m_userData=a.userData};goog.exportSymbol("box2d.b2Joint",box2d.b2Joint);
box2d.b2Joint.prototype.m_type=box2d.b2JointType.e_unknownJoint;goog.exportProperty(box2d.b2Joint.prototype,"m_type",box2d.b2Joint.prototype.m_type);box2d.b2Joint.prototype.m_prev=null;goog.exportProperty(box2d.b2Joint.prototype,"m_prev",box2d.b2Joint.prototype.m_prev);box2d.b2Joint.prototype.m_next=null;goog.exportProperty(box2d.b2Joint.prototype,"m_next",box2d.b2Joint.prototype.m_next);box2d.b2Joint.prototype.m_edgeA=null;goog.exportProperty(box2d.b2Joint.prototype,"m_edgeA",box2d.b2Joint.prototype.m_edgeA);
box2d.b2Joint.prototype.m_edgeB=null;goog.exportProperty(box2d.b2Joint.prototype,"m_edgeB",box2d.b2Joint.prototype.m_edgeB);box2d.b2Joint.prototype.m_bodyA=null;goog.exportProperty(box2d.b2Joint.prototype,"m_bodyA",box2d.b2Joint.prototype.m_bodyA);box2d.b2Joint.prototype.m_bodyB=null;goog.exportProperty(box2d.b2Joint.prototype,"m_bodyB",box2d.b2Joint.prototype.m_bodyB);box2d.b2Joint.prototype.m_index=0;goog.exportProperty(box2d.b2Joint.prototype,"m_index",box2d.b2Joint.prototype.m_index);
box2d.b2Joint.prototype.m_islandFlag=!1;goog.exportProperty(box2d.b2Joint.prototype,"m_islandFlag",box2d.b2Joint.prototype.m_islandFlag);box2d.b2Joint.prototype.m_collideConnected=!1;goog.exportProperty(box2d.b2Joint.prototype,"m_collideConnected",box2d.b2Joint.prototype.m_collideConnected);box2d.b2Joint.prototype.m_userData=null;goog.exportProperty(box2d.b2Joint.prototype,"m_userData",box2d.b2Joint.prototype.m_userData);box2d.b2Joint.prototype.GetAnchorA=function(a){return a.SetZero()};
goog.exportProperty(box2d.b2Joint.prototype,"GetAnchorA",box2d.b2Joint.prototype.GetAnchorA);box2d.b2Joint.prototype.GetAnchorB=function(a){return a.SetZero()};goog.exportProperty(box2d.b2Joint.prototype,"GetAnchorB",box2d.b2Joint.prototype.GetAnchorB);box2d.b2Joint.prototype.GetReactionForce=function(a,b){return b.SetZero()};goog.exportProperty(box2d.b2Joint.prototype,"GetReactionForce",box2d.b2Joint.prototype.GetReactionForce);box2d.b2Joint.prototype.GetReactionTorque=function(a){return 0};
goog.exportProperty(box2d.b2Joint.prototype,"GetReactionTorque",box2d.b2Joint.prototype.GetReactionTorque);box2d.b2Joint.prototype.InitVelocityConstraints=function(a){};goog.exportProperty(box2d.b2Joint.prototype,"InitVelocityConstraints",box2d.b2Joint.prototype.InitVelocityConstraints);box2d.b2Joint.prototype.SolveVelocityConstraints=function(a){};goog.exportProperty(box2d.b2Joint.prototype,"SolveVelocityConstraints",box2d.b2Joint.prototype.SolveVelocityConstraints);
box2d.b2Joint.prototype.SolvePositionConstraints=function(a){return!1};goog.exportProperty(box2d.b2Joint.prototype,"SolvePositionConstraints",box2d.b2Joint.prototype.SolvePositionConstraints);box2d.b2Joint.prototype.GetType=function(){return this.m_type};goog.exportProperty(box2d.b2Joint.prototype,"GetType",box2d.b2Joint.prototype.GetType);box2d.b2Joint.prototype.GetBodyA=function(){return this.m_bodyA};goog.exportProperty(box2d.b2Joint.prototype,"GetBodyA",box2d.b2Joint.prototype.GetBodyA);
box2d.b2Joint.prototype.GetBodyB=function(){return this.m_bodyB};goog.exportProperty(box2d.b2Joint.prototype,"GetBodyB",box2d.b2Joint.prototype.GetBodyB);box2d.b2Joint.prototype.GetNext=function(){return this.m_next};goog.exportProperty(box2d.b2Joint.prototype,"GetNext",box2d.b2Joint.prototype.GetNext);box2d.b2Joint.prototype.GetUserData=function(){return this.m_userData};goog.exportProperty(box2d.b2Joint.prototype,"GetUserData",box2d.b2Joint.prototype.GetUserData);
box2d.b2Joint.prototype.SetUserData=function(a){this.m_userData=a};goog.exportProperty(box2d.b2Joint.prototype,"SetUserData",box2d.b2Joint.prototype.SetUserData);box2d.b2Joint.prototype.GetCollideConnected=function(){return this.m_collideConnected};goog.exportProperty(box2d.b2Joint.prototype,"GetCollideConnected",box2d.b2Joint.prototype.GetCollideConnected);box2d.b2Joint.prototype.Dump=function(){box2d.DEBUG&&box2d.b2Log("// Dump is not supported for this joint type.\n")};
goog.exportProperty(box2d.b2Joint.prototype,"Dump",box2d.b2Joint.prototype.Dump);box2d.b2Joint.prototype.IsActive=function(){return this.m_bodyA.IsActive()&&this.m_bodyB.IsActive()};goog.exportProperty(box2d.b2Joint.prototype,"IsActive",box2d.b2Joint.prototype.IsActive);box2d.b2Joint.prototype.ShiftOrigin=function(a){};goog.exportProperty(box2d.b2Joint.prototype,"ShiftOrigin",box2d.b2Joint.prototype.ShiftOrigin);
box2d.b2AreaJointDef=function(){box2d.b2JointDef.call(this,box2d.b2JointType.e_areaJoint);this.bodies=[]};goog.inherits(box2d.b2AreaJointDef,box2d.b2JointDef);goog.exportSymbol("box2d.b2AreaJointDef",box2d.b2AreaJointDef);box2d.b2AreaJointDef.prototype.world=null;goog.exportProperty(box2d.b2AreaJointDef.prototype,"world",box2d.b2AreaJointDef.prototype.world);box2d.b2AreaJointDef.prototype.bodies=null;goog.exportProperty(box2d.b2AreaJointDef.prototype,"bodies",box2d.b2AreaJointDef.prototype.bodies);
box2d.b2AreaJointDef.prototype.frequencyHz=0;goog.exportProperty(box2d.b2AreaJointDef.prototype,"frequencyHz",box2d.b2AreaJointDef.prototype.frequencyHz);box2d.b2AreaJointDef.prototype.dampingRatio=0;goog.exportProperty(box2d.b2AreaJointDef.prototype,"dampingRatio",box2d.b2AreaJointDef.prototype.dampingRatio);box2d.b2AreaJointDef.prototype.AddBody=function(a){this.bodies.push(a);1===this.bodies.length?this.bodyA=a:2===this.bodies.length&&(this.bodyB=a)};
goog.exportProperty(box2d.b2AreaJointDef.prototype,"AddBody",box2d.b2AreaJointDef.prototype.AddBody);
box2d.b2AreaJoint=function(a){box2d.b2Joint.call(this,a);box2d.ENABLE_ASSERTS&&box2d.b2Assert(3<=a.bodies.length,"You cannot create an area joint with less than three bodies.");this.m_bodies=a.bodies;this.m_frequencyHz=a.frequencyHz;this.m_dampingRatio=a.dampingRatio;this.m_targetLengths=box2d.b2MakeNumberArray(a.bodies.length);this.m_normals=box2d.b2Vec2.MakeArray(a.bodies.length);this.m_joints=Array(a.bodies.length);this.m_deltas=box2d.b2Vec2.MakeArray(a.bodies.length);this.m_delta=new box2d.b2Vec2;
var b=new box2d.b2DistanceJointDef;b.frequencyHz=a.frequencyHz;b.dampingRatio=a.dampingRatio;for(var d=this.m_targetArea=0,e=this.m_bodies.length;d<e;++d){var f=this.m_bodies[d],g=this.m_bodies[(d+1)%e],k=f.GetWorldCenter(),m=g.GetWorldCenter();this.m_targetLengths[d]=box2d.b2Distance(k,m);this.m_targetArea+=box2d.b2Cross_V2_V2(k,m);b.Initialize(f,g,k,m);this.m_joints[d]=a.world.CreateJoint(b)}this.m_targetArea*=.5};goog.inherits(box2d.b2AreaJoint,box2d.b2Joint);
goog.exportSymbol("box2d.b2AreaJoint",box2d.b2AreaJoint);box2d.b2AreaJoint.prototype.m_bodies=null;goog.exportProperty(box2d.b2AreaJoint.prototype,"m_bodies",box2d.b2AreaJoint.prototype.m_bodies);box2d.b2AreaJoint.prototype.m_frequencyHz=0;goog.exportProperty(box2d.b2AreaJoint.prototype,"m_frequencyHz",box2d.b2AreaJoint.prototype.m_frequencyHz);box2d.b2AreaJoint.prototype.m_dampingRatio=0;goog.exportProperty(box2d.b2AreaJoint.prototype,"m_dampingRatio",box2d.b2AreaJoint.prototype.m_dampingRatio);
box2d.b2AreaJoint.prototype.m_impulse=0;goog.exportProperty(box2d.b2AreaJoint.prototype,"m_impulse",box2d.b2AreaJoint.prototype.m_impulse);box2d.b2AreaJoint.prototype.m_targetLengths=null;box2d.b2AreaJoint.prototype.m_targetArea=0;box2d.b2AreaJoint.prototype.m_normals=null;box2d.b2AreaJoint.prototype.m_joints=null;box2d.b2AreaJoint.prototype.m_deltas=null;box2d.b2AreaJoint.prototype.m_delta=null;box2d.b2AreaJoint.prototype.GetAnchorA=function(a){return a.SetZero()};
goog.exportProperty(box2d.b2AreaJoint.prototype,"GetAnchorA",box2d.b2AreaJoint.prototype.GetAnchorA);box2d.b2AreaJoint.prototype.GetAnchorB=function(a){return a.SetZero()};goog.exportProperty(box2d.b2AreaJoint.prototype,"GetAnchorB",box2d.b2AreaJoint.prototype.GetAnchorB);box2d.b2AreaJoint.prototype.GetReactionForce=function(a,b){return b.SetZero()};goog.exportProperty(box2d.b2AreaJoint.prototype,"GetReactionForce",box2d.b2AreaJoint.prototype.GetReactionForce);
box2d.b2AreaJoint.prototype.GetReactionTorque=function(a){return 0};goog.exportProperty(box2d.b2AreaJoint.prototype,"GetReactionTorque",box2d.b2AreaJoint.prototype.GetReactionTorque);box2d.b2AreaJoint.prototype.SetFrequency=function(a){this.m_frequencyHz=a;for(var b=0,d=this.m_joints.length;b<d;++b)this.m_joints[b].SetFrequency(a)};goog.exportProperty(box2d.b2AreaJoint.prototype,"SetFrequency",box2d.b2AreaJoint.prototype.SetFrequency);box2d.b2AreaJoint.prototype.GetFrequency=function(){return this.m_frequencyHz};
goog.exportProperty(box2d.b2AreaJoint.prototype,"GetFrequency",box2d.b2AreaJoint.prototype.GetFrequency);box2d.b2AreaJoint.prototype.SetDampingRatio=function(a){this.m_dampingRatio=a;for(var b=0,d=this.m_joints.length;b<d;++b)this.m_joints[b].SetDampingRatio(a)};goog.exportProperty(box2d.b2AreaJoint.prototype,"SetDampingRatio",box2d.b2AreaJoint.prototype.SetDampingRatio);box2d.b2AreaJoint.prototype.GetDampingRatio=function(){return this.m_dampingRatio};
goog.exportProperty(box2d.b2AreaJoint.prototype,"GetDampingRatio",box2d.b2AreaJoint.prototype.GetDampingRatio);box2d.b2AreaJoint.prototype.Dump=function(){box2d.DEBUG&&box2d.b2Log("Area joint dumping is not supported.\n")};goog.exportProperty(box2d.b2AreaJoint.prototype,"Dump",box2d.b2AreaJoint.prototype.Dump);
box2d.b2AreaJoint.prototype.InitVelocityConstraints=function(a){for(var b=0,d=this.m_bodies.length;b<d;++b){var e=this.m_deltas[b];box2d.b2Sub_V2_V2(a.positions[this.m_bodies[(b+1)%d].m_islandIndex].c,a.positions[this.m_bodies[(b+d-1)%d].m_islandIndex].c,e)}if(a.step.warmStarting)for(this.m_impulse*=a.step.dtRatio,b=0,d=this.m_bodies.length;b<d;++b){var f=this.m_bodies[b],g=a.velocities[f.m_islandIndex].v,e=this.m_deltas[b];g.x+=f.m_invMass*e.y*.5*this.m_impulse;g.y+=f.m_invMass*-e.x*.5*this.m_impulse}else this.m_impulse=
0};goog.exportProperty(box2d.b2AreaJoint.prototype,"InitVelocityConstraints",box2d.b2AreaJoint.prototype.InitVelocityConstraints);
box2d.b2AreaJoint.prototype.SolveVelocityConstraints=function(a){for(var b=0,d=0,e=0,f=this.m_bodies.length;e<f;++e)var g=this.m_bodies[e],k=a.velocities[g.m_islandIndex].v,m=this.m_deltas[e],b=b+m.LengthSquared()/g.GetMass(),d=d+box2d.b2Cross_V2_V2(k,m);b=-2*d/b;this.m_impulse+=b;e=0;for(f=this.m_bodies.length;e<f;++e)g=this.m_bodies[e],k=a.velocities[g.m_islandIndex].v,m=this.m_deltas[e],k.x+=g.m_invMass*m.y*.5*b,k.y+=g.m_invMass*-m.x*.5*b};
goog.exportProperty(box2d.b2AreaJoint.prototype,"SolveVelocityConstraints",box2d.b2AreaJoint.prototype.SolveVelocityConstraints);
box2d.b2AreaJoint.prototype.SolvePositionConstraints=function(a){for(var b=0,d=0,e=0,f=this.m_bodies.length;e<f;++e){var g=this.m_bodies[e],g=a.positions[g.m_islandIndex].c,k=a.positions[this.m_bodies[(e+1)%f].m_islandIndex].c,m=box2d.b2Sub_V2_V2(k,g,this.m_delta),n=m.Length();n<box2d.b2_epsilon&&(n=1);this.m_normals[e].x=m.y/n;this.m_normals[e].y=-m.x/n;b+=n;d+=box2d.b2Cross_V2_V2(g,k)}b=.5*(this.m_targetArea-.5*d)/b;d=!0;e=0;for(f=this.m_bodies.length;e<f;++e)g=this.m_bodies[e],g=a.positions[g.m_islandIndex].c,
m=box2d.b2Add_V2_V2(this.m_normals[e],this.m_normals[(e+1)%f],this.m_delta),m.SelfMul(b),k=m.LengthSquared(),k>box2d.b2Sq(box2d.b2_maxLinearCorrection)&&m.SelfMul(box2d.b2_maxLinearCorrection/box2d.b2Sqrt(k)),k>box2d.b2Sq(box2d.b2_linearSlop)&&(d=!1),g.x+=m.x,g.y+=m.y;return d};goog.exportProperty(box2d.b2AreaJoint.prototype,"SolvePositionConstraints",box2d.b2AreaJoint.prototype.SolvePositionConstraints);
box2d.b2DistanceJointDef=function(){box2d.b2JointDef.call(this,box2d.b2JointType.e_distanceJoint);this.localAnchorA=new box2d.b2Vec2;this.localAnchorB=new box2d.b2Vec2};goog.inherits(box2d.b2DistanceJointDef,box2d.b2JointDef);goog.exportSymbol("box2d.b2DistanceJointDef",box2d.b2DistanceJointDef);box2d.b2DistanceJointDef.prototype.localAnchorA=null;goog.exportProperty(box2d.b2DistanceJointDef.prototype,"localAnchorA",box2d.b2DistanceJointDef.prototype.localAnchorA);
box2d.b2DistanceJointDef.prototype.localAnchorB=null;goog.exportProperty(box2d.b2DistanceJointDef.prototype,"localAnchorB",box2d.b2DistanceJointDef.prototype.localAnchorB);box2d.b2DistanceJointDef.prototype.length=1;goog.exportProperty(box2d.b2DistanceJointDef.prototype,"length",box2d.b2DistanceJointDef.prototype.length);box2d.b2DistanceJointDef.prototype.frequencyHz=0;goog.exportProperty(box2d.b2DistanceJointDef.prototype,"frequencyHz",box2d.b2DistanceJointDef.prototype.frequencyHz);
box2d.b2DistanceJointDef.prototype.dampingRatio=0;goog.exportProperty(box2d.b2DistanceJointDef.prototype,"dampingRatio",box2d.b2DistanceJointDef.prototype.dampingRatio);box2d.b2DistanceJointDef.prototype.Initialize=function(a,b,d,e){this.bodyA=a;this.bodyB=b;this.bodyA.GetLocalPoint(d,this.localAnchorA);this.bodyB.GetLocalPoint(e,this.localAnchorB);this.length=box2d.b2Distance(d,e);this.dampingRatio=this.frequencyHz=0};goog.exportProperty(box2d.b2DistanceJointDef.prototype,"Initialize",box2d.b2DistanceJointDef.prototype.Initialize);
box2d.b2DistanceJoint=function(a){box2d.b2Joint.call(this,a);this.m_u=new box2d.b2Vec2;this.m_rA=new box2d.b2Vec2;this.m_rB=new box2d.b2Vec2;this.m_localCenterA=new box2d.b2Vec2;this.m_localCenterB=new box2d.b2Vec2;this.m_qA=new box2d.b2Rot;this.m_qB=new box2d.b2Rot;this.m_lalcA=new box2d.b2Vec2;this.m_lalcB=new box2d.b2Vec2;this.m_frequencyHz=a.frequencyHz;this.m_dampingRatio=a.dampingRatio;this.m_localAnchorA=a.localAnchorA.Clone();this.m_localAnchorB=a.localAnchorB.Clone();this.m_length=a.length};
goog.inherits(box2d.b2DistanceJoint,box2d.b2Joint);goog.exportSymbol("box2d.b2DistanceJoint",box2d.b2DistanceJoint);box2d.b2DistanceJoint.prototype.m_frequencyHz=0;goog.exportProperty(box2d.b2DistanceJoint.prototype,"m_frequencyHz",box2d.b2DistanceJoint.prototype.m_frequencyHz);box2d.b2DistanceJoint.prototype.m_dampingRatio=0;goog.exportProperty(box2d.b2DistanceJoint.prototype,"m_dampingRatio",box2d.b2DistanceJoint.prototype.m_dampingRatio);box2d.b2DistanceJoint.prototype.m_bias=0;
goog.exportProperty(box2d.b2DistanceJoint.prototype,"m_bias",box2d.b2DistanceJoint.prototype.m_bias);box2d.b2DistanceJoint.prototype.m_localAnchorA=null;goog.exportProperty(box2d.b2DistanceJoint.prototype,"m_localAnchorA",box2d.b2DistanceJoint.prototype.m_localAnchorA);box2d.b2DistanceJoint.prototype.m_localAnchorB=null;goog.exportProperty(box2d.b2DistanceJoint.prototype,"m_localAnchorB",box2d.b2DistanceJoint.prototype.m_localAnchorB);box2d.b2DistanceJoint.prototype.m_gamma=0;
goog.exportProperty(box2d.b2DistanceJoint.prototype,"m_gamma",box2d.b2DistanceJoint.prototype.m_gamma);box2d.b2DistanceJoint.prototype.m_impulse=0;goog.exportProperty(box2d.b2DistanceJoint.prototype,"m_impulse",box2d.b2DistanceJoint.prototype.m_impulse);box2d.b2DistanceJoint.prototype.m_length=0;goog.exportProperty(box2d.b2DistanceJoint.prototype,"m_length",box2d.b2DistanceJoint.prototype.m_length);box2d.b2DistanceJoint.prototype.m_indexA=0;
goog.exportProperty(box2d.b2DistanceJoint.prototype,"m_indexA",box2d.b2DistanceJoint.prototype.m_indexA);box2d.b2DistanceJoint.prototype.m_indexB=0;goog.exportProperty(box2d.b2DistanceJoint.prototype,"m_indexB",box2d.b2DistanceJoint.prototype.m_indexB);box2d.b2DistanceJoint.prototype.m_u=null;goog.exportProperty(box2d.b2DistanceJoint.prototype,"m_u",box2d.b2DistanceJoint.prototype.m_u);box2d.b2DistanceJoint.prototype.m_rA=null;goog.exportProperty(box2d.b2DistanceJoint.prototype,"m_rA",box2d.b2DistanceJoint.prototype.m_rA);
box2d.b2DistanceJoint.prototype.m_rB=null;goog.exportProperty(box2d.b2DistanceJoint.prototype,"m_rB",box2d.b2DistanceJoint.prototype.m_rB);box2d.b2DistanceJoint.prototype.m_localCenterA=null;goog.exportProperty(box2d.b2DistanceJoint.prototype,"m_localCenterA",box2d.b2DistanceJoint.prototype.m_localCenterA);box2d.b2DistanceJoint.prototype.m_localCenterB=null;goog.exportProperty(box2d.b2DistanceJoint.prototype,"m_localCenterB",box2d.b2DistanceJoint.prototype.m_localCenterB);
box2d.b2DistanceJoint.prototype.m_invMassA=0;goog.exportProperty(box2d.b2DistanceJoint.prototype,"m_invMassA",box2d.b2DistanceJoint.prototype.m_invMassA);box2d.b2DistanceJoint.prototype.m_invMassB=0;goog.exportProperty(box2d.b2DistanceJoint.prototype,"m_invMassB",box2d.b2DistanceJoint.prototype.m_invMassB);box2d.b2DistanceJoint.prototype.m_invIA=0;goog.exportProperty(box2d.b2DistanceJoint.prototype,"m_invIA",box2d.b2DistanceJoint.prototype.m_invIA);box2d.b2DistanceJoint.prototype.m_invIB=0;
goog.exportProperty(box2d.b2DistanceJoint.prototype,"m_invIB",box2d.b2DistanceJoint.prototype.m_invIB);box2d.b2DistanceJoint.prototype.m_mass=0;goog.exportProperty(box2d.b2DistanceJoint.prototype,"m_mass",box2d.b2DistanceJoint.prototype.m_mass);box2d.b2DistanceJoint.prototype.m_qA=null;goog.exportProperty(box2d.b2DistanceJoint.prototype,"m_qA",box2d.b2DistanceJoint.prototype.m_qA);box2d.b2DistanceJoint.prototype.m_qB=null;goog.exportProperty(box2d.b2DistanceJoint.prototype,"m_qB",box2d.b2DistanceJoint.prototype.m_qB);
box2d.b2DistanceJoint.prototype.m_lalcA=null;goog.exportProperty(box2d.b2DistanceJoint.prototype,"m_lalcA",box2d.b2DistanceJoint.prototype.m_lalcA);box2d.b2DistanceJoint.prototype.m_lalcB=null;goog.exportProperty(box2d.b2DistanceJoint.prototype,"m_lalcB",box2d.b2DistanceJoint.prototype.m_lalcB);box2d.b2DistanceJoint.prototype.GetAnchorA=function(a){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,a)};goog.exportProperty(box2d.b2DistanceJoint.prototype,"GetAnchorA",box2d.b2DistanceJoint.prototype.GetAnchorA);
box2d.b2DistanceJoint.prototype.GetAnchorB=function(a){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,a)};goog.exportProperty(box2d.b2DistanceJoint.prototype,"GetAnchorB",box2d.b2DistanceJoint.prototype.GetAnchorB);box2d.b2DistanceJoint.prototype.GetReactionForce=function(a,b){return b.Set(a*this.m_impulse*this.m_u.x,a*this.m_impulse*this.m_u.y)};goog.exportProperty(box2d.b2DistanceJoint.prototype,"GetReactionForce",box2d.b2DistanceJoint.prototype.GetReactionForce);
box2d.b2DistanceJoint.prototype.GetReactionTorque=function(a){return 0};goog.exportProperty(box2d.b2DistanceJoint.prototype,"GetReactionTorque",box2d.b2DistanceJoint.prototype.GetReactionTorque);box2d.b2DistanceJoint.prototype.GetLocalAnchorA=function(a){return a.Copy(this.m_localAnchorA)};goog.exportProperty(box2d.b2DistanceJoint.prototype,"GetLocalAnchorA",box2d.b2DistanceJoint.prototype.GetLocalAnchorA);box2d.b2DistanceJoint.prototype.GetLocalAnchorB=function(a){return a.Copy(this.m_localAnchorB)};
goog.exportProperty(box2d.b2DistanceJoint.prototype,"GetLocalAnchorB",box2d.b2DistanceJoint.prototype.GetLocalAnchorB);box2d.b2DistanceJoint.prototype.SetLength=function(a){this.m_length=a};goog.exportProperty(box2d.b2DistanceJoint.prototype,"SetLength",box2d.b2DistanceJoint.prototype.SetLength);box2d.b2DistanceJoint.prototype.GetLength=function(){return this.m_length};goog.exportProperty(box2d.b2DistanceJoint.prototype,"GetLength",box2d.b2DistanceJoint.prototype.GetLength);
box2d.b2DistanceJoint.prototype.SetFrequency=function(a){this.m_frequencyHz=a};goog.exportProperty(box2d.b2DistanceJoint.prototype,"SetFrequency",box2d.b2DistanceJoint.prototype.SetFrequency);box2d.b2DistanceJoint.prototype.GetFrequency=function(){return this.m_frequencyHz};goog.exportProperty(box2d.b2DistanceJoint.prototype,"GetFrequency",box2d.b2DistanceJoint.prototype.GetFrequency);box2d.b2DistanceJoint.prototype.SetDampingRatio=function(a){this.m_dampingRatio=a};
goog.exportProperty(box2d.b2DistanceJoint.prototype,"SetDampingRatio",box2d.b2DistanceJoint.prototype.SetDampingRatio);box2d.b2DistanceJoint.prototype.GetDampingRatio=function(){return this.m_dampingRatio};goog.exportProperty(box2d.b2DistanceJoint.prototype,"GetDampingRatio",box2d.b2DistanceJoint.prototype.GetDampingRatio);
box2d.b2DistanceJoint.prototype.Dump=function(){if(box2d.DEBUG){var a=this.m_bodyA.m_islandIndex,b=this.m_bodyB.m_islandIndex;box2d.b2Log("  /*box2d.b2DistanceJointDef*/ var jd = new box2d.b2DistanceJointDef();\n");box2d.b2Log("  jd.bodyA = bodies[%d];\n",a);box2d.b2Log("  jd.bodyB = bodies[%d];\n",b);box2d.b2Log("  jd.collideConnected = %s;\n",this.m_collideConnected?"true":"false");box2d.b2Log("  jd.localAnchorA.Set(%.15f, %.15f);\n",this.m_localAnchorA.x,this.m_localAnchorA.y);box2d.b2Log("  jd.localAnchorB.Set(%.15f, %.15f);\n",
this.m_localAnchorB.x,this.m_localAnchorB.y);box2d.b2Log("  jd.length = %.15f;\n",this.m_length);box2d.b2Log("  jd.frequencyHz = %.15f;\n",this.m_frequencyHz);box2d.b2Log("  jd.dampingRatio = %.15f;\n",this.m_dampingRatio);box2d.b2Log("  joints[%d] = this.m_world.CreateJoint(jd);\n",this.m_index)}};goog.exportProperty(box2d.b2DistanceJoint.prototype,"Dump",box2d.b2DistanceJoint.prototype.Dump);
box2d.b2DistanceJoint.prototype.InitVelocityConstraints=function(a){this.m_indexA=this.m_bodyA.m_islandIndex;this.m_indexB=this.m_bodyB.m_islandIndex;this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter);this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter);this.m_invMassA=this.m_bodyA.m_invMass;this.m_invMassB=this.m_bodyB.m_invMass;this.m_invIA=this.m_bodyA.m_invI;this.m_invIB=this.m_bodyB.m_invI;var b=a.positions[this.m_indexA].c,d=a.velocities[this.m_indexA].v,e=a.velocities[this.m_indexA].w,
f=a.positions[this.m_indexB].c,g=a.positions[this.m_indexB].a,k=a.velocities[this.m_indexB].v,m=a.velocities[this.m_indexB].w,n=this.m_qA.SetAngle(a.positions[this.m_indexA].a),g=this.m_qB.SetAngle(g);box2d.b2Sub_V2_V2(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA);box2d.b2Mul_R_V2(n,this.m_lalcA,this.m_rA);box2d.b2Sub_V2_V2(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB);box2d.b2Mul_R_V2(g,this.m_lalcB,this.m_rB);this.m_u.x=f.x+this.m_rB.x-b.x-this.m_rA.x;this.m_u.y=f.y+this.m_rB.y-
b.y-this.m_rA.y;f=this.m_u.Length();f>box2d.b2_linearSlop?this.m_u.SelfMul(1/f):this.m_u.SetZero();b=box2d.b2Cross_V2_V2(this.m_rA,this.m_u);n=box2d.b2Cross_V2_V2(this.m_rB,this.m_u);b=this.m_invMassA+this.m_invIA*b*b+this.m_invMassB+this.m_invIB*n*n;this.m_mass=0!==b?1/b:0;if(0<this.m_frequencyHz){var f=f-this.m_length,n=2*box2d.b2_pi*this.m_frequencyHz,g=this.m_mass*n*n,q=a.step.dt;this.m_gamma=q*(2*this.m_mass*this.m_dampingRatio*n+q*g);this.m_gamma=0!==this.m_gamma?1/this.m_gamma:0;this.m_bias=
f*q*g*this.m_gamma;b+=this.m_gamma;this.m_mass=0!==b?1/b:0}else this.m_bias=this.m_gamma=0;a.step.warmStarting?(this.m_impulse*=a.step.dtRatio,b=box2d.b2Mul_S_V2(this.m_impulse,this.m_u,box2d.b2DistanceJoint.prototype.InitVelocityConstraints.s_P),d.SelfMulSub(this.m_invMassA,b),e-=this.m_invIA*box2d.b2Cross_V2_V2(this.m_rA,b),k.SelfMulAdd(this.m_invMassB,b),m+=this.m_invIB*box2d.b2Cross_V2_V2(this.m_rB,b)):this.m_impulse=0;a.velocities[this.m_indexA].w=e;a.velocities[this.m_indexB].w=m};
goog.exportProperty(box2d.b2DistanceJoint.prototype,"InitVelocityConstraints",box2d.b2DistanceJoint.prototype.InitVelocityConstraints);box2d.b2DistanceJoint.prototype.InitVelocityConstraints.s_P=new box2d.b2Vec2;
box2d.b2DistanceJoint.prototype.SolveVelocityConstraints=function(a){var b=a.velocities[this.m_indexA].v,d=a.velocities[this.m_indexA].w,e=a.velocities[this.m_indexB].v,f=a.velocities[this.m_indexB].w,g=box2d.b2AddCross_V2_S_V2(b,d,this.m_rA,box2d.b2DistanceJoint.prototype.SolveVelocityConstraints.s_vpA),k=box2d.b2AddCross_V2_S_V2(e,f,this.m_rB,box2d.b2DistanceJoint.prototype.SolveVelocityConstraints.s_vpB),g=box2d.b2Dot_V2_V2(this.m_u,box2d.b2Sub_V2_V2(k,g,box2d.b2Vec2.s_t0)),g=-this.m_mass*(g+this.m_bias+
this.m_gamma*this.m_impulse);this.m_impulse+=g;g=box2d.b2Mul_S_V2(g,this.m_u,box2d.b2DistanceJoint.prototype.SolveVelocityConstraints.s_P);b.SelfMulSub(this.m_invMassA,g);d-=this.m_invIA*box2d.b2Cross_V2_V2(this.m_rA,g);e.SelfMulAdd(this.m_invMassB,g);f+=this.m_invIB*box2d.b2Cross_V2_V2(this.m_rB,g);a.velocities[this.m_indexA].w=d;a.velocities[this.m_indexB].w=f};goog.exportProperty(box2d.b2DistanceJoint.prototype,"SolveVelocityConstraints",box2d.b2DistanceJoint.prototype.SolveVelocityConstraints);
box2d.b2DistanceJoint.prototype.SolveVelocityConstraints.s_vpA=new box2d.b2Vec2;box2d.b2DistanceJoint.prototype.SolveVelocityConstraints.s_vpB=new box2d.b2Vec2;box2d.b2DistanceJoint.prototype.SolveVelocityConstraints.s_P=new box2d.b2Vec2;
box2d.b2DistanceJoint.prototype.SolvePositionConstraints=function(a){if(0<this.m_frequencyHz)return!0;var b=a.positions[this.m_indexA].c,d=a.positions[this.m_indexA].a,e=a.positions[this.m_indexB].c,f=a.positions[this.m_indexB].a;this.m_qA.SetAngle(d);this.m_qB.SetAngle(f);var g=box2d.b2Mul_R_V2(this.m_qA,this.m_lalcA,this.m_rA),k=box2d.b2Mul_R_V2(this.m_qB,this.m_lalcB,this.m_rB),m=this.m_u;m.x=e.x+k.x-b.x-g.x;m.y=e.y+k.y-b.y-g.y;var n=this.m_u.Normalize()-this.m_length,n=box2d.b2Clamp(n,-box2d.b2_maxLinearCorrection,
box2d.b2_maxLinearCorrection),m=box2d.b2Mul_S_V2(-this.m_mass*n,m,box2d.b2DistanceJoint.prototype.SolvePositionConstraints.s_P);b.SelfMulSub(this.m_invMassA,m);d-=this.m_invIA*box2d.b2Cross_V2_V2(g,m);e.SelfMulAdd(this.m_invMassB,m);f+=this.m_invIB*box2d.b2Cross_V2_V2(k,m);a.positions[this.m_indexA].a=d;a.positions[this.m_indexB].a=f;return box2d.b2Abs(n)<box2d.b2_linearSlop};goog.exportProperty(box2d.b2DistanceJoint.prototype,"SolvePositionConstraints",box2d.b2DistanceJoint.prototype.SolvePositionConstraints);
box2d.b2DistanceJoint.prototype.SolvePositionConstraints.s_P=new box2d.b2Vec2;box2d.b2FrictionJointDef=function(){box2d.b2JointDef.call(this,box2d.b2JointType.e_frictionJoint);this.localAnchorA=new box2d.b2Vec2;this.localAnchorB=new box2d.b2Vec2};goog.inherits(box2d.b2FrictionJointDef,box2d.b2JointDef);goog.exportSymbol("box2d.b2FrictionJointDef",box2d.b2FrictionJointDef);box2d.b2FrictionJointDef.prototype.localAnchorA=null;goog.exportProperty(box2d.b2FrictionJointDef.prototype,"localAnchorA",box2d.b2FrictionJointDef.prototype.localAnchorA);
box2d.b2FrictionJointDef.prototype.localAnchorB=null;goog.exportProperty(box2d.b2FrictionJointDef.prototype,"localAnchorB",box2d.b2FrictionJointDef.prototype.localAnchorB);box2d.b2FrictionJointDef.prototype.maxForce=0;goog.exportProperty(box2d.b2FrictionJointDef.prototype,"maxForce",box2d.b2FrictionJointDef.prototype.maxForce);box2d.b2FrictionJointDef.prototype.maxTorque=0;goog.exportProperty(box2d.b2FrictionJointDef.prototype,"maxTorque",box2d.b2FrictionJointDef.prototype.maxTorque);
box2d.b2FrictionJointDef.prototype.Initialize=function(a,b,d){this.bodyA=a;this.bodyB=b;this.bodyA.GetLocalPoint(d,this.localAnchorA);this.bodyB.GetLocalPoint(d,this.localAnchorB)};goog.exportProperty(box2d.b2FrictionJointDef.prototype,"Initialize",box2d.b2FrictionJointDef.prototype.Initialize);
box2d.b2FrictionJoint=function(a){box2d.b2Joint.call(this,a);this.m_localAnchorA=a.localAnchorA.Clone();this.m_localAnchorB=a.localAnchorB.Clone();this.m_linearImpulse=(new box2d.b2Vec2).SetZero();this.m_maxForce=a.maxForce;this.m_maxTorque=a.maxTorque;this.m_rA=new box2d.b2Vec2;this.m_rB=new box2d.b2Vec2;this.m_localCenterA=new box2d.b2Vec2;this.m_localCenterB=new box2d.b2Vec2;this.m_linearMass=(new box2d.b2Mat22).SetZero();this.m_qA=new box2d.b2Rot;this.m_qB=new box2d.b2Rot;this.m_lalcA=new box2d.b2Vec2;
this.m_lalcB=new box2d.b2Vec2;this.m_K=new box2d.b2Mat22};goog.inherits(box2d.b2FrictionJoint,box2d.b2Joint);goog.exportSymbol("box2d.b2FrictionJoint",box2d.b2FrictionJoint);box2d.b2FrictionJoint.prototype.m_localAnchorA=null;goog.exportProperty(box2d.b2FrictionJoint.prototype,"m_localAnchorA",box2d.b2FrictionJoint.prototype.m_localAnchorA);box2d.b2FrictionJoint.prototype.m_localAnchorB=null;goog.exportProperty(box2d.b2FrictionJoint.prototype,"m_localAnchorB",box2d.b2FrictionJoint.prototype.m_localAnchorB);
box2d.b2FrictionJoint.prototype.m_linearImpulse=null;goog.exportProperty(box2d.b2FrictionJoint.prototype,"m_linearImpulse",box2d.b2FrictionJoint.prototype.m_linearImpulse);box2d.b2FrictionJoint.prototype.m_angularImpulse=0;goog.exportProperty(box2d.b2FrictionJoint.prototype,"m_angularImpulse",box2d.b2FrictionJoint.prototype.m_angularImpulse);box2d.b2FrictionJoint.prototype.m_maxForce=0;goog.exportProperty(box2d.b2FrictionJoint.prototype,"m_maxForce",box2d.b2FrictionJoint.prototype.m_maxForce);
box2d.b2FrictionJoint.prototype.m_maxTorque=0;goog.exportProperty(box2d.b2FrictionJoint.prototype,"m_maxTorque",box2d.b2FrictionJoint.prototype.m_maxTorque);box2d.b2FrictionJoint.prototype.m_indexA=0;goog.exportProperty(box2d.b2FrictionJoint.prototype,"m_indexA",box2d.b2FrictionJoint.prototype.m_indexA);box2d.b2FrictionJoint.prototype.m_indexB=0;goog.exportProperty(box2d.b2FrictionJoint.prototype,"m_indexB",box2d.b2FrictionJoint.prototype.m_indexB);box2d.b2FrictionJoint.prototype.m_rA=null;
goog.exportProperty(box2d.b2FrictionJoint.prototype,"m_rA",box2d.b2FrictionJoint.prototype.m_rA);box2d.b2FrictionJoint.prototype.m_rB=null;goog.exportProperty(box2d.b2FrictionJoint.prototype,"m_rB",box2d.b2FrictionJoint.prototype.m_rB);box2d.b2FrictionJoint.prototype.m_localCenterA=null;goog.exportProperty(box2d.b2FrictionJoint.prototype,"m_localCenterA",box2d.b2FrictionJoint.prototype.m_localCenterA);box2d.b2FrictionJoint.prototype.m_localCenterB=null;
goog.exportProperty(box2d.b2FrictionJoint.prototype,"m_localCenterB",box2d.b2FrictionJoint.prototype.m_localCenterB);box2d.b2FrictionJoint.prototype.m_invMassA=0;goog.exportProperty(box2d.b2FrictionJoint.prototype,"m_invMassA",box2d.b2FrictionJoint.prototype.m_invMassA);box2d.b2FrictionJoint.prototype.m_invMassB=0;goog.exportProperty(box2d.b2FrictionJoint.prototype,"m_invMassB",box2d.b2FrictionJoint.prototype.m_invMassB);box2d.b2FrictionJoint.prototype.m_invIA=0;
goog.exportProperty(box2d.b2FrictionJoint.prototype,"m_invIA",box2d.b2FrictionJoint.prototype.m_invIA);box2d.b2FrictionJoint.prototype.m_invIB=0;goog.exportProperty(box2d.b2FrictionJoint.prototype,"m_invIB",box2d.b2FrictionJoint.prototype.m_invIB);box2d.b2FrictionJoint.prototype.m_linearMass=null;goog.exportProperty(box2d.b2FrictionJoint.prototype,"m_linearMass",box2d.b2FrictionJoint.prototype.m_linearMass);box2d.b2FrictionJoint.prototype.m_angularMass=0;
goog.exportProperty(box2d.b2FrictionJoint.prototype,"m_angularMass",box2d.b2FrictionJoint.prototype.m_angularMass);box2d.b2FrictionJoint.prototype.m_qA=null;goog.exportProperty(box2d.b2FrictionJoint.prototype,"m_qA",box2d.b2FrictionJoint.prototype.m_qA);box2d.b2FrictionJoint.prototype.m_qB=null;goog.exportProperty(box2d.b2FrictionJoint.prototype,"m_qB",box2d.b2FrictionJoint.prototype.m_qB);box2d.b2FrictionJoint.prototype.m_lalcA=null;goog.exportProperty(box2d.b2FrictionJoint.prototype,"m_lalcA",box2d.b2FrictionJoint.prototype.m_lalcA);
box2d.b2FrictionJoint.prototype.m_lalcB=null;goog.exportProperty(box2d.b2FrictionJoint.prototype,"m_lalcB",box2d.b2FrictionJoint.prototype.m_lalcB);box2d.b2FrictionJoint.prototype.m_K=null;goog.exportProperty(box2d.b2FrictionJoint.prototype,"m_K",box2d.b2FrictionJoint.prototype.m_K);
box2d.b2FrictionJoint.prototype.InitVelocityConstraints=function(a){this.m_indexA=this.m_bodyA.m_islandIndex;this.m_indexB=this.m_bodyB.m_islandIndex;this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter);this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter);this.m_invMassA=this.m_bodyA.m_invMass;this.m_invMassB=this.m_bodyB.m_invMass;this.m_invIA=this.m_bodyA.m_invI;this.m_invIB=this.m_bodyB.m_invI;var b=a.velocities[this.m_indexA].v,d=a.velocities[this.m_indexA].w,e=a.positions[this.m_indexB].a,
f=a.velocities[this.m_indexB].v,g=a.velocities[this.m_indexB].w,k=this.m_qA.SetAngle(a.positions[this.m_indexA].a),e=this.m_qB.SetAngle(e);box2d.b2Sub_V2_V2(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA);k=box2d.b2Mul_R_V2(k,this.m_lalcA,this.m_rA);box2d.b2Sub_V2_V2(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB);var m=box2d.b2Mul_R_V2(e,this.m_lalcB,this.m_rB),e=this.m_invMassA,n=this.m_invMassB,q=this.m_invIA,s=this.m_invIB,t=this.m_K;t.ex.x=e+n+q*k.y*k.y+s*m.y*m.y;t.ex.y=-q*k.x*k.y-
s*m.x*m.y;t.ey.x=t.ex.y;t.ey.y=e+n+q*k.x*k.x+s*m.x*m.x;t.GetInverse(this.m_linearMass);this.m_angularMass=q+s;0<this.m_angularMass&&(this.m_angularMass=1/this.m_angularMass);a.step.warmStarting?(this.m_linearImpulse.SelfMul(a.step.dtRatio),this.m_angularImpulse*=a.step.dtRatio,k=this.m_linearImpulse,b.SelfMulSub(e,k),d-=q*(box2d.b2Cross_V2_V2(this.m_rA,k)+this.m_angularImpulse),f.SelfMulAdd(n,k),g+=s*(box2d.b2Cross_V2_V2(this.m_rB,k)+this.m_angularImpulse)):(this.m_linearImpulse.SetZero(),this.m_angularImpulse=
0);a.velocities[this.m_indexA].w=d;a.velocities[this.m_indexB].w=g};goog.exportProperty(box2d.b2FrictionJoint.prototype,"InitVelocityConstraints",box2d.b2FrictionJoint.prototype.InitVelocityConstraints);
box2d.b2FrictionJoint.prototype.SolveVelocityConstraints=function(a){var b=a.velocities[this.m_indexA].v,d=a.velocities[this.m_indexA].w,e=a.velocities[this.m_indexB].v,f=a.velocities[this.m_indexB].w,g=this.m_invMassA,k=this.m_invMassB,m=this.m_invIA,n=this.m_invIB,q=a.step.dt,s,t=-this.m_angularMass*(f-d),u=this.m_angularImpulse;s=q*this.m_maxTorque;this.m_angularImpulse=box2d.b2Clamp(this.m_angularImpulse+t,-s,s);t=this.m_angularImpulse-u;d-=m*t;f+=n*t;s=box2d.b2Sub_V2_V2(box2d.b2AddCross_V2_S_V2(e,
f,this.m_rB,box2d.b2Vec2.s_t0),box2d.b2AddCross_V2_S_V2(b,d,this.m_rA,box2d.b2Vec2.s_t1),box2d.b2FrictionJoint.prototype.SolveVelocityConstraints.s_Cdot);t=box2d.b2Mul_M22_V2(this.m_linearMass,s,box2d.b2FrictionJoint.prototype.SolveVelocityConstraints.s_impulseV).SelfNeg();u=box2d.b2FrictionJoint.prototype.SolveVelocityConstraints.s_oldImpulseV.Copy(this.m_linearImpulse);this.m_linearImpulse.SelfAdd(t);s=q*this.m_maxForce;this.m_linearImpulse.LengthSquared()>s*s&&(this.m_linearImpulse.Normalize(),
this.m_linearImpulse.SelfMul(s));box2d.b2Sub_V2_V2(this.m_linearImpulse,u,t);b.SelfMulSub(g,t);d-=m*box2d.b2Cross_V2_V2(this.m_rA,t);e.SelfMulAdd(k,t);f+=n*box2d.b2Cross_V2_V2(this.m_rB,t);a.velocities[this.m_indexA].w=d;a.velocities[this.m_indexB].w=f};goog.exportProperty(box2d.b2FrictionJoint.prototype,"SolveVelocityConstraints",box2d.b2FrictionJoint.prototype.SolveVelocityConstraints);box2d.b2FrictionJoint.prototype.SolveVelocityConstraints.s_Cdot=new box2d.b2Vec2;
box2d.b2FrictionJoint.prototype.SolveVelocityConstraints.s_impulseV=new box2d.b2Vec2;box2d.b2FrictionJoint.prototype.SolveVelocityConstraints.s_oldImpulseV=new box2d.b2Vec2;box2d.b2FrictionJoint.prototype.SolvePositionConstraints=function(a){return!0};goog.exportProperty(box2d.b2FrictionJoint.prototype,"SolvePositionConstraints",box2d.b2FrictionJoint.prototype.SolvePositionConstraints);box2d.b2FrictionJoint.prototype.GetAnchorA=function(a){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,a)};
goog.exportProperty(box2d.b2FrictionJoint.prototype,"GetAnchorA",box2d.b2FrictionJoint.prototype.GetAnchorA);box2d.b2FrictionJoint.prototype.GetAnchorB=function(a){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,a)};goog.exportProperty(box2d.b2FrictionJoint.prototype,"GetAnchorB",box2d.b2FrictionJoint.prototype.GetAnchorB);box2d.b2FrictionJoint.prototype.GetReactionForce=function(a,b){return b.Set(a*this.m_linearImpulse.x,a*this.m_linearImpulse.y)};
goog.exportProperty(box2d.b2FrictionJoint.prototype,"GetReactionForce",box2d.b2FrictionJoint.prototype.GetReactionForce);box2d.b2FrictionJoint.prototype.GetReactionTorque=function(a){return a*this.m_angularImpulse};goog.exportProperty(box2d.b2FrictionJoint.prototype,"GetReactionTorque",box2d.b2FrictionJoint.prototype.GetReactionTorque);box2d.b2FrictionJoint.prototype.GetLocalAnchorA=function(a){return a.Copy(this.m_localAnchorA)};
goog.exportProperty(box2d.b2FrictionJoint.prototype,"GetLocalAnchorA",box2d.b2FrictionJoint.prototype.GetLocalAnchorA);box2d.b2FrictionJoint.prototype.GetLocalAnchorB=function(a){return a.Copy(this.m_localAnchorB)};goog.exportProperty(box2d.b2FrictionJoint.prototype,"GetLocalAnchorB",box2d.b2FrictionJoint.prototype.GetLocalAnchorB);box2d.b2FrictionJoint.prototype.SetMaxForce=function(a){this.m_maxForce=a};goog.exportProperty(box2d.b2FrictionJoint.prototype,"SetMaxForce",box2d.b2FrictionJoint.prototype.SetMaxForce);
box2d.b2FrictionJoint.prototype.GetMaxForce=function(){return this.m_maxForce};goog.exportProperty(box2d.b2FrictionJoint.prototype,"GetMaxForce",box2d.b2FrictionJoint.prototype.GetMaxForce);box2d.b2FrictionJoint.prototype.SetMaxTorque=function(a){this.m_maxTorque=a};goog.exportProperty(box2d.b2FrictionJoint.prototype,"SetMaxTorque",box2d.b2FrictionJoint.prototype.SetMaxTorque);box2d.b2FrictionJoint.prototype.GetMaxTorque=function(){return this.m_maxTorque};
goog.exportProperty(box2d.b2FrictionJoint.prototype,"GetMaxTorque",box2d.b2FrictionJoint.prototype.GetMaxTorque);
box2d.b2FrictionJoint.prototype.Dump=function(){if(box2d.DEBUG){var a=this.m_bodyA.m_islandIndex,b=this.m_bodyB.m_islandIndex;box2d.b2Log("  /*box2d.b2FrictionJointDef*/ var jd = new box2d.b2FrictionJointDef();\n");box2d.b2Log("  jd.bodyA = bodies[%d];\n",a);box2d.b2Log("  jd.bodyB = bodies[%d];\n",b);box2d.b2Log("  jd.collideConnected = %s;\n",this.m_collideConnected?"true":"false");box2d.b2Log("  jd.localAnchorA.Set(%.15f, %.15f);\n",this.m_localAnchorA.x,this.m_localAnchorA.y);box2d.b2Log("  jd.localAnchorB.Set(%.15f, %.15f);\n",
this.m_localAnchorB.x,this.m_localAnchorB.y);box2d.b2Log("  jd.maxForce = %.15f;\n",this.m_maxForce);box2d.b2Log("  jd.maxTorque = %.15f;\n",this.m_maxTorque);box2d.b2Log("  joints[%d] = this.m_world.CreateJoint(jd);\n",this.m_index)}};goog.exportProperty(box2d.b2FrictionJoint.prototype,"Dump",box2d.b2FrictionJoint.prototype.Dump);box2d.b2JointFactory={};
box2d.b2JointFactory.Create=function(a,b){var d=null;switch(a.type){case box2d.b2JointType.e_distanceJoint:d=new box2d.b2DistanceJoint(a instanceof box2d.b2DistanceJointDef?a:null);break;case box2d.b2JointType.e_mouseJoint:d=new box2d.b2MouseJoint(a instanceof box2d.b2MouseJointDef?a:null);break;case box2d.b2JointType.e_prismaticJoint:d=new box2d.b2PrismaticJoint(a instanceof box2d.b2PrismaticJointDef?a:null);break;case box2d.b2JointType.e_revoluteJoint:d=new box2d.b2RevoluteJoint(a instanceof box2d.b2RevoluteJointDef?
a:null);break;case box2d.b2JointType.e_pulleyJoint:d=new box2d.b2PulleyJoint(a instanceof box2d.b2PulleyJointDef?a:null);break;case box2d.b2JointType.e_gearJoint:d=new box2d.b2GearJoint(a instanceof box2d.b2GearJointDef?a:null);break;case box2d.b2JointType.e_wheelJoint:d=new box2d.b2WheelJoint(a instanceof box2d.b2WheelJointDef?a:null);break;case box2d.b2JointType.e_weldJoint:d=new box2d.b2WeldJoint(a instanceof box2d.b2WeldJointDef?a:null);break;case box2d.b2JointType.e_frictionJoint:d=new box2d.b2FrictionJoint(a instanceof
box2d.b2FrictionJointDef?a:null);break;case box2d.b2JointType.e_ropeJoint:d=new box2d.b2RopeJoint(a instanceof box2d.b2RopeJointDef?a:null);break;case box2d.b2JointType.e_motorJoint:d=new box2d.b2MotorJoint(a instanceof box2d.b2MotorJointDef?a:null);break;case box2d.b2JointType.e_areaJoint:d=new box2d.b2AreaJoint(a instanceof box2d.b2AreaJointDef?a:null);break;default:box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1)}return d};goog.exportSymbol("box2d.b2JointFactory.Create",box2d.b2JointFactory.Create);
box2d.b2JointFactory.Destroy=function(a,b){};goog.exportSymbol("box2d.b2JointFactory.Destroy",box2d.b2JointFactory.Destroy);
box2d.b2World=function(a){this.m_flag_clearForces=!0;this.m_contactManager=new box2d.b2ContactManager;this.m_gravity=a.Clone();this.m_out_gravity=new box2d.b2Vec2;this.m_allowSleep=!0;this.m_debugDraw=this.m_destructionListener=null;this.m_continuousPhysics=this.m_warmStarting=!0;this.m_subStepping=!1;this.m_stepComplete=!0;this.m_profile=new box2d.b2Profile;this.m_island=new box2d.b2Island;this.s_stack=[]};goog.exportSymbol("box2d.b2World",box2d.b2World);
box2d.b2World.prototype.m_flag_newFixture=!1;goog.exportProperty(box2d.b2World.prototype,"m_flag_newFixture",box2d.b2World.prototype.m_flag_newFixture);box2d.b2World.prototype.m_flag_locked=!1;goog.exportProperty(box2d.b2World.prototype,"m_flag_locked",box2d.b2World.prototype.m_flag_locked);box2d.b2World.prototype.m_flag_clearForces=!1;goog.exportProperty(box2d.b2World.prototype,"m_flag_clearForces",box2d.b2World.prototype.m_flag_clearForces);box2d.b2World.prototype.m_contactManager=null;
goog.exportProperty(box2d.b2World.prototype,"m_contactManager",box2d.b2World.prototype.m_contactManager);box2d.b2World.prototype.m_bodyList=null;goog.exportProperty(box2d.b2World.prototype,"m_bodyList",box2d.b2World.prototype.m_bodyList);box2d.b2World.prototype.m_jointList=null;goog.exportProperty(box2d.b2World.prototype,"m_jointList",box2d.b2World.prototype.m_jointList);box2d.b2World.prototype.m_particleSystemList=null;goog.exportProperty(box2d.b2World.prototype,"m_particleSystemList",box2d.b2World.prototype.m_particleSystemList);
box2d.b2World.prototype.m_bodyCount=0;goog.exportProperty(box2d.b2World.prototype,"m_bodyCount",box2d.b2World.prototype.m_bodyCount);box2d.b2World.prototype.m_jointCount=0;goog.exportProperty(box2d.b2World.prototype,"m_jointCount",box2d.b2World.prototype.m_jointCount);box2d.b2World.prototype.m_gravity=null;goog.exportProperty(box2d.b2World.prototype,"m_gravity",box2d.b2World.prototype.m_gravity);box2d.b2World.prototype.m_out_gravity=null;
goog.exportProperty(box2d.b2World.prototype,"m_out_gravity",box2d.b2World.prototype.m_out_gravity);box2d.b2World.prototype.m_allowSleep=!0;goog.exportProperty(box2d.b2World.prototype,"m_allowSleep",box2d.b2World.prototype.m_allowSleep);box2d.b2World.prototype.m_destructionListener=null;goog.exportProperty(box2d.b2World.prototype,"m_destructionListener",box2d.b2World.prototype.m_destructionListener);box2d.b2World.prototype.m_debugDraw=null;
goog.exportProperty(box2d.b2World.prototype,"m_debugDraw",box2d.b2World.prototype.m_debugDraw);box2d.b2World.prototype.m_inv_dt0=0;goog.exportProperty(box2d.b2World.prototype,"m_inv_dt0",box2d.b2World.prototype.m_inv_dt0);box2d.b2World.prototype.m_warmStarting=!0;goog.exportProperty(box2d.b2World.prototype,"m_warmStarting",box2d.b2World.prototype.m_warmStarting);box2d.b2World.prototype.m_continuousPhysics=!0;goog.exportProperty(box2d.b2World.prototype,"m_continuousPhysics",box2d.b2World.prototype.m_continuousPhysics);
box2d.b2World.prototype.m_subStepping=!1;goog.exportProperty(box2d.b2World.prototype,"m_subStepping",box2d.b2World.prototype.m_subStepping);box2d.b2World.prototype.m_stepComplete=!0;goog.exportProperty(box2d.b2World.prototype,"m_stepComplete",box2d.b2World.prototype.m_stepComplete);box2d.b2World.prototype.m_profile=null;goog.exportProperty(box2d.b2World.prototype,"m_profile",box2d.b2World.prototype.m_profile);box2d.b2World.prototype.m_island=null;
goog.exportProperty(box2d.b2World.prototype,"m_island",box2d.b2World.prototype.m_island);box2d.b2World.prototype.s_stack=null;goog.exportProperty(box2d.b2World.prototype,"s_stack",box2d.b2World.prototype.s_stack);box2d.b2World.prototype.m_controllerList=null;goog.exportProperty(box2d.b2World.prototype,"m_controllerList",box2d.b2World.prototype.m_controllerList);box2d.b2World.prototype.m_controllerCount=0;goog.exportProperty(box2d.b2World.prototype,"m_controllerCount",box2d.b2World.prototype.m_controllerCount);
box2d.b2World.prototype.SetAllowSleeping=function(a){if(a!==this.m_allowSleep&&(this.m_allowSleep=a,!this.m_allowSleep))for(a=this.m_bodyList;a;a=a.m_next)a.SetAwake(!0)};goog.exportProperty(box2d.b2World.prototype,"SetAllowSleeping",box2d.b2World.prototype.SetAllowSleeping);box2d.b2World.prototype.GetAllowSleeping=function(){return this.m_allowSleep};goog.exportProperty(box2d.b2World.prototype,"GetAllowSleeping",box2d.b2World.prototype.GetAllowSleeping);
box2d.b2World.prototype.SetWarmStarting=function(a){this.m_warmStarting=a};goog.exportProperty(box2d.b2World.prototype,"SetWarmStarting",box2d.b2World.prototype.SetWarmStarting);box2d.b2World.prototype.GetWarmStarting=function(){return this.m_warmStarting};goog.exportProperty(box2d.b2World.prototype,"GetWarmStarting",box2d.b2World.prototype.GetWarmStarting);box2d.b2World.prototype.SetContinuousPhysics=function(a){this.m_continuousPhysics=a};
goog.exportProperty(box2d.b2World.prototype,"SetContinuousPhysics",box2d.b2World.prototype.SetContinuousPhysics);box2d.b2World.prototype.GetContinuousPhysics=function(){return this.m_continuousPhysics};goog.exportProperty(box2d.b2World.prototype,"GetContinuousPhysics",box2d.b2World.prototype.GetContinuousPhysics);box2d.b2World.prototype.SetSubStepping=function(a){this.m_subStepping=a};goog.exportProperty(box2d.b2World.prototype,"SetSubStepping",box2d.b2World.prototype.SetSubStepping);
box2d.b2World.prototype.GetSubStepping=function(){return this.m_subStepping};goog.exportProperty(box2d.b2World.prototype,"GetSubStepping",box2d.b2World.prototype.GetSubStepping);box2d.b2World.prototype.GetBodyList=function(){return this.m_bodyList};goog.exportProperty(box2d.b2World.prototype,"GetBodyList",box2d.b2World.prototype.GetBodyList);box2d.b2World.prototype.GetJointList=function(){return this.m_jointList};goog.exportProperty(box2d.b2World.prototype,"GetJointList",box2d.b2World.prototype.GetJointList);
box2d.b2World.prototype.GetParticleSystemList=function(){return this.m_particleSystemList};goog.exportProperty(box2d.b2World.prototype,"GetParticleSystemList",box2d.b2World.prototype.GetParticleSystemList);box2d.b2World.prototype.GetContactList=function(){return this.m_contactManager.m_contactList};goog.exportProperty(box2d.b2World.prototype,"GetContactList",box2d.b2World.prototype.GetContactList);box2d.b2World.prototype.GetBodyCount=function(){return this.m_bodyCount};
goog.exportProperty(box2d.b2World.prototype,"GetBodyCount",box2d.b2World.prototype.GetBodyCount);box2d.b2World.prototype.GetJointCount=function(){return this.m_jointCount};goog.exportProperty(box2d.b2World.prototype,"GetJointCount",box2d.b2World.prototype.GetJointCount);box2d.b2World.prototype.GetContactCount=function(){return this.m_contactManager.m_contactCount};goog.exportProperty(box2d.b2World.prototype,"GetContactCount",box2d.b2World.prototype.GetContactCount);
box2d.b2World.prototype.SetGravity=function(a,b){b=b||!0;if(this.m_gravity.x!==a.x||this.m_gravity.y!==a.y)if(this.m_gravity.Copy(a),b)for(var d=this.m_bodyList;d;d=d.m_next)d.SetAwake(!0)};goog.exportProperty(box2d.b2World.prototype,"SetGravity",box2d.b2World.prototype.SetGravity);box2d.b2World.prototype.GetGravity=function(a){a=a||this.m_out_gravity;return a.Copy(this.m_gravity)};goog.exportProperty(box2d.b2World.prototype,"GetGravity",box2d.b2World.prototype.GetGravity);
box2d.b2World.prototype.IsLocked=function(){return this.m_flag_locked};goog.exportProperty(box2d.b2World.prototype,"IsLocked",box2d.b2World.prototype.IsLocked);box2d.b2World.prototype.SetAutoClearForces=function(a){this.m_flag_clearForces=a};goog.exportProperty(box2d.b2World.prototype,"SetAutoClearForces",box2d.b2World.prototype.SetAutoClearForces);box2d.b2World.prototype.GetAutoClearForces=function(){return this.m_flag_clearForces};
goog.exportProperty(box2d.b2World.prototype,"GetAutoClearForces",box2d.b2World.prototype.GetAutoClearForces);box2d.b2World.prototype.GetContactManager=function(){return this.m_contactManager};goog.exportProperty(box2d.b2World.prototype,"GetContactManager",box2d.b2World.prototype.GetContactManager);box2d.b2World.prototype.GetProfile=function(){return this.m_profile};goog.exportProperty(box2d.b2World.prototype,"GetProfile",box2d.b2World.prototype.GetProfile);
box2d.b2World.prototype.SetDestructionListener=function(a){this.m_destructionListener=a};goog.exportProperty(box2d.b2World.prototype,"SetDestructionListener",box2d.b2World.prototype.SetDestructionListener);box2d.b2World.prototype.SetContactFilter=function(a){this.m_contactManager.m_contactFilter=a};goog.exportProperty(box2d.b2World.prototype,"SetContactFilter",box2d.b2World.prototype.SetContactFilter);box2d.b2World.prototype.SetContactListener=function(a){this.m_contactManager.m_contactListener=a};
goog.exportProperty(box2d.b2World.prototype,"SetContactListener",box2d.b2World.prototype.SetContactListener);box2d.b2World.prototype.SetDebugDraw=function(a){this.m_debugDraw=a};goog.exportProperty(box2d.b2World.prototype,"SetDebugDraw",box2d.b2World.prototype.SetDebugDraw);
box2d.b2World.prototype.CreateBody=function(a){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!this.IsLocked());if(this.IsLocked())return null;a=new box2d.b2Body(a,this);a.m_prev=null;if(a.m_next=this.m_bodyList)this.m_bodyList.m_prev=a;this.m_bodyList=a;++this.m_bodyCount;return a};goog.exportProperty(box2d.b2World.prototype,"CreateBody",box2d.b2World.prototype.CreateBody);
box2d.b2World.prototype.DestroyBody=function(a){box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<this.m_bodyCount);box2d.ENABLE_ASSERTS&&box2d.b2Assert(!this.IsLocked());if(!this.IsLocked()){for(var b=a.m_jointList;b;){var d=b,b=b.next;this.m_destructionListener&&this.m_destructionListener.SayGoodbyeJoint(d.joint);this.DestroyJoint(d.joint);a.m_jointList=b}a.m_jointList=null;for(b=a.m_controllerList;b;)d=b,b=b.nextController,d.controller.RemoveBody(a);for(b=a.m_contactList;b;)d=b,b=b.next,this.m_contactManager.Destroy(d.contact);
a.m_contactList=null;for(b=a.m_fixtureList;b;)d=b,b=b.m_next,this.m_destructionListener&&this.m_destructionListener.SayGoodbyeFixture(d),d.DestroyProxies(this.m_contactManager.m_broadPhase),d.Destroy(),a.m_fixtureList=b,--a.m_fixtureCount;a.m_fixtureList=null;a.m_fixtureCount=0;a.m_prev&&(a.m_prev.m_next=a.m_next);a.m_next&&(a.m_next.m_prev=a.m_prev);a===this.m_bodyList&&(this.m_bodyList=a.m_next);--this.m_bodyCount}};goog.exportProperty(box2d.b2World.prototype,"DestroyBody",box2d.b2World.prototype.DestroyBody);
box2d.b2World.prototype.CreateJoint=function(a){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!this.IsLocked());if(this.IsLocked())return null;var b=box2d.b2JointFactory.Create(a,null);b.m_prev=null;if(b.m_next=this.m_jointList)this.m_jointList.m_prev=b;this.m_jointList=b;++this.m_jointCount;b.m_edgeA.joint=b;b.m_edgeA.other=b.m_bodyB;b.m_edgeA.prev=null;if(b.m_edgeA.next=b.m_bodyA.m_jointList)b.m_bodyA.m_jointList.prev=b.m_edgeA;b.m_bodyA.m_jointList=b.m_edgeA;b.m_edgeB.joint=b;b.m_edgeB.other=b.m_bodyA;
b.m_edgeB.prev=null;if(b.m_edgeB.next=b.m_bodyB.m_jointList)b.m_bodyB.m_jointList.prev=b.m_edgeB;b.m_bodyB.m_jointList=b.m_edgeB;var d=a.bodyA,e=a.bodyB;if(!a.collideConnected)for(a=e.GetContactList();a;)a.other===d&&a.contact.FlagForFiltering(),a=a.next;return b};goog.exportProperty(box2d.b2World.prototype,"CreateJoint",box2d.b2World.prototype.CreateJoint);
box2d.b2World.prototype.DestroyJoint=function(a){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!this.IsLocked());if(!this.IsLocked()){var b=a.m_collideConnected;a.m_prev&&(a.m_prev.m_next=a.m_next);a.m_next&&(a.m_next.m_prev=a.m_prev);a===this.m_jointList&&(this.m_jointList=a.m_next);var d=a.m_bodyA,e=a.m_bodyB;d.SetAwake(!0);e.SetAwake(!0);a.m_edgeA.prev&&(a.m_edgeA.prev.next=a.m_edgeA.next);a.m_edgeA.next&&(a.m_edgeA.next.prev=a.m_edgeA.prev);a.m_edgeA===d.m_jointList&&(d.m_jointList=a.m_edgeA.next);a.m_edgeA.prev=
null;a.m_edgeA.next=null;a.m_edgeB.prev&&(a.m_edgeB.prev.next=a.m_edgeB.next);a.m_edgeB.next&&(a.m_edgeB.next.prev=a.m_edgeB.prev);a.m_edgeB===e.m_jointList&&(e.m_jointList=a.m_edgeB.next);a.m_edgeB.prev=null;a.m_edgeB.next=null;box2d.b2JointFactory.Destroy(a,null);box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<this.m_jointCount);--this.m_jointCount;if(!b)for(a=e.GetContactList();a;)a.other===d&&a.contact.FlagForFiltering(),a=a.next}};goog.exportProperty(box2d.b2World.prototype,"DestroyJoint",box2d.b2World.prototype.DestroyJoint);
box2d.b2World.prototype.CreateParticleSystem=function(a){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!this.IsLocked());if(this.IsLocked())return null;a=new box2d.b2ParticleSystem(a,this);a.m_prev=null;if(a.m_next=this.m_particleSystemList)this.m_particleSystemList.m_prev=a;return this.m_particleSystemList=a};goog.exportProperty(box2d.b2World.prototype,"CreateParticleSystem",box2d.b2World.prototype.CreateParticleSystem);
box2d.b2World.prototype.DestroyParticleSystem=function(a){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!this.IsLocked());this.IsLocked()||(a.m_prev&&(a.m_prev.m_next=a.m_next),a.m_next&&(a.m_next.m_prev=a.m_prev),a===this.m_particleSystemList&&(this.m_particleSystemList=a.m_next))};goog.exportProperty(box2d.b2World.prototype,"DestroyParticleSystem",box2d.b2World.prototype.DestroyParticleSystem);
box2d.b2World.prototype.Solve=function(a){for(var b=this.m_bodyList;b;b=b.m_next)b.m_xf0.Copy(b.m_xf);for(var d=this.m_controllerList;d;d=d.m_next)d.Step(a);this.m_profile.solveInit=0;this.m_profile.solveVelocity=0;this.m_profile.solvePosition=0;d=this.m_island;d.Initialize(this.m_bodyCount,this.m_contactManager.m_contactCount,this.m_jointCount,null,this.m_contactManager.m_contactListener);for(b=this.m_bodyList;b;b=b.m_next)b.m_flag_islandFlag=!1;for(var e=this.m_contactManager.m_contactList;e;e=
e.m_next)e.m_flag_islandFlag=!1;for(e=this.m_jointList;e;e=e.m_next)e.m_islandFlag=!1;for(var e=this.m_bodyCount,f=this.s_stack,g=this.m_bodyList;g;g=g.m_next)if(!g.m_flag_islandFlag&&g.IsAwake()&&g.IsActive()&&g.GetType()!==box2d.b2BodyType.b2_staticBody){d.Clear();var k=0;f[k++]=g;for(g.m_flag_islandFlag=!0;0<k;)if(b=f[--k],box2d.ENABLE_ASSERTS&&box2d.b2Assert(b.IsActive()),d.AddBody(b),b.SetAwake(!0),b.GetType()!==box2d.b2BodyType.b2_staticBody){for(var m=b.m_contactList;m;m=m.next){var n=m.contact;
if(!n.m_flag_islandFlag&&n.IsEnabled()&&n.IsTouching()){var q=n.m_fixtureB.m_isSensor;n.m_fixtureA.m_isSensor||q||(d.AddContact(n),n.m_flag_islandFlag=!0,n=m.other,n.m_flag_islandFlag||(box2d.ENABLE_ASSERTS&&box2d.b2Assert(k<e),f[k++]=n,n.m_flag_islandFlag=!0))}}for(b=b.m_jointList;b;b=b.next)b.joint.m_islandFlag||(n=b.other,n.IsActive()&&(d.AddJoint(b.joint),b.joint.m_islandFlag=!0,n.m_flag_islandFlag||(box2d.ENABLE_ASSERTS&&box2d.b2Assert(k<e),f[k++]=n,n.m_flag_islandFlag=!0)))}b=new box2d.b2Profile;
d.Solve(b,a,this.m_gravity,this.m_allowSleep);this.m_profile.solveInit+=b.solveInit;this.m_profile.solveVelocity+=b.solveVelocity;this.m_profile.solvePosition+=b.solvePosition;for(k=0;k<d.m_bodyCount;++k)b=d.m_bodies[k],b.GetType()===box2d.b2BodyType.b2_staticBody&&(b.m_flag_islandFlag=!1)}for(k=0;k<f.length&&f[k];++k)f[k]=null;a=new box2d.b2Timer;for(b=this.m_bodyList;b;b=b.m_next)b.m_flag_islandFlag&&b.GetType()!==box2d.b2BodyType.b2_staticBody&&b.SynchronizeFixtures();this.m_contactManager.FindNewContacts();
this.m_profile.broadphase=a.GetMilliseconds()};goog.exportProperty(box2d.b2World.prototype,"Solve",box2d.b2World.prototype.Solve);
box2d.b2World.prototype.SolveTOI=function(a){var b=this.m_island;b.Initialize(2*box2d.b2_maxTOIContacts,box2d.b2_maxTOIContacts,0,null,this.m_contactManager.m_contactListener);if(this.m_stepComplete){for(var d=this.m_bodyList;d;d=d.m_next)d.m_flag_islandFlag=!1,d.m_sweep.alpha0=0;for(var e=this.m_contactManager.m_contactList;e;e=e.m_next)e.m_flag_toiFlag=e.m_flag_islandFlag=!1,e.m_toiCount=0,e.m_toi=1}for(;;){for(var f=null,d=1,e=this.m_contactManager.m_contactList;e;e=e.m_next)if(e.IsEnabled()&&
!(e.m_toiCount>box2d.b2_maxSubSteps)){var g=1;if(e.m_flag_toiFlag)g=e.m_toi;else{var k=e.GetFixtureA(),m=e.GetFixtureB();if(k.IsSensor()||m.IsSensor())continue;var g=k.GetBody(),n=m.GetBody(),q=g.m_type,s=n.m_type;box2d.ENABLE_ASSERTS&&box2d.b2Assert(q!==box2d.b2BodyType.b2_staticBody||s!==box2d.b2BodyType.b2_staticBody);var t=g.IsAwake()&&q!==box2d.b2BodyType.b2_staticBody,u=n.IsAwake()&&s!==box2d.b2BodyType.b2_staticBody;if(!t&&!u)continue;q=g.IsBullet()||q!==box2d.b2BodyType.b2_dynamicBody;s=n.IsBullet()||
s!==box2d.b2BodyType.b2_dynamicBody;if(!q&&!s)continue;s=g.m_sweep.alpha0;g.m_sweep.alpha0<n.m_sweep.alpha0?(s=n.m_sweep.alpha0,g.m_sweep.Advance(s)):n.m_sweep.alpha0<g.m_sweep.alpha0&&(s=g.m_sweep.alpha0,n.m_sweep.Advance(s));box2d.ENABLE_ASSERTS&&box2d.b2Assert(1>s);t=e.GetChildIndexA();u=e.GetChildIndexB();q=box2d.b2World.prototype.SolveTOI.s_toi_input;q.proxyA.SetShape(k.GetShape(),t);q.proxyB.SetShape(m.GetShape(),u);q.sweepA.Copy(g.m_sweep);q.sweepB.Copy(n.m_sweep);q.tMax=1;g=box2d.b2World.prototype.SolveTOI.s_toi_output;
box2d.b2TimeOfImpact(g,q);n=g.t;g=g.state===box2d.b2TOIOutputState.e_touching?box2d.b2Min(s+(1-s)*n,1):1;e.m_toi=g;e.m_flag_toiFlag=!0}g<d&&(f=e,d=g)}if(null===f||1-10*box2d.b2_epsilon<d){this.m_stepComplete=!0;break}k=f.GetFixtureA();m=f.GetFixtureB();g=k.GetBody();n=m.GetBody();e=box2d.b2World.prototype.SolveTOI.s_backup1.Copy(g.m_sweep);k=box2d.b2World.prototype.SolveTOI.s_backup2.Copy(n.m_sweep);g.Advance(d);n.Advance(d);f.Update(this.m_contactManager.m_contactListener);f.m_flag_toiFlag=!1;++f.m_toiCount;
if(f.IsEnabled()&&f.IsTouching()){g.SetAwake(!0);n.SetAwake(!0);b.Clear();b.AddBody(g);b.AddBody(n);b.AddContact(f);g.m_flag_islandFlag=!0;n.m_flag_islandFlag=!0;f.m_flag_islandFlag=!0;for(f=0;2>f;++f)if(e=0===f?g:n,e.m_type===box2d.b2BodyType.b2_dynamicBody)for(k=e.m_contactList;k&&b.m_bodyCount!==b.m_bodyCapacity&&b.m_contactCount!==b.m_contactCapacity;k=k.next)m=k.contact,!m.m_flag_islandFlag&&(s=k.other,s.m_type!==box2d.b2BodyType.b2_dynamicBody||e.IsBullet()||s.IsBullet())&&(q=m.m_fixtureB.m_isSensor,
m.m_fixtureA.m_isSensor||q||(q=box2d.b2World.prototype.SolveTOI.s_backup.Copy(s.m_sweep),s.m_flag_islandFlag||s.Advance(d),m.Update(this.m_contactManager.m_contactListener),m.IsEnabled()?m.IsTouching()?(m.m_flag_islandFlag=!0,b.AddContact(m),s.m_flag_islandFlag||(s.m_flag_islandFlag=!0,s.m_type!==box2d.b2BodyType.b2_staticBody&&s.SetAwake(!0),b.AddBody(s))):(s.m_sweep.Copy(q),s.SynchronizeTransform()):(s.m_sweep.Copy(q),s.SynchronizeTransform())));f=box2d.b2World.prototype.SolveTOI.s_subStep;f.dt=
(1-d)*a.dt;f.inv_dt=1/f.dt;f.dtRatio=1;f.positionIterations=20;f.velocityIterations=a.velocityIterations;f.particleIterations=a.particleIterations;f.warmStarting=!1;b.SolveTOI(f,g.m_islandIndex,n.m_islandIndex);for(f=0;f<b.m_bodyCount;++f)if(e=b.m_bodies[f],e.m_flag_islandFlag=!1,e.m_type===box2d.b2BodyType.b2_dynamicBody)for(e.SynchronizeFixtures(),k=e.m_contactList;k;k=k.next)k.contact.m_flag_toiFlag=k.contact.m_flag_islandFlag=!1;this.m_contactManager.FindNewContacts();if(this.m_subStepping){this.m_stepComplete=
!1;break}}else f.SetEnabled(!1),g.m_sweep.Copy(e),n.m_sweep.Copy(k),g.SynchronizeTransform(),n.SynchronizeTransform()}};goog.exportProperty(box2d.b2World.prototype,"SolveTOI",box2d.b2World.prototype.SolveTOI);box2d.b2World.prototype.SolveTOI.s_subStep=new box2d.b2TimeStep;box2d.b2World.prototype.SolveTOI.s_backup=new box2d.b2Sweep;box2d.b2World.prototype.SolveTOI.s_backup1=new box2d.b2Sweep;box2d.b2World.prototype.SolveTOI.s_backup2=new box2d.b2Sweep;box2d.b2World.prototype.SolveTOI.s_toi_input=new box2d.b2TOIInput;
box2d.b2World.prototype.SolveTOI.s_toi_output=new box2d.b2TOIOutput;
box2d.b2World.prototype.Step=function(a,b,d,e){e=e||this.CalculateReasonableParticleIterations(a);var f=new box2d.b2Timer;this.m_flag_newFixture&&(this.m_contactManager.FindNewContacts(),this.m_flag_newFixture=!1);this.m_flag_locked=!0;var g=box2d.b2World.prototype.Step.s_step;g.dt=a;g.velocityIterations=b;g.positionIterations=d;g.particleIterations=e;g.inv_dt=0<a?1/a:0;g.dtRatio=this.m_inv_dt0*a;g.warmStarting=this.m_warmStarting;a=new box2d.b2Timer;this.m_contactManager.Collide();this.m_profile.collide=
a.GetMilliseconds();if(this.m_stepComplete&&0<g.dt){a=new box2d.b2Timer;for(b=this.m_particleSystemList;b;b=b.m_next)b.Solve(g);this.Solve(g);this.m_profile.solve=a.GetMilliseconds()}this.m_continuousPhysics&&0<g.dt&&(a=new box2d.b2Timer,this.SolveTOI(g),this.m_profile.solveTOI=a.GetMilliseconds());0<g.dt&&(this.m_inv_dt0=g.inv_dt);this.m_flag_clearForces&&this.ClearForces();this.m_flag_locked=!1;this.m_profile.step=f.GetMilliseconds()};goog.exportProperty(box2d.b2World.prototype,"Step",box2d.b2World.prototype.Step);
box2d.b2World.prototype.Step.s_step=new box2d.b2TimeStep;box2d.b2World.prototype.ClearForces=function(){for(var a=this.m_bodyList;a;a=a.m_next)a.m_force.SetZero(),a.m_torque=0};goog.exportProperty(box2d.b2World.prototype,"ClearForces",box2d.b2World.prototype.ClearForces);
box2d.b2World.prototype.QueryAABB=function(a,b){var d=this.m_contactManager.m_broadPhase;d.Query(function(b){b=d.GetUserData(b);box2d.ENABLE_ASSERTS&&box2d.b2Assert(b instanceof box2d.b2FixtureProxy);b=b.fixture;return a instanceof box2d.b2QueryCallback?a.ReportFixture(b):a(b)},b);if(a instanceof box2d.b2QueryCallback)for(var e=this.m_particleSystemList;e;e=e.m_next)a.ShouldQueryParticleSystem(e)&&e.QueryAABB(a,b)};goog.exportProperty(box2d.b2World.prototype,"QueryAABB",box2d.b2World.prototype.QueryAABB);
box2d.b2World.prototype.QueryShape=function(a,b,d,e){var f=this.m_contactManager.m_broadPhase,g=box2d.b2World.prototype.QueryShape.s_aabb;b.ComputeAABB(g,d,e||0);f.Query(function(e){e=f.GetUserData(e);box2d.ENABLE_ASSERTS&&box2d.b2Assert(e instanceof box2d.b2FixtureProxy);e=e.fixture;return box2d.b2TestOverlap_Shape(b,0,e.GetShape(),0,d,e.GetBody().GetTransform())?a instanceof box2d.b2QueryCallback?a.ReportFixture(e):a(e):!0},g);if(a instanceof box2d.b2QueryCallback)for(e=this.m_particleSystemList;e;e=
e.m_next)a.ShouldQueryParticleSystem(e)&&e.QueryAABB(a,g)};goog.exportProperty(box2d.b2World.prototype,"QueryShape",box2d.b2World.prototype.QueryShape);box2d.b2World.prototype.QueryShape.s_aabb=new box2d.b2AABB;
box2d.b2World.prototype.QueryPoint=function(a,b,d){var e=this.m_contactManager.m_broadPhase;d="number"===typeof d?d:box2d.b2_linearSlop;var f=box2d.b2World.prototype.QueryPoint.s_aabb;f.lowerBound.Set(b.x-d,b.y-d);f.upperBound.Set(b.x+d,b.y+d);e.Query(function(d){d=e.GetUserData(d);box2d.ENABLE_ASSERTS&&box2d.b2Assert(d instanceof box2d.b2FixtureProxy);d=d.fixture;return d.TestPoint(b)?a instanceof box2d.b2QueryCallback?a.ReportFixture(d):a(d):!0},f);if(a instanceof box2d.b2QueryCallback)for(d=this.m_particleSystemList;d;d=
d.m_next)a.ShouldQueryParticleSystem(d)&&d.QueryAABB(a,f)};goog.exportProperty(box2d.b2World.prototype,"QueryPoint",box2d.b2World.prototype.QueryPoint);box2d.b2World.prototype.QueryPoint.s_aabb=new box2d.b2AABB;
box2d.b2World.prototype.RayCast=function(a,b,d){var e=this.m_contactManager.m_broadPhase,f=box2d.b2World.prototype.RayCast.s_input;f.maxFraction=1;f.p1.Copy(b);f.p2.Copy(d);e.RayCast(function(f,k){var m=e.GetUserData(k);box2d.ENABLE_ASSERTS&&box2d.b2Assert(m instanceof box2d.b2FixtureProxy);var n=m.fixture,q=box2d.b2World.prototype.RayCast.s_output;if(n.RayCast(q,f,m.childIndex)){var m=q.fraction,s=box2d.b2World.prototype.RayCast.s_point;s.Set((1-m)*b.x+m*d.x,(1-m)*b.y+m*d.y);return a instanceof box2d.b2RayCastCallback?
a.ReportFixture(n,s,q.normal,m):a(n,s,q.normal,m)}return f.maxFraction},f);if(a instanceof box2d.b2RayCastCallback)for(f=this.m_particleSystemList;f;f=f.m_next)a.ShouldQueryParticleSystem(f)&&f.RayCast(a,b,d)};goog.exportProperty(box2d.b2World.prototype,"RayCast",box2d.b2World.prototype.RayCast);box2d.b2World.prototype.RayCast.s_input=new box2d.b2RayCastInput;box2d.b2World.prototype.RayCast.s_output=new box2d.b2RayCastOutput;box2d.b2World.prototype.RayCast.s_point=new box2d.b2Vec2;
box2d.b2World.prototype.RayCastOne=function(a,b){var d=null,e=1;this.RayCast(function(a,b,k,m){m<e&&(e=m,d=a);return e},a,b);return d};goog.exportProperty(box2d.b2World.prototype,"RayCastOne",box2d.b2World.prototype.RayCastOne);box2d.b2World.prototype.RayCastAll=function(a,b,d){d.length=0;this.RayCast(function(a,b,g,k){d.push(a);return 1},a,b);return d};goog.exportProperty(box2d.b2World.prototype,"RayCastAll",box2d.b2World.prototype.RayCastAll);
box2d.b2World.prototype.DrawShape=function(a,b){var d=a.GetShape();switch(d.m_type){case box2d.b2ShapeType.e_circleShape:d=d instanceof box2d.b2CircleShape?d:null;this.m_debugDraw.DrawSolidCircle(d.m_p,d.m_radius,box2d.b2Vec2.UNITX,b);break;case box2d.b2ShapeType.e_edgeShape:var e=d instanceof box2d.b2EdgeShape?d:null,d=e.m_vertex1,f=e.m_vertex2;this.m_debugDraw.DrawSegment(d,f,b);break;case box2d.b2ShapeType.e_chainShape:var d=d instanceof box2d.b2ChainShape?d:null,e=d.m_count,g=d.m_vertices,d=g[0];
this.m_debugDraw.DrawCircle(d,.05,b);for(var k=1;k<e;++k)f=g[k],this.m_debugDraw.DrawSegment(d,f,b),this.m_debugDraw.DrawCircle(f,.05,b),d=f;break;case box2d.b2ShapeType.e_polygonShape:e=d instanceof box2d.b2PolygonShape?d:null,d=e.m_count,g=e.m_vertices,this.m_debugDraw.DrawSolidPolygon(g,d,b)}};goog.exportProperty(box2d.b2World.prototype,"DrawShape",box2d.b2World.prototype.DrawShape);
box2d.b2World.prototype.DrawJoint=function(a){var b=a.GetBodyA(),d=a.GetBodyB(),e=b.m_xf.p,f=d.m_xf.p,d=a.GetAnchorA(box2d.b2World.prototype.DrawJoint.s_p1),b=a.GetAnchorB(box2d.b2World.prototype.DrawJoint.s_p2),g=box2d.b2World.prototype.DrawJoint.s_color.SetRGB(.5,.8,.8);switch(a.m_type){case box2d.b2JointType.e_distanceJoint:this.m_debugDraw.DrawSegment(d,b,g);break;case box2d.b2JointType.e_pulleyJoint:e=a instanceof box2d.b2PulleyJoint?a:null;a=e.GetGroundAnchorA(box2d.b2World.prototype.DrawJoint.s_s1);
e=e.GetGroundAnchorB(box2d.b2World.prototype.DrawJoint.s_s2);this.m_debugDraw.DrawSegment(a,d,g);this.m_debugDraw.DrawSegment(e,b,g);this.m_debugDraw.DrawSegment(a,e,g);break;case box2d.b2JointType.e_mouseJoint:this.m_debugDraw.DrawSegment(d,b,g);break;default:this.m_debugDraw.DrawSegment(e,d,g),this.m_debugDraw.DrawSegment(d,b,g),this.m_debugDraw.DrawSegment(f,b,g)}};goog.exportProperty(box2d.b2World.prototype,"DrawJoint",box2d.b2World.prototype.DrawJoint);
box2d.b2World.prototype.DrawJoint.s_p1=new box2d.b2Vec2;box2d.b2World.prototype.DrawJoint.s_p2=new box2d.b2Vec2;box2d.b2World.prototype.DrawJoint.s_color=new box2d.b2Color(.5,.8,.8);box2d.b2World.prototype.DrawJoint.s_s1=new box2d.b2Vec2;box2d.b2World.prototype.DrawJoint.s_s2=new box2d.b2Vec2;
box2d.b2World.prototype.DrawParticleSystem=function(a){var b=a.GetParticleCount();if(b){var d=a.GetRadius(),e=a.GetPositionBuffer();a.m_colorBuffer.data?(a=a.GetColorBuffer(),this.m_debugDraw.DrawParticles(e,d,a,b)):this.m_debugDraw.DrawParticles(e,d,null,b)}};goog.exportProperty(box2d.b2World.prototype,"DrawParticleSystem",box2d.b2World.prototype.DrawParticleSystem);
box2d.b2World.prototype.DrawDebugData=function(){if(null!==this.m_debugDraw){var a=this.m_debugDraw.GetFlags(),b=box2d.b2World.prototype.DrawDebugData.s_color.SetRGB(0,0,0);if(a&box2d.b2DrawFlags.e_shapeBit)for(var d=this.m_bodyList;d;d=d.m_next){var e=d.m_xf;this.m_debugDraw.PushTransform(e);for(var f=d.GetFixtureList();f;f=f.m_next)d.IsActive()?d.GetType()===box2d.b2BodyType.b2_staticBody?b.SetRGB(.5,.9,.5):d.GetType()===box2d.b2BodyType.b2_kinematicBody?b.SetRGB(.5,.5,.9):d.IsAwake()?b.SetRGB(.9,
.7,.7):b.SetRGB(.6,.6,.6):b.SetRGB(.5,.5,.3),this.DrawShape(f,b);this.m_debugDraw.PopTransform(e)}if(a&box2d.b2DrawFlags.e_particleBit)for(d=this.m_particleSystemList;d;d=d.m_next)this.DrawParticleSystem(d);if(a&box2d.b2DrawFlags.e_jointBit)for(d=this.m_jointList;d;d=d.m_next)this.DrawJoint(d);if(a&box2d.b2DrawFlags.e_aabbBit){b.SetRGB(.9,.3,.9);for(var e=this.m_contactManager.m_broadPhase,g=box2d.b2World.prototype.DrawDebugData.s_vs,d=this.m_bodyList;d;d=d.m_next)if(d.IsActive())for(f=d.GetFixtureList();f;f=
f.m_next)for(var k=0;k<f.m_proxyCount;++k){var m=e.GetFatAABB(f.m_proxies[k].proxy);g[0].Set(m.lowerBound.x,m.lowerBound.y);g[1].Set(m.upperBound.x,m.lowerBound.y);g[2].Set(m.upperBound.x,m.upperBound.y);g[3].Set(m.lowerBound.x,m.upperBound.y);this.m_debugDraw.DrawPolygon(g,4,b)}}if(a&box2d.b2DrawFlags.e_centerOfMassBit)for(d=this.m_bodyList;d;d=d.m_next)e=box2d.b2World.prototype.DrawDebugData.s_xf,e.q.Copy(d.m_xf.q),e.p.Copy(d.GetWorldCenter()),this.m_debugDraw.DrawTransform(e);if(a&box2d.b2DrawFlags.e_controllerBit)for(a=
this.m_controllerList;a;a=a.m_next)a.Draw(this.m_debugDraw)}};goog.exportProperty(box2d.b2World.prototype,"DrawDebugData",box2d.b2World.prototype.DrawDebugData);box2d.b2World.prototype.DrawDebugData.s_color=new box2d.b2Color(0,0,0);box2d.b2World.prototype.DrawDebugData.s_vs=box2d.b2Vec2.MakeArray(4);box2d.b2World.prototype.DrawDebugData.s_xf=new box2d.b2Transform;
box2d.b2World.prototype.SetBroadPhase=function(a){var b=this.m_contactManager.m_broadPhase;this.m_contactManager.m_broadPhase=a;for(var d=this.m_bodyList;d;d=d.m_next)for(var e=d.m_fixtureList;e;e=e.m_next)e.m_proxy=a.CreateProxy(b.GetFatAABB(e.m_proxy),e)};goog.exportProperty(box2d.b2World.prototype,"SetBroadPhase",box2d.b2World.prototype.SetBroadPhase);
box2d.b2World.prototype.CalculateReasonableParticleIterations=function(a){return null===this.m_particleSystemList?1:box2d.b2CalculateParticleIterations(this.m_gravity.Length(),function(a){var d=box2d.b2_maxFloat;for(a=a.GetParticleSystemList();null!==a;a=a.m_next)d=box2d.b2Min(d,a.GetRadius());return d}(this),a)};goog.exportProperty(box2d.b2World.prototype,"CalculateReasonableParticleIterations",box2d.b2World.prototype.CalculateReasonableParticleIterations);box2d.b2World.prototype.GetProxyCount=function(){return this.m_contactManager.m_broadPhase.GetProxyCount()};
goog.exportProperty(box2d.b2World.prototype,"GetProxyCount",box2d.b2World.prototype.GetProxyCount);box2d.b2World.prototype.GetTreeHeight=function(){return this.m_contactManager.m_broadPhase.GetTreeHeight()};goog.exportProperty(box2d.b2World.prototype,"GetTreeHeight",box2d.b2World.prototype.GetTreeHeight);box2d.b2World.prototype.GetTreeBalance=function(){return this.m_contactManager.m_broadPhase.GetTreeBalance()};goog.exportProperty(box2d.b2World.prototype,"GetTreeBalance",box2d.b2World.prototype.GetTreeBalance);
box2d.b2World.prototype.GetTreeQuality=function(){return this.m_contactManager.m_broadPhase.GetTreeQuality()};goog.exportProperty(box2d.b2World.prototype,"GetTreeQuality",box2d.b2World.prototype.GetTreeQuality);box2d.b2World.prototype.ShiftOrigin=function(a){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!this.IsLocked());if(!this.IsLocked()){for(var b=this.m_bodyList;b;b=b.m_next)b.m_xf.p.SelfSub(a),b.m_sweep.c0.SelfSub(a),b.m_sweep.c.SelfSub(a);for(b=this.m_jointList;b;b=b.m_next)b.ShiftOrigin(a);this.m_contactManager.m_broadPhase.ShiftOrigin(a)}};
goog.exportProperty(box2d.b2World.prototype,"ShiftOrigin",box2d.b2World.prototype.ShiftOrigin);
box2d.b2World.prototype.Dump=function(){if(box2d.DEBUG&&!this.m_flag_locked){box2d.b2Log("/** @type {box2d.b2Vec2} */ var g = new box2d.b2Vec2(%.15f, %.15f);\n",this.m_gravity.x,this.m_gravity.y);box2d.b2Log("this.m_world.SetGravity(g);\n");box2d.b2Log("/** @type {Array.<box2d.b2Body>} */ var bodies = new Array(%d);\n",this.m_bodyCount);box2d.b2Log("/** @type {Array.<box2d.b2Joint>} */ var joints = new Array(%d);\n",this.m_jointCount);for(var a=0,b=this.m_bodyList;b;b=b.m_next)b.m_islandIndex=a,b.Dump(),
++a;a=0;for(b=this.m_jointList;b;b=b.m_next)b.m_index=a,++a;for(b=this.m_jointList;b;b=b.m_next)b.m_type!==box2d.b2JointType.e_gearJoint&&(box2d.b2Log("{\n"),b.Dump(),box2d.b2Log("}\n"));for(b=this.m_jointList;b;b=b.m_next)b.m_type===box2d.b2JointType.e_gearJoint&&(box2d.b2Log("{\n"),b.Dump(),box2d.b2Log("}\n"))}};goog.exportProperty(box2d.b2World.prototype,"Dump",box2d.b2World.prototype.Dump);
box2d.b2World.prototype.AddController=function(a){box2d.ENABLE_ASSERTS&&box2d.b2Assert(null===a.m_world,"Controller can only be a member of one world");a.m_world=this;a.m_next=this.m_controllerList;a.m_prev=null;this.m_controllerList&&(this.m_controllerList.m_prev=a);this.m_controllerList=a;++this.m_controllerCount;return a};goog.exportProperty(box2d.b2World.prototype,"AddController",box2d.b2World.prototype.AddController);
box2d.b2World.prototype.RemoveController=function(a){box2d.ENABLE_ASSERTS&&box2d.b2Assert(a.m_world===this,"Controller is not a member of this world");a.m_prev&&(a.m_prev.m_next=a.m_next);a.m_next&&(a.m_next.m_prev=a.m_prev);this.m_controllerList===a&&(this.m_controllerList=a.m_next);--this.m_controllerCount;a.m_prev=null;a.m_next=null;a.m_world=null};goog.exportProperty(box2d.b2World.prototype,"RemoveController",box2d.b2World.prototype.RemoveController);
box2d.b2MotorJointDef=function(){box2d.b2JointDef.call(this,box2d.b2JointType.e_motorJoint);this.linearOffset=new box2d.b2Vec2(0,0)};goog.inherits(box2d.b2MotorJointDef,box2d.b2JointDef);goog.exportSymbol("box2d.b2MotorJointDef",box2d.b2MotorJointDef);box2d.b2MotorJointDef.prototype.linearOffset=null;goog.exportProperty(box2d.b2MotorJointDef.prototype,"linearOffset",box2d.b2MotorJointDef.prototype.linearOffset);box2d.b2MotorJointDef.prototype.angularOffset=0;
goog.exportProperty(box2d.b2MotorJointDef.prototype,"angularOffset",box2d.b2MotorJointDef.prototype.angularOffset);box2d.b2MotorJointDef.prototype.maxForce=1;goog.exportProperty(box2d.b2MotorJointDef.prototype,"maxForce",box2d.b2MotorJointDef.prototype.maxForce);box2d.b2MotorJointDef.prototype.maxTorque=1;goog.exportProperty(box2d.b2MotorJointDef.prototype,"maxTorque",box2d.b2MotorJointDef.prototype.maxTorque);box2d.b2MotorJointDef.prototype.correctionFactor=.3;
goog.exportProperty(box2d.b2MotorJointDef.prototype,"correctionFactor",box2d.b2MotorJointDef.prototype.correctionFactor);box2d.b2MotorJointDef.prototype.Initialize=function(a,b){this.bodyA=a;this.bodyB=b;this.bodyA.GetLocalPoint(this.bodyB.GetPosition(),this.linearOffset);var d=this.bodyA.GetAngle();this.angularOffset=this.bodyB.GetAngle()-d};goog.exportProperty(box2d.b2MotorJointDef.prototype,"Initialize",box2d.b2MotorJointDef.prototype.Initialize);
box2d.b2MotorJoint=function(a){box2d.b2Joint.call(this,a);this.m_linearOffset=a.linearOffset.Clone();this.m_linearImpulse=new box2d.b2Vec2(0,0);this.m_maxForce=a.maxForce;this.m_maxTorque=a.maxTorque;this.m_correctionFactor=a.correctionFactor;this.m_rA=new box2d.b2Vec2(0,0);this.m_rB=new box2d.b2Vec2(0,0);this.m_localCenterA=new box2d.b2Vec2(0,0);this.m_localCenterB=new box2d.b2Vec2(0,0);this.m_linearError=new box2d.b2Vec2(0,0);this.m_linearMass=new box2d.b2Mat22;this.m_qA=new box2d.b2Rot;this.m_qB=
new box2d.b2Rot;this.m_K=new box2d.b2Mat22};goog.inherits(box2d.b2MotorJoint,box2d.b2Joint);goog.exportSymbol("box2d.b2MotorJoint",box2d.b2MotorJoint);box2d.b2MotorJoint.prototype.m_linearOffset=null;goog.exportProperty(box2d.b2MotorJoint.prototype,"m_linearOffset",box2d.b2MotorJoint.prototype.m_linearOffset);box2d.b2MotorJoint.prototype.m_angularOffset=0;goog.exportProperty(box2d.b2MotorJoint.prototype,"m_angularOffset",box2d.b2MotorJoint.prototype.m_angularOffset);
box2d.b2MotorJoint.prototype.m_linearImpulse=null;goog.exportProperty(box2d.b2MotorJoint.prototype,"m_linearImpulse",box2d.b2MotorJoint.prototype.m_linearImpulse);box2d.b2MotorJoint.prototype.m_angularImpulse=0;goog.exportProperty(box2d.b2MotorJoint.prototype,"m_angularImpulse",box2d.b2MotorJoint.prototype.m_angularImpulse);box2d.b2MotorJoint.prototype.m_maxForce=0;goog.exportProperty(box2d.b2MotorJoint.prototype,"m_maxForce",box2d.b2MotorJoint.prototype.m_maxForce);
box2d.b2MotorJoint.prototype.m_maxTorque=0;goog.exportProperty(box2d.b2MotorJoint.prototype,"m_maxTorque",box2d.b2MotorJoint.prototype.m_maxTorque);box2d.b2MotorJoint.prototype.m_correctionFactor=.3;goog.exportProperty(box2d.b2MotorJoint.prototype,"m_correctionFactor",box2d.b2MotorJoint.prototype.m_correctionFactor);box2d.b2MotorJoint.prototype.m_indexA=0;goog.exportProperty(box2d.b2MotorJoint.prototype,"m_indexA",box2d.b2MotorJoint.prototype.m_indexA);box2d.b2MotorJoint.prototype.m_indexB=0;
goog.exportProperty(box2d.b2MotorJoint.prototype,"m_indexB",box2d.b2MotorJoint.prototype.m_indexB);box2d.b2MotorJoint.prototype.m_rA=null;goog.exportProperty(box2d.b2MotorJoint.prototype,"m_rA",box2d.b2MotorJoint.prototype.m_rA);box2d.b2MotorJoint.prototype.m_rB=null;goog.exportProperty(box2d.b2MotorJoint.prototype,"m_rB",box2d.b2MotorJoint.prototype.m_rB);box2d.b2MotorJoint.prototype.m_localCenterA=null;goog.exportProperty(box2d.b2MotorJoint.prototype,"m_localCenterA",box2d.b2MotorJoint.prototype.m_localCenterA);
box2d.b2MotorJoint.prototype.m_localCenterB=null;goog.exportProperty(box2d.b2MotorJoint.prototype,"m_localCenterB",box2d.b2MotorJoint.prototype.m_localCenterB);box2d.b2MotorJoint.prototype.m_linearError=null;goog.exportProperty(box2d.b2MotorJoint.prototype,"m_linearError",box2d.b2MotorJoint.prototype.m_linearError);box2d.b2MotorJoint.prototype.m_angularError=0;goog.exportProperty(box2d.b2MotorJoint.prototype,"m_angularError",box2d.b2MotorJoint.prototype.m_angularError);
box2d.b2MotorJoint.prototype.m_invMassA=0;goog.exportProperty(box2d.b2MotorJoint.prototype,"m_invMassA",box2d.b2MotorJoint.prototype.m_invMassA);box2d.b2MotorJoint.prototype.m_invMassB=0;goog.exportProperty(box2d.b2MotorJoint.prototype,"m_invMassB",box2d.b2MotorJoint.prototype.m_invMassB);box2d.b2MotorJoint.prototype.m_invIA=0;goog.exportProperty(box2d.b2MotorJoint.prototype,"m_invIA",box2d.b2MotorJoint.prototype.m_invIA);box2d.b2MotorJoint.prototype.m_invIB=0;
goog.exportProperty(box2d.b2MotorJoint.prototype,"m_invIB",box2d.b2MotorJoint.prototype.m_invIB);box2d.b2MotorJoint.prototype.m_linearMass=null;goog.exportProperty(box2d.b2MotorJoint.prototype,"m_linearMass",box2d.b2MotorJoint.prototype.m_linearMass);box2d.b2MotorJoint.prototype.m_angularMass=0;goog.exportProperty(box2d.b2MotorJoint.prototype,"m_angularMass",box2d.b2MotorJoint.prototype.m_angularMass);box2d.b2MotorJoint.prototype.m_qA=null;goog.exportProperty(box2d.b2MotorJoint.prototype,"m_qA",box2d.b2MotorJoint.prototype.m_qA);
box2d.b2MotorJoint.prototype.m_qB=null;goog.exportProperty(box2d.b2MotorJoint.prototype,"m_qB",box2d.b2MotorJoint.prototype.m_qB);box2d.b2MotorJoint.prototype.m_K=null;goog.exportProperty(box2d.b2MotorJoint.prototype,"m_K",box2d.b2MotorJoint.prototype.m_K);box2d.b2MotorJoint.prototype.GetAnchorA=function(a){return this.m_bodyA.GetPosition(a)};goog.exportProperty(box2d.b2MotorJoint.prototype,"GetAnchorA",box2d.b2MotorJoint.prototype.GetAnchorA);box2d.b2MotorJoint.prototype.GetAnchorB=function(a){return this.m_bodyB.GetPosition(a)};
goog.exportProperty(box2d.b2MotorJoint.prototype,"GetAnchorB",box2d.b2MotorJoint.prototype.GetAnchorB);box2d.b2MotorJoint.prototype.GetReactionForce=function(a,b){return box2d.b2Mul_S_V2(a,this.m_linearImpulse,b)};goog.exportProperty(box2d.b2MotorJoint.prototype,"GetReactionForce",box2d.b2MotorJoint.prototype.GetReactionForce);box2d.b2MotorJoint.prototype.GetReactionTorque=function(a){return a*this.m_angularImpulse};goog.exportProperty(box2d.b2MotorJoint.prototype,"GetReactionTorque",box2d.b2MotorJoint.prototype.GetReactionTorque);
box2d.b2MotorJoint.prototype.SetCorrectionFactor=function(a){box2d.ENABLE_ASSERTS&&box2d.b2Assert(box2d.b2IsValid(a)&&0<=a&&1>=a);this._correctionFactor=a};box2d.b2MotorJoint.prototype.GetCorrectionFactor=function(){return this.m_correctionFactor};box2d.b2MotorJoint.prototype.SetLinearOffset=function(a){if(a.x!=this.m_linearOffset.x||a.y!=this.m_linearOffset.y)this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_linearOffset.Copy(a)};
goog.exportProperty(box2d.b2MotorJoint.prototype,"SetLinearOffset",box2d.b2MotorJoint.prototype.SetLinearOffset);box2d.b2MotorJoint.prototype.GetLinearOffset=function(a){return a.Copy(this.m_linearOffset)};goog.exportProperty(box2d.b2MotorJoint.prototype,"GetLinearOffset",box2d.b2MotorJoint.prototype.GetLinearOffset);box2d.b2MotorJoint.prototype.SetAngularOffset=function(a){a!==this.m_angularOffset&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_angularOffset=a)};
goog.exportProperty(box2d.b2MotorJoint.prototype,"SetAngularOffset",box2d.b2MotorJoint.prototype.SetAngularOffset);box2d.b2MotorJoint.prototype.GetAngularOffset=function(){return this.m_angularOffset};goog.exportProperty(box2d.b2MotorJoint.prototype,"GetAngularOffset",box2d.b2MotorJoint.prototype.GetAngularOffset);box2d.b2MotorJoint.prototype.SetMaxForce=function(a){box2d.ENABLE_ASSERTS&&box2d.b2Assert(box2d.b2IsValid(a)&&0<=a);this.m_maxForce=a};
goog.exportProperty(box2d.b2MotorJoint.prototype,"SetMaxForce",box2d.b2MotorJoint.prototype.SetMaxForce);box2d.b2MotorJoint.prototype.GetMaxForce=function(){return this.m_maxForce};goog.exportProperty(box2d.b2MotorJoint.prototype,"GetMaxForce",box2d.b2MotorJoint.prototype.GetMaxForce);box2d.b2MotorJoint.prototype.SetMaxTorque=function(a){box2d.ENABLE_ASSERTS&&box2d.b2Assert(box2d.b2IsValid(a)&&0<=a);this.m_maxTorque=a};goog.exportProperty(box2d.b2MotorJoint.prototype,"SetMaxTorque",box2d.b2MotorJoint.prototype.SetMaxTorque);
box2d.b2MotorJoint.prototype.GetMaxTorque=function(){return this.m_maxTorque};goog.exportProperty(box2d.b2MotorJoint.prototype,"GetMaxTorque",box2d.b2MotorJoint.prototype.GetMaxTorque);
box2d.b2MotorJoint.prototype.InitVelocityConstraints=function(a){this.m_indexA=this.m_bodyA.m_islandIndex;this.m_indexB=this.m_bodyB.m_islandIndex;this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter);this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter);this.m_invMassA=this.m_bodyA.m_invMass;this.m_invMassB=this.m_bodyB.m_invMass;this.m_invIA=this.m_bodyA.m_invI;this.m_invIB=this.m_bodyB.m_invI;var b=a.positions[this.m_indexA].c,d=a.positions[this.m_indexA].a,e=a.velocities[this.m_indexA].v,
f=a.velocities[this.m_indexA].w,g=a.positions[this.m_indexB].c,k=a.positions[this.m_indexB].a,m=a.velocities[this.m_indexB].v,n=a.velocities[this.m_indexB].w,q=this.m_qA.SetAngle(d),s=this.m_qB.SetAngle(k),t=box2d.b2Mul_R_V2(q,box2d.b2Vec2.s_t0.Copy(this.m_localCenterA).SelfNeg(),this.m_rA),s=box2d.b2Mul_R_V2(s,box2d.b2Vec2.s_t0.Copy(this.m_localCenterB).SelfNeg(),this.m_rB),u=this.m_invMassA,v=this.m_invMassB,y=this.m_invIA,z=this.m_invIB,A=this.m_K;A.ex.x=u+v+y*t.y*t.y+z*s.y*s.y;A.ex.y=-y*t.x*t.y-
z*s.x*s.y;A.ey.x=A.ex.y;A.ey.y=u+v+y*t.x*t.x+z*s.x*s.x;A.GetInverse(this.m_linearMass);this.m_angularMass=y+z;0<this.m_angularMass&&(this.m_angularMass=1/this.m_angularMass);box2d.b2Sub_V2_V2(box2d.b2Sub_V2_V2(box2d.b2Add_V2_V2(g,s,box2d.b2Vec2.s_t0),box2d.b2Add_V2_V2(b,t,box2d.b2Vec2.s_t1),box2d.b2Vec2.s_t2),box2d.b2Mul_R_V2(q,this.m_linearOffset,box2d.b2Vec2.s_t3),this.m_linearError);this.m_angularError=k-d-this.m_angularOffset;a.step.warmStarting?(this.m_linearImpulse.SelfMul(a.step.dtRatio),this.m_angularImpulse*=
a.step.dtRatio,b=this.m_linearImpulse,e.SelfMulSub(u,b),f-=y*(box2d.b2Cross_V2_V2(t,b)+this.m_angularImpulse),m.SelfMulAdd(v,b),n+=z*(box2d.b2Cross_V2_V2(s,b)+this.m_angularImpulse)):(this.m_linearImpulse.SetZero(),this.m_angularImpulse=0);a.velocities[this.m_indexA].w=f;a.velocities[this.m_indexB].w=n};goog.exportProperty(box2d.b2MotorJoint.prototype,"InitVelocityConstraints",box2d.b2MotorJoint.prototype.InitVelocityConstraints);
box2d.b2MotorJoint.prototype.SolveVelocityConstraints=function(a){var b=a.velocities[this.m_indexA].v,d=a.velocities[this.m_indexA].w,e=a.velocities[this.m_indexB].v,f=a.velocities[this.m_indexB].w,g=this.m_invMassA,k=this.m_invMassB,m=this.m_invIA,n=this.m_invIB,q=a.step.dt,s=a.step.inv_dt,t=f-d+s*this.m_correctionFactor*this.m_angularError,t=-this.m_angularMass*t,u=this.m_angularImpulse,v=q*this.m_maxTorque;this.m_angularImpulse=box2d.b2Clamp(this.m_angularImpulse+t,-v,v);var t=this.m_angularImpulse-
u,d=d-m*t,f=f+n*t,y=this.m_rA,z=this.m_rB,t=box2d.b2Add_V2_V2(box2d.b2Sub_V2_V2(box2d.b2Add_V2_V2(e,box2d.b2Cross_S_V2(f,z,box2d.b2Vec2.s_t0),box2d.b2Vec2.s_t0),box2d.b2Add_V2_V2(b,box2d.b2Cross_S_V2(d,y,box2d.b2Vec2.s_t1),box2d.b2Vec2.s_t1),box2d.b2Vec2.s_t2),box2d.b2Mul_S_V2(s*this.m_correctionFactor,this.m_linearError,box2d.b2Vec2.s_t3),box2d.b2MotorJoint.prototype.SolveVelocityConstraints.s_Cdot),t=box2d.b2Mul_M22_V2(this.m_linearMass,t,box2d.b2MotorJoint.prototype.SolveVelocityConstraints.s_impulse).SelfNeg(),
u=box2d.b2MotorJoint.prototype.SolveVelocityConstraints.s_oldImpulse.Copy(this.m_linearImpulse);this.m_linearImpulse.SelfAdd(t);v=q*this.m_maxForce;this.m_linearImpulse.LengthSquared()>v*v&&(this.m_linearImpulse.Normalize(),this.m_linearImpulse.SelfMul(v));box2d.b2Sub_V2_V2(this.m_linearImpulse,u,t);b.SelfMulSub(g,t);d-=m*box2d.b2Cross_V2_V2(y,t);e.SelfMulAdd(k,t);f+=n*box2d.b2Cross_V2_V2(z,t);a.velocities[this.m_indexA].w=d;a.velocities[this.m_indexB].w=f};
goog.exportProperty(box2d.b2MotorJoint.prototype,"SolveVelocityConstraints",box2d.b2MotorJoint.prototype.SolveVelocityConstraints);box2d.b2MotorJoint.prototype.SolveVelocityConstraints.s_Cdot=new box2d.b2Vec2;box2d.b2MotorJoint.prototype.SolveVelocityConstraints.s_impulse=new box2d.b2Vec2;box2d.b2MotorJoint.prototype.SolveVelocityConstraints.s_oldImpulse=new box2d.b2Vec2;box2d.b2MotorJoint.prototype.SolvePositionConstraints=function(a){return!0};
goog.exportProperty(box2d.b2MotorJoint.prototype,"SolvePositionConstraints",box2d.b2MotorJoint.prototype.SolvePositionConstraints);
box2d.b2MotorJoint.prototype.Dump=function(){if(box2d.DEBUG){var a=this.m_bodyA.m_islandIndex,b=this.m_bodyB.m_islandIndex;box2d.b2Log("  /*box2d.b2MotorJointDef*/ var jd = new box2d.b2MotorJointDef();\n");box2d.b2Log("  jd.bodyA = bodies[%d];\n",a);box2d.b2Log("  jd.bodyB = bodies[%d];\n",b);box2d.b2Log("  jd.collideConnected = %s;\n",this.m_collideConnected?"true":"false");box2d.b2Log("  jd.linearOffset.Set(%.15f, %.15f);\n",this.m_linearOffset.x,this.m_linearOffset.y);box2d.b2Log("  jd.angularOffset = %.15f;\n",
this.m_angularOffset);box2d.b2Log("  jd.maxForce = %.15f;\n",this.m_maxForce);box2d.b2Log("  jd.maxTorque = %.15f;\n",this.m_maxTorque);box2d.b2Log("  jd.correctionFactor = %.15f;\n",this.m_correctionFactor);box2d.b2Log("  joints[%d] = this.m_world.CreateJoint(jd);\n",this.m_index)}};goog.exportProperty(box2d.b2MotorJoint.prototype,"Dump",box2d.b2MotorJoint.prototype.Dump);box2d.b2MouseJointDef=function(){box2d.b2JointDef.call(this,box2d.b2JointType.e_mouseJoint);this.target=new box2d.b2Vec2};
goog.inherits(box2d.b2MouseJointDef,box2d.b2JointDef);goog.exportSymbol("box2d.b2MouseJointDef",box2d.b2MouseJointDef);box2d.b2MouseJointDef.prototype.target=null;goog.exportProperty(box2d.b2MouseJointDef.prototype,"target",box2d.b2MouseJointDef.prototype.target);box2d.b2MouseJointDef.prototype.maxForce=0;goog.exportProperty(box2d.b2MouseJointDef.prototype,"maxForce",box2d.b2MouseJointDef.prototype.maxForce);box2d.b2MouseJointDef.prototype.frequencyHz=5;
goog.exportProperty(box2d.b2MouseJointDef.prototype,"frequencyHz",box2d.b2MouseJointDef.prototype.frequencyHz);box2d.b2MouseJointDef.prototype.dampingRatio=.7;goog.exportProperty(box2d.b2MouseJointDef.prototype,"dampingRatio",box2d.b2MouseJointDef.prototype.dampingRatio);
box2d.b2MouseJoint=function(a){box2d.b2Joint.call(this,a);this.m_localAnchorB=new box2d.b2Vec2;this.m_targetA=new box2d.b2Vec2;this.m_impulse=new box2d.b2Vec2;this.m_rB=new box2d.b2Vec2;this.m_localCenterB=new box2d.b2Vec2;this.m_mass=new box2d.b2Mat22;this.m_C=new box2d.b2Vec2;this.m_qB=new box2d.b2Rot;this.m_lalcB=new box2d.b2Vec2;this.m_K=new box2d.b2Mat22;box2d.ENABLE_ASSERTS&&box2d.b2Assert(a.target.IsValid());box2d.ENABLE_ASSERTS&&box2d.b2Assert(box2d.b2IsValid(a.maxForce)&&0<=a.maxForce);box2d.ENABLE_ASSERTS&&
box2d.b2Assert(box2d.b2IsValid(a.frequencyHz)&&0<=a.frequencyHz);box2d.ENABLE_ASSERTS&&box2d.b2Assert(box2d.b2IsValid(a.dampingRatio)&&0<=a.dampingRatio);this.m_targetA.Copy(a.target);box2d.b2MulT_X_V2(this.m_bodyB.GetTransform(),this.m_targetA,this.m_localAnchorB);this.m_maxForce=a.maxForce;this.m_impulse.SetZero();this.m_frequencyHz=a.frequencyHz;this.m_dampingRatio=a.dampingRatio;this.m_gamma=this.m_beta=0};goog.inherits(box2d.b2MouseJoint,box2d.b2Joint);
goog.exportSymbol("box2d.b2MouseJoint",box2d.b2MouseJoint);box2d.b2MouseJoint.prototype.m_localAnchorB=null;goog.exportProperty(box2d.b2MouseJoint.prototype,"m_localAnchorB",box2d.b2MouseJoint.prototype.m_localAnchorB);box2d.b2MouseJoint.prototype.m_targetA=null;goog.exportProperty(box2d.b2MouseJoint.prototype,"m_targetA",box2d.b2MouseJoint.prototype.m_targetA);box2d.b2MouseJoint.prototype.m_frequencyHz=0;goog.exportProperty(box2d.b2MouseJoint.prototype,"m_frequencyHz",box2d.b2MouseJoint.prototype.m_frequencyHz);
box2d.b2MouseJoint.prototype.m_dampingRatio=0;goog.exportProperty(box2d.b2MouseJoint.prototype,"m_dampingRatio",box2d.b2MouseJoint.prototype.m_dampingRatio);box2d.b2MouseJoint.prototype.m_beta=0;goog.exportProperty(box2d.b2MouseJoint.prototype,"m_beta",box2d.b2MouseJoint.prototype.m_beta);box2d.b2MouseJoint.prototype.m_impulse=null;goog.exportProperty(box2d.b2MouseJoint.prototype,"m_impulse",box2d.b2MouseJoint.prototype.m_impulse);box2d.b2MouseJoint.prototype.m_maxForce=0;
goog.exportProperty(box2d.b2MouseJoint.prototype,"m_maxForce",box2d.b2MouseJoint.prototype.m_maxForce);box2d.b2MouseJoint.prototype.m_gamma=0;goog.exportProperty(box2d.b2MouseJoint.prototype,"m_gamma",box2d.b2MouseJoint.prototype.m_gamma);box2d.b2MouseJoint.prototype.m_indexA=0;goog.exportProperty(box2d.b2MouseJoint.prototype,"m_indexA",box2d.b2MouseJoint.prototype.m_indexA);box2d.b2MouseJoint.prototype.m_indexB=0;goog.exportProperty(box2d.b2MouseJoint.prototype,"m_indexB",box2d.b2MouseJoint.prototype.m_indexB);
box2d.b2MouseJoint.prototype.m_rB=null;goog.exportProperty(box2d.b2MouseJoint.prototype,"m_rB",box2d.b2MouseJoint.prototype.m_rB);box2d.b2MouseJoint.prototype.m_localCenterB=null;goog.exportProperty(box2d.b2MouseJoint.prototype,"m_localCenterB",box2d.b2MouseJoint.prototype.m_localCenterB);box2d.b2MouseJoint.prototype.m_invMassB=0;goog.exportProperty(box2d.b2MouseJoint.prototype,"m_invMassB",box2d.b2MouseJoint.prototype.m_invMassB);box2d.b2MouseJoint.prototype.m_invIB=0;
goog.exportProperty(box2d.b2MouseJoint.prototype,"m_invIB",box2d.b2MouseJoint.prototype.m_invIB);box2d.b2MouseJoint.prototype.m_mass=null;goog.exportProperty(box2d.b2MouseJoint.prototype,"m_mass",box2d.b2MouseJoint.prototype.m_mass);box2d.b2MouseJoint.prototype.m_C=null;goog.exportProperty(box2d.b2MouseJoint.prototype,"m_C",box2d.b2MouseJoint.prototype.m_C);box2d.b2MouseJoint.prototype.m_qB=null;goog.exportProperty(box2d.b2MouseJoint.prototype,"m_qB",box2d.b2MouseJoint.prototype.m_qB);
box2d.b2MouseJoint.prototype.m_lalcB=null;goog.exportProperty(box2d.b2MouseJoint.prototype,"m_lalcB",box2d.b2MouseJoint.prototype.m_lalcB);box2d.b2MouseJoint.prototype.m_K=null;goog.exportProperty(box2d.b2MouseJoint.prototype,"m_K",box2d.b2MouseJoint.prototype.m_K);box2d.b2MouseJoint.prototype.SetTarget=function(a){this.m_bodyB.IsAwake()||this.m_bodyB.SetAwake(!0);this.m_targetA.Copy(a)};goog.exportProperty(box2d.b2MouseJoint.prototype,"SetTarget",box2d.b2MouseJoint.prototype.SetTarget);
box2d.b2MouseJoint.prototype.GetTarget=function(a){return a.Copy(this.m_targetA)};goog.exportProperty(box2d.b2MouseJoint.prototype,"GetTarget",box2d.b2MouseJoint.prototype.GetTarget);box2d.b2MouseJoint.prototype.SetMaxForce=function(a){this.m_maxForce=a};goog.exportProperty(box2d.b2MouseJoint.prototype,"SetMaxForce",box2d.b2MouseJoint.prototype.SetMaxForce);box2d.b2MouseJoint.prototype.GetMaxForce=function(){return this.m_maxForce};goog.exportProperty(box2d.b2MouseJoint.prototype,"GetMaxForce",box2d.b2MouseJoint.prototype.GetMaxForce);
box2d.b2MouseJoint.prototype.SetFrequency=function(a){this.m_frequencyHz=a};goog.exportProperty(box2d.b2MouseJoint.prototype,"SetFrequency",box2d.b2MouseJoint.prototype.SetFrequency);box2d.b2MouseJoint.prototype.GetFrequency=function(){return this.m_frequencyHz};goog.exportProperty(box2d.b2MouseJoint.prototype,"GetFrequency",box2d.b2MouseJoint.prototype.GetFrequency);box2d.b2MouseJoint.prototype.SetDampingRatio=function(a){this.m_dampingRatio=a};
goog.exportProperty(box2d.b2MouseJoint.prototype,"SetDampingRatio",box2d.b2MouseJoint.prototype.SetDampingRatio);box2d.b2MouseJoint.prototype.GetDampingRatio=function(){return this.m_dampingRatio};goog.exportProperty(box2d.b2MouseJoint.prototype,"GetDampingRatio",box2d.b2MouseJoint.prototype.GetDampingRatio);
box2d.b2MouseJoint.prototype.InitVelocityConstraints=function(a){this.m_indexB=this.m_bodyB.m_islandIndex;this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter);this.m_invMassB=this.m_bodyB.m_invMass;this.m_invIB=this.m_bodyB.m_invI;var b=a.positions[this.m_indexB].c,d=a.velocities[this.m_indexB].v,e=a.velocities[this.m_indexB].w,f=this.m_qB.SetAngle(a.positions[this.m_indexB].a),g=this.m_bodyB.GetMass(),k=2*box2d.b2_pi*this.m_frequencyHz,m=2*g*this.m_dampingRatio*k,g=g*k*k,k=a.step.dt;box2d.ENABLE_ASSERTS&&
box2d.b2Assert(m+k*g>box2d.b2_epsilon);this.m_gamma=k*(m+k*g);0!==this.m_gamma&&(this.m_gamma=1/this.m_gamma);this.m_beta=k*g*this.m_gamma;box2d.b2Sub_V2_V2(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB);box2d.b2Mul_R_V2(f,this.m_lalcB,this.m_rB);f=this.m_K;f.ex.x=this.m_invMassB+this.m_invIB*this.m_rB.y*this.m_rB.y+this.m_gamma;f.ex.y=-this.m_invIB*this.m_rB.x*this.m_rB.y;f.ey.x=f.ex.y;f.ey.y=this.m_invMassB+this.m_invIB*this.m_rB.x*this.m_rB.x+this.m_gamma;f.GetInverse(this.m_mass);this.m_C.x=
b.x+this.m_rB.x-this.m_targetA.x;this.m_C.y=b.y+this.m_rB.y-this.m_targetA.y;this.m_C.SelfMul(this.m_beta);e*=.98;a.step.warmStarting?(this.m_impulse.SelfMul(a.step.dtRatio),d.x+=this.m_invMassB*this.m_impulse.x,d.y+=this.m_invMassB*this.m_impulse.y,e+=this.m_invIB*box2d.b2Cross_V2_V2(this.m_rB,this.m_impulse)):this.m_impulse.SetZero();a.velocities[this.m_indexB].w=e};goog.exportProperty(box2d.b2MouseJoint.prototype,"InitVelocityConstraints",box2d.b2MouseJoint.prototype.InitVelocityConstraints);
box2d.b2MouseJoint.prototype.SolveVelocityConstraints=function(a){var b=a.velocities[this.m_indexB].v,d=a.velocities[this.m_indexB].w,e=box2d.b2AddCross_V2_S_V2(b,d,this.m_rB,box2d.b2MouseJoint.prototype.SolveVelocityConstraints.s_Cdot),e=box2d.b2Mul_M22_V2(this.m_mass,box2d.b2Add_V2_V2(e,box2d.b2Add_V2_V2(this.m_C,box2d.b2Mul_S_V2(this.m_gamma,this.m_impulse,box2d.b2Vec2.s_t0),box2d.b2Vec2.s_t0),box2d.b2Vec2.s_t0).SelfNeg(),box2d.b2MouseJoint.prototype.SolveVelocityConstraints.s_impulse),f=box2d.b2MouseJoint.prototype.SolveVelocityConstraints.s_oldImpulse.Copy(this.m_impulse);
this.m_impulse.SelfAdd(e);var g=a.step.dt*this.m_maxForce;this.m_impulse.LengthSquared()>g*g&&this.m_impulse.SelfMul(g/this.m_impulse.Length());box2d.b2Sub_V2_V2(this.m_impulse,f,e);b.SelfMulAdd(this.m_invMassB,e);d+=this.m_invIB*box2d.b2Cross_V2_V2(this.m_rB,e);a.velocities[this.m_indexB].w=d};goog.exportProperty(box2d.b2MouseJoint.prototype,"SolveVelocityConstraints",box2d.b2MouseJoint.prototype.SolveVelocityConstraints);box2d.b2MouseJoint.prototype.SolveVelocityConstraints.s_Cdot=new box2d.b2Vec2;
box2d.b2MouseJoint.prototype.SolveVelocityConstraints.s_impulse=new box2d.b2Vec2;box2d.b2MouseJoint.prototype.SolveVelocityConstraints.s_oldImpulse=new box2d.b2Vec2;box2d.b2MouseJoint.prototype.SolvePositionConstraints=function(a){return!0};goog.exportProperty(box2d.b2MouseJoint.prototype,"SolvePositionConstraints",box2d.b2MouseJoint.prototype.SolvePositionConstraints);box2d.b2MouseJoint.prototype.GetAnchorA=function(a){return a.Copy(this.m_targetA)};
goog.exportProperty(box2d.b2MouseJoint.prototype,"GetAnchorA",box2d.b2MouseJoint.prototype.GetAnchorA);box2d.b2MouseJoint.prototype.GetAnchorB=function(a){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,a)};goog.exportProperty(box2d.b2MouseJoint.prototype,"GetAnchorB",box2d.b2MouseJoint.prototype.GetAnchorB);box2d.b2MouseJoint.prototype.GetReactionForce=function(a,b){return box2d.b2Mul_S_V2(a,this.m_impulse,b)};goog.exportProperty(box2d.b2MouseJoint.prototype,"GetReactionForce",box2d.b2MouseJoint.prototype.GetReactionForce);
box2d.b2MouseJoint.prototype.GetReactionTorque=function(a){return 0};goog.exportProperty(box2d.b2MouseJoint.prototype,"GetReactionTorque",box2d.b2MouseJoint.prototype.GetReactionTorque);box2d.b2MouseJoint.prototype.Dump=function(){box2d.DEBUG&&box2d.b2Log("Mouse joint dumping is not supported.\n")};goog.exportProperty(box2d.b2MouseJoint.prototype,"Dump",box2d.b2MouseJoint.prototype.Dump);box2d.b2MouseJoint.prototype.ShiftOrigin=function(a){this.m_targetA.SelfSub(a)};
goog.exportProperty(box2d.b2MouseJoint.prototype,"ShiftOrigin",box2d.b2MouseJoint.prototype.ShiftOrigin);box2d.b2PrismaticJointDef=function(){box2d.b2JointDef.call(this,box2d.b2JointType.e_prismaticJoint);this.localAnchorA=new box2d.b2Vec2;this.localAnchorB=new box2d.b2Vec2;this.localAxisA=new box2d.b2Vec2(1,0)};goog.inherits(box2d.b2PrismaticJointDef,box2d.b2JointDef);goog.exportSymbol("box2d.b2PrismaticJointDef",box2d.b2PrismaticJointDef);box2d.b2PrismaticJointDef.prototype.localAnchorA=null;
goog.exportProperty(box2d.b2PrismaticJointDef.prototype,"localAnchorA",box2d.b2PrismaticJointDef.prototype.localAnchorA);box2d.b2PrismaticJointDef.prototype.localAnchorB=null;goog.exportProperty(box2d.b2PrismaticJointDef.prototype,"localAnchorB",box2d.b2PrismaticJointDef.prototype.localAnchorB);box2d.b2PrismaticJointDef.prototype.localAxisA=null;goog.exportProperty(box2d.b2PrismaticJointDef.prototype,"localAxisA",box2d.b2PrismaticJointDef.prototype.localAxisA);
box2d.b2PrismaticJointDef.prototype.referenceAngle=0;goog.exportProperty(box2d.b2PrismaticJointDef.prototype,"referenceAngle",box2d.b2PrismaticJointDef.prototype.referenceAngle);box2d.b2PrismaticJointDef.prototype.enableLimit=!1;goog.exportProperty(box2d.b2PrismaticJointDef.prototype,"enableLimit",box2d.b2PrismaticJointDef.prototype.enableLimit);box2d.b2PrismaticJointDef.prototype.lowerTranslation=0;goog.exportProperty(box2d.b2PrismaticJointDef.prototype,"lowerTranslation",box2d.b2PrismaticJointDef.prototype.lowerTranslation);
box2d.b2PrismaticJointDef.prototype.upperTranslation=0;goog.exportProperty(box2d.b2PrismaticJointDef.prototype,"upperTranslation",box2d.b2PrismaticJointDef.prototype.upperTranslation);box2d.b2PrismaticJointDef.prototype.enableMotor=!1;goog.exportProperty(box2d.b2PrismaticJointDef.prototype,"enableMotor",box2d.b2PrismaticJointDef.prototype.enableMotor);box2d.b2PrismaticJointDef.prototype.maxMotorForce=0;goog.exportProperty(box2d.b2PrismaticJointDef.prototype,"maxMotorForce",box2d.b2PrismaticJointDef.prototype.maxMotorForce);
box2d.b2PrismaticJointDef.prototype.motorSpeed=0;goog.exportProperty(box2d.b2PrismaticJointDef.prototype,"motorSpeed",box2d.b2PrismaticJointDef.prototype.motorSpeed);box2d.b2PrismaticJointDef.prototype.Initialize=function(a,b,d,e){this.bodyA=a;this.bodyB=b;this.bodyA.GetLocalPoint(d,this.localAnchorA);this.bodyB.GetLocalPoint(d,this.localAnchorB);this.bodyA.GetLocalVector(e,this.localAxisA);this.referenceAngle=this.bodyB.GetAngle()-this.bodyA.GetAngle()};
goog.exportProperty(box2d.b2PrismaticJointDef.prototype,"Initialize",box2d.b2PrismaticJointDef.prototype.Initialize);
box2d.b2PrismaticJoint=function(a){box2d.b2Joint.call(this,a);this.m_localAnchorA=a.localAnchorA.Clone();this.m_localAnchorB=a.localAnchorB.Clone();this.m_localXAxisA=a.localAxisA.Clone().SelfNormalize();this.m_localYAxisA=box2d.b2Cross_S_V2(1,this.m_localXAxisA,new box2d.b2Vec2);this.m_referenceAngle=a.referenceAngle;this.m_impulse=new box2d.b2Vec3(0,0,0);this.m_lowerTranslation=a.lowerTranslation;this.m_upperTranslation=a.upperTranslation;this.m_maxMotorForce=a.maxMotorForce;this.m_motorSpeed=a.motorSpeed;
this.m_enableLimit=a.enableLimit;this.m_enableMotor=a.enableMotor;this.m_localCenterA=new box2d.b2Vec2;this.m_localCenterB=new box2d.b2Vec2;this.m_axis=new box2d.b2Vec2(0,0);this.m_perp=new box2d.b2Vec2(0,0);this.m_K=new box2d.b2Mat33;this.m_K3=new box2d.b2Mat33;this.m_K2=new box2d.b2Mat22;this.m_qA=new box2d.b2Rot;this.m_qB=new box2d.b2Rot;this.m_lalcA=new box2d.b2Vec2;this.m_lalcB=new box2d.b2Vec2;this.m_rA=new box2d.b2Vec2;this.m_rB=new box2d.b2Vec2};goog.inherits(box2d.b2PrismaticJoint,box2d.b2Joint);
goog.exportSymbol("box2d.b2PrismaticJoint",box2d.b2PrismaticJoint);box2d.b2PrismaticJoint.prototype.m_localAnchorA=null;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_localAnchorA",box2d.b2PrismaticJoint.prototype.m_localAnchorA);box2d.b2PrismaticJoint.prototype.m_localAnchorB=null;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_localAnchorB",box2d.b2PrismaticJoint.prototype.m_localAnchorB);box2d.b2PrismaticJoint.prototype.m_localXAxisA=null;
goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_localXAxisA",box2d.b2PrismaticJoint.prototype.m_localXAxisA);box2d.b2PrismaticJoint.prototype.m_localYAxisA=null;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_localYAxisA",box2d.b2PrismaticJoint.prototype.m_localYAxisA);box2d.b2PrismaticJoint.prototype.m_referenceAngle=0;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_referenceAngle",box2d.b2PrismaticJoint.prototype.m_referenceAngle);
box2d.b2PrismaticJoint.prototype.m_impulse=null;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_impulse",box2d.b2PrismaticJoint.prototype.m_impulse);box2d.b2PrismaticJoint.prototype.m_motorImpulse=0;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_motorImpulse",box2d.b2PrismaticJoint.prototype.m_motorImpulse);box2d.b2PrismaticJoint.prototype.m_lowerTranslation=0;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_lowerTranslation",box2d.b2PrismaticJoint.prototype.m_lowerTranslation);
box2d.b2PrismaticJoint.prototype.m_upperTranslation=0;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_upperTranslation",box2d.b2PrismaticJoint.prototype.m_upperTranslation);box2d.b2PrismaticJoint.prototype.m_maxMotorForce=0;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_maxMotorForce",box2d.b2PrismaticJoint.prototype.m_maxMotorForce);box2d.b2PrismaticJoint.prototype.m_motorSpeed=0;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_motorSpeed",box2d.b2PrismaticJoint.prototype.m_motorSpeed);
box2d.b2PrismaticJoint.prototype.m_enableLimit=!1;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_enableLimit",box2d.b2PrismaticJoint.prototype.m_enableLimit);box2d.b2PrismaticJoint.prototype.m_enableMotor=!1;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_enableMotor",box2d.b2PrismaticJoint.prototype.m_enableMotor);box2d.b2PrismaticJoint.prototype.m_limitState=box2d.b2LimitState.e_inactiveLimit;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_limitState",box2d.b2PrismaticJoint.prototype.m_limitState);
box2d.b2PrismaticJoint.prototype.m_indexA=0;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_indexA",box2d.b2PrismaticJoint.prototype.m_indexA);box2d.b2PrismaticJoint.prototype.m_indexB=0;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_indexB",box2d.b2PrismaticJoint.prototype.m_indexB);box2d.b2PrismaticJoint.prototype.m_localCenterA=null;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_localCenterA",box2d.b2PrismaticJoint.prototype.m_localCenterA);
box2d.b2PrismaticJoint.prototype.m_localCenterB=null;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_localCenterB",box2d.b2PrismaticJoint.prototype.m_localCenterB);box2d.b2PrismaticJoint.prototype.m_invMassA=0;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_invMassA",box2d.b2PrismaticJoint.prototype.m_invMassA);box2d.b2PrismaticJoint.prototype.m_invMassB=0;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_invMassB",box2d.b2PrismaticJoint.prototype.m_invMassB);
box2d.b2PrismaticJoint.prototype.m_invIA=0;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_invIA",box2d.b2PrismaticJoint.prototype.m_invIA);box2d.b2PrismaticJoint.prototype.m_invIB=0;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_invIB",box2d.b2PrismaticJoint.prototype.m_invIB);box2d.b2PrismaticJoint.prototype.m_axis=null;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_axis",box2d.b2PrismaticJoint.prototype.m_axis);box2d.b2PrismaticJoint.prototype.m_perp=null;
goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_perp",box2d.b2PrismaticJoint.prototype.m_perp);box2d.b2PrismaticJoint.prototype.m_s1=0;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_s1",box2d.b2PrismaticJoint.prototype.m_s1);box2d.b2PrismaticJoint.prototype.m_s2=0;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_s2",box2d.b2PrismaticJoint.prototype.m_s2);box2d.b2PrismaticJoint.prototype.m_a1=0;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_a1",box2d.b2PrismaticJoint.prototype.m_a1);
box2d.b2PrismaticJoint.prototype.m_a2=0;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_a2",box2d.b2PrismaticJoint.prototype.m_a2);box2d.b2PrismaticJoint.prototype.m_K=null;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_K",box2d.b2PrismaticJoint.prototype.m_K);box2d.b2PrismaticJoint.prototype.m_K3=null;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_K3",box2d.b2PrismaticJoint.prototype.m_K3);box2d.b2PrismaticJoint.prototype.m_K2=null;
goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_K2",box2d.b2PrismaticJoint.prototype.m_K2);box2d.b2PrismaticJoint.prototype.m_motorMass=0;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_motorMass",box2d.b2PrismaticJoint.prototype.m_motorMass);box2d.b2PrismaticJoint.prototype.m_qA=null;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_qA",box2d.b2PrismaticJoint.prototype.m_qA);box2d.b2PrismaticJoint.prototype.m_qB=null;
goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_qB",box2d.b2PrismaticJoint.prototype.m_qB);box2d.b2PrismaticJoint.prototype.m_lalcA=null;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_lalcA",box2d.b2PrismaticJoint.prototype.m_lalcA);box2d.b2PrismaticJoint.prototype.m_lalcB=null;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_lalcB",box2d.b2PrismaticJoint.prototype.m_lalcB);box2d.b2PrismaticJoint.prototype.m_rA=null;
goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_rA",box2d.b2PrismaticJoint.prototype.m_rA);box2d.b2PrismaticJoint.prototype.m_rB=null;goog.exportProperty(box2d.b2PrismaticJoint.prototype,"m_rB",box2d.b2PrismaticJoint.prototype.m_rB);
box2d.b2PrismaticJoint.prototype.InitVelocityConstraints=function(a){this.m_indexA=this.m_bodyA.m_islandIndex;this.m_indexB=this.m_bodyB.m_islandIndex;this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter);this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter);this.m_invMassA=this.m_bodyA.m_invMass;this.m_invMassB=this.m_bodyB.m_invMass;this.m_invIA=this.m_bodyA.m_invI;this.m_invIB=this.m_bodyB.m_invI;var b=a.positions[this.m_indexA].c,d=a.velocities[this.m_indexA].v,e=a.velocities[this.m_indexA].w,
f=a.positions[this.m_indexB].c,g=a.positions[this.m_indexB].a,k=a.velocities[this.m_indexB].v,m=a.velocities[this.m_indexB].w,n=this.m_qA.SetAngle(a.positions[this.m_indexA].a),g=this.m_qB.SetAngle(g);box2d.b2Sub_V2_V2(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA);var q=box2d.b2Mul_R_V2(n,this.m_lalcA,this.m_rA);box2d.b2Sub_V2_V2(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB);var s=box2d.b2Mul_R_V2(g,this.m_lalcB,this.m_rB),t=box2d.b2Add_V2_V2(box2d.b2Sub_V2_V2(f,b,box2d.b2Vec2.s_t0),
box2d.b2Sub_V2_V2(s,q,box2d.b2Vec2.s_t1),box2d.b2PrismaticJoint.prototype.InitVelocityConstraints.s_d),b=this.m_invMassA,f=this.m_invMassB,g=this.m_invIA,u=this.m_invIB;box2d.b2Mul_R_V2(n,this.m_localXAxisA,this.m_axis);this.m_a1=box2d.b2Cross_V2_V2(box2d.b2Add_V2_V2(t,q,box2d.b2Vec2.s_t0),this.m_axis);this.m_a2=box2d.b2Cross_V2_V2(s,this.m_axis);this.m_motorMass=b+f+g*this.m_a1*this.m_a1+u*this.m_a2*this.m_a2;0<this.m_motorMass&&(this.m_motorMass=1/this.m_motorMass);box2d.b2Mul_R_V2(n,this.m_localYAxisA,
this.m_perp);this.m_s1=box2d.b2Cross_V2_V2(box2d.b2Add_V2_V2(t,q,box2d.b2Vec2.s_t0),this.m_perp);this.m_s2=box2d.b2Cross_V2_V2(s,this.m_perp);this.m_K.ex.x=b+f+g*this.m_s1*this.m_s1+u*this.m_s2*this.m_s2;this.m_K.ex.y=g*this.m_s1+u*this.m_s2;this.m_K.ex.z=g*this.m_s1*this.m_a1+u*this.m_s2*this.m_a2;this.m_K.ey.x=this.m_K.ex.y;this.m_K.ey.y=g+u;0===this.m_K.ey.y&&(this.m_K.ey.y=1);this.m_K.ey.z=g*this.m_a1+u*this.m_a2;this.m_K.ez.x=this.m_K.ex.z;this.m_K.ez.y=this.m_K.ey.z;this.m_K.ez.z=b+f+g*this.m_a1*
this.m_a1+u*this.m_a2*this.m_a2;this.m_enableLimit?(n=box2d.b2Dot_V2_V2(this.m_axis,t),box2d.b2Abs(this.m_upperTranslation-this.m_lowerTranslation)<2*box2d.b2_linearSlop?this.m_limitState=box2d.b2LimitState.e_equalLimits:n<=this.m_lowerTranslation?this.m_limitState!==box2d.b2LimitState.e_atLowerLimit&&(this.m_limitState=box2d.b2LimitState.e_atLowerLimit,this.m_impulse.z=0):n>=this.m_upperTranslation?this.m_limitState!==box2d.b2LimitState.e_atUpperLimit&&(this.m_limitState=box2d.b2LimitState.e_atUpperLimit,
this.m_impulse.z=0):(this.m_limitState=box2d.b2LimitState.e_inactiveLimit,this.m_impulse.z=0)):(this.m_limitState=box2d.b2LimitState.e_inactiveLimit,this.m_impulse.z=0);this.m_enableMotor||(this.m_motorImpulse=0);a.step.warmStarting?(this.m_impulse.SelfMulScalar(a.step.dtRatio),this.m_motorImpulse*=a.step.dtRatio,n=box2d.b2Add_V2_V2(box2d.b2Mul_S_V2(this.m_impulse.x,this.m_perp,box2d.b2Vec2.s_t0),box2d.b2Mul_S_V2(this.m_motorImpulse+this.m_impulse.z,this.m_axis,box2d.b2Vec2.s_t1),box2d.b2PrismaticJoint.prototype.InitVelocityConstraints.s_P),
q=this.m_impulse.x*this.m_s1+this.m_impulse.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_a1,s=this.m_impulse.x*this.m_s2+this.m_impulse.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_a2,d.SelfMulSub(b,n),e-=g*q,k.SelfMulAdd(f,n),m+=u*s):(this.m_impulse.SetZero(),this.m_motorImpulse=0);a.velocities[this.m_indexA].w=e;a.velocities[this.m_indexB].w=m};goog.exportProperty(box2d.b2PrismaticJoint.prototype,"InitVelocityConstraints",box2d.b2PrismaticJoint.prototype.InitVelocityConstraints);
box2d.b2PrismaticJoint.prototype.InitVelocityConstraints.s_d=new box2d.b2Vec2;box2d.b2PrismaticJoint.prototype.InitVelocityConstraints.s_P=new box2d.b2Vec2;
box2d.b2PrismaticJoint.prototype.SolveVelocityConstraints=function(a){var b=a.velocities[this.m_indexA].v,d=a.velocities[this.m_indexA].w,e=a.velocities[this.m_indexB].v,f=a.velocities[this.m_indexB].w,g=this.m_invMassA,k=this.m_invMassB,m=this.m_invIA,n=this.m_invIB;if(this.m_enableMotor&&this.m_limitState!==box2d.b2LimitState.e_equalLimits){var q=box2d.b2Dot_V2_V2(this.m_axis,box2d.b2Sub_V2_V2(e,b,box2d.b2Vec2.s_t0))+this.m_a2*f-this.m_a1*d,q=this.m_motorMass*(this.m_motorSpeed-q),s=this.m_motorImpulse,
t=a.step.dt*this.m_maxMotorForce;this.m_motorImpulse=box2d.b2Clamp(this.m_motorImpulse+q,-t,t);q=this.m_motorImpulse-s;s=box2d.b2Mul_S_V2(q,this.m_axis,box2d.b2PrismaticJoint.prototype.SolveVelocityConstraints.s_P);t=q*this.m_a1;q*=this.m_a2;b.SelfMulSub(g,s);d-=m*t;e.SelfMulAdd(k,s);f+=n*q}var t=box2d.b2Dot_V2_V2(this.m_perp,box2d.b2Sub_V2_V2(e,b,box2d.b2Vec2.s_t0))+this.m_s2*f-this.m_s1*d,u=f-d;this.m_enableLimit&&this.m_limitState!==box2d.b2LimitState.e_inactiveLimit?(q=box2d.b2Dot_V2_V2(this.m_axis,
box2d.b2Sub_V2_V2(e,b,box2d.b2Vec2.s_t0))+this.m_a2*f-this.m_a1*d,s=box2d.b2PrismaticJoint.prototype.SolveVelocityConstraints.s_f1.Copy(this.m_impulse),q=this.m_K.Solve33(-t,-u,-q,box2d.b2PrismaticJoint.prototype.SolveVelocityConstraints.s_df3),this.m_impulse.SelfAdd(q),this.m_limitState===box2d.b2LimitState.e_atLowerLimit?this.m_impulse.z=box2d.b2Max(this.m_impulse.z,0):this.m_limitState===box2d.b2LimitState.e_atUpperLimit&&(this.m_impulse.z=box2d.b2Min(this.m_impulse.z,0)),t=this.m_K.Solve22(-t-
(this.m_impulse.z-s.z)*this.m_K.ez.x,-u-(this.m_impulse.z-s.z)*this.m_K.ez.y,box2d.b2PrismaticJoint.prototype.SolveVelocityConstraints.s_f2r),t.x+=s.x,t.y+=s.y,this.m_impulse.x=t.x,this.m_impulse.y=t.y,q.x=this.m_impulse.x-s.x,q.y=this.m_impulse.y-s.y,q.z=this.m_impulse.z-s.z,s=box2d.b2Add_V2_V2(box2d.b2Mul_S_V2(q.x,this.m_perp,box2d.b2Vec2.s_t0),box2d.b2Mul_S_V2(q.z,this.m_axis,box2d.b2Vec2.s_t1),box2d.b2PrismaticJoint.prototype.SolveVelocityConstraints.s_P),t=q.x*this.m_s1+q.y+q.z*this.m_a1,q=q.x*
this.m_s2+q.y+q.z*this.m_a2):(q=this.m_K.Solve22(-t,-u,box2d.b2PrismaticJoint.prototype.SolveVelocityConstraints.s_df2),this.m_impulse.x+=q.x,this.m_impulse.y+=q.y,s=box2d.b2Mul_S_V2(q.x,this.m_perp,box2d.b2PrismaticJoint.prototype.SolveVelocityConstraints.s_P),t=q.x*this.m_s1+q.y,q=q.x*this.m_s2+q.y);b.SelfMulSub(g,s);d-=m*t;e.SelfMulAdd(k,s);a.velocities[this.m_indexA].w=d;a.velocities[this.m_indexB].w=f+n*q};goog.exportProperty(box2d.b2PrismaticJoint.prototype,"SolveVelocityConstraints",box2d.b2PrismaticJoint.prototype.SolveVelocityConstraints);
box2d.b2PrismaticJoint.prototype.SolveVelocityConstraints.s_P=new box2d.b2Vec2;box2d.b2PrismaticJoint.prototype.SolveVelocityConstraints.s_f2r=new box2d.b2Vec2;box2d.b2PrismaticJoint.prototype.SolveVelocityConstraints.s_f1=new box2d.b2Vec3;box2d.b2PrismaticJoint.prototype.SolveVelocityConstraints.s_df3=new box2d.b2Vec3;box2d.b2PrismaticJoint.prototype.SolveVelocityConstraints.s_df2=new box2d.b2Vec2;
box2d.b2PrismaticJoint.prototype.SolvePositionConstraints=function(a){var b=a.positions[this.m_indexA].c,d=a.positions[this.m_indexA].a,e=a.positions[this.m_indexB].c,f=a.positions[this.m_indexB].a,g=this.m_qA.SetAngle(d),k=this.m_qB.SetAngle(f),m=this.m_invMassA,n=this.m_invMassB,q=this.m_invIA,s=this.m_invIB,t=box2d.b2Mul_R_V2(g,this.m_lalcA,this.m_rA),u=box2d.b2Mul_R_V2(k,this.m_lalcB,this.m_rB),v=box2d.b2Sub_V2_V2(box2d.b2Add_V2_V2(e,u,box2d.b2Vec2.s_t0),box2d.b2Add_V2_V2(b,t,box2d.b2Vec2.s_t1),
box2d.b2PrismaticJoint.prototype.SolvePositionConstraints.s_d),y=box2d.b2Mul_R_V2(g,this.m_localXAxisA,this.m_axis),z=box2d.b2Cross_V2_V2(box2d.b2Add_V2_V2(v,t,box2d.b2Vec2.s_t0),y),k=box2d.b2Cross_V2_V2(u,y),g=box2d.b2Mul_R_V2(g,this.m_localYAxisA,this.m_perp),A=box2d.b2Cross_V2_V2(box2d.b2Add_V2_V2(v,t,box2d.b2Vec2.s_t0),g),r=box2d.b2Cross_V2_V2(u,g),D=box2d.b2PrismaticJoint.prototype.SolvePositionConstraints.s_impulse,C=box2d.b2Dot_V2_V2(g,v),B=f-d-this.m_referenceAngle,t=box2d.b2Abs(C),u=box2d.b2Abs(B),
F=!1,J=0;this.m_enableLimit&&(v=box2d.b2Dot_V2_V2(y,v),box2d.b2Abs(this.m_upperTranslation-this.m_lowerTranslation)<2*box2d.b2_linearSlop?(J=box2d.b2Clamp(v,-box2d.b2_maxLinearCorrection,box2d.b2_maxLinearCorrection),t=box2d.b2Max(t,box2d.b2Abs(v)),F=!0):v<=this.m_lowerTranslation?(J=box2d.b2Clamp(v-this.m_lowerTranslation+box2d.b2_linearSlop,-box2d.b2_maxLinearCorrection,0),t=box2d.b2Max(t,this.m_lowerTranslation-v),F=!0):v>=this.m_upperTranslation&&(J=box2d.b2Clamp(v-this.m_upperTranslation-box2d.b2_linearSlop,
0,box2d.b2_maxLinearCorrection),t=box2d.b2Max(t,v-this.m_upperTranslation),F=!0));if(F){var v=q*A+s*r,L=q*A*z+s*r*k,F=q+s;0===F&&(F=1);var G=q*z+s*k,K=m+n+q*z*z+s*k*k,P=this.m_K3;P.ex.Set(m+n+q*A*A+s*r*r,v,L);P.ey.Set(v,F,G);P.ez.Set(L,G,K);D=P.Solve33(-C,-B,-J,D)}else v=q*A+s*r,F=q+s,0===F&&(F=1),J=this.m_K2,J.ex.Set(m+n+q*A*A+s*r*r,v),J.ey.Set(v,F),C=J.Solve(-C,-B,box2d.b2PrismaticJoint.prototype.SolvePositionConstraints.s_impulse1),D.x=C.x,D.y=C.y,D.z=0;y=box2d.b2Add_V2_V2(box2d.b2Mul_S_V2(D.x,
g,box2d.b2Vec2.s_t0),box2d.b2Mul_S_V2(D.z,y,box2d.b2Vec2.s_t1),box2d.b2PrismaticJoint.prototype.SolvePositionConstraints.s_P);z=D.x*A+D.y+D.z*z;k=D.x*r+D.y+D.z*k;b.SelfMulSub(m,y);d-=q*z;e.SelfMulAdd(n,y);a.positions[this.m_indexA].a=d;a.positions[this.m_indexB].a=f+s*k;return t<=box2d.b2_linearSlop&&u<=box2d.b2_angularSlop};goog.exportProperty(box2d.b2PrismaticJoint.prototype,"SolvePositionConstraints",box2d.b2PrismaticJoint.prototype.SolvePositionConstraints);
box2d.b2PrismaticJoint.prototype.SolvePositionConstraints.s_d=new box2d.b2Vec2;box2d.b2PrismaticJoint.prototype.SolvePositionConstraints.s_impulse=new box2d.b2Vec3;box2d.b2PrismaticJoint.prototype.SolvePositionConstraints.s_impulse1=new box2d.b2Vec2;box2d.b2PrismaticJoint.prototype.SolvePositionConstraints.s_P=new box2d.b2Vec2;box2d.b2PrismaticJoint.prototype.GetAnchorA=function(a){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,a)};
goog.exportProperty(box2d.b2PrismaticJoint.prototype,"GetAnchorA",box2d.b2PrismaticJoint.prototype.GetAnchorA);box2d.b2PrismaticJoint.prototype.GetAnchorB=function(a){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,a)};goog.exportProperty(box2d.b2PrismaticJoint.prototype,"GetAnchorB",box2d.b2PrismaticJoint.prototype.GetAnchorB);
box2d.b2PrismaticJoint.prototype.GetReactionForce=function(a,b){return b.Set(a*(this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.x),a*(this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.y))};goog.exportProperty(box2d.b2PrismaticJoint.prototype,"GetReactionForce",box2d.b2PrismaticJoint.prototype.GetReactionForce);box2d.b2PrismaticJoint.prototype.GetReactionTorque=function(a){return a*this.m_impulse.y};
goog.exportProperty(box2d.b2PrismaticJoint.prototype,"GetReactionTorque",box2d.b2PrismaticJoint.prototype.GetReactionTorque);box2d.b2PrismaticJoint.prototype.GetLocalAnchorA=function(a){return a.Copy(this.m_localAnchorA)};goog.exportProperty(box2d.b2PrismaticJoint.prototype,"GetLocalAnchorA",box2d.b2PrismaticJoint.prototype.GetLocalAnchorA);box2d.b2PrismaticJoint.prototype.GetLocalAnchorB=function(a){return a.Copy(this.m_localAnchorB)};
goog.exportProperty(box2d.b2PrismaticJoint.prototype,"GetLocalAnchorB",box2d.b2PrismaticJoint.prototype.GetLocalAnchorB);box2d.b2PrismaticJoint.prototype.GetLocalAxisA=function(a){return a.Copy(this.m_localXAxisA)};goog.exportProperty(box2d.b2PrismaticJoint.prototype,"GetLocalAxisA",box2d.b2PrismaticJoint.prototype.GetLocalAxisA);box2d.b2PrismaticJoint.prototype.GetReferenceAngle=function(){return this.m_referenceAngle};goog.exportProperty(box2d.b2PrismaticJoint.prototype,"GetReferenceAngle",box2d.b2PrismaticJoint.prototype.GetReferenceAngle);
box2d.b2PrismaticJoint.prototype.GetJointTranslation=function(){var a=this.m_bodyA.GetWorldPoint(this.m_localAnchorA,box2d.b2PrismaticJoint.prototype.GetJointTranslation.s_pA),b=this.m_bodyB.GetWorldPoint(this.m_localAnchorB,box2d.b2PrismaticJoint.prototype.GetJointTranslation.s_pB),a=box2d.b2Sub_V2_V2(b,a,box2d.b2PrismaticJoint.prototype.GetJointTranslation.s_d),b=this.m_bodyA.GetWorldVector(this.m_localXAxisA,box2d.b2PrismaticJoint.prototype.GetJointTranslation.s_axis);return box2d.b2Dot_V2_V2(a,
b)};goog.exportProperty(box2d.b2PrismaticJoint.prototype,"GetJointTranslation",box2d.b2PrismaticJoint.prototype.GetJointTranslation);box2d.b2PrismaticJoint.prototype.GetJointTranslation.s_pA=new box2d.b2Vec2;box2d.b2PrismaticJoint.prototype.GetJointTranslation.s_pB=new box2d.b2Vec2;box2d.b2PrismaticJoint.prototype.GetJointTranslation.s_d=new box2d.b2Vec2;box2d.b2PrismaticJoint.prototype.GetJointTranslation.s_axis=new box2d.b2Vec2;
box2d.b2PrismaticJoint.prototype.GetJointSpeed=function(){var a=this.m_bodyA,b=this.m_bodyB;box2d.b2Sub_V2_V2(this.m_localAnchorA,a.m_sweep.localCenter,this.m_lalcA);var d=box2d.b2Mul_R_V2(a.m_xf.q,this.m_lalcA,this.m_rA);box2d.b2Sub_V2_V2(this.m_localAnchorB,b.m_sweep.localCenter,this.m_lalcB);var e=box2d.b2Mul_R_V2(b.m_xf.q,this.m_lalcB,this.m_rB),f=box2d.b2Add_V2_V2(a.m_sweep.c,d,box2d.b2Vec2.s_t0),g=box2d.b2Add_V2_V2(b.m_sweep.c,e,box2d.b2Vec2.s_t1),f=box2d.b2Sub_V2_V2(g,f,box2d.b2Vec2.s_t2),
g=a.GetWorldVector(this.m_localXAxisA,this.m_axis),k=a.m_linearVelocity,m=b.m_linearVelocity,a=a.m_angularVelocity,b=b.m_angularVelocity;return box2d.b2Dot_V2_V2(f,box2d.b2Cross_S_V2(a,g,box2d.b2Vec2.s_t0))+box2d.b2Dot_V2_V2(g,box2d.b2Sub_V2_V2(box2d.b2AddCross_V2_S_V2(m,b,e,box2d.b2Vec2.s_t0),box2d.b2AddCross_V2_S_V2(k,a,d,box2d.b2Vec2.s_t1),box2d.b2Vec2.s_t0))};goog.exportProperty(box2d.b2PrismaticJoint.prototype,"GetJointSpeed",box2d.b2PrismaticJoint.prototype.GetJointSpeed);
box2d.b2PrismaticJoint.prototype.IsLimitEnabled=function(){return this.m_enableLimit};goog.exportProperty(box2d.b2PrismaticJoint.prototype,"IsLimitEnabled",box2d.b2PrismaticJoint.prototype.IsLimitEnabled);box2d.b2PrismaticJoint.prototype.EnableLimit=function(a){a!==this.m_enableLimit&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableLimit=a,this.m_impulse.z=0)};goog.exportProperty(box2d.b2PrismaticJoint.prototype,"EnableLimit",box2d.b2PrismaticJoint.prototype.EnableLimit);
box2d.b2PrismaticJoint.prototype.GetLowerLimit=function(){return this.m_lowerTranslation};goog.exportProperty(box2d.b2PrismaticJoint.prototype,"GetLowerLimit",box2d.b2PrismaticJoint.prototype.GetLowerLimit);box2d.b2PrismaticJoint.prototype.GetUpperLimit=function(){return this.m_upperTranslation};goog.exportProperty(box2d.b2PrismaticJoint.prototype,"GetUpperLimit",box2d.b2PrismaticJoint.prototype.GetUpperLimit);
box2d.b2PrismaticJoint.prototype.SetLimits=function(a,b){if(a!==this.m_lowerTranslation||b!==this.m_upperTranslation)this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_lowerTranslation=a,this.m_upperTranslation=b,this.m_impulse.z=0};goog.exportProperty(box2d.b2PrismaticJoint.prototype,"SetLimits",box2d.b2PrismaticJoint.prototype.SetLimits);box2d.b2PrismaticJoint.prototype.IsMotorEnabled=function(){return this.m_enableMotor};
goog.exportProperty(box2d.b2PrismaticJoint.prototype,"IsMotorEnabled",box2d.b2PrismaticJoint.prototype.IsMotorEnabled);box2d.b2PrismaticJoint.prototype.EnableMotor=function(a){this.m_bodyA.SetAwake(!0);this.m_bodyB.SetAwake(!0);this.m_enableMotor=a};goog.exportProperty(box2d.b2PrismaticJoint.prototype,"EnableMotor",box2d.b2PrismaticJoint.prototype.EnableMotor);box2d.b2PrismaticJoint.prototype.SetMotorSpeed=function(a){this.m_bodyA.SetAwake(!0);this.m_bodyB.SetAwake(!0);this.m_motorSpeed=a};
goog.exportProperty(box2d.b2PrismaticJoint.prototype,"SetMotorSpeed",box2d.b2PrismaticJoint.prototype.SetMotorSpeed);box2d.b2PrismaticJoint.prototype.GetMotorSpeed=function(){return this.m_motorSpeed};goog.exportProperty(box2d.b2PrismaticJoint.prototype,"GetMotorSpeed",box2d.b2PrismaticJoint.prototype.GetMotorSpeed);box2d.b2PrismaticJoint.prototype.SetMaxMotorForce=function(a){this.m_bodyA.SetAwake(!0);this.m_bodyB.SetAwake(!0);this.m_maxMotorForce=a};
goog.exportProperty(box2d.b2PrismaticJoint.prototype,"SetMaxMotorForce",box2d.b2PrismaticJoint.prototype.SetMaxMotorForce);box2d.b2PrismaticJoint.prototype.GetMaxMotorForce=function(){return this.m_maxMotorForce};goog.exportProperty(box2d.b2PrismaticJoint.prototype,"GetMaxMotorForce",box2d.b2PrismaticJoint.prototype.GetMaxMotorForce);box2d.b2PrismaticJoint.prototype.GetMotorForce=function(a){return a*this.m_motorImpulse};goog.exportProperty(box2d.b2PrismaticJoint.prototype,"GetMotorForce",box2d.b2PrismaticJoint.prototype.GetMotorForce);
box2d.b2PrismaticJoint.prototype.Dump=function(){if(box2d.DEBUG){var a=this.m_bodyA.m_islandIndex,b=this.m_bodyB.m_islandIndex;box2d.b2Log("  /*box2d.b2PrismaticJointDef*/ var jd = new box2d.b2PrismaticJointDef();\n");box2d.b2Log("  jd.bodyA = bodies[%d];\n",a);box2d.b2Log("  jd.bodyB = bodies[%d];\n",b);box2d.b2Log("  jd.collideConnected = %s;\n",this.m_collideConnected?"true":"false");box2d.b2Log("  jd.localAnchorA.Set(%.15f, %.15f);\n",this.m_localAnchorA.x,this.m_localAnchorA.y);box2d.b2Log("  jd.localAnchorB.Set(%.15f, %.15f);\n",
this.m_localAnchorB.x,this.m_localAnchorB.y);box2d.b2Log("  jd.localAxisA.Set(%.15f, %.15f);\n",this.m_localXAxisA.x,this.m_localXAxisA.y);box2d.b2Log("  jd.referenceAngle = %.15f;\n",this.m_referenceAngle);box2d.b2Log("  jd.enableLimit = %s;\n",this.m_enableLimit?"true":"false");box2d.b2Log("  jd.lowerTranslation = %.15f;\n",this.m_lowerTranslation);box2d.b2Log("  jd.upperTranslation = %.15f;\n",this.m_upperTranslation);box2d.b2Log("  jd.enableMotor = %s;\n",this.m_enableMotor?"true":"false");box2d.b2Log("  jd.motorSpeed = %.15f;\n",
this.m_motorSpeed);box2d.b2Log("  jd.maxMotorForce = %.15f;\n",this.m_maxMotorForce);box2d.b2Log("  joints[%d] = this.m_world.CreateJoint(jd);\n",this.m_index)}};goog.exportProperty(box2d.b2PrismaticJoint.prototype,"Dump",box2d.b2PrismaticJoint.prototype.Dump);box2d.b2_minPulleyLength=2;goog.exportSymbol("box2d.b2_minPulleyLength",box2d.b2_minPulleyLength);
box2d.b2PulleyJointDef=function(){box2d.b2JointDef.call(this,box2d.b2JointType.e_pulleyJoint);this.collideConnected=!0;this.groundAnchorA=new box2d.b2Vec2(-1,1);this.groundAnchorB=new box2d.b2Vec2(1,1);this.localAnchorA=new box2d.b2Vec2(-1,0);this.localAnchorB=new box2d.b2Vec2(1,0)};goog.inherits(box2d.b2PulleyJointDef,box2d.b2JointDef);goog.exportSymbol("box2d.b2PulleyJointDef",box2d.b2PulleyJointDef);box2d.b2PulleyJointDef.prototype.groundAnchorA=null;
goog.exportProperty(box2d.b2PulleyJointDef.prototype,"groundAnchorA",box2d.b2PulleyJointDef.prototype.groundAnchorA);box2d.b2PulleyJointDef.prototype.groundAnchorB=null;goog.exportProperty(box2d.b2PulleyJointDef.prototype,"groundAnchorB",box2d.b2PulleyJointDef.prototype.groundAnchorB);box2d.b2PulleyJointDef.prototype.localAnchorA=null;goog.exportProperty(box2d.b2PulleyJointDef.prototype,"localAnchorA",box2d.b2PulleyJointDef.prototype.localAnchorA);box2d.b2PulleyJointDef.prototype.localAnchorB=null;
goog.exportProperty(box2d.b2PulleyJointDef.prototype,"localAnchorB",box2d.b2PulleyJointDef.prototype.localAnchorB);box2d.b2PulleyJointDef.prototype.lengthA=0;goog.exportProperty(box2d.b2PulleyJointDef.prototype,"lengthA",box2d.b2PulleyJointDef.prototype.lengthA);box2d.b2PulleyJointDef.prototype.lengthB=0;goog.exportProperty(box2d.b2PulleyJointDef.prototype,"lengthB",box2d.b2PulleyJointDef.prototype.lengthB);box2d.b2PulleyJointDef.prototype.ratio=1;
goog.exportProperty(box2d.b2PulleyJointDef.prototype,"ratio",box2d.b2PulleyJointDef.prototype.ratio);box2d.b2PulleyJointDef.prototype.Initialize=function(a,b,d,e,f,g,k){this.bodyA=a;this.bodyB=b;this.groundAnchorA.Copy(d);this.groundAnchorB.Copy(e);this.bodyA.GetLocalPoint(f,this.localAnchorA);this.bodyB.GetLocalPoint(g,this.localAnchorB);this.lengthA=box2d.b2Distance(f,d);this.lengthB=box2d.b2Distance(g,e);this.ratio=k;box2d.ENABLE_ASSERTS&&box2d.b2Assert(this.ratio>box2d.b2_epsilon)};
goog.exportProperty(box2d.b2PulleyJointDef.prototype,"Initialize",box2d.b2PulleyJointDef.prototype.Initialize);
box2d.b2PulleyJoint=function(a){box2d.b2Joint.call(this,a);this.m_groundAnchorA=new box2d.b2Vec2;this.m_groundAnchorB=new box2d.b2Vec2;this.m_localAnchorA=new box2d.b2Vec2;this.m_localAnchorB=new box2d.b2Vec2;this.m_uA=new box2d.b2Vec2;this.m_uB=new box2d.b2Vec2;this.m_rA=new box2d.b2Vec2;this.m_rB=new box2d.b2Vec2;this.m_localCenterA=new box2d.b2Vec2;this.m_localCenterB=new box2d.b2Vec2;this.m_qA=new box2d.b2Rot;this.m_qB=new box2d.b2Rot;this.m_lalcA=new box2d.b2Vec2;this.m_lalcB=new box2d.b2Vec2;
this.m_groundAnchorA.Copy(a.groundAnchorA);this.m_groundAnchorB.Copy(a.groundAnchorB);this.m_localAnchorA.Copy(a.localAnchorA);this.m_localAnchorB.Copy(a.localAnchorB);this.m_lengthA=a.lengthA;this.m_lengthB=a.lengthB;box2d.ENABLE_ASSERTS&&box2d.b2Assert(0!==a.ratio);this.m_ratio=a.ratio;this.m_constant=a.lengthA+this.m_ratio*a.lengthB;this.m_impulse=0};goog.inherits(box2d.b2PulleyJoint,box2d.b2Joint);goog.exportSymbol("box2d.b2PulleyJoint",box2d.b2PulleyJoint);
box2d.b2PulleyJoint.prototype.m_groundAnchorA=null;goog.exportProperty(box2d.b2PulleyJoint.prototype,"m_groundAnchorA",box2d.b2PulleyJoint.prototype.m_groundAnchorA);box2d.b2PulleyJoint.prototype.m_groundAnchorB=null;goog.exportProperty(box2d.b2PulleyJoint.prototype,"m_groundAnchorB",box2d.b2PulleyJoint.prototype.m_groundAnchorB);box2d.b2PulleyJoint.prototype.m_lengthA=0;goog.exportProperty(box2d.b2PulleyJoint.prototype,"m_lengthA",box2d.b2PulleyJoint.prototype.m_lengthA);
box2d.b2PulleyJoint.prototype.m_lengthB=0;goog.exportProperty(box2d.b2PulleyJoint.prototype,"m_lengthB",box2d.b2PulleyJoint.prototype.m_lengthB);box2d.b2PulleyJoint.prototype.m_localAnchorA=null;goog.exportProperty(box2d.b2PulleyJoint.prototype,"m_localAnchorA",box2d.b2PulleyJoint.prototype.m_localAnchorA);box2d.b2PulleyJoint.prototype.m_localAnchorB=null;goog.exportProperty(box2d.b2PulleyJoint.prototype,"m_localAnchorB",box2d.b2PulleyJoint.prototype.m_localAnchorB);
box2d.b2PulleyJoint.prototype.m_constant=0;goog.exportProperty(box2d.b2PulleyJoint.prototype,"m_constant",box2d.b2PulleyJoint.prototype.m_constant);box2d.b2PulleyJoint.prototype.m_ratio=0;goog.exportProperty(box2d.b2PulleyJoint.prototype,"m_ratio",box2d.b2PulleyJoint.prototype.m_ratio);box2d.b2PulleyJoint.prototype.m_impulse=0;goog.exportProperty(box2d.b2PulleyJoint.prototype,"m_impulse",box2d.b2PulleyJoint.prototype.m_impulse);box2d.b2PulleyJoint.prototype.m_indexA=0;
goog.exportProperty(box2d.b2PulleyJoint.prototype,"m_indexA",box2d.b2PulleyJoint.prototype.m_indexA);box2d.b2PulleyJoint.prototype.m_indexB=0;goog.exportProperty(box2d.b2PulleyJoint.prototype,"m_indexB",box2d.b2PulleyJoint.prototype.m_indexB);box2d.b2PulleyJoint.prototype.m_uA=null;goog.exportProperty(box2d.b2PulleyJoint.prototype,"m_uA",box2d.b2PulleyJoint.prototype.m_uA);box2d.b2PulleyJoint.prototype.m_uB=null;goog.exportProperty(box2d.b2PulleyJoint.prototype,"m_uB",box2d.b2PulleyJoint.prototype.m_uB);
box2d.b2PulleyJoint.prototype.m_rA=null;goog.exportProperty(box2d.b2PulleyJoint.prototype,"m_rA",box2d.b2PulleyJoint.prototype.m_rA);box2d.b2PulleyJoint.prototype.m_rB=null;goog.exportProperty(box2d.b2PulleyJoint.prototype,"m_rB",box2d.b2PulleyJoint.prototype.m_rB);box2d.b2PulleyJoint.prototype.m_localCenterA=null;goog.exportProperty(box2d.b2PulleyJoint.prototype,"m_localCenterA",box2d.b2PulleyJoint.prototype.m_localCenterA);box2d.b2PulleyJoint.prototype.m_localCenterB=null;
goog.exportProperty(box2d.b2PulleyJoint.prototype,"m_localCenterB",box2d.b2PulleyJoint.prototype.m_localCenterB);box2d.b2PulleyJoint.prototype.m_invMassA=0;goog.exportProperty(box2d.b2PulleyJoint.prototype,"m_invMassA",box2d.b2PulleyJoint.prototype.m_invMassA);box2d.b2PulleyJoint.prototype.m_invMassB=0;goog.exportProperty(box2d.b2PulleyJoint.prototype,"m_invMassB",box2d.b2PulleyJoint.prototype.m_invMassB);box2d.b2PulleyJoint.prototype.m_invIA=0;
goog.exportProperty(box2d.b2PulleyJoint.prototype,"m_invIA",box2d.b2PulleyJoint.prototype.m_invIA);box2d.b2PulleyJoint.prototype.m_invIB=0;goog.exportProperty(box2d.b2PulleyJoint.prototype,"m_invIB",box2d.b2PulleyJoint.prototype.m_invIB);box2d.b2PulleyJoint.prototype.m_mass=0;goog.exportProperty(box2d.b2PulleyJoint.prototype,"m_mass",box2d.b2PulleyJoint.prototype.m_mass);box2d.b2PulleyJoint.prototype.m_qA=null;goog.exportProperty(box2d.b2PulleyJoint.prototype,"m_qA",box2d.b2PulleyJoint.prototype.m_qA);
box2d.b2PulleyJoint.prototype.m_qB=null;goog.exportProperty(box2d.b2PulleyJoint.prototype,"m_qB",box2d.b2PulleyJoint.prototype.m_qB);box2d.b2PulleyJoint.prototype.m_lalcA=null;goog.exportProperty(box2d.b2PulleyJoint.prototype,"m_lalcA",box2d.b2PulleyJoint.prototype.m_lalcA);box2d.b2PulleyJoint.prototype.m_lalcB=null;goog.exportProperty(box2d.b2PulleyJoint.prototype,"m_lalcB",box2d.b2PulleyJoint.prototype.m_lalcB);
box2d.b2PulleyJoint.prototype.InitVelocityConstraints=function(a){this.m_indexA=this.m_bodyA.m_islandIndex;this.m_indexB=this.m_bodyB.m_islandIndex;this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter);this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter);this.m_invMassA=this.m_bodyA.m_invMass;this.m_invMassB=this.m_bodyB.m_invMass;this.m_invIA=this.m_bodyA.m_invI;this.m_invIB=this.m_bodyB.m_invI;var b=a.positions[this.m_indexA].c,d=a.velocities[this.m_indexA].v,e=a.velocities[this.m_indexA].w,
f=a.positions[this.m_indexB].c,g=a.positions[this.m_indexB].a,k=a.velocities[this.m_indexB].v,m=a.velocities[this.m_indexB].w,n=this.m_qA.SetAngle(a.positions[this.m_indexA].a),g=this.m_qB.SetAngle(g);box2d.b2Sub_V2_V2(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA);box2d.b2Mul_R_V2(n,this.m_lalcA,this.m_rA);box2d.b2Sub_V2_V2(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB);box2d.b2Mul_R_V2(g,this.m_lalcB,this.m_rB);this.m_uA.Copy(b).SelfAdd(this.m_rA).SelfSub(this.m_groundAnchorA);this.m_uB.Copy(f).SelfAdd(this.m_rB).SelfSub(this.m_groundAnchorB);
b=this.m_uA.Length();f=this.m_uB.Length();b>10*box2d.b2_linearSlop?this.m_uA.SelfMul(1/b):this.m_uA.SetZero();f>10*box2d.b2_linearSlop?this.m_uB.SelfMul(1/f):this.m_uB.SetZero();b=box2d.b2Cross_V2_V2(this.m_rA,this.m_uA);f=box2d.b2Cross_V2_V2(this.m_rB,this.m_uB);this.m_mass=this.m_invMassA+this.m_invIA*b*b+this.m_ratio*this.m_ratio*(this.m_invMassB+this.m_invIB*f*f);0<this.m_mass&&(this.m_mass=1/this.m_mass);a.step.warmStarting?(this.m_impulse*=a.step.dtRatio,b=box2d.b2Mul_S_V2(-this.m_impulse,this.m_uA,
box2d.b2PulleyJoint.prototype.InitVelocityConstraints.s_PA),f=box2d.b2Mul_S_V2(-this.m_ratio*this.m_impulse,this.m_uB,box2d.b2PulleyJoint.prototype.InitVelocityConstraints.s_PB),d.SelfMulAdd(this.m_invMassA,b),e+=this.m_invIA*box2d.b2Cross_V2_V2(this.m_rA,b),k.SelfMulAdd(this.m_invMassB,f),m+=this.m_invIB*box2d.b2Cross_V2_V2(this.m_rB,f)):this.m_impulse=0;a.velocities[this.m_indexA].w=e;a.velocities[this.m_indexB].w=m};goog.exportProperty(box2d.b2PulleyJoint.prototype,"InitVelocityConstraints",box2d.b2PulleyJoint.prototype.InitVelocityConstraints);
box2d.b2PulleyJoint.prototype.InitVelocityConstraints.s_PA=new box2d.b2Vec2;box2d.b2PulleyJoint.prototype.InitVelocityConstraints.s_PB=new box2d.b2Vec2;
box2d.b2PulleyJoint.prototype.SolveVelocityConstraints=function(a){var b=a.velocities[this.m_indexA].v,d=a.velocities[this.m_indexA].w,e=a.velocities[this.m_indexB].v,f=a.velocities[this.m_indexB].w,g=box2d.b2AddCross_V2_S_V2(b,d,this.m_rA,box2d.b2PulleyJoint.prototype.SolveVelocityConstraints.s_vpA),k=box2d.b2AddCross_V2_S_V2(e,f,this.m_rB,box2d.b2PulleyJoint.prototype.SolveVelocityConstraints.s_vpB),g=-box2d.b2Dot_V2_V2(this.m_uA,g)-this.m_ratio*box2d.b2Dot_V2_V2(this.m_uB,k),k=-this.m_mass*g;this.m_impulse+=
k;g=box2d.b2Mul_S_V2(-k,this.m_uA,box2d.b2PulleyJoint.prototype.SolveVelocityConstraints.s_PA);k=box2d.b2Mul_S_V2(-this.m_ratio*k,this.m_uB,box2d.b2PulleyJoint.prototype.SolveVelocityConstraints.s_PB);b.SelfMulAdd(this.m_invMassA,g);d+=this.m_invIA*box2d.b2Cross_V2_V2(this.m_rA,g);e.SelfMulAdd(this.m_invMassB,k);f+=this.m_invIB*box2d.b2Cross_V2_V2(this.m_rB,k);a.velocities[this.m_indexA].w=d;a.velocities[this.m_indexB].w=f};
goog.exportProperty(box2d.b2PulleyJoint.prototype,"SolveVelocityConstraints",box2d.b2PulleyJoint.prototype.SolveVelocityConstraints);box2d.b2PulleyJoint.prototype.SolveVelocityConstraints.s_vpA=new box2d.b2Vec2;box2d.b2PulleyJoint.prototype.SolveVelocityConstraints.s_vpB=new box2d.b2Vec2;box2d.b2PulleyJoint.prototype.SolveVelocityConstraints.s_PA=new box2d.b2Vec2;box2d.b2PulleyJoint.prototype.SolveVelocityConstraints.s_PB=new box2d.b2Vec2;
box2d.b2PulleyJoint.prototype.SolvePositionConstraints=function(a){var b=a.positions[this.m_indexA].c,d=a.positions[this.m_indexA].a,e=a.positions[this.m_indexB].c,f=a.positions[this.m_indexB].a,g=this.m_qA.SetAngle(d),k=this.m_qB.SetAngle(f);box2d.b2Sub_V2_V2(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA);g=box2d.b2Mul_R_V2(g,this.m_lalcA,this.m_rA);box2d.b2Sub_V2_V2(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB);var k=box2d.b2Mul_R_V2(k,this.m_lalcB,this.m_rB),m=this.m_uA.Copy(b).SelfAdd(g).SelfSub(this.m_groundAnchorA),
n=this.m_uB.Copy(e).SelfAdd(k).SelfSub(this.m_groundAnchorB),q=m.Length(),s=n.Length();q>10*box2d.b2_linearSlop?m.SelfMul(1/q):m.SetZero();s>10*box2d.b2_linearSlop?n.SelfMul(1/s):n.SetZero();var t=box2d.b2Cross_V2_V2(g,m),u=box2d.b2Cross_V2_V2(k,n),t=this.m_invMassA+this.m_invIA*t*t+this.m_ratio*this.m_ratio*(this.m_invMassB+this.m_invIB*u*u);0<t&&(t=1/t);s=this.m_constant-q-this.m_ratio*s;q=box2d.b2Abs(s);s*=-t;m=box2d.b2Mul_S_V2(-s,m,box2d.b2PulleyJoint.prototype.SolvePositionConstraints.s_PA);
n=box2d.b2Mul_S_V2(-this.m_ratio*s,n,box2d.b2PulleyJoint.prototype.SolvePositionConstraints.s_PB);b.SelfMulAdd(this.m_invMassA,m);d+=this.m_invIA*box2d.b2Cross_V2_V2(g,m);e.SelfMulAdd(this.m_invMassB,n);f+=this.m_invIB*box2d.b2Cross_V2_V2(k,n);a.positions[this.m_indexA].a=d;a.positions[this.m_indexB].a=f;return q<box2d.b2_linearSlop};goog.exportProperty(box2d.b2PulleyJoint.prototype,"SolvePositionConstraints",box2d.b2PulleyJoint.prototype.SolvePositionConstraints);
box2d.b2PulleyJoint.prototype.SolvePositionConstraints.s_PA=new box2d.b2Vec2;box2d.b2PulleyJoint.prototype.SolvePositionConstraints.s_PB=new box2d.b2Vec2;box2d.b2PulleyJoint.prototype.GetAnchorA=function(a){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,a)};goog.exportProperty(box2d.b2PulleyJoint.prototype,"GetAnchorA",box2d.b2PulleyJoint.prototype.GetAnchorA);box2d.b2PulleyJoint.prototype.GetAnchorB=function(a){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,a)};
goog.exportProperty(box2d.b2PulleyJoint.prototype,"GetAnchorB",box2d.b2PulleyJoint.prototype.GetAnchorB);box2d.b2PulleyJoint.prototype.GetReactionForce=function(a,b){return b.Set(a*this.m_impulse*this.m_uB.x,a*this.m_impulse*this.m_uB.y)};goog.exportProperty(box2d.b2PulleyJoint.prototype,"GetReactionForce",box2d.b2PulleyJoint.prototype.GetReactionForce);box2d.b2PulleyJoint.prototype.GetReactionTorque=function(a){return 0};goog.exportProperty(box2d.b2PulleyJoint.prototype,"GetReactionTorque",box2d.b2PulleyJoint.prototype.GetReactionTorque);
box2d.b2PulleyJoint.prototype.GetGroundAnchorA=function(a){return a.Copy(this.m_groundAnchorA)};goog.exportProperty(box2d.b2PulleyJoint.prototype,"GetGroundAnchorA",box2d.b2PulleyJoint.prototype.GetGroundAnchorA);box2d.b2PulleyJoint.prototype.GetGroundAnchorB=function(a){return a.Copy(this.m_groundAnchorB)};goog.exportProperty(box2d.b2PulleyJoint.prototype,"GetGroundAnchorB",box2d.b2PulleyJoint.prototype.GetGroundAnchorB);box2d.b2PulleyJoint.prototype.GetLengthA=function(){return this.m_lengthA};
goog.exportProperty(box2d.b2PulleyJoint.prototype,"GetLengthA",box2d.b2PulleyJoint.prototype.GetLengthA);box2d.b2PulleyJoint.prototype.GetLengthB=function(){return this.m_lengthB};goog.exportProperty(box2d.b2PulleyJoint.prototype,"GetLengthB",box2d.b2PulleyJoint.prototype.GetLengthB);box2d.b2PulleyJoint.prototype.GetRatio=function(){return this.m_ratio};goog.exportProperty(box2d.b2PulleyJoint.prototype,"GetRatio",box2d.b2PulleyJoint.prototype.GetRatio);
box2d.b2PulleyJoint.prototype.GetCurrentLengthA=function(){var a=this.m_bodyA.GetWorldPoint(this.m_localAnchorA,box2d.b2PulleyJoint.prototype.GetCurrentLengthA.s_p);return box2d.b2Distance(a,this.m_groundAnchorA)};goog.exportProperty(box2d.b2PulleyJoint.prototype,"GetCurrentLengthA",box2d.b2PulleyJoint.prototype.GetCurrentLengthA);box2d.b2PulleyJoint.prototype.GetCurrentLengthA.s_p=new box2d.b2Vec2;
box2d.b2PulleyJoint.prototype.GetCurrentLengthB=function(){var a=this.m_bodyB.GetWorldPoint(this.m_localAnchorB,box2d.b2PulleyJoint.prototype.GetCurrentLengthB.s_p);return box2d.b2Distance(a,this.m_groundAnchorB)};goog.exportProperty(box2d.b2PulleyJoint.prototype,"GetCurrentLengthB",box2d.b2PulleyJoint.prototype.GetCurrentLengthB);box2d.b2PulleyJoint.prototype.GetCurrentLengthB.s_p=new box2d.b2Vec2;
box2d.b2PulleyJoint.prototype.Dump=function(){if(box2d.DEBUG){var a=this.m_bodyA.m_islandIndex,b=this.m_bodyB.m_islandIndex;box2d.b2Log("  /*box2d.b2PulleyJointDef*/ var jd = new box2d.b2PulleyJointDef();\n");box2d.b2Log("  jd.bodyA = bodies[%d];\n",a);box2d.b2Log("  jd.bodyB = bodies[%d];\n",b);box2d.b2Log("  jd.collideConnected = %s;\n",this.m_collideConnected?"true":"false");box2d.b2Log("  jd.groundAnchorA.Set(%.15f, %.15f);\n",this.m_groundAnchorA.x,this.m_groundAnchorA.y);box2d.b2Log("  jd.groundAnchorB.Set(%.15f, %.15f);\n",
this.m_groundAnchorB.x,this.m_groundAnchorB.y);box2d.b2Log("  jd.localAnchorA.Set(%.15f, %.15f);\n",this.m_localAnchorA.x,this.m_localAnchorA.y);box2d.b2Log("  jd.localAnchorB.Set(%.15f, %.15f);\n",this.m_localAnchorB.x,this.m_localAnchorB.y);box2d.b2Log("  jd.lengthA = %.15f;\n",this.m_lengthA);box2d.b2Log("  jd.lengthB = %.15f;\n",this.m_lengthB);box2d.b2Log("  jd.ratio = %.15f;\n",this.m_ratio);box2d.b2Log("  joints[%d] = this.m_world.CreateJoint(jd);\n",this.m_index)}};
goog.exportProperty(box2d.b2PulleyJoint.prototype,"Dump",box2d.b2PulleyJoint.prototype.Dump);box2d.b2PulleyJoint.prototype.ShiftOrigin=function(a){this.m_groundAnchorA.SelfSub(a);this.m_groundAnchorB.SelfSub(a)};goog.exportProperty(box2d.b2PulleyJoint.prototype,"ShiftOrigin",box2d.b2PulleyJoint.prototype.ShiftOrigin);box2d.b2RevoluteJointDef=function(){box2d.b2JointDef.call(this,box2d.b2JointType.e_revoluteJoint);this.localAnchorA=new box2d.b2Vec2(0,0);this.localAnchorB=new box2d.b2Vec2(0,0)};
goog.inherits(box2d.b2RevoluteJointDef,box2d.b2JointDef);goog.exportSymbol("box2d.b2RevoluteJointDef",box2d.b2RevoluteJointDef);box2d.b2RevoluteJointDef.prototype.localAnchorA=null;goog.exportProperty(box2d.b2RevoluteJointDef.prototype,"localAnchorA",box2d.b2RevoluteJointDef.prototype.localAnchorA);box2d.b2RevoluteJointDef.prototype.localAnchorB=null;goog.exportProperty(box2d.b2RevoluteJointDef.prototype,"localAnchorB",box2d.b2RevoluteJointDef.prototype.localAnchorB);
box2d.b2RevoluteJointDef.prototype.referenceAngle=0;goog.exportProperty(box2d.b2RevoluteJointDef.prototype,"referenceAngle",box2d.b2RevoluteJointDef.prototype.referenceAngle);box2d.b2RevoluteJointDef.prototype.enableLimit=!1;goog.exportProperty(box2d.b2RevoluteJointDef.prototype,"enableLimit",box2d.b2RevoluteJointDef.prototype.enableLimit);box2d.b2RevoluteJointDef.prototype.lowerAngle=0;goog.exportProperty(box2d.b2RevoluteJointDef.prototype,"lowerAngle",box2d.b2RevoluteJointDef.prototype.lowerAngle);
box2d.b2RevoluteJointDef.prototype.upperAngle=0;goog.exportProperty(box2d.b2RevoluteJointDef.prototype,"upperAngle",box2d.b2RevoluteJointDef.prototype.upperAngle);box2d.b2RevoluteJointDef.prototype.enableMotor=!1;goog.exportProperty(box2d.b2RevoluteJointDef.prototype,"enableMotor",box2d.b2RevoluteJointDef.prototype.enableMotor);box2d.b2RevoluteJointDef.prototype.motorSpeed=0;goog.exportProperty(box2d.b2RevoluteJointDef.prototype,"motorSpeed",box2d.b2RevoluteJointDef.prototype.motorSpeed);
box2d.b2RevoluteJointDef.prototype.maxMotorTorque=0;goog.exportProperty(box2d.b2RevoluteJointDef.prototype,"maxMotorTorque",box2d.b2RevoluteJointDef.prototype.maxMotorTorque);box2d.b2RevoluteJointDef.prototype.Initialize=function(a,b,d){this.bodyA=a;this.bodyB=b;this.bodyA.GetLocalPoint(d,this.localAnchorA);this.bodyB.GetLocalPoint(d,this.localAnchorB);this.referenceAngle=this.bodyB.GetAngle()-this.bodyA.GetAngle()};goog.exportProperty(box2d.b2RevoluteJointDef.prototype,"Initialize",box2d.b2RevoluteJointDef.prototype.Initialize);
box2d.b2RevoluteJoint=function(a){box2d.b2Joint.call(this,a);this.m_localAnchorA=new box2d.b2Vec2;this.m_localAnchorB=new box2d.b2Vec2;this.m_impulse=new box2d.b2Vec3;this.m_rA=new box2d.b2Vec2;this.m_rB=new box2d.b2Vec2;this.m_localCenterA=new box2d.b2Vec2;this.m_localCenterB=new box2d.b2Vec2;this.m_mass=new box2d.b2Mat33;this.m_qA=new box2d.b2Rot;this.m_qB=new box2d.b2Rot;this.m_lalcA=new box2d.b2Vec2;this.m_lalcB=new box2d.b2Vec2;this.m_K=new box2d.b2Mat22;this.m_localAnchorA.Copy(a.localAnchorA);
this.m_localAnchorB.Copy(a.localAnchorB);this.m_referenceAngle=a.referenceAngle;this.m_impulse.SetZero();this.m_motorImpulse=0;this.m_lowerAngle=a.lowerAngle;this.m_upperAngle=a.upperAngle;this.m_maxMotorTorque=a.maxMotorTorque;this.m_motorSpeed=a.motorSpeed;this.m_enableLimit=a.enableLimit;this.m_enableMotor=a.enableMotor;this.m_limitState=box2d.b2LimitState.e_inactiveLimit};goog.inherits(box2d.b2RevoluteJoint,box2d.b2Joint);goog.exportSymbol("box2d.b2RevoluteJoint",box2d.b2RevoluteJoint);
box2d.b2RevoluteJoint.prototype.m_localAnchorA=null;goog.exportProperty(box2d.b2RevoluteJoint.prototype,"m_localAnchorA",box2d.b2RevoluteJoint.prototype.m_localAnchorA);box2d.b2RevoluteJoint.prototype.m_localAnchorB=null;goog.exportProperty(box2d.b2RevoluteJoint.prototype,"m_localAnchorB",box2d.b2RevoluteJoint.prototype.m_localAnchorB);box2d.b2RevoluteJoint.prototype.m_impulse=null;goog.exportProperty(box2d.b2RevoluteJoint.prototype,"m_impulse",box2d.b2RevoluteJoint.prototype.m_impulse);
box2d.b2RevoluteJoint.prototype.m_motorImpulse=0;goog.exportProperty(box2d.b2RevoluteJoint.prototype,"m_motorImpulse",box2d.b2RevoluteJoint.prototype.m_motorImpulse);box2d.b2RevoluteJoint.prototype.m_enableMotor=!1;goog.exportProperty(box2d.b2RevoluteJoint.prototype,"m_enableMotor",box2d.b2RevoluteJoint.prototype.m_enableMotor);box2d.b2RevoluteJoint.prototype.m_maxMotorTorque=0;goog.exportProperty(box2d.b2RevoluteJoint.prototype,"m_maxMotorTorque",box2d.b2RevoluteJoint.prototype.m_maxMotorTorque);
box2d.b2RevoluteJoint.prototype.m_motorSpeed=0;goog.exportProperty(box2d.b2RevoluteJoint.prototype,"m_motorSpeed",box2d.b2RevoluteJoint.prototype.m_motorSpeed);box2d.b2RevoluteJoint.prototype.m_enableLimit=!1;goog.exportProperty(box2d.b2RevoluteJoint.prototype,"m_enableLimit",box2d.b2RevoluteJoint.prototype.m_enableLimit);box2d.b2RevoluteJoint.prototype.m_referenceAngle=0;goog.exportProperty(box2d.b2RevoluteJoint.prototype,"m_referenceAngle",box2d.b2RevoluteJoint.prototype.m_referenceAngle);
box2d.b2RevoluteJoint.prototype.m_lowerAngle=0;goog.exportProperty(box2d.b2RevoluteJoint.prototype,"m_lowerAngle",box2d.b2RevoluteJoint.prototype.m_lowerAngle);box2d.b2RevoluteJoint.prototype.m_upperAngle=0;goog.exportProperty(box2d.b2RevoluteJoint.prototype,"m_upperAngle",box2d.b2RevoluteJoint.prototype.m_upperAngle);box2d.b2RevoluteJoint.prototype.m_indexA=0;goog.exportProperty(box2d.b2RevoluteJoint.prototype,"m_indexA",box2d.b2RevoluteJoint.prototype.m_indexA);
box2d.b2RevoluteJoint.prototype.m_indexB=0;goog.exportProperty(box2d.b2RevoluteJoint.prototype,"m_indexB",box2d.b2RevoluteJoint.prototype.m_indexB);box2d.b2RevoluteJoint.prototype.m_rA=null;goog.exportProperty(box2d.b2RevoluteJoint.prototype,"m_rA",box2d.b2RevoluteJoint.prototype.m_rA);box2d.b2RevoluteJoint.prototype.m_rB=null;goog.exportProperty(box2d.b2RevoluteJoint.prototype,"m_rB",box2d.b2RevoluteJoint.prototype.m_rB);box2d.b2RevoluteJoint.prototype.m_localCenterA=null;
goog.exportProperty(box2d.b2RevoluteJoint.prototype,"m_localCenterA",box2d.b2RevoluteJoint.prototype.m_localCenterA);box2d.b2RevoluteJoint.prototype.m_localCenterB=null;goog.exportProperty(box2d.b2RevoluteJoint.prototype,"m_localCenterB",box2d.b2RevoluteJoint.prototype.m_localCenterB);box2d.b2RevoluteJoint.prototype.m_invMassA=0;goog.exportProperty(box2d.b2RevoluteJoint.prototype,"m_invMassA",box2d.b2RevoluteJoint.prototype.m_invMassA);box2d.b2RevoluteJoint.prototype.m_invMassB=0;
goog.exportProperty(box2d.b2RevoluteJoint.prototype,"m_invMassB",box2d.b2RevoluteJoint.prototype.m_invMassB);box2d.b2RevoluteJoint.prototype.m_invIA=0;goog.exportProperty(box2d.b2RevoluteJoint.prototype,"m_invIA",box2d.b2RevoluteJoint.prototype.m_invIA);box2d.b2RevoluteJoint.prototype.m_invIB=0;goog.exportProperty(box2d.b2RevoluteJoint.prototype,"m_invIB",box2d.b2RevoluteJoint.prototype.m_invIB);box2d.b2RevoluteJoint.prototype.m_mass=null;
goog.exportProperty(box2d.b2RevoluteJoint.prototype,"m_mass",box2d.b2RevoluteJoint.prototype.m_mass);box2d.b2RevoluteJoint.prototype.m_motorMass=0;goog.exportProperty(box2d.b2RevoluteJoint.prototype,"m_motorMass",box2d.b2RevoluteJoint.prototype.m_motorMass);box2d.b2RevoluteJoint.prototype.m_limitState=box2d.b2LimitState.e_inactiveLimit;goog.exportProperty(box2d.b2RevoluteJoint.prototype,"m_limitState",box2d.b2RevoluteJoint.prototype.m_limitState);box2d.b2RevoluteJoint.prototype.m_qA=null;
goog.exportProperty(box2d.b2RevoluteJoint.prototype,"m_qA",box2d.b2RevoluteJoint.prototype.m_qA);box2d.b2RevoluteJoint.prototype.m_qB=null;goog.exportProperty(box2d.b2RevoluteJoint.prototype,"m_qB",box2d.b2RevoluteJoint.prototype.m_qB);box2d.b2RevoluteJoint.prototype.m_lalcA=null;goog.exportProperty(box2d.b2RevoluteJoint.prototype,"m_lalcA",box2d.b2RevoluteJoint.prototype.m_lalcA);box2d.b2RevoluteJoint.prototype.m_lalcB=null;goog.exportProperty(box2d.b2RevoluteJoint.prototype,"m_lalcB",box2d.b2RevoluteJoint.prototype.m_lalcB);
box2d.b2RevoluteJoint.prototype.m_K=null;goog.exportProperty(box2d.b2RevoluteJoint.prototype,"m_K",box2d.b2RevoluteJoint.prototype.m_K);
box2d.b2RevoluteJoint.prototype.InitVelocityConstraints=function(a){this.m_indexA=this.m_bodyA.m_islandIndex;this.m_indexB=this.m_bodyB.m_islandIndex;this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter);this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter);this.m_invMassA=this.m_bodyA.m_invMass;this.m_invMassB=this.m_bodyB.m_invMass;this.m_invIA=this.m_bodyA.m_invI;this.m_invIB=this.m_bodyB.m_invI;var b=a.positions[this.m_indexA].a,d=a.velocities[this.m_indexA].v,e=a.velocities[this.m_indexA].w,
f=a.positions[this.m_indexB].a,g=a.velocities[this.m_indexB].v,k=a.velocities[this.m_indexB].w,m=this.m_qA.SetAngle(b),n=this.m_qB.SetAngle(f);box2d.b2Sub_V2_V2(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA);box2d.b2Mul_R_V2(m,this.m_lalcA,this.m_rA);box2d.b2Sub_V2_V2(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB);box2d.b2Mul_R_V2(n,this.m_lalcB,this.m_rB);var m=this.m_invMassA,n=this.m_invMassB,q=this.m_invIA,s=this.m_invIB,t=0===q+s;this.m_mass.ex.x=m+n+this.m_rA.y*this.m_rA.y*q+this.m_rB.y*
this.m_rB.y*s;this.m_mass.ey.x=-this.m_rA.y*this.m_rA.x*q-this.m_rB.y*this.m_rB.x*s;this.m_mass.ez.x=-this.m_rA.y*q-this.m_rB.y*s;this.m_mass.ex.y=this.m_mass.ey.x;this.m_mass.ey.y=m+n+this.m_rA.x*this.m_rA.x*q+this.m_rB.x*this.m_rB.x*s;this.m_mass.ez.y=this.m_rA.x*q+this.m_rB.x*s;this.m_mass.ex.z=this.m_mass.ez.x;this.m_mass.ey.z=this.m_mass.ez.y;this.m_mass.ez.z=q+s;this.m_motorMass=q+s;0<this.m_motorMass&&(this.m_motorMass=1/this.m_motorMass);if(!this.m_enableMotor||t)this.m_motorImpulse=0;this.m_enableLimit&&
!t?(b=f-b-this.m_referenceAngle,box2d.b2Abs(this.m_upperAngle-this.m_lowerAngle)<2*box2d.b2_angularSlop?this.m_limitState=box2d.b2LimitState.e_equalLimits:b<=this.m_lowerAngle?(this.m_limitState!==box2d.b2LimitState.e_atLowerLimit&&(this.m_impulse.z=0),this.m_limitState=box2d.b2LimitState.e_atLowerLimit):b>=this.m_upperAngle?(this.m_limitState!==box2d.b2LimitState.e_atUpperLimit&&(this.m_impulse.z=0),this.m_limitState=box2d.b2LimitState.e_atUpperLimit):(this.m_limitState=box2d.b2LimitState.e_inactiveLimit,
this.m_impulse.z=0)):this.m_limitState=box2d.b2LimitState.e_inactiveLimit;a.step.warmStarting?(this.m_impulse.SelfMulScalar(a.step.dtRatio),this.m_motorImpulse*=a.step.dtRatio,b=box2d.b2RevoluteJoint.prototype.InitVelocityConstraints.s_P.Set(this.m_impulse.x,this.m_impulse.y),d.SelfMulSub(m,b),e-=q*(box2d.b2Cross_V2_V2(this.m_rA,b)+this.m_motorImpulse+this.m_impulse.z),g.SelfMulAdd(n,b),k+=s*(box2d.b2Cross_V2_V2(this.m_rB,b)+this.m_motorImpulse+this.m_impulse.z)):(this.m_impulse.SetZero(),this.m_motorImpulse=
0);a.velocities[this.m_indexA].w=e;a.velocities[this.m_indexB].w=k};goog.exportProperty(box2d.b2RevoluteJoint.prototype,"InitVelocityConstraints",box2d.b2RevoluteJoint.prototype.InitVelocityConstraints);box2d.b2RevoluteJoint.prototype.InitVelocityConstraints.s_P=new box2d.b2Vec2;
box2d.b2RevoluteJoint.prototype.SolveVelocityConstraints=function(a){var b=a.velocities[this.m_indexA].v,d=a.velocities[this.m_indexA].w,e=a.velocities[this.m_indexB].v,f=a.velocities[this.m_indexB].w,g=this.m_invMassA,k=this.m_invMassB,m=this.m_invIA,n=this.m_invIB,q=0===m+n;if(this.m_enableMotor&&this.m_limitState!==box2d.b2LimitState.e_equalLimits&&!q){var s=f-d-this.m_motorSpeed,s=-this.m_motorMass*s,t=this.m_motorImpulse,u=a.step.dt*this.m_maxMotorTorque;this.m_motorImpulse=box2d.b2Clamp(this.m_motorImpulse+
s,-u,u);s=this.m_motorImpulse-t;d-=m*s;f+=n*s}this.m_enableLimit&&this.m_limitState!==box2d.b2LimitState.e_inactiveLimit&&!q?(q=box2d.b2Sub_V2_V2(box2d.b2AddCross_V2_S_V2(e,f,this.m_rB,box2d.b2Vec2.s_t0),box2d.b2AddCross_V2_S_V2(b,d,this.m_rA,box2d.b2Vec2.s_t1),box2d.b2RevoluteJoint.prototype.SolveVelocityConstraints.s_Cdot1),s=this.m_mass.Solve33(q.x,q.y,f-d,box2d.b2RevoluteJoint.prototype.SolveVelocityConstraints.s_impulse3).SelfNeg(),this.m_limitState===box2d.b2LimitState.e_equalLimits?this.m_impulse.SelfAdd(s):
this.m_limitState===box2d.b2LimitState.e_atLowerLimit?(t=this.m_impulse.z+s.z,0>t?(t=-q.x+this.m_impulse.z*this.m_mass.ez.x,q=-q.y+this.m_impulse.z*this.m_mass.ez.y,q=this.m_mass.Solve22(t,q,box2d.b2RevoluteJoint.prototype.SolveVelocityConstraints.s_reduced),s.x=q.x,s.y=q.y,s.z=-this.m_impulse.z,this.m_impulse.x+=q.x,this.m_impulse.y+=q.y,this.m_impulse.z=0):this.m_impulse.SelfAdd(s)):this.m_limitState===box2d.b2LimitState.e_atUpperLimit&&(t=this.m_impulse.z+s.z,0<t?(t=-q.x+this.m_impulse.z*this.m_mass.ez.x,
q=-q.y+this.m_impulse.z*this.m_mass.ez.y,q=this.m_mass.Solve22(t,q,box2d.b2RevoluteJoint.prototype.SolveVelocityConstraints.s_reduced),s.x=q.x,s.y=q.y,s.z=-this.m_impulse.z,this.m_impulse.x+=q.x,this.m_impulse.y+=q.y,this.m_impulse.z=0):this.m_impulse.SelfAdd(s)),q=box2d.b2RevoluteJoint.prototype.SolveVelocityConstraints.s_P.Set(s.x,s.y),b.SelfMulSub(g,q),d-=m*(box2d.b2Cross_V2_V2(this.m_rA,q)+s.z),e.SelfMulAdd(k,q),f+=n*(box2d.b2Cross_V2_V2(this.m_rB,q)+s.z)):(s=box2d.b2Sub_V2_V2(box2d.b2AddCross_V2_S_V2(e,
f,this.m_rB,box2d.b2Vec2.s_t0),box2d.b2AddCross_V2_S_V2(b,d,this.m_rA,box2d.b2Vec2.s_t1),box2d.b2RevoluteJoint.prototype.SolveVelocityConstraints.s_Cdot),s=this.m_mass.Solve22(-s.x,-s.y,box2d.b2RevoluteJoint.prototype.SolveVelocityConstraints.s_impulse2),this.m_impulse.x+=s.x,this.m_impulse.y+=s.y,b.SelfMulSub(g,s),d-=m*box2d.b2Cross_V2_V2(this.m_rA,s),e.SelfMulAdd(k,s),f+=n*box2d.b2Cross_V2_V2(this.m_rB,s));a.velocities[this.m_indexA].w=d;a.velocities[this.m_indexB].w=f};
goog.exportProperty(box2d.b2RevoluteJoint.prototype,"SolveVelocityConstraints",box2d.b2RevoluteJoint.prototype.SolveVelocityConstraints);box2d.b2RevoluteJoint.prototype.SolveVelocityConstraints.s_P=new box2d.b2Vec2;box2d.b2RevoluteJoint.prototype.SolveVelocityConstraints.s_Cdot=new box2d.b2Vec2;box2d.b2RevoluteJoint.prototype.SolveVelocityConstraints.s_Cdot1=new box2d.b2Vec2;box2d.b2RevoluteJoint.prototype.SolveVelocityConstraints.s_impulse3=new box2d.b2Vec3;
box2d.b2RevoluteJoint.prototype.SolveVelocityConstraints.s_reduced=new box2d.b2Vec2;box2d.b2RevoluteJoint.prototype.SolveVelocityConstraints.s_impulse2=new box2d.b2Vec2;
box2d.b2RevoluteJoint.prototype.SolvePositionConstraints=function(a){var b=a.positions[this.m_indexA].c,d=a.positions[this.m_indexA].a,e=a.positions[this.m_indexB].c,f=a.positions[this.m_indexB].a,g=this.m_qA.SetAngle(d),k=this.m_qB.SetAngle(f),m=0,n=0,n=0===this.m_invIA+this.m_invIB;if(this.m_enableLimit&&this.m_limitState!==box2d.b2LimitState.e_inactiveLimit&&!n){var q=f-d-this.m_referenceAngle,n=0;this.m_limitState===box2d.b2LimitState.e_equalLimits?(q=box2d.b2Clamp(q-this.m_lowerAngle,-box2d.b2_maxAngularCorrection,
box2d.b2_maxAngularCorrection),n=-this.m_motorMass*q,m=box2d.b2Abs(q)):this.m_limitState===box2d.b2LimitState.e_atLowerLimit?(q-=this.m_lowerAngle,m=-q,q=box2d.b2Clamp(q+box2d.b2_angularSlop,-box2d.b2_maxAngularCorrection,0),n=-this.m_motorMass*q):this.m_limitState===box2d.b2LimitState.e_atUpperLimit&&(m=q-=this.m_upperAngle,q=box2d.b2Clamp(q-box2d.b2_angularSlop,0,box2d.b2_maxAngularCorrection),n=-this.m_motorMass*q);d-=this.m_invIA*n;f+=this.m_invIB*n}g.SetAngle(d);k.SetAngle(f);box2d.b2Sub_V2_V2(this.m_localAnchorA,
this.m_localCenterA,this.m_lalcA);g=box2d.b2Mul_R_V2(g,this.m_lalcA,this.m_rA);box2d.b2Sub_V2_V2(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB);var k=box2d.b2Mul_R_V2(k,this.m_lalcB,this.m_rB),q=box2d.b2Sub_V2_V2(box2d.b2Add_V2_V2(e,k,box2d.b2Vec2.s_t0),box2d.b2Add_V2_V2(b,g,box2d.b2Vec2.s_t1),box2d.b2RevoluteJoint.prototype.SolvePositionConstraints.s_C),n=q.Length(),s=this.m_invMassA,t=this.m_invMassB,u=this.m_invIA,v=this.m_invIB,y=this.m_K;y.ex.x=s+t+u*g.y*g.y+v*k.y*k.y;y.ex.y=-u*g.x*g.y-
v*k.x*k.y;y.ey.x=y.ex.y;y.ey.y=s+t+u*g.x*g.x+v*k.x*k.x;q=y.Solve(q.x,q.y,box2d.b2RevoluteJoint.prototype.SolvePositionConstraints.s_impulse).SelfNeg();b.SelfMulSub(s,q);d-=u*box2d.b2Cross_V2_V2(g,q);e.SelfMulAdd(t,q);f+=v*box2d.b2Cross_V2_V2(k,q);a.positions[this.m_indexA].a=d;a.positions[this.m_indexB].a=f;return n<=box2d.b2_linearSlop&&m<=box2d.b2_angularSlop};goog.exportProperty(box2d.b2RevoluteJoint.prototype,"SolvePositionConstraints",box2d.b2RevoluteJoint.prototype.SolvePositionConstraints);
box2d.b2RevoluteJoint.prototype.SolvePositionConstraints.s_C=new box2d.b2Vec2;box2d.b2RevoluteJoint.prototype.SolvePositionConstraints.s_impulse=new box2d.b2Vec2;box2d.b2RevoluteJoint.prototype.GetAnchorA=function(a){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,a)};goog.exportProperty(box2d.b2RevoluteJoint.prototype,"GetAnchorA",box2d.b2RevoluteJoint.prototype.GetAnchorA);box2d.b2RevoluteJoint.prototype.GetAnchorB=function(a){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,a)};
goog.exportProperty(box2d.b2RevoluteJoint.prototype,"GetAnchorB",box2d.b2RevoluteJoint.prototype.GetAnchorB);box2d.b2RevoluteJoint.prototype.GetReactionForce=function(a,b){return b.Set(a*this.m_impulse.x,a*this.m_impulse.y)};goog.exportProperty(box2d.b2RevoluteJoint.prototype,"GetReactionForce",box2d.b2RevoluteJoint.prototype.GetReactionForce);box2d.b2RevoluteJoint.prototype.GetReactionTorque=function(a){return a*this.m_impulse.z};
goog.exportProperty(box2d.b2RevoluteJoint.prototype,"GetReactionTorque",box2d.b2RevoluteJoint.prototype.GetReactionTorque);box2d.b2RevoluteJoint.prototype.GetLocalAnchorA=function(a){return a.Copy(this.m_localAnchorA)};goog.exportProperty(box2d.b2RevoluteJoint.prototype,"GetLocalAnchorA",box2d.b2RevoluteJoint.prototype.GetLocalAnchorA);box2d.b2RevoluteJoint.prototype.GetLocalAnchorB=function(a){return a.Copy(this.m_localAnchorB)};
goog.exportProperty(box2d.b2RevoluteJoint.prototype,"GetLocalAnchorB",box2d.b2RevoluteJoint.prototype.GetLocalAnchorB);box2d.b2RevoluteJoint.prototype.GetReferenceAngle=function(){return this.m_referenceAngle};goog.exportProperty(box2d.b2RevoluteJoint.prototype,"GetReferenceAngle",box2d.b2RevoluteJoint.prototype.GetReferenceAngle);box2d.b2RevoluteJoint.prototype.GetJointAngle=function(){return this.m_bodyB.m_sweep.a-this.m_bodyA.m_sweep.a-this.m_referenceAngle};
goog.exportProperty(box2d.b2RevoluteJoint.prototype,"GetJointAngle",box2d.b2RevoluteJoint.prototype.GetJointAngle);box2d.b2RevoluteJoint.prototype.GetJointSpeed=function(){return this.m_bodyB.m_angularVelocity-this.m_bodyA.m_angularVelocity};goog.exportProperty(box2d.b2RevoluteJoint.prototype,"GetJointSpeed",box2d.b2RevoluteJoint.prototype.GetJointSpeed);box2d.b2RevoluteJoint.prototype.IsMotorEnabled=function(){return this.m_enableMotor};
goog.exportProperty(box2d.b2RevoluteJoint.prototype,"IsMotorEnabled",box2d.b2RevoluteJoint.prototype.IsMotorEnabled);box2d.b2RevoluteJoint.prototype.EnableMotor=function(a){this.m_enableMotor!==a&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableMotor=a)};goog.exportProperty(box2d.b2RevoluteJoint.prototype,"EnableMotor",box2d.b2RevoluteJoint.prototype.EnableMotor);box2d.b2RevoluteJoint.prototype.GetMotorTorque=function(a){return a*this.m_motorImpulse};
goog.exportProperty(box2d.b2RevoluteJoint.prototype,"GetMotorTorque",box2d.b2RevoluteJoint.prototype.GetMotorTorque);box2d.b2RevoluteJoint.prototype.GetMotorSpeed=function(){return this.m_motorSpeed};goog.exportProperty(box2d.b2RevoluteJoint.prototype,"GetMotorSpeed",box2d.b2RevoluteJoint.prototype.GetMotorSpeed);box2d.b2RevoluteJoint.prototype.SetMaxMotorTorque=function(a){this.m_maxMotorTorque=a};goog.exportProperty(box2d.b2RevoluteJoint.prototype,"SetMaxMotorTorque",box2d.b2RevoluteJoint.prototype.SetMaxMotorTorque);
box2d.b2RevoluteJoint.prototype.GetMaxMotorTorque=function(){return this.m_maxMotorTorque};goog.exportProperty(box2d.b2RevoluteJoint.prototype,"GetMaxMotorTorque",box2d.b2RevoluteJoint.prototype.GetMaxMotorTorque);box2d.b2RevoluteJoint.prototype.IsLimitEnabled=function(){return this.m_enableLimit};goog.exportProperty(box2d.b2RevoluteJoint.prototype,"IsLimitEnabled",box2d.b2RevoluteJoint.prototype.IsLimitEnabled);
box2d.b2RevoluteJoint.prototype.EnableLimit=function(a){a!==this.m_enableLimit&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableLimit=a,this.m_impulse.z=0)};goog.exportProperty(box2d.b2RevoluteJoint.prototype,"EnableLimit",box2d.b2RevoluteJoint.prototype.EnableLimit);box2d.b2RevoluteJoint.prototype.GetLowerLimit=function(){return this.m_lowerAngle};goog.exportProperty(box2d.b2RevoluteJoint.prototype,"GetLowerLimit",box2d.b2RevoluteJoint.prototype.GetLowerLimit);
box2d.b2RevoluteJoint.prototype.GetUpperLimit=function(){return this.m_upperAngle};goog.exportProperty(box2d.b2RevoluteJoint.prototype,"GetUpperLimit",box2d.b2RevoluteJoint.prototype.GetUpperLimit);box2d.b2RevoluteJoint.prototype.SetLimits=function(a,b){if(a!==this.m_lowerAngle||b!==this.m_upperAngle)this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_impulse.z=0,this.m_lowerAngle=a,this.m_upperAngle=b};goog.exportProperty(box2d.b2RevoluteJoint.prototype,"SetLimits",box2d.b2RevoluteJoint.prototype.SetLimits);
box2d.b2RevoluteJoint.prototype.SetMotorSpeed=function(a){this.m_motorSpeed!==a&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_motorSpeed=a)};goog.exportProperty(box2d.b2RevoluteJoint.prototype,"SetMotorSpeed",box2d.b2RevoluteJoint.prototype.SetMotorSpeed);
box2d.b2RevoluteJoint.prototype.Dump=function(){if(box2d.DEBUG){var a=this.m_bodyA.m_islandIndex,b=this.m_bodyB.m_islandIndex;box2d.b2Log("  /*box2d.b2RevoluteJointDef*/ var jd = new box2d.b2RevoluteJointDef();\n");box2d.b2Log("  jd.bodyA = bodies[%d];\n",a);box2d.b2Log("  jd.bodyB = bodies[%d];\n",b);box2d.b2Log("  jd.collideConnected = %s;\n",this.m_collideConnected?"true":"false");box2d.b2Log("  jd.localAnchorA.Set(%.15f, %.15f);\n",this.m_localAnchorA.x,this.m_localAnchorA.y);box2d.b2Log("  jd.localAnchorB.Set(%.15f, %.15f);\n",
this.m_localAnchorB.x,this.m_localAnchorB.y);box2d.b2Log("  jd.referenceAngle = %.15f;\n",this.m_referenceAngle);box2d.b2Log("  jd.enableLimit = %s;\n",this.m_enableLimit?"true":"false");box2d.b2Log("  jd.lowerAngle = %.15f;\n",this.m_lowerAngle);box2d.b2Log("  jd.upperAngle = %.15f;\n",this.m_upperAngle);box2d.b2Log("  jd.enableMotor = %s;\n",this.m_enableMotor?"true":"false");box2d.b2Log("  jd.motorSpeed = %.15f;\n",this.m_motorSpeed);box2d.b2Log("  jd.maxMotorTorque = %.15f;\n",this.m_maxMotorTorque);
box2d.b2Log("  joints[%d] = this.m_world.CreateJoint(jd);\n",this.m_index)}};goog.exportProperty(box2d.b2RevoluteJoint.prototype,"Dump",box2d.b2RevoluteJoint.prototype.Dump);box2d.b2GearJointDef=function(){box2d.b2JointDef.call(this,box2d.b2JointType.e_gearJoint)};goog.inherits(box2d.b2GearJointDef,box2d.b2JointDef);goog.exportSymbol("box2d.b2GearJointDef",box2d.b2GearJointDef);box2d.b2GearJointDef.prototype.joint1=null;goog.exportProperty(box2d.b2GearJointDef.prototype,"joint1",box2d.b2GearJointDef.prototype.joint1);
box2d.b2GearJointDef.prototype.joint2=null;goog.exportProperty(box2d.b2GearJointDef.prototype,"joint2",box2d.b2GearJointDef.prototype.joint2);box2d.b2GearJointDef.prototype.ratio=1;goog.exportProperty(box2d.b2GearJointDef.prototype,"ratio",box2d.b2GearJointDef.prototype.ratio);
box2d.b2GearJoint=function(a){box2d.b2Joint.call(this,a);this.m_joint1=a.joint1;this.m_joint2=a.joint2;this.m_localAnchorA=new box2d.b2Vec2;this.m_localAnchorB=new box2d.b2Vec2;this.m_localAnchorC=new box2d.b2Vec2;this.m_localAnchorD=new box2d.b2Vec2;this.m_localAxisC=new box2d.b2Vec2;this.m_localAxisD=new box2d.b2Vec2;this.m_lcA=new box2d.b2Vec2;this.m_lcB=new box2d.b2Vec2;this.m_lcC=new box2d.b2Vec2;this.m_lcD=new box2d.b2Vec2;this.m_JvAC=new box2d.b2Vec2;this.m_JvBD=new box2d.b2Vec2;this.m_qA=
new box2d.b2Rot;this.m_qB=new box2d.b2Rot;this.m_qC=new box2d.b2Rot;this.m_qD=new box2d.b2Rot;this.m_lalcA=new box2d.b2Vec2;this.m_lalcB=new box2d.b2Vec2;this.m_lalcC=new box2d.b2Vec2;this.m_lalcD=new box2d.b2Vec2;this.m_typeA=this.m_joint1.GetType();this.m_typeB=this.m_joint2.GetType();box2d.ENABLE_ASSERTS&&box2d.b2Assert(this.m_typeA===box2d.b2JointType.e_revoluteJoint||this.m_typeA===box2d.b2JointType.e_prismaticJoint);box2d.ENABLE_ASSERTS&&box2d.b2Assert(this.m_typeB===box2d.b2JointType.e_revoluteJoint||
this.m_typeB===box2d.b2JointType.e_prismaticJoint);var b,d;this.m_bodyC=this.m_joint1.GetBodyA();this.m_bodyA=this.m_joint1.GetBodyB();b=this.m_bodyA.m_xf;var e=this.m_bodyA.m_sweep.a;d=this.m_bodyC.m_xf;var f=this.m_bodyC.m_sweep.a;this.m_typeA===box2d.b2JointType.e_revoluteJoint?(d=a.joint1,this.m_localAnchorC.Copy(d.m_localAnchorA),this.m_localAnchorA.Copy(d.m_localAnchorB),this.m_referenceAngleA=d.m_referenceAngle,this.m_localAxisC.SetZero(),b=e-f-this.m_referenceAngleA):(f=a.joint1,this.m_localAnchorC.Copy(f.m_localAnchorA),
this.m_localAnchorA.Copy(f.m_localAnchorB),this.m_referenceAngleA=f.m_referenceAngle,this.m_localAxisC.Copy(f.m_localXAxisA),e=this.m_localAnchorC,b=box2d.b2MulT_R_V2(d.q,box2d.b2Add_V2_V2(box2d.b2Mul_R_V2(b.q,this.m_localAnchorA,box2d.b2Vec2.s_t0),box2d.b2Sub_V2_V2(b.p,d.p,box2d.b2Vec2.s_t1),box2d.b2Vec2.s_t0),box2d.b2Vec2.s_t0),b=box2d.b2Dot_V2_V2(box2d.b2Sub_V2_V2(b,e,box2d.b2Vec2.s_t0),this.m_localAxisC));this.m_bodyD=this.m_joint2.GetBodyA();this.m_bodyB=this.m_joint2.GetBodyB();d=this.m_bodyB.m_xf;
var f=this.m_bodyB.m_sweep.a,e=this.m_bodyD.m_xf,g=this.m_bodyD.m_sweep.a;this.m_typeB===box2d.b2JointType.e_revoluteJoint?(d=a.joint2,this.m_localAnchorD.Copy(d.m_localAnchorA),this.m_localAnchorB.Copy(d.m_localAnchorB),this.m_referenceAngleB=d.m_referenceAngle,this.m_localAxisD.SetZero(),d=f-g-this.m_referenceAngleB):(f=a.joint2,this.m_localAnchorD.Copy(f.m_localAnchorA),this.m_localAnchorB.Copy(f.m_localAnchorB),this.m_referenceAngleB=f.m_referenceAngle,this.m_localAxisD.Copy(f.m_localXAxisA),
f=this.m_localAnchorD,d=box2d.b2MulT_R_V2(e.q,box2d.b2Add_V2_V2(box2d.b2Mul_R_V2(d.q,this.m_localAnchorB,box2d.b2Vec2.s_t0),box2d.b2Sub_V2_V2(d.p,e.p,box2d.b2Vec2.s_t1),box2d.b2Vec2.s_t0),box2d.b2Vec2.s_t0),d=box2d.b2Dot_V2_V2(box2d.b2Sub_V2_V2(d,f,box2d.b2Vec2.s_t0),this.m_localAxisD));this.m_ratio=a.ratio;this.m_constant=b+this.m_ratio*d;this.m_impulse=0};goog.inherits(box2d.b2GearJoint,box2d.b2Joint);goog.exportSymbol("box2d.b2GearJoint",box2d.b2GearJoint);
box2d.b2GearJoint.prototype.m_joint1=null;goog.exportProperty(box2d.b2GearJoint.prototype,"m_joint1",box2d.b2GearJoint.prototype.m_joint1);box2d.b2GearJoint.prototype.m_joint2=null;goog.exportProperty(box2d.b2GearJoint.prototype,"m_joint2",box2d.b2GearJoint.prototype.m_joint2);box2d.b2GearJoint.prototype.m_typeA=box2d.b2JointType.e_unknownJoint;goog.exportProperty(box2d.b2GearJoint.prototype,"m_typeA",box2d.b2GearJoint.prototype.m_typeA);box2d.b2GearJoint.prototype.m_typeB=box2d.b2JointType.e_unknownJoint;
goog.exportProperty(box2d.b2GearJoint.prototype,"m_typeB",box2d.b2GearJoint.prototype.m_typeB);box2d.b2GearJoint.prototype.m_bodyC=null;goog.exportProperty(box2d.b2GearJoint.prototype,"m_bodyC",box2d.b2GearJoint.prototype.m_bodyC);box2d.b2GearJoint.prototype.m_bodyD=null;goog.exportProperty(box2d.b2GearJoint.prototype,"m_bodyD",box2d.b2GearJoint.prototype.m_bodyD);box2d.b2GearJoint.prototype.m_localAnchorA=null;goog.exportProperty(box2d.b2GearJoint.prototype,"m_localAnchorA",box2d.b2GearJoint.prototype.m_localAnchorA);
box2d.b2GearJoint.prototype.m_localAnchorB=null;goog.exportProperty(box2d.b2GearJoint.prototype,"m_localAnchorB",box2d.b2GearJoint.prototype.m_localAnchorB);box2d.b2GearJoint.prototype.m_localAnchorC=null;goog.exportProperty(box2d.b2GearJoint.prototype,"m_localAnchorC",box2d.b2GearJoint.prototype.m_localAnchorC);box2d.b2GearJoint.prototype.m_localAnchorD=null;goog.exportProperty(box2d.b2GearJoint.prototype,"m_localAnchorD",box2d.b2GearJoint.prototype.m_localAnchorD);
box2d.b2GearJoint.prototype.m_localAxisC=null;goog.exportProperty(box2d.b2GearJoint.prototype,"m_localAxisC",box2d.b2GearJoint.prototype.m_localAxisC);box2d.b2GearJoint.prototype.m_localAxisD=null;goog.exportProperty(box2d.b2GearJoint.prototype,"m_localAxisD",box2d.b2GearJoint.prototype.m_localAxisD);box2d.b2GearJoint.prototype.m_referenceAngleA=0;goog.exportProperty(box2d.b2GearJoint.prototype,"m_referenceAngleA",box2d.b2GearJoint.prototype.m_referenceAngleA);
box2d.b2GearJoint.prototype.m_referenceAngleB=0;goog.exportProperty(box2d.b2GearJoint.prototype,"m_referenceAngleB",box2d.b2GearJoint.prototype.m_referenceAngleB);box2d.b2GearJoint.prototype.m_constant=0;goog.exportProperty(box2d.b2GearJoint.prototype,"m_constant",box2d.b2GearJoint.prototype.m_constant);box2d.b2GearJoint.prototype.m_ratio=0;goog.exportProperty(box2d.b2GearJoint.prototype,"m_ratio",box2d.b2GearJoint.prototype.m_ratio);box2d.b2GearJoint.prototype.m_impulse=0;
goog.exportProperty(box2d.b2GearJoint.prototype,"m_impulse",box2d.b2GearJoint.prototype.m_impulse);box2d.b2GearJoint.prototype.m_indexA=0;goog.exportProperty(box2d.b2GearJoint.prototype,"m_indexA",box2d.b2GearJoint.prototype.m_indexA);box2d.b2GearJoint.prototype.m_indexB=0;goog.exportProperty(box2d.b2GearJoint.prototype,"m_indexB",box2d.b2GearJoint.prototype.m_indexB);box2d.b2GearJoint.prototype.m_indexC=0;goog.exportProperty(box2d.b2GearJoint.prototype,"m_indexC",box2d.b2GearJoint.prototype.m_indexC);
box2d.b2GearJoint.prototype.m_indexD=0;goog.exportProperty(box2d.b2GearJoint.prototype,"m_indexD",box2d.b2GearJoint.prototype.m_indexD);box2d.b2GearJoint.prototype.m_lcA=null;goog.exportProperty(box2d.b2GearJoint.prototype,"m_lcA",box2d.b2GearJoint.prototype.m_lcA);box2d.b2GearJoint.prototype.m_lcB=null;goog.exportProperty(box2d.b2GearJoint.prototype,"m_lcB",box2d.b2GearJoint.prototype.m_lcB);box2d.b2GearJoint.prototype.m_lcC=null;goog.exportProperty(box2d.b2GearJoint.prototype,"m_lcC",box2d.b2GearJoint.prototype.m_lcC);
box2d.b2GearJoint.prototype.m_lcD=null;goog.exportProperty(box2d.b2GearJoint.prototype,"m_lcD",box2d.b2GearJoint.prototype.m_lcD);box2d.b2GearJoint.prototype.m_mA=0;goog.exportProperty(box2d.b2GearJoint.prototype,"m_mA",box2d.b2GearJoint.prototype.m_mA);box2d.b2GearJoint.prototype.m_mB=0;goog.exportProperty(box2d.b2GearJoint.prototype,"m_mB",box2d.b2GearJoint.prototype.m_mB);box2d.b2GearJoint.prototype.m_mC=0;goog.exportProperty(box2d.b2GearJoint.prototype,"m_mC",box2d.b2GearJoint.prototype.m_mC);
box2d.b2GearJoint.prototype.m_mD=0;goog.exportProperty(box2d.b2GearJoint.prototype,"m_mD",box2d.b2GearJoint.prototype.m_mD);box2d.b2GearJoint.prototype.m_iA=0;goog.exportProperty(box2d.b2GearJoint.prototype,"m_iA",box2d.b2GearJoint.prototype.m_iA);box2d.b2GearJoint.prototype.m_iB=0;goog.exportProperty(box2d.b2GearJoint.prototype,"m_iB",box2d.b2GearJoint.prototype.m_iB);box2d.b2GearJoint.prototype.m_iC=0;goog.exportProperty(box2d.b2GearJoint.prototype,"m_iC",box2d.b2GearJoint.prototype.m_iC);
box2d.b2GearJoint.prototype.m_iD=0;goog.exportProperty(box2d.b2GearJoint.prototype,"m_iD",box2d.b2GearJoint.prototype.m_iD);box2d.b2GearJoint.prototype.m_JvAC=null;goog.exportProperty(box2d.b2GearJoint.prototype,"m_JvAC",box2d.b2GearJoint.prototype.m_JvAC);box2d.b2GearJoint.prototype.m_JvBD=null;goog.exportProperty(box2d.b2GearJoint.prototype,"m_JvBD",box2d.b2GearJoint.prototype.m_JvBD);box2d.b2GearJoint.prototype.m_JwA=0;goog.exportProperty(box2d.b2GearJoint.prototype,"m_JwA",box2d.b2GearJoint.prototype.m_JwA);
box2d.b2GearJoint.prototype.m_JwB=0;goog.exportProperty(box2d.b2GearJoint.prototype,"m_JwB",box2d.b2GearJoint.prototype.m_JwB);box2d.b2GearJoint.prototype.m_JwC=0;goog.exportProperty(box2d.b2GearJoint.prototype,"m_JwC",box2d.b2GearJoint.prototype.m_JwC);box2d.b2GearJoint.prototype.m_JwD=0;goog.exportProperty(box2d.b2GearJoint.prototype,"m_JwD",box2d.b2GearJoint.prototype.m_JwD);box2d.b2GearJoint.prototype.m_mass=0;goog.exportProperty(box2d.b2GearJoint.prototype,"m_mass",box2d.b2GearJoint.prototype.m_mass);
box2d.b2GearJoint.prototype.m_qA=null;goog.exportProperty(box2d.b2GearJoint.prototype,"m_qA",box2d.b2GearJoint.prototype.m_qA);box2d.b2GearJoint.prototype.m_qB=null;goog.exportProperty(box2d.b2GearJoint.prototype,"m_qB",box2d.b2GearJoint.prototype.m_qB);box2d.b2GearJoint.prototype.m_qC=null;goog.exportProperty(box2d.b2GearJoint.prototype,"m_qC",box2d.b2GearJoint.prototype.m_qC);box2d.b2GearJoint.prototype.m_qD=null;goog.exportProperty(box2d.b2GearJoint.prototype,"m_qD",box2d.b2GearJoint.prototype.m_qD);
box2d.b2GearJoint.prototype.m_lalcA=null;goog.exportProperty(box2d.b2GearJoint.prototype,"m_lalcA",box2d.b2GearJoint.prototype.m_lalcA);box2d.b2GearJoint.prototype.m_lalcB=null;goog.exportProperty(box2d.b2GearJoint.prototype,"m_lalcB",box2d.b2GearJoint.prototype.m_lalcB);box2d.b2GearJoint.prototype.m_lalcC=null;goog.exportProperty(box2d.b2GearJoint.prototype,"m_lalcC",box2d.b2GearJoint.prototype.m_lalcC);box2d.b2GearJoint.prototype.m_lalcD=null;
goog.exportProperty(box2d.b2GearJoint.prototype,"m_lalcD",box2d.b2GearJoint.prototype.m_lalcD);
box2d.b2GearJoint.prototype.InitVelocityConstraints=function(a){this.m_indexA=this.m_bodyA.m_islandIndex;this.m_indexB=this.m_bodyB.m_islandIndex;this.m_indexC=this.m_bodyC.m_islandIndex;this.m_indexD=this.m_bodyD.m_islandIndex;this.m_lcA.Copy(this.m_bodyA.m_sweep.localCenter);this.m_lcB.Copy(this.m_bodyB.m_sweep.localCenter);this.m_lcC.Copy(this.m_bodyC.m_sweep.localCenter);this.m_lcD.Copy(this.m_bodyD.m_sweep.localCenter);this.m_mA=this.m_bodyA.m_invMass;this.m_mB=this.m_bodyB.m_invMass;this.m_mC=
this.m_bodyC.m_invMass;this.m_mD=this.m_bodyD.m_invMass;this.m_iA=this.m_bodyA.m_invI;this.m_iB=this.m_bodyB.m_invI;this.m_iC=this.m_bodyC.m_invI;this.m_iD=this.m_bodyD.m_invI;var b=a.velocities[this.m_indexA].v,d=a.velocities[this.m_indexA].w,e=a.positions[this.m_indexB].a,f=a.velocities[this.m_indexB].v,g=a.velocities[this.m_indexB].w,k=a.positions[this.m_indexC].a,m=a.velocities[this.m_indexC].v,n=a.velocities[this.m_indexC].w,q=a.positions[this.m_indexD].a,s=a.velocities[this.m_indexD].v,t=a.velocities[this.m_indexD].w,
u=this.m_qA.SetAngle(a.positions[this.m_indexA].a),e=this.m_qB.SetAngle(e),v=this.m_qC.SetAngle(k),k=this.m_qD.SetAngle(q);this.m_mass=0;this.m_typeA===box2d.b2JointType.e_revoluteJoint?(this.m_JvAC.SetZero(),this.m_JwC=this.m_JwA=1,this.m_mass+=this.m_iA+this.m_iC):(q=box2d.b2Mul_R_V2(v,this.m_localAxisC,box2d.b2GearJoint.prototype.InitVelocityConstraints.s_u),box2d.b2Sub_V2_V2(this.m_localAnchorC,this.m_lcC,this.m_lalcC),v=box2d.b2Mul_R_V2(v,this.m_lalcC,box2d.b2GearJoint.prototype.InitVelocityConstraints.s_rC),
box2d.b2Sub_V2_V2(this.m_localAnchorA,this.m_lcA,this.m_lalcA),u=box2d.b2Mul_R_V2(u,this.m_lalcA,box2d.b2GearJoint.prototype.InitVelocityConstraints.s_rA),this.m_JvAC.Copy(q),this.m_JwC=box2d.b2Cross_V2_V2(v,q),this.m_JwA=box2d.b2Cross_V2_V2(u,q),this.m_mass+=this.m_mC+this.m_mA+this.m_iC*this.m_JwC*this.m_JwC+this.m_iA*this.m_JwA*this.m_JwA);this.m_typeB===box2d.b2JointType.e_revoluteJoint?(this.m_JvBD.SetZero(),this.m_JwD=this.m_JwB=this.m_ratio,this.m_mass+=this.m_ratio*this.m_ratio*(this.m_iB+
this.m_iD)):(q=box2d.b2Mul_R_V2(k,this.m_localAxisD,box2d.b2GearJoint.prototype.InitVelocityConstraints.s_u),box2d.b2Sub_V2_V2(this.m_localAnchorD,this.m_lcD,this.m_lalcD),u=box2d.b2Mul_R_V2(k,this.m_lalcD,box2d.b2GearJoint.prototype.InitVelocityConstraints.s_rD),box2d.b2Sub_V2_V2(this.m_localAnchorB,this.m_lcB,this.m_lalcB),e=box2d.b2Mul_R_V2(e,this.m_lalcB,box2d.b2GearJoint.prototype.InitVelocityConstraints.s_rB),box2d.b2Mul_S_V2(this.m_ratio,q,this.m_JvBD),this.m_JwD=this.m_ratio*box2d.b2Cross_V2_V2(u,
q),this.m_JwB=this.m_ratio*box2d.b2Cross_V2_V2(e,q),this.m_mass+=this.m_ratio*this.m_ratio*(this.m_mD+this.m_mB)+this.m_iD*this.m_JwD*this.m_JwD+this.m_iB*this.m_JwB*this.m_JwB);this.m_mass=0<this.m_mass?1/this.m_mass:0;a.step.warmStarting?(b.SelfMulAdd(this.m_mA*this.m_impulse,this.m_JvAC),d+=this.m_iA*this.m_impulse*this.m_JwA,f.SelfMulAdd(this.m_mB*this.m_impulse,this.m_JvBD),g+=this.m_iB*this.m_impulse*this.m_JwB,m.SelfMulSub(this.m_mC*this.m_impulse,this.m_JvAC),n-=this.m_iC*this.m_impulse*this.m_JwC,
s.SelfMulSub(this.m_mD*this.m_impulse,this.m_JvBD),t-=this.m_iD*this.m_impulse*this.m_JwD):this.m_impulse=0;a.velocities[this.m_indexA].w=d;a.velocities[this.m_indexB].w=g;a.velocities[this.m_indexC].w=n;a.velocities[this.m_indexD].w=t};box2d.b2GearJoint.prototype.InitVelocityConstraints.s_u=new box2d.b2Vec2;box2d.b2GearJoint.prototype.InitVelocityConstraints.s_rA=new box2d.b2Vec2;box2d.b2GearJoint.prototype.InitVelocityConstraints.s_rB=new box2d.b2Vec2;
box2d.b2GearJoint.prototype.InitVelocityConstraints.s_rC=new box2d.b2Vec2;box2d.b2GearJoint.prototype.InitVelocityConstraints.s_rD=new box2d.b2Vec2;
box2d.b2GearJoint.prototype.SolveVelocityConstraints=function(a){var b=a.velocities[this.m_indexA].v,d=a.velocities[this.m_indexA].w,e=a.velocities[this.m_indexB].v,f=a.velocities[this.m_indexB].w,g=a.velocities[this.m_indexC].v,k=a.velocities[this.m_indexC].w,m=a.velocities[this.m_indexD].v,n=a.velocities[this.m_indexD].w,q=box2d.b2Dot_V2_V2(this.m_JvAC,box2d.b2Sub_V2_V2(b,g,box2d.b2Vec2.s_t0))+box2d.b2Dot_V2_V2(this.m_JvBD,box2d.b2Sub_V2_V2(e,m,box2d.b2Vec2.s_t0)),q=q+(this.m_JwA*d-this.m_JwC*k+
(this.m_JwB*f-this.m_JwD*n)),q=-this.m_mass*q;this.m_impulse+=q;b.SelfMulAdd(this.m_mA*q,this.m_JvAC);d+=this.m_iA*q*this.m_JwA;e.SelfMulAdd(this.m_mB*q,this.m_JvBD);f+=this.m_iB*q*this.m_JwB;g.SelfMulSub(this.m_mC*q,this.m_JvAC);k-=this.m_iC*q*this.m_JwC;m.SelfMulSub(this.m_mD*q,this.m_JvBD);n-=this.m_iD*q*this.m_JwD;a.velocities[this.m_indexA].w=d;a.velocities[this.m_indexB].w=f;a.velocities[this.m_indexC].w=k;a.velocities[this.m_indexD].w=n};
box2d.b2GearJoint.prototype.SolvePositionConstraints=function(a){var b=a.positions[this.m_indexA].c,d=a.positions[this.m_indexA].a,e=a.positions[this.m_indexB].c,f=a.positions[this.m_indexB].a,g=a.positions[this.m_indexC].c,k=a.positions[this.m_indexC].a,m=a.positions[this.m_indexD].c,n=a.positions[this.m_indexD].a,q=this.m_qA.SetAngle(d),s=this.m_qB.SetAngle(f),t=this.m_qC.SetAngle(k),u=this.m_qD.SetAngle(n),v=this.m_JvAC,y=this.m_JvBD,z,A,r=0;if(this.m_typeA===box2d.b2JointType.e_revoluteJoint)v.SetZero(),
q=z=1,r+=this.m_iA+this.m_iC,t=d-k-this.m_referenceAngleA;else{A=box2d.b2Mul_R_V2(t,this.m_localAxisC,box2d.b2GearJoint.prototype.SolvePositionConstraints.s_u);z=box2d.b2Mul_R_V2(t,this.m_lalcC,box2d.b2GearJoint.prototype.SolvePositionConstraints.s_rC);var D=box2d.b2Mul_R_V2(q,this.m_lalcA,box2d.b2GearJoint.prototype.SolvePositionConstraints.s_rA);v.Copy(A);q=box2d.b2Cross_V2_V2(z,A);z=box2d.b2Cross_V2_V2(D,A);r+=this.m_mC+this.m_mA+this.m_iC*q*q+this.m_iA*z*z;A=this.m_lalcC;t=box2d.b2MulT_R_V2(t,
box2d.b2Add_V2_V2(D,box2d.b2Sub_V2_V2(b,g,box2d.b2Vec2.s_t0),box2d.b2Vec2.s_t0),box2d.b2Vec2.s_t0);t=box2d.b2Dot_V2_V2(box2d.b2Sub_V2_V2(t,A,box2d.b2Vec2.s_t0),this.m_localAxisC)}if(this.m_typeB===box2d.b2JointType.e_revoluteJoint)y.SetZero(),s=A=this.m_ratio,r+=this.m_ratio*this.m_ratio*(this.m_iB+this.m_iD),u=f-n-this.m_referenceAngleB;else{A=box2d.b2Mul_R_V2(u,this.m_localAxisD,box2d.b2GearJoint.prototype.SolvePositionConstraints.s_u);var C=box2d.b2Mul_R_V2(u,this.m_lalcD,box2d.b2GearJoint.prototype.SolvePositionConstraints.s_rD),
D=box2d.b2Mul_R_V2(s,this.m_lalcB,box2d.b2GearJoint.prototype.SolvePositionConstraints.s_rB);box2d.b2Mul_S_V2(this.m_ratio,A,y);s=this.m_ratio*box2d.b2Cross_V2_V2(C,A);A=this.m_ratio*box2d.b2Cross_V2_V2(D,A);r+=this.m_ratio*this.m_ratio*(this.m_mD+this.m_mB)+this.m_iD*s*s+this.m_iB*A*A;C=this.m_lalcD;u=box2d.b2MulT_R_V2(u,box2d.b2Add_V2_V2(D,box2d.b2Sub_V2_V2(e,m,box2d.b2Vec2.s_t0),box2d.b2Vec2.s_t0),box2d.b2Vec2.s_t0);u=box2d.b2Dot_V2_V2(box2d.b2Sub_V2_V2(u,C,box2d.b2Vec2.s_t0),this.m_localAxisD)}u=
t+this.m_ratio*u-this.m_constant;t=0;0<r&&(t=-u/r);b.SelfMulAdd(this.m_mA*t,v);d+=this.m_iA*t*z;e.SelfMulAdd(this.m_mB*t,y);f+=this.m_iB*t*A;g.SelfMulSub(this.m_mC*t,v);k-=this.m_iC*t*q;m.SelfMulSub(this.m_mD*t,y);n-=this.m_iD*t*s;a.positions[this.m_indexA].a=d;a.positions[this.m_indexB].a=f;a.positions[this.m_indexC].a=k;a.positions[this.m_indexD].a=n;return 0<box2d.b2_linearSlop};goog.exportProperty(box2d.b2GearJoint.prototype,"SolvePositionConstraints",box2d.b2GearJoint.prototype.SolvePositionConstraints);
box2d.b2GearJoint.prototype.SolvePositionConstraints.s_u=new box2d.b2Vec2;box2d.b2GearJoint.prototype.SolvePositionConstraints.s_rA=new box2d.b2Vec2;box2d.b2GearJoint.prototype.SolvePositionConstraints.s_rB=new box2d.b2Vec2;box2d.b2GearJoint.prototype.SolvePositionConstraints.s_rC=new box2d.b2Vec2;box2d.b2GearJoint.prototype.SolvePositionConstraints.s_rD=new box2d.b2Vec2;box2d.b2GearJoint.prototype.GetAnchorA=function(a){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,a)};
goog.exportProperty(box2d.b2GearJoint.prototype,"GetAnchorA",box2d.b2GearJoint.prototype.GetAnchorA);box2d.b2GearJoint.prototype.GetAnchorB=function(a){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,a)};goog.exportProperty(box2d.b2GearJoint.prototype,"GetAnchorB",box2d.b2GearJoint.prototype.GetAnchorB);box2d.b2GearJoint.prototype.GetReactionForce=function(a,b){return box2d.b2Mul_S_V2(a*this.m_impulse,this.m_JvAC,b)};goog.exportProperty(box2d.b2GearJoint.prototype,"GetReactionForce",box2d.b2GearJoint.prototype.GetReactionForce);
box2d.b2GearJoint.prototype.GetReactionTorque=function(a){return a*this.m_impulse*this.m_JwA};goog.exportProperty(box2d.b2GearJoint.prototype,"GetReactionTorque",box2d.b2GearJoint.prototype.GetReactionTorque);box2d.b2GearJoint.prototype.GetJoint1=function(){return this.m_joint1};goog.exportProperty(box2d.b2GearJoint.prototype,"GetJoint1",box2d.b2GearJoint.prototype.GetJoint1);box2d.b2GearJoint.prototype.GetJoint2=function(){return this.m_joint2};
goog.exportProperty(box2d.b2GearJoint.prototype,"GetJoint2",box2d.b2GearJoint.prototype.GetJoint2);box2d.b2GearJoint.prototype.GetRatio=function(){return this.m_ratio};goog.exportProperty(box2d.b2GearJoint.prototype,"GetRatio",box2d.b2GearJoint.prototype.GetRatio);box2d.b2GearJoint.prototype.SetRatio=function(a){box2d.ENABLE_ASSERTS&&box2d.b2Assert(box2d.b2IsValid(a));this.m_ratio=a};goog.exportProperty(box2d.b2GearJoint.prototype,"SetRatio",box2d.b2GearJoint.prototype.SetRatio);
box2d.b2GearJoint.prototype.Dump=function(){if(box2d.DEBUG){var a=this.m_bodyA.m_islandIndex,b=this.m_bodyB.m_islandIndex,d=this.m_joint1.m_index,e=this.m_joint2.m_index;box2d.b2Log("  /*box2d.b2GearJointDef*/ var jd = new box2d.b2GearJointDef();\n");box2d.b2Log("  jd.bodyA = bodies[%d];\n",a);box2d.b2Log("  jd.bodyB = bodies[%d];\n",b);box2d.b2Log("  jd.collideConnected = %s;\n",this.m_collideConnected?"true":"false");box2d.b2Log("  jd.joint1 = joints[%d];\n",d);box2d.b2Log("  jd.joint2 = joints[%d];\n",
e);box2d.b2Log("  jd.ratio = %.15f;\n",this.m_ratio);box2d.b2Log("  joints[%d] = this.m_world.CreateJoint(jd);\n",this.m_index)}};goog.exportProperty(box2d.b2GearJoint.prototype,"Dump",box2d.b2GearJoint.prototype.Dump);box2d.b2RopeJointDef=function(){box2d.b2JointDef.call(this,box2d.b2JointType.e_ropeJoint);this.localAnchorA=new box2d.b2Vec2(-1,0);this.localAnchorB=new box2d.b2Vec2(1,0)};goog.inherits(box2d.b2RopeJointDef,box2d.b2JointDef);goog.exportSymbol("box2d.b2RopeJointDef",box2d.b2RopeJointDef);
box2d.b2RopeJointDef.prototype.localAnchorA=null;goog.exportProperty(box2d.b2RopeJointDef.prototype,"localAnchorA",box2d.b2RopeJointDef.prototype.localAnchorA);box2d.b2RopeJointDef.prototype.localAnchorB=null;goog.exportProperty(box2d.b2RopeJointDef.prototype,"localAnchorB",box2d.b2RopeJointDef.prototype.localAnchorB);box2d.b2RopeJointDef.prototype.maxLength=0;goog.exportProperty(box2d.b2RopeJointDef.prototype,"maxLength",box2d.b2RopeJointDef.prototype.maxLength);
box2d.b2RopeJoint=function(a){box2d.b2Joint.call(this,a);this.m_localAnchorA=a.localAnchorA.Clone();this.m_localAnchorB=a.localAnchorB.Clone();this.m_maxLength=a.maxLength;this.m_u=new box2d.b2Vec2;this.m_rA=new box2d.b2Vec2;this.m_rB=new box2d.b2Vec2;this.m_localCenterA=new box2d.b2Vec2;this.m_localCenterB=new box2d.b2Vec2;this.m_qA=new box2d.b2Rot;this.m_qB=new box2d.b2Rot;this.m_lalcA=new box2d.b2Vec2;this.m_lalcB=new box2d.b2Vec2};goog.inherits(box2d.b2RopeJoint,box2d.b2Joint);
goog.exportSymbol("box2d.b2RopeJoint",box2d.b2RopeJoint);box2d.b2RopeJoint.prototype.m_localAnchorA=null;goog.exportProperty(box2d.b2RopeJoint.prototype,"m_localAnchorA",box2d.b2RopeJoint.prototype.m_localAnchorA);box2d.b2RopeJoint.prototype.m_localAnchorB=null;goog.exportProperty(box2d.b2RopeJoint.prototype,"m_localAnchorB",box2d.b2RopeJoint.prototype.m_localAnchorB);box2d.b2RopeJoint.prototype.m_maxLength=0;goog.exportProperty(box2d.b2RopeJoint.prototype,"m_maxLength",box2d.b2RopeJoint.prototype.m_maxLength);
box2d.b2RopeJoint.prototype.m_length=0;goog.exportProperty(box2d.b2RopeJoint.prototype,"m_length",box2d.b2RopeJoint.prototype.m_length);box2d.b2RopeJoint.prototype.m_impulse=0;goog.exportProperty(box2d.b2RopeJoint.prototype,"m_impulse",box2d.b2RopeJoint.prototype.m_impulse);box2d.b2RopeJoint.prototype.m_indexA=0;goog.exportProperty(box2d.b2RopeJoint.prototype,"m_indexA",box2d.b2RopeJoint.prototype.m_indexA);box2d.b2RopeJoint.prototype.m_indexB=0;
goog.exportProperty(box2d.b2RopeJoint.prototype,"m_indexB",box2d.b2RopeJoint.prototype.m_indexB);box2d.b2RopeJoint.prototype.m_u=null;goog.exportProperty(box2d.b2RopeJoint.prototype,"m_u",box2d.b2RopeJoint.prototype.m_u);box2d.b2RopeJoint.prototype.m_rA=null;goog.exportProperty(box2d.b2RopeJoint.prototype,"m_rA",box2d.b2RopeJoint.prototype.m_rA);box2d.b2RopeJoint.prototype.m_rB=null;goog.exportProperty(box2d.b2RopeJoint.prototype,"m_rB",box2d.b2RopeJoint.prototype.m_rB);
box2d.b2RopeJoint.prototype.m_localCenterA=null;goog.exportProperty(box2d.b2RopeJoint.prototype,"m_localCenterA",box2d.b2RopeJoint.prototype.m_localCenterA);box2d.b2RopeJoint.prototype.m_localCenterB=null;goog.exportProperty(box2d.b2RopeJoint.prototype,"m_localCenterB",box2d.b2RopeJoint.prototype.m_localCenterB);box2d.b2RopeJoint.prototype.m_invMassA=0;goog.exportProperty(box2d.b2RopeJoint.prototype,"m_invMassA",box2d.b2RopeJoint.prototype.m_invMassA);box2d.b2RopeJoint.prototype.m_invMassB=0;
goog.exportProperty(box2d.b2RopeJoint.prototype,"m_invMassB",box2d.b2RopeJoint.prototype.m_invMassB);box2d.b2RopeJoint.prototype.m_invIA=0;goog.exportProperty(box2d.b2RopeJoint.prototype,"m_invIA",box2d.b2RopeJoint.prototype.m_invIA);box2d.b2RopeJoint.prototype.m_invIB=0;goog.exportProperty(box2d.b2RopeJoint.prototype,"m_invIB",box2d.b2RopeJoint.prototype.m_invIB);box2d.b2RopeJoint.prototype.m_mass=0;goog.exportProperty(box2d.b2RopeJoint.prototype,"m_mass",box2d.b2RopeJoint.prototype.m_mass);
box2d.b2RopeJoint.prototype.m_state=box2d.b2LimitState.e_inactiveLimit;goog.exportProperty(box2d.b2RopeJoint.prototype,"m_state",box2d.b2RopeJoint.prototype.m_state);box2d.b2RopeJoint.prototype.m_qA=null;goog.exportProperty(box2d.b2RopeJoint.prototype,"m_qA",box2d.b2RopeJoint.prototype.m_qA);box2d.b2RopeJoint.prototype.m_qB=null;goog.exportProperty(box2d.b2RopeJoint.prototype,"m_qB",box2d.b2RopeJoint.prototype.m_qB);box2d.b2RopeJoint.prototype.m_lalcA=null;
goog.exportProperty(box2d.b2RopeJoint.prototype,"m_lalcA",box2d.b2RopeJoint.prototype.m_lalcA);box2d.b2RopeJoint.prototype.m_lalcB=null;goog.exportProperty(box2d.b2RopeJoint.prototype,"m_lalcB",box2d.b2RopeJoint.prototype.m_lalcB);
box2d.b2RopeJoint.prototype.InitVelocityConstraints=function(a){this.m_indexA=this.m_bodyA.m_islandIndex;this.m_indexB=this.m_bodyB.m_islandIndex;this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter);this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter);this.m_invMassA=this.m_bodyA.m_invMass;this.m_invMassB=this.m_bodyB.m_invMass;this.m_invIA=this.m_bodyA.m_invI;this.m_invIB=this.m_bodyB.m_invI;var b=a.positions[this.m_indexA].c,d=a.velocities[this.m_indexA].v,e=a.velocities[this.m_indexA].w,
f=a.positions[this.m_indexB].c,g=a.positions[this.m_indexB].a,k=a.velocities[this.m_indexB].v,m=a.velocities[this.m_indexB].w,n=this.m_qA.SetAngle(a.positions[this.m_indexA].a),g=this.m_qB.SetAngle(g);box2d.b2Sub_V2_V2(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA);box2d.b2Mul_R_V2(n,this.m_lalcA,this.m_rA);box2d.b2Sub_V2_V2(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB);box2d.b2Mul_R_V2(g,this.m_lalcB,this.m_rB);this.m_u.Copy(f).SelfAdd(this.m_rB).SelfSub(b).SelfSub(this.m_rA);this.m_length=
this.m_u.Length();this.m_state=0<this.m_length-this.m_maxLength?box2d.b2LimitState.e_atUpperLimit:box2d.b2LimitState.e_inactiveLimit;this.m_length>box2d.b2_linearSlop?(this.m_u.SelfMul(1/this.m_length),b=box2d.b2Cross_V2_V2(this.m_rA,this.m_u),f=box2d.b2Cross_V2_V2(this.m_rB,this.m_u),b=this.m_invMassA+this.m_invIA*b*b+this.m_invMassB+this.m_invIB*f*f,this.m_mass=0!==b?1/b:0,a.step.warmStarting?(this.m_impulse*=a.step.dtRatio,b=box2d.b2Mul_S_V2(this.m_impulse,this.m_u,box2d.b2RopeJoint.prototype.InitVelocityConstraints.s_P),
d.SelfMulSub(this.m_invMassA,b),e-=this.m_invIA*box2d.b2Cross_V2_V2(this.m_rA,b),k.SelfMulAdd(this.m_invMassB,b),m+=this.m_invIB*box2d.b2Cross_V2_V2(this.m_rB,b)):this.m_impulse=0,a.velocities[this.m_indexA].w=e,a.velocities[this.m_indexB].w=m):(this.m_u.SetZero(),this.m_impulse=this.m_mass=0)};goog.exportProperty(box2d.b2RopeJoint.prototype,"InitVelocityConstraints",box2d.b2RopeJoint.prototype.InitVelocityConstraints);box2d.b2RopeJoint.prototype.InitVelocityConstraints.s_P=new box2d.b2Vec2;
box2d.b2RopeJoint.prototype.SolveVelocityConstraints=function(a){var b=a.velocities[this.m_indexA].v,d=a.velocities[this.m_indexA].w,e=a.velocities[this.m_indexB].v,f=a.velocities[this.m_indexB].w,g=box2d.b2AddCross_V2_S_V2(b,d,this.m_rA,box2d.b2RopeJoint.prototype.SolveVelocityConstraints.s_vpA),k=box2d.b2AddCross_V2_S_V2(e,f,this.m_rB,box2d.b2RopeJoint.prototype.SolveVelocityConstraints.s_vpB),m=this.m_length-this.m_maxLength,g=box2d.b2Dot_V2_V2(this.m_u,box2d.b2Sub_V2_V2(k,g,box2d.b2Vec2.s_t0));
0>m&&(g+=a.step.inv_dt*m);m=-this.m_mass*g;g=this.m_impulse;this.m_impulse=box2d.b2Min(0,this.m_impulse+m);m=this.m_impulse-g;m=box2d.b2Mul_S_V2(m,this.m_u,box2d.b2RopeJoint.prototype.SolveVelocityConstraints.s_P);b.SelfMulSub(this.m_invMassA,m);d-=this.m_invIA*box2d.b2Cross_V2_V2(this.m_rA,m);e.SelfMulAdd(this.m_invMassB,m);f+=this.m_invIB*box2d.b2Cross_V2_V2(this.m_rB,m);a.velocities[this.m_indexA].w=d;a.velocities[this.m_indexB].w=f};
goog.exportProperty(box2d.b2RopeJoint.prototype,"SolveVelocityConstraints",box2d.b2RopeJoint.prototype.SolveVelocityConstraints);box2d.b2RopeJoint.prototype.SolveVelocityConstraints.s_vpA=new box2d.b2Vec2;box2d.b2RopeJoint.prototype.SolveVelocityConstraints.s_vpB=new box2d.b2Vec2;box2d.b2RopeJoint.prototype.SolveVelocityConstraints.s_P=new box2d.b2Vec2;
box2d.b2RopeJoint.prototype.SolvePositionConstraints=function(a){var b=a.positions[this.m_indexA].c,d=a.positions[this.m_indexA].a,e=a.positions[this.m_indexB].c,f=a.positions[this.m_indexB].a,g=this.m_qA.SetAngle(d),k=this.m_qB.SetAngle(f);box2d.b2Sub_V2_V2(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA);g=box2d.b2Mul_R_V2(g,this.m_lalcA,this.m_rA);box2d.b2Sub_V2_V2(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB);var k=box2d.b2Mul_R_V2(k,this.m_lalcB,this.m_rB),m=this.m_u.Copy(e).SelfAdd(k).SelfSub(b).SelfSub(g),
n=m.Normalize(),q=n-this.m_maxLength,q=box2d.b2Clamp(q,0,box2d.b2_maxLinearCorrection),m=box2d.b2Mul_S_V2(-this.m_mass*q,m,box2d.b2RopeJoint.prototype.SolvePositionConstraints.s_P);b.SelfMulSub(this.m_invMassA,m);d-=this.m_invIA*box2d.b2Cross_V2_V2(g,m);e.SelfMulAdd(this.m_invMassB,m);f+=this.m_invIB*box2d.b2Cross_V2_V2(k,m);a.positions[this.m_indexA].a=d;a.positions[this.m_indexB].a=f;return n-this.m_maxLength<box2d.b2_linearSlop};
goog.exportProperty(box2d.b2RopeJoint.prototype,"SolvePositionConstraints",box2d.b2RopeJoint.prototype.SolvePositionConstraints);box2d.b2RopeJoint.prototype.SolvePositionConstraints.s_P=new box2d.b2Vec2;box2d.b2RopeJoint.prototype.GetAnchorA=function(a){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,a)};goog.exportProperty(box2d.b2RopeJoint.prototype,"GetAnchorA",box2d.b2RopeJoint.prototype.GetAnchorA);
box2d.b2RopeJoint.prototype.GetAnchorB=function(a){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,a)};goog.exportProperty(box2d.b2RopeJoint.prototype,"GetAnchorB",box2d.b2RopeJoint.prototype.GetAnchorB);box2d.b2RopeJoint.prototype.GetReactionForce=function(a,b){return box2d.b2Mul_S_V2(a*this.m_impulse,this.m_u,b)};goog.exportProperty(box2d.b2RopeJoint.prototype,"GetReactionForce",box2d.b2RopeJoint.prototype.GetReactionForce);box2d.b2RopeJoint.prototype.GetReactionTorque=function(a){return 0};
goog.exportProperty(box2d.b2RopeJoint.prototype,"GetReactionTorque",box2d.b2RopeJoint.prototype.GetReactionTorque);box2d.b2RopeJoint.prototype.GetLocalAnchorA=function(a){return a.Copy(this.m_localAnchorA)};goog.exportProperty(box2d.b2RopeJoint.prototype,"GetLocalAnchorA",box2d.b2RopeJoint.prototype.GetLocalAnchorA);box2d.b2RopeJoint.prototype.GetLocalAnchorB=function(a){return a.Copy(this.m_localAnchorB)};goog.exportProperty(box2d.b2RopeJoint.prototype,"GetLocalAnchorB",box2d.b2RopeJoint.prototype.GetLocalAnchorB);
box2d.b2RopeJoint.prototype.SetMaxLength=function(a){this.m_maxLength=a};goog.exportProperty(box2d.b2RopeJoint.prototype,"SetMaxLength",box2d.b2RopeJoint.prototype.SetMaxLength);box2d.b2RopeJoint.prototype.GetMaxLength=function(){return this.m_maxLength};goog.exportProperty(box2d.b2RopeJoint.prototype,"GetMaxLength",box2d.b2RopeJoint.prototype.GetMaxLength);box2d.b2RopeJoint.prototype.GetLimitState=function(){return this.m_state};goog.exportProperty(box2d.b2RopeJoint.prototype,"GetLimitState",box2d.b2RopeJoint.prototype.GetLimitState);
box2d.b2RopeJoint.prototype.Dump=function(){if(box2d.DEBUG){var a=this.m_bodyA.m_islandIndex,b=this.m_bodyB.m_islandIndex;box2d.b2Log("  /*box2d.b2RopeJointDef*/ var jd = new box2d.b2RopeJointDef();\n");box2d.b2Log("  jd.bodyA = bodies[%d];\n",a);box2d.b2Log("  jd.bodyB = bodies[%d];\n",b);box2d.b2Log("  jd.collideConnected = %s;\n",this.m_collideConnected?"true":"false");box2d.b2Log("  jd.localAnchorA.Set(%.15f, %.15f);\n",this.m_localAnchorA.x,this.m_localAnchorA.y);box2d.b2Log("  jd.localAnchorB.Set(%.15f, %.15f);\n",
this.m_localAnchorB.x,this.m_localAnchorB.y);box2d.b2Log("  jd.maxLength = %.15f;\n",this.m_maxLength);box2d.b2Log("  joints[%d] = this.m_world.CreateJoint(jd);\n",this.m_index)}};goog.exportProperty(box2d.b2RopeJoint.prototype,"Dump",box2d.b2RopeJoint.prototype.Dump);box2d.b2WeldJointDef=function(){box2d.b2JointDef.call(this,box2d.b2JointType.e_weldJoint);this.localAnchorA=new box2d.b2Vec2;this.localAnchorB=new box2d.b2Vec2};goog.inherits(box2d.b2WeldJointDef,box2d.b2JointDef);
goog.exportSymbol("box2d.b2WeldJointDef",box2d.b2WeldJointDef);box2d.b2WeldJointDef.prototype.localAnchorA=null;goog.exportProperty(box2d.b2WeldJointDef.prototype,"localAnchorA",box2d.b2WeldJointDef.prototype.localAnchorA);box2d.b2WeldJointDef.prototype.localAnchorB=null;goog.exportProperty(box2d.b2WeldJointDef.prototype,"localAnchorB",box2d.b2WeldJointDef.prototype.localAnchorB);box2d.b2WeldJointDef.prototype.referenceAngle=0;goog.exportProperty(box2d.b2WeldJointDef.prototype,"referenceAngle",box2d.b2WeldJointDef.prototype.referenceAngle);
box2d.b2WeldJointDef.prototype.frequencyHz=0;goog.exportProperty(box2d.b2WeldJointDef.prototype,"frequencyHz",box2d.b2WeldJointDef.prototype.frequencyHz);box2d.b2WeldJointDef.prototype.dampingRatio=0;goog.exportProperty(box2d.b2WeldJointDef.prototype,"dampingRatio",box2d.b2WeldJointDef.prototype.dampingRatio);
box2d.b2WeldJointDef.prototype.Initialize=function(a,b,d){this.bodyA=a;this.bodyB=b;this.bodyA.GetLocalPoint(d,this.localAnchorA);this.bodyB.GetLocalPoint(d,this.localAnchorB);this.referenceAngle=this.bodyB.GetAngle()-this.bodyA.GetAngle()};goog.exportProperty(box2d.b2WeldJointDef.prototype,"Initialize",box2d.b2WeldJointDef.prototype.Initialize);
box2d.b2WeldJoint=function(a){box2d.b2Joint.call(this,a);this.m_frequencyHz=a.frequencyHz;this.m_dampingRatio=a.dampingRatio;this.m_localAnchorA=a.localAnchorA.Clone();this.m_localAnchorB=a.localAnchorB.Clone();this.m_referenceAngle=a.referenceAngle;this.m_impulse=new box2d.b2Vec3(0,0,0);this.m_rA=new box2d.b2Vec2;this.m_rB=new box2d.b2Vec2;this.m_localCenterA=new box2d.b2Vec2;this.m_localCenterB=new box2d.b2Vec2;this.m_mass=new box2d.b2Mat33;this.m_qA=new box2d.b2Rot;this.m_qB=new box2d.b2Rot;this.m_lalcA=
new box2d.b2Vec2;this.m_lalcB=new box2d.b2Vec2;this.m_K=new box2d.b2Mat33};goog.inherits(box2d.b2WeldJoint,box2d.b2Joint);goog.exportSymbol("box2d.b2WeldJoint",box2d.b2WeldJoint);box2d.b2WeldJoint.prototype.m_frequencyHz=0;goog.exportProperty(box2d.b2WeldJoint.prototype,"m_frequencyHz",box2d.b2WeldJoint.prototype.m_frequencyHz);box2d.b2WeldJoint.prototype.m_dampingRatio=0;goog.exportProperty(box2d.b2WeldJoint.prototype,"m_dampingRatio",box2d.b2WeldJoint.prototype.m_dampingRatio);
box2d.b2WeldJoint.prototype.m_bias=0;goog.exportProperty(box2d.b2WeldJoint.prototype,"m_bias",box2d.b2WeldJoint.prototype.m_bias);box2d.b2WeldJoint.prototype.m_localAnchorA=null;goog.exportProperty(box2d.b2WeldJoint.prototype,"m_localAnchorA",box2d.b2WeldJoint.prototype.m_localAnchorA);box2d.b2WeldJoint.prototype.m_localAnchorB=null;goog.exportProperty(box2d.b2WeldJoint.prototype,"m_localAnchorB",box2d.b2WeldJoint.prototype.m_localAnchorB);box2d.b2WeldJoint.prototype.m_referenceAngle=0;
goog.exportProperty(box2d.b2WeldJoint.prototype,"m_referenceAngle",box2d.b2WeldJoint.prototype.m_referenceAngle);box2d.b2WeldJoint.prototype.m_gamma=0;goog.exportProperty(box2d.b2WeldJoint.prototype,"m_gamma",box2d.b2WeldJoint.prototype.m_gamma);box2d.b2WeldJoint.prototype.m_impulse=null;goog.exportProperty(box2d.b2WeldJoint.prototype,"m_impulse",box2d.b2WeldJoint.prototype.m_impulse);box2d.b2WeldJoint.prototype.m_indexA=0;goog.exportProperty(box2d.b2WeldJoint.prototype,"m_indexA",box2d.b2WeldJoint.prototype.m_indexA);
box2d.b2WeldJoint.prototype.m_indexB=0;goog.exportProperty(box2d.b2WeldJoint.prototype,"m_indexB",box2d.b2WeldJoint.prototype.m_indexB);box2d.b2WeldJoint.prototype.m_rA=null;goog.exportProperty(box2d.b2WeldJoint.prototype,"m_rA",box2d.b2WeldJoint.prototype.m_rA);box2d.b2WeldJoint.prototype.m_rB=null;goog.exportProperty(box2d.b2WeldJoint.prototype,"m_rB",box2d.b2WeldJoint.prototype.m_rB);box2d.b2WeldJoint.prototype.m_localCenterA=null;
goog.exportProperty(box2d.b2WeldJoint.prototype,"m_localCenterA",box2d.b2WeldJoint.prototype.m_localCenterA);box2d.b2WeldJoint.prototype.m_localCenterB=null;goog.exportProperty(box2d.b2WeldJoint.prototype,"m_localCenterB",box2d.b2WeldJoint.prototype.m_localCenterB);box2d.b2WeldJoint.prototype.m_invMassA=0;goog.exportProperty(box2d.b2WeldJoint.prototype,"m_invMassA",box2d.b2WeldJoint.prototype.m_invMassA);box2d.b2WeldJoint.prototype.m_invMassB=0;
goog.exportProperty(box2d.b2WeldJoint.prototype,"m_invMassB",box2d.b2WeldJoint.prototype.m_invMassB);box2d.b2WeldJoint.prototype.m_invIA=0;goog.exportProperty(box2d.b2WeldJoint.prototype,"m_invIA",box2d.b2WeldJoint.prototype.m_invIA);box2d.b2WeldJoint.prototype.m_invIB=0;goog.exportProperty(box2d.b2WeldJoint.prototype,"m_invIB",box2d.b2WeldJoint.prototype.m_invIB);box2d.b2WeldJoint.prototype.m_mass=null;goog.exportProperty(box2d.b2WeldJoint.prototype,"m_mass",box2d.b2WeldJoint.prototype.m_mass);
box2d.b2WeldJoint.prototype.m_qA=null;goog.exportProperty(box2d.b2WeldJoint.prototype,"m_qA",box2d.b2WeldJoint.prototype.m_qA);box2d.b2WeldJoint.prototype.m_qB=null;goog.exportProperty(box2d.b2WeldJoint.prototype,"m_qB",box2d.b2WeldJoint.prototype.m_qB);box2d.b2WeldJoint.prototype.m_lalcA=null;goog.exportProperty(box2d.b2WeldJoint.prototype,"m_lalcA",box2d.b2WeldJoint.prototype.m_lalcA);box2d.b2WeldJoint.prototype.m_lalcB=null;goog.exportProperty(box2d.b2WeldJoint.prototype,"m_lalcB",box2d.b2WeldJoint.prototype.m_lalcB);
box2d.b2WeldJoint.prototype.m_K=null;goog.exportProperty(box2d.b2WeldJoint.prototype,"m_K",box2d.b2WeldJoint.prototype.m_K);
box2d.b2WeldJoint.prototype.InitVelocityConstraints=function(a){this.m_indexA=this.m_bodyA.m_islandIndex;this.m_indexB=this.m_bodyB.m_islandIndex;this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter);this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter);this.m_invMassA=this.m_bodyA.m_invMass;this.m_invMassB=this.m_bodyB.m_invMass;this.m_invIA=this.m_bodyA.m_invI;this.m_invIB=this.m_bodyB.m_invI;var b=a.positions[this.m_indexA].a,d=a.velocities[this.m_indexA].v,e=a.velocities[this.m_indexA].w,
f=a.positions[this.m_indexB].a,g=a.velocities[this.m_indexB].v,k=a.velocities[this.m_indexB].w,m=this.m_qA.SetAngle(b),n=this.m_qB.SetAngle(f);box2d.b2Sub_V2_V2(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA);box2d.b2Mul_R_V2(m,this.m_lalcA,this.m_rA);box2d.b2Sub_V2_V2(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB);box2d.b2Mul_R_V2(n,this.m_lalcB,this.m_rB);var m=this.m_invMassA,n=this.m_invMassB,q=this.m_invIA,s=this.m_invIB,t=this.m_K;t.ex.x=m+n+this.m_rA.y*this.m_rA.y*q+this.m_rB.y*
this.m_rB.y*s;t.ey.x=-this.m_rA.y*this.m_rA.x*q-this.m_rB.y*this.m_rB.x*s;t.ez.x=-this.m_rA.y*q-this.m_rB.y*s;t.ex.y=t.ey.x;t.ey.y=m+n+this.m_rA.x*this.m_rA.x*q+this.m_rB.x*this.m_rB.x*s;t.ez.y=this.m_rA.x*q+this.m_rB.x*s;t.ex.z=t.ez.x;t.ey.z=t.ez.y;t.ez.z=q+s;if(0<this.m_frequencyHz){t.GetInverse22(this.m_mass);var t=q+s,u=0<t?1/t:0,b=f-b-this.m_referenceAngle,f=2*box2d.b2_pi*this.m_frequencyHz,v=u*f*f,y=a.step.dt;this.m_gamma=y*(2*u*this.m_dampingRatio*f+y*v);this.m_gamma=0!==this.m_gamma?1/this.m_gamma:
0;this.m_bias=b*y*v*this.m_gamma;t+=this.m_gamma;this.m_mass.ez.z=0!==t?1/t:0}else 0===t.ez.z?t.GetInverse22(this.m_mass):t.GetSymInverse33(this.m_mass),this.m_bias=this.m_gamma=0;a.step.warmStarting?(this.m_impulse.SelfMulScalar(a.step.dtRatio),t=box2d.b2WeldJoint.prototype.InitVelocityConstraints.s_P.Set(this.m_impulse.x,this.m_impulse.y),d.SelfMulSub(m,t),e-=q*(box2d.b2Cross_V2_V2(this.m_rA,t)+this.m_impulse.z),g.SelfMulAdd(n,t),k+=s*(box2d.b2Cross_V2_V2(this.m_rB,t)+this.m_impulse.z)):this.m_impulse.SetZero();
a.velocities[this.m_indexA].w=e;a.velocities[this.m_indexB].w=k};box2d.b2WeldJoint.prototype.InitVelocityConstraints.s_P=new box2d.b2Vec2;
box2d.b2WeldJoint.prototype.SolveVelocityConstraints=function(a){var b=a.velocities[this.m_indexA].v,d=a.velocities[this.m_indexA].w,e=a.velocities[this.m_indexB].v,f=a.velocities[this.m_indexB].w,g=this.m_invMassA,k=this.m_invMassB,m=this.m_invIA,n=this.m_invIB;if(0<this.m_frequencyHz){var q=-this.m_mass.ez.z*(f-d+this.m_bias+this.m_gamma*this.m_impulse.z);this.m_impulse.z+=q;d-=m*q;f+=n*q;q=box2d.b2Sub_V2_V2(box2d.b2AddCross_V2_S_V2(e,f,this.m_rB,box2d.b2Vec2.s_t0),box2d.b2AddCross_V2_S_V2(b,d,
this.m_rA,box2d.b2Vec2.s_t1),box2d.b2WeldJoint.prototype.SolveVelocityConstraints.s_Cdot1);q=box2d.b2Mul_M33_X_Y(this.m_mass,q.x,q.y,box2d.b2WeldJoint.prototype.SolveVelocityConstraints.s_impulse1).SelfNeg();this.m_impulse.x+=q.x;this.m_impulse.y+=q.y;b.SelfMulSub(g,q);d-=m*box2d.b2Cross_V2_V2(this.m_rA,q);e.SelfMulAdd(k,q);f+=n*box2d.b2Cross_V2_V2(this.m_rB,q)}else{var q=box2d.b2Sub_V2_V2(box2d.b2AddCross_V2_S_V2(e,f,this.m_rB,box2d.b2Vec2.s_t0),box2d.b2AddCross_V2_S_V2(b,d,this.m_rA,box2d.b2Vec2.s_t1),
box2d.b2WeldJoint.prototype.SolveVelocityConstraints.s_Cdot1),s=box2d.b2Mul_M33_X_Y_Z(this.m_mass,q.x,q.y,f-d,box2d.b2WeldJoint.prototype.SolveVelocityConstraints.s_impulse).SelfNeg();this.m_impulse.SelfAdd(s);q=box2d.b2WeldJoint.prototype.SolveVelocityConstraints.s_P.Set(s.x,s.y);b.SelfMulSub(g,q);d-=m*(box2d.b2Cross_V2_V2(this.m_rA,q)+s.z);e.SelfMulAdd(k,q);f+=n*(box2d.b2Cross_V2_V2(this.m_rB,q)+s.z)}a.velocities[this.m_indexA].w=d;a.velocities[this.m_indexB].w=f};
goog.exportProperty(box2d.b2WeldJoint.prototype,"SolveVelocityConstraints",box2d.b2WeldJoint.prototype.SolveVelocityConstraints);box2d.b2WeldJoint.prototype.SolveVelocityConstraints.s_Cdot1=new box2d.b2Vec2;box2d.b2WeldJoint.prototype.SolveVelocityConstraints.s_impulse1=new box2d.b2Vec2;box2d.b2WeldJoint.prototype.SolveVelocityConstraints.s_impulse=new box2d.b2Vec3;box2d.b2WeldJoint.prototype.SolveVelocityConstraints.s_P=new box2d.b2Vec2;
box2d.b2WeldJoint.prototype.SolvePositionConstraints=function(a){var b=a.positions[this.m_indexA].c,d=a.positions[this.m_indexA].a,e=a.positions[this.m_indexB].c,f=a.positions[this.m_indexB].a,g=this.m_qA.SetAngle(d),k=this.m_qB.SetAngle(f),m=this.m_invMassA,n=this.m_invMassB,q=this.m_invIA,s=this.m_invIB;box2d.b2Sub_V2_V2(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA);var t=box2d.b2Mul_R_V2(g,this.m_lalcA,this.m_rA);box2d.b2Sub_V2_V2(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB);var u=
box2d.b2Mul_R_V2(k,this.m_lalcB,this.m_rB),v=this.m_K;v.ex.x=m+n+t.y*t.y*q+u.y*u.y*s;v.ey.x=-t.y*t.x*q-u.y*u.x*s;v.ez.x=-t.y*q-u.y*s;v.ex.y=v.ey.x;v.ey.y=m+n+t.x*t.x*q+u.x*u.x*s;v.ez.y=t.x*q+u.x*s;v.ex.z=v.ez.x;v.ey.z=v.ez.y;v.ez.z=q+s;if(0<this.m_frequencyHz){var y=box2d.b2Sub_V2_V2(box2d.b2Add_V2_V2(e,u,box2d.b2Vec2.s_t0),box2d.b2Add_V2_V2(b,t,box2d.b2Vec2.s_t1),box2d.b2WeldJoint.prototype.SolvePositionConstraints.s_C1),k=y.Length(),g=0,v=v.Solve22(y.x,y.y,box2d.b2WeldJoint.prototype.SolvePositionConstraints.s_P).SelfNeg();
b.SelfMulSub(m,v);d-=q*box2d.b2Cross_V2_V2(t,v);e.SelfMulAdd(n,v);f+=s*box2d.b2Cross_V2_V2(u,v)}else y=box2d.b2Sub_V2_V2(box2d.b2Add_V2_V2(e,u,box2d.b2Vec2.s_t0),box2d.b2Add_V2_V2(b,t,box2d.b2Vec2.s_t1),box2d.b2WeldJoint.prototype.SolvePositionConstraints.s_C1),u=f-d-this.m_referenceAngle,k=y.Length(),g=box2d.b2Abs(u),t=box2d.b2WeldJoint.prototype.SolvePositionConstraints.s_impulse,0<v.ez.z?v.Solve33(y.x,y.y,u,t).SelfNeg():(v=v.Solve22(y.x,y.y,box2d.b2WeldJoint.prototype.SolvePositionConstraints.s_impulse2).SelfNeg(),
t.x=v.x,t.y=v.y,t.z=0),v=box2d.b2WeldJoint.prototype.SolvePositionConstraints.s_P.Set(t.x,t.y),b.SelfMulSub(m,v),d-=q*(box2d.b2Cross_V2_V2(this.m_rA,v)+t.z),e.SelfMulAdd(n,v),f+=s*(box2d.b2Cross_V2_V2(this.m_rB,v)+t.z);a.positions[this.m_indexA].a=d;a.positions[this.m_indexB].a=f;return k<=box2d.b2_linearSlop&&g<=box2d.b2_angularSlop};goog.exportProperty(box2d.b2WeldJoint.prototype,"SolvePositionConstraints",box2d.b2WeldJoint.prototype.SolvePositionConstraints);
box2d.b2WeldJoint.prototype.SolvePositionConstraints.s_C1=new box2d.b2Vec2;box2d.b2WeldJoint.prototype.SolvePositionConstraints.s_P=new box2d.b2Vec2;box2d.b2WeldJoint.prototype.SolvePositionConstraints.s_impulse=new box2d.b2Vec3;box2d.b2WeldJoint.prototype.SolvePositionConstraints.s_impulse2=new box2d.b2Vec2;box2d.b2WeldJoint.prototype.GetAnchorA=function(a){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,a)};goog.exportProperty(box2d.b2WeldJoint.prototype,"GetAnchorA",box2d.b2WeldJoint.prototype.GetAnchorA);
box2d.b2WeldJoint.prototype.GetAnchorB=function(a){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,a)};goog.exportProperty(box2d.b2WeldJoint.prototype,"GetAnchorB",box2d.b2WeldJoint.prototype.GetAnchorB);box2d.b2WeldJoint.prototype.GetReactionForce=function(a,b){return b.Set(a*this.m_impulse.x,a*this.m_impulse.y)};goog.exportProperty(box2d.b2WeldJoint.prototype,"GetReactionForce",box2d.b2WeldJoint.prototype.GetReactionForce);
box2d.b2WeldJoint.prototype.GetReactionTorque=function(a){return a*this.m_impulse.z};goog.exportProperty(box2d.b2WeldJoint.prototype,"GetReactionTorque",box2d.b2WeldJoint.prototype.GetReactionTorque);box2d.b2WeldJoint.prototype.GetLocalAnchorA=function(a){return a.Copy(this.m_localAnchorA)};goog.exportProperty(box2d.b2WeldJoint.prototype,"GetLocalAnchorA",box2d.b2WeldJoint.prototype.GetLocalAnchorA);box2d.b2WeldJoint.prototype.GetLocalAnchorB=function(a){return a.Copy(this.m_localAnchorB)};
goog.exportProperty(box2d.b2WeldJoint.prototype,"GetLocalAnchorB",box2d.b2WeldJoint.prototype.GetLocalAnchorB);box2d.b2WeldJoint.prototype.GetReferenceAngle=function(){return this.m_referenceAngle};goog.exportProperty(box2d.b2WeldJoint.prototype,"GetReferenceAngle",box2d.b2WeldJoint.prototype.GetReferenceAngle);box2d.b2WeldJoint.prototype.SetFrequency=function(a){this.m_frequencyHz=a};box2d.b2WeldJoint.prototype.GetFrequency=function(){return this.m_frequencyHz};
goog.exportProperty(box2d.b2WeldJoint.prototype,"GetFrequency",box2d.b2WeldJoint.prototype.GetFrequency);box2d.b2WeldJoint.prototype.SetDampingRatio=function(a){this.m_dampingRatio=a};box2d.b2WeldJoint.prototype.GetDampingRatio=function(){return this.m_dampingRatio};goog.exportProperty(box2d.b2WeldJoint.prototype,"GetDampingRatio",box2d.b2WeldJoint.prototype.GetDampingRatio);
box2d.b2WeldJoint.prototype.Dump=function(){if(box2d.DEBUG){var a=this.m_bodyA.m_islandIndex,b=this.m_bodyB.m_islandIndex;box2d.b2Log("  /*box2d.b2WeldJointDef*/ var jd = new box2d.b2WeldJointDef();\n");box2d.b2Log("  jd.bodyA = bodies[%d];\n",a);box2d.b2Log("  jd.bodyB = bodies[%d];\n",b);box2d.b2Log("  jd.collideConnected = %s;\n",this.m_collideConnected?"true":"false");box2d.b2Log("  jd.localAnchorA.Set(%.15f, %.15f);\n",this.m_localAnchorA.x,this.m_localAnchorA.y);box2d.b2Log("  jd.localAnchorB.Set(%.15f, %.15f);\n",
this.m_localAnchorB.x,this.m_localAnchorB.y);box2d.b2Log("  jd.referenceAngle = %.15f;\n",this.m_referenceAngle);box2d.b2Log("  jd.frequencyHz = %.15f;\n",this.m_frequencyHz);box2d.b2Log("  jd.dampingRatio = %.15f;\n",this.m_dampingRatio);box2d.b2Log("  joints[%d] = this.m_world.CreateJoint(jd);\n",this.m_index)}};goog.exportProperty(box2d.b2WeldJoint.prototype,"Dump",box2d.b2WeldJoint.prototype.Dump);
box2d.b2WheelJointDef=function(){box2d.b2JointDef.call(this,box2d.b2JointType.e_wheelJoint);this.localAnchorA=new box2d.b2Vec2(0,0);this.localAnchorB=new box2d.b2Vec2(0,0);this.localAxisA=new box2d.b2Vec2(1,0)};goog.inherits(box2d.b2WheelJointDef,box2d.b2JointDef);goog.exportSymbol("box2d.b2WheelJointDef",box2d.b2WheelJointDef);box2d.b2WheelJointDef.prototype.localAnchorA=null;goog.exportProperty(box2d.b2WheelJointDef.prototype,"localAnchorA",box2d.b2WheelJointDef.prototype.localAnchorA);
box2d.b2WheelJointDef.prototype.localAnchorB=null;goog.exportProperty(box2d.b2WheelJointDef.prototype,"localAnchorB",box2d.b2WheelJointDef.prototype.localAnchorB);box2d.b2WheelJointDef.prototype.localAxisA=null;goog.exportProperty(box2d.b2WheelJointDef.prototype,"localAxisA",box2d.b2WheelJointDef.prototype.localAxisA);box2d.b2WheelJointDef.prototype.enableMotor=!1;goog.exportProperty(box2d.b2WheelJointDef.prototype,"enableMotor",box2d.b2WheelJointDef.prototype.enableMotor);
box2d.b2WheelJointDef.prototype.maxMotorTorque=0;goog.exportProperty(box2d.b2WheelJointDef.prototype,"maxMotorTorque",box2d.b2WheelJointDef.prototype.maxMotorTorque);box2d.b2WheelJointDef.prototype.motorSpeed=0;goog.exportProperty(box2d.b2WheelJointDef.prototype,"motorSpeed",box2d.b2WheelJointDef.prototype.motorSpeed);box2d.b2WheelJointDef.prototype.frequencyHz=2;goog.exportProperty(box2d.b2WheelJointDef.prototype,"frequencyHz",box2d.b2WheelJointDef.prototype.frequencyHz);
box2d.b2WheelJointDef.prototype.dampingRatio=.7;goog.exportProperty(box2d.b2WheelJointDef.prototype,"dampingRatio",box2d.b2WheelJointDef.prototype.dampingRatio);box2d.b2WheelJointDef.prototype.Initialize=function(a,b,d,e){this.bodyA=a;this.bodyB=b;this.bodyA.GetLocalPoint(d,this.localAnchorA);this.bodyB.GetLocalPoint(d,this.localAnchorB);this.bodyA.GetLocalVector(e,this.localAxisA)};goog.exportProperty(box2d.b2WheelJointDef.prototype,"Initialize",box2d.b2WheelJointDef.prototype.Initialize);
box2d.b2WheelJoint=function(a){box2d.b2Joint.call(this,a);this.m_frequencyHz=a.frequencyHz;this.m_dampingRatio=a.dampingRatio;this.m_localAnchorA=a.localAnchorA.Clone();this.m_localAnchorB=a.localAnchorB.Clone();this.m_localXAxisA=a.localAxisA.Clone();this.m_localYAxisA=box2d.b2Cross_S_V2(1,this.m_localXAxisA,new box2d.b2Vec2);this.m_maxMotorTorque=a.maxMotorTorque;this.m_motorSpeed=a.motorSpeed;this.m_enableMotor=a.enableMotor;this.m_localCenterA=new box2d.b2Vec2;this.m_localCenterB=new box2d.b2Vec2;
this.m_ax=new box2d.b2Vec2;this.m_ay=new box2d.b2Vec2;this.m_qA=new box2d.b2Rot;this.m_qB=new box2d.b2Rot;this.m_lalcA=new box2d.b2Vec2;this.m_lalcB=new box2d.b2Vec2;this.m_rA=new box2d.b2Vec2;this.m_rB=new box2d.b2Vec2;this.m_ax.SetZero();this.m_ay.SetZero()};goog.inherits(box2d.b2WheelJoint,box2d.b2Joint);goog.exportSymbol("box2d.b2WheelJoint",box2d.b2WheelJoint);box2d.b2WheelJoint.prototype.m_frequencyHz=0;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_frequencyHz",box2d.b2WheelJoint.prototype.m_frequencyHz);
box2d.b2WheelJoint.prototype.m_dampingRatio=0;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_dampingRatio",box2d.b2WheelJoint.prototype.m_dampingRatio);box2d.b2WheelJoint.prototype.m_localAnchorA=null;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_localAnchorA",box2d.b2WheelJoint.prototype.m_localAnchorA);box2d.b2WheelJoint.prototype.m_localAnchorB=null;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_localAnchorB",box2d.b2WheelJoint.prototype.m_localAnchorB);
box2d.b2WheelJoint.prototype.m_localXAxisA=null;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_localXAxisA",box2d.b2WheelJoint.prototype.m_localXAxisA);box2d.b2WheelJoint.prototype.m_localYAxisA=null;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_localYAxisA",box2d.b2WheelJoint.prototype.m_localYAxisA);box2d.b2WheelJoint.prototype.m_impulse=0;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_impulse",box2d.b2WheelJoint.prototype.m_impulse);box2d.b2WheelJoint.prototype.m_motorImpulse=0;
goog.exportProperty(box2d.b2WheelJoint.prototype,"m_motorImpulse",box2d.b2WheelJoint.prototype.m_motorImpulse);box2d.b2WheelJoint.prototype.m_springImpulse=0;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_springImpulse",box2d.b2WheelJoint.prototype.m_springImpulse);box2d.b2WheelJoint.prototype.m_maxMotorTorque=0;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_maxMotorTorque",box2d.b2WheelJoint.prototype.m_maxMotorTorque);box2d.b2WheelJoint.prototype.m_motorSpeed=0;
goog.exportProperty(box2d.b2WheelJoint.prototype,"m_motorSpeed",box2d.b2WheelJoint.prototype.m_motorSpeed);box2d.b2WheelJoint.prototype.m_enableMotor=!1;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_enableMotor",box2d.b2WheelJoint.prototype.m_enableMotor);box2d.b2WheelJoint.prototype.m_indexA=0;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_indexA",box2d.b2WheelJoint.prototype.m_indexA);box2d.b2WheelJoint.prototype.m_indexB=0;
goog.exportProperty(box2d.b2WheelJoint.prototype,"m_indexB",box2d.b2WheelJoint.prototype.m_indexB);box2d.b2WheelJoint.prototype.m_localCenterA=null;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_localCenterA",box2d.b2WheelJoint.prototype.m_localCenterA);box2d.b2WheelJoint.prototype.m_localCenterB=null;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_localCenterB",box2d.b2WheelJoint.prototype.m_localCenterB);box2d.b2WheelJoint.prototype.m_invMassA=0;
goog.exportProperty(box2d.b2WheelJoint.prototype,"m_invMassA",box2d.b2WheelJoint.prototype.m_invMassA);box2d.b2WheelJoint.prototype.m_invMassB=0;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_invMassB",box2d.b2WheelJoint.prototype.m_invMassB);box2d.b2WheelJoint.prototype.m_invIA=0;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_invIA",box2d.b2WheelJoint.prototype.m_invIA);box2d.b2WheelJoint.prototype.m_invIB=0;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_invIB",box2d.b2WheelJoint.prototype.m_invIB);
box2d.b2WheelJoint.prototype.m_ax=null;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_ax",box2d.b2WheelJoint.prototype.m_ax);box2d.b2WheelJoint.prototype.m_ay=null;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_ay",box2d.b2WheelJoint.prototype.m_ay);box2d.b2WheelJoint.prototype.m_sAx=0;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_sAx",box2d.b2WheelJoint.prototype.m_sAx);box2d.b2WheelJoint.prototype.m_sBx=0;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_sBx",box2d.b2WheelJoint.prototype.m_sBx);
box2d.b2WheelJoint.prototype.m_sAy=0;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_sAy",box2d.b2WheelJoint.prototype.m_sAy);box2d.b2WheelJoint.prototype.m_sBy=0;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_sBy",box2d.b2WheelJoint.prototype.m_sBy);box2d.b2WheelJoint.prototype.m_mass=0;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_mass",box2d.b2WheelJoint.prototype.m_mass);box2d.b2WheelJoint.prototype.m_motorMass=0;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_motorMass",box2d.b2WheelJoint.prototype.m_motorMass);
box2d.b2WheelJoint.prototype.m_springMass=0;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_springMass",box2d.b2WheelJoint.prototype.m_springMass);box2d.b2WheelJoint.prototype.m_bias=0;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_bias",box2d.b2WheelJoint.prototype.m_bias);box2d.b2WheelJoint.prototype.m_gamma=0;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_gamma",box2d.b2WheelJoint.prototype.m_gamma);box2d.b2WheelJoint.prototype.m_qA=null;
goog.exportProperty(box2d.b2WheelJoint.prototype,"m_qA",box2d.b2WheelJoint.prototype.m_qA);box2d.b2WheelJoint.prototype.m_qB=null;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_qB",box2d.b2WheelJoint.prototype.m_qB);box2d.b2WheelJoint.prototype.m_lalcA=null;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_lalcA",box2d.b2WheelJoint.prototype.m_lalcA);box2d.b2WheelJoint.prototype.m_lalcB=null;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_lalcB",box2d.b2WheelJoint.prototype.m_lalcB);
box2d.b2WheelJoint.prototype.m_rA=null;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_rA",box2d.b2WheelJoint.prototype.m_rA);box2d.b2WheelJoint.prototype.m_rB=null;goog.exportProperty(box2d.b2WheelJoint.prototype,"m_rB",box2d.b2WheelJoint.prototype.m_rB);box2d.b2WheelJoint.prototype.GetMotorSpeed=function(){return this.m_motorSpeed};goog.exportProperty(box2d.b2WheelJoint.prototype,"GetMotorSpeed",box2d.b2WheelJoint.prototype.GetMotorSpeed);box2d.b2WheelJoint.prototype.GetMaxMotorTorque=function(){return this.m_maxMotorTorque};
goog.exportProperty(box2d.b2WheelJoint.prototype,"GetMaxMotorTorque",box2d.b2WheelJoint.prototype.GetMaxMotorTorque);box2d.b2WheelJoint.prototype.SetSpringFrequencyHz=function(a){this.m_frequencyHz=a};goog.exportProperty(box2d.b2WheelJoint.prototype,"SetSpringFrequencyHz",box2d.b2WheelJoint.prototype.SetSpringFrequencyHz);box2d.b2WheelJoint.prototype.GetSpringFrequencyHz=function(){return this.m_frequencyHz};goog.exportProperty(box2d.b2WheelJoint.prototype,"GetSpringFrequencyHz",box2d.b2WheelJoint.prototype.GetSpringFrequencyHz);
box2d.b2WheelJoint.prototype.SetSpringDampingRatio=function(a){this.m_dampingRatio=a};goog.exportProperty(box2d.b2WheelJoint.prototype,"SetSpringDampingRatio",box2d.b2WheelJoint.prototype.SetSpringDampingRatio);box2d.b2WheelJoint.prototype.GetSpringDampingRatio=function(){return this.m_dampingRatio};goog.exportProperty(box2d.b2WheelJoint.prototype,"GetSpringDampingRatio",box2d.b2WheelJoint.prototype.GetSpringDampingRatio);
box2d.b2WheelJoint.prototype.InitVelocityConstraints=function(a){this.m_indexA=this.m_bodyA.m_islandIndex;this.m_indexB=this.m_bodyB.m_islandIndex;this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter);this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter);this.m_invMassA=this.m_bodyA.m_invMass;this.m_invMassB=this.m_bodyB.m_invMass;this.m_invIA=this.m_bodyA.m_invI;this.m_invIB=this.m_bodyB.m_invI;var b=this.m_invMassA,d=this.m_invMassB,e=this.m_invIA,f=this.m_invIB,g=a.positions[this.m_indexA].c,
k=a.velocities[this.m_indexA].v,m=a.velocities[this.m_indexA].w,n=a.positions[this.m_indexB].c,q=a.positions[this.m_indexB].a,s=a.velocities[this.m_indexB].v,t=a.velocities[this.m_indexB].w,u=this.m_qA.SetAngle(a.positions[this.m_indexA].a),v=this.m_qB.SetAngle(q);box2d.b2Sub_V2_V2(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA);q=box2d.b2Mul_R_V2(u,this.m_lalcA,this.m_rA);box2d.b2Sub_V2_V2(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB);v=box2d.b2Mul_R_V2(v,this.m_lalcB,this.m_rB);g=
box2d.b2Sub_V2_V2(box2d.b2Add_V2_V2(n,v,box2d.b2Vec2.s_t0),box2d.b2Add_V2_V2(g,q,box2d.b2Vec2.s_t1),box2d.b2WheelJoint.prototype.InitVelocityConstraints.s_d);box2d.b2Mul_R_V2(u,this.m_localYAxisA,this.m_ay);this.m_sAy=box2d.b2Cross_V2_V2(box2d.b2Add_V2_V2(g,q,box2d.b2Vec2.s_t0),this.m_ay);this.m_sBy=box2d.b2Cross_V2_V2(v,this.m_ay);this.m_mass=b+d+e*this.m_sAy*this.m_sAy+f*this.m_sBy*this.m_sBy;0<this.m_mass&&(this.m_mass=1/this.m_mass);this.m_gamma=this.m_bias=this.m_springMass=0;0<this.m_frequencyHz?
(box2d.b2Mul_R_V2(u,this.m_localXAxisA,this.m_ax),this.m_sAx=box2d.b2Cross_V2_V2(box2d.b2Add_V2_V2(g,q,box2d.b2Vec2.s_t0),this.m_ax),this.m_sBx=box2d.b2Cross_V2_V2(v,this.m_ax),b=b+d+e*this.m_sAx*this.m_sAx+f*this.m_sBx*this.m_sBx,0<b&&(this.m_springMass=1/b,d=box2d.b2Dot_V2_V2(g,this.m_ax),u=2*box2d.b2_pi*this.m_frequencyHz,g=this.m_springMass*u*u,n=a.step.dt,this.m_gamma=n*(2*this.m_springMass*this.m_dampingRatio*u+n*g),0<this.m_gamma&&(this.m_gamma=1/this.m_gamma),this.m_bias=d*n*g*this.m_gamma,
this.m_springMass=b+this.m_gamma,0<this.m_springMass&&(this.m_springMass=1/this.m_springMass))):this.m_springImpulse=0;this.m_enableMotor?(this.m_motorMass=e+f,0<this.m_motorMass&&(this.m_motorMass=1/this.m_motorMass)):this.m_motorImpulse=this.m_motorMass=0;a.step.warmStarting?(this.m_impulse*=a.step.dtRatio,this.m_springImpulse*=a.step.dtRatio,this.m_motorImpulse*=a.step.dtRatio,e=box2d.b2Add_V2_V2(box2d.b2Mul_S_V2(this.m_impulse,this.m_ay,box2d.b2Vec2.s_t0),box2d.b2Mul_S_V2(this.m_springImpulse,
this.m_ax,box2d.b2Vec2.s_t1),box2d.b2WheelJoint.prototype.InitVelocityConstraints.s_P),f=this.m_impulse*this.m_sAy+this.m_springImpulse*this.m_sAx+this.m_motorImpulse,b=this.m_impulse*this.m_sBy+this.m_springImpulse*this.m_sBx+this.m_motorImpulse,k.SelfMulSub(this.m_invMassA,e),m-=this.m_invIA*f,s.SelfMulAdd(this.m_invMassB,e),t+=this.m_invIB*b):this.m_motorImpulse=this.m_springImpulse=this.m_impulse=0;a.velocities[this.m_indexA].w=m;a.velocities[this.m_indexB].w=t};
goog.exportProperty(box2d.b2WheelJoint.prototype,"InitVelocityConstraints",box2d.b2WheelJoint.prototype.InitVelocityConstraints);box2d.b2WheelJoint.prototype.InitVelocityConstraints.s_d=new box2d.b2Vec2;box2d.b2WheelJoint.prototype.InitVelocityConstraints.s_P=new box2d.b2Vec2;
box2d.b2WheelJoint.prototype.SolveVelocityConstraints=function(a){var b=this.m_invMassA,d=this.m_invMassB,e=this.m_invIA,f=this.m_invIB,g=a.velocities[this.m_indexA].v,k=a.velocities[this.m_indexA].w,m=a.velocities[this.m_indexB].v,n=a.velocities[this.m_indexB].w,q=box2d.b2Dot_V2_V2(this.m_ax,box2d.b2Sub_V2_V2(m,g,box2d.b2Vec2.s_t0))+this.m_sBx*n-this.m_sAx*k,q=-this.m_springMass*(q+this.m_bias+this.m_gamma*this.m_springImpulse);this.m_springImpulse+=q;var s=box2d.b2Mul_S_V2(q,this.m_ax,box2d.b2WheelJoint.prototype.SolveVelocityConstraints.s_P),
t=q*this.m_sAx,q=q*this.m_sBx;g.SelfMulSub(b,s);k-=e*t;m.SelfMulAdd(d,s);n+=f*q;q=n-k-this.m_motorSpeed;q*=-this.m_motorMass;s=this.m_motorImpulse;t=a.step.dt*this.m_maxMotorTorque;this.m_motorImpulse=box2d.b2Clamp(this.m_motorImpulse+q,-t,t);q=this.m_motorImpulse-s;k-=e*q;n+=f*q;q=box2d.b2Dot_V2_V2(this.m_ay,box2d.b2Sub_V2_V2(m,g,box2d.b2Vec2.s_t0))+this.m_sBy*n-this.m_sAy*k;q*=-this.m_mass;this.m_impulse+=q;s=box2d.b2Mul_S_V2(q,this.m_ay,box2d.b2WheelJoint.prototype.SolveVelocityConstraints.s_P);
t=q*this.m_sAy;q*=this.m_sBy;g.SelfMulSub(b,s);k-=e*t;m.SelfMulAdd(d,s);a.velocities[this.m_indexA].w=k;a.velocities[this.m_indexB].w=n+f*q};goog.exportProperty(box2d.b2WheelJoint.prototype,"SolveVelocityConstraints",box2d.b2WheelJoint.prototype.SolveVelocityConstraints);box2d.b2WheelJoint.prototype.SolveVelocityConstraints.s_P=new box2d.b2Vec2;
box2d.b2WheelJoint.prototype.SolvePositionConstraints=function(a){var b=a.positions[this.m_indexA].c,d=a.positions[this.m_indexA].a,e=a.positions[this.m_indexB].c,f=a.positions[this.m_indexB].a,g=this.m_qA.SetAngle(d),k=this.m_qB.SetAngle(f);box2d.b2Sub_V2_V2(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA);var m=box2d.b2Mul_R_V2(g,this.m_lalcA,this.m_rA);box2d.b2Sub_V2_V2(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB);var k=box2d.b2Mul_R_V2(k,this.m_lalcB,this.m_rB),n=box2d.b2Add_V2_V2(box2d.b2Sub_V2_V2(e,
b,box2d.b2Vec2.s_t0),box2d.b2Sub_V2_V2(k,m,box2d.b2Vec2.s_t1),box2d.b2WheelJoint.prototype.SolvePositionConstraints.s_d),g=box2d.b2Mul_R_V2(g,this.m_localYAxisA,this.m_ay),m=box2d.b2Cross_V2_V2(box2d.b2Add_V2_V2(n,m,box2d.b2Vec2.s_t0),g),k=box2d.b2Cross_V2_V2(k,g),n=box2d.b2Dot_V2_V2(n,this.m_ay),q=this.m_invMassA+this.m_invMassB+this.m_invIA*this.m_sAy*this.m_sAy+this.m_invIB*this.m_sBy*this.m_sBy,q=0!==q?-n/q:0,g=box2d.b2Mul_S_V2(q,g,box2d.b2WheelJoint.prototype.SolvePositionConstraints.s_P),m=
q*m,k=q*k;b.SelfMulSub(this.m_invMassA,g);d-=this.m_invIA*m;e.SelfMulAdd(this.m_invMassB,g);f+=this.m_invIB*k;a.positions[this.m_indexA].a=d;a.positions[this.m_indexB].a=f;return box2d.b2Abs(n)<=box2d.b2_linearSlop};goog.exportProperty(box2d.b2WheelJoint.prototype,"SolvePositionConstraints",box2d.b2WheelJoint.prototype.SolvePositionConstraints);box2d.b2WheelJoint.prototype.SolvePositionConstraints.s_d=new box2d.b2Vec2;box2d.b2WheelJoint.prototype.SolvePositionConstraints.s_P=new box2d.b2Vec2;
box2d.b2WheelJoint.prototype.GetDefinition=function(a){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1);return a};goog.exportProperty(box2d.b2WheelJoint.prototype,"GetDefinition",box2d.b2WheelJoint.prototype.GetDefinition);box2d.b2WheelJoint.prototype.GetAnchorA=function(a){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,a)};goog.exportProperty(box2d.b2WheelJoint.prototype,"GetAnchorA",box2d.b2WheelJoint.prototype.GetAnchorA);
box2d.b2WheelJoint.prototype.GetAnchorB=function(a){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,a)};goog.exportProperty(box2d.b2WheelJoint.prototype,"GetAnchorB",box2d.b2WheelJoint.prototype.GetAnchorB);box2d.b2WheelJoint.prototype.GetReactionForce=function(a,b){b.x=a*(this.m_impulse*this.m_ay.x+this.m_springImpulse*this.m_ax.x);b.y=a*(this.m_impulse*this.m_ay.y+this.m_springImpulse*this.m_ax.y);return b};goog.exportProperty(box2d.b2WheelJoint.prototype,"GetReactionForce",box2d.b2WheelJoint.prototype.GetReactionForce);
box2d.b2WheelJoint.prototype.GetReactionTorque=function(a){return a*this.m_motorImpulse};goog.exportProperty(box2d.b2WheelJoint.prototype,"GetReactionTorque",box2d.b2WheelJoint.prototype.GetReactionTorque);box2d.b2WheelJoint.prototype.GetLocalAnchorA=function(a){return a.Copy(this.m_localAnchorA)};goog.exportProperty(box2d.b2WheelJoint.prototype,"GetLocalAnchorA",box2d.b2WheelJoint.prototype.GetLocalAnchorA);box2d.b2WheelJoint.prototype.GetLocalAnchorB=function(a){return a.Copy(this.m_localAnchorB)};
goog.exportProperty(box2d.b2WheelJoint.prototype,"GetLocalAnchorB",box2d.b2WheelJoint.prototype.GetLocalAnchorB);box2d.b2WheelJoint.prototype.GetLocalAxisA=function(a){return a.Copy(this.m_localXAxisA)};goog.exportProperty(box2d.b2WheelJoint.prototype,"GetLocalAxisA",box2d.b2WheelJoint.prototype.GetLocalAxisA);box2d.b2WheelJoint.prototype.GetJointTranslation=function(){return this.GetPrismaticJointTranslation()};goog.exportProperty(box2d.b2WheelJoint.prototype,"GetJointTranslation",box2d.b2WheelJoint.prototype.GetJointTranslation);
box2d.b2WheelJoint.prototype.GetJointSpeed=function(){return this.GetRevoluteJointSpeed()};goog.exportProperty(box2d.b2WheelJoint.prototype,"GetJointSpeed",box2d.b2WheelJoint.prototype.GetJointSpeed);
box2d.b2WheelJoint.prototype.GetPrismaticJointTranslation=function(){var a=this.m_bodyA,b=this.m_bodyB,d=a.GetWorldPoint(this.m_localAnchorA,new box2d.b2Vec2),b=b.GetWorldPoint(this.m_localAnchorB,new box2d.b2Vec2),d=box2d.b2Sub_V2_V2(b,d,new box2d.b2Vec2),a=a.GetWorldVector(this.m_localXAxisA,new box2d.b2Vec2);return box2d.b2Dot_V2_V2(d,a)};goog.exportProperty(box2d.b2WheelJoint.prototype,"GetPrismaticJointTranslation",box2d.b2WheelJoint.prototype.GetPrismaticJointTranslation);
box2d.b2WheelJoint.prototype.GetPrismaticJointSpeed=function(){var a=this.m_bodyA,b=this.m_bodyB;box2d.b2Sub_V2_V2(this.m_localAnchorA,a.m_sweep.localCenter,this.m_lalcA);var d=box2d.b2Mul_R_V2(a.m_xf.q,this.m_lalcA,this.m_rA);box2d.b2Sub_V2_V2(this.m_localAnchorB,b.m_sweep.localCenter,this.m_lalcB);var e=box2d.b2Mul_R_V2(b.m_xf.q,this.m_lalcB,this.m_rB),f=box2d.b2Add_V2_V2(a.m_sweep.c,d,box2d.b2Vec2.s_t0),g=box2d.b2Add_V2_V2(b.m_sweep.c,e,box2d.b2Vec2.s_t1),f=box2d.b2Sub_V2_V2(g,f,box2d.b2Vec2.s_t2),
g=a.GetWorldVector(this.m_localXAxisA,new box2d.b2Vec2),k=a.m_linearVelocity,m=b.m_linearVelocity,a=a.m_angularVelocity,b=b.m_angularVelocity;return box2d.b2Dot_V2_V2(f,box2d.b2Cross_S_V2(a,g,box2d.b2Vec2.s_t0))+box2d.b2Dot_V2_V2(g,box2d.b2Sub_V2_V2(box2d.b2AddCross_V2_S_V2(m,b,e,box2d.b2Vec2.s_t0),box2d.b2AddCross_V2_S_V2(k,a,d,box2d.b2Vec2.s_t1),box2d.b2Vec2.s_t0))};goog.exportProperty(box2d.b2WheelJoint.prototype,"GetPrismaticJointSpeed",box2d.b2WheelJoint.prototype.GetPrismaticJointSpeed);
box2d.b2WheelJoint.prototype.GetRevoluteJointAngle=function(){return this.m_bodyB.m_sweep.a-this.m_bodyA.m_sweep.a};goog.exportProperty(box2d.b2WheelJoint.prototype,"GetRevoluteJointAngle",box2d.b2WheelJoint.prototype.GetRevoluteJointAngle);box2d.b2WheelJoint.prototype.GetRevoluteJointSpeed=function(){return this.m_bodyB.m_angularVelocity-this.m_bodyA.m_angularVelocity};goog.exportProperty(box2d.b2WheelJoint.prototype,"GetRevoluteJointSpeed",box2d.b2WheelJoint.prototype.GetRevoluteJointSpeed);
box2d.b2WheelJoint.prototype.IsMotorEnabled=function(){return this.m_enableMotor};goog.exportProperty(box2d.b2WheelJoint.prototype,"IsMotorEnabled",box2d.b2WheelJoint.prototype.IsMotorEnabled);box2d.b2WheelJoint.prototype.EnableMotor=function(a){this.m_bodyA.SetAwake(!0);this.m_bodyB.SetAwake(!0);this.m_enableMotor=a};goog.exportProperty(box2d.b2WheelJoint.prototype,"EnableMotor",box2d.b2WheelJoint.prototype.EnableMotor);
box2d.b2WheelJoint.prototype.SetMotorSpeed=function(a){this.m_bodyA.SetAwake(!0);this.m_bodyB.SetAwake(!0);this.m_motorSpeed=a};goog.exportProperty(box2d.b2WheelJoint.prototype,"SetMotorSpeed",box2d.b2WheelJoint.prototype.SetMotorSpeed);box2d.b2WheelJoint.prototype.SetMaxMotorTorque=function(a){this.m_bodyA.SetAwake(!0);this.m_bodyB.SetAwake(!0);this.m_maxMotorTorque=a};goog.exportProperty(box2d.b2WheelJoint.prototype,"SetMaxMotorTorque",box2d.b2WheelJoint.prototype.SetMaxMotorTorque);
box2d.b2WheelJoint.prototype.GetMotorTorque=function(a){return a*this.m_motorImpulse};goog.exportProperty(box2d.b2WheelJoint.prototype,"GetMotorTorque",box2d.b2WheelJoint.prototype.GetMotorTorque);
box2d.b2WheelJoint.prototype.Dump=function(){if(box2d.DEBUG){var a=this.m_bodyA.m_islandIndex,b=this.m_bodyB.m_islandIndex;box2d.b2Log("  /*box2d.b2WheelJointDef*/ var jd = new box2d.b2WheelJointDef();\n");box2d.b2Log("  jd.bodyA = bodies[%d];\n",a);box2d.b2Log("  jd.bodyB = bodies[%d];\n",b);box2d.b2Log("  jd.collideConnected = %s;\n",this.m_collideConnected?"true":"false");box2d.b2Log("  jd.localAnchorA.Set(%.15f, %.15f);\n",this.m_localAnchorA.x,this.m_localAnchorA.y);box2d.b2Log("  jd.localAnchorB.Set(%.15f, %.15f);\n",
this.m_localAnchorB.x,this.m_localAnchorB.y);box2d.b2Log("  jd.localAxisA.Set(%.15f, %.15f);\n",this.m_localXAxisA.x,this.m_localXAxisA.y);box2d.b2Log("  jd.enableMotor = %s;\n",this.m_enableMotor?"true":"false");box2d.b2Log("  jd.motorSpeed = %.15f;\n",this.m_motorSpeed);box2d.b2Log("  jd.maxMotorTorque = %.15f;\n",this.m_maxMotorTorque);box2d.b2Log("  jd.frequencyHz = %.15f;\n",this.m_frequencyHz);box2d.b2Log("  jd.dampingRatio = %.15f;\n",this.m_dampingRatio);box2d.b2Log("  joints[%d] = this.m_world.CreateJoint(jd);\n",
this.m_index)}};goog.exportProperty(box2d.b2WheelJoint.prototype,"Dump",box2d.b2WheelJoint.prototype.Dump);box2d.b2Particle={};
box2d.b2ParticleFlag={b2_waterParticle:0,b2_zombieParticle:2,b2_wallParticle:4,b2_springParticle:8,b2_elasticParticle:16,b2_viscousParticle:32,b2_powderParticle:64,b2_tensileParticle:128,b2_colorMixingParticle:256,b2_destructionListenerParticle:512,b2_barrierParticle:1024,b2_staticPressureParticle:2048,b2_reactiveParticle:4096,b2_repulsiveParticle:8192,b2_fixtureContactListenerParticle:16384,b2_particleContactListenerParticle:32768,b2_fixtureContactFilterParticle:65536,b2_particleContactFilterParticle:131072};
goog.exportSymbol("box2d.b2ParticleFlag",box2d.b2ParticleFlag);goog.exportProperty(box2d.b2ParticleFlag,"b2_waterParticle",box2d.b2ParticleFlag.b2_waterParticle);goog.exportProperty(box2d.b2ParticleFlag,"b2_zombieParticle",box2d.b2ParticleFlag.b2_zombieParticle);goog.exportProperty(box2d.b2ParticleFlag,"b2_wallParticle",box2d.b2ParticleFlag.b2_wallParticle);goog.exportProperty(box2d.b2ParticleFlag,"b2_springParticle",box2d.b2ParticleFlag.b2_springParticle);
goog.exportProperty(box2d.b2ParticleFlag,"b2_elasticParticle",box2d.b2ParticleFlag.b2_elasticParticle);goog.exportProperty(box2d.b2ParticleFlag,"b2_viscousParticle",box2d.b2ParticleFlag.b2_viscousParticle);goog.exportProperty(box2d.b2ParticleFlag,"b2_powderParticle",box2d.b2ParticleFlag.b2_powderParticle);goog.exportProperty(box2d.b2ParticleFlag,"b2_tensileParticle",box2d.b2ParticleFlag.b2_tensileParticle);goog.exportProperty(box2d.b2ParticleFlag,"b2_colorMixingParticle",box2d.b2ParticleFlag.b2_colorMixingParticle);
goog.exportProperty(box2d.b2ParticleFlag,"b2_destructionListenerParticle",box2d.b2ParticleFlag.b2_destructionListenerParticle);goog.exportProperty(box2d.b2ParticleFlag,"b2_barrierParticle",box2d.b2ParticleFlag.b2_barrierParticle);goog.exportProperty(box2d.b2ParticleFlag,"b2_staticPressureParticle",box2d.b2ParticleFlag.b2_staticPressureParticle);goog.exportProperty(box2d.b2ParticleFlag,"b2_reactiveParticle",box2d.b2ParticleFlag.b2_reactiveParticle);
goog.exportProperty(box2d.b2ParticleFlag,"b2_repulsiveParticle",box2d.b2ParticleFlag.b2_repulsiveParticle);goog.exportProperty(box2d.b2ParticleFlag,"b2_fixtureContactListenerParticle",box2d.b2ParticleFlag.b2_fixtureContactListenerParticle);goog.exportProperty(box2d.b2ParticleFlag,"b2_particleContactListenerParticle",box2d.b2ParticleFlag.b2_particleContactListenerParticle);goog.exportProperty(box2d.b2ParticleFlag,"b2_fixtureContactFilterParticle",box2d.b2ParticleFlag.b2_fixtureContactFilterParticle);
goog.exportProperty(box2d.b2ParticleFlag,"b2_particleContactFilterParticle",box2d.b2ParticleFlag.b2_particleContactFilterParticle);box2d.b2ParticleColor=function(a,b,d,e){if(0!==arguments.length)if(a instanceof box2d.b2Color)this.r=0|255*a.r,this.g=0|255*a.g,this.b=0|255*a.b,this.a=0|255*a.a;else if(3<=arguments.length)this.r=0|a||0,this.g=0|b||0,this.b=0|d||0,this.a=0|e||0;else throw Error();};goog.exportSymbol("box2d.b2ParticleColor",box2d.b2ParticleColor);box2d.b2ParticleColor.prototype.r=0;
goog.exportProperty(box2d.b2ParticleColor.prototype,"r",box2d.b2ParticleColor.prototype.r);box2d.b2ParticleColor.prototype.g=0;goog.exportProperty(box2d.b2ParticleColor.prototype,"g",box2d.b2ParticleColor.prototype.g);box2d.b2ParticleColor.prototype.b=0;goog.exportProperty(box2d.b2ParticleColor.prototype,"b",box2d.b2ParticleColor.prototype.b);box2d.b2ParticleColor.prototype.a=0;goog.exportProperty(box2d.b2ParticleColor.prototype,"a",box2d.b2ParticleColor.prototype.a);
box2d.b2ParticleColor.prototype.IsZero=function(){return 0===this.r&&0===this.g&&0===this.b&&0===this.a};goog.exportProperty(box2d.b2ParticleColor.prototype,"IsZero",box2d.b2ParticleColor.prototype.IsZero);box2d.b2ParticleColor.prototype.GetColor=function(a){a.r=this.r/255;a.g=this.g/255;a.b=this.b/255;a.a=this.a/255;return a};goog.exportProperty(box2d.b2ParticleColor.prototype,"GetColor",box2d.b2ParticleColor.prototype.GetColor);
box2d.b2ParticleColor.prototype.Set=function(a,b,d,e){if(a instanceof box2d.b2Color)this.SetColor(a);else if(3<=arguments.length)this.SetRGBA(a||0,b||0,d||0,e);else throw Error();};goog.exportProperty(box2d.b2ParticleColor.prototype,"Set",box2d.b2ParticleColor.prototype.Set);box2d.b2ParticleColor.prototype.SetRGBA=function(a,b,d,e){this.r=a;this.g=b;this.b=d;this.a="number"===typeof e?e:255};goog.exportProperty(box2d.b2ParticleColor.prototype,"SetRGBA",box2d.b2ParticleColor.prototype.SetRGBA);
box2d.b2ParticleColor.prototype.SetColor=function(a){this.r=255*a.r;this.g=255*a.g;this.b=255*a.b;this.a=255*a.a};goog.exportProperty(box2d.b2ParticleColor.prototype,"SetColor",box2d.b2ParticleColor.prototype.SetColor);box2d.b2ParticleColor.prototype.Copy=function(a){this.r=a.r;this.g=a.g;this.b=a.b;this.a=a.a;return this};goog.exportProperty(box2d.b2ParticleColor.prototype,"Copy",box2d.b2ParticleColor.prototype.Copy);
box2d.b2ParticleColor.prototype.Clone=function(){return new box2d.b2ParticleColor(this.r,this.g,this.b,this.a)};box2d.b2ParticleColor.prototype.SelfMul_0_1=function(a){this.r*=a;this.g*=a;this.b*=a;this.a*=a;return this};goog.exportProperty(box2d.b2ParticleColor.prototype,"SelfMul_0_1",box2d.b2ParticleColor.prototype.SelfMul_0_1);
box2d.b2ParticleColor.prototype.SelfMul_0_255=function(a){a+=1;this.r=this.r*a>>box2d.b2ParticleColor.k_bitsPerComponent;this.g=this.g*a>>box2d.b2ParticleColor.k_bitsPerComponent;this.b=this.b*a>>box2d.b2ParticleColor.k_bitsPerComponent;this.a=this.a*a>>box2d.b2ParticleColor.k_bitsPerComponent;return this};goog.exportProperty(box2d.b2ParticleColor.prototype,"SelfMul_0_255",box2d.b2ParticleColor.prototype.SelfMul_0_255);box2d.b2ParticleColor.prototype.Mul_0_1=function(a,b){return b.Copy(this).SelfMul_0_1(a)};
goog.exportProperty(box2d.b2ParticleColor.prototype,"Mul_0_1",box2d.b2ParticleColor.prototype.Mul_0_1);box2d.b2ParticleColor.prototype.Mul_0_255=function(a,b){return b.Copy(this).SelfMul_0_255(a)};goog.exportProperty(box2d.b2ParticleColor.prototype,"Mul_0_255",box2d.b2ParticleColor.prototype.Mul_0_255);box2d.b2ParticleColor.prototype.SelfAdd=function(a){this.r+=a.r;this.g+=a.g;this.b+=a.b;this.a+=a.a;return this};goog.exportProperty(box2d.b2ParticleColor.prototype,"SelfAdd",box2d.b2ParticleColor.prototype.SelfAdd);
box2d.b2ParticleColor.prototype.Add=function(a,b){b.r=this.r+a.r;b.g=this.g+a.g;b.b=this.b+a.b;b.a=this.a+a.a;return b};goog.exportProperty(box2d.b2ParticleColor.prototype,"Add",box2d.b2ParticleColor.prototype.Add);box2d.b2ParticleColor.prototype.SelfSub=function(a){this.r-=a.r;this.g-=a.g;this.b-=a.b;this.a-=a.a;return this};goog.exportProperty(box2d.b2ParticleColor.prototype,"SelfSub",box2d.b2ParticleColor.prototype.SelfSub);
box2d.b2ParticleColor.prototype.Sub=function(a,b){b.r=this.r-a.r;b.g=this.g-a.g;b.b=this.b-a.b;b.a=this.a-a.a;return b};goog.exportProperty(box2d.b2ParticleColor.prototype,"Sub",box2d.b2ParticleColor.prototype.Sub);box2d.b2ParticleColor.prototype.IsEqual=function(a){return this.r===a.r&&this.g===a.g&&this.b===a.b&&this.a===a.a};goog.exportProperty(box2d.b2ParticleColor.prototype,"IsEqual",box2d.b2ParticleColor.prototype.IsEqual);
box2d.b2ParticleColor.prototype.Mix=function(a,b){box2d.b2ParticleColor.MixColors(this,a,b)};goog.exportProperty(box2d.b2ParticleColor.prototype,"Mix",box2d.b2ParticleColor.prototype.Mix);
box2d.b2ParticleColor.MixColors=function(a,b,d){var e=d*(b.r-a.r)>>box2d.b2ParticleColor.k_bitsPerComponent,f=d*(b.g-a.g)>>box2d.b2ParticleColor.k_bitsPerComponent,g=d*(b.b-a.b)>>box2d.b2ParticleColor.k_bitsPerComponent;d=d*(b.a-a.a)>>box2d.b2ParticleColor.k_bitsPerComponent;a.r+=e;a.g+=f;a.b+=g;a.a+=d;b.r-=e;b.g-=f;b.b-=g;b.a-=d};goog.exportProperty(box2d.b2ParticleColor,"MixColors",box2d.b2ParticleColor.MixColors);box2d.B2PARTICLECOLOR_BITS_PER_COMPONENT=8;
box2d.B2PARTICLECOLOR_MAX_VALUE=(1<<box2d.B2PARTICLECOLOR_BITS_PER_COMPONENT)-1;box2d.b2ParticleColor.k_maxValue=+box2d.B2PARTICLECOLOR_MAX_VALUE;goog.exportProperty(box2d.b2ParticleColor,"k_maxValue",box2d.b2ParticleColor.k_maxValue);box2d.b2ParticleColor.k_inverseMaxValue=1/+box2d.B2PARTICLECOLOR_MAX_VALUE;goog.exportProperty(box2d.b2ParticleColor,"k_inverseMaxValue",box2d.b2ParticleColor.k_inverseMaxValue);box2d.b2ParticleColor.k_bitsPerComponent=box2d.B2PARTICLECOLOR_BITS_PER_COMPONENT;
goog.exportProperty(box2d.b2ParticleColor,"k_bitsPerComponent",box2d.b2ParticleColor.k_bitsPerComponent);box2d.b2ParticleColor_zero=new box2d.b2ParticleColor;box2d.b2ParticleDef=function(){this.position=box2d.b2Vec2_zero.Clone();this.velocity=box2d.b2Vec2_zero.Clone();this.color=box2d.b2ParticleColor_zero.Clone()};goog.exportSymbol("box2d.b2ParticleDef",box2d.b2ParticleDef);box2d.b2ParticleDef.prototype.flags=0;goog.exportProperty(box2d.b2ParticleDef.prototype,"flags",box2d.b2ParticleDef.prototype.flags);
box2d.b2ParticleDef.prototype.position=null;goog.exportProperty(box2d.b2ParticleDef.prototype,"position",box2d.b2ParticleDef.prototype.position);box2d.b2ParticleDef.prototype.velocity=null;goog.exportProperty(box2d.b2ParticleDef.prototype,"velocity",box2d.b2ParticleDef.prototype.velocity);box2d.b2ParticleDef.prototype.color=null;goog.exportProperty(box2d.b2ParticleDef.prototype,"color",box2d.b2ParticleDef.prototype.color);box2d.b2ParticleDef.prototype.lifetime=0;
goog.exportProperty(box2d.b2ParticleDef.prototype,"lifetime",box2d.b2ParticleDef.prototype.lifetime);box2d.b2ParticleDef.prototype.userData=null;goog.exportProperty(box2d.b2ParticleDef.prototype,"userData",box2d.b2ParticleDef.prototype.userData);box2d.b2ParticleDef.prototype.group=null;goog.exportProperty(box2d.b2ParticleDef.prototype,"group",box2d.b2ParticleDef.prototype.group);box2d.b2CalculateParticleIterations=function(a,b,d){a=Math.ceil(Math.sqrt(a/(.01*b))*d);return box2d.b2Clamp(a,1,8)};
goog.exportSymbol("box2d.b2CalculateParticleIterations",box2d.b2CalculateParticleIterations);box2d.b2ParticleHandle=function(){};goog.exportSymbol("box2d.b2ParticleHandle",box2d.b2ParticleHandle);box2d.b2ParticleHandle.prototype.m_index=box2d.b2_invalidParticleIndex;box2d.b2ParticleHandle.prototype.GetIndex=function(){return this.m_index};goog.exportProperty(box2d.b2ParticleHandle.prototype,"GetIndex",box2d.b2ParticleHandle.prototype.GetIndex);
box2d.b2ParticleHandle.prototype.SetIndex=function(a){this.m_index=a};box2d.b2ParticleGroupFlag={b2_solidParticleGroup:1,b2_rigidParticleGroup:2,b2_particleGroupCanBeEmpty:4,b2_particleGroupWillBeDestroyed:8,b2_particleGroupNeedsUpdateDepth:16};goog.exportSymbol("box2d.b2ParticleGroupFlag",box2d.b2ParticleGroupFlag);goog.exportProperty(box2d.b2ParticleGroupFlag,"b2_solidParticleGroup",box2d.b2ParticleGroupFlag.b2_solidParticleGroup);
goog.exportProperty(box2d.b2ParticleGroupFlag,"b2_rigidParticleGroup",box2d.b2ParticleGroupFlag.b2_rigidParticleGroup);goog.exportProperty(box2d.b2ParticleGroupFlag,"b2_particleGroupCanBeEmpty",box2d.b2ParticleGroupFlag.b2_particleGroupCanBeEmpty);goog.exportProperty(box2d.b2ParticleGroupFlag,"b2_particleGroupWillBeDestroyed",box2d.b2ParticleGroupFlag.b2_particleGroupWillBeDestroyed);goog.exportProperty(box2d.b2ParticleGroupFlag,"b2_particleGroupNeedsUpdateDepth",box2d.b2ParticleGroupFlag.b2_particleGroupNeedsUpdateDepth);
box2d.b2ParticleGroupFlag.b2_particleGroupInternalMask=box2d.b2ParticleGroupFlag.b2_particleGroupWillBeDestroyed|box2d.b2ParticleGroupFlag.b2_particleGroupNeedsUpdateDepth;box2d.b2ParticleGroupDef=function(){this.position=box2d.b2Vec2_zero.Clone();this.linearVelocity=box2d.b2Vec2_zero.Clone();this.color=box2d.b2ParticleColor_zero.Clone()};goog.exportSymbol("box2d.b2ParticleGroupDef",box2d.b2ParticleGroupDef);box2d.b2ParticleGroupDef.prototype.flags=0;
goog.exportProperty(box2d.b2ParticleGroupDef.prototype,"flags",box2d.b2ParticleGroupDef.prototype.flags);box2d.b2ParticleGroupDef.prototype.groupFlags=0;goog.exportProperty(box2d.b2ParticleGroupDef.prototype,"groupFlags",box2d.b2ParticleGroupDef.prototype.groupFlags);box2d.b2ParticleGroupDef.prototype.position=null;goog.exportProperty(box2d.b2ParticleGroupDef.prototype,"position",box2d.b2ParticleGroupDef.prototype.position);box2d.b2ParticleGroupDef.prototype.angle=0;
goog.exportProperty(box2d.b2ParticleGroupDef.prototype,"angle",box2d.b2ParticleGroupDef.prototype.angle);box2d.b2ParticleGroupDef.prototype.linearVelocity=null;goog.exportProperty(box2d.b2ParticleGroupDef.prototype,"linearVelocity",box2d.b2ParticleGroupDef.prototype.linearVelocity);box2d.b2ParticleGroupDef.prototype.angularVelocity=0;goog.exportProperty(box2d.b2ParticleGroupDef.prototype,"angularVelocity",box2d.b2ParticleGroupDef.prototype.angularVelocity);
box2d.b2ParticleGroupDef.prototype.color=null;goog.exportProperty(box2d.b2ParticleGroupDef.prototype,"color",box2d.b2ParticleGroupDef.prototype.color);box2d.b2ParticleGroupDef.prototype.strength=1;goog.exportProperty(box2d.b2ParticleGroupDef.prototype,"strength",box2d.b2ParticleGroupDef.prototype.strength);box2d.b2ParticleGroupDef.prototype.shape=null;goog.exportProperty(box2d.b2ParticleGroupDef.prototype,"shape",box2d.b2ParticleGroupDef.prototype.shape);
box2d.b2ParticleGroupDef.prototype.shapes=null;goog.exportProperty(box2d.b2ParticleGroupDef.prototype,"shapes",box2d.b2ParticleGroupDef.prototype.shapes);box2d.b2ParticleGroupDef.prototype.shapeCount=0;goog.exportProperty(box2d.b2ParticleGroupDef.prototype,"shapeCount",box2d.b2ParticleGroupDef.prototype.shapeCount);box2d.b2ParticleGroupDef.prototype.stride=0;goog.exportProperty(box2d.b2ParticleGroupDef.prototype,"stride",box2d.b2ParticleGroupDef.prototype.stride);
box2d.b2ParticleGroupDef.prototype.particleCount=0;goog.exportProperty(box2d.b2ParticleGroupDef.prototype,"particleCount",box2d.b2ParticleGroupDef.prototype.particleCount);box2d.b2ParticleGroupDef.prototype.positionData=null;goog.exportProperty(box2d.b2ParticleGroupDef.prototype,"positionData",box2d.b2ParticleGroupDef.prototype.positionData);box2d.b2ParticleGroupDef.prototype.lifetime=0;goog.exportProperty(box2d.b2ParticleGroupDef.prototype,"lifetime",box2d.b2ParticleGroupDef.prototype.lifetime);
box2d.b2ParticleGroupDef.prototype.userData=null;goog.exportProperty(box2d.b2ParticleGroupDef.prototype,"userData",box2d.b2ParticleGroupDef.prototype.userData);box2d.b2ParticleGroupDef.prototype.group=null;goog.exportProperty(box2d.b2ParticleGroupDef.prototype,"group",box2d.b2ParticleGroupDef.prototype.group);box2d.b2ParticleGroup=function(){this.m_center=new box2d.b2Vec2;this.m_linearVelocity=new box2d.b2Vec2;this.m_transform=new box2d.b2Transform;this.m_transform.SetIdentity()};
goog.exportSymbol("box2d.b2ParticleGroup",box2d.b2ParticleGroup);box2d.b2ParticleGroup.prototype.m_system=null;box2d.b2ParticleGroup.prototype.m_firstIndex=0;box2d.b2ParticleGroup.prototype.m_lastIndex=0;box2d.b2ParticleGroup.prototype.m_groupFlags=0;box2d.b2ParticleGroup.prototype.m_strength=1;box2d.b2ParticleGroup.prototype.m_prev=null;box2d.b2ParticleGroup.prototype.m_next=null;box2d.b2ParticleGroup.prototype.m_timestamp=-1;box2d.b2ParticleGroup.prototype.m_mass=0;
box2d.b2ParticleGroup.prototype.m_inertia=0;box2d.b2ParticleGroup.prototype.m_center=null;box2d.b2ParticleGroup.prototype.m_linearVelocity=null;box2d.b2ParticleGroup.prototype.m_angularVelocity=0;box2d.b2ParticleGroup.prototype.m_transform=null;box2d.b2ParticleGroup.prototype.m_userData=null;box2d.b2ParticleGroup.prototype.GetNext=function(){return this.m_next};goog.exportProperty(box2d.b2ParticleGroup.prototype,"GetNext",box2d.b2ParticleGroup.prototype.GetNext);
box2d.b2ParticleGroup.prototype.GetParticleSystem=function(){return this.m_system};goog.exportProperty(box2d.b2ParticleGroup.prototype,"GetParticleSystem",box2d.b2ParticleGroup.prototype.GetParticleSystem);box2d.b2ParticleGroup.prototype.GetParticleCount=function(){return this.m_lastIndex-this.m_firstIndex};goog.exportProperty(box2d.b2ParticleGroup.prototype,"GetParticleCount",box2d.b2ParticleGroup.prototype.GetParticleCount);box2d.b2ParticleGroup.prototype.GetBufferIndex=function(){return this.m_firstIndex};
goog.exportProperty(box2d.b2ParticleGroup.prototype,"GetBufferIndex",box2d.b2ParticleGroup.prototype.GetBufferIndex);box2d.b2ParticleGroup.prototype.ContainsParticle=function(a){return this.m_firstIndex<=a&&a<this.m_lastIndex};box2d.b2ParticleGroup.prototype.GetAllParticleFlags=function(){for(var a=0,b=this.m_firstIndex;b<this.m_lastIndex;b++)a|=this.m_system.m_flagsBuffer.data[b];return a};goog.exportProperty(box2d.b2ParticleGroup.prototype,"GetAllParticleFlags",box2d.b2ParticleGroup.prototype.GetAllParticleFlags);
box2d.b2ParticleGroup.prototype.GetGroupFlags=function(){return this.m_groupFlags};goog.exportProperty(box2d.b2ParticleGroup.prototype,"GetGroupFlags",box2d.b2ParticleGroup.prototype.GetGroupFlags);box2d.b2ParticleGroup.prototype.SetGroupFlags=function(a){box2d.b2Assert(0===(a&box2d.b2ParticleGroupFlag.b2_particleGroupInternalMask));a|=this.m_groupFlags&box2d.b2ParticleGroupFlag.b2_particleGroupInternalMask;this.m_system.SetGroupFlags(this,a)};
goog.exportProperty(box2d.b2ParticleGroup.prototype,"SetGroupFlags",box2d.b2ParticleGroup.prototype.SetGroupFlags);box2d.b2ParticleGroup.prototype.GetMass=function(){this.UpdateStatistics();return this.m_mass};goog.exportProperty(box2d.b2ParticleGroup.prototype,"GetMass",box2d.b2ParticleGroup.prototype.GetMass);box2d.b2ParticleGroup.prototype.GetInertia=function(){this.UpdateStatistics();return this.m_inertia};goog.exportProperty(box2d.b2ParticleGroup.prototype,"GetInertia",box2d.b2ParticleGroup.prototype.GetInertia);
box2d.b2ParticleGroup.prototype.GetCenter=function(){this.UpdateStatistics();return this.m_center};goog.exportProperty(box2d.b2ParticleGroup.prototype,"GetCenter",box2d.b2ParticleGroup.prototype.GetCenter);box2d.b2ParticleGroup.prototype.GetLinearVelocity=function(){this.UpdateStatistics();return this.m_linearVelocity};goog.exportProperty(box2d.b2ParticleGroup.prototype,"GetLinearVelocity",box2d.b2ParticleGroup.prototype.GetLinearVelocity);
box2d.b2ParticleGroup.prototype.GetAngularVelocity=function(){this.UpdateStatistics();return this.m_angularVelocity};goog.exportProperty(box2d.b2ParticleGroup.prototype,"GetAngularVelocity",box2d.b2ParticleGroup.prototype.GetAngularVelocity);box2d.b2ParticleGroup.prototype.GetTransform=function(){return this.m_transform};goog.exportProperty(box2d.b2ParticleGroup.prototype,"GetTransform",box2d.b2ParticleGroup.prototype.GetTransform);box2d.b2ParticleGroup.prototype.GetPosition=function(){return this.m_transform.p};
goog.exportProperty(box2d.b2ParticleGroup.prototype,"GetPosition",box2d.b2ParticleGroup.prototype.GetPosition);box2d.b2ParticleGroup.prototype.GetAngle=function(){return this.m_transform.q.GetAngle()};goog.exportProperty(box2d.b2ParticleGroup.prototype,"GetAngle",box2d.b2ParticleGroup.prototype.GetAngle);
box2d.b2ParticleGroup.prototype.GetLinearVelocityFromWorldPoint=function(a,b){var d=box2d.b2ParticleGroup.prototype.GetLinearVelocityFromWorldPoint.s_t0;this.UpdateStatistics();return box2d.b2AddCross_V2_S_V2(this.m_linearVelocity,this.m_angularVelocity,box2d.b2Sub_V2_V2(a,this.m_center,d),b)};goog.exportProperty(box2d.b2ParticleGroup.prototype,"GetLinearVelocityFromWorldPoint",box2d.b2ParticleGroup.prototype.GetLinearVelocityFromWorldPoint);
box2d.b2ParticleGroup.prototype.GetLinearVelocityFromWorldPoint.s_t0=new box2d.b2Vec2;box2d.b2ParticleGroup.prototype.GetUserData=function(){return this.m_userData};goog.exportProperty(box2d.b2ParticleGroup.prototype,"GetUserData",box2d.b2ParticleGroup.prototype.GetUserData);box2d.b2ParticleGroup.prototype.SetUserData=function(a){this.m_userData=a};goog.exportProperty(box2d.b2ParticleGroup.prototype,"SetUserData",box2d.b2ParticleGroup.prototype.SetUserData);
box2d.b2ParticleGroup.prototype.ApplyForce=function(a){this.m_system.ApplyForce(this.m_firstIndex,this.m_lastIndex,a)};goog.exportProperty(box2d.b2ParticleGroup.prototype,"ApplyForce",box2d.b2ParticleGroup.prototype.ApplyForce);box2d.b2ParticleGroup.prototype.ApplyLinearImpulse=function(a){this.m_system.ApplyLinearImpulse(this.m_firstIndex,this.m_lastIndex,a)};goog.exportProperty(box2d.b2ParticleGroup.prototype,"ApplyLinearImpulse",box2d.b2ParticleGroup.prototype.ApplyLinearImpulse);
box2d.b2ParticleGroup.prototype.DestroyParticles=function(a){box2d.b2Assert(!1===this.m_system.m_world.IsLocked());if(!this.m_system.m_world.IsLocked())for(var b=this.m_firstIndex;b<this.m_lastIndex;b++)this.m_system.DestroyParticle(b,a)};goog.exportProperty(box2d.b2ParticleGroup.prototype,"DestroyParticles",box2d.b2ParticleGroup.prototype.DestroyParticles);
box2d.b2ParticleGroup.prototype.UpdateStatistics=function(){var a=new box2d.b2Vec2,b=new box2d.b2Vec2;if(this.m_timestamp!=this.m_system.m_timestamp){var d=this.m_system.GetParticleMass();this.m_mass=d*(this.m_lastIndex-this.m_firstIndex);this.m_center.SetZero();this.m_linearVelocity.SetZero();for(var e=this.m_firstIndex;e<this.m_lastIndex;e++)this.m_center.SelfMulAdd(d,this.m_system.m_positionBuffer.data[e]),this.m_linearVelocity.SelfMulAdd(d,this.m_system.m_velocityBuffer.data[e]);0<this.m_mass&&
(e=1/this.m_mass,this.m_center.SelfMul(e),this.m_linearVelocity.SelfMul(e));this.m_angularVelocity=this.m_inertia=0;for(e=this.m_firstIndex;e<this.m_lastIndex;e++)box2d.b2Sub_V2_V2(this.m_system.m_positionBuffer.data[e],this.m_center,a),box2d.b2Sub_V2_V2(this.m_system.m_velocityBuffer.data[e],this.m_linearVelocity,b),this.m_inertia+=d*box2d.b2Dot_V2_V2(a,a),this.m_angularVelocity+=d*box2d.b2Cross_V2_V2(a,b);0<this.m_inertia&&(this.m_angularVelocity*=1/this.m_inertia);this.m_timestamp=this.m_system.m_timestamp}};
goog.exportProperty(box2d.b2ParticleGroup.prototype,"UpdateStatistics",box2d.b2ParticleGroup.prototype.UpdateStatistics);box2d.std_iter_swap=function(a,b,d){var e=a[b];a[b]=a[d];a[d]=e};
box2d.std_sort=function(a,b,d,e){"number"!==typeof b&&(b=0);"number"!==typeof d&&(d=a.length-b);"function"!==typeof e&&(e=function(a,b){return a<b});for(var f=[],g=0;;){for(;b+1<d;d++){var k=a[b+Math.floor(Math.random()*(d-b))];f[g++]=d;for(var m=b-1;;){for(;e(a[++m],k););for(;e(k,a[--d]););if(m>=d)break;box2d.std_iter_swap(a,m,d)}}if(0===g)break;b=d;d=f[--g]}return a};box2d.std_stable_sort=function(a,b,d,e){return box2d.std_sort(a,b,d,e)};
box2d.std_remove_if=function(a,b,d){"number"!==typeof d&&(d=a.length);for(var e=0,f=0;f<d;++f)b(a[f])||(f===e?++e:box2d.std_iter_swap(a,e++,f));return e};box2d.std_lower_bound=function(a,b,d,e,f){"function"!==typeof f&&(f=function(a,b){return a<b});for(d-=b;0<d;){var g=Math.floor(d/2),k=b+g;f(a[k],e)?(b=++k,d-=g+1):d=g}return b};box2d.std_upper_bound=function(a,b,d,e,f){"function"!==typeof f&&(f=function(a,b){return a<b});for(d-=b;0<d;){var g=Math.floor(d/2),k=b+g;f(e,a[k])?d=g:(b=++k,d-=g+1)}return b};
box2d.std_rotate=function(a,b,d,e){for(var f=d;b!==f;)box2d.std_iter_swap(a,b++,f++),f===e?f=d:b===d&&(d=f)};box2d.std_unique=function(a,b,d,e){if(b===d)return d;for(var f=b;++b!==d;)e(a[f],a[b])||box2d.std_iter_swap(a,++f,b);return++f};box2d.b2GrowableBuffer=function(a){this.data=[];this.capacity=this.count=0;this.allocator=a};box2d.b2GrowableBuffer.prototype.data=null;box2d.b2GrowableBuffer.prototype.count=0;box2d.b2GrowableBuffer.prototype.capacity=0;
box2d.b2GrowableBuffer.prototype.allocator=function(){return null};box2d.b2GrowableBuffer.prototype.Append=function(){this.count>=this.capacity&&this.Grow();return this.count++};box2d.b2GrowableBuffer.prototype.Reserve=function(a){if(!(this.capacity>=a)){box2d.b2Assert(this.capacity===this.data.length);for(var b=this.capacity;b<a;++b)this.data[b]=this.allocator();this.capacity=a}};
box2d.b2GrowableBuffer.prototype.Grow=function(){var a=this.capacity?2*this.capacity:box2d.b2_minParticleSystemBufferCapacity;box2d.b2Assert(a>this.capacity);this.Reserve(a)};box2d.b2GrowableBuffer.prototype.Free=function(){0!==this.data.length&&(this.data=[],this.count=this.capacity=0)};box2d.b2GrowableBuffer.prototype.Shorten=function(a){box2d.b2Assert(!1)};box2d.b2GrowableBuffer.prototype.Data=function(){return this.data};box2d.b2GrowableBuffer.prototype.GetCount=function(){return this.count};
box2d.b2GrowableBuffer.prototype.SetCount=function(a){box2d.b2Assert(0<=a&&a<=this.capacity);this.count=a};box2d.b2GrowableBuffer.prototype.GetCapacity=function(){return this.capacity};box2d.b2GrowableBuffer.prototype.RemoveIf=function(a){for(var b=0,d=0;d<this.count;++d)a(this.data[d])||b++;this.count=box2d.std_remove_if(this.data,a,this.count);box2d.b2Assert(b===this.count)};box2d.b2GrowableBuffer.prototype.Unique=function(a){this.count=box2d.std_unique(this.data,0,this.count,a)};
box2d.b2FixtureParticleQueryCallback=function(a){this.m_system=a};goog.inherits(box2d.b2FixtureParticleQueryCallback,box2d.b2QueryCallback);box2d.b2FixtureParticleQueryCallback.prototype.m_system=null;box2d.b2FixtureParticleQueryCallback.prototype.ShouldQueryParticleSystem=function(a){return!1};
box2d.b2FixtureParticleQueryCallback.prototype.ReportFixture=function(a){if(a.IsSensor())return!0;for(var b=a.GetShape().GetChildCount(),d=0;d<b;d++)for(var e=a.GetAABB(d),e=this.m_system.GetInsideBoundsEnumerator(e),f;0<=(f=e.GetNext());)this.ReportFixtureAndParticle(a,d,f);return!0};goog.exportProperty(box2d.b2FixtureParticleQueryCallback.prototype,"ReportFixture",box2d.b2FixtureParticleQueryCallback.prototype.ReportFixture);
box2d.b2FixtureParticleQueryCallback.prototype.ReportParticle=function(a,b){return!1};goog.exportProperty(box2d.b2FixtureParticleQueryCallback.prototype,"ReportParticle",box2d.b2FixtureParticleQueryCallback.prototype.ReportParticle);box2d.b2FixtureParticleQueryCallback.prototype.ReportFixtureAndParticle=function(a,b,d){box2d.b2Assert(!1)};goog.exportProperty(box2d.b2FixtureParticleQueryCallback.prototype,"ReportFixtureAndParticle",box2d.b2FixtureParticleQueryCallback.prototype.ReportFixtureAndParticle);
box2d.b2ParticleContact=function(){this.normal=new box2d.b2Vec2};goog.exportSymbol("box2d.b2ParticleContact",box2d.b2ParticleContact);box2d.b2ParticleContact.prototype.indexA=0;goog.exportProperty(box2d.b2ParticleContact.prototype,"indexA",box2d.b2ParticleContact.prototype.indexA);box2d.b2ParticleContact.prototype.indexB=0;goog.exportProperty(box2d.b2ParticleContact.prototype,"indexB",box2d.b2ParticleContact.prototype.indexB);box2d.b2ParticleContact.prototype.weight=0;
goog.exportProperty(box2d.b2ParticleContact.prototype,"weight",box2d.b2ParticleContact.prototype.weight);box2d.b2ParticleContact.prototype.normal=null;goog.exportProperty(box2d.b2ParticleContact.prototype,"normal",box2d.b2ParticleContact.prototype.normal);box2d.b2ParticleContact.prototype.flags=0;goog.exportProperty(box2d.b2ParticleContact.prototype,"flags",box2d.b2ParticleContact.prototype.flags);
box2d.b2ParticleContact.prototype.SetIndices=function(a,b){box2d.b2Assert(a<=box2d.b2_maxParticleIndex&&b<=box2d.b2_maxParticleIndex);this.indexA=a;this.indexB=b};goog.exportProperty(box2d.b2ParticleContact.prototype,"SetIndices",box2d.b2ParticleContact.prototype.SetIndices);box2d.b2ParticleContact.prototype.SetWeight=function(a){this.weight=a};goog.exportProperty(box2d.b2ParticleContact.prototype,"SetWeight",box2d.b2ParticleContact.prototype.SetWeight);
box2d.b2ParticleContact.prototype.SetNormal=function(a){this.normal.Copy(a)};goog.exportProperty(box2d.b2ParticleContact.prototype,"SetNormal",box2d.b2ParticleContact.prototype.SetNormal);box2d.b2ParticleContact.prototype.SetFlags=function(a){this.flags=a};goog.exportProperty(box2d.b2ParticleContact.prototype,"SetFlags",box2d.b2ParticleContact.prototype.SetFlags);box2d.b2ParticleContact.prototype.GetIndexA=function(){return this.indexA};
goog.exportProperty(box2d.b2ParticleContact.prototype,"GetIndexA",box2d.b2ParticleContact.prototype.GetIndexA);box2d.b2ParticleContact.prototype.GetIndexB=function(){return this.indexB};goog.exportProperty(box2d.b2ParticleContact.prototype,"GetIndexB",box2d.b2ParticleContact.prototype.GetIndexB);box2d.b2ParticleContact.prototype.GetWeight=function(){return this.weight};goog.exportProperty(box2d.b2ParticleContact.prototype,"GetWeight",box2d.b2ParticleContact.prototype.GetWeight);
box2d.b2ParticleContact.prototype.GetNormal=function(){return this.normal};goog.exportProperty(box2d.b2ParticleContact.prototype,"GetNormal",box2d.b2ParticleContact.prototype.GetNormal);box2d.b2ParticleContact.prototype.GetFlags=function(){return this.flags};goog.exportProperty(box2d.b2ParticleContact.prototype,"GetFlags",box2d.b2ParticleContact.prototype.GetFlags);
box2d.b2ParticleContact.prototype.IsEqual=function(a){return this.indexA===a.indexA&&this.indexB===a.indexB&&this.flags===a.flags&&this.weight===a.weight&&this.normal.x===a.normal.x&&this.normal.y===a.normal.y};goog.exportProperty(box2d.b2ParticleContact.prototype,"IsEqual",box2d.b2ParticleContact.prototype.IsEqual);box2d.b2ParticleContact.prototype.IsNotEqual=function(a){return!this.IsEqual(a)};goog.exportProperty(box2d.b2ParticleContact.prototype,"IsNotEqual",box2d.b2ParticleContact.prototype.IsNotEqual);
box2d.b2ParticleContact.prototype.ApproximatelyEqual=function(a){return this.indexA===a.indexA&&this.indexB===a.indexB&&this.flags===a.flags&&.01>box2d.b2Abs(this.weight-a.weight)&&1E-4>box2d.b2DistanceSquared(this.normal,a.normal)};goog.exportProperty(box2d.b2ParticleContact.prototype,"ApproximatelyEqual",box2d.b2ParticleContact.prototype.ApproximatelyEqual);box2d.b2ParticleBodyContact=function(){this.normal=new box2d.b2Vec2};goog.exportSymbol("box2d.b2ParticleBodyContact",box2d.b2ParticleBodyContact);
box2d.b2ParticleBodyContact.prototype.index=0;goog.exportProperty(box2d.b2ParticleBodyContact.prototype,"index",box2d.b2ParticleBodyContact.prototype.index);box2d.b2ParticleBodyContact.prototype.body=null;goog.exportProperty(box2d.b2ParticleBodyContact.prototype,"body",box2d.b2ParticleBodyContact.prototype.body);box2d.b2ParticleBodyContact.prototype.fixture=null;goog.exportProperty(box2d.b2ParticleBodyContact.prototype,"fixture",box2d.b2ParticleBodyContact.prototype.fixture);
box2d.b2ParticleBodyContact.prototype.weight=0;goog.exportProperty(box2d.b2ParticleBodyContact.prototype,"weight",box2d.b2ParticleBodyContact.prototype.weight);box2d.b2ParticleBodyContact.prototype.normal=null;goog.exportProperty(box2d.b2ParticleBodyContact.prototype,"normal",box2d.b2ParticleBodyContact.prototype.normal);box2d.b2ParticleBodyContact.prototype.mass=0;goog.exportProperty(box2d.b2ParticleBodyContact.prototype,"mass",box2d.b2ParticleBodyContact.prototype.mass);box2d.b2ParticlePair=function(){};
goog.exportSymbol("box2d.b2ParticlePair",box2d.b2ParticlePair);box2d.b2ParticlePair.prototype.indexA=0;goog.exportProperty(box2d.b2ParticlePair.prototype,"indexA",box2d.b2ParticlePair.prototype.indexA);box2d.b2ParticlePair.prototype.indexB=0;goog.exportProperty(box2d.b2ParticlePair.prototype,"indexB",box2d.b2ParticlePair.prototype.indexB);box2d.b2ParticlePair.prototype.flags=0;goog.exportProperty(box2d.b2ParticlePair.prototype,"flags",box2d.b2ParticlePair.prototype.flags);
box2d.b2ParticlePair.prototype.strength=0;goog.exportProperty(box2d.b2ParticlePair.prototype,"strength",box2d.b2ParticlePair.prototype.strength);box2d.b2ParticlePair.prototype.distance=0;goog.exportProperty(box2d.b2ParticlePair.prototype,"distance",box2d.b2ParticlePair.prototype.distance);box2d.b2ParticleTriad=function(){this.pa=new box2d.b2Vec2(0,0);this.pb=new box2d.b2Vec2(0,0);this.pc=new box2d.b2Vec2(0,0)};goog.exportSymbol("box2d.b2ParticleTriad",box2d.b2ParticleTriad);
box2d.b2ParticleTriad.prototype.indexA=0;goog.exportProperty(box2d.b2ParticleTriad.prototype,"indexA",box2d.b2ParticleTriad.prototype.indexA);box2d.b2ParticleTriad.prototype.indexB=0;goog.exportProperty(box2d.b2ParticleTriad.prototype,"indexB",box2d.b2ParticleTriad.prototype.indexB);box2d.b2ParticleTriad.prototype.indexC=0;goog.exportProperty(box2d.b2ParticleTriad.prototype,"indexC",box2d.b2ParticleTriad.prototype.indexC);box2d.b2ParticleTriad.prototype.flags=0;
goog.exportProperty(box2d.b2ParticleTriad.prototype,"flags",box2d.b2ParticleTriad.prototype.flags);box2d.b2ParticleTriad.prototype.strength=0;goog.exportProperty(box2d.b2ParticleTriad.prototype,"strength",box2d.b2ParticleTriad.prototype.strength);box2d.b2ParticleTriad.prototype.pa=null;goog.exportProperty(box2d.b2ParticleTriad.prototype,"pa",box2d.b2ParticleTriad.prototype.pa);box2d.b2ParticleTriad.prototype.pb=null;goog.exportProperty(box2d.b2ParticleTriad.prototype,"pb",box2d.b2ParticleTriad.prototype.pb);
box2d.b2ParticleTriad.prototype.pc=null;goog.exportProperty(box2d.b2ParticleTriad.prototype,"pc",box2d.b2ParticleTriad.prototype.pc);box2d.b2ParticleTriad.prototype.ka=0;goog.exportProperty(box2d.b2ParticleTriad.prototype,"ka",box2d.b2ParticleTriad.prototype.ka);box2d.b2ParticleTriad.prototype.kb=0;goog.exportProperty(box2d.b2ParticleTriad.prototype,"kb",box2d.b2ParticleTriad.prototype.kb);box2d.b2ParticleTriad.prototype.kc=0;goog.exportProperty(box2d.b2ParticleTriad.prototype,"kc",box2d.b2ParticleTriad.prototype.kc);
box2d.b2ParticleTriad.prototype.s=0;goog.exportProperty(box2d.b2ParticleTriad.prototype,"s",box2d.b2ParticleTriad.prototype.s);box2d.b2ParticleSystemDef=function(){};goog.exportSymbol("box2d.b2ParticleSystemDef",box2d.b2ParticleSystemDef);box2d.b2ParticleSystemDef.prototype.strictContactCheck=!1;goog.exportProperty(box2d.b2ParticleSystemDef.prototype,"strictContactCheck",box2d.b2ParticleSystemDef.prototype.strictContactCheck);box2d.b2ParticleSystemDef.prototype.density=1;
goog.exportProperty(box2d.b2ParticleSystemDef.prototype,"density",box2d.b2ParticleSystemDef.prototype.density);box2d.b2ParticleSystemDef.prototype.gravityScale=1;goog.exportProperty(box2d.b2ParticleSystemDef.prototype,"gravityScale",box2d.b2ParticleSystemDef.prototype.gravityScale);box2d.b2ParticleSystemDef.prototype.radius=1;goog.exportProperty(box2d.b2ParticleSystemDef.prototype,"radius",box2d.b2ParticleSystemDef.prototype.radius);box2d.b2ParticleSystemDef.prototype.maxCount=0;
goog.exportProperty(box2d.b2ParticleSystemDef.prototype,"maxCount",box2d.b2ParticleSystemDef.prototype.maxCount);box2d.b2ParticleSystemDef.prototype.pressureStrength=.005;goog.exportProperty(box2d.b2ParticleSystemDef.prototype,"pressureStrength",box2d.b2ParticleSystemDef.prototype.pressureStrength);box2d.b2ParticleSystemDef.prototype.dampingStrength=1;goog.exportProperty(box2d.b2ParticleSystemDef.prototype,"dampingStrength",box2d.b2ParticleSystemDef.prototype.dampingStrength);
box2d.b2ParticleSystemDef.prototype.elasticStrength=.25;goog.exportProperty(box2d.b2ParticleSystemDef.prototype,"elasticStrength",box2d.b2ParticleSystemDef.prototype.elasticStrength);box2d.b2ParticleSystemDef.prototype.springStrength=.25;goog.exportProperty(box2d.b2ParticleSystemDef.prototype,"springStrength",box2d.b2ParticleSystemDef.prototype.springStrength);box2d.b2ParticleSystemDef.prototype.viscousStrength=.25;goog.exportProperty(box2d.b2ParticleSystemDef.prototype,"viscousStrength",box2d.b2ParticleSystemDef.prototype.viscousStrength);
box2d.b2ParticleSystemDef.prototype.surfaceTensionPressureStrength=.2;goog.exportProperty(box2d.b2ParticleSystemDef.prototype,"surfaceTensionPressureStrength",box2d.b2ParticleSystemDef.prototype.surfaceTensionPressureStrength);box2d.b2ParticleSystemDef.prototype.surfaceTensionNormalStrength=.2;goog.exportProperty(box2d.b2ParticleSystemDef.prototype,"surfaceTensionNormalStrength",box2d.b2ParticleSystemDef.prototype.surfaceTensionNormalStrength);
box2d.b2ParticleSystemDef.prototype.repulsiveStrength=1;goog.exportProperty(box2d.b2ParticleSystemDef.prototype,"repulsiveStrength",box2d.b2ParticleSystemDef.prototype.repulsiveStrength);box2d.b2ParticleSystemDef.prototype.powderStrength=.5;goog.exportProperty(box2d.b2ParticleSystemDef.prototype,"powderStrength",box2d.b2ParticleSystemDef.prototype.powderStrength);box2d.b2ParticleSystemDef.prototype.ejectionStrength=.5;goog.exportProperty(box2d.b2ParticleSystemDef.prototype,"ejectionStrength",box2d.b2ParticleSystemDef.prototype.ejectionStrength);
box2d.b2ParticleSystemDef.prototype.staticPressureStrength=.2;goog.exportProperty(box2d.b2ParticleSystemDef.prototype,"staticPressureStrength",box2d.b2ParticleSystemDef.prototype.staticPressureStrength);box2d.b2ParticleSystemDef.prototype.staticPressureRelaxation=.2;goog.exportProperty(box2d.b2ParticleSystemDef.prototype,"staticPressureRelaxation",box2d.b2ParticleSystemDef.prototype.staticPressureRelaxation);box2d.b2ParticleSystemDef.prototype.staticPressureIterations=8;
goog.exportProperty(box2d.b2ParticleSystemDef.prototype,"staticPressureIterations",box2d.b2ParticleSystemDef.prototype.staticPressureIterations);box2d.b2ParticleSystemDef.prototype.colorMixingStrength=.5;goog.exportProperty(box2d.b2ParticleSystemDef.prototype,"colorMixingStrength",box2d.b2ParticleSystemDef.prototype.colorMixingStrength);box2d.b2ParticleSystemDef.prototype.destroyByAge=!0;goog.exportProperty(box2d.b2ParticleSystemDef.prototype,"destroyByAge",box2d.b2ParticleSystemDef.prototype.destroyByAge);
box2d.b2ParticleSystemDef.prototype.lifetimeGranularity=1/60;goog.exportProperty(box2d.b2ParticleSystemDef.prototype,"lifetimeGranularity",box2d.b2ParticleSystemDef.prototype.lifetimeGranularity);
box2d.b2ParticleSystemDef.prototype.Copy=function(a){this.strictContactCheck=a.strictContactCheck;this.density=a.density;this.gravityScale=a.gravityScale;this.radius=a.radius;this.maxCount=a.maxCount;this.pressureStrength=a.pressureStrength;this.dampingStrength=a.dampingStrength;this.elasticStrength=a.elasticStrength;this.springStrength=a.springStrength;this.viscousStrength=a.viscousStrength;this.surfaceTensionPressureStrength=a.surfaceTensionPressureStrength;this.surfaceTensionNormalStrength=a.surfaceTensionNormalStrength;
this.repulsiveStrength=a.repulsiveStrength;this.powderStrength=a.powderStrength;this.ejectionStrength=a.ejectionStrength;this.staticPressureStrength=a.staticPressureStrength;this.staticPressureRelaxation=a.staticPressureRelaxation;this.staticPressureIterations=a.staticPressureIterations;this.colorMixingStrength=a.colorMixingStrength;this.destroyByAge=a.destroyByAge;this.lifetimeGranularity=a.lifetimeGranularity;return this};box2d.b2ParticleSystemDef.prototype.Clone=function(){return(new box2d.b2ParticleSystemDef).Copy(this)};
box2d.b2ParticleSystem=function(a,b){this._ctor_(a,b)};goog.exportSymbol("box2d.b2ParticleSystem",box2d.b2ParticleSystem);box2d.b2ParticleSystem.prototype.m_paused=!1;box2d.b2ParticleSystem.prototype.m_timestamp=0;box2d.b2ParticleSystem.prototype.m_allParticleFlags=0;box2d.b2ParticleSystem.prototype.m_needsUpdateAllParticleFlags=!1;box2d.b2ParticleSystem.prototype.m_allGroupFlags=0;box2d.b2ParticleSystem.prototype.m_needsUpdateAllGroupFlags=!1;box2d.b2ParticleSystem.prototype.m_hasForce=!1;
box2d.b2ParticleSystem.prototype.m_iterationIndex=0;box2d.b2ParticleSystem.prototype.m_inverseDensity=0;box2d.b2ParticleSystem.prototype.m_particleDiameter=0;box2d.b2ParticleSystem.prototype.m_inverseDiameter=0;box2d.b2ParticleSystem.prototype.m_squaredDiameter=0;box2d.b2ParticleSystem.prototype.m_count=0;box2d.b2ParticleSystem.prototype.m_internalAllocatedCapacity=0;box2d.b2ParticleSystem.prototype.m_handleAllocator=null;box2d.b2ParticleSystem.prototype.m_handleIndexBuffer=null;
box2d.b2ParticleSystem.prototype.m_flagsBuffer=null;box2d.b2ParticleSystem.prototype.m_positionBuffer=null;box2d.b2ParticleSystem.prototype.m_velocityBuffer=null;box2d.b2ParticleSystem.prototype.m_forceBuffer=null;box2d.b2ParticleSystem.prototype.m_weightBuffer=null;box2d.b2ParticleSystem.prototype.m_staticPressureBuffer=null;box2d.b2ParticleSystem.prototype.m_accumulationBuffer=null;box2d.b2ParticleSystem.prototype.m_accumulation2Buffer=null;box2d.b2ParticleSystem.prototype.m_depthBuffer=null;
box2d.b2ParticleSystem.prototype.m_colorBuffer=null;box2d.b2ParticleSystem.prototype.m_groupBuffer=null;box2d.b2ParticleSystem.prototype.m_userDataBuffer=null;box2d.b2ParticleSystem.prototype.m_stuckThreshold=0;box2d.b2ParticleSystem.prototype.m_lastBodyContactStepBuffer=null;box2d.b2ParticleSystem.prototype.m_bodyContactCountBuffer=null;box2d.b2ParticleSystem.prototype.m_consecutiveContactStepsBuffer=null;box2d.b2ParticleSystem.prototype.m_stuckParticleBuffer=null;
box2d.b2ParticleSystem.prototype.m_proxyBuffer=null;box2d.b2ParticleSystem.prototype.m_contactBuffer=null;box2d.b2ParticleSystem.prototype.m_bodyContactBuffer=null;box2d.b2ParticleSystem.prototype.m_pairBuffer=null;box2d.b2ParticleSystem.prototype.m_triadBuffer=null;box2d.b2ParticleSystem.prototype.m_expirationTimeBuffer=null;box2d.b2ParticleSystem.prototype.m_indexByExpirationTimeBuffer=null;box2d.b2ParticleSystem.prototype.m_timeElapsed=0;
box2d.b2ParticleSystem.prototype.m_expirationTimeBufferRequiresSorting=!1;box2d.b2ParticleSystem.prototype.m_groupCount=0;box2d.b2ParticleSystem.prototype.m_groupList=null;box2d.b2ParticleSystem.prototype.m_def=null;box2d.b2ParticleSystem.prototype.m_world=null;box2d.b2ParticleSystem.prototype.m_prev=null;box2d.b2ParticleSystem.prototype.m_next=null;box2d.b2ParticleSystem.xTruncBits=12;box2d.b2ParticleSystem.yTruncBits=12;box2d.b2ParticleSystem.tagBits=32;
box2d.b2ParticleSystem.yOffset=1<<box2d.b2ParticleSystem.yTruncBits-1;box2d.b2ParticleSystem.yShift=box2d.b2ParticleSystem.tagBits-box2d.b2ParticleSystem.yTruncBits;box2d.b2ParticleSystem.xShift=box2d.b2ParticleSystem.tagBits-box2d.b2ParticleSystem.yTruncBits-box2d.b2ParticleSystem.xTruncBits;box2d.b2ParticleSystem.xScale=1<<box2d.b2ParticleSystem.xShift;box2d.b2ParticleSystem.xOffset=box2d.b2ParticleSystem.xScale*(1<<box2d.b2ParticleSystem.xTruncBits-1);
box2d.b2ParticleSystem.yMask=(1<<box2d.b2ParticleSystem.yTruncBits)-1<<box2d.b2ParticleSystem.yShift;box2d.b2ParticleSystem.xMask=~box2d.b2ParticleSystem.yMask;box2d.b2ParticleSystem.computeTag=function(a,b){return(b+box2d.b2ParticleSystem.yOffset>>>0<<box2d.b2ParticleSystem.yShift)+(box2d.b2ParticleSystem.xScale*a+box2d.b2ParticleSystem.xOffset>>>0)>>>0};box2d.b2ParticleSystem.computeRelativeTag=function(a,b,d){return a+(d<<box2d.b2ParticleSystem.yShift)+(b<<box2d.b2ParticleSystem.xShift)>>>0};
box2d.b2ParticleSystem.FixedSetAllocator=function(){};box2d.b2ParticleSystem.FixedSetAllocator.prototype.Invalidate=function(a){};box2d.b2ParticleSystem.FixtureParticle=function(a,b){this.first=a;this.second=b};box2d.b2ParticleSystem.FixtureParticle.prototype.first=null;box2d.b2ParticleSystem.FixtureParticle.prototype.second=box2d.b2_invalidParticleIndex;box2d.b2ParticleSystem.FixtureParticleSet=function(){};goog.inherits(box2d.b2ParticleSystem.FixtureParticleSet,box2d.b2ParticleSystem.FixedSetAllocator);
box2d.b2ParticleSystem.FixtureParticleSet.prototype.Initialize=function(a,b){};box2d.b2ParticleSystem.FixtureParticleSet.prototype.Find=function(a){};box2d.b2ParticleSystem.ParticlePair=function(a,b){};box2d.b2ParticleSystem.ParticlePair.prototype.first=box2d.b2_invalidParticleIndex;box2d.b2ParticleSystem.ParticlePair.prototype.second=box2d.b2_invalidParticleIndex;box2d.b2ParticleSystem.b2ParticlePairSet=function(){};goog.inherits(box2d.b2ParticleSystem.b2ParticlePairSet,box2d.b2ParticleSystem.FixedSetAllocator);
box2d.b2ParticleSystem.b2ParticlePairSet.prototype.Initialize=function(a,b){};box2d.b2ParticleSystem.b2ParticlePairSet.prototype.Find=function(a){};box2d.b2ParticleSystem.ConnectionFilter=function(){};box2d.b2ParticleSystem.ConnectionFilter.prototype.IsNecessary=function(a){return!0};box2d.b2ParticleSystem.ConnectionFilter.prototype.ShouldCreatePair=function(a,b){return!0};box2d.b2ParticleSystem.ConnectionFilter.prototype.ShouldCreateTriad=function(a,b,d){return!0};
box2d.b2ParticleSystem.prototype._ctor_=function(a,b){this.m_handleIndexBuffer=new box2d.b2ParticleSystem.UserOverridableBuffer;this.m_flagsBuffer=new box2d.b2ParticleSystem.UserOverridableBuffer;this.m_positionBuffer=new box2d.b2ParticleSystem.UserOverridableBuffer;this.m_velocityBuffer=new box2d.b2ParticleSystem.UserOverridableBuffer;this.m_forceBuffer=[];this.m_weightBuffer=[];this.m_staticPressureBuffer=[];this.m_accumulationBuffer=[];this.m_accumulation2Buffer=[];this.m_depthBuffer=[];this.m_colorBuffer=
new box2d.b2ParticleSystem.UserOverridableBuffer;this.m_groupBuffer=[];this.m_userDataBuffer=new box2d.b2ParticleSystem.UserOverridableBuffer;this.m_lastBodyContactStepBuffer=new box2d.b2ParticleSystem.UserOverridableBuffer;this.m_bodyContactCountBuffer=new box2d.b2ParticleSystem.UserOverridableBuffer;this.m_consecutiveContactStepsBuffer=new box2d.b2ParticleSystem.UserOverridableBuffer;this.m_stuckParticleBuffer=new box2d.b2GrowableBuffer(function(){return 0});this.m_proxyBuffer=new box2d.b2GrowableBuffer(function(){return new box2d.b2ParticleSystem.Proxy});
this.m_contactBuffer=new box2d.b2GrowableBuffer(function(){return new box2d.b2ParticleContact});this.m_bodyContactBuffer=new box2d.b2GrowableBuffer(function(){return new box2d.b2ParticleBodyContact});this.m_pairBuffer=new box2d.b2GrowableBuffer(function(){return new box2d.b2ParticlePair});this.m_triadBuffer=new box2d.b2GrowableBuffer(function(){return new box2d.b2ParticleTriad});this.m_expirationTimeBuffer=new box2d.b2ParticleSystem.UserOverridableBuffer;this.m_indexByExpirationTimeBuffer=new box2d.b2ParticleSystem.UserOverridableBuffer;
this.m_def=new box2d.b2ParticleSystemDef;box2d.b2Assert(null!==a);this.SetStrictContactCheck(a.strictContactCheck);this.SetDensity(a.density);this.SetGravityScale(a.gravityScale);this.SetRadius(a.radius);this.SetMaxParticleCount(a.maxCount);box2d.b2Assert(0<a.lifetimeGranularity);this.m_def=a.Clone();this.m_world=b;this.SetDestructionByAge(this.m_def.destroyByAge)};
box2d.b2ParticleSystem.prototype._dtor_=function(){for(;this.m_groupList;)this.DestroyParticleGroup(this.m_groupList);this.FreeUserOverridableBuffer(this.m_handleIndexBuffer);this.FreeUserOverridableBuffer(this.m_flagsBuffer);this.FreeUserOverridableBuffer(this.m_lastBodyContactStepBuffer);this.FreeUserOverridableBuffer(this.m_bodyContactCountBuffer);this.FreeUserOverridableBuffer(this.m_consecutiveContactStepsBuffer);this.FreeUserOverridableBuffer(this.m_positionBuffer);this.FreeUserOverridableBuffer(this.m_velocityBuffer);
this.FreeUserOverridableBuffer(this.m_colorBuffer);this.FreeUserOverridableBuffer(this.m_userDataBuffer);this.FreeUserOverridableBuffer(this.m_expirationTimeBuffer);this.FreeUserOverridableBuffer(this.m_indexByExpirationTimeBuffer);this.FreeBuffer(this.m_forceBuffer,this.m_internalAllocatedCapacity);this.FreeBuffer(this.m_weightBuffer,this.m_internalAllocatedCapacity);this.FreeBuffer(this.m_staticPressureBuffer,this.m_internalAllocatedCapacity);this.FreeBuffer(this.m_accumulationBuffer,this.m_internalAllocatedCapacity);
this.FreeBuffer(this.m_accumulation2Buffer,this.m_internalAllocatedCapacity);this.FreeBuffer(this.m_depthBuffer,this.m_internalAllocatedCapacity);this.FreeBuffer(this.m_groupBuffer,this.m_internalAllocatedCapacity)};box2d.b2ParticleSystem.prototype.Drop=function(){this._dtor_()};
box2d.b2ParticleSystem.prototype.CreateParticle=function(a){box2d.b2Assert(!1===this.m_world.IsLocked());if(this.m_world.IsLocked())return 0;this.m_count>=this.m_internalAllocatedCapacity&&this.ReallocateInternalAllocatedBuffers(this.m_count?2*this.m_count:box2d.b2_minParticleSystemBufferCapacity);if(this.m_count>=this.m_internalAllocatedCapacity)if(this.m_def.destroyByAge)this.DestroyOldestParticle(0,!1),this.SolveZombie();else return box2d.b2_invalidParticleIndex;var b=this.m_count++;this.m_flagsBuffer.data[b]=
0;this.m_lastBodyContactStepBuffer.data&&(this.m_lastBodyContactStepBuffer.data[b]=0);this.m_bodyContactCountBuffer.data&&(this.m_bodyContactCountBuffer.data[b]=0);this.m_consecutiveContactStepsBuffer.data&&(this.m_consecutiveContactStepsBuffer.data[b]=0);this.m_positionBuffer.data[b]=a.position.Clone();this.m_velocityBuffer.data[b]=a.velocity.Clone();this.m_weightBuffer[b]=0;this.m_forceBuffer[b]=box2d.b2Vec2_zero.Clone();this.m_staticPressureBuffer&&(this.m_staticPressureBuffer[b]=0);this.m_depthBuffer&&
(this.m_depthBuffer[b]=0);if(this.m_colorBuffer.data||!a.color.IsZero())this.m_colorBuffer.data=this.RequestBuffer(this.m_colorBuffer.data),this.m_colorBuffer.data[b]=a.color.Clone();if(this.m_userDataBuffer.data||a.userData)this.m_userDataBuffer.data=this.RequestBuffer(this.m_userDataBuffer.data),this.m_userDataBuffer.data[b]=a.userData;this.m_handleIndexBuffer.data&&(this.m_handleIndexBuffer.data[b]=null);var d=this.m_proxyBuffer.data[this.m_proxyBuffer.Append()],e=0<a.lifetime;if(this.m_expirationTimeBuffer.data||
e)this.SetParticleLifetime(b,e?a.lifetime:this.ExpirationTimeToLifetime(-this.GetQuantizedTimeElapsed())),this.m_indexByExpirationTimeBuffer.data[b]=b;d.index=b;d=a.group;if(this.m_groupBuffer[b]=d)d.m_firstIndex<d.m_lastIndex?(this.RotateBuffer(d.m_firstIndex,d.m_lastIndex,b),box2d.b2Assert(d.m_lastIndex===b)):d.m_firstIndex=b,d.m_lastIndex=b+1;this.SetParticleFlags(b,a.flags);return b};goog.exportProperty(box2d.b2ParticleSystem.prototype,"CreateParticle",box2d.b2ParticleSystem.prototype.CreateParticle);
box2d.b2ParticleSystem.prototype.GetParticleHandleFromIndex=function(a){box2d.b2Assert(0<=a&&a<this.GetParticleCount()&&a!==box2d.b2_invalidParticleIndex);this.m_handleIndexBuffer.data=this.RequestBuffer(this.m_handleIndexBuffer.data);var b=this.m_handleIndexBuffer.data[a];if(b)return b;b=new box2d.b2ParticleHandle;box2d.b2Assert(null!==b);b.SetIndex(a);return this.m_handleIndexBuffer.data[a]=b};goog.exportProperty(box2d.b2ParticleSystem.prototype,"GetParticleHandleFromIndex",box2d.b2ParticleSystem.prototype.GetParticleHandleFromIndex);
box2d.b2ParticleSystem.prototype.DestroyParticle=function(a,b){var d=box2d.b2ParticleFlag.b2_zombieParticle;b&&(d|=box2d.b2ParticleFlag.b2_destructionListenerParticle);this.SetParticleFlags(a,this.m_flagsBuffer.data[a]|d)};goog.exportProperty(box2d.b2ParticleSystem.prototype,"DestroyParticle",box2d.b2ParticleSystem.prototype.DestroyParticle);
box2d.b2ParticleSystem.prototype.DestroyOldestParticle=function(a,b){var d=this.GetParticleCount();box2d.b2Assert(0<=a&&a<d);box2d.b2Assert(null!==this.m_indexByExpirationTimeBuffer.data);var d=this.m_indexByExpirationTimeBuffer.data[d-(a+1)],e=this.m_indexByExpirationTimeBuffer.data[a];this.DestroyParticle(0<this.m_expirationTimeBuffer.data[d]?d:e,b)};
box2d.b2ParticleSystem.DestroyParticlesInShapeCallback=function(a,b,d,e){this.m_system=a;this.m_shape=b;this.m_xf=d;this.m_callDestructionListener=e;this.m_destroyed=0};goog.inherits(box2d.b2ParticleSystem.DestroyParticlesInShapeCallback,box2d.b2QueryCallback);box2d.b2ParticleSystem.DestroyParticlesInShapeCallback.prototype.m_system=null;box2d.b2ParticleSystem.DestroyParticlesInShapeCallback.prototype.m_shape=null;box2d.b2ParticleSystem.DestroyParticlesInShapeCallback.prototype.m_xf=null;
box2d.b2ParticleSystem.DestroyParticlesInShapeCallback.prototype.m_callDestructionListener=!1;box2d.b2ParticleSystem.DestroyParticlesInShapeCallback.prototype.m_destroyed=0;box2d.b2ParticleSystem.DestroyParticlesInShapeCallback.prototype.ReportFixture=function(a){return!1};
box2d.b2ParticleSystem.DestroyParticlesInShapeCallback.prototype.ReportParticle=function(a,b){if(a!==this.m_system)return!1;box2d.b2Assert(0<=b&&b<this.m_system.m_count);this.m_shape.TestPoint(this.m_xf,this.m_system.m_positionBuffer.data[b])&&(this.m_system.DestroyParticle(b,this.m_callDestructionListener),this.m_destroyed++);return!0};box2d.b2ParticleSystem.DestroyParticlesInShapeCallback.prototype.Destroyed=function(){return this.m_destroyed};
box2d.b2ParticleSystem.prototype.DestroyParticlesInShape=function(a,b,d){var e=box2d.b2ParticleSystem.prototype.DestroyParticlesInShape.s_aabb;box2d.b2Assert(!1===this.m_world.IsLocked());if(this.m_world.IsLocked())return 0;d=new box2d.b2ParticleSystem.DestroyParticlesInShapeCallback(this,a,b,d);a.ComputeAABB(e,b,0);this.m_world.QueryAABB(d,e);return d.Destroyed()};goog.exportProperty(box2d.b2ParticleSystem.prototype,"DestroyParticlesInShape",box2d.b2ParticleSystem.prototype.DestroyParticlesInShape);
box2d.b2ParticleSystem.prototype.DestroyParticlesInShape.s_aabb=new box2d.b2AABB;
box2d.b2ParticleSystem.prototype.CreateParticleGroup=function(a){var b=box2d.b2ParticleSystem.prototype.CreateParticleGroup.s_transform;box2d.b2Assert(!1===this.m_world.IsLocked());if(this.m_world.IsLocked())return null;b.Set(a.position,a.angle);var d=this.m_count;a.shape&&this.CreateParticlesWithShapeForGroup(a.shape,a,b);a.shapes&&this.CreateParticlesWithShapesForGroup(a.shapes,a.shapeCount,a,b);if(a.particleCount){box2d.b2Assert(null!==a.positionData);for(var e=0;e<a.particleCount;e++)this.CreateParticleForGroup(a,
b,a.positionData[e])}var f=this.m_count,g=new box2d.b2ParticleGroup;g.m_system=this;g.m_firstIndex=d;g.m_lastIndex=f;g.m_strength=a.strength;g.m_userData=a.userData;g.m_transform.Copy(b);g.m_prev=null;if(g.m_next=this.m_groupList)this.m_groupList.m_prev=g;this.m_groupList=g;++this.m_groupCount;for(e=d;e<f;e++)this.m_groupBuffer[e]=g;this.SetGroupFlags(g,a.groupFlags);b=new box2d.b2ParticleSystem.ConnectionFilter;this.UpdateContacts(!0);this.UpdatePairsAndTriads(d,f,b);a.group&&(this.JoinParticleGroups(a.group,
g),g=a.group);return g};goog.exportProperty(box2d.b2ParticleSystem.prototype,"CreateParticleGroup",box2d.b2ParticleSystem.prototype.CreateParticleGroup);box2d.b2ParticleSystem.prototype.CreateParticleGroup.s_transform=new box2d.b2Transform;box2d.b2ParticleSystem.JoinParticleGroupsFilter=function(a){this.m_threshold=a};goog.inherits(box2d.b2ParticleSystem.JoinParticleGroupsFilter,box2d.b2ParticleSystem.ConnectionFilter);box2d.b2ParticleSystem.JoinParticleGroupsFilter.prototype.m_threshold=0;
box2d.b2ParticleSystem.JoinParticleGroupsFilter.prototype.ShouldCreatePair=function(a,b){return a<this.m_threshold&&this.m_threshold<=b||b<this.m_threshold&&this.m_threshold<=a};box2d.b2ParticleSystem.JoinParticleGroupsFilter.prototype.ShouldCreateTriad=function(a,b,d){return(a<this.m_threshold||b<this.m_threshold||d<this.m_threshold)&&(this.m_threshold<=a||this.m_threshold<=b||this.m_threshold<=d)};
box2d.b2ParticleSystem.prototype.JoinParticleGroups=function(a,b){box2d.b2Assert(!1===this.m_world.IsLocked());if(!this.m_world.IsLocked()){box2d.b2Assert(a!==b);this.RotateBuffer(b.m_firstIndex,b.m_lastIndex,this.m_count);box2d.b2Assert(b.m_lastIndex===this.m_count);this.RotateBuffer(a.m_firstIndex,a.m_lastIndex,b.m_firstIndex);box2d.b2Assert(a.m_lastIndex===b.m_firstIndex);var d=new box2d.b2ParticleSystem.JoinParticleGroupsFilter(b.m_firstIndex);this.UpdateContacts(!0);this.UpdatePairsAndTriads(a.m_firstIndex,
b.m_lastIndex,d);for(d=b.m_firstIndex;d<b.m_lastIndex;d++)this.m_groupBuffer[d]=a;this.SetGroupFlags(a,a.m_groupFlags|b.m_groupFlags);a.m_lastIndex=b.m_lastIndex;b.m_firstIndex=b.m_lastIndex;this.DestroyParticleGroup(b)}};goog.exportProperty(box2d.b2ParticleSystem.prototype,"JoinParticleGroups",box2d.b2ParticleSystem.prototype.JoinParticleGroups);
box2d.b2ParticleSystem.prototype.SplitParticleGroup=function(a){this.UpdateContacts(!0);var b=a.GetParticleCount(),b=box2d.b2MakeArray(b,function(a){return new box2d.b2ParticleSystem.ParticleListNode});box2d.b2ParticleSystem.InitializeParticleLists(a,b);this.MergeParticleListsInContact(a,b);var d=box2d.b2ParticleSystem.FindLongestParticleList(a,b);this.MergeZombieParticleListNodes(a,b,d);this.CreateParticleGroupsFromParticleList(a,b,d);this.UpdatePairsAndTriadsWithParticleList(a,b)};
goog.exportProperty(box2d.b2ParticleSystem.prototype,"SplitParticleGroup",box2d.b2ParticleSystem.prototype.SplitParticleGroup);box2d.b2ParticleSystem.prototype.GetParticleGroupList=function(){return this.m_groupList};goog.exportProperty(box2d.b2ParticleSystem.prototype,"GetParticleGroupList",box2d.b2ParticleSystem.prototype.GetParticleGroupList);box2d.b2ParticleSystem.prototype.GetParticleGroupCount=function(){return this.m_groupCount};
goog.exportProperty(box2d.b2ParticleSystem.prototype,"GetParticleGroupCount",box2d.b2ParticleSystem.prototype.GetParticleGroupCount);box2d.b2ParticleSystem.prototype.GetParticleCount=function(){return this.m_count};goog.exportProperty(box2d.b2ParticleSystem.prototype,"GetParticleCount",box2d.b2ParticleSystem.prototype.GetParticleCount);box2d.b2ParticleSystem.prototype.GetMaxParticleCount=function(){return this.m_def.maxCount};
goog.exportProperty(box2d.b2ParticleSystem.prototype,"GetMaxParticleCount",box2d.b2ParticleSystem.prototype.GetMaxParticleCount);box2d.b2ParticleSystem.prototype.SetMaxParticleCount=function(a){box2d.b2Assert(this.m_count<=a);this.m_def.maxCount=a};goog.exportProperty(box2d.b2ParticleSystem.prototype,"SetMaxParticleCount",box2d.b2ParticleSystem.prototype.SetMaxParticleCount);box2d.b2ParticleSystem.prototype.GetAllParticleFlags=function(){return this.m_allParticleFlags};
goog.exportProperty(box2d.b2ParticleSystem.prototype,"GetAllParticleFlags",box2d.b2ParticleSystem.prototype.GetAllParticleFlags);box2d.b2ParticleSystem.prototype.GetAllGroupFlags=function(){return this.m_allGroupFlags};goog.exportProperty(box2d.b2ParticleSystem.prototype,"GetAllGroupFlags",box2d.b2ParticleSystem.prototype.GetAllGroupFlags);box2d.b2ParticleSystem.prototype.SetPaused=function(a){this.m_paused=a};goog.exportProperty(box2d.b2ParticleSystem.prototype,"SetPaused",box2d.b2ParticleSystem.prototype.SetPaused);
box2d.b2ParticleSystem.prototype.GetPaused=function(){return this.m_paused};goog.exportProperty(box2d.b2ParticleSystem.prototype,"GetPaused",box2d.b2ParticleSystem.prototype.GetPaused);box2d.b2ParticleSystem.prototype.SetDensity=function(a){this.m_def.density=a;this.m_inverseDensity=1/this.m_def.density};goog.exportProperty(box2d.b2ParticleSystem.prototype,"SetDensity",box2d.b2ParticleSystem.prototype.SetDensity);box2d.b2ParticleSystem.prototype.GetDensity=function(){return this.m_def.density};
goog.exportProperty(box2d.b2ParticleSystem.prototype,"GetDensity",box2d.b2ParticleSystem.prototype.GetDensity);box2d.b2ParticleSystem.prototype.SetGravityScale=function(a){this.m_def.gravityScale=a};goog.exportProperty(box2d.b2ParticleSystem.prototype,"SetGravityScale",box2d.b2ParticleSystem.prototype.SetGravityScale);box2d.b2ParticleSystem.prototype.GetGravityScale=function(){return this.m_def.gravityScale};goog.exportProperty(box2d.b2ParticleSystem.prototype,"GetGravityScale",box2d.b2ParticleSystem.prototype.GetGravityScale);
box2d.b2ParticleSystem.prototype.SetDamping=function(a){this.m_def.dampingStrength=a};goog.exportProperty(box2d.b2ParticleSystem.prototype,"SetDamping",box2d.b2ParticleSystem.prototype.SetDamping);box2d.b2ParticleSystem.prototype.GetDamping=function(){return this.m_def.dampingStrength};goog.exportProperty(box2d.b2ParticleSystem.prototype,"GetDamping",box2d.b2ParticleSystem.prototype.GetDamping);
box2d.b2ParticleSystem.prototype.SetStaticPressureIterations=function(a){this.m_def.staticPressureIterations=a};goog.exportProperty(box2d.b2ParticleSystem.prototype,"SetStaticPressureIterations",box2d.b2ParticleSystem.prototype.SetStaticPressureIterations);box2d.b2ParticleSystem.prototype.GetStaticPressureIterations=function(){return this.m_def.staticPressureIterations};goog.exportProperty(box2d.b2ParticleSystem.prototype,"GetStaticPressureIterations",box2d.b2ParticleSystem.prototype.GetStaticPressureIterations);
box2d.b2ParticleSystem.prototype.SetRadius=function(a){this.m_particleDiameter=2*a;this.m_squaredDiameter=this.m_particleDiameter*this.m_particleDiameter;this.m_inverseDiameter=1/this.m_particleDiameter};goog.exportProperty(box2d.b2ParticleSystem.prototype,"SetRadius",box2d.b2ParticleSystem.prototype.SetRadius);box2d.b2ParticleSystem.prototype.GetRadius=function(){return this.m_particleDiameter/2};goog.exportProperty(box2d.b2ParticleSystem.prototype,"GetRadius",box2d.b2ParticleSystem.prototype.GetRadius);
box2d.b2ParticleSystem.prototype.GetPositionBuffer=function(){return this.m_positionBuffer.data};goog.exportProperty(box2d.b2ParticleSystem.prototype,"GetPositionBuffer",box2d.b2ParticleSystem.prototype.GetPositionBuffer);box2d.b2ParticleSystem.prototype.GetVelocityBuffer=function(){return this.m_velocityBuffer.data};goog.exportProperty(box2d.b2ParticleSystem.prototype,"GetVelocityBuffer",box2d.b2ParticleSystem.prototype.GetVelocityBuffer);
box2d.b2ParticleSystem.prototype.GetColorBuffer=function(){this.m_colorBuffer.data=this.RequestBuffer(this.m_colorBuffer.data);return this.m_colorBuffer.data};goog.exportProperty(box2d.b2ParticleSystem.prototype,"GetColorBuffer",box2d.b2ParticleSystem.prototype.GetColorBuffer);box2d.b2ParticleSystem.prototype.GetGroupBuffer=function(){return this.m_groupBuffer};goog.exportProperty(box2d.b2ParticleSystem.prototype,"GetGroupBuffer",box2d.b2ParticleSystem.prototype.GetGroupBuffer);
box2d.b2ParticleSystem.prototype.GetWeightBuffer=function(){return this.m_weightBuffer};goog.exportProperty(box2d.b2ParticleSystem.prototype,"GetWeightBuffer",box2d.b2ParticleSystem.prototype.GetWeightBuffer);box2d.b2ParticleSystem.prototype.GetUserDataBuffer=function(){this.m_userDataBuffer.data=this.RequestBuffer(this.m_userDataBuffer.data);return this.m_userDataBuffer.data};goog.exportProperty(box2d.b2ParticleSystem.prototype,"GetUserDataBuffer",box2d.b2ParticleSystem.prototype.GetUserDataBuffer);
box2d.b2ParticleSystem.prototype.GetFlagsBuffer=function(){return this.m_flagsBuffer.data};goog.exportProperty(box2d.b2ParticleSystem.prototype,"GetFlagsBuffer",box2d.b2ParticleSystem.prototype.GetFlagsBuffer);
box2d.b2ParticleSystem.prototype.SetParticleFlags=function(a,b){this.m_flagsBuffer.data[a]&~b&&(this.m_needsUpdateAllParticleFlags=!0);~this.m_allParticleFlags&b&&(b&box2d.b2ParticleFlag.b2_tensileParticle&&(this.m_accumulation2Buffer=this.RequestBuffer(this.m_accumulation2Buffer)),b&box2d.b2ParticleFlag.b2_colorMixingParticle&&(this.m_colorBuffer.data=this.RequestBuffer(this.m_colorBuffer.data)),this.m_allParticleFlags|=b);this.m_flagsBuffer.data[a]=b};
goog.exportProperty(box2d.b2ParticleSystem.prototype,"SetParticleFlags",box2d.b2ParticleSystem.prototype.SetParticleFlags);box2d.b2ParticleSystem.prototype.GetParticleFlags=function(a){return this.m_flagsBuffer.data[a]};goog.exportProperty(box2d.b2ParticleSystem.prototype,"GetParticleFlags",box2d.b2ParticleSystem.prototype.GetParticleFlags);box2d.b2ParticleSystem.prototype.SetFlagsBuffer=function(a,b){this.SetUserOverridableBuffer(this.m_flagsBuffer,a,b)};
goog.exportProperty(box2d.b2ParticleSystem.prototype,"SetFlagsBuffer",box2d.b2ParticleSystem.prototype.SetFlagsBuffer);box2d.b2ParticleSystem.prototype.SetPositionBuffer=function(a,b){this.SetUserOverridableBuffer(this.m_positionBuffer,a,b)};goog.exportProperty(box2d.b2ParticleSystem.prototype,"SetPositionBuffer",box2d.b2ParticleSystem.prototype.SetPositionBuffer);box2d.b2ParticleSystem.prototype.SetVelocityBuffer=function(a,b){this.SetUserOverridableBuffer(this.m_velocityBuffer,a,b)};
goog.exportProperty(box2d.b2ParticleSystem.prototype,"SetVelocityBuffer",box2d.b2ParticleSystem.prototype.SetVelocityBuffer);box2d.b2ParticleSystem.prototype.SetColorBuffer=function(a,b){this.SetUserOverridableBuffer(this.m_colorBuffer,a,b)};goog.exportProperty(box2d.b2ParticleSystem.prototype,"SetColorBuffer",box2d.b2ParticleSystem.prototype.SetColorBuffer);box2d.b2ParticleSystem.prototype.SetUserDataBuffer=function(a,b){this.SetUserOverridableBuffer(this.m_userDataBuffer,a,b)};
goog.exportProperty(box2d.b2ParticleSystem.prototype,"SetUserDataBuffer",box2d.b2ParticleSystem.prototype.SetUserDataBuffer);box2d.b2ParticleSystem.prototype.GetContacts=function(){return this.m_contactBuffer.data};goog.exportProperty(box2d.b2ParticleSystem.prototype,"GetContacts",box2d.b2ParticleSystem.prototype.GetContacts);box2d.b2ParticleSystem.prototype.GetContactCount=function(){return this.m_contactBuffer.count};goog.exportProperty(box2d.b2ParticleSystem.prototype,"GetContactCount",box2d.b2ParticleSystem.prototype.GetContactCount);
box2d.b2ParticleSystem.prototype.GetBodyContacts=function(){return this.m_bodyContactBuffer.data};goog.exportProperty(box2d.b2ParticleSystem.prototype,"GetBodyContacts",box2d.b2ParticleSystem.prototype.GetBodyContacts);box2d.b2ParticleSystem.prototype.GetBodyContactCount=function(){return this.m_bodyContactBuffer.count};goog.exportProperty(box2d.b2ParticleSystem.prototype,"GetBodyContactCount",box2d.b2ParticleSystem.prototype.GetBodyContactCount);box2d.b2ParticleSystem.prototype.GetPairs=function(){return this.m_pairBuffer.data};
goog.exportProperty(box2d.b2ParticleSystem.prototype,"GetPairs",box2d.b2ParticleSystem.prototype.GetPairs);box2d.b2ParticleSystem.prototype.GetPairCount=function(){return this.m_pairBuffer.count};goog.exportProperty(box2d.b2ParticleSystem.prototype,"GetPairCount",box2d.b2ParticleSystem.prototype.GetPairCount);box2d.b2ParticleSystem.prototype.GetTriads=function(){return this.m_triadBuffer.data};goog.exportProperty(box2d.b2ParticleSystem.prototype,"GetTriads",box2d.b2ParticleSystem.prototype.GetTriads);
box2d.b2ParticleSystem.prototype.GetTriadCount=function(){return this.m_triadBuffer.count};goog.exportProperty(box2d.b2ParticleSystem.prototype,"GetTriadCount",box2d.b2ParticleSystem.prototype.GetTriadCount);
box2d.b2ParticleSystem.prototype.SetStuckThreshold=function(a){this.m_stuckThreshold=a;0<a&&(this.m_lastBodyContactStepBuffer.data=this.RequestBuffer(this.m_lastBodyContactStepBuffer.data),this.m_bodyContactCountBuffer.data=this.RequestBuffer(this.m_bodyContactCountBuffer.data),this.m_consecutiveContactStepsBuffer.data=this.RequestBuffer(this.m_consecutiveContactStepsBuffer.data))};box2d.b2ParticleSystem.prototype.GetStuckCandidates=function(){return this.m_stuckParticleBuffer.Data()};
goog.exportProperty(box2d.b2ParticleSystem.prototype,"GetStuckCandidates",box2d.b2ParticleSystem.prototype.GetStuckCandidates);box2d.b2ParticleSystem.prototype.GetStuckCandidateCount=function(){return this.m_stuckParticleBuffer.GetCount()};goog.exportProperty(box2d.b2ParticleSystem.prototype,"GetStuckCandidateCount",box2d.b2ParticleSystem.prototype.GetStuckCandidateCount);
box2d.b2ParticleSystem.prototype.ComputeCollisionEnergy=function(){for(var a=box2d.b2ParticleSystem.prototype.ComputeCollisionEnergy.s_v,b=this.m_velocityBuffer.data,d=0,e=0;e<this.m_contactBuffer.count;e++){var f=this.m_contactBuffer.data[e],g=f.normal,f=box2d.b2Sub_V2_V2(b[f.indexB],b[f.indexA],a),g=box2d.b2Dot_V2_V2(f,g);0>g&&(d+=g*g)}return.5*this.GetParticleMass()*d};goog.exportProperty(box2d.b2ParticleSystem.prototype,"ComputeCollisionEnergy",box2d.b2ParticleSystem.prototype.ComputeCollisionEnergy);
box2d.b2ParticleSystem.prototype.ComputeCollisionEnergy.s_v=new box2d.b2Vec2;box2d.b2ParticleSystem.prototype.SetStrictContactCheck=function(a){this.m_def.strictContactCheck=a};goog.exportProperty(box2d.b2ParticleSystem.prototype,"SetStrictContactCheck",box2d.b2ParticleSystem.prototype.SetStrictContactCheck);box2d.b2ParticleSystem.prototype.GetStrictContactCheck=function(){return this.m_def.strictContactCheck};goog.exportProperty(box2d.b2ParticleSystem.prototype,"GetStrictContactCheck",box2d.b2ParticleSystem.prototype.GetStrictContactCheck);
box2d.b2ParticleSystem.prototype.SetParticleLifetime=function(a,b){box2d.b2Assert(this.ValidateParticleIndex(a));var d=null===this.m_indexByExpirationTimeBuffer.data;this.m_expirationTimeBuffer.data=this.RequestBuffer(this.m_expirationTimeBuffer.data);this.m_indexByExpirationTimeBuffer.data=this.RequestBuffer(this.m_indexByExpirationTimeBuffer.data);if(d)for(var d=this.GetParticleCount(),e=0;e<d;++e)this.m_indexByExpirationTimeBuffer.data[e]=e;d=b/this.m_def.lifetimeGranularity;d=0<d?this.GetQuantizedTimeElapsed()+
d:d;d!==this.m_expirationTimeBuffer.data[a]&&(this.m_expirationTimeBuffer.data[a]=d,this.m_expirationTimeBufferRequiresSorting=!0)};goog.exportProperty(box2d.b2ParticleSystem.prototype,"SetParticleLifetime",box2d.b2ParticleSystem.prototype.SetParticleLifetime);box2d.b2ParticleSystem.prototype.GetParticleLifetime=function(a){box2d.b2Assert(this.ValidateParticleIndex(a));return this.ExpirationTimeToLifetime(this.GetExpirationTimeBuffer()[a])};
goog.exportProperty(box2d.b2ParticleSystem.prototype,"GetParticleLifetime",box2d.b2ParticleSystem.prototype.GetParticleLifetime);box2d.b2ParticleSystem.prototype.SetDestructionByAge=function(a){a&&this.GetExpirationTimeBuffer();this.m_def.destroyByAge=a};goog.exportProperty(box2d.b2ParticleSystem.prototype,"SetDestructionByAge",box2d.b2ParticleSystem.prototype.SetDestructionByAge);box2d.b2ParticleSystem.prototype.GetDestructionByAge=function(){return this.m_def.destroyByAge};
goog.exportProperty(box2d.b2ParticleSystem.prototype,"GetDestructionByAge",box2d.b2ParticleSystem.prototype.GetDestructionByAge);box2d.b2ParticleSystem.prototype.GetExpirationTimeBuffer=function(){this.m_expirationTimeBuffer.data=this.RequestBuffer(this.m_expirationTimeBuffer.data);return this.m_expirationTimeBuffer.data};goog.exportProperty(box2d.b2ParticleSystem.prototype,"GetExpirationTimeBuffer",box2d.b2ParticleSystem.prototype.GetExpirationTimeBuffer);
box2d.b2ParticleSystem.prototype.ExpirationTimeToLifetime=function(a){return(0<a?a-this.GetQuantizedTimeElapsed():a)*this.m_def.lifetimeGranularity};goog.exportProperty(box2d.b2ParticleSystem.prototype,"ExpirationTimeToLifetime",box2d.b2ParticleSystem.prototype.ExpirationTimeToLifetime);
box2d.b2ParticleSystem.prototype.GetIndexByExpirationTimeBuffer=function(){this.GetParticleCount()?this.SetParticleLifetime(0,this.GetParticleLifetime(0)):this.m_indexByExpirationTimeBuffer.data=this.RequestBuffer(this.m_indexByExpirationTimeBuffer.data);return this.m_indexByExpirationTimeBuffer.data};goog.exportProperty(box2d.b2ParticleSystem.prototype,"GetIndexByExpirationTimeBuffer",box2d.b2ParticleSystem.prototype.GetIndexByExpirationTimeBuffer);
box2d.b2ParticleSystem.prototype.ParticleApplyLinearImpulse=function(a,b){this.ApplyLinearImpulse(a,a+1,b)};goog.exportProperty(box2d.b2ParticleSystem.prototype,"ParticleApplyLinearImpulse",box2d.b2ParticleSystem.prototype.ParticleApplyLinearImpulse);box2d.b2ParticleSystem.prototype.ApplyLinearImpulse=function(a,b,d){var e=this.m_velocityBuffer.data,f=(b-a)*this.GetParticleMass();for(d=d.Clone().SelfMul(1/f);a<b;a++)e[a].SelfAdd(d)};
goog.exportProperty(box2d.b2ParticleSystem.prototype,"ApplyLinearImpulse",box2d.b2ParticleSystem.prototype.ApplyLinearImpulse);box2d.b2ParticleSystem.IsSignificantForce=function(a){return 0!==a.x||0!==a.y};box2d.b2ParticleSystem.prototype.ParticleApplyForce=function(a,b){box2d.b2ParticleSystem.IsSignificantForce(b)&&this.ForceCanBeApplied(this.m_flagsBuffer.data[a])&&(this.PrepareForceBuffer(),this.m_forceBuffer[a].SelfAdd(b))};
goog.exportProperty(box2d.b2ParticleSystem.prototype,"ParticleApplyForce",box2d.b2ParticleSystem.prototype.ParticleApplyForce);box2d.b2ParticleSystem.prototype.ApplyForce=function(a,b,d){for(var e=0,f=a;f<b;f++)e|=this.m_flagsBuffer.data[f];box2d.b2Assert(this.ForceCanBeApplied(e));d=d.Clone().SelfMul(1/(b-a));if(box2d.b2ParticleSystem.IsSignificantForce(d))for(this.PrepareForceBuffer(),f=a;f<b;f++)this.m_forceBuffer[f].SelfAdd(d)};
goog.exportProperty(box2d.b2ParticleSystem.prototype,"ApplyForce",box2d.b2ParticleSystem.prototype.ApplyForce);box2d.b2ParticleSystem.prototype.GetNext=function(){return this.m_next};goog.exportProperty(box2d.b2ParticleSystem.prototype,"GetNext",box2d.b2ParticleSystem.prototype.GetNext);
box2d.b2ParticleSystem.prototype.QueryAABB=function(a,b){if(0!==this.m_proxyBuffer.count)for(var d=this.m_proxyBuffer.count,e=box2d.std_lower_bound(this.m_proxyBuffer.data,0,d,box2d.b2ParticleSystem.computeTag(this.m_inverseDiameter*b.lowerBound.x,this.m_inverseDiameter*b.lowerBound.y),box2d.b2ParticleSystem.Proxy.CompareProxyTag),d=box2d.std_upper_bound(this.m_proxyBuffer.data,e,d,box2d.b2ParticleSystem.computeTag(this.m_inverseDiameter*b.upperBound.x,this.m_inverseDiameter*b.upperBound.y),box2d.b2ParticleSystem.Proxy.CompareTagProxy),
f=this.m_positionBuffer.data;e<d;++e){var g=this.m_proxyBuffer.data[e].index,k=f[g];if(b.lowerBound.x<k.x&&k.x<b.upperBound.x&&b.lowerBound.y<k.y&&k.y<b.upperBound.y&&!a.ReportParticle(this,g))break}};goog.exportProperty(box2d.b2ParticleSystem.prototype,"QueryAABB",box2d.b2ParticleSystem.prototype.QueryAABB);box2d.b2ParticleSystem.prototype.QueryShapeAABB=function(a,b,d,e){var f=box2d.b2ParticleSystem.prototype.QueryShapeAABB.s_aabb;b.ComputeAABB(f,d,e||0);this.QueryAABB(a,f)};
goog.exportProperty(box2d.b2ParticleSystem.prototype,"QueryShapeAABB",box2d.b2ParticleSystem.prototype.QueryShapeAABB);box2d.b2ParticleSystem.prototype.QueryShapeAABB.s_aabb=new box2d.b2AABB;box2d.b2ParticleSystem.prototype.QueryPointAABB=function(a,b,d){var e=box2d.b2ParticleSystem.prototype.QueryPointAABB.s_aabb;d="number"===typeof d?d:box2d.b2_linearSlop;e.lowerBound.Set(b.x-d,b.y-d);e.upperBound.Set(b.x+d,b.y+d);this.QueryAABB(a,e)};
goog.exportProperty(box2d.b2ParticleSystem.prototype,"QueryPointAABB",box2d.b2ParticleSystem.prototype.QueryPointAABB);box2d.b2ParticleSystem.prototype.QueryPointAABB.s_aabb=new box2d.b2AABB;
box2d.b2ParticleSystem.prototype.RayCast=function(a,b,d){var e=box2d.b2ParticleSystem.prototype.RayCast.s_aabb,f=box2d.b2ParticleSystem.prototype.RayCast.s_p,g=box2d.b2ParticleSystem.prototype.RayCast.s_v,k=box2d.b2ParticleSystem.prototype.RayCast.s_n,m=box2d.b2ParticleSystem.prototype.RayCast.s_point;if(0!==this.m_proxyBuffer.count){var n=this.m_positionBuffer.data;box2d.b2Min_V2_V2(b,d,e.lowerBound);box2d.b2Max_V2_V2(b,d,e.upperBound);var q=1;d=box2d.b2Sub_V2_V2(d,b,g);for(var g=box2d.b2Dot_V2_V2(d,
d),e=this.GetInsideBoundsEnumerator(e),s;0<=(s=e.GetNext());){var t=box2d.b2Sub_V2_V2(b,n[s],f),u=box2d.b2Dot_V2_V2(t,d),v=box2d.b2Dot_V2_V2(t,t),v=u*u-g*(v-this.m_squaredDiameter);if(0<=v){var y=box2d.b2Sqrt(v),v=(-u-y)/g;if(!(v>q||0>v&&(v=(-u+y)/g,0>v||v>q))&&(t=box2d.b2AddMul_V2_S_V2(t,v,d,k),t.Normalize(),s=a.ReportParticle(this,s,box2d.b2AddMul_V2_S_V2(b,v,d,m),t,v),q=box2d.b2Min(q,s),0>=q))break}}}};goog.exportProperty(box2d.b2ParticleSystem.prototype,"RayCast",box2d.b2ParticleSystem.prototype.RayCast);
box2d.b2ParticleSystem.prototype.RayCast.s_aabb=new box2d.b2AABB;box2d.b2ParticleSystem.prototype.RayCast.s_p=new box2d.b2Vec2;box2d.b2ParticleSystem.prototype.RayCast.s_v=new box2d.b2Vec2;box2d.b2ParticleSystem.prototype.RayCast.s_n=new box2d.b2Vec2;box2d.b2ParticleSystem.prototype.RayCast.s_point=new box2d.b2Vec2;
box2d.b2ParticleSystem.prototype.ComputeAABB=function(a){var b=this.GetParticleCount();box2d.b2Assert(null!==a);a.lowerBound.x=+box2d.b2_maxFloat;a.lowerBound.y=+box2d.b2_maxFloat;a.upperBound.x=-box2d.b2_maxFloat;a.upperBound.y=-box2d.b2_maxFloat;for(var d=this.m_positionBuffer.data,e=0;e<b;e++){var f=d[e];box2d.b2Min_V2_V2(a.lowerBound,f,a.lowerBound);box2d.b2Max_V2_V2(a.upperBound,f,a.upperBound)}a.lowerBound.x-=this.m_particleDiameter;a.lowerBound.y-=this.m_particleDiameter;a.upperBound.x+=this.m_particleDiameter;
a.upperBound.y+=this.m_particleDiameter};goog.exportProperty(box2d.b2ParticleSystem.prototype,"ComputeAABB",box2d.b2ParticleSystem.prototype.ComputeAABB);box2d.b2ParticleSystem.UserOverridableBuffer=function(){};box2d.b2ParticleSystem.UserOverridableBuffer.prototype.data=null;box2d.b2ParticleSystem.UserOverridableBuffer.prototype.userSuppliedCapacity=0;box2d.b2ParticleSystem.Proxy=function(){};box2d.b2ParticleSystem.Proxy.prototype.index=box2d.b2_invalidParticleIndex;
box2d.b2ParticleSystem.Proxy.prototype.tag=0;box2d.b2ParticleSystem.Proxy.CompareProxyProxy=function(a,b){return a.tag<b.tag};box2d.b2ParticleSystem.Proxy.CompareTagProxy=function(a,b){return a<b.tag};box2d.b2ParticleSystem.Proxy.CompareProxyTag=function(a,b){return a.tag<b};
box2d.b2ParticleSystem.InsideBoundsEnumerator=function(a,b,d,e,f){this.m_system=a;this.m_xLower=(b&box2d.b2ParticleSystem.xMask)>>>0;this.m_xUpper=(d&box2d.b2ParticleSystem.xMask)>>>0;this.m_yLower=(b&box2d.b2ParticleSystem.yMask)>>>0;this.m_yUpper=(d&box2d.b2ParticleSystem.yMask)>>>0;this.m_first=e;this.m_last=f;box2d.b2Assert(this.m_first<=this.m_last)};
box2d.b2ParticleSystem.InsideBoundsEnumerator.prototype.GetNext=function(){for(;this.m_first<this.m_last;){var a=(this.m_system.m_proxyBuffer.data[this.m_first].tag&box2d.b2ParticleSystem.xMask)>>>0,b=(this.m_system.m_proxyBuffer.data[this.m_first].tag&box2d.b2ParticleSystem.yMask)>>>0;box2d.b2Assert(b>=this.m_yLower);box2d.b2Assert(b<=this.m_yUpper);if(a>=this.m_xLower&&a<=this.m_xUpper)return this.m_system.m_proxyBuffer.data[this.m_first++].index;this.m_first++}return box2d.b2_invalidParticleIndex};
box2d.b2ParticleSystem.ParticleListNode=function(){};box2d.b2ParticleSystem.ParticleListNode.prototype.list=null;box2d.b2ParticleSystem.ParticleListNode.prototype.next=null;box2d.b2ParticleSystem.ParticleListNode.prototype.count=0;box2d.b2ParticleSystem.ParticleListNode.prototype.index=0;box2d.b2ParticleSystem.k_pairFlags=box2d.b2ParticleFlag.b2_springParticle;box2d.b2ParticleSystem.k_triadFlags=box2d.b2ParticleFlag.b2_elasticParticle;
box2d.b2ParticleSystem.k_noPressureFlags=box2d.b2ParticleFlag.b2_powderParticle|box2d.b2ParticleFlag.b2_tensileParticle;box2d.b2ParticleSystem.k_extraDampingFlags=box2d.b2ParticleFlag.b2_staticPressureParticle;box2d.b2ParticleSystem.k_barrierWallFlags=box2d.b2ParticleFlag.b2_barrierParticle|box2d.b2ParticleFlag.b2_wallParticle;box2d.b2ParticleSystem.prototype.FreeBuffer=function(a,b){null!==a&&(a.length=0)};
box2d.b2ParticleSystem.prototype.FreeUserOverridableBuffer=function(a){0==a.userSuppliedCapacity&&this.FreeBuffer(a.data,this.m_internalAllocatedCapacity)};box2d.b2ParticleSystem.prototype.ReallocateBuffer3=function(a,b,d){box2d.b2Assert(d>b);a=a?a.slice():[];a.length=d;return a};box2d.b2ParticleSystem.prototype.ReallocateBuffer5=function(a,b,d,e,f){box2d.b2Assert(e>d);box2d.b2Assert(!b||e<=b);f&&!a||b||(a=this.ReallocateBuffer3(a,d,e));return a};
box2d.b2ParticleSystem.prototype.ReallocateBuffer4=function(a,b,d,e){box2d.b2Assert(d>b);return this.ReallocateBuffer5(a.data,a.userSuppliedCapacity,b,d,e)};box2d.b2ParticleSystem.prototype.RequestBuffer=function(a){a||(0===this.m_internalAllocatedCapacity&&this.ReallocateInternalAllocatedBuffers(box2d.b2_minParticleSystemBufferCapacity),a=[],a.length=this.m_internalAllocatedCapacity);return a};
box2d.b2ParticleSystem.prototype.ReallocateHandleBuffers=function(a){box2d.b2Assert(a>this.m_internalAllocatedCapacity);this.m_handleIndexBuffer.data=this.ReallocateBuffer4(this.m_handleIndexBuffer,this.m_internalAllocatedCapacity,a,!0)};
box2d.b2ParticleSystem.prototype.ReallocateInternalAllocatedBuffers=function(a){function b(a,b){return b&&a>b?b:a}a=b(a,this.m_def.maxCount);a=b(a,this.m_flagsBuffer.userSuppliedCapacity);a=b(a,this.m_positionBuffer.userSuppliedCapacity);a=b(a,this.m_velocityBuffer.userSuppliedCapacity);a=b(a,this.m_colorBuffer.userSuppliedCapacity);a=b(a,this.m_userDataBuffer.userSuppliedCapacity);if(this.m_internalAllocatedCapacity<a){this.ReallocateHandleBuffers(a);this.m_flagsBuffer.data=this.ReallocateBuffer4(this.m_flagsBuffer,
this.m_internalAllocatedCapacity,a,!1);var d=0<this.m_stuckThreshold;this.m_lastBodyContactStepBuffer.data=this.ReallocateBuffer4(this.m_lastBodyContactStepBuffer,this.m_internalAllocatedCapacity,a,d);this.m_bodyContactCountBuffer.data=this.ReallocateBuffer4(this.m_bodyContactCountBuffer,this.m_internalAllocatedCapacity,a,d);this.m_consecutiveContactStepsBuffer.data=this.ReallocateBuffer4(this.m_consecutiveContactStepsBuffer,this.m_internalAllocatedCapacity,a,d);this.m_positionBuffer.data=this.ReallocateBuffer4(this.m_positionBuffer,
this.m_internalAllocatedCapacity,a,!1);this.m_velocityBuffer.data=this.ReallocateBuffer4(this.m_velocityBuffer,this.m_internalAllocatedCapacity,a,!1);this.m_forceBuffer=this.ReallocateBuffer5(this.m_forceBuffer,0,this.m_internalAllocatedCapacity,a,!1);this.m_weightBuffer=this.ReallocateBuffer5(this.m_weightBuffer,0,this.m_internalAllocatedCapacity,a,!1);this.m_staticPressureBuffer=this.ReallocateBuffer5(this.m_staticPressureBuffer,0,this.m_internalAllocatedCapacity,a,!0);this.m_accumulationBuffer=
this.ReallocateBuffer5(this.m_accumulationBuffer,0,this.m_internalAllocatedCapacity,a,!1);this.m_accumulation2Buffer=this.ReallocateBuffer5(this.m_accumulation2Buffer,0,this.m_internalAllocatedCapacity,a,!0);this.m_depthBuffer=this.ReallocateBuffer5(this.m_depthBuffer,0,this.m_internalAllocatedCapacity,a,!0);this.m_colorBuffer.data=this.ReallocateBuffer4(this.m_colorBuffer,this.m_internalAllocatedCapacity,a,!0);this.m_groupBuffer=this.ReallocateBuffer5(this.m_groupBuffer,0,this.m_internalAllocatedCapacity,
a,!1);this.m_userDataBuffer.data=this.ReallocateBuffer4(this.m_userDataBuffer,this.m_internalAllocatedCapacity,a,!0);this.m_expirationTimeBuffer.data=this.ReallocateBuffer4(this.m_expirationTimeBuffer,this.m_internalAllocatedCapacity,a,!0);this.m_indexByExpirationTimeBuffer.data=this.ReallocateBuffer4(this.m_indexByExpirationTimeBuffer,this.m_internalAllocatedCapacity,a,!1);this.m_internalAllocatedCapacity=a}};
box2d.b2ParticleSystem.prototype.CreateParticleForGroup=function(a,b,d){var e=new box2d.b2ParticleDef;e.flags=a.flags;box2d.b2Mul_X_V2(b,d,e.position);box2d.b2Add_V2_V2(a.linearVelocity,box2d.b2Cross_S_V2(a.angularVelocity,box2d.b2Sub_V2_V2(e.position,a.position,box2d.b2Vec2.s_t0),box2d.b2Vec2.s_t0),e.velocity);e.color.Copy(a.color);e.lifetime=a.lifetime;e.userData=a.userData;this.CreateParticle(e)};goog.exportProperty(box2d.b2ParticleSystem.prototype,"CreateParticleForGroup",box2d.b2ParticleSystem.prototype.CreateParticleForGroup);
box2d.b2ParticleSystem.prototype.CreateParticlesStrokeShapeForGroup=function(a,b,d){var e=box2d.b2ParticleSystem.prototype.CreateParticlesStrokeShapeForGroup.s_edge,f=box2d.b2ParticleSystem.prototype.CreateParticlesStrokeShapeForGroup.s_d,g=box2d.b2ParticleSystem.prototype.CreateParticlesStrokeShapeForGroup.s_p,k=b.stride;0===k&&(k=this.GetParticleStride());for(var m=0,n=a.GetChildCount(),q=0;q<n;q++){var s=null;a.GetType()===box2d.b2ShapeType.e_edgeShape?s=a:(box2d.b2Assert(a.GetType()===box2d.b2ShapeType.e_chainShape),
s=e,a.GetChildEdge(s,q));for(var t=box2d.b2Sub_V2_V2(s.m_vertex2,s.m_vertex1,f),u=t.Length();m<u;){var v=box2d.b2AddMul_V2_S_V2(s.m_vertex1,m/u,t,g);this.CreateParticleForGroup(b,d,v);m+=k}m-=u}};goog.exportProperty(box2d.b2ParticleSystem.prototype,"CreateParticlesStrokeShapeForGroup",box2d.b2ParticleSystem.prototype.CreateParticlesStrokeShapeForGroup);box2d.b2ParticleSystem.prototype.CreateParticlesStrokeShapeForGroup.s_edge=new box2d.b2EdgeShape;
box2d.b2ParticleSystem.prototype.CreateParticlesStrokeShapeForGroup.s_d=new box2d.b2Vec2;box2d.b2ParticleSystem.prototype.CreateParticlesStrokeShapeForGroup.s_p=new box2d.b2Vec2;
box2d.b2ParticleSystem.prototype.CreateParticlesFillShapeForGroup=function(a,b,d){var e=box2d.b2ParticleSystem.prototype.CreateParticlesFillShapeForGroup.s_aabb,f=box2d.b2ParticleSystem.prototype.CreateParticlesFillShapeForGroup.s_p,g=b.stride;0===g&&(g=this.GetParticleStride());var k=box2d.b2Transform.IDENTITY;box2d.b2Assert(1===a.GetChildCount());a.ComputeAABB(e,k,0);for(var m=Math.floor(e.lowerBound.y/g)*g;m<e.upperBound.y;m+=g)for(var n=Math.floor(e.lowerBound.x/g)*g;n<e.upperBound.x;n+=g){var q=
f.Set(n,m);a.TestPoint(k,q)&&this.CreateParticleForGroup(b,d,q)}};goog.exportProperty(box2d.b2ParticleSystem.prototype,"CreateParticlesFillShapeForGroup",box2d.b2ParticleSystem.prototype.CreateParticlesFillShapeForGroup);box2d.b2ParticleSystem.prototype.CreateParticlesFillShapeForGroup.s_aabb=new box2d.b2AABB;box2d.b2ParticleSystem.prototype.CreateParticlesFillShapeForGroup.s_p=new box2d.b2Vec2;
box2d.b2ParticleSystem.prototype.CreateParticlesWithShapeForGroup=function(a,b,d){switch(a.GetType()){case box2d.b2ShapeType.e_edgeShape:case box2d.b2ShapeType.e_chainShape:this.CreateParticlesStrokeShapeForGroup(a,b,d);break;case box2d.b2ShapeType.e_polygonShape:case box2d.b2ShapeType.e_circleShape:this.CreateParticlesFillShapeForGroup(a,b,d);break;default:box2d.b2Assert(!1)}};goog.exportProperty(box2d.b2ParticleSystem.prototype,"CreateParticlesWithShapeForGroup",box2d.b2ParticleSystem.prototype.CreateParticlesWithShapeForGroup);
box2d.b2ParticleSystem.CompositeShape=function(a,b){this.m_shapes=a;this.m_shapeCount=b};goog.inherits(box2d.b2ParticleSystem.CompositeShape,box2d.b2Shape);box2d.b2ParticleSystem.CompositeShape.prototype.m_shapes=null;box2d.b2ParticleSystem.CompositeShape.prototype.m_shapeCount=0;box2d.b2ParticleSystem.CompositeShape.prototype.Clone=function(){box2d.b2Assert(!1);return null};box2d.b2ParticleSystem.CompositeShape.prototype.GetChildCount=function(){return 1};
box2d.b2ParticleSystem.CompositeShape.prototype.TestPoint=function(a,b){for(var d=0;d<this.m_shapeCount;d++)if(this.m_shapes[d].TestPoint(a,b))return!0;return!1};goog.exportProperty(box2d.b2ParticleSystem.CompositeShape.prototype,"TestPoint",box2d.b2ParticleSystem.CompositeShape.prototype.TestPoint);box2d.b2ParticleSystem.CompositeShape.prototype.ComputeDistance=function(a,b,d,e){box2d.b2Assert(!1)};goog.exportProperty(box2d.b2ParticleSystem.CompositeShape.prototype,"ComputeDistance",box2d.b2ParticleSystem.CompositeShape.prototype.ComputeDistance);
box2d.b2ParticleSystem.CompositeShape.prototype.RayCast=function(a,b,d,e){box2d.b2Assert(!1);return!1};goog.exportProperty(box2d.b2ParticleSystem.CompositeShape.prototype,"RayCast",box2d.b2ParticleSystem.CompositeShape.prototype.RayCast);
box2d.b2ParticleSystem.CompositeShape.prototype.ComputeAABB=function(a,b,d){var e=new box2d.b2AABB;a.lowerBound.x=+box2d.b2_maxFloat;a.lowerBound.y=+box2d.b2_maxFloat;a.upperBound.x=-box2d.b2_maxFloat;a.upperBound.y=-box2d.b2_maxFloat;box2d.b2Assert(0===d);for(d=0;d<this.m_shapeCount;d++)for(var f=this.m_shapes[d].GetChildCount(),g=0;g<f;g++){var k=e;this.m_shapes[d].ComputeAABB(k,b,g);a.Combine1(k)}};goog.exportProperty(box2d.b2ParticleSystem.CompositeShape.prototype,"ComputeAABB",box2d.b2ParticleSystem.CompositeShape.prototype.ComputeAABB);
box2d.b2ParticleSystem.CompositeShape.prototype.ComputeMass=function(a,b){box2d.b2Assert(!1)};goog.exportProperty(box2d.b2ParticleSystem.CompositeShape.prototype,"ComputeMass",box2d.b2ParticleSystem.CompositeShape.prototype.ComputeMass);box2d.b2ParticleSystem.prototype.CreateParticlesWithShapesForGroup=function(a,b,d,e){a=new box2d.b2ParticleSystem.CompositeShape(a,b);this.CreateParticlesFillShapeForGroup(a,d,e)};
goog.exportProperty(box2d.b2ParticleSystem.prototype,"CreateParticlesWithShapesForGroup",box2d.b2ParticleSystem.prototype.CreateParticlesWithShapesForGroup);
box2d.b2ParticleSystem.prototype.CloneParticle=function(a,b){var d=new box2d.b2ParticleDef;d.flags=this.m_flagsBuffer.data[a];d.position.Copy(this.m_positionBuffer.data[a]);d.velocity.Copy(this.m_velocityBuffer.data[a]);this.m_colorBuffer.data&&d.color.Copy(this.m_colorBuffer.data[a]);this.m_userDataBuffer.data&&(d.userData=this.m_userDataBuffer.data[a]);d.group=b;d=this.CreateParticle(d);if(this.m_handleIndexBuffer.data){var e=this.m_handleIndexBuffer.data[a];e&&e.SetIndex(d);this.m_handleIndexBuffer.data[d]=
e;this.m_handleIndexBuffer.data[a]=null}this.m_lastBodyContactStepBuffer.data&&(this.m_lastBodyContactStepBuffer.data[d]=this.m_lastBodyContactStepBuffer.data[a]);this.m_bodyContactCountBuffer.data&&(this.m_bodyContactCountBuffer.data[d]=this.m_bodyContactCountBuffer.data[a]);this.m_consecutiveContactStepsBuffer.data&&(this.m_consecutiveContactStepsBuffer.data[d]=this.m_consecutiveContactStepsBuffer.data[a]);this.m_hasForce&&this.m_forceBuffer[d].Copy(this.m_forceBuffer[a]);this.m_staticPressureBuffer&&
(this.m_staticPressureBuffer[d]=this.m_staticPressureBuffer[a]);this.m_depthBuffer&&(this.m_depthBuffer[d]=this.m_depthBuffer[a]);this.m_expirationTimeBuffer.data&&(this.m_expirationTimeBuffer.data[d]=this.m_expirationTimeBuffer.data[a]);return d};goog.exportProperty(box2d.b2ParticleSystem.prototype,"CloneParticle",box2d.b2ParticleSystem.prototype.CloneParticle);
box2d.b2ParticleSystem.prototype.DestroyParticlesInGroup=function(a,b){for(var d=a.m_firstIndex;d<a.m_lastIndex;d++)this.DestroyParticle(d,b)};goog.exportProperty(box2d.b2ParticleSystem.prototype,"DestroyParticlesInGroup",box2d.b2ParticleSystem.prototype.DestroyParticlesInGroup);
box2d.b2ParticleSystem.prototype.DestroyParticleGroup=function(a){box2d.b2Assert(0<this.m_groupCount);box2d.b2Assert(null!==a);this.m_world.m_destructionListener&&this.m_world.m_destructionListener.SayGoodbyeParticleGroup(a);this.SetGroupFlags(a,0);for(var b=a.m_firstIndex;b<a.m_lastIndex;b++)this.m_groupBuffer[b]=null;a.m_prev&&(a.m_prev.m_next=a.m_next);a.m_next&&(a.m_next.m_prev=a.m_prev);a===this.m_groupList&&(this.m_groupList=a.m_next);--this.m_groupCount};
goog.exportProperty(box2d.b2ParticleSystem.prototype,"DestroyParticleGroup",box2d.b2ParticleSystem.prototype.DestroyParticleGroup);box2d.b2ParticleSystem.ParticleCanBeConnected=function(a,b){return 0!==(a&(box2d.b2ParticleFlag.b2_wallParticle|box2d.b2ParticleFlag.b2_springParticle|box2d.b2ParticleFlag.b2_elasticParticle))||null!==b&&0!==(b.GetGroupFlags()&box2d.b2ParticleGroupFlag.b2_rigidParticleGroup)};
box2d.b2ParticleSystem.prototype.UpdatePairsAndTriads=function(a,b,d){var e=box2d.b2ParticleSystem.prototype.UpdatePairsAndTriads.s_dab,f=box2d.b2ParticleSystem.prototype.UpdatePairsAndTriads.s_dbc,g=box2d.b2ParticleSystem.prototype.UpdatePairsAndTriads.s_dca,k=this.m_positionBuffer.data;box2d.b2Assert(a<=b);for(var m=0,n=a;n<b;n++)m|=this.m_flagsBuffer.data[n];if(m&box2d.b2ParticleSystem.k_pairFlags)for(n=0;n<this.m_contactBuffer.count;n++){var q=this.m_contactBuffer.data[n],s=q.indexA,t=q.indexB,
u=this.m_flagsBuffer.data[s],v=this.m_flagsBuffer.data[t],y=this.m_groupBuffer[s],z=this.m_groupBuffer[t];s>=a&&s<b&&t>=a&&t<b&&!((u|v)&box2d.b2ParticleFlag.b2_zombieParticle)&&(u|v)&box2d.b2ParticleSystem.k_pairFlags&&(d.IsNecessary(s)||d.IsNecessary(t))&&box2d.b2ParticleSystem.ParticleCanBeConnected(u,y)&&box2d.b2ParticleSystem.ParticleCanBeConnected(v,z)&&d.ShouldCreatePair(s,t)&&(u=this.m_pairBuffer.data[this.m_pairBuffer.Append()],u.indexA=s,u.indexB=t,u.flags=q.flags,u.strength=box2d.b2Min(y?
y.m_strength:1,z?z.m_strength:1),u.distance=box2d.b2Distance(k[s],k[t]));box2d.std_stable_sort(this.m_pairBuffer.data,0,this.m_pairBuffer.count,box2d.b2ParticleSystem.ComparePairIndices);this.m_pairBuffer.Unique(box2d.b2ParticleSystem.MatchPairIndices)}if(m&box2d.b2ParticleSystem.k_triadFlags){m=new box2d.b2VoronoiDiagram(b-a);q=0;for(n=a;n<b;n++)s=this.m_flagsBuffer.data[n],t=this.m_groupBuffer[n],s&box2d.b2ParticleFlag.b2_zombieParticle||!box2d.b2ParticleSystem.ParticleCanBeConnected(s,t)||(d.IsNecessary(n)&&
++q,m.AddGenerator(k[n],n,d.IsNecessary(n)));if(0===q)for(n=a;n<b;n++)d.IsNecessary(n);a=this.GetParticleStride();m.Generate(a/2,2*a);var A=this;m.GetNodes(function(a,b,m){var n=A.m_flagsBuffer.data[a],q=A.m_flagsBuffer.data[b],s=A.m_flagsBuffer.data[m];if((n|q|s)&box2d.b2ParticleSystem.k_triadFlags&&d.ShouldCreateTriad(a,b,m)){var t=k[a],v=k[b],u=k[m],y=box2d.b2Sub_V2_V2(t,v,e),z=box2d.b2Sub_V2_V2(v,u,f),O=box2d.b2Sub_V2_V2(u,t,g),H=box2d.b2_maxTriadDistanceSquared*A.m_squaredDiameter;if(!(box2d.b2Dot_V2_V2(y,
y)>H||box2d.b2Dot_V2_V2(z,z)>H||box2d.b2Dot_V2_V2(O,O)>H)){var T=A.m_groupBuffer[a],S=A.m_groupBuffer[b],E=A.m_groupBuffer[m],H=A.m_triadBuffer.data[A.m_triadBuffer.Append()];H.indexA=a;H.indexB=b;H.indexC=m;H.flags=n|q|s;H.strength=box2d.b2Min(box2d.b2Min(T?T.m_strength:1,S?S.m_strength:1),E?E.m_strength:1);a=(t.x+v.x+u.x)/3;b=(t.y+v.y+u.y)/3;H.pa.x=t.x-a;H.pa.y=t.y-b;H.pb.x=v.x-a;H.pb.y=v.y-b;H.pc.x=u.x-a;H.pc.y=u.y-b;H.ka=-box2d.b2Dot_V2_V2(O,y);H.kb=-box2d.b2Dot_V2_V2(y,z);H.kc=-box2d.b2Dot_V2_V2(z,
O);H.s=box2d.b2Cross_V2_V2(t,v)+box2d.b2Cross_V2_V2(v,u)+box2d.b2Cross_V2_V2(u,t)}}});box2d.std_stable_sort(this.m_triadBuffer.data,0,this.m_triadBuffer.count,box2d.b2ParticleSystem.CompareTriadIndices);this.m_triadBuffer.Unique(box2d.b2ParticleSystem.MatchTriadIndices)}};box2d.b2ParticleSystem.prototype.UpdatePairsAndTriads.s_dab=new box2d.b2Vec2;box2d.b2ParticleSystem.prototype.UpdatePairsAndTriads.s_dbc=new box2d.b2Vec2;box2d.b2ParticleSystem.prototype.UpdatePairsAndTriads.s_dca=new box2d.b2Vec2;
box2d.b2ParticleSystem.ReactiveFilter=function(a){this.m_flagsBuffer=a};goog.inherits(box2d.b2ParticleSystem.ReactiveFilter,box2d.b2ParticleSystem.ConnectionFilter);box2d.b2ParticleSystem.ReactiveFilter.prototype.m_flagsBuffer=null;box2d.b2ParticleSystem.ReactiveFilter.prototype.IsNecessary=function(a){return 0!==(this.m_flagsBuffer[a]&box2d.b2ParticleFlag.b2_reactiveParticle)};
box2d.b2ParticleSystem.prototype.UpdatePairsAndTriadsWithReactiveParticles=function(){var a=new box2d.b2ParticleSystem.ReactiveFilter(this.m_flagsBuffer);this.UpdatePairsAndTriads(0,this.m_count,a);for(a=0;a<this.m_count;a++)this.m_flagsBuffer.data[a]&=~box2d.b2ParticleFlag.b2_reactiveParticle;this.m_allParticleFlags&=~box2d.b2ParticleFlag.b2_reactiveParticle};box2d.b2ParticleSystem.ComparePairIndices=function(a,b){var d=a.indexA-b.indexA;return 0!==d?0>d:a.indexB<b.indexB};
box2d.b2ParticleSystem.MatchPairIndices=function(a,b){return a.indexA===b.indexA&&a.indexB===b.indexB};box2d.b2ParticleSystem.CompareTriadIndices=function(a,b){var d=a.indexA-b.indexA;if(0!==d)return 0>d;d=a.indexB-b.indexB;return 0!==d?0>d:a.indexC<b.indexC};box2d.b2ParticleSystem.MatchTriadIndices=function(a,b){return a.indexA===b.indexA&&a.indexB===b.indexB&&a.indexC===b.indexC};
box2d.b2ParticleSystem.InitializeParticleLists=function(a,b){for(var d=a.GetBufferIndex(),e=a.GetParticleCount(),f=0;f<e;f++){var g=b[f];g.list=g;g.next=null;g.count=1;g.index=f+d}};
box2d.b2ParticleSystem.prototype.MergeParticleListsInContact=function(a,b){for(var d=a.GetBufferIndex(),e=0;e<this.m_contactBuffer.count;e++){var f=this.m_contactBuffer.data[e],g=f.indexA,f=f.indexB;if(a.ContainsParticle(g)&&a.ContainsParticle(f)&&(g=b[g-d].list,f=b[f-d].list,g!==f)){if(g.count<f.count)var k=g,g=f,f=k;box2d.b2Assert(g.count>=f.count);box2d.b2ParticleSystem.MergeParticleLists(g,f)}}};
box2d.b2ParticleSystem.MergeParticleLists=function(a,b){box2d.b2Assert(a!==b);for(var d=b;;){d.list=a;var e=d.next;if(e)d=e;else{d.next=a.next;break}}a.next=b;a.count+=b.count;b.count=0};box2d.b2ParticleSystem.FindLongestParticleList=function(a,b){for(var d=a.GetParticleCount(),e=b[0],f=0;f<d;f++){var g=b[f];e.count<g.count&&(e=g)}return e};
box2d.b2ParticleSystem.prototype.MergeZombieParticleListNodes=function(a,b,d){a=a.GetParticleCount();for(var e=0;e<a;e++){var f=b[e];f!==d&&this.m_flagsBuffer.data[f.index]&box2d.b2ParticleFlag.b2_zombieParticle&&box2d.b2ParticleSystem.MergeParticleListAndNode(d,f)}};box2d.b2ParticleSystem.MergeParticleListAndNode=function(a,b){box2d.b2Assert(b!==a);box2d.b2Assert(b.list===b);box2d.b2Assert(1===b.count);b.list=a;b.next=a.next;a.next=b;a.count++;b.count=0};
box2d.b2ParticleSystem.prototype.CreateParticleGroupsFromParticleList=function(a,b,d){var e=a.GetParticleCount(),f=new box2d.b2ParticleGroupDef;f.groupFlags=a.GetGroupFlags();f.userData=a.GetUserData();for(a=0;a<e;a++){var g=b[a];if(g.count&&g!==d){box2d.b2Assert(g.list===g);for(var k=this.CreateParticleGroup(f);g;g=g.next){var m=g.index;box2d.b2Assert(!(this.m_flagsBuffer.data[m]&box2d.b2ParticleFlag.b2_zombieParticle));var n=this.CloneParticle(m,k);this.m_flagsBuffer.data[m]|=box2d.b2ParticleFlag.b2_zombieParticle;
g.index=n}}}};
box2d.b2ParticleSystem.prototype.UpdatePairsAndTriadsWithParticleList=function(a,b){for(var d=a.GetBufferIndex(),e=0;e<this.m_pairBuffer.count;e++){var f=this.m_pairBuffer.data[e],g=f.indexA,k=f.indexB;a.ContainsParticle(g)&&(f.indexA=b[g-d].index);a.ContainsParticle(k)&&(f.indexB=b[k-d].index)}for(e=0;e<this.m_triadBuffer.count;e++){var f=this.m_triadBuffer.data[e],g=f.indexA,k=f.indexB,m=f.indexC;a.ContainsParticle(g)&&(f.indexA=b[g-d].index);a.ContainsParticle(k)&&(f.indexB=b[k-d].index);a.ContainsParticle(m)&&
(f.indexC=b[m-d].index)}};
box2d.b2ParticleSystem.prototype.ComputeDepth=function(){for(var a=[],b=0,d=0;d<this.m_contactBuffer.count;d++){var e=this.m_contactBuffer.data[d],f=e.indexA,g=e.indexB,k=this.m_groupBuffer[f],m=this.m_groupBuffer[g];k&&k===m&&k.m_groupFlags&box2d.b2ParticleGroupFlag.b2_particleGroupNeedsUpdateDepth&&(a[b++]=e)}k=[];m=0;for(d=this.m_groupList;d;d=d.GetNext())if(d.m_groupFlags&box2d.b2ParticleGroupFlag.b2_particleGroupNeedsUpdateDepth)for(k[m++]=d,this.SetGroupFlags(d,d.m_groupFlags&~box2d.b2ParticleGroupFlag.b2_particleGroupNeedsUpdateDepth),
g=d.m_firstIndex;g<d.m_lastIndex;g++)this.m_accumulationBuffer[g]=0;for(d=0;d<b;d++){var e=a[d],f=e.indexA,g=e.indexB,n=e.weight;this.m_accumulationBuffer[f]+=n;this.m_accumulationBuffer[g]+=n}box2d.b2Assert(null!==this.m_depthBuffer);for(g=0;g<m;g++)for(d=k[g],g=d.m_firstIndex;g<d.m_lastIndex;g++)n=this.m_accumulationBuffer[g],this.m_depthBuffer[g]=.8>n?0:box2d.b2_maxFloat;for(var n=box2d.b2Sqrt(this.m_count)>>0,q=0;q<n;q++){for(var s=!1,d=0;d<b;d++){var e=a[d],f=e.indexA,g=e.indexB,t=1-e.weight,
e=this.m_depthBuffer[f],u=this.m_depthBuffer[g],v=u+t,t=e+t;e>v&&(this.m_depthBuffer[f]=v,s=!0);u>t&&(this.m_depthBuffer[g]=t,s=!0)}if(!s)break}for(g=0;g<m;g++)for(d=k[g],g=d.m_firstIndex;g<d.m_lastIndex;g++)this.m_depthBuffer[g]=this.m_depthBuffer[g]<box2d.b2_maxFloat?this.m_depthBuffer[g]*this.m_particleDiameter:0};
box2d.b2ParticleSystem.prototype.GetInsideBoundsEnumerator=function(a){var b=box2d.b2ParticleSystem.computeTag(this.m_inverseDiameter*a.lowerBound.x-1,this.m_inverseDiameter*a.lowerBound.y-1);a=box2d.b2ParticleSystem.computeTag(this.m_inverseDiameter*a.upperBound.x+1,this.m_inverseDiameter*a.upperBound.y+1);var d=this.m_proxyBuffer.count,e=box2d.std_lower_bound(this.m_proxyBuffer.data,0,d,b,box2d.b2ParticleSystem.Proxy.CompareProxyTag),f=box2d.std_upper_bound(this.m_proxyBuffer.data,0,d,a,box2d.b2ParticleSystem.Proxy.CompareTagProxy);
box2d.b2Assert(0<=e);box2d.b2Assert(e<=f);box2d.b2Assert(f<=d);return new box2d.b2ParticleSystem.InsideBoundsEnumerator(this,b,a,e,f)};box2d.b2ParticleSystem.prototype.UpdateAllParticleFlags=function(){for(var a=this.m_allParticleFlags=0;a<this.m_count;a++)this.m_allParticleFlags|=this.m_flagsBuffer.data[a];this.m_needsUpdateAllParticleFlags=!1};
box2d.b2ParticleSystem.prototype.UpdateAllGroupFlags=function(){this.m_allGroupFlags=0;for(var a=this.m_groupList;a;a=a.GetNext())this.m_allGroupFlags|=a.m_groupFlags;this.m_needsUpdateAllGroupFlags=!1};
box2d.b2ParticleSystem.prototype.AddContact=function(a,b,d){var e=box2d.b2ParticleSystem.prototype.AddContact.s_d,f=this.m_positionBuffer.data;box2d.b2Assert(d===this.m_contactBuffer);d=box2d.b2Sub_V2_V2(f[b],f[a],e);e=box2d.b2Dot_V2_V2(d,d);if(e<this.m_squaredDiameter){f=box2d.b2InvSqrt(e);isFinite(f)||(f=1.9817753699999998E19);var g=this.m_contactBuffer.data[this.m_contactBuffer.Append()];g.indexA=a;g.indexB=b;g.flags=this.m_flagsBuffer.data[a]|this.m_flagsBuffer.data[b];g.weight=1-e*f*this.m_inverseDiameter;
box2d.b2Mul_S_V2(f,d,g.normal)}};box2d.b2ParticleSystem.prototype.AddContact.s_d=new box2d.b2Vec2;
box2d.b2ParticleSystem.prototype.FindContacts_Reference=function(a){box2d.b2Assert(a===this.m_contactBuffer);a=this.m_proxyBuffer.count;for(var b=this.m_contactBuffer.count=0,d=0;b<a;b++){for(var e=box2d.b2ParticleSystem.computeRelativeTag(this.m_proxyBuffer.data[b].tag,1,0),f=b+1;f<a&&!(e<this.m_proxyBuffer.data[f].tag);f++)this.AddContact(this.m_proxyBuffer.data[b].index,this.m_proxyBuffer.data[f].index,this.m_contactBuffer);for(f=box2d.b2ParticleSystem.computeRelativeTag(this.m_proxyBuffer.data[b].tag,
-1,1);d<a&&!(f<=this.m_proxyBuffer.data[d].tag);d++);e=box2d.b2ParticleSystem.computeRelativeTag(this.m_proxyBuffer.data[b].tag,1,1);for(f=d;f<a&&!(e<this.m_proxyBuffer.data[f].tag);f++)this.AddContact(this.m_proxyBuffer.data[b].index,this.m_proxyBuffer.data[f].index,this.m_contactBuffer)}};box2d.b2ParticleSystem.prototype.FindContacts=function(a){this.FindContacts_Reference(a)};
box2d.b2ParticleSystem.prototype.UpdateProxies_Reference=function(a){box2d.b2Assert(a===this.m_proxyBuffer);a=this.m_positionBuffer.data;for(var b=this.m_inverseDiameter,d=0;d<this.m_proxyBuffer.count;++d){var e=this.m_proxyBuffer.data[d],f=a[e.index];e.tag=box2d.b2ParticleSystem.computeTag(b*f.x,b*f.y)}};box2d.b2ParticleSystem.prototype.UpdateProxies=function(a){this.UpdateProxies_Reference(a)};
box2d.b2ParticleSystem.prototype.SortProxies=function(a){box2d.b2Assert(a===this.m_proxyBuffer);box2d.std_sort(this.m_proxyBuffer.data,0,this.m_proxyBuffer.count,box2d.b2ParticleSystem.Proxy.CompareProxyProxy)};
box2d.b2ParticleSystem.prototype.FilterContacts=function(a){var b=this.GetParticleContactFilter();if(null!==b){box2d.b2Assert(a===this.m_contactBuffer);var d=this;this.m_contactBuffer.RemoveIf(function(a){return a.flags&box2d.b2ParticleFlag.b2_particleContactFilterParticle&&!b.ShouldCollideParticleParticle(d,a.indexA,a.indexB)})}};box2d.b2ParticleSystem.prototype.NotifyContactListenerPreContact=function(a){if(null!==this.GetParticleContactListener()){debugger;a.Initialize(this.m_contactBuffer,this.m_flagsBuffer)}};
box2d.b2ParticleSystem.prototype.NotifyContactListenerPostContact=function(a){a=this.GetParticleContactListener();if(null!==a){debugger;for(var b=0;b<this.m_contactBuffer.count;++b)a.BeginContactParticleParticle(this,this.m_contactBuffer.data[b])}};box2d.b2ParticleSystem.b2ParticleContactIsZombie=function(a){return(a.flags&box2d.b2ParticleFlag.b2_zombieParticle)===box2d.b2ParticleFlag.b2_zombieParticle};
box2d.b2ParticleSystem.prototype.UpdateContacts=function(a){this.UpdateProxies(this.m_proxyBuffer);this.SortProxies(this.m_proxyBuffer);var b=new box2d.b2ParticleSystem.b2ParticlePairSet;this.NotifyContactListenerPreContact(b);this.FindContacts(this.m_contactBuffer);this.FilterContacts(this.m_contactBuffer);this.NotifyContactListenerPostContact(b);a&&this.m_contactBuffer.RemoveIf(box2d.b2ParticleSystem.b2ParticleContactIsZombie)};
box2d.b2ParticleSystem.prototype.NotifyBodyContactListenerPreContact=function(a){if(null!==this.GetFixtureContactListener()){debugger;a.Initialize(this.m_bodyContactBuffer,this.m_flagsBuffer)}};box2d.b2ParticleSystem.prototype.NotifyBodyContactListenerPostContact=function(a){a=this.GetFixtureContactListener();if(null!==a){debugger;for(var b=0;b<this.m_bodyContactBuffer.count;b++){var d=this.m_bodyContactBuffer.data[b];box2d.b2Assert(null!==d);a.BeginContactFixtureParticle(this,d)}}};
box2d.b2ParticleSystem.UpdateBodyContactsCallback=function(a,b){box2d.b2FixtureParticleQueryCallback.call(this,a);this.m_contactFilter=b};goog.inherits(box2d.b2ParticleSystem.UpdateBodyContactsCallback,box2d.b2FixtureParticleQueryCallback);
box2d.b2ParticleSystem.UpdateBodyContactsCallback.prototype.ShouldCollideFixtureParticle=function(a,b,d){return this.m_contactFilter&&this.m_system.GetFlagsBuffer()[d]&box2d.b2ParticleFlag.b2_fixtureContactFilterParticle?this.m_contactFilter.ShouldCollideFixtureParticle(a,this.m_system,d):!0};goog.exportProperty(box2d.b2ParticleSystem.UpdateBodyContactsCallback.prototype,"ShouldCollideFixtureParticle",box2d.b2ParticleSystem.UpdateBodyContactsCallback.prototype.ShouldCollideFixtureParticle);
box2d.b2ParticleSystem.UpdateBodyContactsCallback.prototype.ReportFixtureAndParticle=function(a,b,d){var e=box2d.b2ParticleSystem.UpdateBodyContactsCallback.prototype.ReportFixtureAndParticle.s_rp,f=this.m_system.m_positionBuffer.data[d],g=box2d.b2ParticleSystem.UpdateBodyContactsCallback.prototype.ReportFixtureAndParticle.s_n;b=a.ComputeDistance(f,g,b);if(b<this.m_system.m_particleDiameter&&this.ShouldCollideFixtureParticle(a,this.m_system,d)){var k=a.GetBody(),m=k.GetWorldCenter(),n=k.GetMass(),
q=k.GetInertia()-n*k.GetLocalCenter().LengthSquared(),n=0<n?1/n:0,q=0<q?1/q:0,s=this.m_system.m_flagsBuffer.data[d]&box2d.b2ParticleFlag.b2_wallParticle?0:this.m_system.GetParticleInvMass(),e=box2d.b2Sub_V2_V2(f,m,e),e=box2d.b2Cross_V2_V2(e,g),e=s+n+q*e*e,f=this.m_system.m_bodyContactBuffer.data[this.m_system.m_bodyContactBuffer.Append()];f.index=d;f.body=k;f.fixture=a;f.weight=1-b*this.m_system.m_inverseDiameter;f.normal.Copy(g.SelfNeg());f.mass=0<e?1/e:0;this.m_system.DetectStuckParticle(d)}};
goog.exportProperty(box2d.b2ParticleSystem.UpdateBodyContactsCallback.prototype,"ReportFixtureAndParticle",box2d.b2ParticleSystem.UpdateBodyContactsCallback.prototype.ReportFixtureAndParticle);box2d.b2ParticleSystem.UpdateBodyContactsCallback.prototype.ReportFixtureAndParticle.s_n=new box2d.b2Vec2;box2d.b2ParticleSystem.UpdateBodyContactsCallback.prototype.ReportFixtureAndParticle.s_rp=new box2d.b2Vec2;
box2d.b2ParticleSystem.prototype.UpdateBodyContacts=function(){var a=box2d.b2ParticleSystem.prototype.UpdateBodyContacts.s_aabb,b=new box2d.b2ParticleSystem.FixtureParticleSet;this.NotifyBodyContactListenerPreContact(b);if(0<this.m_stuckThreshold)for(var d=this.GetParticleCount(),e=0;e<d;e++)this.m_bodyContactCountBuffer.data[e]=0,this.m_timestamp>this.m_lastBodyContactStepBuffer.data[e]+1&&(this.m_consecutiveContactStepsBuffer.data[e]=0);this.m_bodyContactBuffer.SetCount(0);this.m_stuckParticleBuffer.SetCount(0);
this.ComputeAABB(a);d=new box2d.b2ParticleSystem.UpdateBodyContactsCallback(this,this.GetFixtureContactFilter());this.m_world.QueryAABB(d,a);this.m_def.strictContactCheck&&this.RemoveSpuriousBodyContacts();this.NotifyBodyContactListenerPostContact(b)};box2d.b2ParticleSystem.prototype.UpdateBodyContacts.s_aabb=new box2d.b2AABB;
box2d.b2ParticleSystem.prototype.Solve=function(a){var b=box2d.b2ParticleSystem.prototype.Solve.s_subStep;if(0!==this.m_count&&(this.m_expirationTimeBuffer.data&&this.SolveLifetimes(a),this.m_allParticleFlags&box2d.b2ParticleFlag.b2_zombieParticle&&this.SolveZombie(),this.m_needsUpdateAllParticleFlags&&this.UpdateAllParticleFlags(),this.m_needsUpdateAllGroupFlags&&this.UpdateAllGroupFlags(),!this.m_paused))for(this.m_iterationIndex=0;this.m_iterationIndex<a.particleIterations;this.m_iterationIndex++){++this.m_timestamp;
var d=b.Copy(a);d.dt/=a.particleIterations;d.inv_dt*=a.particleIterations;this.UpdateContacts(!1);this.UpdateBodyContacts();this.ComputeWeight();this.m_allGroupFlags&box2d.b2ParticleGroupFlag.b2_particleGroupNeedsUpdateDepth&&this.ComputeDepth();this.m_allParticleFlags&box2d.b2ParticleFlag.b2_reactiveParticle&&this.UpdatePairsAndTriadsWithReactiveParticles();this.m_hasForce&&this.SolveForce(d);this.m_allParticleFlags&box2d.b2ParticleFlag.b2_viscousParticle&&this.SolveViscous();this.m_allParticleFlags&
box2d.b2ParticleFlag.b2_repulsiveParticle&&this.SolveRepulsive(d);this.m_allParticleFlags&box2d.b2ParticleFlag.b2_powderParticle&&this.SolvePowder(d);this.m_allParticleFlags&box2d.b2ParticleFlag.b2_tensileParticle&&this.SolveTensile(d);this.m_allGroupFlags&box2d.b2ParticleGroupFlag.b2_solidParticleGroup&&this.SolveSolid(d);this.m_allParticleFlags&box2d.b2ParticleFlag.b2_colorMixingParticle&&this.SolveColorMixing();this.SolveGravity(d);this.m_allParticleFlags&box2d.b2ParticleFlag.b2_staticPressureParticle&&
this.SolveStaticPressure(d);this.SolvePressure(d);this.SolveDamping(d);this.m_allParticleFlags&box2d.b2ParticleSystem.k_extraDampingFlags&&this.SolveExtraDamping();this.m_allParticleFlags&box2d.b2ParticleFlag.b2_elasticParticle&&this.SolveElastic(d);this.m_allParticleFlags&box2d.b2ParticleFlag.b2_springParticle&&this.SolveSpring(d);this.LimitVelocity(d);this.m_allGroupFlags&box2d.b2ParticleGroupFlag.b2_rigidParticleGroup&&this.SolveRigidDamping();this.m_allParticleFlags&box2d.b2ParticleFlag.b2_barrierParticle&&
this.SolveBarrier(d);this.SolveCollision(d);this.m_allGroupFlags&box2d.b2ParticleGroupFlag.b2_rigidParticleGroup&&this.SolveRigid(d);this.m_allParticleFlags&box2d.b2ParticleFlag.b2_wallParticle&&this.SolveWall();for(var e=0;e<this.m_count;e++)this.m_positionBuffer.data[e].SelfMulAdd(d.dt,this.m_velocityBuffer.data[e])}};goog.exportProperty(box2d.b2ParticleSystem.prototype,"Solve",box2d.b2ParticleSystem.prototype.Solve);box2d.b2ParticleSystem.prototype.Solve.s_subStep=new box2d.b2TimeStep;
box2d.b2ParticleSystem.SolveCollisionCallback=function(a,b){box2d.b2FixtureParticleQueryCallback.call(this,a);this.m_step=b};goog.inherits(box2d.b2ParticleSystem.SolveCollisionCallback,box2d.b2FixtureParticleQueryCallback);
box2d.b2ParticleSystem.SolveCollisionCallback.prototype.ReportFixtureAndParticle=function(a,b,d){var e=box2d.b2ParticleSystem.SolveCollisionCallback.prototype.ReportFixtureAndParticle.s_p1,f=box2d.b2ParticleSystem.SolveCollisionCallback.prototype.ReportFixtureAndParticle.s_output,g=box2d.b2ParticleSystem.SolveCollisionCallback.prototype.ReportFixtureAndParticle.s_input,k=box2d.b2ParticleSystem.SolveCollisionCallback.prototype.ReportFixtureAndParticle.s_p,m=box2d.b2ParticleSystem.SolveCollisionCallback.prototype.ReportFixtureAndParticle.s_v,
n=box2d.b2ParticleSystem.SolveCollisionCallback.prototype.ReportFixtureAndParticle.s_f,q=a.GetBody(),s=this.m_system.m_positionBuffer.data[d],t=this.m_system.m_velocityBuffer.data[d];0===this.m_system.m_iterationIndex?(e=box2d.b2MulT_X_V2(q.m_xf0,s,e),a.GetShape().GetType()===box2d.b2ShapeType.e_circleShape&&(e.SelfSub(q.GetLocalCenter()),box2d.b2Mul_R_V2(q.m_xf0.q,e,e),box2d.b2MulT_R_V2(q.m_xf.q,e,e),e.SelfAdd(q.GetLocalCenter())),box2d.b2Mul_X_V2(q.m_xf,e,g.p1)):g.p1.Copy(s);box2d.b2AddMul_V2_S_V2(s,
this.m_step.dt,t,g.p2);g.maxFraction=1;a.RayCast(f,g,b)&&(a=f.normal,k.x=(1-f.fraction)*g.p1.x+f.fraction*g.p2.x+box2d.b2_linearSlop*a.x,k.y=(1-f.fraction)*g.p1.y+f.fraction*g.p2.y+box2d.b2_linearSlop*a.y,m.x=this.m_step.inv_dt*(k.x-s.x),m.y=this.m_step.inv_dt*(k.y-s.y),this.m_system.m_velocityBuffer.data[d].Copy(m),n.x=this.m_step.inv_dt*this.m_system.GetParticleMass()*(t.x-m.x),n.y=this.m_step.inv_dt*this.m_system.GetParticleMass()*(t.y-m.y),this.m_system.ParticleApplyForce(d,n))};
goog.exportProperty(box2d.b2ParticleSystem.SolveCollisionCallback.prototype,"ReportFixtureAndParticle",box2d.b2ParticleSystem.SolveCollisionCallback.prototype.ReportFixtureAndParticle);box2d.b2ParticleSystem.SolveCollisionCallback.prototype.ReportFixtureAndParticle.s_p1=new box2d.b2Vec2;box2d.b2ParticleSystem.SolveCollisionCallback.prototype.ReportFixtureAndParticle.s_output=new box2d.b2RayCastOutput;box2d.b2ParticleSystem.SolveCollisionCallback.prototype.ReportFixtureAndParticle.s_input=new box2d.b2RayCastInput;
box2d.b2ParticleSystem.SolveCollisionCallback.prototype.ReportFixtureAndParticle.s_p=new box2d.b2Vec2;box2d.b2ParticleSystem.SolveCollisionCallback.prototype.ReportFixtureAndParticle.s_v=new box2d.b2Vec2;box2d.b2ParticleSystem.SolveCollisionCallback.prototype.ReportFixtureAndParticle.s_f=new box2d.b2Vec2;box2d.b2ParticleSystem.SolveCollisionCallback.prototype.ReportParticle=function(a,b){return!1};goog.exportProperty(box2d.b2ParticleSystem.SolveCollisionCallback.prototype,"ReportParticle",box2d.b2ParticleSystem.SolveCollisionCallback.prototype.ReportParticle);
box2d.b2ParticleSystem.prototype.SolveCollision=function(a){var b=this.m_positionBuffer.data,d=this.m_velocityBuffer.data,e=box2d.b2ParticleSystem.prototype.SolveCollision.s_aabb;e.lowerBound.x=+box2d.b2_maxFloat;e.lowerBound.y=+box2d.b2_maxFloat;e.upperBound.x=-box2d.b2_maxFloat;e.upperBound.y=-box2d.b2_maxFloat;for(var f=0;f<this.m_count;f++){var g=d[f],k=b[f],m=k.x+a.dt*g.x,g=k.y+a.dt*g.y;e.lowerBound.x=box2d.b2Min(e.lowerBound.x,box2d.b2Min(k.x,m));e.lowerBound.y=box2d.b2Min(e.lowerBound.y,box2d.b2Min(k.y,
g));e.upperBound.x=box2d.b2Max(e.upperBound.x,box2d.b2Max(k.x,m));e.upperBound.y=box2d.b2Max(e.upperBound.y,box2d.b2Max(k.y,g))}a=new box2d.b2ParticleSystem.SolveCollisionCallback(this,a);this.m_world.QueryAABB(a,e)};box2d.b2ParticleSystem.prototype.SolveCollision.s_aabb=new box2d.b2AABB;
box2d.b2ParticleSystem.prototype.LimitVelocity=function(a){var b=this.m_velocityBuffer.data;a=this.GetCriticalVelocitySquared(a);for(var d=0;d<this.m_count;d++){var e=b[d],f=box2d.b2Dot_V2_V2(e,e);f>a&&e.SelfMul(box2d.b2Sqrt(a/f))}};box2d.b2ParticleSystem.prototype.SolveGravity=function(a){var b=box2d.b2ParticleSystem.prototype.SolveGravity.s_gravity,d=this.m_velocityBuffer.data;a=box2d.b2Mul_S_V2(a.dt*this.m_def.gravityScale,this.m_world.GetGravity(),b);for(b=0;b<this.m_count;b++)d[b].SelfAdd(a)};
box2d.b2ParticleSystem.prototype.SolveGravity.s_gravity=new box2d.b2Vec2;
box2d.b2ParticleSystem.prototype.SolveBarrier=function(a){for(var b=box2d.b2ParticleSystem.prototype.SolveBarrier.s_aabb,d=box2d.b2ParticleSystem.prototype.SolveBarrier.s_va,e=box2d.b2ParticleSystem.prototype.SolveBarrier.s_vb,f=box2d.b2ParticleSystem.prototype.SolveBarrier.s_pba,g=box2d.b2ParticleSystem.prototype.SolveBarrier.s_vba,k=box2d.b2ParticleSystem.prototype.SolveBarrier.s_vc,m=box2d.b2ParticleSystem.prototype.SolveBarrier.s_pca,n=box2d.b2ParticleSystem.prototype.SolveBarrier.s_vca,q=box2d.b2ParticleSystem.prototype.SolveBarrier.s_qba,
s=box2d.b2ParticleSystem.prototype.SolveBarrier.s_qca,t=box2d.b2ParticleSystem.prototype.SolveBarrier.s_dv,u=box2d.b2ParticleSystem.prototype.SolveBarrier.s_f,v=this.m_positionBuffer.data,y=this.m_velocityBuffer.data,z=0;z<this.m_count;z++)0!==(this.m_flagsBuffer.data[z]&box2d.b2ParticleSystem.k_barrierWallFlags)&&y[z].SetZero();for(var z=box2d.b2_barrierCollisionTime*a.dt,A=this.GetParticleMass(),r=0;r<this.m_pairBuffer.count;r++){var D=this.m_pairBuffer.data[r];if(D.flags&box2d.b2ParticleFlag.b2_barrierParticle){var C=
D.indexA,B=D.indexB,D=v[C],F=v[B],J=b;box2d.b2Min_V2_V2(D,F,J.lowerBound);box2d.b2Max_V2_V2(D,F,J.upperBound);for(var L=this.m_groupBuffer[C],G=this.m_groupBuffer[B],C=this.GetLinearVelocity(L,C,D,d),B=this.GetLinearVelocity(G,B,F,e),F=box2d.b2Sub_V2_V2(F,D,f),B=box2d.b2Sub_V2_V2(B,C,g),J=this.GetInsideBoundsEnumerator(J),K;0<=(K=J.GetNext());){var P=v[K],R=this.m_groupBuffer[K];if(L!==R&&G!==R){var O=this.GetLinearVelocity(R,K,P,k),H=box2d.b2Sub_V2_V2(P,D,m),T=box2d.b2Sub_V2_V2(O,C,n),S=box2d.b2Cross_V2_V2(B,
T),E=box2d.b2Cross_V2_V2(F,T)-box2d.b2Cross_V2_V2(H,B),I=box2d.b2Cross_V2_V2(F,H),M=q,N=s;if(0===S){if(0===E)continue;I=-I/E;if(!(0<=I&&I<z))continue;box2d.b2AddMul_V2_S_V2(F,I,B,M);box2d.b2AddMul_V2_S_V2(H,I,T,N);E=box2d.b2Dot_V2_V2(M,N)/box2d.b2Dot_V2_V2(M,M);if(!(0<=E&&1>=E))continue}else{I=E*E-4*I*S;if(0>I)continue;var U=box2d.b2Sqrt(I),I=(-E-U)/(2*S),S=(-E+U)/(2*S);I>S&&(E=I,I=S,S=E);box2d.b2AddMul_V2_S_V2(F,I,B,M);box2d.b2AddMul_V2_S_V2(H,I,T,N);E=box2d.b2Dot_V2_V2(M,N)/box2d.b2Dot_V2_V2(M,
M);if(!(0<=I&&I<z&&0<=E&&1>=E)){I=S;if(!(0<=I&&I<z))continue;box2d.b2AddMul_V2_S_V2(F,I,B,M);box2d.b2AddMul_V2_S_V2(H,I,T,N);E=box2d.b2Dot_V2_V2(M,N)/box2d.b2Dot_V2_V2(M,M);if(!(0<=E&&1>=E))continue}}H=t;H.x=C.x+E*B.x-O.x;H.y=C.y+E*B.y-O.y;O=box2d.b2Mul_S_V2(A,H,u);this.IsRigidGroup(R)?(A=R.GetMass(),H=R.GetInertia(),0<A&&R.m_linearVelocity.SelfMulAdd(1/A,O),0<H&&(R.m_angularVelocity+=box2d.b2Cross_V2_V2(box2d.b2Sub_V2_V2(P,R.GetCenter(),box2d.b2Vec2.s_t0),O)/H)):y[K].SelfAdd(H);this.ParticleApplyForce(K,
O.SelfMul(-a.inv_dt))}}}}};box2d.b2ParticleSystem.prototype.SolveBarrier.s_aabb=new box2d.b2AABB;box2d.b2ParticleSystem.prototype.SolveBarrier.s_va=new box2d.b2Vec2;box2d.b2ParticleSystem.prototype.SolveBarrier.s_vb=new box2d.b2Vec2;box2d.b2ParticleSystem.prototype.SolveBarrier.s_pba=new box2d.b2Vec2;box2d.b2ParticleSystem.prototype.SolveBarrier.s_vba=new box2d.b2Vec2;box2d.b2ParticleSystem.prototype.SolveBarrier.s_vc=new box2d.b2Vec2;box2d.b2ParticleSystem.prototype.SolveBarrier.s_pca=new box2d.b2Vec2;
box2d.b2ParticleSystem.prototype.SolveBarrier.s_vca=new box2d.b2Vec2;box2d.b2ParticleSystem.prototype.SolveBarrier.s_qba=new box2d.b2Vec2;box2d.b2ParticleSystem.prototype.SolveBarrier.s_qca=new box2d.b2Vec2;box2d.b2ParticleSystem.prototype.SolveBarrier.s_dv=new box2d.b2Vec2;box2d.b2ParticleSystem.prototype.SolveBarrier.s_f=new box2d.b2Vec2;
box2d.b2ParticleSystem.prototype.SolveStaticPressure=function(a){this.m_staticPressureBuffer=this.RequestBuffer(this.m_staticPressureBuffer);var b=this.GetCriticalPressure(a);a=this.m_def.staticPressureStrength*b;for(var b=box2d.b2_maxParticlePressure*b,d=this.m_def.staticPressureRelaxation,e=0;e<this.m_def.staticPressureIterations;e++){for(var f=0;f<this.m_count;f++)this.m_accumulationBuffer[f]=0;for(f=0;f<this.m_contactBuffer.count;f++){var g=this.m_contactBuffer.data[f];if(g.flags&box2d.b2ParticleFlag.b2_staticPressureParticle){var k=
g.indexA,m=g.indexB,g=g.weight;this.m_accumulationBuffer[k]+=g*this.m_staticPressureBuffer[m];this.m_accumulationBuffer[m]+=g*this.m_staticPressureBuffer[k]}}for(f=0;f<this.m_count;f++)g=this.m_weightBuffer[f],this.m_staticPressureBuffer[f]=this.m_flagsBuffer.data[f]&box2d.b2ParticleFlag.b2_staticPressureParticle?box2d.b2Clamp((this.m_accumulationBuffer[f]+a*(g-box2d.b2_minParticleWeight))/(g+d),0,b):0}};
box2d.b2ParticleSystem.prototype.ComputeWeight=function(){for(var a=0;a<this.m_count;a++)this.m_weightBuffer[a]=0;for(a=0;a<this.m_bodyContactBuffer.count;a++){var b=this.m_bodyContactBuffer.data[a],d=b.index,b=b.weight;this.m_weightBuffer[d]+=b}for(a=0;a<this.m_contactBuffer.count;a++){var b=this.m_contactBuffer.data[a],d=b.indexA,e=b.indexB,b=b.weight;this.m_weightBuffer[d]+=b;this.m_weightBuffer[e]+=b}};
box2d.b2ParticleSystem.prototype.SolvePressure=function(a){for(var b=box2d.b2ParticleSystem.prototype.SolvePressure.s_f,d=this.m_positionBuffer.data,e=this.m_velocityBuffer.data,f=this.GetCriticalPressure(a),g=this.m_def.pressureStrength*f,k=box2d.b2_maxParticlePressure*f,m=0;m<this.m_count;m++){var f=this.m_weightBuffer[m],n=g*box2d.b2Max(0,f-box2d.b2_minParticleWeight);this.m_accumulationBuffer[m]=box2d.b2Min(n,k)}if(this.m_allParticleFlags&box2d.b2ParticleSystem.k_noPressureFlags)for(m=0;m<this.m_count;m++)this.m_flagsBuffer.data[m]&
box2d.b2ParticleSystem.k_noPressureFlags&&(this.m_accumulationBuffer[m]=0);if(this.m_allParticleFlags&box2d.b2ParticleFlag.b2_staticPressureParticle)for(box2d.b2Assert(null!==this.m_staticPressureBuffer),m=0;m<this.m_count;m++)this.m_flagsBuffer.data[m]&box2d.b2ParticleFlag.b2_staticPressureParticle&&(this.m_accumulationBuffer[m]+=this.m_staticPressureBuffer[m]);a=a.dt/(this.m_def.density*this.m_particleDiameter);k=this.GetParticleInvMass();for(m=0;m<this.m_bodyContactBuffer.count;m++){var n=this.m_bodyContactBuffer.data[m],
q=n.index,s=n.body,f=n.weight,t=n.mass,u=n.normal,v=d[q],n=this.m_accumulationBuffer[q]+g*f,f=box2d.b2Mul_S_V2(a*f*t*n,u,b);e[q].SelfMulSub(k,f);s.ApplyLinearImpulse(f,v,!0)}for(m=0;m<this.m_contactBuffer.count;m++)n=this.m_contactBuffer.data[m],q=n.indexA,s=n.indexB,f=n.weight,u=n.normal,n=this.m_accumulationBuffer[q]+this.m_accumulationBuffer[s],f=box2d.b2Mul_S_V2(a*f*n,u,b),e[q].SelfSub(f),e[s].SelfAdd(f)};box2d.b2ParticleSystem.prototype.SolvePressure.s_f=new box2d.b2Vec2;
box2d.b2ParticleSystem.prototype.SolveDamping=function(a){var b=box2d.b2ParticleSystem.prototype.SolveDamping.s_v,d=box2d.b2ParticleSystem.prototype.SolveDamping.s_f,e=this.m_positionBuffer.data,f=this.m_velocityBuffer.data,g=this.m_def.dampingStrength;a=1/this.GetCriticalVelocity(a);for(var k=this.GetParticleInvMass(),m=0;m<this.m_bodyContactBuffer.count;m++){var n=this.m_bodyContactBuffer.data[m],q=n.index,s=n.body,t=n.weight,u=n.mass,v=n.normal,n=e[q],y=box2d.b2Sub_V2_V2(s.GetLinearVelocityFromWorldPoint(n,
box2d.b2Vec2.s_t0),f[q],b),y=box2d.b2Dot_V2_V2(y,v);0>y&&(t=box2d.b2Max(g*t,box2d.b2Min(-a*y,.5)),u=box2d.b2Mul_S_V2(t*u*y,v,d),f[q].SelfMulAdd(k,u),s.ApplyLinearImpulse(u.SelfNeg(),n,!0))}for(m=0;m<this.m_contactBuffer.count;m++)n=this.m_contactBuffer.data[m],q=n.indexA,s=n.indexB,t=n.weight,v=n.normal,y=box2d.b2Sub_V2_V2(f[s],f[q],b),y=box2d.b2Dot_V2_V2(y,v),0>y&&(t=box2d.b2Max(g*t,box2d.b2Min(-a*y,.5)),u=box2d.b2Mul_S_V2(t*y,v,d),f[q].SelfAdd(u),f[s].SelfSub(u))};
box2d.b2ParticleSystem.prototype.SolveDamping.s_v=new box2d.b2Vec2;box2d.b2ParticleSystem.prototype.SolveDamping.s_f=new box2d.b2Vec2;
box2d.b2ParticleSystem.prototype.SolveRigidDamping=function(){for(var a=box2d.b2ParticleSystem.prototype.SolveRigidDamping.s_t0,b=box2d.b2ParticleSystem.prototype.SolveRigidDamping.s_t1,d=box2d.b2ParticleSystem.prototype.SolveRigidDamping.s_p,e=box2d.b2ParticleSystem.prototype.SolveRigidDamping.s_v,f=[0],g=[0],k=[0],m=[0],n=[0],q=[0],s=this.m_positionBuffer.data,t=this.m_def.dampingStrength,u=0;u<this.m_bodyContactBuffer.count;u++){var v=this.m_bodyContactBuffer.data[u],y=v.index,z=this.m_groupBuffer[y];
if(this.IsRigidGroup(z)){var A=v.body,r=v.normal,D=v.weight,v=s[y],C=box2d.b2Sub_V2_V2(A.GetLinearVelocityFromWorldPoint(v,a),z.GetLinearVelocityFromWorldPoint(v,b),e),C=box2d.b2Dot_V2_V2(C,r);0>C&&(this.InitDampingParameterWithRigidGroupOrParticle(f,g,k,!0,z,y,v,r),this.InitDampingParameter(m,n,q,A.GetMass(),A.GetInertia()-A.GetMass()*A.GetLocalCenter().LengthSquared(),A.GetWorldCenter(),v,r),D=t*box2d.b2Min(D,1)*this.ComputeDampingImpulse(f[0],g[0],k[0],m[0],n[0],q[0],C),this.ApplyDamping(f[0],
g[0],k[0],!0,z,y,D,r),A.ApplyLinearImpulse(box2d.b2Mul_S_V2(-D,r,box2d.b2Vec2.s_t0),v,!0))}}for(u=0;u<this.m_contactBuffer.count;u++){var v=this.m_contactBuffer.data[u],y=v.indexA,A=v.indexB,r=v.normal,D=v.weight,z=this.m_groupBuffer[y],B=this.m_groupBuffer[A],F=this.IsRigidGroup(z),J=this.IsRigidGroup(B);z!==B&&(F||J)&&(v=box2d.b2Mid_V2_V2(s[y],s[A],d),C=box2d.b2Sub_V2_V2(this.GetLinearVelocity(B,A,v,a),this.GetLinearVelocity(z,y,v,b),e),C=box2d.b2Dot_V2_V2(C,r),0>C&&(this.InitDampingParameterWithRigidGroupOrParticle(f,
g,k,F,z,y,v,r),this.InitDampingParameterWithRigidGroupOrParticle(m,n,q,J,B,A,v,r),D=t*D*this.ComputeDampingImpulse(f[0],g[0],k[0],m[0],n[0],q[0],C),this.ApplyDamping(f[0],g[0],k[0],F,z,y,D,r),this.ApplyDamping(m[0],n[0],q[0],J,B,A,-D,r)))}};box2d.b2ParticleSystem.prototype.SolveRigidDamping.s_t0=new box2d.b2Vec2;box2d.b2ParticleSystem.prototype.SolveRigidDamping.s_t1=new box2d.b2Vec2;box2d.b2ParticleSystem.prototype.SolveRigidDamping.s_p=new box2d.b2Vec2;
box2d.b2ParticleSystem.prototype.SolveRigidDamping.s_v=new box2d.b2Vec2;
box2d.b2ParticleSystem.prototype.SolveExtraDamping=function(){for(var a=box2d.b2ParticleSystem.prototype.SolveExtraDamping.s_v,b=box2d.b2ParticleSystem.prototype.SolveExtraDamping.s_f,d=this.m_velocityBuffer.data,e=this.m_positionBuffer.data,f=this.GetParticleInvMass(),g=0;g<this.m_bodyContactBuffer.count;g++){var k=this.m_bodyContactBuffer.data[g],m=k.index;if(this.m_flagsBuffer.data[m]&box2d.b2ParticleSystem.k_extraDampingFlags){var n=k.body,q=k.mass,s=k.normal,k=e[m],t=box2d.b2Sub_V2_V2(n.GetLinearVelocityFromWorldPoint(k,
box2d.b2Vec2.s_t0),d[m],a),t=box2d.b2Dot_V2_V2(t,s);0>t&&(q=box2d.b2Mul_S_V2(.5*q*t,s,b),d[m].SelfMulAdd(f,q),n.ApplyLinearImpulse(q.SelfNeg(),k,!0))}}};box2d.b2ParticleSystem.prototype.SolveExtraDamping.s_v=new box2d.b2Vec2;box2d.b2ParticleSystem.prototype.SolveExtraDamping.s_f=new box2d.b2Vec2;box2d.b2ParticleSystem.prototype.SolveWall=function(){for(var a=this.m_velocityBuffer.data,b=0;b<this.m_count;b++)this.m_flagsBuffer.data[b]&box2d.b2ParticleFlag.b2_wallParticle&&a[b].SetZero()};
box2d.b2ParticleSystem.prototype.SolveRigid=function(a){for(var b=box2d.b2ParticleSystem.prototype.SolveRigid.s_position,d=box2d.b2ParticleSystem.prototype.SolveRigid.s_rotation,e=box2d.b2ParticleSystem.prototype.SolveRigid.s_transform,f=box2d.b2ParticleSystem.prototype.SolveRigid.s_velocityTransform,g=this.m_positionBuffer.data,k=this.m_velocityBuffer.data,m=this.m_groupList;m;m=m.GetNext())if(m.m_groupFlags&box2d.b2ParticleGroupFlag.b2_rigidParticleGroup){m.UpdateStatistics();var n=d;n.SetAngle(a.dt*
m.m_angularVelocity);var q=box2d.b2Add_V2_V2(m.m_center,box2d.b2Sub_V2_V2(box2d.b2Mul_S_V2(a.dt,m.m_linearVelocity,box2d.b2Vec2.s_t0),box2d.b2Mul_R_V2(n,m.m_center,box2d.b2Vec2.s_t1),box2d.b2Vec2.s_t0),b),s=e;s.SetPositionRotation(q,n);box2d.b2Mul_X_X(s,m.m_transform,m.m_transform);n=f;n.p.x=a.inv_dt*s.p.x;n.p.y=a.inv_dt*s.p.y;n.q.s=a.inv_dt*s.q.s;n.q.c=a.inv_dt*(s.q.c-1);for(s=m.m_firstIndex;s<m.m_lastIndex;s++)box2d.b2Mul_X_V2(n,g[s],k[s])}};
box2d.b2ParticleSystem.prototype.SolveRigid.s_position=new box2d.b2Vec2;box2d.b2ParticleSystem.prototype.SolveRigid.s_rotation=new box2d.b2Rot;box2d.b2ParticleSystem.prototype.SolveRigid.s_transform=new box2d.b2Transform;box2d.b2ParticleSystem.prototype.SolveRigid.s_velocityTransform=new box2d.b2Transform;
box2d.b2ParticleSystem.prototype.SolveElastic=function(a){for(var b=box2d.b2ParticleSystem.prototype.SolveElastic.s_pa,d=box2d.b2ParticleSystem.prototype.SolveElastic.s_pb,e=box2d.b2ParticleSystem.prototype.SolveElastic.s_pc,f=box2d.b2ParticleSystem.prototype.SolveElastic.s_r,g=box2d.b2ParticleSystem.prototype.SolveElastic.s_t0,k=this.m_positionBuffer.data,m=this.m_velocityBuffer.data,n=a.inv_dt*this.m_def.elasticStrength,q=0;q<this.m_triadBuffer.count;q++){var s=this.m_triadBuffer.data[q];if(s.flags&
box2d.b2ParticleFlag.b2_elasticParticle){var t=s.indexA,u=s.indexB,v=s.indexC,y=s.pa,z=s.pb,A=s.pc,r=b.Copy(k[t]),D=d.Copy(k[u]),C=e.Copy(k[v]),t=m[t],u=m[u],v=m[v];r.SelfMulAdd(a.dt,t);D.SelfMulAdd(a.dt,u);C.SelfMulAdd(a.dt,v);var B=(r.x+D.x+C.x)/3,F=(r.y+D.y+C.y)/3;r.x-=B;r.y-=F;D.x-=B;D.y-=F;C.x-=B;C.y-=F;B=f;B.s=box2d.b2Cross_V2_V2(y,r)+box2d.b2Cross_V2_V2(z,D)+box2d.b2Cross_V2_V2(A,C);B.c=box2d.b2Dot_V2_V2(y,r)+box2d.b2Dot_V2_V2(z,D)+box2d.b2Dot_V2_V2(A,C);F=box2d.b2InvSqrt(B.s*B.s+B.c*B.c);
isFinite(F)||(F=1.9817753699999998E19);B.s*=F;B.c*=F;B.angle=Math.atan2(B.s,B.c);s=n*s.strength;box2d.b2Mul_R_V2(B,y,g);box2d.b2Sub_V2_V2(g,r,g);box2d.b2Mul_S_V2(s,g,g);t.SelfAdd(g);box2d.b2Mul_R_V2(B,z,g);box2d.b2Sub_V2_V2(g,D,g);box2d.b2Mul_S_V2(s,g,g);u.SelfAdd(g);box2d.b2Mul_R_V2(B,A,g);box2d.b2Sub_V2_V2(g,C,g);box2d.b2Mul_S_V2(s,g,g);v.SelfAdd(g)}}};box2d.b2ParticleSystem.prototype.SolveElastic.s_pa=new box2d.b2Vec2;box2d.b2ParticleSystem.prototype.SolveElastic.s_pb=new box2d.b2Vec2;
box2d.b2ParticleSystem.prototype.SolveElastic.s_pc=new box2d.b2Vec2;box2d.b2ParticleSystem.prototype.SolveElastic.s_r=new box2d.b2Rot;box2d.b2ParticleSystem.prototype.SolveElastic.s_t0=new box2d.b2Vec2;
box2d.b2ParticleSystem.prototype.SolveSpring=function(a){for(var b=box2d.b2ParticleSystem.prototype.SolveSpring.s_pa,d=box2d.b2ParticleSystem.prototype.SolveSpring.s_pb,e=box2d.b2ParticleSystem.prototype.SolveSpring.s_d,f=box2d.b2ParticleSystem.prototype.SolveSpring.s_f,g=this.m_positionBuffer.data,k=this.m_velocityBuffer.data,m=a.inv_dt*this.m_def.springStrength,n=0;n<this.m_pairBuffer.count;n++){var q=this.m_pairBuffer.data[n];if(q.flags&box2d.b2ParticleFlag.b2_springParticle){var s=q.indexA,t=
q.indexB,u=b.Copy(g[s]),v=d.Copy(g[t]),s=k[s],t=k[t];u.SelfMulAdd(a.dt,s);v.SelfMulAdd(a.dt,t);var u=box2d.b2Sub_V2_V2(v,u,e),v=q.distance,y=u.Length(),q=box2d.b2Mul_S_V2(m*q.strength*(v-y)/y,u,f);s.SelfSub(q);t.SelfAdd(q)}}};box2d.b2ParticleSystem.prototype.SolveSpring.s_pa=new box2d.b2Vec2;box2d.b2ParticleSystem.prototype.SolveSpring.s_pb=new box2d.b2Vec2;box2d.b2ParticleSystem.prototype.SolveSpring.s_d=new box2d.b2Vec2;box2d.b2ParticleSystem.prototype.SolveSpring.s_f=new box2d.b2Vec2;
box2d.b2ParticleSystem.prototype.SolveTensile=function(a){var b=box2d.b2ParticleSystem.prototype.SolveTensile.s_weightedNormal,d=box2d.b2ParticleSystem.prototype.SolveTensile.s_s,e=box2d.b2ParticleSystem.prototype.SolveTensile.s_f,f=this.m_velocityBuffer.data;box2d.b2Assert(null!==this.m_accumulation2Buffer);for(var g=0;g<this.m_count;g++)this.m_accumulation2Buffer[g]=box2d.b2Vec2_zero.Clone(),this.m_accumulation2Buffer[g].SetZero();for(g=0;g<this.m_contactBuffer.count;g++){var k=this.m_contactBuffer.data[g];
if(k.flags&box2d.b2ParticleFlag.b2_tensileParticle){var m=k.indexA,n=k.indexB,q=k.weight,k=k.normal,q=box2d.b2Mul_S_V2((1-q)*q,k,b);this.m_accumulation2Buffer[m].SelfSub(q);this.m_accumulation2Buffer[n].SelfAdd(q)}}g=this.GetCriticalVelocity(a);a=this.m_def.surfaceTensionPressureStrength*g;for(var b=this.m_def.surfaceTensionNormalStrength*g,s=box2d.b2_maxParticleForce*g,g=0;g<this.m_contactBuffer.count;g++)if(k=this.m_contactBuffer.data[g],k.flags&box2d.b2ParticleFlag.b2_tensileParticle){var m=k.indexA,
n=k.indexB,q=k.weight,k=k.normal,t=this.m_weightBuffer[m]+this.m_weightBuffer[n],u=box2d.b2Sub_V2_V2(this.m_accumulation2Buffer[n],this.m_accumulation2Buffer[m],d),q=box2d.b2Min(a*(t-2)+b*box2d.b2Dot_V2_V2(u,k),s)*q,q=box2d.b2Mul_S_V2(q,k,e);f[m].SelfSub(q);f[n].SelfAdd(q)}};box2d.b2ParticleSystem.prototype.SolveTensile.s_weightedNormal=new box2d.b2Vec2;box2d.b2ParticleSystem.prototype.SolveTensile.s_s=new box2d.b2Vec2;box2d.b2ParticleSystem.prototype.SolveTensile.s_f=new box2d.b2Vec2;
box2d.b2ParticleSystem.prototype.SolveViscous=function(){for(var a=box2d.b2ParticleSystem.prototype.SolveViscous.s_v,b=box2d.b2ParticleSystem.prototype.SolveViscous.s_f,d=this.m_positionBuffer.data,e=this.m_velocityBuffer.data,f=this.m_def.viscousStrength,g=this.GetParticleInvMass(),k=0;k<this.m_bodyContactBuffer.count;k++){var m=this.m_bodyContactBuffer.data[k],n=m.index;if(this.m_flagsBuffer.data[n]&box2d.b2ParticleFlag.b2_viscousParticle){var q=m.body,s=m.weight,t=m.mass,m=d[n],u=box2d.b2Sub_V2_V2(q.GetLinearVelocityFromWorldPoint(m,
box2d.b2Vec2.s_t0),e[n],a),s=box2d.b2Mul_S_V2(f*t*s,u,b);e[n].SelfMulAdd(g,s);q.ApplyLinearImpulse(s.SelfNeg(),m,!0)}}for(k=0;k<this.m_contactBuffer.count;k++)m=this.m_contactBuffer.data[k],m.flags&box2d.b2ParticleFlag.b2_viscousParticle&&(n=m.indexA,q=m.indexB,s=m.weight,u=box2d.b2Sub_V2_V2(e[q],e[n],a),s=box2d.b2Mul_S_V2(f*s,u,b),e[n].SelfAdd(s),e[q].SelfSub(s))};box2d.b2ParticleSystem.prototype.SolveViscous.s_v=new box2d.b2Vec2;box2d.b2ParticleSystem.prototype.SolveViscous.s_f=new box2d.b2Vec2;
box2d.b2ParticleSystem.prototype.SolveRepulsive=function(a){var b=box2d.b2ParticleSystem.prototype.SolveRepulsive.s_f,d=this.m_velocityBuffer.data;a=this.m_def.repulsiveStrength*this.GetCriticalVelocity(a);for(var e=0;e<this.m_contactBuffer.count;e++){var f=this.m_contactBuffer.data[e];if(f.flags&box2d.b2ParticleFlag.b2_repulsiveParticle){var g=f.indexA,k=f.indexB;this.m_groupBuffer[g]!==this.m_groupBuffer[k]&&(f=box2d.b2Mul_S_V2(a*f.weight,f.normal,b),d[g].SelfSub(f),d[k].SelfAdd(f))}}};
box2d.b2ParticleSystem.prototype.SolveRepulsive.s_f=new box2d.b2Vec2;
box2d.b2ParticleSystem.prototype.SolvePowder=function(a){var b=box2d.b2ParticleSystem.prototype.SolvePowder.s_f,d=this.m_positionBuffer.data,e=this.m_velocityBuffer.data;a=this.m_def.powderStrength*this.GetCriticalVelocity(a);for(var f=1-box2d.b2_particleStride,g=this.GetParticleInvMass(),k=0;k<this.m_bodyContactBuffer.count;k++){var m=this.m_bodyContactBuffer.data[k],n=m.index;if(this.m_flagsBuffer.data[n]&box2d.b2ParticleFlag.b2_powderParticle){var q=m.weight;if(q>f){var s=m.body,t=d[n],u=m.normal,
m=box2d.b2Mul_S_V2(a*m.mass*(q-f),u,b);e[n].SelfMulSub(g,m);s.ApplyLinearImpulse(m,t,!0)}}}for(k=0;k<this.m_contactBuffer.count;k++)m=this.m_contactBuffer.data[k],m.flags&box2d.b2ParticleFlag.b2_powderParticle&&(q=m.weight,q>f&&(n=m.indexA,s=m.indexB,u=m.normal,m=box2d.b2Mul_S_V2(a*(q-f),u,b),e[n].SelfSub(m),e[s].SelfAdd(m)))};box2d.b2ParticleSystem.prototype.SolvePowder.s_f=new box2d.b2Vec2;
box2d.b2ParticleSystem.prototype.SolveSolid=function(a){var b=box2d.b2ParticleSystem.prototype.SolveSolid.s_f,d=this.m_velocityBuffer.data;this.m_depthBuffer=this.RequestBuffer(this.m_depthBuffer);a=a.inv_dt*this.m_def.ejectionStrength;for(var e=0;e<this.m_contactBuffer.count;e++){var f=this.m_contactBuffer.data[e],g=f.indexA,k=f.indexB;this.m_groupBuffer[g]!==this.m_groupBuffer[k]&&(f=box2d.b2Mul_S_V2(a*(this.m_depthBuffer[g]+this.m_depthBuffer[k])*f.weight,f.normal,b),d[g].SelfSub(f),d[k].SelfAdd(f))}};
box2d.b2ParticleSystem.prototype.SolveSolid.s_f=new box2d.b2Vec2;box2d.b2ParticleSystem.prototype.SolveForce=function(a){var b=this.m_velocityBuffer.data;a=a.dt*this.GetParticleInvMass();for(var d=0;d<this.m_count;d++)b[d].SelfMulAdd(a,this.m_forceBuffer[d]);this.m_hasForce=!1};
box2d.b2ParticleSystem.prototype.SolveColorMixing=function(){box2d.b2Assert(null!==this.m_colorBuffer.data);var a=Math.floor(128*this.m_def.colorMixingStrength);if(a)for(var b=0;b<this.m_contactBuffer.count;b++){var d=this.m_contactBuffer.data[b],e=d.indexA,d=d.indexB;this.m_flagsBuffer.data[e]&this.m_flagsBuffer.data[d]&box2d.b2ParticleFlag.b2_colorMixingParticle&&box2d.b2ParticleColor.MixColors(this.m_colorBuffer.data[e],this.m_colorBuffer.data[d],a)}};
box2d.b2ParticleSystem.prototype.SolveZombie=function(){for(var a=0,b=[],d=0;d<this.m_count;d++)b[d]=box2d.b2_invalidParticleIndex;box2d.b2Assert(b.length===this.m_count);for(var e=0,d=0;d<this.m_count;d++){var f=this.m_flagsBuffer.data[d];if(f&box2d.b2ParticleFlag.b2_zombieParticle){var g=this.m_world.m_destructionListener;f&box2d.b2ParticleFlag.b2_destructionListenerParticle&&g&&g.SayGoodbyeParticle(this,d);this.m_handleIndexBuffer.data&&(g=this.m_handleIndexBuffer.data[d])&&(g.SetIndex(box2d.b2_invalidParticleIndex),
this.m_handleIndexBuffer.data[d]=null);b[d]=box2d.b2_invalidParticleIndex}else b[d]=a,d!==a&&(this.m_handleIndexBuffer.data&&((g=this.m_handleIndexBuffer.data[d])&&g.SetIndex(a),this.m_handleIndexBuffer.data[a]=g),this.m_flagsBuffer.data[a]=this.m_flagsBuffer.data[d],this.m_lastBodyContactStepBuffer.data&&(this.m_lastBodyContactStepBuffer.data[a]=this.m_lastBodyContactStepBuffer.data[d]),this.m_bodyContactCountBuffer.data&&(this.m_bodyContactCountBuffer.data[a]=this.m_bodyContactCountBuffer.data[d]),
this.m_consecutiveContactStepsBuffer.data&&(this.m_consecutiveContactStepsBuffer.data[a]=this.m_consecutiveContactStepsBuffer.data[d]),this.m_positionBuffer.data[a].Copy(this.m_positionBuffer.data[d]),this.m_velocityBuffer.data[a].Copy(this.m_velocityBuffer.data[d]),this.m_groupBuffer[a]=this.m_groupBuffer[d],this.m_hasForce&&this.m_forceBuffer[a].Copy(this.m_forceBuffer[d]),this.m_staticPressureBuffer&&(this.m_staticPressureBuffer[a]=this.m_staticPressureBuffer[d]),this.m_depthBuffer&&(this.m_depthBuffer[a]=
this.m_depthBuffer[d]),this.m_colorBuffer.data&&this.m_colorBuffer.data[a].Copy(this.m_colorBuffer.data[d]),this.m_userDataBuffer.data&&(this.m_userDataBuffer.data[a]=this.m_userDataBuffer.data[d]),this.m_expirationTimeBuffer.data&&(this.m_expirationTimeBuffer.data[a]=this.m_expirationTimeBuffer.data[d])),a++,e|=f}for(d=0;d<this.m_proxyBuffer.count;d++)f=this.m_proxyBuffer.data[d],f.index=b[f.index];this.m_proxyBuffer.RemoveIf(function(a){return 0>a.index});for(d=0;d<this.m_contactBuffer.count;d++)f=
this.m_contactBuffer.data[d],f.indexA=b[f.indexA],f.indexB=b[f.indexB];this.m_contactBuffer.RemoveIf(function(a){return 0>a.indexA||0>a.indexB});for(d=0;d<this.m_bodyContactBuffer.count;d++)f=this.m_bodyContactBuffer.data[d],f.index=b[f.index];this.m_bodyContactBuffer.RemoveIf(function(a){return 0>a.index});for(d=0;d<this.m_pairBuffer.count;d++)f=this.m_pairBuffer.data[d],f.indexA=b[f.indexA],f.indexB=b[f.indexB];this.m_pairBuffer.RemoveIf(function(a){return 0>a.indexA||0>a.indexB});for(d=0;d<this.m_triadBuffer.count;d++)f=
this.m_triadBuffer.data[d],f.indexA=b[f.indexA],f.indexB=b[f.indexB],f.indexC=b[f.indexC];this.m_triadBuffer.RemoveIf(function(a){return 0>a.indexA||0>a.indexB||0>a.indexC});if(this.m_indexByExpirationTimeBuffer.data)for(f=d=0;f<this.m_count;f++)g=b[this.m_indexByExpirationTimeBuffer.data[f]],g!==box2d.b2_invalidParticleIndex&&(this.m_indexByExpirationTimeBuffer.data[d++]=g);for(f=this.m_groupList;f;f=f.GetNext()){for(var g=a,k=0,m=!1,d=f.m_firstIndex;d<f.m_lastIndex;d++){var n=b[d];0<=n?(g=box2d.b2Min(g,
n),k=box2d.b2Max(k,n+1)):m=!0}g<k?(f.m_firstIndex=g,f.m_lastIndex=k,m&&f.m_groupFlags&box2d.b2ParticleGroupFlag.b2_solidParticleGroup&&this.SetGroupFlags(f,f.m_groupFlags|box2d.b2ParticleGroupFlag.b2_particleGroupNeedsUpdateDepth)):(f.m_firstIndex=0,f.m_lastIndex=0,f.m_groupFlags&box2d.b2ParticleGroupFlag.b2_particleGroupCanBeEmpty||this.SetGroupFlags(f,f.m_groupFlags|box2d.b2ParticleGroupFlag.b2_particleGroupWillBeDestroyed))}this.m_count=a;this.m_allParticleFlags=e;this.m_needsUpdateAllParticleFlags=
!1;for(f=this.m_groupList;f;)a=f.GetNext(),f.m_groupFlags&box2d.b2ParticleGroupFlag.b2_particleGroupWillBeDestroyed&&this.DestroyParticleGroup(f),f=a};
box2d.b2ParticleSystem.prototype.SolveLifetimes=function(a){box2d.b2Assert(null!==this.m_expirationTimeBuffer.data);box2d.b2Assert(null!==this.m_indexByExpirationTimeBuffer.data);this.m_timeElapsed=this.LifetimeToExpirationTime(a.dt);a=this.GetQuantizedTimeElapsed();var b=this.m_expirationTimeBuffer.data,d=this.m_indexByExpirationTimeBuffer.data,e=this.GetParticleCount();this.m_expirationTimeBufferRequiresSorting&&(box2d.std_sort(d,0,e,function(a,d){var e=b[a],f=b[d],g=0>=e;return g===0>=f?e>f:g}),
this.m_expirationTimeBufferRequiresSorting=!1);for(--e;0<=e;--e){var f=d[e],g=b[f];if(a<g||0>=g)break;this.DestroyParticle(f)}};
box2d.b2ParticleSystem.prototype.RotateBuffer=function(a,b,d){function e(e){return e<a?e:e<b?e+d-b:e<d?e+a-b:e}if(a!==b&&b!==d){box2d.b2Assert(b>=a&&b<=d);box2d.std_rotate(this.m_flagsBuffer.data,a,b,d);this.m_lastBodyContactStepBuffer.data&&box2d.std_rotate(this.m_lastBodyContactStepBuffer.data,a,b,d);this.m_bodyContactCountBuffer.data&&box2d.std_rotate(this.m_bodyContactCountBuffer.data,a,b,d);this.m_consecutiveContactStepsBuffer.data&&box2d.std_rotate(this.m_consecutiveContactStepsBuffer.data,
a,b,d);box2d.std_rotate(this.m_positionBuffer.data,a,b,d);box2d.std_rotate(this.m_velocityBuffer.data,a,b,d);box2d.std_rotate(this.m_groupBuffer,a,b,d);this.m_hasForce&&box2d.std_rotate(this.m_forceBuffer,a,b,d);this.m_staticPressureBuffer&&box2d.std_rotate(this.m_staticPressureBuffer,a,b,d);this.m_depthBuffer&&box2d.std_rotate(this.m_depthBuffer,a,b,d);this.m_colorBuffer.data&&box2d.std_rotate(this.m_colorBuffer.data,a,b,d);this.m_userDataBuffer.data&&box2d.std_rotate(this.m_userDataBuffer.data,
a,b,d);if(this.m_handleIndexBuffer.data){box2d.std_rotate(this.m_handleIndexBuffer.data,a,b,d);for(var f=a;f<d;++f){var g=this.m_handleIndexBuffer.data[f];g&&g.SetIndex(e(g.GetIndex()))}}if(this.m_expirationTimeBuffer.data){box2d.std_rotate(this.m_expirationTimeBuffer.data,a,b,d);for(var g=this.GetParticleCount(),k=this.m_indexByExpirationTimeBuffer.data,f=0;f<g;++f)k[f]=e(k[f])}for(f=0;f<this.m_proxyBuffer.count;f++)g=this.m_proxyBuffer.data[f],g.index=e(g.index);for(f=0;f<this.m_contactBuffer.count;f++)g=
this.m_contactBuffer.data[f],g.indexA=e(g.indexA),g.indexB=e(g.indexB);for(f=0;f<this.m_bodyContactBuffer.count;f++)g=this.m_bodyContactBuffer.data[f],g.index=e(g.index);for(f=0;f<this.m_pairBuffer.count;f++)g=this.m_pairBuffer.data[f],g.indexA=e(g.indexA),g.indexB=e(g.indexB);for(f=0;f<this.m_triadBuffer.count;f++)g=this.m_triadBuffer.data[f],g.indexA=e(g.indexA),g.indexB=e(g.indexB),g.indexC=e(g.indexC);for(f=this.m_groupList;f;f=f.GetNext())f.m_firstIndex=e(f.m_firstIndex),f.m_lastIndex=e(f.m_lastIndex-
1)+1}};box2d.b2ParticleSystem.prototype.GetCriticalVelocity=function(a){return this.m_particleDiameter*a.inv_dt};box2d.b2ParticleSystem.prototype.GetCriticalVelocitySquared=function(a){a=this.GetCriticalVelocity(a);return a*a};box2d.b2ParticleSystem.prototype.GetCriticalPressure=function(a){return this.m_def.density*this.GetCriticalVelocitySquared(a)};box2d.b2ParticleSystem.prototype.GetParticleStride=function(){return box2d.b2_particleStride*this.m_particleDiameter};
box2d.b2ParticleSystem.prototype.GetParticleMass=function(){var a=this.GetParticleStride();return this.m_def.density*a*a};box2d.b2ParticleSystem.prototype.GetParticleInvMass=function(){var a=1/box2d.b2_particleStride*this.m_inverseDiameter;return this.m_inverseDensity*a*a};box2d.b2ParticleSystem.prototype.GetFixtureContactFilter=function(){return this.m_allParticleFlags&box2d.b2ParticleFlag.b2_fixtureContactFilterParticle?this.m_world.m_contactManager.m_contactFilter:null};
box2d.b2ParticleSystem.prototype.GetParticleContactFilter=function(){return this.m_allParticleFlags&box2d.b2ParticleFlag.b2_particleContactFilterParticle?this.m_world.m_contactManager.m_contactFilter:null};box2d.b2ParticleSystem.prototype.GetFixtureContactListener=function(){return this.m_allParticleFlags&box2d.b2ParticleFlag.b2_fixtureContactListenerParticle?this.m_world.m_contactManager.m_contactListener:null};
box2d.b2ParticleSystem.prototype.GetParticleContactListener=function(){return this.m_allParticleFlags&box2d.b2ParticleFlag.b2_particleContactListenerParticle?this.m_world.m_contactManager.m_contactListener:null};box2d.b2ParticleSystem.prototype.SetUserOverridableBuffer=function(a,b,d){box2d.b2Assert(null!==b&&0<d||null===b&&0===d);a.data=b;a.userSuppliedCapacity=d};
box2d.b2ParticleSystem.prototype.SetGroupFlags=function(a,b){var d=a.m_groupFlags;(d^b)&box2d.b2ParticleGroupFlag.b2_solidParticleGroup&&(b|=box2d.b2ParticleGroupFlag.b2_particleGroupNeedsUpdateDepth);d&~b&&(this.m_needsUpdateAllGroupFlags=!0);~this.m_allGroupFlags&b&&(b&box2d.b2ParticleGroupFlag.b2_solidParticleGroup&&(this.m_depthBuffer=this.RequestBuffer(this.m_depthBuffer)),this.m_allGroupFlags|=b);a.m_groupFlags=b};
box2d.b2ParticleSystem.prototype.RemoveSpuriousBodyContacts=function(){box2d.std_sort(this.m_bodyContactBuffer.data,0,this.m_bodyContactBuffer.count,box2d.b2ParticleSystem.BodyContactCompare);var a=box2d.b2ParticleSystem.prototype.RemoveSpuriousBodyContacts.s_n,b=box2d.b2ParticleSystem.prototype.RemoveSpuriousBodyContacts.s_pos,d=box2d.b2ParticleSystem.prototype.RemoveSpuriousBodyContacts.s_normal,e=this,f=-1,g=0,k=0;this.m_bodyContactBuffer.count=box2d.std_remove_if(this.m_bodyContactBuffer.data,
function(m){m.index!==f&&(g=0,f=m.index);if(3<g++)return++k,!0;var n=a.Copy(m.normal);n.SelfMul(e.m_particleDiameter*(1-m.weight));n=box2d.b2Add_V2_V2(e.m_positionBuffer.data[m.index],n,b);if(!m.fixture.TestPoint(n)){for(var q=m.fixture.GetShape().GetChildCount(),s=0;s<q;s++)if(m.fixture.ComputeDistance(n,d,s)<box2d.b2_linearSlop)return!1;++k;return!0}return!1},this.m_bodyContactBuffer.count)};box2d.b2ParticleSystem.prototype.RemoveSpuriousBodyContacts.s_n=new box2d.b2Vec2;
box2d.b2ParticleSystem.prototype.RemoveSpuriousBodyContacts.s_pos=new box2d.b2Vec2;box2d.b2ParticleSystem.prototype.RemoveSpuriousBodyContacts.s_normal=new box2d.b2Vec2;box2d.b2ParticleSystem.BodyContactCompare=function(a,b){return a.index===b.index?a.weight>b.weight:a.index<b.index};
box2d.b2ParticleSystem.prototype.DetectStuckParticle=function(a){0>=this.m_stuckThreshold||(++this.m_bodyContactCountBuffer.data[a],2===this.m_bodyContactCountBuffer.data[a]&&(++this.m_consecutiveContactStepsBuffer.data[a],this.m_consecutiveContactStepsBuffer.data[a]>this.m_stuckThreshold&&(this.m_stuckParticleBuffer.data[this.m_stuckParticleBuffer.Append()]=a)),this.m_lastBodyContactStepBuffer.data[a]=this.m_timestamp)};
box2d.b2ParticleSystem.prototype.ValidateParticleIndex=function(a){return 0<=a&&a<this.GetParticleCount()&&a!==box2d.b2_invalidParticleIndex};box2d.b2ParticleSystem.prototype.GetQuantizedTimeElapsed=function(){return Math.floor(this.m_timeElapsed/4294967296)};box2d.b2ParticleSystem.prototype.LifetimeToExpirationTime=function(a){return this.m_timeElapsed+Math.floor(a/this.m_def.lifetimeGranularity*4294967296)};box2d.b2ParticleSystem.prototype.ForceCanBeApplied=function(a){return!(a&box2d.b2ParticleFlag.b2_wallParticle)};
box2d.b2ParticleSystem.prototype.PrepareForceBuffer=function(){if(!this.m_hasForce){for(var a=0;a<this.m_count;a++)this.m_forceBuffer[a].SetZero();this.m_hasForce=!0}};box2d.b2ParticleSystem.prototype.IsRigidGroup=function(a){return null!==a&&0!==(a.m_groupFlags&box2d.b2ParticleGroupFlag.b2_rigidParticleGroup)};box2d.b2ParticleSystem.prototype.GetLinearVelocity=function(a,b,d,e){return this.IsRigidGroup(a)?a.GetLinearVelocityFromWorldPoint(d,e):e.Copy(this.m_velocityBuffer.data[b])};
box2d.b2ParticleSystem.prototype.InitDampingParameter=function(a,b,d,e,f,g,k,m){a[0]=0<e?1/e:0;b[0]=0<f?1/f:0;d[0]=box2d.b2Cross_V2_V2(box2d.b2Sub_V2_V2(k,g,box2d.b2Vec2.s_t0),m)};box2d.b2ParticleSystem.prototype.InitDampingParameterWithRigidGroupOrParticle=function(a,b,d,e,f,g,k,m){e?this.InitDampingParameter(a,b,d,f.GetMass(),f.GetInertia(),f.GetCenter(),k,m):this.InitDampingParameter(a,b,d,this.m_flagsBuffer.data[g]&box2d.b2ParticleFlag.b2_wallParticle?0:this.GetParticleMass(),0,k,k,m)};
box2d.b2ParticleSystem.prototype.ComputeDampingImpulse=function(a,b,d,e,f,g,k){a=a+b*d*d+e+f*g*g;return 0<a?k/a:0};box2d.b2ParticleSystem.prototype.ApplyDamping=function(a,b,d,e,f,g,k,m){e?(f.m_linearVelocity.SelfMulAdd(k*a,m),f.m_angularVelocity+=k*d*b):this.m_velocityBuffer.data[g].SelfMulAdd(k*a,m)};box2d.b2StackQueue=function(a){this.m_buffer=box2d.b2MakeArray(a);this.m_end=a};box2d.b2StackQueue.prototype.m_buffer=null;box2d.b2StackQueue.prototype.m_front=0;
box2d.b2StackQueue.prototype.m_back=0;box2d.b2StackQueue.prototype.m_capacity=0;
box2d.b2StackQueue.prototype.Push=function(a){if(this.m_back>=this.m_capacity){for(var b=this.m_front;b<this.m_back;b++)this.m_buffer[b-this.m_front]=this.m_buffer[b];this.m_back-=this.m_front;this.m_front=0;this.m_back>=this.m_capacity&&(0<this.m_capacity?(this.m_buffer.concat(box2d.b2MakeArray(this.m_capacity)),this.m_capacity*=2):(this.m_buffer.concat(box2d.b2MakeArray(1)),this.m_capacity=1))}this.m_buffer[this.m_back]=a;this.m_back++};
box2d.b2StackQueue.prototype.Pop=function(){box2d.b2Assert(this.m_front<this.m_back);this.m_buffer[this.m_front]=null;this.m_front++};box2d.b2StackQueue.prototype.Empty=function(){box2d.b2Assert(this.m_front<=this.m_back);return this.m_front===this.m_back};box2d.b2StackQueue.prototype.Front=function(){return this.m_buffer[this.m_front]};box2d.b2VoronoiDiagram=function(a){this.m_generatorBuffer=box2d.b2MakeArray(a,function(a){return new box2d.b2VoronoiDiagram.Generator});this.m_generatorCapacity=a};
goog.exportSymbol("box2d.b2VoronoiDiagram",box2d.b2VoronoiDiagram);box2d.b2VoronoiDiagram.prototype.m_generatorBuffer=null;goog.exportProperty(box2d.b2VoronoiDiagram.prototype,"m_generatorBuffer",box2d.b2VoronoiDiagram.prototype.m_generatorBuffer);box2d.b2VoronoiDiagram.prototype.m_generatorCapacity=0;box2d.b2VoronoiDiagram.prototype.m_generatorCount=0;box2d.b2VoronoiDiagram.prototype.m_countX=0;box2d.b2VoronoiDiagram.prototype.m_countY=0;box2d.b2VoronoiDiagram.prototype.m_diagram=null;
box2d.b2VoronoiDiagram.Generator=function(){this.center=new box2d.b2Vec2};box2d.b2VoronoiDiagram.Generator.prototype.center=null;box2d.b2VoronoiDiagram.Generator.prototype.tag=0;box2d.b2VoronoiDiagram.b2VoronoiDiagramTask=function(a,b,d,e){this.m_x=a;this.m_y=b;this.m_i=d;this.m_generator=e};box2d.b2VoronoiDiagram.b2VoronoiDiagramTask.prototype.m_x=0;box2d.b2VoronoiDiagram.b2VoronoiDiagramTask.prototype.m_y=0;box2d.b2VoronoiDiagram.b2VoronoiDiagramTask.prototype.m_i=0;
box2d.b2VoronoiDiagram.b2VoronoiDiagramTask.prototype.m_generator=null;box2d.b2VoronoiDiagram.prototype.AddGenerator=function(a,b,d){box2d.b2Assert(this.m_generatorCount<this.m_generatorCapacity);var e=this.m_generatorBuffer[this.m_generatorCount++];e.center.Copy(a);e.tag=b;e.necessary=d};goog.exportProperty(box2d.b2VoronoiDiagram.prototype,"AddGenerator",box2d.b2VoronoiDiagram.prototype.AddGenerator);
box2d.b2VoronoiDiagram.prototype.Generate=function(a,b){box2d.b2Assert(null===this.m_diagram);for(var d=1/a,e=new box2d.b2Vec2(+box2d.b2_maxFloat,+box2d.b2_maxFloat),f=new box2d.b2Vec2(-box2d.b2_maxFloat,-box2d.b2_maxFloat),g=0,k=0;k<this.m_generatorCount;k++){var m=this.m_generatorBuffer[k];m.necessary&&(box2d.b2Min_V2_V2(e,m.center,e),box2d.b2Max_V2_V2(f,m.center,f),++g)}if(0===g)this.m_countY=this.m_countX=0;else{e.x-=b;e.y-=b;f.x+=b;f.y+=b;this.m_countX=1+Math.floor(d*(f.x-e.x));this.m_countY=
1+Math.floor(d*(f.y-e.y));this.m_diagram=box2d.b2MakeArray(this.m_countX*this.m_countY);f=new box2d.b2StackQueue(4*this.m_countX*this.m_countY);for(k=0;k<this.m_generatorCount;k++){m=this.m_generatorBuffer[k];m.center.SelfSub(e).SelfMul(d);var g=Math.floor(m.center.x),n=Math.floor(m.center.y);0<=g&&0<=n&&g<this.m_countX&&n<this.m_countY&&f.Push(new box2d.b2VoronoiDiagram.b2VoronoiDiagramTask(g,n,g+n*this.m_countX,m))}for(;!f.Empty();)k=f.Front(),g=k.m_x,n=k.m_y,d=k.m_i,m=k.m_generator,f.Pop(),this.m_diagram[d]||
(this.m_diagram[d]=m,0<g&&f.Push(new box2d.b2VoronoiDiagram.b2VoronoiDiagramTask(g-1,n,d-1,m)),0<n&&f.Push(new box2d.b2VoronoiDiagram.b2VoronoiDiagramTask(g,n-1,d-this.m_countX,m)),g<this.m_countX-1&&f.Push(new box2d.b2VoronoiDiagram.b2VoronoiDiagramTask(g+1,n,d+1,m)),n<this.m_countY-1&&f.Push(new box2d.b2VoronoiDiagram.b2VoronoiDiagramTask(g,n+1,d+this.m_countX,m)));for(n=0;n<this.m_countY;n++)for(g=0;g<this.m_countX-1;g++)d=g+n*this.m_countX,e=this.m_diagram[d],k=this.m_diagram[d+1],e!==k&&(f.Push(new box2d.b2VoronoiDiagram.b2VoronoiDiagramTask(g,
n,d,k)),f.Push(new box2d.b2VoronoiDiagram.b2VoronoiDiagramTask(g+1,n,d+1,e)));for(n=0;n<this.m_countY-1;n++)for(g=0;g<this.m_countX;g++)d=g+n*this.m_countX,e=this.m_diagram[d],k=this.m_diagram[d+this.m_countX],e!==k&&(f.Push(new box2d.b2VoronoiDiagram.b2VoronoiDiagramTask(g,n,d,k)),f.Push(new box2d.b2VoronoiDiagram.b2VoronoiDiagramTask(g,n+1,d+this.m_countX,e)));for(;!f.Empty();)if(k=f.Front(),g=k.m_x,n=k.m_y,d=k.m_i,k=k.m_generator,f.Pop(),e=this.m_diagram[d],e!==k){var m=e.center.x-g,e=e.center.y-
n,q=k.center.x-g,s=k.center.y-n;m*m+e*e>q*q+s*s&&(this.m_diagram[d]=k,0<g&&f.Push(new box2d.b2VoronoiDiagram.b2VoronoiDiagramTask(g-1,n,d-1,k)),0<n&&f.Push(new box2d.b2VoronoiDiagram.b2VoronoiDiagramTask(g,n-1,d-this.m_countX,k)),g<this.m_countX-1&&f.Push(new box2d.b2VoronoiDiagram.b2VoronoiDiagramTask(g+1,n,d+1,k)),n<this.m_countY-1&&f.Push(new box2d.b2VoronoiDiagram.b2VoronoiDiagramTask(g,n+1,d+this.m_countX,k)))}}};goog.exportProperty(box2d.b2VoronoiDiagram.prototype,"Generate",box2d.b2VoronoiDiagram.prototype.Generate);
box2d.b2VoronoiDiagram.prototype.GetNodes=function(a){for(var b=0;b<this.m_countY-1;b++)for(var d=0;d<this.m_countX-1;d++){var e=d+b*this.m_countX,f=this.m_diagram[e],g=this.m_diagram[e+1],k=this.m_diagram[e+this.m_countX],e=this.m_diagram[e+1+this.m_countX];g!==k&&(f!==g&&f!==k&&(f.necessary||g.necessary||k.necessary)&&a(f.tag,g.tag,k.tag),e!==g&&e!==k&&(f.necessary||g.necessary||k.necessary)&&a(g.tag,e.tag,k.tag))}};goog.exportProperty(box2d.b2VoronoiDiagram.prototype,"GetNodes",box2d.b2VoronoiDiagram.prototype.GetNodes);
box2d.b2RopeDef=function(){this.vertices=[];this.masses=[];this.gravity=new box2d.b2Vec2};goog.exportSymbol("box2d.b2RopeDef",box2d.b2RopeDef);box2d.b2RopeDef.prototype.vertices=null;box2d.b2RopeDef.prototype.count=0;box2d.b2RopeDef.prototype.masses=null;box2d.b2RopeDef.prototype.gravity=null;box2d.b2RopeDef.prototype.damping=.1;box2d.b2RopeDef.prototype.k2=.9;box2d.b2RopeDef.prototype.k3=.1;box2d.b2Rope=function(){this.m_gravity=new box2d.b2Vec2};goog.exportSymbol("box2d.b2Rope",box2d.b2Rope);
box2d.b2Rope.prototype.m_count=0;box2d.b2Rope.prototype.m_ps=null;box2d.b2Rope.prototype.m_p0s=null;box2d.b2Rope.prototype.m_vs=null;box2d.b2Rope.prototype.m_ims=null;box2d.b2Rope.prototype.m_Ls=null;box2d.b2Rope.prototype.m_as=null;box2d.b2Rope.prototype.m_gravity=null;box2d.b2Rope.prototype.m_damping=0;box2d.b2Rope.prototype.m_k2=1;box2d.b2Rope.prototype.m_k3=.1;box2d.b2Rope.prototype.GetVertexCount=function(){return this.m_count};goog.exportProperty(box2d.b2Rope.prototype,"GetVertexCount",box2d.b2Rope.prototype.GetVertexCount);
box2d.b2Rope.prototype.GetVertices=function(){return this.m_ps};goog.exportProperty(box2d.b2Rope.prototype,"GetVertices",box2d.b2Rope.prototype.GetVertices);
box2d.b2Rope.prototype.Initialize=function(a){box2d.ENABLE_ASSERTS&&box2d.b2Assert(3<=a.count);this.m_count=a.count;this.m_ps=box2d.b2Vec2.MakeArray(this.m_count);this.m_p0s=box2d.b2Vec2.MakeArray(this.m_count);this.m_vs=box2d.b2Vec2.MakeArray(this.m_count);this.m_ims=box2d.b2MakeNumberArray(this.m_count);for(var b=0;b<this.m_count;++b){this.m_ps[b].Copy(a.vertices[b]);this.m_p0s[b].Copy(a.vertices[b]);this.m_vs[b].SetZero();var d=a.masses[b];this.m_ims[b]=0<d?1/d:0}var e=this.m_count-1,d=this.m_count-
2;this.m_Ls=box2d.b2MakeNumberArray(e);this.m_as=box2d.b2MakeNumberArray(d);for(b=0;b<e;++b){var f=this.m_ps[b],g=this.m_ps[b+1];this.m_Ls[b]=box2d.b2Distance(f,g)}for(b=0;b<d;++b)f=this.m_ps[b],g=this.m_ps[b+1],e=this.m_ps[b+2],f=box2d.b2Sub_V2_V2(g,f,box2d.b2Vec2.s_t0),e=box2d.b2Sub_V2_V2(e,g,box2d.b2Vec2.s_t1),g=box2d.b2Cross_V2_V2(f,e),f=box2d.b2Dot_V2_V2(f,e),this.m_as[b]=box2d.b2Atan2(g,f);this.m_gravity.Copy(a.gravity);this.m_damping=a.damping;this.m_k2=a.k2;this.m_k3=a.k3};
goog.exportProperty(box2d.b2Rope.prototype,"Initialize",box2d.b2Rope.prototype.Initialize);
box2d.b2Rope.prototype.Step=function(a,b){if(0!==a){for(var d=Math.exp(-a*this.m_damping),e=0;e<this.m_count;++e)this.m_p0s[e].Copy(this.m_ps[e]),0<this.m_ims[e]&&this.m_vs[e].SelfMulAdd(a,this.m_gravity),this.m_vs[e].SelfMul(d),this.m_ps[e].SelfMulAdd(a,this.m_vs[e]);for(e=0;e<b;++e)this.SolveC2(),this.SolveC3(),this.SolveC2();d=1/a;for(e=0;e<this.m_count;++e)box2d.b2Mul_S_V2(d,box2d.b2Sub_V2_V2(this.m_ps[e],this.m_p0s[e],box2d.b2Vec2.s_t0),this.m_vs[e])}};
goog.exportProperty(box2d.b2Rope.prototype,"Step",box2d.b2Rope.prototype.Step);box2d.b2Rope.prototype.SolveC2=function(){for(var a=this.m_count-1,b=0;b<a;++b){var d=this.m_ps[b],e=this.m_ps[b+1],f=box2d.b2Sub_V2_V2(e,d,box2d.b2Rope.s_d),g=f.Normalize(),k=this.m_ims[b],m=this.m_ims[b+1];if(0!==k+m){var n=m/(k+m);d.SelfMulSub(k/(k+m)*this.m_k2*(this.m_Ls[b]-g),f);e.SelfMulAdd(this.m_k2*n*(this.m_Ls[b]-g),f)}}};goog.exportProperty(box2d.b2Rope.prototype,"SolveC2",box2d.b2Rope.prototype.SolveC2);
box2d.b2Rope.s_d=new box2d.b2Vec2;box2d.b2Rope.prototype.SetAngle=function(a){for(var b=this.m_count-2,d=0;d<b;++d)this.m_as[d]=a};goog.exportProperty(box2d.b2Rope.prototype,"SetAngle",box2d.b2Rope.prototype.SetAngle);
box2d.b2Rope.prototype.SolveC3=function(){for(var a=this.m_count-2,b=0;b<a;++b){var d=this.m_ps[b],e=this.m_ps[b+1],f=this.m_ps[b+2],g=this.m_ims[b],k=this.m_ims[b+1],m=this.m_ims[b+2],n=box2d.b2Sub_V2_V2(e,d,box2d.b2Rope.s_d1),q=box2d.b2Sub_V2_V2(f,e,box2d.b2Rope.s_d2),s=n.LengthSquared(),t=q.LengthSquared();if(0!==s*t){var u=box2d.b2Cross_V2_V2(n,q),v=box2d.b2Dot_V2_V2(n,q),u=box2d.b2Atan2(u,v),n=box2d.b2Mul_S_V2(-1/s,n.SelfSkew(),box2d.b2Rope.s_Jd1),s=box2d.b2Mul_S_V2(1/t,q.SelfSkew(),box2d.b2Rope.s_Jd2),
q=box2d.b2Rope.s_J1.Copy(n).SelfNeg(),t=box2d.b2Sub_V2_V2(n,s,box2d.b2Rope.s_J2),n=s,s=g*box2d.b2Dot_V2_V2(q,q)+k*box2d.b2Dot_V2_V2(t,t)+m*box2d.b2Dot_V2_V2(n,n);if(0!==s){s=1/s;for(v=u-this.m_as[b];v>box2d.b2_pi;)u-=2*box2d.b2_pi,v=u-this.m_as[b];for(;v<-box2d.b2_pi;)u+=2*box2d.b2_pi,v=u-this.m_as[b];u=-this.m_k3*s*v;d.SelfMulAdd(g*u,q);e.SelfMulAdd(k*u,t);f.SelfMulAdd(m*u,n)}}}};goog.exportProperty(box2d.b2Rope.prototype,"SolveC3",box2d.b2Rope.prototype.SolveC3);box2d.b2Rope.s_d1=new box2d.b2Vec2;
box2d.b2Rope.s_d2=new box2d.b2Vec2;box2d.b2Rope.s_Jd1=new box2d.b2Vec2;box2d.b2Rope.s_Jd2=new box2d.b2Vec2;box2d.b2Rope.s_J1=new box2d.b2Vec2;box2d.b2Rope.s_J2=new box2d.b2Vec2;box2d.b2Rope.prototype.Draw=function(a){for(var b=new box2d.b2Color(.4,.5,.7),d=0;d<this.m_count-1;++d)a.DrawSegment(this.m_ps[d],this.m_ps[d+1],b)};goog.exportProperty(box2d.b2Rope.prototype,"Draw",box2d.b2Rope.prototype.Draw);box2d.b2ControllerEdge=function(){};goog.exportSymbol("box2d.b2ControllerEdge",box2d.b2ControllerEdge);
box2d.b2ControllerEdge.prototype.controller=null;goog.exportProperty(box2d.b2ControllerEdge.prototype,"controller",box2d.b2ControllerEdge.prototype.controller);box2d.b2ControllerEdge.prototype.body=null;goog.exportProperty(box2d.b2ControllerEdge.prototype,"body",box2d.b2ControllerEdge.prototype.body);box2d.b2ControllerEdge.prototype.prevBody=null;goog.exportProperty(box2d.b2ControllerEdge.prototype,"prevBody",box2d.b2ControllerEdge.prototype.prevBody);box2d.b2ControllerEdge.prototype.nextBody=null;
goog.exportProperty(box2d.b2ControllerEdge.prototype,"nextBody",box2d.b2ControllerEdge.prototype.nextBody);box2d.b2ControllerEdge.prototype.prevController=null;goog.exportProperty(box2d.b2ControllerEdge.prototype,"prevController",box2d.b2ControllerEdge.prototype.prevController);box2d.b2ControllerEdge.prototype.nextController=null;goog.exportProperty(box2d.b2ControllerEdge.prototype,"nextController",box2d.b2ControllerEdge.prototype.nextController);box2d.b2Controller=function(){};
goog.exportSymbol("box2d.b2Controller",box2d.b2Controller);box2d.b2Controller.prototype.m_world=null;goog.exportProperty(box2d.b2Controller.prototype,"m_world",box2d.b2Controller.prototype.m_world);box2d.b2Controller.prototype.m_bodyList=null;goog.exportProperty(box2d.b2Controller.prototype,"m_bodyList",box2d.b2Controller.prototype.m_bodyList);box2d.b2Controller.prototype.m_bodyCount=0;goog.exportProperty(box2d.b2Controller.prototype,"m_bodyCount",box2d.b2Controller.prototype.m_bodyCount);
box2d.b2Controller.prototype.m_prev=null;goog.exportProperty(box2d.b2Controller.prototype,"m_prev",box2d.b2Controller.prototype.m_prev);box2d.b2Controller.prototype.m_next=null;goog.exportProperty(box2d.b2Controller.prototype,"m_next",box2d.b2Controller.prototype.m_next);box2d.b2Controller.prototype.Step=function(a){};goog.exportProperty(box2d.b2Controller.prototype,"Step",box2d.b2Controller.prototype.Step);box2d.b2Controller.prototype.Draw=function(a){};
goog.exportProperty(box2d.b2Controller.prototype,"Draw",box2d.b2Controller.prototype.Draw);box2d.b2Controller.prototype.GetNext=function(){return this.m_next};goog.exportProperty(box2d.b2Controller.prototype,"GetNext",box2d.b2Controller.prototype.GetNext);box2d.b2Controller.prototype.GetPrev=function(){return this.m_prev};goog.exportProperty(box2d.b2Controller.prototype,"GetPrev",box2d.b2Controller.prototype.GetPrev);box2d.b2Controller.prototype.GetWorld=function(){return this.m_world};
goog.exportProperty(box2d.b2Controller.prototype,"GetWorld",box2d.b2Controller.prototype.GetWorld);box2d.b2Controller.prototype.GetBodyList=function(){return this.m_bodyList};goog.exportProperty(box2d.b2Controller.prototype,"GetBodyList",box2d.b2Controller.prototype.GetBodyList);
box2d.b2Controller.prototype.AddBody=function(a){var b=new box2d.b2ControllerEdge;b.body=a;b.controller=this;b.nextBody=this.m_bodyList;b.prevBody=null;this.m_bodyList&&(this.m_bodyList.prevBody=b);this.m_bodyList=b;++this.m_bodyCount;b.nextController=a.m_controllerList;b.prevController=null;a.m_controllerList&&(a.m_controllerList.prevController=b);a.m_controllerList=b;++a.m_controllerCount};goog.exportProperty(box2d.b2Controller.prototype,"AddBody",box2d.b2Controller.prototype.AddBody);
box2d.b2Controller.prototype.RemoveBody=function(a){box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<this.m_bodyCount);for(var b=this.m_bodyList;b&&b.body!==a;)b=b.nextBody;box2d.ENABLE_ASSERTS&&box2d.b2Assert(null!==b);b.prevBody&&(b.prevBody.nextBody=b.nextBody);b.nextBody&&(b.nextBody.prevBody=b.prevBody);this.m_bodyList===b&&(this.m_bodyList=b.nextBody);--this.m_bodyCount;b.nextController&&(b.nextController.prevController=b.prevController);b.prevController&&(b.prevController.nextController=b.nextController);
a.m_controllerList===b&&(a.m_controllerList=b.nextController);--a.m_controllerCount};goog.exportProperty(box2d.b2Controller.prototype,"RemoveBody",box2d.b2Controller.prototype.RemoveBody);box2d.b2Controller.prototype.Clear=function(){for(;this.m_bodyList;)this.RemoveBody(this.m_bodyList.body);this.m_bodyCount=0};goog.exportProperty(box2d.b2Controller.prototype,"Clear",box2d.b2Controller.prototype.Clear);
box2d.b2BuoyancyController=function(){box2d.b2Controller.call(this);this.normal=new box2d.b2Vec2(0,1);this.velocity=new box2d.b2Vec2(0,0);this.gravity=new box2d.b2Vec2(0,0)};goog.inherits(box2d.b2BuoyancyController,box2d.b2Controller);goog.exportSymbol("box2d.b2BuoyancyController",box2d.b2BuoyancyController);box2d.b2BuoyancyController.prototype.normal=null;goog.exportProperty(box2d.b2BuoyancyController.prototype,"normal",box2d.b2BuoyancyController.prototype.normal);
box2d.b2BuoyancyController.prototype.offset=0;goog.exportProperty(box2d.b2BuoyancyController.prototype,"offset",box2d.b2BuoyancyController.prototype.offset);box2d.b2BuoyancyController.prototype.density=0;goog.exportProperty(box2d.b2BuoyancyController.prototype,"density",box2d.b2BuoyancyController.prototype.density);box2d.b2BuoyancyController.prototype.velocity=null;goog.exportProperty(box2d.b2BuoyancyController.prototype,"velocity",box2d.b2BuoyancyController.prototype.velocity);
box2d.b2BuoyancyController.prototype.linearDrag=0;goog.exportProperty(box2d.b2BuoyancyController.prototype,"linearDrag",box2d.b2BuoyancyController.prototype.linearDrag);box2d.b2BuoyancyController.prototype.angularDrag=0;goog.exportProperty(box2d.b2BuoyancyController.prototype,"angularDrag",box2d.b2BuoyancyController.prototype.angularDrag);box2d.b2BuoyancyController.prototype.useDensity=!1;goog.exportProperty(box2d.b2BuoyancyController.prototype,"useDensity",box2d.b2BuoyancyController.prototype.useDensity);
box2d.b2BuoyancyController.prototype.useWorldGravity=!0;goog.exportProperty(box2d.b2BuoyancyController.prototype,"useWorldGravity",box2d.b2BuoyancyController.prototype.useWorldGravity);box2d.b2BuoyancyController.prototype.gravity=null;goog.exportProperty(box2d.b2BuoyancyController.prototype,"gravity",box2d.b2BuoyancyController.prototype.gravity);
box2d.b2BuoyancyController.prototype.Step=function(a){if(this.m_bodyList)for(this.useWorldGravity&&this.gravity.Copy(this.GetWorld().GetGravity()),a=this.m_bodyList;a;a=a.nextBody){var b=a.body;if(b.IsAwake()){for(var d=new box2d.b2Vec2,e=new box2d.b2Vec2,f=0,g=0,k=b.GetFixtureList();k;k=k.m_next){var m=new box2d.b2Vec2,n=k.GetShape().ComputeSubmergedArea(this.normal,this.offset,b.GetTransform(),m),f=f+n;d.x+=n*m.x;d.y+=n*m.y;var q=0,q=this.useDensity?k.GetDensity():1,g=g+n*q;e.x+=n*m.x*q;e.y+=n*
m.y*q}d.x/=f;d.y/=f;e.x/=g;e.y/=g;f<box2d.b2_epsilon||(g=this.gravity.Clone().SelfNeg(),g.SelfMul(this.density*f),b.ApplyForce(g,e),e=b.GetLinearVelocityFromWorldPoint(d,new box2d.b2Vec2),e.SelfSub(this.velocity),e.SelfMul(-this.linearDrag*f),b.ApplyForce(e,d),b.ApplyTorque(-b.GetInertia()/b.GetMass()*f*b.GetAngularVelocity()*this.angularDrag))}}};goog.exportProperty(box2d.b2BuoyancyController.prototype,"Step",box2d.b2BuoyancyController.prototype.Step);
box2d.b2BuoyancyController.prototype.Draw=function(a){var b=new box2d.b2Vec2,d=new box2d.b2Vec2;b.x=this.normal.x*this.offset+100*this.normal.y;b.y=this.normal.y*this.offset-100*this.normal.x;d.x=this.normal.x*this.offset-100*this.normal.y;d.y=this.normal.y*this.offset+100*this.normal.x;var e=new box2d.b2Color(0,0,.8);a.DrawSegment(b,d,e)};goog.exportProperty(box2d.b2BuoyancyController.prototype,"Draw",box2d.b2BuoyancyController.prototype.Draw);
box2d.b2ConstantAccelController=function(){box2d.b2Controller.call(this);this.A=new box2d.b2Vec2(0,0)};goog.inherits(box2d.b2ConstantAccelController,box2d.b2Controller);goog.exportSymbol("box2d.b2ConstantAccelController",box2d.b2ConstantAccelController);box2d.b2ConstantAccelController.prototype.A=null;goog.exportProperty(box2d.b2ConstantAccelController.prototype,"A",box2d.b2ConstantAccelController.prototype.A);
box2d.b2ConstantAccelController.prototype.Step=function(a){a=box2d.b2Mul_S_V2(a.dt,this.A,box2d.b2ConstantAccelController.prototype.Step.s_dtA);for(var b=this.m_bodyList;b;b=b.nextBody){var d=b.body;d.IsAwake()&&d.SetLinearVelocity(box2d.b2Add_V2_V2(d.GetLinearVelocity(),a,box2d.b2Vec2.s_t0))}};goog.exportProperty(box2d.b2ConstantAccelController.prototype,"Step",box2d.b2ConstantAccelController.prototype.Step);box2d.b2ConstantAccelController.prototype.Step.s_dtA=new box2d.b2Vec2;
box2d.b2ConstantForceController=function(){box2d.b2Controller.call(this);this.F=new box2d.b2Vec2(0,0)};goog.inherits(box2d.b2ConstantForceController,box2d.b2Controller);goog.exportSymbol("box2d.b2ConstantForceController",box2d.b2ConstantForceController);box2d.b2ConstantAccelController.prototype.F=null;goog.exportProperty(box2d.b2ConstantAccelController.prototype,"F",box2d.b2ConstantAccelController.prototype.F);
box2d.b2ConstantForceController.prototype.Step=function(a){for(a=this.m_bodyList;a;a=a.nextBody){var b=a.body;b.IsAwake()&&b.ApplyForce(this.F,b.GetWorldCenter())}};goog.exportProperty(box2d.b2ConstantForceController.prototype,"Step",box2d.b2ConstantForceController.prototype.Step);box2d.b2GravityController=function(){box2d.b2Controller.call(this)};goog.inherits(box2d.b2GravityController,box2d.b2Controller);goog.exportSymbol("box2d.b2GravityController",box2d.b2GravityController);
box2d.b2GravityController.prototype.G=1;goog.exportProperty(box2d.b2GravityController.prototype,"G",box2d.b2GravityController.prototype.G);box2d.b2GravityController.prototype.invSqr=!0;goog.exportProperty(box2d.b2GravityController.prototype,"invSqr",box2d.b2GravityController.prototype.invSqr);
box2d.b2GravityController.prototype.Step=function(a){if(this.invSqr)for(a=this.m_bodyList;a;a=a.nextBody)for(var b=a.body,d=b.GetWorldCenter(),e=b.GetMass(),f=this.m_bodyList;f!==a;f=f.nextBody){var g=f.body,k=g.GetWorldCenter(),m=g.GetMass(),n=k.x-d.x,q=k.y-d.y,s=n*n+q*q;s<box2d.b2_epsilon||(n=box2d.b2GravityController.prototype.Step.s_f.Set(n,q),n.SelfMul(this.G/s/box2d.b2Sqrt(s)*e*m),b.IsAwake()&&b.ApplyForce(n,d),g.IsAwake()&&g.ApplyForce(n.SelfMul(-1),k))}else for(a=this.m_bodyList;a;a=a.nextBody)for(b=
a.body,d=b.GetWorldCenter(),e=b.GetMass(),f=this.m_bodyList;f!==a;f=f.nextBody)g=f.body,k=g.GetWorldCenter(),m=g.GetMass(),n=k.x-d.x,q=k.y-d.y,s=n*n+q*q,s<box2d.b2_epsilon||(n=box2d.b2GravityController.prototype.Step.s_f.Set(n,q),n.SelfMul(this.G/s*e*m),b.IsAwake()&&b.ApplyForce(n,d),g.IsAwake()&&g.ApplyForce(n.SelfMul(-1),k))};goog.exportProperty(box2d.b2GravityController.prototype,"Step",box2d.b2GravityController.prototype.Step);box2d.b2GravityController.prototype.Step.s_f=new box2d.b2Vec2;
box2d.b2TensorDampingController=function(){box2d.b2Controller.call(this);this.T=new box2d.b2Mat22;this.maxTimestep=0};goog.inherits(box2d.b2TensorDampingController,box2d.b2Controller);goog.exportSymbol("box2d.b2TensorDampingController",box2d.b2TensorDampingController);box2d.b2TensorDampingController.prototype.T=new box2d.b2Mat22;goog.exportProperty(box2d.b2TensorDampingController.prototype,"T",box2d.b2TensorDampingController.prototype.T);box2d.b2TensorDampingController.prototype.maxTimestep=0;
goog.exportProperty(box2d.b2TensorDampingController.prototype,"maxTimestep",box2d.b2TensorDampingController.prototype.maxTimestep);
box2d.b2TensorDampingController.prototype.Step=function(a){a=a.dt;if(!(a<=box2d.b2_epsilon)){a>this.maxTimestep&&0<this.maxTimestep&&(a=this.maxTimestep);for(var b=this.m_bodyList;b;b=b.nextBody){var d=b.body;if(d.IsAwake()){var e=d.GetWorldVector(box2d.b2Mul_M22_V2(this.T,d.GetLocalVector(d.GetLinearVelocity(),box2d.b2Vec2.s_t0),box2d.b2Vec2.s_t1),box2d.b2TensorDampingController.prototype.Step.s_damping);d.SetLinearVelocity(box2d.b2Add_V2_V2(d.GetLinearVelocity(),box2d.b2Mul_S_V2(a,e,box2d.b2Vec2.s_t0),
box2d.b2Vec2.s_t1))}}}};box2d.b2TensorDampingController.prototype.Step.s_damping=new box2d.b2Vec2;box2d.b2TensorDampingController.prototype.SetAxisAligned=function(a,b){this.T.ex.x=-a;this.T.ex.y=0;this.T.ey.x=0;this.T.ey.y=-b;this.maxTimestep=0<a||0<b?1/box2d.b2Max(a,b):0};
box2d={Render:{},b2DebugDraw:function(a){box2d.b2Draw.call(this);this.scale=a.scale;this.m_canvas=a.canvas||!1;this.m_ctx=a.ctx||!1;this.m_settings=a.flags||box2d.b2DrawFlags.e_shapeBit|box2d.b2DrawFlags.e_centerOfMassBit;this.alpha=a.alpha||.5}};goog.inherits(box2d.b2DebugDraw,box2d.b2Draw);box2d.b2DebugDraw.prototype.m_canvas=null;box2d.b2DebugDraw.prototype.m_ctx=null;box2d.b2DebugDraw.prototype.m_settings=null;box2d.b2DebugDraw.prototype.scale=40;box2d.b2DebugDraw.prototype.alpha=.5;
box2d.b2DebugDraw.prototype.PushTransform=function(a){var b=this.m_ctx;b.save();b.globalAlpha=this.alpha;b.translate(a.p.x*this.scale,a.p.y*this.scale);b.rotate(a.q.GetAngle())};box2d.b2DebugDraw.prototype.PopTransform=function(a){this.m_ctx.restore()};
box2d.b2DebugDraw.prototype.DrawPolygon=function(a,b,d){if(b){var e=this.m_ctx;e.globalAlpha=1;e.beginPath();e.moveTo(a[0].x*this.scale,a[0].y*this.scale);for(var f=1;f<b;f++)e.lineTo(a[f].x*this.scale,a[f].y*this.scale);e.closePath();e.strokeStyle=d.MakeStyleString(1);e.stroke()}};
box2d.b2DebugDraw.prototype.DrawSolidPolygon=function(a,b,d){if(b){var e=this.m_ctx;e.beginPath();e.moveTo(a[0].x*this.scale,a[0].y*this.scale);for(var f=1;f<b;f++)e.lineTo(a[f].x*this.scale,a[f].y*this.scale);e.closePath();e.fillStyle=d.MakeStyleString(.5);e.fill();e.strokeStyle=d.MakeStyleString(1);e.stroke()}};
box2d.b2DebugDraw.prototype.DrawCircle=function(a,b,d){if(b){var e=this.m_ctx;e.beginPath();e.arc(a.x*this.scale,a.y*this.scale,b*this.scale,0,2*box2d.b2_pi,!0);e.strokeStyle=d.MakeStyleString(1);e.stroke()}};
box2d.b2DebugDraw.prototype.DrawSolidCircle=function(a,b,d,e){if(b){var f=this.m_ctx,g=a.x*this.scale;a=a.y*this.scale;f.beginPath();f.arc(g,a,b,0,2*box2d.b2_pi,!0);f.moveTo(g,a);f.lineTo(g+d.x*this.scale*b,a+d.y*this.scale*b);f.fillStyle=e.MakeStyleString(.5);f.fill();f.strokeStyle=e.MakeStyleString(1);f.stroke()}};
box2d.b2DebugDraw.prototype.DrawSegment=function(a,b,d){var e=this.m_ctx;e.beginPath();e.moveTo(a.x*this.scale,a.y*this.scale);e.lineTo(b.x*this.scale,b.y*this.scale);e.strokeStyle=d.MakeStyleString(1);e.stroke()};
box2d.b2DebugDraw.prototype.DrawTransform=function(a){var b=this.m_ctx;this.PushTransform(a);b.beginPath();b.moveTo(0,0);b.lineTo(10,0);b.strokeStyle=box2d.b2Color.RED.MakeStyleString(1);b.stroke();b.beginPath();b.moveTo(0,0);b.lineTo(0,10);b.strokeStyle=box2d.b2Color.GREEN.MakeStyleString(1);b.stroke();this.PopTransform(a)};
box2d.b2DebugDraw.prototype.DrawPoint=function(a,b,d){var e=this.m_ctx;e.fillStyle=d.MakeStyleString();b/=this.m_settings.viewZoom;b/=this.m_settings.canvasScale;d=b/2;e.fillRect(a.x*this.scale-d,a.y*this.scale-d,b,b)};
box2d.b2DebugDraw.prototype.DrawString=function(a,b,d,e){var f=this.m_ctx,g=Array.prototype.slice.call(arguments),g=goog.string.format.apply(null,g.slice(2));f.save();f.setTransform(1,0,0,1,0,0);f.font="18pt helvetica";f.fillStyle=box2d.b2DebugDraw.prototype.DrawString.s_color.MakeStyleString();f.fillText(g,a*this.scale,b*this.scale);f.restore()};box2d.b2DebugDraw.prototype.DrawString.s_color=new box2d.b2Color(.9,.6,.6);
box2d.b2DebugDraw.prototype.DrawStringWorld=function(a,b,d,e){var f=box2d.b2DebugDraw.prototype.DrawStringWorld.s_p.Set(a,b);box2d.b2SubVV(f,this.m_settings.viewCenter,f);box2d.b2MulTRV(this.m_settings.viewRotation,f,f);box2d.b2MulSV(this.m_settings.viewZoom,f,f);box2d.b2MulSV(this.m_settings.canvasScale,f,f);f.y*=-1;var g=box2d.b2DebugDraw.prototype.DrawStringWorld.s_cc.Set(.5*this.m_canvas.width,.5*this.m_canvas.height);box2d.b2AddVV(f,g,f);var g=this.m_ctx,k=Array.prototype.slice.call(arguments),
k=goog.string.format.apply(null,k.slice(2));g.save();g.setTransform(1,0,0,1,0,0);g.font="18pt helvetica";g.fillStyle=box2d.b2DebugDraw.prototype.DrawStringWorld.s_color.MakeStyleString();g.fillText(k,f.x*this.scale,f.y*this.scale);g.restore()};box2d.b2DebugDraw.prototype.DrawStringWorld.s_p=new box2d.b2Vec2;box2d.b2DebugDraw.prototype.DrawStringWorld.s_cc=new box2d.b2Vec2;box2d.b2DebugDraw.prototype.DrawStringWorld.s_color=new box2d.b2Color(.5,.9,.5);
box2d.b2DebugDraw.prototype.DrawAABB=function(a,b){var d=this.m_ctx;d.strokeStyle=b.MakeStyleString();d.strokeRect(a.lowerBound.x*this.scale,a.lowerBound.y*this.scale,(a.upperBound.x-a.lowerBound.x)*this.scale,(a.upperBound.y-a.lowerBound.y)*this.scale)};box2d.b2DebugDraw.prototype.SetFlags=function(a){this.m_settings=a};box2d.b2DebugDraw.prototype.GetFlags=function(){return this.m_settings};
var b2AABB=box2d.b2AABB,b2Body=box2d.b2Body,b2BodyDef=box2d.b2BodyDef,b2ChainShape=box2d.b2ChainShape,b2CircleShape=box2d.b2CircleShape,b2ContactListener=box2d.b2ContactListener,b2DebugDraw=box2d.b2DebugDraw,b2EdgeChainDef=box2d.b2EdgeChainDef,b2EdgeShape=box2d.b2EdgeShape,b2Fixture=box2d.b2Fixture,b2FixtureDef=box2d.b2FixtureDef,b2Joint=box2d.b2Joint,b2MassData=box2d.b2MassData,b2Mat22=box2d.b2Mat22,b2MouseJointDef=box2d.b2MouseJointDef,b2PolygonShape=box2d.b2PolygonShape,b2PrismaticJointDef=box2d.b2PrismaticJointDef,
b2RevoluteJointDef=box2d.b2RevoluteJointDef,b2Settings=box2d.b2Settings,b2Shape=box2d.b2Shape,b2World=box2d.b2World,b2WorldManifold=box2d.b2WorldManifold,b2Vec2=box2d.b2Vec2;
CG.Entity.extend("B2DEntity",{init:function(a){this._super();this.instanceOf="B2DEntity";CG._extend(this,{world:{},scale:{},body:{},bodyType:box2d.b2BodyType.b2_dynamicBody,bullet:!1,alpha:1,x:0,y:0,scale:40,id:{name:"",uid:0,cgObj:this},world:{},isHit:!1,strength:100,dead:!1,angle:0,density:1,restitution:.1,friction:1,allowSleep:!0,awake:!0,fixedRotation:!1,isSensor:!1,bodyDef:new b2BodyDef,fixDef:new b2FixtureDef,categoryBits:1,maskBits:65535,groupIndex:0});a&&(CG._extend(this,a),this.id.name=a.name);
this.bodyDef.allowSleep=this.allowSleep;this.bodyDef.awake=this.awake;this.bodyDef.bullet=this.bullet;this.bodyDef.angle=this.angle;this.bodyDef.fixedRotation=this.fixedRotation;this.fixDef.density=this.density;this.fixDef.friction=this.friction;this.fixDef.restitution=this.restitution;this.fixDef.isSensor=this.isSensor;this.fixDef.filter.categoryBits=this.categoryBits;this.fixDef.filter.maskBits=this.maskBits;this.fixDef.filter.groupIndex=this.groupIndex;return this},hit:function(a,b){this.isHit=
!0;this.strength&&(this.strength-=a,0>=this.strength&&(this.dead=!0))},update:function(){},draw:function(){Game.renderer.draw(this)},addVelocity:function(a){var b=this.body.GetLinearVelocity();b.SelfAdd(a);Math.abs(b.y)>this.max_ver_vel&&(b.y=this.max_ver_vel*b.y/Math.abs(b.y));Math.abs(b.x)>this.max_hor_vel&&(b.x=this.max_hor_vel*b.x/Math.abs(b.x));this.body.SetLinearVelocity(b)},applyImpulse:function(a,b){this.body&&this.body.ApplyLinearImpulse(new b2Vec2(Math.cos(a*CG.Const_PI_180)*b,Math.sin(a*
CG.Const_PI_180)*b),this.body.GetWorldCenter())},setType:function(a){this.body.SetType(a)},setPosition:function(a){this.body.SetPosition(a)},getPosition:function(){return this.body.GetPosition()}});
CG.B2DEntity.extend("B2DCircle",{init:function(a){CG._extend(this,{radius:0});this._super(a);this.instanceOf="B2DCircle";this.setImage(this.image);this.bodyDef.type=this.bodyType;this.bodyDef.position.x=this.x/this.scale;this.bodyDef.position.y=this.y/this.scale;this.bodyDef.userData=this.id;this.fixDef.shape=new b2CircleShape(this.radius/this.scale);this.body=this.world.CreateBody(this.bodyDef);this.body.CreateFixture(this.fixDef);return this}});
CG.B2DEntity.extend("B2DLine",{init:function(a){CG._extend(this,{body:{},startPoint:new b2Vec2(0,0),endPoint:new b2Vec2(0,0)});this._super(a);this.instanceOf="B2DLine";this.convertPoints();this.fixDef.shape=new b2EdgeShape;this.fixDef.shape.Set(this.startPoint,this.endPoint);this.bodyDef.type=box2d.b2BodyType.b2_staticBody;this.bodyDef.position.Set(0/this.scale,0/this.scale);this.bodyDef.userData=this.id;this.body=this.world.CreateBody(this.bodyDef);this.body.CreateFixture(this.fixDef);return this},
convertPoints:function(){this.startPoint.x/=this.scale;this.startPoint.y/=this.scale;this.endPoint.x/=this.scale;this.endPoint.y/=this.scale},update:function(){},draw:function(){}});
CG.B2DEntity.extend("B2DRectangle",{init:function(a){this._super(a);this.instanceOf="B2DRectangle";this.setImage(this.image);this.fixDef.shape=new b2PolygonShape;this.fixDef.shape.SetAsBox(this.width/this.scale*.5,this.height/this.scale*.5);this.bodyDef.type=this.bodyType;this.bodyDef.position.x=this.x/this.scale;this.bodyDef.position.y=this.y/this.scale;this.bodyDef.userData=this.id;this.body=this.world.CreateBody(this.bodyDef);this.body.CreateFixture(this.fixDef);return this}});
CG.B2DEntity.extend("B2DPolygon",{init:function(a){CG._extend(this,{polys:[],bullet:!1});this._super(a);this.instanceOf="B2DPolygon";this.setImage(this.image);this.jsondata=this.texturepacker.data[this.name];this.vecs=[];this.vecs=this.getPolysFromJson(this.texturepacker);this.bodyDef.type=this.bodyType;this.bodyDef.position.Set(this.x/this.scale,this.y/this.scale);this.bodyDef.userData=this.id;this.bodyDef.bullet=this.bullet;this.body=this.world.CreateBody(this.bodyDef);a=0;for(var b=this.vecs.length;a<
b;a++)this.bodyShapePoly=new b2PolygonShape,this.bodyShapePoly.bounce=this.jsondata[a].bounce,this.makeVecsCentroid(this.vecs[a]),this.bodyShapePoly.Set(this.vecs[a],this.vecs[a].length),this.fixDef.density=this.jsondata[a].density,this.fixDef.friction=this.jsondata[a].friction,this.fixDef.shape=this.bodyShapePoly,this.body.CreateFixture(this.fixDef);return this},getPolysFromJson:function(){for(var a=[],b=0,d=this.jsondata.length;b<d;b++){for(var e=this.jsondata[b].shape,f=[],g=0,k=e.length;g<k;g+=
2){var m=new b2Vec2(e[g]/this.scale,e[g+1]/this.scale);f.push(m)}a.push(f)}return a},getPolysFromBitmapTrace:function(a){return[]},makeVecsCentroid:function(a){for(var b=this.xhandle/this.scale,d=this.yhandle/this.scale,e=0,f=a.length;e<f;e++)a[e].x-=b,a[e].y-=d}});
CG.B2DEntity.extend("B2DTerrain",{init:function(a){CG._extend(this,{bitmap:new CG.Bitmap({width:Game.width,height:Game.height}),image:!1,polys:[],terrainShape:[],terrainTriangles:[],holes:[]});this._super(a);this.instanceOf="B2DTerrain";void 0!==typeof this.image&&this.bitmap.loadImage(this.image);this.bodyDef.type=box2d.b2BodyType.b2_staticBody;this.bodyDef.position.Set(this.x/this.scale,this.y/this.scale);this.bodyDef.userData=this.id;this.createTerrain();return this},createTerrain:function(){this.body=
this.world.CreateBody(this.bodyDef);try{for(var a=0,b=this.terrainShape.length;a<b;a++){var d=this.terrainShape[a].outer;if("undefined"!==typeof d){var e=new poly2tri.SweepContext(d,{cloneArrays:!0});if(0<this.terrainShape[a].holes.length)for(var f=0,g=this.terrainShape[a].holes.length;f<g;f++)e.addHole(this.terrainShape[a].holes[f]);e.triangulate();this.terrainTriangles=this.terrainTriangles.concat(e.getTriangles()||[])}}f=0;for(g=this.terrainTriangles.length;f<g;f++)this.bodyShapePoly=new b2PolygonShape,
this.bodyShapePoly.bounce=.5,this.bodyShapePoly.Set(this.getPolysFromTriangulation(this.terrainTriangles[f].points_),this.terrainTriangles[f].points_.length),this.fixDef.density=this.density,this.fixDef.restitution=this.restitution,this.fixDef.friction=this.friction,this.fixDef.shape=this.bodyShapePoly,this.body.CreateFixture(this.fixDef)}catch(k){}},deleteTerrain:function(){this.terrainTriangles=[];this.world.DestroyBody(this.body)},clipTerrain:function(a){for(var b=this.createCircle(a),d=0,e=this.terrainShape.length;d<
e;d++)this.terrainShape[d].holes.push(b);for(var b=[],f=[],g=[],d=0,e=this.terrainShape.length;d<e;d++){f=[this.terrainShape[d].outer];g=[];if(0<this.terrainShape[d].holes.length)for(var k=0,m=this.terrainShape[d].holes.length;k<m;k++)g.push(this.terrainShape[d].holes[k]);k=new ClipperLib.Clipper;k.PreserveCollinear=!0;k.StrictlySimple=!0;m=new ClipperLib.PolyTree;k.AddPaths(f,ClipperLib.PolyType.ptSubject,!0);k.AddPaths(g,ClipperLib.PolyType.ptClip,!0);k.Execute(ClipperLib.ClipType.ctDifference,
m,ClipperLib.PolyFillType.pftNonZero,ClipperLib.PolyFillType.pftNonZero);f=ClipperLib.JS.PolyTreeToExPolygons(m);if(0<f.length)for(g=0,k=f.length;g<k;g++)b.push(f[g])}this.terrainShape=b;this.lightenTerrain();this.deleteTerrain();this.createTerrain();this.bitmap.clearCircle(a.x,a.y,a.radius)},lightenTerrain:function(){for(var a=0,b=this.terrainShape.length;a<b;a++){var d=ClipperLib.JS.Lighten(this.terrainShape[a].outer,.02*this.scale);this.terrainShape[a].outer=d[0];if(0<this.terrainShape[a].holes.length)for(var e=
0,f=this.terrainShape[a].holes.length;e<f;e++)d=ClipperLib.JS.Lighten(this.terrainShape[a].holes[e],.02*this.scale),this.terrainShape[a].holes[e]=d[0]}},cleanTerrain:function(){for(var a=0,b=this.terrainShape.length;a<b;a++){var d=ClipperLib.JS.Clean(this.terrainShape[a].outer,.1*this.scale);this.terrainShape[a].outer=d[0];if(0<this.terrainShape[a].holes.length)for(var e=0,f=this.terrainShape[a].holes.length;e<f;e++)d=ClipperLib.JS.Clean(this.terrainShape[a].holes[e],.1*this.scale),this.terrainShape[a].holes[e]=
d[0]}},getPolysFromTriangulation:function(a){for(var b=[],d=0,e=a.length;d<e;d++){var f=a[d];b.push(new b2Vec2(f.x/this.scale,f.y/this.scale))}return b},createCircle:function(a){for(var b=2*Math.PI/a.points,d=[],e=0;e<a.points;e++)d.push({x:a.x+a.radius*Math.cos(b*e),y:a.y+a.radius*Math.sin(b*e)});return d.reverse()},draw:function(){Game.renderer.draw(this.bitmap)},polys2SvgImage:function(a,b){var d="",e,f;b||(b=1);for(e=0;e<a.length;e++){for(f=0;f<a[e].length;f++)d=f?d+"L":d+"M",d+=a[e][f].X/b+", "+
a[e][f].Y/b;d+="Z"}return d}});
CG.B2DEntity.extend("B2DChainShape",{init:function(a){this._super(a);this.instanceOf="B2DChainShape";CG._extend(this,{vertices:[],bodyType:box2d.b2BodyType.b2_staticBody});this.vertices=this.convertRealWorldPointToBox2DVec2(this.points);this.bodyDef.type=this.bodyType;this.bodyDef.position.Set(this.x/this.scale,this.y/this.scale);this.bodyDef.userData=this.id;this.fixDef.shape=new b2ChainShape;this.fixDef.shape.CreateChain(this.vertices,this.vertices.length);this.body=this.world.CreateBody(this.bodyDef);
this.body.CreateFixture(this.fixDef);return this},convertRealWorldPointToBox2DVec2:function(a){for(var b=[],d=0,e=a.length;d<e;d++){var f=new b2Vec2(a[d].x/this.scale,a[d].y/this.scale);b.push(f)}return b},update:function(){},draw:function(){}});
CG.B2DEntity.extend("B2DRope",{init:function(a){CG._extend(this,{length:0,segments:0,segmentHeight:0,segmentWidth:0,anchor:new b2Vec2,prevBody:{},bodyGroup:[],bodyCount:0,lowerAngle:-25,upperAngle:25,enableLimit:!0});this._super(a);this.instanceOf="B2DRope";this.setImage(this.image);this.segmentHeight=(this.length-this.y)/this.segments/2;this.fixtureDef=new b2FixtureDef;this.bodyShapeCircle=new b2CircleShape;this.bodyDef=new b2BodyDef;this.bodyDef.userData=this.id;this.bodyShapeCircle.m_radius=this.segmentWidth/
this.scale;this.fixtureDef.density=this.density;this.fixtureDef.restitution=this.restitution;this.fixtureDef.friction=this.friction;this.fixtureDef.shape=this.bodyShapeCircle;this.bodyDef.position.Set(this.x/this.scale,this.y/this.scale);this.body=this.bodyGroup[0]=this.world.CreateBody(this.bodyDef);this.bodyGroup[0].CreateFixture(this.fixtureDef);this.prevBody=this.bodyGroup[0];this.fixtureDef=new b2FixtureDef;this.bodyShapePoly=new b2PolygonShape;this.bodyDef=new b2BodyDef;this.bodyDef.userData=
this.id;this.bodyShapePoly.SetAsBox(this.segmentWidth/this.scale,this.segmentHeight/this.scale);this.bodyDef.type=box2d.b2BodyType.b2_dynamicBody;this.fixtureDef.shape=this.bodyShapePoly;this.fixtureDef.density=this.density;this.fixtureDef.restitution=this.restitution;this.fixtureDef.friction=this.friction;this.jointDef=new b2RevoluteJointDef;this.jointDef.lowerAngle=this.lowerAngle/CG.Const_180_PI;this.jointDef.upperAngle=this.upperAngle/CG.Const_180_PI;this.jointDef.enableLimit=this.enableLimit;
a=0;for(var b=this.segments;a<b;a++)this.bodyDef.position.Set(this.x/this.scale,(this.y+this.segmentHeight+2*this.segmentHeight*a)/this.scale),this.bodyGroup[a+1]=this.world.CreateBody(this.bodyDef),this.bodyGroup[a+1].CreateFixture(this.fixtureDef),this.anchor.Set(this.x/this.scale,(this.y+2*this.segmentHeight*a)/this.scale),this.jointDef.Initialize(this.prevBody,this.bodyGroup[a+1],this.anchor),this.world.CreateJoint(this.jointDef),this.prevBody=this.bodyGroup[a+1],this.bodyCount=a+1;return this},
draw:function(){for(var a=1;a<=this.bodyCount;a++)this.body=this.bodyGroup[a],Game.renderer.draw(this)}});
CG.B2DEntity.extend("B2DBridge",{init:function(a){CG._extend(this,{x:0,y:0,length:0,segments:0,segmentWidth:0,segmentHeight:0,anchor:new b2Vec2,prevBody:{},bodyGroup:[],bodyCount:0,lowerAngle:-25,upperAngle:25,enableLimit:!0});this._super(a);this.instanceOf="B2DBridge";this.setImage(this.image);this.segmentWidth=(this.length-this.x)/this.segments/2;this.fixtureDef=new b2FixtureDef;this.bodyShapeCircle=new b2CircleShape;this.bodyDef=new b2BodyDef;this.bodyDef.userData=this.id;this.bodyShapeCircle.m_radius=
this.segmentHeight/this.scale;this.fixtureDef.density=this.density;this.fixtureDef.restitution=this.restitution;this.fixtureDef.friction=this.friction;this.fixtureDef.shape=this.bodyShapeCircle;this.bodyDef.position.Set(this.x/this.scale,this.y/this.scale);this.body=this.bodyGroup[0]=this.world.CreateBody(this.bodyDef);this.bodyGroup[0].CreateFixture(this.fixtureDef);this.prevBody=this.bodyGroup[0];this.bodyDef.position.Set(this.length/this.scale,this.y/this.scale);this.bodyDef.userData=this.id;this.bodyGroup[1]=
this.world.CreateBody(this.bodyDef);this.bodyGroup[1].CreateFixture(this.fixtureDef);this.fixtureDef=new b2FixtureDef;this.bodyShapePoly=new b2PolygonShape;this.bodyDef=new b2BodyDef;this.bodyDef.userData=this.id;this.bodyShapePoly.SetAsBox(this.segmentWidth/this.scale,this.segmentHeight/this.scale);this.bodyDef.type=box2d.b2BodyType.b2_dynamicBody;this.fixtureDef.shape=this.bodyShapePoly;this.fixtureDef.density=this.density;this.fixtureDef.restitution=this.restitution;this.fixtureDef.friction=this.friction;
this.jointDef=new b2RevoluteJointDef;this.jointDef.lowerAngle=this.lowerAngle/CG.Const_180_PI;this.jointDef.upperAngle=this.upperAngle/CG.Const_180_PI;this.jointDef.enableLimit=this.enableLimit;a=0;for(var b=this.segments;a<b;a++)this.bodyDef.position.Set((this.x+this.segmentWidth+2*this.segmentWidth*a)/this.scale,this.y/this.scale),this.bodyGroup[a+2]=this.world.CreateBody(this.bodyDef),this.bodyGroup[a+2].CreateFixture(this.fixtureDef),this.anchor.Set((this.x+2*this.segmentWidth*a)/this.scale,this.y/
this.scale),this.jointDef.Initialize(this.prevBody,this.bodyGroup[a+2],this.anchor),this.world.CreateJoint(this.jointDef),this.prevBody=this.bodyGroup[a+2],this.bodyCount=a+2;this.anchor.Set((this.x+2*this.segmentWidth*this.segments-1)/this.scale,this.y/this.scale);this.jointDef.Initialize(this.prevBody,this.bodyGroup[1],this.anchor);this.world.CreateJoint(this.jointDef);return this},draw:function(){for(var a=2;a<=this.bodyCount;a++)this.body=this.bodyGroup[a],Game.renderer.draw(this)}});
CG.Layer.extend("B2DWorld",{init:function(a){CG._extend(this,{framerate:1/30,name:"",debug:!1,x:0,y:0,elements:[],uid:0,scale:40,sleep:!0});a&&CG._extend(this,a);this.world=new b2World(new b2Vec2(0,10),this.sleep);this.world.m_groundBody=this.world.CreateBody(new b2BodyDef);a=new b2DebugDraw({scale:this.scale,canvas:Game.b_canvas,ctx:Game.b_ctx,flags:box2d.b2DrawFlags.e_shapeBit|box2d.b2DrawFlags.e_jointBit|box2d.b2DrawFlags.e_centerOfMassBit});this.world.SetDebugDraw(a)},update:function(){this.world.Step(this.framerate,
10,10);CG.mousedown?this.mouseDownAt(mousex,mousey):this.isMouseDown()&&this.mouseUp();for(var a=0,b=this.elements.length;a<b;a++)this.elements[a].update()},draw:function(){Game.b_ctx.save();Game.b_ctx.translate(this.x,this.y);for(var a=0,b=this.elements.length;a<b;a++)this.elements[a].draw();this.debug&&(this.world.DrawDebugData(),this.world.ClearForces());Game.b_ctx.restore()},addCustom:function(a){this.uid+=1;a.id.uid=this.uid;this.elements.push(a);return a},checkIfBodyExists:function(a){if(a)for(var b=
0,d=this.elements.length;b<d;b++)if(this.elements[b].body.m_userData.uid==a.m_userData.uid)return!0;return!1},createBox:function(a){a.world=this.world;a.scale=this.scale;this.uid+=1;a=new CG.B2DRectangle(a);a.id.uid=this.uid;this.elements.push(a);return a},createLine:function(a){a.world=this.world;a.scale=this.scale;this.uid+=1;a=new CG.B2DLine(a);a.id.uid=this.uid;this.elements.push(a);return a},createCircle:function(a){a.world=this.world;a.scale=this.scale;this.uid+=1;a=new CG.B2DCircle(a);a.id.uid=
this.uid;this.elements.push(a);return a},createPolyBody:function(a){a.world=this.world;a.scale=this.scale;this.uid+=1;a=new CG.B2DPolygon(a);a.id.uid=this.uid;this.elements.push(a);return a},createTerrain:function(a){a.world=this.world;a.scale=this.scale;this.uid+=1;a=new CG.B2DTerrain(a);a.id.uid=this.uid;this.elements.push(a);return a},createChainShape:function(a){a.world=this.world;a.scale=this.scale;this.uid+=1;a=new CG.B2DChainShape(a);a.id.uid=this.uid;this.elements.push(a);return a},createBridge:function(a){a.world=
this.world;a.scale=this.scale;this.uid+=1;a=new CG.B2DBridge(a);a.id.uid=this.uid;this.elements.push(a);return a},createRope:function(a){a.world=this.world;a.scale=this.scale;this.uid+=1;a=new CG.B2DRope(a);a.id.uid=this.uid;this.elements.push(a);return a},mouseDownAt:function(a,b){if(this.mouseJoint)this.mouseJoint.SetTarget(new b2Vec2((a-this.x)/this.scale,(b-this.y)/this.scale));else{var d=this.getBodyAt(a,b);if(d){var e=new b2MouseJointDef;e.bodyA=this.world.m_groundBody;e.bodyB=d;e.target.Set((a-
this.x)/this.scale,(b-this.y)/this.scale);e.collideConnected=!0;e.maxForce=300*d.GetMass();this.mouseJoint=this.world.CreateJoint(e);d.SetAwake(!0)}}},mouseUp:function(){this.world.DestroyJoint(this.mouseJoint);this.mouseJoint=null},getBodyAt:function(a,b){var d=(a-this.x)/this.scale,e=(b-this.y)/this.scale,f=new b2Vec2(d,e),g=new b2AABB;g.lowerBound.Set(d-.001,e-.001);g.upperBound.Set(d+.001,e+.001);var k=null;this.world.QueryAABB(function(a){return a.GetBody().GetType()!=b2Body.b2_staticBody&&a.GetShape().TestPoint(a.GetBody().GetTransform(),
f)?(k=a.GetBody(),!1):!0},g);return k},deleteBodyAt:function(a,b){if(body=this.getBodyAt(a,b))for(var d=0,e=this.elements.length;d<e;d++)if(this.elements[d].body.m_userData.uid==body.m_userData.uid)return this.removeElementByIndex(d),this.deleteBody(body),!0;return!1},deleteBody:function(a){this.world.DestroyBody(a)},isMouseDown:function(){return null!=this.mouseJoint},removeElementByIndex:function(a){this.elements.splice(a,1)},removeElementByUid:function(a){for(var b=0,d=this.elements.length;b<d;b++)"object"===
typeof this.elements[b]&&"undefined"!==typeof this.elements[b].id&&this.elements[b].id.uid===a&&this.elements.splice(b,1)},applyImpulse:function(a,b,d){a&&a.ApplyLinearImpulse(new b2Vec2(Math.cos(b*CG.Const_PI_180)*d,Math.sin(b*CG.Const_PI_180)*d),a.GetWorldCenter())},addContactListener:function(a){var b=new box2d.b2ContactListener;a.BeginContact&&(b.BeginContact=function(b){a.BeginContact(b.GetFixtureA().GetBody(),b.GetFixtureB().GetBody())});a.EndContact&&(b.EndContact=function(b){a.EndContact(b.GetFixtureA().GetBody(),
b.GetFixtureB().GetBody())});a.PostSolve&&(b.PostSolve=function(b,e){a.PostSolve(b.GetFixtureA().GetBody(),b.GetFixtureB().GetBody(),e.normalImpulses[0])});a.PreSolve&&(b.PreSolve=function(b,e){a.PreSolve(b,e)});this.world.SetContactListener(b)},getBodySpec:function(a){return{x:a.GetPosition().x,y:a.GetPosition().y,a:a.GetAngle(),c:{x:a.GetWorldCenter().x,y:a.GetWorldCenter().y}}}});
(function(a,b){function d(){if(!e.READY){e.event.determineEventTypes();for(var a in e.gestures)e.gestures.hasOwnProperty(a)&&e.detection.register(e.gestures[a]);e.event.onTouch(e.DOCUMENT,e.EVENT_MOVE,e.detection.detect);e.event.onTouch(e.DOCUMENT,e.EVENT_END,e.detection.detect);e.READY=!0}}var e=function(a,b){return new e.Instance(a,b||{})};e.defaults={stop_browser_behavior:{userSelect:"none",touchAction:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};
e.HAS_POINTEREVENTS=navigator.pointerEnabled||navigator.msPointerEnabled;e.HAS_TOUCHEVENTS="ontouchstart"in a;e.MOBILE_REGEX=/mobile|tablet|ip(ad|hone|od)|android/i;e.NO_MOUSEEVENTS=e.HAS_TOUCHEVENTS&&navigator.userAgent.match(e.MOBILE_REGEX);e.EVENT_TYPES={};e.DIRECTION_DOWN="down";e.DIRECTION_LEFT="left";e.DIRECTION_UP="up";e.DIRECTION_RIGHT="right";e.POINTER_MOUSE="mouse";e.POINTER_TOUCH="touch";e.POINTER_PEN="pen";e.EVENT_START="start";e.EVENT_MOVE="move";e.EVENT_END="end";e.DOCUMENT=document;
e.plugins={};e.READY=!1;e.Instance=function(a,b){var f=this;d();this.element=a;this.enabled=!0;this.options=e.utils.extend(e.utils.extend({},e.defaults),b||{});this.options.stop_browser_behavior&&e.utils.stopDefaultBrowserBehavior(this.element,this.options.stop_browser_behavior);e.event.onTouch(a,e.EVENT_START,function(a){f.enabled&&e.detection.startDetect(f,a)});return this};e.Instance.prototype={on:function(a,b){for(var d=a.split(" "),e=0;e<d.length;e++)this.element.addEventListener(d[e],b,!1);
return this},off:function(a,b){for(var d=a.split(" "),e=0;e<d.length;e++)this.element.removeEventListener(d[e],b,!1);return this},trigger:function(a,b){var d=e.DOCUMENT.createEvent("Event");d.initEvent(a,!0,!0);d.gesture=b;var f=this.element;e.utils.hasParent(b.target,f)&&(f=b.target);f.dispatchEvent(d);return this},enable:function(a){this.enabled=a;return this}};var f=null,g=!1,k=!1;e.event={bindDom:function(a,b,d){b=b.split(" ");for(var e=0;e<b.length;e++)a.addEventListener(b[e],d,!1)},onTouch:function(a,
b,d){var s=this;this.bindDom(a,e.EVENT_TYPES[b],function(t){var u=t.type.toLowerCase();if(!u.match(/mouse/)||!k){if(u.match(/touch/)||u.match(/pointerdown/)||u.match(/mouse/)&&1===t.which)g=!0;u.match(/touch|pointer/)&&(k=!0);var v=0;g&&(e.HAS_POINTEREVENTS&&b!=e.EVENT_END?v=e.PointerEvent.updatePointer(b,t):u.match(/touch/)?v=t.touches.length:k||(v=u.match(/up/)?0:1),0<v&&b==e.EVENT_END?b=e.EVENT_MOVE:v||(b=e.EVENT_END),v||null===f?f=t:t=f,d.call(e.detection,s.collectEventData(a,b,t)),e.HAS_POINTEREVENTS&&
b==e.EVENT_END&&(v=e.PointerEvent.updatePointer(b,t)));v||(f=null,k=g=!1,e.PointerEvent.reset())}})},determineEventTypes:function(){var a;a=e.HAS_POINTEREVENTS?e.PointerEvent.getEvents():e.NO_MOUSEEVENTS?["touchstart","touchmove","touchend touchcancel"]:["touchstart mousedown","touchmove mousemove","touchend touchcancel mouseup"];e.EVENT_TYPES[e.EVENT_START]=a[0];e.EVENT_TYPES[e.EVENT_MOVE]=a[1];e.EVENT_TYPES[e.EVENT_END]=a[2]},getTouchList:function(a){return e.HAS_POINTEREVENTS?e.PointerEvent.getTouchList():
a.touches?a.touches:[{identifier:1,pageX:a.pageX,pageY:a.pageY,target:a.target}]},collectEventData:function(a,b,d){a=this.getTouchList(d,b);var f=e.POINTER_TOUCH;if(d.type.match(/mouse/)||e.PointerEvent.matchType(e.POINTER_MOUSE,d))f=e.POINTER_MOUSE;return{center:e.utils.getCenter(a),timeStamp:(new Date).getTime(),target:d.target,touches:a,eventType:b,pointerType:f,srcEvent:d,preventDefault:function(){this.srcEvent.preventManipulation&&this.srcEvent.preventManipulation();this.srcEvent.preventDefault&&
this.srcEvent.preventDefault()},stopPropagation:function(){this.srcEvent.stopPropagation()},stopDetect:function(){return e.detection.stopDetect()}}}};e.PointerEvent={pointers:{},getTouchList:function(){var a=this,b=[];Object.keys(a.pointers).sort().forEach(function(d){b.push(a.pointers[d])});return b},updatePointer:function(a,b){a==e.EVENT_END?this.pointers={}:(b.identifier=b.pointerId,this.pointers[b.pointerId]=b);return Object.keys(this.pointers).length},matchType:function(a,b){if(!b.pointerType)return!1;
var d={};d[e.POINTER_MOUSE]=b.pointerType==b.MSPOINTER_TYPE_MOUSE||b.pointerType==e.POINTER_MOUSE;d[e.POINTER_TOUCH]=b.pointerType==b.MSPOINTER_TYPE_TOUCH||b.pointerType==e.POINTER_TOUCH;d[e.POINTER_PEN]=b.pointerType==b.MSPOINTER_TYPE_PEN||b.pointerType==e.POINTER_PEN;return d[a]},getEvents:function(){return["pointerdown MSPointerDown","pointermove MSPointerMove","pointerup pointercancel MSPointerUp MSPointerCancel"]},reset:function(){this.pointers={}}};e.utils={extend:function(a,d,e){for(var f in d)a[f]!==
b&&e||(a[f]=d[f]);return a},hasParent:function(a,b){for(;a;){if(a==b)return!0;a=a.parentNode}return!1},getCenter:function(a){for(var b=[],d=[],e=0,f=a.length;e<f;e++)b.push(a[e].pageX),d.push(a[e].pageY);return{pageX:(Math.min.apply(Math,b)+Math.max.apply(Math,b))/2,pageY:(Math.min.apply(Math,d)+Math.max.apply(Math,d))/2}},getVelocity:function(a,b,d){return{x:Math.abs(b/a)||0,y:Math.abs(d/a)||0}},getAngle:function(a,b){return 180*Math.atan2(b.pageY-a.pageY,b.pageX-a.pageX)/Math.PI},getDirection:function(a,
b){var d=Math.abs(a.pageX-b.pageX),f=Math.abs(a.pageY-b.pageY);return d>=f?0<a.pageX-b.pageX?e.DIRECTION_LEFT:e.DIRECTION_RIGHT:0<a.pageY-b.pageY?e.DIRECTION_UP:e.DIRECTION_DOWN},getDistance:function(a,b){var d=b.pageX-a.pageX,e=b.pageY-a.pageY;return Math.sqrt(d*d+e*e)},getScale:function(a,b){return 2<=a.length&&2<=b.length?this.getDistance(b[0],b[1])/this.getDistance(a[0],a[1]):1},getRotation:function(a,b){return 2<=a.length&&2<=b.length?this.getAngle(b[1],b[0])-this.getAngle(a[1],a[0]):0},isVertical:function(a){return a==
e.DIRECTION_UP||a==e.DIRECTION_DOWN},stopDefaultBrowserBehavior:function(a,b){var d,e="webkit khtml moz ms o ".split(" ");if(b&&a.style){for(var f=0;f<e.length;f++)for(var g in b)b.hasOwnProperty(g)&&(d=g,e[f]&&(d=e[f]+d.substring(0,1).toUpperCase()+d.substring(1)),a.style[d]=b[g]);"none"==b.userSelect&&(a.onselectstart=function(){return!1})}}};e.detection={gestures:[],current:null,previous:null,stopped:!1,startDetect:function(a,b){this.current||(this.stopped=!1,this.current={inst:a,startEvent:e.utils.extend({},
b),lastEvent:!1,name:""},this.detect(b))},detect:function(a){if(this.current&&!this.stopped){a=this.extendEventData(a);for(var b=this.current.inst.options,d=0,f=this.gestures.length;d<f;d++){var g=this.gestures[d];if(!this.stopped&&!1!==b[g.name]&&!1===g.handler.call(g,a,this.current.inst)){this.stopDetect();break}}this.current&&(this.current.lastEvent=a);a.eventType==e.EVENT_END&&!a.touches.length-1&&this.stopDetect();return a}},stopDetect:function(){this.previous=e.utils.extend({},this.current);
this.current=null;this.stopped=!0},extendEventData:function(a){var b=this.current.startEvent;if(b&&(a.touches.length!=b.touches.length||a.touches===b.touches)){b.touches=[];for(var d=0,f=a.touches.length;d<f;d++)b.touches.push(e.utils.extend({},a.touches[d]))}var d=a.timeStamp-b.timeStamp,f=a.center.pageX-b.center.pageX,g=a.center.pageY-b.center.pageY,k=e.utils.getVelocity(d,f,g);e.utils.extend(a,{deltaTime:d,deltaX:f,deltaY:g,velocityX:k.x,velocityY:k.y,distance:e.utils.getDistance(b.center,a.center),
angle:e.utils.getAngle(b.center,a.center),direction:e.utils.getDirection(b.center,a.center),scale:e.utils.getScale(b.touches,a.touches),rotation:e.utils.getRotation(b.touches,a.touches),startEvent:b});return a},register:function(a){var d=a.defaults||{};d[a.name]===b&&(d[a.name]=!0);e.utils.extend(e.defaults,d,!0);a.index=a.index||1E3;this.gestures.push(a);this.gestures.sort(function(a,b){return a.index<b.index?-1:a.index>b.index?1:0});return this.gestures}};e.gestures=e.gestures||{};e.gestures.Hold=
{name:"hold",index:10,defaults:{hold_timeout:500,hold_threshold:1},timer:null,handler:function(a,b){switch(a.eventType){case e.EVENT_START:clearTimeout(this.timer);e.detection.current.name=this.name;this.timer=setTimeout(function(){"hold"==e.detection.current.name&&b.trigger("hold",a)},b.options.hold_timeout);break;case e.EVENT_MOVE:a.distance>b.options.hold_threshold&&clearTimeout(this.timer);break;case e.EVENT_END:clearTimeout(this.timer)}}};e.gestures.Tap={name:"tap",index:100,defaults:{tap_max_touchtime:250,
tap_max_distance:10,tap_always:!0,doubletap_distance:20,doubletap_interval:300},handler:function(a,b){if(a.eventType==e.EVENT_END){var d=e.detection.previous,f=!1;a.deltaTime>b.options.tap_max_touchtime||a.distance>b.options.tap_max_distance||(d&&"tap"==d.name&&a.timeStamp-d.lastEvent.timeStamp<b.options.doubletap_interval&&a.distance<b.options.doubletap_distance&&(b.trigger("doubletap",a),f=!0),f&&!b.options.tap_always)||(e.detection.current.name="tap",b.trigger(e.detection.current.name,a))}}};e.gestures.Swipe=
{name:"swipe",index:40,defaults:{swipe_max_touches:1,swipe_velocity:.7},handler:function(a,b){a.eventType!=e.EVENT_END||0<b.options.swipe_max_touches&&a.touches.length>b.options.swipe_max_touches||!(a.velocityX>b.options.swipe_velocity||a.velocityY>b.options.swipe_velocity)||(b.trigger(this.name,a),b.trigger(this.name+a.direction,a))}};e.gestures.Drag={name:"drag",index:50,defaults:{drag_min_distance:10,drag_max_touches:1,drag_block_horizontal:!1,drag_block_vertical:!1,drag_lock_to_axis:!1,drag_lock_min_distance:25},
triggered:!1,handler:function(a,b){if(e.detection.current.name!=this.name&&this.triggered)b.trigger(this.name+"end",a),this.triggered=!1;else if(!(0<b.options.drag_max_touches&&a.touches.length>b.options.drag_max_touches))switch(a.eventType){case e.EVENT_START:this.triggered=!1;break;case e.EVENT_MOVE:if(a.distance<b.options.drag_min_distance&&e.detection.current.name!=this.name)break;e.detection.current.name=this.name;if(e.detection.current.lastEvent.drag_locked_to_axis||b.options.drag_lock_to_axis&&
b.options.drag_lock_min_distance<=a.distance)a.drag_locked_to_axis=!0;var d=e.detection.current.lastEvent.direction;a.drag_locked_to_axis&&d!==a.direction&&(e.utils.isVertical(d)?a.direction=0>a.deltaY?e.DIRECTION_UP:e.DIRECTION_DOWN:a.direction=0>a.deltaX?e.DIRECTION_LEFT:e.DIRECTION_RIGHT);this.triggered||(b.trigger(this.name+"start",a),this.triggered=!0);b.trigger(this.name,a);b.trigger(this.name+a.direction,a);(b.options.drag_block_vertical&&e.utils.isVertical(a.direction)||b.options.drag_block_horizontal&&
!e.utils.isVertical(a.direction))&&a.preventDefault();break;case e.EVENT_END:this.triggered&&b.trigger(this.name+"end",a),this.triggered=!1}}};e.gestures.Transform={name:"transform",index:45,defaults:{transform_min_scale:.01,transform_min_rotation:1,transform_always_block:!1},triggered:!1,handler:function(a,b){if(e.detection.current.name!=this.name&&this.triggered)b.trigger(this.name+"end",a),this.triggered=!1;else if(!(2>a.touches.length))switch(b.options.transform_always_block&&a.preventDefault(),
a.eventType){case e.EVENT_START:this.triggered=!1;break;case e.EVENT_MOVE:var d=Math.abs(1-a.scale),f=Math.abs(a.rotation);if(d<b.options.transform_min_scale&&f<b.options.transform_min_rotation)break;e.detection.current.name=this.name;this.triggered||(b.trigger(this.name+"start",a),this.triggered=!0);b.trigger(this.name,a);f>b.options.transform_min_rotation&&b.trigger("rotate",a);d>b.options.transform_min_scale&&(b.trigger("pinch",a),b.trigger("pinch"+(1>a.scale?"in":"out"),a));break;case e.EVENT_END:this.triggered&&
b.trigger(this.name+"end",a),this.triggered=!1}}};e.gestures.Touch={name:"touch",index:-Infinity,defaults:{prevent_default:!1,prevent_mouseevents:!1},handler:function(a,b){b.options.prevent_mouseevents&&a.pointerType==e.POINTER_MOUSE?a.stopDetect():(b.options.prevent_default&&a.preventDefault(),a.eventType==e.EVENT_START&&b.trigger(this.name,a))}};e.gestures.Release={name:"release",index:Infinity,handler:function(a,b){a.eventType==e.EVENT_END&&b.trigger(this.name,a)}};"object"===typeof module&&"object"===
typeof module.exports?module.exports=e:(a.Hammer=e,"function"===typeof a.define&&a.define.amd&&a.define("hammer",[],function(){return e}))})(this);
(function(a,b,d){"undefined"!==typeof module&&module.exports?module.exports=d():"function"===typeof b.define&&b.define.amd?define(a,[],d):b[a]=d()})("buzz",this,function(){var a={defaults:{autoplay:!1,duration:5E3,formats:[],loop:!1,placeholder:"--",preload:"metadata",volume:80,document:document},types:{mp3:"audio/mpeg",ogg:"audio/ogg",wav:"audio/wav",aac:"audio/aac",m4a:"audio/x-m4a"},sounds:[],el:document.createElement("audio"),sound:function(b,d){function e(a){for(var b=[],d=a.length-1,e=0;e<=
d;e++)b.push({start:a.start(e),end:a.end(e)});return b}function f(b,d){var e=g.createElement("source");e.src=d;a.types[d.split(".").pop()]&&(e.type=a.types[d.split(".").pop()]);b.appendChild(e)}d=d||{};var g=d.document||a.defaults.document,k=0,m=[],n={},q=a.isSupported();this.load=function(){if(!q)return this;this.sound.load();return this};this.play=function(){if(!q)return this;this.sound.play();return this};this.togglePlay=function(){if(!q)return this;this.sound.paused?this.sound.play():this.sound.pause();
return this};this.pause=function(){if(!q)return this;this.sound.pause();return this};this.isPaused=function(){return q?this.sound.paused:null};this.stop=function(){if(!q)return this;this.setTime(0);this.sound.pause();return this};this.isEnded=function(){return q?this.sound.ended:null};this.loop=function(){if(!q)return this;this.sound.loop="loop";this.bind("ended.buzzloop",function(){this.currentTime=0;this.play()});return this};this.unloop=function(){if(!q)return this;this.sound.removeAttribute("loop");
this.unbind("ended.buzzloop");return this};this.mute=function(){if(!q)return this;this.sound.muted=!0;return this};this.unmute=function(){if(!q)return this;this.sound.muted=!1;return this};this.toggleMute=function(){if(!q)return this;this.sound.muted=!this.sound.muted;return this};this.isMuted=function(){return q?this.sound.muted:null};this.setVolume=function(a){if(!q)return this;0>a&&(a=0);100<a&&(a=100);this.volume=a;this.sound.volume=a/100;return this};this.getVolume=function(){return q?this.volume:
this};this.increaseVolume=function(a){return this.setVolume(this.volume+(a||1))};this.decreaseVolume=function(a){return this.setVolume(this.volume-(a||1))};this.setTime=function(a){if(!q)return this;var b=!0;this.whenReady(function(){!0===b&&(b=!1,this.sound.currentTime=a)});return this};this.getTime=function(){if(!q)return null;var b=Math.round(100*this.sound.currentTime)/100;return isNaN(b)?a.defaults.placeholder:b};this.setPercent=function(b){return q?this.setTime(a.fromPercent(b,this.sound.duration)):
this};this.getPercent=function(){if(!q)return null;var b=Math.round(a.toPercent(this.sound.currentTime,this.sound.duration));return isNaN(b)?a.defaults.placeholder:b};this.setSpeed=function(a){if(!q)return this;this.sound.playbackRate=a;return this};this.getSpeed=function(){return q?this.sound.playbackRate:null};this.getDuration=function(){if(!q)return null;var b=Math.round(100*this.sound.duration)/100;return isNaN(b)?a.defaults.placeholder:b};this.getPlayed=function(){return q?e(this.sound.played):
null};this.getBuffered=function(){return q?e(this.sound.buffered):null};this.getSeekable=function(){return q?e(this.sound.seekable):null};this.getErrorCode=function(){return q&&this.sound.error?this.sound.error.code:0};this.getErrorMessage=function(){if(!q)return null;switch(this.getErrorCode()){case 1:return"MEDIA_ERR_ABORTED";case 2:return"MEDIA_ERR_NETWORK";case 3:return"MEDIA_ERR_DECODE";case 4:return"MEDIA_ERR_SRC_NOT_SUPPORTED";default:return null}};this.getStateCode=function(){return q?this.sound.readyState:
null};this.getStateMessage=function(){if(!q)return null;switch(this.getStateCode()){case 0:return"HAVE_NOTHING";case 1:return"HAVE_METADATA";case 2:return"HAVE_CURRENT_DATA";case 3:return"HAVE_FUTURE_DATA";case 4:return"HAVE_ENOUGH_DATA";default:return null}};this.getNetworkStateCode=function(){return q?this.sound.networkState:null};this.getNetworkStateMessage=function(){if(!q)return null;switch(this.getNetworkStateCode()){case 0:return"NETWORK_EMPTY";case 1:return"NETWORK_IDLE";case 2:return"NETWORK_LOADING";
case 3:return"NETWORK_NO_SOURCE";default:return null}};this.set=function(a,b){if(!q)return this;this.sound[a]=b;return this};this.get=function(a){return q?a?this.sound[a]:this.sound:null};this.bind=function(a,b){if(!q)return this;a=a.split(" ");for(var d=this,e=function(a){b.call(d,a)},f=0;f<a.length;f++){var g=a[f],k=g,g=k.split(".")[0];m.push({idx:k,func:e});this.sound.addEventListener(g,e,!0)}return this};this.unbind=function(a){if(!q)return this;a=a.split(" ");for(var b=0;b<a.length;b++)for(var d=
a[b],e=d.split(".")[0],f=0;f<m.length;f++){var g=m[f].idx.split(".");if(m[f].idx==d||g[1]&&g[1]==d.replace(".",""))this.sound.removeEventListener(e,m[f].func,!0),m.splice(f,1)}return this};this.bindOnce=function(a,b){if(!q)return this;var d=this;n[k++]=!1;this.bind(a+"."+k,function(){n[k]||(n[k]=!0,b.call(d));d.unbind(a+"."+k)});return this};this.trigger=function(a){if(!q)return this;a=a.split(" ");for(var b=0;b<a.length;b++)for(var d=a[b],e=0;e<m.length;e++){var f=m[e].idx.split(".");if(m[e].idx==
d||f[0]&&f[0]==d.replace(".","")){var k=g.createEvent("HTMLEvents");k.initEvent(f[0],!1,!0);this.sound.dispatchEvent(k)}}return this};this.fadeTo=function(b,d,e){function f(){setTimeout(function(){g<b&&m.volume<b?(m.setVolume(m.volume+=1),f()):g>b&&m.volume>b?(m.setVolume(m.volume-=1),f()):e instanceof Function&&e.apply(m)},k)}if(!q)return this;d instanceof Function?(e=d,d=a.defaults.duration):d=d||a.defaults.duration;var g=this.volume,k=d/Math.abs(g-b),m=this;this.play();this.whenReady(function(){f()});
return this};this.fadeIn=function(a,b){return q?this.setVolume(0).fadeTo(100,a,b):this};this.fadeOut=function(a,b){return q?this.fadeTo(0,a,b):this};this.fadeWith=function(a,b){if(!q)return this;this.fadeOut(b,function(){this.stop()});a.play().fadeIn(b);return this};this.whenReady=function(a){if(!q)return null;var b=this;0===this.sound.readyState?this.bind("canplay.buzzwhenready",function(){a.call(b)}):a.call(b)};if(q&&b){for(var s in a.defaults)a.defaults.hasOwnProperty(s)&&(d[s]=d[s]||a.defaults[s]);
this.sound=g.createElement("audio");if(b instanceof Array)for(var t in b)b.hasOwnProperty(t)&&f(this.sound,b[t]);else if(d.formats.length)for(var u in d.formats)d.formats.hasOwnProperty(u)&&f(this.sound,b+"."+d.formats[u]);else f(this.sound,b);d.loop&&this.loop();d.autoplay&&(this.sound.autoplay="autoplay");this.sound.preload=!0===d.preload?"auto":!1===d.preload?"none":d.preload;this.setVolume(d.volume);a.sounds.push(this)}},group:function(a){function d(){for(var d=e(null,arguments),g=d.shift(),k=
0;k<a.length;k++)a[k][g].apply(a[k],d)}function e(a,b){return a instanceof Array?a:Array.prototype.slice.call(b)}a=e(a,arguments);this.getSounds=function(){return a};this.add=function(d){d=e(d,arguments);for(var g=0;g<d.length;g++)a.push(d[g])};this.remove=function(d){d=e(d,arguments);for(var g=0;g<d.length;g++)for(var k=0;k<a.length;k++)if(a[k]==d[g]){a.splice(k,1);break}};this.load=function(){d("load");return this};this.play=function(){d("play");return this};this.togglePlay=function(){d("togglePlay");
return this};this.pause=function(a){d("pause",a);return this};this.stop=function(){d("stop");return this};this.mute=function(){d("mute");return this};this.unmute=function(){d("unmute");return this};this.toggleMute=function(){d("toggleMute");return this};this.setVolume=function(a){d("setVolume",a);return this};this.increaseVolume=function(a){d("increaseVolume",a);return this};this.decreaseVolume=function(a){d("decreaseVolume",a);return this};this.loop=function(){d("loop");return this};this.unloop=
function(){d("unloop");return this};this.setTime=function(a){d("setTime",a);return this};this.set=function(a,b){d("set",a,b);return this};this.bind=function(a,b){d("bind",a,b);return this};this.unbind=function(a){d("unbind",a);return this};this.bindOnce=function(a,b){d("bindOnce",a,b);return this};this.trigger=function(a){d("trigger",a);return this};this.fade=function(a,b,e,m){d("fade",a,b,e,m);return this};this.fadeIn=function(a,b){d("fadeIn",a,b);return this};this.fadeOut=function(a,b){d("fadeOut",
a,b);return this}},all:function(){return new a.group(a.sounds)},isSupported:function(){return!!a.el.canPlayType},isOGGSupported:function(){return!!a.el.canPlayType&&a.el.canPlayType('audio/ogg; codecs="vorbis"')},isWAVSupported:function(){return!!a.el.canPlayType&&a.el.canPlayType('audio/wav; codecs="1"')},isMP3Supported:function(){return!!a.el.canPlayType&&a.el.canPlayType("audio/mpeg;")},isAACSupported:function(){return!!a.el.canPlayType&&(a.el.canPlayType("audio/x-m4a;")||a.el.canPlayType("audio/aac;"))},
toTimer:function(a,d){var e,f,g;e=Math.floor(a/3600);e=isNaN(e)?"--":10<=e?e:"0"+e;f=d?Math.floor(a/60%60):Math.floor(a/60);f=isNaN(f)?"--":10<=f?f:"0"+f;g=Math.floor(a%60);g=isNaN(g)?"--":10<=g?g:"0"+g;return d?e+":"+f+":"+g:f+":"+g},fromTimer:function(a){var d=a.toString().split(":");d&&3==d.length&&(a=3600*parseInt(d[0],10)+60*parseInt(d[1],10)+parseInt(d[2],10));d&&2==d.length&&(a=60*parseInt(d[0],10)+parseInt(d[1],10));return a},toPercent:function(a,d,e){e=Math.pow(10,e||0);return Math.round(100*
a/d*e)/e},fromPercent:function(a,d,e){e=Math.pow(10,e||0);return Math.round(d/100*a*e)/e}};return a});
var Stats=function(){var a=Date.now(),b=a,d=0,e=Infinity,f=0,g=0,k=Infinity,m=0,n=0,q=0,s=document.createElement("div");s.id="stats";s.addEventListener("mousedown",function(a){a.preventDefault();D(++q%2)},!1);s.style.cssText="width:80px;opacity:0.9;cursor:pointer";var t=document.createElement("div");t.id="fps";t.style.cssText="padding:0 0 3px 3px;text-align:left;background-color:#002";s.appendChild(t);var u=document.createElement("div");u.id="fpsText";u.style.cssText="color:#0ff;font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px";
u.innerHTML="FPS";t.appendChild(u);var v=document.createElement("div");v.id="fpsGraph";v.style.cssText="position:relative;width:74px;height:30px;background-color:#0ff";for(t.appendChild(v);74>v.children.length;){var y=document.createElement("span");y.style.cssText="width:1px;height:30px;float:left;background-color:#113";v.appendChild(y)}var z=document.createElement("div");z.id="ms";z.style.cssText="padding:0 0 3px 3px;text-align:left;background-color:#020;display:none";s.appendChild(z);var A=document.createElement("div");
A.id="msText";A.style.cssText="color:#0f0;font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px";A.innerHTML="MS";z.appendChild(A);var r=document.createElement("div");r.id="msGraph";r.style.cssText="position:relative;width:74px;height:30px;background-color:#0f0";for(z.appendChild(r);74>r.children.length;)y=document.createElement("span"),y.style.cssText="width:1px;height:30px;float:left;background-color:#131",r.appendChild(y);var D=function(a){q=a;switch(q){case 0:t.style.display=
"block";z.style.display="none";break;case 1:t.style.display="none",z.style.display="block"}};return{REVISION:11,domElement:s,setMode:D,begin:function(){a=Date.now()},end:function(){var q=Date.now();d=q-a;e=Math.min(e,d);f=Math.max(f,d);A.textContent=d+" MS ("+e+"-"+f+")";var s=Math.min(30,30-d/200*30);r.appendChild(r.firstChild).style.height=s+"px";n++;q>b+1E3&&(g=Math.round(1E3*n/(q-b)),k=Math.min(k,g),m=Math.max(m,g),u.textContent=g+" FPS ("+k+"-"+m+")",s=Math.min(30,30-g/100*30),v.appendChild(v.firstChild).style.height=
s+"px",b=q,n=0);return q},update:function(){a=this.end()}}};
