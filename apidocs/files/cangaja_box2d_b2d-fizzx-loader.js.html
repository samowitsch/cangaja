<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>cangaja&#x2F;box2d&#x2F;b2d-fizzx-loader.js - Cangaja API</title>
    <link rel="stylesheet" href="http:&#x2F;&#x2F;yui.yahooapis.com&#x2F;3.8.0&#x2F;build&#x2F;cssgrids&#x2F;cssgrids-min.css">
    <link rel="stylesheet" href="..&#x2F;assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="..&#x2F;assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="..&#x2F;assets/favicon.png">
    <script src="http:&#x2F;&#x2F;yui.yahooapis.com&#x2F;combo?3.8.0&#x2F;build&#x2F;yui&#x2F;yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="..&#x2F;assets/css/logo.png" title="Cangaja API"></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 0.1.0</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="..&#x2F;classes/Cangaja.html">Cangaja</a></li>
            
                <li><a href="..&#x2F;classes/CG.Animation.html">CG.Animation</a></li>
            
                <li><a href="..&#x2F;classes/CG.AtlasImage.html">CG.AtlasImage</a></li>
            
                <li><a href="..&#x2F;classes/CG.AtlasTexturePacker.html">CG.AtlasTexturePacker</a></li>
            
                <li><a href="..&#x2F;classes/CG.B2DBridge.html">CG.B2DBridge</a></li>
            
                <li><a href="..&#x2F;classes/CG.B2DChainShape.html">CG.B2DChainShape</a></li>
            
                <li><a href="..&#x2F;classes/CG.B2DCirlce.html">CG.B2DCirlce</a></li>
            
                <li><a href="..&#x2F;classes/CG.B2DEntity.html">CG.B2DEntity</a></li>
            
                <li><a href="..&#x2F;classes/CG.B2DFizzXLoader.html">CG.B2DFizzXLoader</a></li>
            
                <li><a href="..&#x2F;classes/CG.B2DLine.html">CG.B2DLine</a></li>
            
                <li><a href="..&#x2F;classes/CG.B2DPolygon.html">CG.B2DPolygon</a></li>
            
                <li><a href="..&#x2F;classes/CG.B2DRectangle.html">CG.B2DRectangle</a></li>
            
                <li><a href="..&#x2F;classes/CG.B2DRope.html">CG.B2DRope</a></li>
            
                <li><a href="..&#x2F;classes/CG.B2DTerrain.html">CG.B2DTerrain</a></li>
            
                <li><a href="..&#x2F;classes/CG.B2DWorld.html">CG.B2DWorld</a></li>
            
                <li><a href="..&#x2F;classes/CG.Bitmap.html">CG.Bitmap</a></li>
            
                <li><a href="..&#x2F;classes/CG.Bound.html">CG.Bound</a></li>
            
                <li><a href="..&#x2F;classes/CG.Buffer.html">CG.Buffer</a></li>
            
                <li><a href="..&#x2F;classes/CG.Button.html">CG.Button</a></li>
            
                <li><a href="..&#x2F;classes/CG.CanvasRenderer.html">CG.CanvasRenderer</a></li>
            
                <li><a href="..&#x2F;classes/CG.Delta.html">CG.Delta</a></li>
            
                <li><a href="..&#x2F;classes/CG.Director.html">CG.Director</a></li>
            
                <li><a href="..&#x2F;classes/CG.Emitter.html">CG.Emitter</a></li>
            
                <li><a href="..&#x2F;classes/CG.Entity.html">CG.Entity</a></li>
            
                <li><a href="..&#x2F;classes/CG.Font.html">CG.Font</a></li>
            
                <li><a href="..&#x2F;classes/CG.Game.html">CG.Game</a></li>
            
                <li><a href="..&#x2F;classes/CG.Layer.html">CG.Layer</a></li>
            
                <li><a href="..&#x2F;classes/CG.Map.html">CG.Map</a></li>
            
                <li><a href="..&#x2F;classes/CG.MapArea.html">CG.MapArea</a></li>
            
                <li><a href="..&#x2F;classes/CG.MapPoint.html">CG.MapPoint</a></li>
            
                <li><a href="..&#x2F;classes/CG.MapTileLayer.html">CG.MapTileLayer</a></li>
            
                <li><a href="..&#x2F;classes/CG.MapTileProperties.html">CG.MapTileProperties</a></li>
            
                <li><a href="..&#x2F;classes/CG.MediaAsset.html">CG.MediaAsset</a></li>
            
                <li><a href="..&#x2F;classes/CG.Menu.html">CG.Menu</a></li>
            
                <li><a href="..&#x2F;classes/CG.Morph.html">CG.Morph</a></li>
            
                <li><a href="..&#x2F;classes/CG.Particle.html">CG.Particle</a></li>
            
                <li><a href="..&#x2F;classes/CG.Point.html">CG.Point</a></li>
            
                <li><a href="..&#x2F;classes/CG.Screen.html">CG.Screen</a></li>
            
                <li><a href="..&#x2F;classes/CG.Sequence.html">CG.Sequence</a></li>
            
                <li><a href="..&#x2F;classes/CG.SpineAnimation.html">CG.SpineAnimation</a></li>
            
                <li><a href="..&#x2F;classes/CG.Sprite.html">CG.Sprite</a></li>
            
                <li><a href="..&#x2F;classes/CG.Text.html">CG.Text</a></li>
            
                <li><a href="..&#x2F;classes/CG.Translate.html">CG.Translate</a></li>
            
                <li><a href="..&#x2F;classes/CG.Vector.html">CG.Vector</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
                <li><a href="..&#x2F;modules/CG.html">CG</a></li>
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: cangaja&#x2F;box2d&#x2F;b2d-fizzx-loader.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
&#x2F;**
 * @description
 *
 * CG.B2DFizzXLoader
 *
 * @class CG.B2DFizzXLoader
 * @extends CG.Class
 *&#x2F;

CG.Class.extend(&#x27;B2DFizzXLoader&#x27;, {
    &#x2F;**
     * @constructor
     * @method init
     * @param json {string}
     * @param world {CG.B2DWorld}
     * @param offsetx {Number}
     * @param offsety {Number}
     *&#x2F;
    init: function (json, world, offsetx, offsety) {
        &#x2F;**
         @property json {string}
         *&#x2F;
        this.json = JSON.parse(json, function (key, value) {
            if (typeof value === &quot;string&quot;) {
                if (value.match(&#x2F;^[-+]?\d+$&#x2F;)) {      &#x2F;&#x2F;check for integer
                    return parseInt(value)
                } else if (value.match(&#x2F;^[-+]?\d+\.\d+$&#x2F;)) {   &#x2F;&#x2F;check for float
                    return parseFloat(value)
                } else {      &#x2F;&#x2F;strings
                    switch (value) {
                        case &quot;true&quot;:
                            return true
                            break
                        case &quot;false&quot;:
                            return false
                            break
                        case &quot;null&quot;:
                            return null
                            break
                    }
                }
            }
            return value
        })
        &#x2F;**
         @property world {CG.B2DWorld}
         *&#x2F;
        this.world = world
        &#x2F;**
         @property offsetx {Number}
         *&#x2F;
        this.offsetx = offsetx
        &#x2F;**
         @property offsety {Number}
         *&#x2F;
        this.offsety = offsety

        this.bodiesMap = []
        this.jointsMap = []
        this.imageMap = []
        this.atlasMap = []

        this.loadImages()
        this.loadBodies()
        this.loadJoints()
    },
    &#x2F;**
     * @description
     * @method loadBodies
     *&#x2F;
    loadBodies: function () {
        console.log(&#x27;### start bodies&#x27;)
        for (var b = 0, lb = this.json.box2d.bodies.body.length; b &lt; lb; b++) {
            var body = this.json.box2d.bodies.body[b]
            console.log(&#x27;body:&#x27;, body.name, &#x27;image:&#x27;, body.image, body)
            var fixtures = body.fixtures.fixture
            console.log(&#x27;-- fixtures&#x27;, fixtures.length)
            for (var f = 0, fl = fixtures.length; f &lt; fl; f++) {
                console.log(&#x27;--- fixture #&#x27; + (f + 1), fixtures[f])
            }

        }

    },
    &#x2F;**
     * @description is this method needed? use MediaAsset loader instead or extend MediaAsset with in game &quot;preloading&quot;?
     * @method loadImages
     *&#x2F;
    loadImages: function () {
        console.log(&#x27;### start images&#x27;)
        for (var i = 0, li = this.json.box2d.images.image.length; i &lt; li; i++) {
            var image = this.json.box2d.images.image[i]
            console.log(&#x27;-- image #&#x27; + ( i + 1 ), image)
        }
    },
    &#x2F;**
     * @description
     * @method loadJoints
     *&#x2F;
    loadJoints: function () {
        console.log(&#x27;### start joints&#x27;)
        for (var j = 0, lj = this.json.box2d.joints.joint.length; j &lt; lj; j++) {
            var joint = this.json.box2d.joints.joint[j]
            console.log(&#x27;-- joint #&#x27; + (j + 1), joint)
        }
    }
})

&#x2F;*

&#x2F;&#x2F;Example is using LibGDX with the Artemis Entity System Framework
public class FizzXLoader {

    public float BOX_WORLD_TO = 30f;
    HashMap bodiesMap;
    HashMap jointsMap;
    HashMap imageMap;
    HashMap atlasMap;

    public void load(String path, World world, float xOffset, float yOffset) {
        FileHandle fileHandle = Gdx.files.internal(path);

        JsonReader reader = new JsonReader();
        JsonValue map = reader.parse(fileHandle);
        bodiesMap = new HashMap();
        jointsMap = new HashMap();
        imageMap = new HashMap();
        atlasMap = new HashMap();

        JsonValue box2dEntry = map.getChild(&quot;box2D&quot;);

        for (JsonValue entry = box2dEntry; entry != null; entry = entry.next()) {

            if (entry.name.equals(&quot;images&quot;)) {

                JsonValue joints = entry.getChild(&quot;image&quot;);
                for (JsonValue jointJsonValue = joints; jointJsonValue != null; jointJsonValue = jointJsonValue
                    .next()) {
                    JsonValue pathJsonValue = jointJsonValue.get(&quot;-path&quot;);
                    JsonValue nameJsonValue = jointJsonValue.get(&quot;-name&quot;);
                    JsonValue atlasJsonValue = jointJsonValue.get(&quot;-atlas&quot;);
                    String atlasString = atlasJsonValue.asString();
                    if (!atlasString.equals(&quot;null&quot;)) {
                        TextureAtlas textureAtlas = new TextureAtlas(
                            Gdx.files.internal(&quot;data&#x2F;&quot;
                                + atlasJsonValue.asString() + &quot;.txt&quot;));
                        String[] splitName = pathJsonValue.asString().split(
                            &quot;\\.&quot;);
                        atlasMap.put(splitName[0], textureAtlas);
                    }

                    imageMap.put(nameJsonValue.asString(),
                        pathJsonValue.asString());
                }
            }

            else if (entry.name.equals(&quot;bodies&quot;)) {
                JsonValue bodies = entry.getChild(&quot;body&quot;);
                for (JsonValue bodyJsonValue = bodies; bodyJsonValue != null; bodyJsonValue = bodyJsonValue
                    .next()) {
                    Float xValue = bodyJsonValue.getFloat(&quot;-x&quot;);
                    Float yValue = bodyJsonValue.getFloat(&quot;-y&quot;);
                    String typeValue = bodyJsonValue.getString(&quot;-type&quot;);
                    boolean bulletValue = bodyJsonValue.getBoolean(&quot;-bullet&quot;);
                    String nameValue = bodyJsonValue.getString(&quot;-name&quot;);
                    String imagePath = bodyJsonValue.getString(&quot;-image&quot;);

                    imageMap.put(nameValue, imagePath);
                    JsonValue fixturesValue = bodyJsonValue
                        .getChild(&quot;fixtures&quot;);

                    BodyDef bodyDef = new BodyDef();

                    bodyDef.bullet = bulletValue;
                    bodyDef.position.x = xValue &#x2F; BOX_WORLD_TO + xOffset;
                    bodyDef.position.y = yValue &#x2F; BOX_WORLD_TO + yOffset;

                    if (typeValue.equals(&quot;kinematic&quot;)) {
                        bodyDef.type = BodyType.KinematicBody;
                    } else if (typeValue.equals(&quot;static&quot;)) {
                        bodyDef.type = BodyType.StaticBody;
                    } else if (typeValue.equals(&quot;dynamic&quot;)) {
                        bodyDef.type = BodyType.DynamicBody;
                    }

                    Entity entity = world.createEntity();
                    world.getManager(TagManager.class).register(nameValue,
                        entity);
                    SpatialComponent component = PhysicsFactory
                        .createBody(bodyDef);

                    entity.addComponent(component);
                    if (!imagePath.equals(&quot;null&quot;)) {
                        String[] splitName = imagePath.split(&quot;\\.&quot;);

                        if (atlasMap.containsKey(splitName[0])) {
                            TextureComponent textureComponent = new TextureComponent(
                                atlasMap.get(splitName[0]).findRegion(
                                    splitName[0]), new Vector2(0, 0));
                            entity.addComponent(textureComponent);
                        }
                    }

                    entity.addToWorld();
                    component.name = nameValue;
                    bodiesMap.put(nameValue, component.body);

                    JsonValue fixtureEntry = fixturesValue.child();

                    for (JsonValue fixture = fixtureEntry; fixture != null; fixture = fixture
                        .next()) {
                        String fixtureName = fixture.getString(&quot;-name&quot;);
                        String shapeType = fixture.getString(&quot;-shapeType&quot;);
                        float friction = fixture.getFloat(&quot;-friction&quot;);
                        float restitution = fixture.getFloat(&quot;-restitution&quot;);
                        float density = fixture.getFloat(&quot;-density&quot;);

                        JsonValue vertexValue = fixture.getChild(&quot;vertex&quot;);
                        FixtureDef fixtureDef = new FixtureDef();
                        fixtureDef.density = density;
                        fixtureDef.restitution = restitution;
                        fixtureDef.friction = friction;

                        Shape shape = null;
                        if (shapeType.equals(&quot;polygonShape&quot;)) {
                            ArrayList verticesList = new ArrayList();

                            JsonValue vertexEntry = vertexValue;

                            if (vertexEntry != null) {

                                for (JsonValue vertex = vertexEntry; vertex != null; vertex = vertex
                                    .next()) {

                                    Float vertexX = vertex.getFloat(&quot;-x&quot;);
                                    Float vertexY = vertex.getFloat(&quot;-y&quot;);

                                    Vector2 vector2 = new Vector2();
                                    vector2.x = vertexX &#x2F; BOX_WORLD_TO;
                                    vector2.y = vertexY &#x2F; BOX_WORLD_TO;

                                    verticesList.add(vector2);

                                }
                            }

                            shape = new PolygonShape();

                            Vector2[] vertices = new Vector2[verticesList
                                .size()];
                            vertices = verticesList.toArray(vertices);

                            float[] floatVertices = new float[vertices.length * 2];

                            ((PolygonShape) shape).set(vertices);

                            fixtureDef.isSensor = fixture
                                .getBoolean(&quot;-isSensor&quot;);

                        } else if (shapeType.equals(&quot;edgeShape&quot;)) {
                            shape = new ChainShape();

                            ArrayList verticesList = new ArrayList();

                            JsonValue vertexEntry = vertexValue;

                            if (vertexEntry != null) {

                                for (JsonValue vertex = vertexEntry; vertex != null; vertex = vertex
                                    .next()) {
                                    JsonValue vertexX = vertex.get(&quot;-x&quot;);
                                    JsonValue vertexY = vertex.get(&quot;-y&quot;);

                                    Vector2 vector2 = new Vector2();
                                    vector2.x = vertexX.asFloat()
                                        &#x2F; BOX_WORLD_TO;
                                    vector2.y = vertexY.asFloat()
                                        &#x2F; BOX_WORLD_TO;

                                    verticesList.add(vector2);

                                }
                            }

                            Vector2[] vertices = new Vector2[verticesList
                                .size()];
                            vertices = verticesList.toArray(vertices);

                            ((ChainShape) shape).createChain(vertices);

                        } else if (shapeType.equals(&quot;circleShape&quot;)) {
                            shape = new CircleShape();
                            JsonValue circleRadiusJsonValue = fixture
                                .get(&quot;-circleRadius&quot;);
                            ((CircleShape) shape)
                        .setRadius(circleRadiusJsonValue.asFloat()
                                &#x2F; BOX_WORLD_TO);

                            float circleX = fixture.getFloat(&quot;-circleX&quot;);
                            float circleY = fixture.getFloat(&quot;-circleY&quot;);

                            ((CircleShape) shape).setPosition(new Vector2(
                                circleX &#x2F; BOX_WORLD_TO, circleY
                                    &#x2F; BOX_WORLD_TO));
                            fixtureDef.isSensor = fixture
                                .getBoolean(&quot;-isSensor&quot;);

                        }

                        fixtureDef.shape = shape;
                        PhysicsFactory.createFixture(fixtureDef, component);
                    }

                }
            } else if (entry.name.equals(&quot;joints&quot;)) {

                JsonValue joints = entry.getChild(&quot;joint&quot;);
                for (JsonValue jointJsonValue = joints; jointJsonValue != null; jointJsonValue = jointJsonValue
                    .next()) {
                    JsonValue nameJsonValue = jointJsonValue.get(&quot;-name&quot;);
                    JsonValue typeJsonValue = jointJsonValue.get(&quot;-type&quot;);
                    JsonValue collideConnected = jointJsonValue
                        .get(&quot;-collideConnected&quot;);
                    JsonValue xJsonValue = jointJsonValue.get(&quot;-x&quot;);
                    JsonValue yJsonValue = jointJsonValue.get(&quot;-y&quot;);
                    JsonValue bodyAJsonValue = jointJsonValue.get(&quot;-bodyA&quot;);
                    JsonValue bodyBJsonValue = jointJsonValue.get(&quot;-bodyB&quot;);

                    JointDef jointDef = null;
                    if (typeJsonValue.asString().equals(&quot;RevoluteJoint&quot;)) {
                        jointDef = new RevoluteJointDef();
                        RevoluteJointDef revoluteJointDef = (RevoluteJointDef) jointDef;

                        Body bodyA = bodiesMap.get(bodyAJsonValue.asString());
                        Body bodyB = bodiesMap.get(bodyBJsonValue.asString());

                        JsonValue enableLimit = jointJsonValue
                            .get(&quot;-enableLimit&quot;);
                        JsonValue lowerAngle = jointJsonValue
                            .get(&quot;-lowerAngle&quot;);
                        JsonValue upperAngle = jointJsonValue
                            .get(&quot;-upperAngle&quot;);

                        revoluteJointDef.enableLimit = enableLimit.asBoolean();
                        revoluteJointDef.lowerAngle = lowerAngle.asFloat();
                        revoluteJointDef.upperAngle = upperAngle.asFloat();

                        Vector2 anchor = new Vector2(xJsonValue.asFloat()
                            &#x2F; BOX_WORLD_TO, yJsonValue.asFloat()
                            &#x2F; BOX_WORLD_TO);
                        revoluteJointDef.initialize(bodyA, bodyB, anchor);

                    } else if (typeJsonValue.asString().equals(&quot;WeldJoint&quot;)) {
                        jointDef = new WeldJointDef();
                        WeldJointDef weldJointDef = (WeldJointDef) jointDef;

                        Body bodyA = bodiesMap.get(bodyAJsonValue.asString());
                        Body bodyB = bodiesMap.get(bodyBJsonValue.asString());
                        Vector2 anchor = new Vector2(xJsonValue.asFloat()
                            &#x2F; BOX_WORLD_TO, yJsonValue.asFloat()
                            &#x2F; BOX_WORLD_TO);
                        weldJointDef.initialize(bodyA, bodyB, anchor);

                    }

                    jointDef.collideConnected = collideConnected.asBoolean();

                    Joint joint = PhysicsFactory.createJoint(jointDef);

                    jointsMap.put(nameJsonValue.asString(), joint);
                }

            }

        }
    }
}
*&#x2F;


    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="..&#x2F;assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="..&#x2F;assets/js/yui-prettify.js"></script>
<script src="..&#x2F;assets/../api.js"></script>
<script src="..&#x2F;assets/js/api-filter.js"></script>
<script src="..&#x2F;assets/js/api-list.js"></script>
<script src="..&#x2F;assets/js/api-search.js"></script>
<script src="..&#x2F;assets/js/apidocs.js"></script>
</body>
</html>
