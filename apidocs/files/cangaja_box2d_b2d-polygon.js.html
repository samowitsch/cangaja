<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>cangaja/box2d/b2d-polygon.js - Cangaja API</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
                <h1><img src="../assets/css/logo.png" title="Cangaja API"></h1>
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 0.1.0</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
                    <h2 class="off-left">APIs</h2>
                    <div id="api-tabview" class="tabview">
                        <ul class="tabs">
                            <li><a href="#api-classes">Classes</a></li>
                            <li><a href="#api-modules">Modules</a></li>
                        </ul>
                
                        <div id="api-tabview-filter">
                            <input type="search" id="api-filter" placeholder="Type to filter APIs">
                        </div>
                
                        <div id="api-tabview-panel">
                            <ul id="api-classes" class="apis classes">
                                <li><a href="../classes/Cangaja.html">Cangaja</a></li>
                                <li><a href="../classes/CG.Animation.html">CG.Animation</a></li>
                                <li><a href="../classes/CG.AtlasImage.html">CG.AtlasImage</a></li>
                                <li><a href="../classes/CG.AtlasTexturePacker.html">CG.AtlasTexturePacker</a></li>
                                <li><a href="../classes/CG.B2DBridge.html">CG.B2DBridge</a></li>
                                <li><a href="../classes/CG.B2DChainShape.html">CG.B2DChainShape</a></li>
                                <li><a href="../classes/CG.B2DCirlce.html">CG.B2DCirlce</a></li>
                                <li><a href="../classes/CG.B2DEntity.html">CG.B2DEntity</a></li>
                                <li><a href="../classes/CG.B2DFizzXLoader.html">CG.B2DFizzXLoader</a></li>
                                <li><a href="../classes/CG.B2DLine.html">CG.B2DLine</a></li>
                                <li><a href="../classes/CG.B2DPolygon.html">CG.B2DPolygon</a></li>
                                <li><a href="../classes/CG.B2DRectangle.html">CG.B2DRectangle</a></li>
                                <li><a href="../classes/CG.B2DRope.html">CG.B2DRope</a></li>
                                <li><a href="../classes/CG.B2DTerrain.html">CG.B2DTerrain</a></li>
                                <li><a href="../classes/CG.B2DWorld.html">CG.B2DWorld</a></li>
                                <li><a href="../classes/CG.Bitmap.html">CG.Bitmap</a></li>
                                <li><a href="../classes/CG.Bound.html">CG.Bound</a></li>
                                <li><a href="../classes/CG.Buffer.html">CG.Buffer</a></li>
                                <li><a href="../classes/CG.Button.html">CG.Button</a></li>
                                <li><a href="../classes/CG.CanvasRenderer.html">CG.CanvasRenderer</a></li>
                                <li><a href="../classes/CG.Delta.html">CG.Delta</a></li>
                                <li><a href="../classes/CG.Director.html">CG.Director</a></li>
                                <li><a href="../classes/CG.Emitter.html">CG.Emitter</a></li>
                                <li><a href="../classes/CG.Entity.html">CG.Entity</a></li>
                                <li><a href="../classes/CG.Font.html">CG.Font</a></li>
                                <li><a href="../classes/CG.Game.html">CG.Game</a></li>
                                <li><a href="../classes/CG.GameController.html">CG.GameController</a></li>
                                <li><a href="../classes/CG.Layer.html">CG.Layer</a></li>
                                <li><a href="../classes/CG.Map.html">CG.Map</a></li>
                                <li><a href="../classes/CG.MapArea.html">CG.MapArea</a></li>
                                <li><a href="../classes/CG.MapPoint.html">CG.MapPoint</a></li>
                                <li><a href="../classes/CG.MapTileLayer.html">CG.MapTileLayer</a></li>
                                <li><a href="../classes/CG.MapTileProperties.html">CG.MapTileProperties</a></li>
                                <li><a href="../classes/CG.MediaAsset.html">CG.MediaAsset</a></li>
                                <li><a href="../classes/CG.Menu.html">CG.Menu</a></li>
                                <li><a href="../classes/CG.Morph.html">CG.Morph</a></li>
                                <li><a href="../classes/CG.Particle.html">CG.Particle</a></li>
                                <li><a href="../classes/CG.Point.html">CG.Point</a></li>
                                <li><a href="../classes/CG.Screen.html">CG.Screen</a></li>
                                <li><a href="../classes/CG.Sequence.html">CG.Sequence</a></li>
                                <li><a href="../classes/CG.SpineAnimation.html">CG.SpineAnimation</a></li>
                                <li><a href="../classes/CG.Sprite.html">CG.Sprite</a></li>
                                <li><a href="../classes/CG.Stick.html">CG.Stick</a></li>
                                <li><a href="../classes/CG.Text.html">CG.Text</a></li>
                                <li><a href="../classes/CG.Translate.html">CG.Translate</a></li>
                                <li><a href="../classes/CG.Vector.html">CG.Vector</a></li>
                            </ul>
                
                            <ul id="api-modules" class="apis modules">
                                <li><a href="../modules/CG.html">CG</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
                    Show:
                    <label for="api-show-inherited">
                        <input type="checkbox" id="api-show-inherited" checked>
                        Inherited
                    </label>
            
                    <label for="api-show-protected">
                        <input type="checkbox" id="api-show-protected">
                        Protected
                    </label>
            
                    <label for="api-show-private">
                        <input type="checkbox" id="api-show-private">
                        Private
                    </label>
                    <label for="api-show-deprecated">
                        <input type="checkbox" id="api-show-deprecated">
                        Deprecated
                    </label>
            
                </div>
            
            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: cangaja/box2d/b2d-polygon.js</h1>
                        
                        <div class="file">
                            <pre class="code prettyprint linenums">
                        /**
                         * @description
                         *
                         * B2DPolygon  is a simple b2PolygonShape wrapper element with basic physics properties.
                         * It uses PhysicsEditor json files, use export Lime + Corona (json).
                         * Supported options for now are friction, density and bounce and would be set to B2DPolygon.
                         *
                        
                         &#x60;&#x60;&#x60;
                        
                         var e = new CG.B2DPolygon({
                            name: &#x27;player&#x27;,
                            image: this.asset.getImageByName(&#x27;glowball&#x27;),
                            texturepacker: this.asset.getJsonByName(&#x27;powerstar75&#x27;),
                            x: 100,
                            y: 100,
                            world: b2world,
                            scale: 40,
                            bodyType: box2d.b2BodyType.b2_staticBody,
                            bullet: false
                         })
                        
                         &#x60;&#x60;&#x60;
                        
                         *
                         * @class CG.B2DPolygon
                         * @extends CG.B2DEntity
                         */
                        
                        CG.B2DEntity.extend(&#x27;B2DPolygon&#x27;, {
                            /**
                             * Options:
                             * name {string}
                             * image {mixed}
                             * texturepacker {string}
                             * x {number}
                             * y (number}
                             * world {object}
                             * scale {number}
                             * bodyType {box2d.b2BodyType}
                             * bullet {boolean}
                             *
                             * @method init
                             * @constructor
                             * @param options {Object}
                             * @return {*}
                             */
                            init: function (options) {
                        
                                CG._extend(this, {
                                    /**
                                     * @property polys
                                     * @type {Array}
                                     */
                                    polys: new Array(),
                                    /**
                                     * @property bullet
                                     * @type {*}
                                     */
                                    bullet: false
                                })
                        
                                this._super(options)
                                this.instanceOf = &#x27;B2DPolygon&#x27;
                                this.setImage(this.image)
                        
                                /**
                                 * @property jsondata
                                 * @type {*}
                                 */
                        //        this.jsondata = jsonpoly.data[jsonpoly.name]
                                this.jsondata = this.texturepacker.data[this.name]
                                /**
                                 * @property vecs
                                 * @type {Array}
                                 */
                                this.vecs = new Array()
                                this.vecs = this.getPolysFromJson(this.texturepacker) // build grouped b2vecs from physicseditor
                                //@TODO get alternative polys from bitmap contourTrace &amp; triangulation?
                        
                                /**
                                 * @property bodyDef.type
                                 * @type {box2d.b2BodyType.b2_staticBody/box2d.b2BodyType.b2_dynamicBody/box2d.b2BodyType.b2_kinematicBody/box2d.b2BodyType.b2_bulletBody}
                                 */
                                this.bodyDef.type = this.bodyType
                        
                                /**
                                 * @property bodyDef.position
                                 */
                                this.bodyDef.position.SetXY(this.x / this.scale, this.y / this.scale)
                                /**
                                 * @property bodyDef.userData
                                 * @type {*}
                                 */
                                this.bodyDef.userData = this.id
                                /**
                                 * @property bodyDef.bullet
                                 * @type {*}
                                 */
                                this.bodyDef.bullet = this.bullet
                        
                                /**
                                 * @property body
                                 * @type {b2Body}
                                 */
                                this.body = this.world.CreateBody(this.bodyDef)
                        
                                for (var i = 0, l = this.vecs.length; i &lt; l; i++) {
                                    this.bodyShapePoly = new b2PolygonShape
                                    this.bodyShapePoly.bounce = this.jsondata[i].bounce        //value from physics editor
                                    this.makeVecsCentroid(this.vecs[i])
                                    this.bodyShapePoly.SetAsArray(this.vecs[i], this.vecs[i].length)
                                    this.fixDef.density = this.jsondata[i].density                  //value from physics editor
                                    this.fixDef.friction = this.jsondata[i].friction                //value from physics editor
                                    //this.fixDef.restitution = 0
                        
                                    this.fixDef.shape = this.bodyShapePoly
                                    this.body.CreateFixture(this.fixDef)
                                }
                                return this
                        
                            },
                            /**
                             * @description extract the polygons out of the PhysicsEditor json file and collect them into an array
                             *
                             * Physicseditor json example
                             @example
                             {
                        
                                 &quot;ballon&quot;: [
                        
                                         {
                                             &quot;density&quot;: 0.05, &quot;friction&quot;: 0.5, &quot;bounce&quot;: 0,
                                             &quot;filter&quot;: { &quot;categoryBits&quot;: 1, &quot;maskBits&quot;: 65535 },
                                             &quot;shape&quot;: [   98.5, 210  ,  98.5, 212  ,  92, 215.5  ,  82.5, 205  ,  91.5, 206  ,  97, 207.5  ]
                                         }  ,
                                         {
                                             &quot;density&quot;: 0.05, &quot;friction&quot;: 0.5, &quot;bounce&quot;: 0,
                                             &quot;filter&quot;: { &quot;categoryBits&quot;: 1, &quot;maskBits&quot;: 65535 },
                                             &quot;shape&quot;: [   81.5, 213  ,  82.5, 205  ,  92, 215.5  ,  83, 215.5  ]
                                         }  ,
                        
                             * @method getPolysFromJson
                             * @return {Array}
                             */
                            getPolysFromJson: function () {
                                var vecs = []
                                for (var i = 0, l = this.jsondata.length; i &lt; l; i++) {
                                    var poly = this.jsondata[i].shape
                                    var temp = []
                                    for (var i2 = 0, l2 = poly.length; i2 &lt; l2; i2 = i2 + 2) {
                                        var vec = new b2Vec2(poly[i2] / this.scale, poly[i2 + 1] / this.scale)
                                        temp.push(vec)
                                    }
                                    vecs.push(temp)
                                }
                                return vecs
                            },
                            /**
                             * @description use the CG.Bitmap traceContour method to get the shape of an bitmap. The result are &#x27;only&#x27; triangulated polygons. Better results with concave polygons are calculated with Physicseditor, see getPolysFromJson.
                             * @todo final implemenation
                             *
                             @example
                             // example code from demo-bitmap-contour.js
                             bitmap = new CG.Bitmap(Game.width, Game.height)
                             bitmap.loadImage(Game.asset.getImageByName(&#x27;star-contour-test&#x27;))
                             var contour = bitmap.traceContour()
                             var lightedContour = bitmap.lightenCountur(contour)
                             var triangulatedContour = bitmap.triangulateContour(lightedContour)
                        
                             * @method getPolysFromBitmapTrace
                             * @param image
                             * @returns {Array}
                             */
                            getPolysFromBitmapTrace: function (image) {
                                var vecs = []
                                return vecs
                            },
                            /**
                             * The origin of the vertices from physicseditor is top/left. This method makes the vecs centroid (centered origin) depending on image size.
                             * @todo put this stuff into getPolysFromJson?
                             *
                             * @method makeVecsCentroid
                             * @param vecs
                             */
                            makeVecsCentroid: function (vecs) {
                                var xcenter = this.xhandle / this.scale,
                                    ycenter = this.yhandle / this.scale
                                for (var p = 0, pl = vecs.length; p &lt; pl; p++) {
                                    vecs[p].x = vecs[p].x - xcenter
                                    vecs[p].y = vecs[p].y - ycenter
                                }
                            }
                        })
                        
                        
                        
                            </pre>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
